Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp2.osuosl.org (smtp2.osuosl.org [140.211.166.133])
	by mail.lfdr.de (Postfix) with ESMTPS id 79B894244AD
	for <lists.virtualization@lfdr.de>; Wed,  6 Oct 2021 19:40:59 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp2.osuosl.org (Postfix) with ESMTP id 641C840DA5;
	Wed,  6 Oct 2021 17:40:56 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
	by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id da7w-DQZzKcW; Wed,  6 Oct 2021 17:40:55 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp2.osuosl.org (Postfix) with ESMTPS id 6949940D9A;
	Wed,  6 Oct 2021 17:40:54 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 6F943C0023;
	Wed,  6 Oct 2021 17:40:53 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp3.osuosl.org (smtp3.osuosl.org [IPv6:2605:bc80:3010::136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 2864AC0032
 for <virtualization@lists.linux-foundation.org>;
 Wed,  6 Oct 2021 17:40:47 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp3.osuosl.org (Postfix) with ESMTP id 98E4E60EF1
 for <virtualization@lists.linux-foundation.org>;
 Wed,  6 Oct 2021 17:40:46 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp3.osuosl.org ([127.0.0.1])
 by localhost (smtp3.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id ygUFTGLlD_24
 for <virtualization@lists.linux-foundation.org>;
 Wed,  6 Oct 2021 17:40:45 +0000 (UTC)
X-Greylist: from auto-whitelisted by SQLgrey-1.8.0
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by smtp3.osuosl.org (Postfix) with ESMTPS id D86A560EF5
 for <virtualization@lists.linux-foundation.org>;
 Wed,  6 Oct 2021 17:40:44 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 60054307CAF1; Wed,  6 Oct 2021 20:31:05 +0300 (EEST)
Received: from localhost (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 41E03305FFA0;
 Wed,  6 Oct 2021 20:31:05 +0300 (EEST)
X-Is-Junk-Enabled: fGZTSsP0qEJE2AIKtlSuFiRRwg9xyHmJ
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v12 29/77] KVM: introduce VM introspection
Date: Wed,  6 Oct 2021 20:30:25 +0300
Message-Id: <20211006173113.26445-30-alazar@bitdefender.com>
In-Reply-To: <20211006173113.26445-1-alazar@bitdefender.com>
References: <20211006173113.26445-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: Tamas K Lengyel <tamas@tklengyel.com>, Wanpeng Li <wanpengli@tencent.com>,
 Sean Christopherson <seanjc@google.com>, Joerg Roedel <joro@8bytes.org>,
 virtualization@lists.linux-foundation.org,
 =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Marian Rotariu <marian.c.rotariu@gmail.com>,
 Mathieu Tarral <mathieu.tarral@protonmail.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 Jim Mattson <jmattson@google.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhlIEtWTSBpbnRy
b3NwZWN0aW9uIHN1YnN5c3RlbSBwcm92aWRlcyBhIGZhY2lsaXR5IGZvciBhcHBsaWNhdGlvbnMK
dG8gY29udHJvbCB0aGUgZXhlY3V0aW9uIG9mIGFueSBydW5uaW5nIFZNcyAocGF1c2UsIHJlc3Vt
ZSwgc2h1dGRvd24pLApxdWVyeSB0aGUgc3RhdGUgb2YgdGhlIHZDUFVzIChHUFJzLCBNU1JzIGV0
Yy4pLCBhbHRlciB0aGUgcGFnZSBhY2Nlc3MgYml0cwppbiB0aGUgc2hhZG93IHBhZ2UgdGFibGVz
IGFuZCByZWNlaXZlIG5vdGlmaWNhdGlvbnMgd2hlbiBldmVudHMgb2YgaW50ZXJlc3QKaGF2ZSB0
YWtlbiBwbGFjZSAoc2hhZG93IHBhZ2UgdGFibGUgbGV2ZWwgZmF1bHRzLCBrZXkgTVNSIHdyaXRl
cywKaHlwZXJjYWxscyBldGMuKS4gU29tZSBub3RpZmljYXRpb25zIGNhbiBiZSByZXNwb25kZWQg
dG8gd2l0aCBhbiBhY3Rpb24KKGxpa2UgcHJldmVudGluZyBhbiBNU1IgZnJvbSBiZWluZyB3cml0
dGVuKSwgb3RoZXJzIGFyZSBtZXJlIGluZm9ybWF0aXZlCihsaWtlIGJyZWFrcG9pbnQgZXZlbnRz
IHdoaWNoIGNhbiBiZSB1c2VkIGZvciBleGVjdXRpb24gdHJhY2luZykuCgpTaWduZWQtb2ZmLWJ5
OiBNaWhhaSBEb27Im3UgPG1kb250dUBiaXRkZWZlbmRlci5jb20+CkNvLWRldmVsb3BlZC1ieTog
TWFyaWFuIFJvdGFyaXUgPG1hcmlhbi5jLnJvdGFyaXVAZ21haWwuY29tPgpTaWduZWQtb2ZmLWJ5
OiBNYXJpYW4gUm90YXJpdSA8bWFyaWFuLmMucm90YXJpdUBnbWFpbC5jb20+ClNpZ25lZC1vZmYt
Ynk6IEFkYWxiZXJ0IExhesSDciA8YWxhemFyQGJpdGRlZmVuZGVyLmNvbT4KLS0tCiBEb2N1bWVu
dGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0ICAgfCAxMzkgKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrCiBhcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1faG9zdC5oICAgfCAgIDIgKwogYXJjaC94
ODYva3ZtL0tjb25maWcgICAgICAgICAgICAgIHwgIDEwICsrKwogYXJjaC94ODYva3ZtL01ha2Vm
aWxlICAgICAgICAgICAgIHwgICAyICsKIGluY2x1ZGUvbGludXgva3ZtaV9ob3N0LmggICAgICAg
ICB8ICAyMSArKysrKwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMgICAgIHwgIDI1ICsr
KysrKwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oIHwgICA3ICsrCiB2aXJ0L2t2
bS9rdm1fbWFpbi5jICAgICAgICAgICAgICAgfCAgMTUgKysrKwogOCBmaWxlcyBjaGFuZ2VkLCAy
MjEgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IERvY3VtZW50YXRpb24vdmlydC9r
dm0va3ZtaS5yc3QKIGNyZWF0ZSBtb2RlIDEwMDY0NCBpbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5o
CiBjcmVhdGUgbW9kZSAxMDA2NDQgdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKIGNyZWF0
ZSBtb2RlIDEwMDY0NCB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmgKCmRpZmYgLS1n
aXQgYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0IGIvRG9jdW1lbnRhdGlvbi92aXJ0
L2t2bS9rdm1pLnJzdApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjU5
Y2MzM2EzOWY5ZgotLS0gL2Rldi9udWxsCisrKyBiL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3Zt
aS5yc3QKQEAgLTAsMCArMSwxMzkgQEAKKy4uIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwt
Mi4wCisKKz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PQorS1ZNSSAtIFRoZSBrZXJuZWwgdmlydHVhbCBtYWNoaW5lIGludHJvc3BlY3Rpb24g
c3Vic3lzdGVtCis9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KKworVGhlIEtWTSBpbnRyb3NwZWN0aW9uIHN1YnN5c3RlbSBwcm92aWRlcyBh
IGZhY2lsaXR5IGZvciBhcHBsaWNhdGlvbnMgcnVubmluZworb24gdGhlIGhvc3Qgb3IgaW4gYSBz
ZXBhcmF0ZSBWTSwgdG8gY29udHJvbCB0aGUgZXhlY3V0aW9uIG9mIGFueSBydW5uaW5nIFZNcwor
KHBhdXNlLCByZXN1bWUsIHNodXRkb3duKSwgcXVlcnkgdGhlIHN0YXRlIG9mIHRoZSB2Q1BVcyAo
R1BScywgTVNScyBldGMuKSwKK2FsdGVyIHRoZSBwYWdlIGFjY2VzcyBiaXRzIGluIHRoZSBzaGFk
b3cgcGFnZSB0YWJsZXMgKG9ubHkgZm9yIHRoZSBoYXJkd2FyZQorYmFja2VkIG9uZXMsIGVnLiBJ
bnRlbCdzIEVQVCkgYW5kIHJlY2VpdmUgbm90aWZpY2F0aW9ucyB3aGVuIGV2ZW50cyBvZgoraW50
ZXJlc3QgaGF2ZSB0YWtlbiBwbGFjZSAoc2hhZG93IHBhZ2UgdGFibGUgbGV2ZWwgZmF1bHRzLCBr
ZXkgTVNSIHdyaXRlcywKK2h5cGVyY2FsbHMgZXRjLikuIFNvbWUgbm90aWZpY2F0aW9ucyBjYW4g
YmUgcmVzcG9uZGVkIHRvIHdpdGggYW4gYWN0aW9uCisobGlrZSBwcmV2ZW50aW5nIGFuIE1TUiBm
cm9tIGJlaW5nIHdyaXR0ZW4pLCBvdGhlcnMgYXJlIG1lcmUgaW5mb3JtYXRpdmUKKyhsaWtlIGJy
ZWFrcG9pbnQgZXZlbnRzIHdoaWNoIGNhbiBiZSB1c2VkIGZvciBleGVjdXRpb24gdHJhY2luZyku
CitXaXRoIGZldyBleGNlcHRpb25zLCBhbGwgZXZlbnRzIGFyZSBvcHRpb25hbC4gQW4gYXBwbGlj
YXRpb24gdXNpbmcgdGhpcworc3Vic3lzdGVtIHdpbGwgZXhwbGljaXRseSByZWdpc3RlciBmb3Ig
dGhlbS4KKworVGhlIHVzZSBjYXNlIHRoYXQgZ2F2ZSB3YXkgZm9yIHRoZSBjcmVhdGlvbiBvZiB0
aGlzIHN1YnN5c3RlbSBpcyB0byBtb25pdG9yCit0aGUgZ3Vlc3QgT1MgYW5kIGFzIHN1Y2ggdGhl
IEFCSS9BUEkgaXMgaGlnaGx5IGluZmx1ZW5jZWQgYnkgaG93IHRoZSBndWVzdAorc29mdHdhcmUg
KGtlcm5lbCwgYXBwbGljYXRpb25zKSBzZWVzIHRoZSB3b3JsZC4gRm9yIGV4YW1wbGUsIHNvbWUg
ZXZlbnRzCitwcm92aWRlIGluZm9ybWF0aW9uIHNwZWNpZmljIGZvciB0aGUgaG9zdCBDUFUgYXJj
aGl0ZWN0dXJlCisoZWcuIE1TUl9JQTMyX1NZU0VOVEVSX0VJUCkgbWVyZWx5IGJlY2F1c2UgaXRz
IGxldmVyYWdlZCBieSBndWVzdCBzb2Z0d2FyZQordG8gaW1wbGVtZW50IGEgY3JpdGljYWwgZmVh
dHVyZSAoZmFzdCBzeXN0ZW0gY2FsbHMpLgorCitBdCB0aGUgbW9tZW50LCB0aGUgdGFyZ2V0IGF1
ZGllbmNlIGZvciBLVk1JIGFyZSBzZWN1cml0eSBzb2Z0d2FyZSBhdXRob3JzCit0aGF0IHdpc2gg
dG8gcGVyZm9ybSBmb3JlbnNpY3Mgb24gbmV3bHkgZGlzY292ZXJlZCB0aHJlYXRzIChleHBsb2l0
cykgb3IKK3RvIGltcGxlbWVudCBhbm90aGVyIGxheWVyIG9mIHNlY3VyaXR5IGxpa2UgcHJldmVu
dGluZyBhIGxhcmdlIHNldCBvZgora2VybmVsIHJvb3RraXRzIHNpbXBseSBieSAibG9ja2luZyIg
dGhlIGtlcm5lbCBpbWFnZSBpbiB0aGUgc2hhZG93IHBhZ2UKK3RhYmxlcyAoaWUuIGVuZm9yY2Ug
LnRleHQgci14LCAucm9kYXRhIHJ3LSBldGMuKS4gSXQncyB0aGUgbGF0dGVyIGNhc2UgdGhhdAor
bWFkZSBLVk1JIGEgc2VwYXJhdGUgc3Vic3lzdGVtLCBldmVuIHRob3VnaCBtYW55IG9mIHRoZXNl
IGZlYXR1cmVzIGFyZQorYXZhaWxhYmxlIGluIHRoZSBkZXZpY2UgbWFuYWdlciAoZWcuIFFFTVUp
LiBUaGUgYWJpbGl0eSB0byBidWlsZCBhIHNlY3VyaXR5CithcHBsaWNhdGlvbiB0aGF0IGRvZXMg
bm90IGludGVyZmVyZSAoaW4gdGVybXMgb2YgcGVyZm9ybWFuY2UpIHdpdGggdGhlCitndWVzdCBz
b2Z0d2FyZSBhc2tzIGZvciBhIHNwZWNpYWxpemVkIGludGVyZmFjZSB0aGF0IGlzIGRlc2lnbmVk
IGZvciBtaW5pbXVtCitvdmVyaGVhZC4KKworQVBJL0FCSQorPT09PT09PQorCitUaGlzIGNoYXB0
ZXIgZGVzY3JpYmVzIHRoZSBWTUkgaW50ZXJmYWNlIHVzZWQgdG8gbW9uaXRvciBhbmQgY29udHJv
bCBsb2NhbAorZ3Vlc3RzIGZyb20gYSB1c2VyIGFwcGxpY2F0aW9uLgorCitPdmVydmlldworLS0t
LS0tLS0KKworVGhlIGludGVyZmFjZSBpcyBzb2NrZXQgYmFzZWQsIG9uZSBjb25uZWN0aW9uIGZv
ciBldmVyeSBWTS4gT25lIGVuZCBpcyBpbiB0aGUKK2hvc3Qga2VybmVsIHdoaWxlIHRoZSBvdGhl
ciBpcyBoZWxkIGJ5IHRoZSB1c2VyIGFwcGxpY2F0aW9uIChpbnRyb3NwZWN0aW9uCit0b29sKS4K
KworVGhlIGluaXRpYWwgY29ubmVjdGlvbiBpcyBlc3RhYmxpc2hlZCBieSBhbiBhcHBsaWNhdGlv
biBydW5uaW5nIG9uIHRoZQoraG9zdCAoZWcuIFFFTVUpIHRoYXQgY29ubmVjdHMgdG8gdGhlIGlu
dHJvc3BlY3Rpb24gdG9vbCBhbmQgYWZ0ZXIgYQoraGFuZHNoYWtlIHRoZSBmaWxlIGRlc2NyaXB0
b3IgaXMgcGFzc2VkIHRvIHRoZSBob3N0IGtlcm5lbCBtYWtpbmcgYWxsCitmdXJ0aGVyIGNvbW11
bmljYXRpb24gdGFrZSBwbGFjZSBiZXR3ZWVuIGl0IGFuZCB0aGUgaW50cm9zcGVjdGlvbiB0b29s
LgorCitUaGUgc29ja2V0IHByb3RvY29sIGFsbG93cyBmb3IgY29tbWFuZHMgYW5kIGV2ZW50cyB0
byBiZSBtdWx0aXBsZXhlZCBvdmVyCit0aGUgc2FtZSBjb25uZWN0aW9uLiBBcyBzdWNoLCBpdCBp
cyBwb3NzaWJsZSBmb3IgdGhlIGludHJvc3BlY3Rpb24gdG9vbCB0bworcmVjZWl2ZSBhbiBldmVu
dCB3aGlsZSB3YWl0aW5nIGZvciB0aGUgcmVzdWx0IG9mIGEgY29tbWFuZC4gQWxzbywgaXQgY2Fu
CitzZW5kIGEgY29tbWFuZCB3aGlsZSB0aGUgaG9zdCBrZXJuZWwgaXMgd2FpdGluZyBmb3IgYSBy
ZXBseSB0byBhbiBldmVudC4KKworVGhlIGtlcm5lbCBzaWRlIG9mIHRoZSBzb2NrZXQgY29tbXVu
aWNhdGlvbiBpcyBibG9ja2luZyBhbmQgd2lsbCB3YWl0Citmb3IgYW4gYW5zd2VyIGZyb20gaXRz
IHBlZXIgaW5kZWZpbml0ZWx5IG9yIHVudGlsIHRoZSBndWVzdCBpcyBwb3dlcmVkCitvZmYgKGtp
bGxlZCksIHJlc3RhcnRlZCBvciB0aGUgcGVlciBnb2VzIGF3YXksIGF0IHdoaWNoIHBvaW50IGl0
IHdpbGwKK3dha2UgdXAgYW5kIHByb3Blcmx5IGNsZWFudXAgYXMgaWYgdGhlIGludHJvc3BlY3Rp
b24gc3Vic3lzdGVtIGhhcyBuZXZlcgorYmVlbiB1c2VkIG9uIHRoYXQgZ3Vlc3QgKGlmIHJlcXVl
c3RlZCkuIE9idmlvdXNseSwgd2hldGhlciB0aGUgZ3Vlc3QgY2FuCityZWFsbHkgY29udGludWUg
bm9ybWFsIGV4ZWN1dGlvbiBkZXBlbmRzIG9uIHdoZXRoZXIgdGhlIGludHJvc3BlY3Rpb24KK3Rv
b2wgaGFzIG1hZGUgYW55IG1vZGlmaWNhdGlvbnMgdGhhdCByZXF1aXJlIGFuIGFjdGl2ZSBLVk1J
IGNoYW5uZWwuCisKK0hhbmRzaGFrZQorLS0tLS0tLS0tCisKK0FsdGhvdWdoIHRoaXMgZmFsbHMg
b3V0IG9mIHRoZSBzY29wZSBvZiB0aGUgaW50cm9zcGVjdGlvbiBzdWJzeXN0ZW0sIGJlbG93Citp
cyBhIHByb3Bvc2FsIG9mIGEgaGFuZHNoYWtlIHRoYXQgY2FuIGJlIHVzZWQgYnkgaW1wbGVtZW50
b3JzLgorCitCYXNlZCBvbiB0aGUgc3lzdGVtIGFkbWluaXN0cmF0aW9uIHBvbGljaWVzLCB0aGUg
bWFuYWdlbWVudCB0b29sCisoZWcuIGxpYnZpcnQpIHN0YXJ0cyBkZXZpY2UgbWFuYWdlcnMgKGVn
LiBRRU1VKSB3aXRoIHNvbWUgZXh0cmEgYXJndW1lbnRzOgord2hhdCBpbnRyb3NwZWN0aW9uIHRv
b2wgY291bGQgbW9uaXRvci9jb250cm9sIHRoYXQgc3BlY2lmaWMgZ3Vlc3QgKGFuZAoraG93IHRv
IGNvbm5lY3QgdG8pIGFuZCB3aGF0IGludHJvc3BlY3Rpb24gY29tbWFuZHMvZXZlbnRzIGFyZSBh
bGxvd2VkLgorCitUaGUgZGV2aWNlIG1hbmFnZXIgd2lsbCBjb25uZWN0IHRvIHRoZSBpbnRyb3Nw
ZWN0aW9uIHRvb2wgYW5kIHdhaXQgZm9yIGEKK2NyeXB0b2dyYXBoaWMgaGFzaCBvZiBhIGNvb2tp
ZSB0aGF0IHNob3VsZCBiZSBrbm93biBieSBib3RoIHBlZXJzLiBJZiB0aGUKK2hhc2ggaXMgY29y
cmVjdCAodGhlIGRlc3RpbmF0aW9uIGhhcyBiZWVuICJhdXRoZW50aWNhdGVkIiksIHRoZSBkZXZp
Y2UKK21hbmFnZXIgd2lsbCBzZW5kIGFub3RoZXIgY3J5cHRvZ3JhcGhpYyBoYXNoIGFuZCByYW5k
b20gc2FsdC4gVGhlIHBlZXIKK3JlY29tcHV0ZXMgdGhlIGhhc2ggb2YgdGhlIGNvb2tpZSBieXRl
cyBpbmNsdWRpbmcgdGhlIHNhbHQgYW5kIGlmIHRoZXkgbWF0Y2gsCit0aGUgZGV2aWNlIG1hbmFn
ZXIgaGFzIGJlZW4gImF1dGhlbnRpY2F0ZWQiIHRvby4gVGhpcyBpcyBhIHJhdGhlciBjcnVkZQor
c3lzdGVtIHRoYXQgbWFrZXMgaXQgZGlmZmljdWx0IGZvciBkZXZpY2UgbWFuYWdlciBleHBsb2l0
cyB0byB0cmljayB0aGUKK2ludHJvc3BlY3Rpb24gdG9vbCBpbnRvIGJlbGlldmluZyBpdHMgd29y
a2luZyBPSy4KKworVGhlIGNvb2tpZSB3b3VsZCBub3JtYWxseSBiZSBnZW5lcmF0ZWQgYnkgYSBt
YW5hZ2VtZW50IHRvb2wgKGVnLiBsaWJ2aXJ0KQorYW5kIG1ha2UgaXQgYXZhaWxhYmxlIHRvIHRo
ZSBkZXZpY2UgbWFuYWdlciBhbmQgdG8gYSBwcm9wZXJseSBhdXRoZW50aWNhdGVkCitjbGllbnQu
IEl0IGlzIHRoZSBqb2Igb2YgYSB0aGlyZCBwYXJ0eSB0byByZXRyaWV2ZSB0aGUgY29va2llIGZy
b20gdGhlCittYW5hZ2VtZW50IGFwcGxpY2F0aW9uIGFuZCBwYXNzIGl0IG92ZXIgYSBzZWN1cmUg
Y2hhbm5lbCB0byB0aGUgaW50cm9zcGVjdGlvbgordG9vbC4KKworT25jZSB0aGUgYmFzaWMgImF1
dGhlbnRpY2F0aW9uIiBoYXMgdGFrZW4gcGxhY2UsIHRoZSBpbnRyb3NwZWN0aW9uIHRvb2wKK2Nh
biByZWNlaXZlIGluZm9ybWF0aW9uIG9uIHRoZSBndWVzdCAoaXRzIFVVSUQpIGFuZCBvdGhlciBm
bGFncyAoZW5kaWFubmVzcworb3IgZmVhdHVyZXMgc3VwcG9ydGVkIGJ5IHRoZSBob3N0IGtlcm5l
bCkuCisKK0luIHRoZSBlbmQsIHRoZSBkZXZpY2UgbWFuYWdlciB3aWxsIHBhc3MgdGhlIGZpbGUg
ZGVzY3JpcHRvciAocGx1cwordGhlIGFsbG93ZWQgY29tbWFuZHMvZXZlbnRzKSB0byBLVk0uIEl0
IHdpbGwgZGV0ZWN0IHdoZW4gdGhlIHNvY2tldCBpcworc2h1dGRvd24gYW5kIGl0IHdpbGwgcmVp
bml0aWF0ZSB0aGUgaGFuZHNoYWtlLgorCitVbmhvb2tpbmcKKy0tLS0tLS0tLQorCitEdXJpbmcg
YSBWTUkgc2Vzc2lvbiBpdCBpcyBwb3NzaWJsZSBmb3IgdGhlIGd1ZXN0IHRvIGJlIHBhdGNoZWQg
YW5kIGZvcgorc29tZSBvZiB0aGVzZSBwYXRjaGVzIHRvICJ0YWxrIiB3aXRoIHRoZSBpbnRyb3Nw
ZWN0aW9uIHRvb2wuIEl0IHRodXMKK2JlY29tZXMgbmVjZXNzYXJ5IHRvIHJlbW92ZSB0aGVtIGJl
Zm9yZSB0aGUgZ3Vlc3QgaXMgc3VzcGVuZGVkLCBtb3ZlZAorKG1pZ3JhdGVkKSBvciBhIHNuYXBz
aG90IHdpdGggbWVtb3J5IGlzIGNyZWF0ZWQuCisKK1RoZSBhY3Rpb25zIGFyZSBub3JtYWxseSBw
ZXJmb3JtZWQgYnkgdGhlIGRldmljZSBtYW5hZ2VyLiBJbiB0aGUgY2FzZQorb2YgUUVNVSwgaXQg
d2lsbCB1c2UgYW5vdGhlciBpb2N0bCB0byBub3RpZnkgdGhlIGludHJvc3BlY3Rpb24gdG9vbCBh
bmQKK3dhaXQgZm9yIGEgbGltaXRlZCBhbW91bnQgb2YgdGltZSAoYSBmZXcgc2Vjb25kcykgZm9y
IGEgY29uZmlybWF0aW9uIHRoYXQKK2lzIE9LIHRvIHByb2NlZWQgKHRoZSBpbnRyb3NwZWN0aW9u
IHRvb2wgd2lsbCBjbG9zZSB0aGUgY29ubmVjdGlvbikuCisKK0xpdmUgbWlncmF0aW9ucworLS0t
LS0tLS0tLS0tLS0tCisKK0JlZm9yZSB0aGUgbGl2ZSBtaWdyYXRpb24gdGFrZXMgcGxhY2UsIHRo
ZSBpbnRyb3NwZWN0aW9uIHRvb2wgaGFzIHRvIGJlCitub3RpZmllZCBhbmQgaGF2ZSBhIGNoYW5j
ZSB0byB1bmhvb2sgKHNlZSAqKlVuaG9va2luZyoqKS4KKworVGhlIFFFTVUgaW5zdGFuY2Ugb24g
dGhlIHJlY2VpdmluZyBlbmQsIGlmIGNvbmZpZ3VyZWQgZm9yIEtWTUksIHdpbGwgbmVlZAordG8g
ZXN0YWJsaXNoIGEgY29ubmVjdGlvbiB0byB0aGUgaW50cm9zcGVjdGlvbiB0b29sIGFmdGVyIHRo
ZSBtaWdyYXRpb24KK2hhcyBiZWVuIGNvbXBsZXRlZC4KKworT2J2aW91c2x5LCB0aGlzIGNyZWF0
ZXMgYSB3aW5kb3cgaW4gd2hpY2ggdGhlIGd1ZXN0IGlzIG5vdCBpbnRyb3NwZWN0ZWQuCitUaGUg
dXNlciBoYXMgdG8gYmUgYXdhcmUgb2YgdGhpcyBkZXRhaWwuIEZ1dHVyZSBpbnRyb3NwZWN0aW9u
IHRlY2hub2xvZ2llcworY2FuIGNob29zZSBub3QgdG8gZGlzY29ubmVjdCBhbmQgaW5zdGVhZCB0
cmFuc2ZlciB0aGUgbmVjZXNzYXJ5IGNvbnRleHQKK3RvIHRoZSBpbnRyb3NwZWN0aW9uIHRvb2wg
YXQgdGhlIG1pZ3JhdGlvbiBkZXN0aW5hdGlvbiB2aWEgYSBzZXBhcmF0ZQorY2hhbm5lbC4KKwor
TWVtb3J5IGFjY2VzcyBzYWZldHkKKy0tLS0tLS0tLS0tLS0tLS0tLS0tCisKK1RoZSBLVk1JIEFQ
SSBnaXZlcyBhY2Nlc3MgdG8gdGhlIGVudGlyZSBndWVzdCBwaHlzaWNhbCBhZGRyZXNzIHNwYWNl
IGJ1dAorcHJvdmlkZXMgbm8gaW5mb3JtYXRpb24gb24gd2hpY2ggcGFydHMgb2YgaXQgYXJlIHN5
c3RlbSBSQU0gYW5kIHdoaWNoIGFyZQorZGV2aWNlLXNwZWNpZmljIG1lbW9yeSAoRE1BLCBlbXVs
YXRlZCBNTUlPLCByZXNlcnZlZCBieSBhIHBhc3N0aHJvdWdoCitkZXZpY2UgZXRjLikuIEl0IGlz
IHVwIHRvIHRoZSB1c2VyIHRvIGRldGVybWluZSwgdXNpbmcgdGhlIGd1ZXN0IG9wZXJhdGluZwor
c3lzdGVtIGRhdGEgc3RydWN0dXJlcywgdGhlIGFyZWFzIHRoYXQgYXJlIHNhZmUgdG8gYWNjZXNz
IChjb2RlLCBzdGFjaywgaGVhcAorZXRjLikuCmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9pbmNsdWRl
L2FzbS9rdm1faG9zdC5oIGIvYXJjaC94ODYvaW5jbHVkZS9hc20va3ZtX2hvc3QuaAppbmRleCBk
YzNjODNlZGM0YmMuLjE5NzBjMjFjMjI3MCAxMDA2NDQKLS0tIGEvYXJjaC94ODYvaW5jbHVkZS9h
c20va3ZtX2hvc3QuaAorKysgYi9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1faG9zdC5oCkBAIC0x
NjI4LDYgKzE2MjgsOCBAQCB2b2lkIGt2bV9maXJlX21hc2tfbm90aWZpZXJzKHN0cnVjdCBrdm0g
Kmt2bSwgdW5zaWduZWQgaXJxY2hpcCwgdW5zaWduZWQgcGluLAogCiBleHRlcm4gYm9vbCB0ZHBf
ZW5hYmxlZDsKIAorZXh0ZXJuIGJvb2wgZW5hYmxlX2ludHJvc3BlY3Rpb247CisKIHU2NCB2Y3B1
X3RzY19raHooc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIAogLyogY29udHJvbCBvZiBndWVzdCB0
c2MgcmF0ZSBzdXBwb3J0ZWQ/ICovCmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9rdm0vS2NvbmZpZyBi
L2FyY2gveDg2L2t2bS9LY29uZmlnCmluZGV4IDYxOTE4NjEzODE3Ni4uNDRkNzQwOWIwYzBjIDEw
MDY0NAotLS0gYS9hcmNoL3g4Ni9rdm0vS2NvbmZpZworKysgYi9hcmNoL3g4Ni9rdm0vS2NvbmZp
ZwpAQCAtMTMyLDQgKzEzMiwxNCBAQCBjb25maWcgS1ZNX01NVV9BVURJVAogY29uZmlnIEtWTV9F
WFRFUk5BTF9XUklURV9UUkFDS0lORwogCWJvb2wKIAorY29uZmlnIEtWTV9JTlRST1NQRUNUSU9O
CisJYm9vbCAiS1ZNIEludHJvc3BlY3Rpb24iCisJZGVwZW5kcyBvbiAoS1ZNX0lOVEVMIHx8IEtW
TV9BTUQpCisJc2VsZWN0IEtWTV9FWFRFUk5BTF9XUklURV9UUkFDS0lORworCWRlZmF1bHQgbgor
CWhlbHAKKwkgIFByb3ZpZGVzIHRoZSBpbnRyb3NwZWN0aW9uIGludGVyZmFjZSwgd2hpY2ggYWxs
b3dzIHRoZSBjb250cm9sCisJICBvZiBhbnkgcnVubmluZyBWTS4gSXQgbXVzdCBiZSBleHBsaWNp
dGx5IGVuYWJsZWQgYnkgc2V0dGluZworCSAgdGhlIGt2bS5pbnRyb3NwZWN0aW9uIG1vZHVsZSBw
YXJhbWV0ZXIuCisKIGVuZGlmICMgVklSVFVBTElaQVRJT04KZGlmZiAtLWdpdCBhL2FyY2gveDg2
L2t2bS9NYWtlZmlsZSBiL2FyY2gveDg2L2t2bS9NYWtlZmlsZQppbmRleCA3NWRmZDI3YjZlOGEu
LmVkMmFhMzA4ZWI3NyAxMDA2NDQKLS0tIGEvYXJjaC94ODYva3ZtL01ha2VmaWxlCisrKyBiL2Fy
Y2gveDg2L2t2bS9NYWtlZmlsZQpAQCAtOCwxMSArOCwxMyBAQCBPQkpFQ1RfRklMRVNfTk9OX1NU
QU5EQVJEX3ZtZW50ZXIubyA6PSB5CiBlbmRpZgogCiBLVk0gOj0gLi4vLi4vLi4vdmlydC9rdm0K
K0tWTUkgOj0gJChLVk0pL2ludHJvc3BlY3Rpb24KIAoga3ZtLXkJCQkrPSAkKEtWTSkva3ZtX21h
aW4ubyAkKEtWTSkvY29hbGVzY2VkX21taW8ubyBcCiAJCQkJJChLVk0pL2V2ZW50ZmQubyAkKEtW
TSkvaXJxY2hpcC5vICQoS1ZNKS92ZmlvLm8gXAogCQkJCSQoS1ZNKS9kaXJ0eV9yaW5nLm8gJChL
Vk0pL2JpbmFyeV9zdGF0cy5vCiBrdm0tJChDT05GSUdfS1ZNX0FTWU5DX1BGKQkrPSAkKEtWTSkv
YXN5bmNfcGYubwora3ZtLSQoQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OKSArPSAkKEtWTUkpL2t2
bWkubwogCiBrdm0teQkJCSs9IHg4Ni5vIGVtdWxhdGUubyBpODI1OS5vIGlycS5vIGxhcGljLm8g
XAogCQkJICAgaTgyNTQubyBpb2FwaWMubyBpcnFfY29tbS5vIGNwdWlkLm8gcG11Lm8gbXRyci5v
IFwKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmggYi9pbmNsdWRlL2xpbnV4
L2t2bWlfaG9zdC5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMWUw
YTczYzJhMTkwCi0tLSAvZGV2L251bGwKKysrIGIvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaApA
QCAtMCwwICsxLDIxIEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5
ICovCisjaWZuZGVmIF9fS1ZNSV9IT1NUX0gKKyNkZWZpbmUgX19LVk1JX0hPU1RfSAorCisjaWZk
ZWYgQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OCisKK2ludCBrdm1pX2luaXQodm9pZCk7Cit2b2lk
IGt2bWlfdW5pbml0KHZvaWQpOwordm9pZCBrdm1pX2NyZWF0ZV92bShzdHJ1Y3Qga3ZtICprdm0p
Owordm9pZCBrdm1pX2Rlc3Ryb3lfdm0oc3RydWN0IGt2bSAqa3ZtKTsKKworI2Vsc2UKKworc3Rh
dGljIGlubGluZSBpbnQga3ZtaV9pbml0KHZvaWQpIHsgcmV0dXJuIDA7IH0KK3N0YXRpYyBpbmxp
bmUgdm9pZCBrdm1pX3VuaW5pdCh2b2lkKSB7IH0KK3N0YXRpYyBpbmxpbmUgdm9pZCBrdm1pX2Ny
ZWF0ZV92bShzdHJ1Y3Qga3ZtICprdm0pIHsgfQorc3RhdGljIGlubGluZSB2b2lkIGt2bWlfZGVz
dHJveV92bShzdHJ1Y3Qga3ZtICprdm0pIHsgfQorCisjZW5kaWYgLyogQ09ORklHX0tWTV9JTlRS
T1NQRUNUSU9OICovCisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlv
bi9rdm1pLmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwpuZXcgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmY1YjZiYmJkOTJiOQotLS0gL2Rldi9udWxsCisrKyBi
L3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCkBAIC0wLDAgKzEsMjUgQEAKKy8vIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogS1ZNIEludHJvc3BlY3Rpb24KKyAq
CisgKiBDb3B5cmlnaHQgKEMpIDIwMTctMjAyMSBCaXRkZWZlbmRlciBTLlIuTC4KKyAqCisgKi8K
KyNpbmNsdWRlICJrdm1pX2ludC5oIgorCitpbnQga3ZtaV9pbml0KHZvaWQpCit7CisJcmV0dXJu
IDA7Cit9CisKK3ZvaWQga3ZtaV91bmluaXQodm9pZCkKK3sKK30KKwordm9pZCBrdm1pX2NyZWF0
ZV92bShzdHJ1Y3Qga3ZtICprdm0pCit7Cit9CisKK3ZvaWQga3ZtaV9kZXN0cm95X3ZtKHN0cnVj
dCBrdm0gKmt2bSkKK3sKK30KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3Zt
aV9pbnQuaCBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaApuZXcgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmJkYjQyMjhmZGE1YgotLS0gL2Rldi9udWxsCisr
KyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaApAQCAtMCwwICsxLDcgQEAKKy8q
IFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCisjaWZuZGVmIF9fS1ZNSV9JTlRf
SAorI2RlZmluZSBfX0tWTUlfSU5UX0gKKworI2luY2x1ZGUgPGxpbnV4L2t2bV9ob3N0Lmg+CisK
KyNlbmRpZgpkaWZmIC0tZ2l0IGEvdmlydC9rdm0va3ZtX21haW4uYyBiL3ZpcnQva3ZtL2t2bV9t
YWluLmMKaW5kZXggODVmMmRkOGE3OWQxLi5jMjE1ODdjNDJiZTIgMTAwNjQ0Ci0tLSBhL3ZpcnQv
a3ZtL2t2bV9tYWluLmMKKysrIGIvdmlydC9rdm0va3ZtX21haW4uYwpAQCAtNTIsNiArNTIsNyBA
QAogI2luY2x1ZGUgPGxpbnV4L2xvY2tkZXAuaD4KICNpbmNsdWRlIDxsaW51eC9rdGhyZWFkLmg+
CiAjaW5jbHVkZSA8bGludXgvc3VzcGVuZC5oPgorI2luY2x1ZGUgPGxpbnV4L2t2bWlfaG9zdC5o
PgogCiAjaW5jbHVkZSA8YXNtL3Byb2Nlc3Nvci5oPgogI2luY2x1ZGUgPGFzbS9pb2N0bC5oPgpA
QCAtOTMsNiArOTQsOSBAQCB1bnNpZ25lZCBpbnQgaGFsdF9wb2xsX25zX3NocmluazsKIG1vZHVs
ZV9wYXJhbShoYWx0X3BvbGxfbnNfc2hyaW5rLCB1aW50LCAwNjQ0KTsKIEVYUE9SVF9TWU1CT0xf
R1BMKGhhbHRfcG9sbF9uc19zaHJpbmspOwogCitib29sIF9fcmVhZF9tb3N0bHkgZW5hYmxlX2lu
dHJvc3BlY3Rpb247Cittb2R1bGVfcGFyYW1fbmFtZWQoaW50cm9zcGVjdGlvbiwgZW5hYmxlX2lu
dHJvc3BlY3Rpb24sIGJvb2wsIDA0NDQpOworCiAvKgogICogT3JkZXJpbmcgb2YgbG9ja3M6CiAg
KgpAQCAtMTEwMCw2ICsxMTA0LDkgQEAgc3RhdGljIHN0cnVjdCBrdm0gKmt2bV9jcmVhdGVfdm0o
dW5zaWduZWQgbG9uZyB0eXBlKQogCWlmIChyKQogCQlnb3RvIG91dF9lcnI7CiAKKwlpZiAoZW5h
YmxlX2ludHJvc3BlY3Rpb24pCisJCWt2bWlfY3JlYXRlX3ZtKGt2bSk7CisKIAltdXRleF9sb2Nr
KCZrdm1fbG9jayk7CiAJbGlzdF9hZGQoJmt2bS0+dm1fbGlzdCwgJnZtX2xpc3QpOwogCW11dGV4
X3VubG9jaygma3ZtX2xvY2spOwpAQCAtMTE1Myw2ICsxMTYwLDggQEAgc3RhdGljIHZvaWQga3Zt
X2Rlc3Ryb3lfdm0oc3RydWN0IGt2bSAqa3ZtKQogCWludCBpOwogCXN0cnVjdCBtbV9zdHJ1Y3Qg
Km1tID0ga3ZtLT5tbTsKIAorCWlmIChlbmFibGVfaW50cm9zcGVjdGlvbikKKwkJa3ZtaV9kZXN0
cm95X3ZtKGt2bSk7CiAJa3ZtX2Rlc3Ryb3lfcG1fbm90aWZpZXIoa3ZtKTsKIAlrdm1fdWV2ZW50
X25vdGlmeV9jaGFuZ2UoS1ZNX0VWRU5UX0RFU1RST1lfVk0sIGt2bSk7CiAJa3ZtX2Rlc3Ryb3lf
dm1fZGVidWdmcyhrdm0pOwpAQCAtNTU5Myw2ICs1NjAyLDExIEBAIGludCBrdm1faW5pdCh2b2lk
ICpvcGFxdWUsIHVuc2lnbmVkIHZjcHVfc2l6ZSwgdW5zaWduZWQgdmNwdV9hbGlnbiwKIAlyID0g
a3ZtX3ZmaW9fb3BzX2luaXQoKTsKIAlXQVJOX09OKHIpOwogCisJaWYgKGVuYWJsZV9pbnRyb3Nw
ZWN0aW9uKSB7CisJCXIgPSBrdm1pX2luaXQoKTsKKwkJV0FSTl9PTihyKTsKKwl9CisKIAlyZXR1
cm4gMDsKIAogb3V0X3VucmVnOgpAQCAtNTYyMiw2ICs1NjM2LDcgQEAgdm9pZCBrdm1fZXhpdCh2
b2lkKQogewogCWludCBjcHU7CiAKKwlrdm1pX3VuaW5pdCgpOwogCWRlYnVnZnNfcmVtb3ZlX3Jl
Y3Vyc2l2ZShrdm1fZGVidWdmc19kaXIpOwogCW1pc2NfZGVyZWdpc3Rlcigma3ZtX2Rldik7CiAJ
Zm9yX2VhY2hfcG9zc2libGVfY3B1KGNwdSkKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0
aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0
aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
