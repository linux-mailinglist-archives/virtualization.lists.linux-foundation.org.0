Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from mail.linuxfoundation.org (mail.linuxfoundation.org [140.211.169.12])
	by mail.lfdr.de (Postfix) with ESMTPS id 07AC75E1BA
	for <lists.virtualization@lfdr.de>; Wed,  3 Jul 2019 12:10:15 +0200 (CEST)
Received: from mail.linux-foundation.org (localhost [127.0.0.1])
	by mail.linuxfoundation.org (Postfix) with ESMTP id 3FB621189;
	Wed,  3 Jul 2019 10:10:08 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@mail.linuxfoundation.org
Received: from smtp1.linuxfoundation.org (smtp1.linux-foundation.org
	[172.17.192.35])
	by mail.linuxfoundation.org (Postfix) with ESMTPS id 8B8D21187
	for <virtualization@lists.linux-foundation.org>;
	Wed,  3 Jul 2019 10:10:06 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
	by smtp1.linuxfoundation.org (Postfix) with ESMTPS id AF04F836
	for <virtualization@lists.linux-foundation.org>;
	Wed,  3 Jul 2019 10:10:04 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx01.intmail.prod.int.phx2.redhat.com
	[10.5.11.11])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mx1.redhat.com (Postfix) with ESMTPS id EAF9530C7E6A;
	Wed,  3 Jul 2019 10:10:03 +0000 (UTC)
Received: from [10.72.12.173] (ovpn-12-173.pek2.redhat.com [10.72.12.173])
	by smtp.corp.redhat.com (Postfix) with ESMTP id ED429863D9;
	Wed,  3 Jul 2019 10:09:52 +0000 (UTC)
Subject: Re: [RFC v2] vhost: introduce mdev based hardware vhost backend
To: Tiwei Bie <tiwei.bie@intel.com>, mst@redhat.com,
	alex.williamson@redhat.com, maxime.coquelin@redhat.com
References: <20190703091339.1847-1-tiwei.bie@intel.com>
From: Jason Wang <jasowang@redhat.com>
Message-ID: <7b8279b2-aa7e-7adc-eeff-20dfaf4400d0@redhat.com>
Date: Wed, 3 Jul 2019 18:09:51 +0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
	Thunderbird/60.7.2
MIME-Version: 1.0
In-Reply-To: <20190703091339.1847-1-tiwei.bie@intel.com>
Content-Language: en-US
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.11
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
	(mx1.redhat.com [10.5.110.46]);
	Wed, 03 Jul 2019 10:10:04 +0000 (UTC)
X-Spam-Status: No, score=-6.9 required=5.0 tests=BAYES_00,RCVD_IN_DNSWL_HI
	autolearn=ham version=3.3.1
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on
	smtp1.linux-foundation.org
Cc: kvm@vger.kernel.org, netdev@vger.kernel.org, linux-kernel@vger.kernel.org,
	virtualization@lists.linux-foundation.org, zhihong.wang@intel.com
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.12
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>,
	<mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>,
	<mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Sender: virtualization-bounces@lists.linux-foundation.org
Errors-To: virtualization-bounces@lists.linux-foundation.org

Ck9uIDIwMTkvNy8zIOS4i+WNiDU6MTMsIFRpd2VpIEJpZSB3cm90ZToKPiBEZXRhaWxzIGFib3V0
IHRoaXMgY2FuIGJlIGZvdW5kIGhlcmU6Cj4KPiBodHRwczovL2x3bi5uZXQvQXJ0aWNsZXMvNzUw
NzcwLwo+Cj4gV2hhdCdzIG5ldyBpbiB0aGlzIHZlcnNpb24KPiA9PT09PT09PT09PT09PT09PT09
PT09PT09PQo+Cj4gQSBuZXcgVkZJTyBkZXZpY2UgdHlwZSBpcyBpbnRyb2R1Y2VkIC0gdmZpby12
aG9zdC4gVGhpcyBhZGRyZXNzZWQKPiBzb21lIGNvbW1lbnRzIGZyb20gaGVyZTogaHR0cHM6Ly9w
YXRjaHdvcmsub3psYWJzLm9yZy9jb3Zlci85ODQ3NjMvCj4KPiBCZWxvdyBpcyB0aGUgdXBkYXRl
ZCBkZXZpY2UgaW50ZXJmYWNlOgo+Cj4gQ3VycmVudGx5LCB0aGVyZSBhcmUgdHdvIHJlZ2lvbnMg
b2YgdGhpcyBkZXZpY2U6IDEpIENPTkZJR19SRUdJT04KPiAoVkZJT19WSE9TVF9DT05GSUdfUkVH
SU9OX0lOREVYKSwgd2hpY2ggY2FuIGJlIHVzZWQgdG8gc2V0dXAgdGhlCj4gZGV2aWNlOyAyKSBO
T1RJRllfUkVHSU9OIChWRklPX1ZIT1NUX05PVElGWV9SRUdJT05fSU5ERVgpLCB3aGljaAo+IGNh
biBiZSB1c2VkIHRvIG5vdGlmeSB0aGUgZGV2aWNlLgo+Cj4gMS4gQ09ORklHX1JFR0lPTgo+Cj4g
VGhlIHJlZ2lvbiBkZXNjcmliZWQgYnkgQ09ORklHX1JFR0lPTiBpcyB0aGUgbWFpbiBjb250cm9s
IGludGVyZmFjZS4KPiBNZXNzYWdlcyB3aWxsIGJlIHdyaXR0ZW4gdG8gb3IgcmVhZCBmcm9tIHRo
aXMgcmVnaW9uLgo+Cj4gVGhlIG1lc3NhZ2UgdHlwZSBpcyBkZXRlcm1pbmVkIGJ5IHRoZSBgcmVx
dWVzdGAgZmllbGQgaW4gbWVzc2FnZQo+IGhlYWRlci4gVGhlIG1lc3NhZ2Ugc2l6ZSBpcyBlbmNv
ZGVkIGluIHRoZSBtZXNzYWdlIGhlYWRlciB0b28uCj4gVGhlIG1lc3NhZ2UgZm9ybWF0IGxvb2tz
IGxpa2UgdGhpczoKPgo+IHN0cnVjdCB2aG9zdF92ZmlvX29wIHsKPiAJX191NjQgcmVxdWVzdDsK
PiAJX191MzIgZmxhZ3M7Cj4gCS8qIEZsYWcgdmFsdWVzOiAqLwo+ICAgI2RlZmluZSBWSE9TVF9W
RklPX05FRURfUkVQTFkgMHgxIC8qIFdoZXRoZXIgbmVlZCByZXBseSAqLwo+IAlfX3UzMiBzaXpl
Owo+IAl1bmlvbiB7Cj4gCQlfX3U2NCB1NjQ7Cj4gCQlzdHJ1Y3Qgdmhvc3RfdnJpbmdfc3RhdGUg
c3RhdGU7Cj4gCQlzdHJ1Y3Qgdmhvc3RfdnJpbmdfYWRkciBhZGRyOwo+IAl9IHBheWxvYWQ7Cj4g
fTsKPgo+IFRoZSBleGlzdGluZyB2aG9zdC1rZXJuZWwgaW9jdGwgY21kcyBhcmUgcmV1c2VkIGFz
IHRoZSBtZXNzYWdlCj4gcmVxdWVzdHMgaW4gYWJvdmUgc3RydWN0dXJlLgoKClN0aWxsIGEgY29t
bWVudHMgbGlrZSBWMS4gV2hhdCdzIHRoZSBhZHZhbnRhZ2Ugb2YgaW52ZW50aW5nIGEgbmV3IApw
cm90b2NvbD8gSSBiZWxpZXZlIGVpdGhlciBvZiB0aGUgZm9sbG93aW5nIHNob3VsZCBiZSBiZXR0
ZXI6CgotIHVzaW5nIHZob3N0IGlvY3RsLMKgIHdlIGNhbiBzdGFydCBmcm9tIFNFVF9WUklOR19L
SUNLL1NFVF9WUklOR19DQUxMIAphbmQgZXh0ZW5kIGl0IHdpdGggZS5nIG5vdGlmeSByZWdpb24u
IFRoZSBhZHZhbnRhZ2VzIGlzIHRoYXQgYWxsIGV4aXN0IAp1c2Vyc3BhY2UgcHJvZ3JhbSBjb3Vs
ZCBiZSByZXVzZWQgd2l0aG91dCBtb2RpZmljYXRpb24gKG9yIG1pbmltYWwgCm1vZGlmaWNhdGlv
bikuIEFuZCB2aG9zdCBBUEkgaGlkZXMgbG90cyBvZiBkZXRhaWxzIHRoYXQgaXMgbm90IG5lY2Vz
c2FyeSAKdG8gYmUgdW5kZXJzdG9vZCBieSBhcHBsaWNhdGlvbiAoZS5nIGluIHRoZSBjYXNlIG9m
IGNvbnRhaW5lcikuCgotIHVzaW5nIFBDSSBsYXlvdXQsIHRoZW4geW91IGRvbid0IGV2ZW4gbmVl
ZCB0byByZS1pbnZlbnQgbm90aWZpeSByZWdpb24gCmF0IGFsbCBhbmQgd2UgY2FuIHBhc3MtdGhy
b3VnaCB0aGVtIHRvIGd1ZXN0LgoKUGVyc29uYWxseSwgSSBwcmVmZXIgdmhvc3QgaW9jdGwuCgoK
Pgo+IEVhY2ggbWVzc2FnZSB3aWxsIGJlIHdyaXR0ZW4gdG8gb3IgcmVhZCBmcm9tIHRoaXMgcmVn
aW9uIGF0IG9mZnNldCAwOgo+Cj4gaW50IHZob3N0X3ZmaW9fd3JpdGUoc3RydWN0IHZob3N0X2Rl
diAqZGV2LCBzdHJ1Y3Qgdmhvc3RfdmZpb19vcCAqb3ApCj4gewo+IAlpbnQgY291bnQgPSBWSE9T
VF9WRklPX09QX0hEUl9TSVpFICsgb3AtPnNpemU7Cj4gCXN0cnVjdCB2aG9zdF92ZmlvICp2Zmlv
ID0gZGV2LT5vcGFxdWU7Cj4gCWludCByZXQ7Cj4KPiAJcmV0ID0gcHdyaXRlNjQodmZpby0+ZGV2
aWNlX2ZkLCBvcCwgY291bnQsIHZmaW8tPmNvbmZpZ19vZmZzZXQpOwo+IAlpZiAocmV0ICE9IGNv
dW50KQo+IAkJcmV0dXJuIC0xOwo+Cj4gCXJldHVybiAwOwo+IH0KPgo+IGludCB2aG9zdF92Zmlv
X3JlYWQoc3RydWN0IHZob3N0X2RldiAqZGV2LCBzdHJ1Y3Qgdmhvc3RfdmZpb19vcCAqb3ApCj4g
ewo+IAlpbnQgY291bnQgPSBWSE9TVF9WRklPX09QX0hEUl9TSVpFICsgb3AtPnNpemU7Cj4gCXN0
cnVjdCB2aG9zdF92ZmlvICp2ZmlvID0gZGV2LT5vcGFxdWU7Cj4gCXVpbnQ2NF90IHJlcXVlc3Qg
PSBvcC0+cmVxdWVzdDsKPiAJaW50IHJldDsKPgo+IAlyZXQgPSBwcmVhZDY0KHZmaW8tPmRldmlj
ZV9mZCwgb3AsIGNvdW50LCB2ZmlvLT5jb25maWdfb2Zmc2V0KTsKPiAJaWYgKHJldCAhPSBjb3Vu
dCB8fCByZXF1ZXN0ICE9IG9wLT5yZXF1ZXN0KQo+IAkJcmV0dXJuIC0xOwo+Cj4gCXJldHVybiAw
Owo+IH0KPgo+IEl0J3MgcXVpdGUgc3RyYWlnaHRmb3J3YXJkIHRvIHNldCB0aGluZ3MgdG8gdGhl
IGRldmljZS4gSnVzdCBuZWVkIHRvCj4gd3JpdGUgdGhlIG1lc3NhZ2UgdG8gZGV2aWNlIGRpcmVj
dGx5Ogo+Cj4gaW50IHZob3N0X3ZmaW9fc2V0X2ZlYXR1cmVzKHN0cnVjdCB2aG9zdF9kZXYgKmRl
diwgdWludDY0X3QgZmVhdHVyZXMpCj4gewo+IAlzdHJ1Y3Qgdmhvc3RfdmZpb19vcCBvcDsKPgo+
IAlvcC5yZXF1ZXN0ID0gVkhPU1RfU0VUX0ZFQVRVUkVTOwo+IAlvcC5mbGFncyA9IDA7Cj4gCW9w
LnNpemUgPSBzaXplb2YoZmVhdHVyZXMpOwo+IAlvcC5wYXlsb2FkLnU2NCA9IGZlYXR1cmVzOwo+
Cj4gCXJldHVybiB2aG9zdF92ZmlvX3dyaXRlKGRldiwgJm9wKTsKPiB9Cj4KPiBUbyBnZXQgdGhp
bmdzIGZyb20gdGhlIGRldmljZSwgdHdvIHN0ZXBzIGFyZSBuZWVkZWQuCj4gVGFrZSBWSE9TVF9H
RVRfRkVBVFVSRSBhcyBhbiBleGFtcGxlOgo+Cj4gaW50IHZob3N0X3ZmaW9fZ2V0X2ZlYXR1cmVz
KHN0cnVjdCB2aG9zdF9kZXYgKmRldiwgdWludDY0X3QgKmZlYXR1cmVzKQo+IHsKPiAJc3RydWN0
IHZob3N0X3ZmaW9fb3Agb3A7Cj4gCWludCByZXQ7Cj4KPiAJb3AucmVxdWVzdCA9IFZIT1NUX0dF
VF9GRUFUVVJFUzsKPiAJb3AuZmxhZ3MgPSBWSE9TVF9WRklPX05FRURfUkVQTFk7Cj4gCW9wLnNp
emUgPSAwOwo+Cj4gCS8qIEp1c3QgbmVlZCB0byB3cml0ZSB0aGUgaGVhZGVyICovCj4gCXJldCA9
IHZob3N0X3ZmaW9fd3JpdGUoZGV2LCAmb3ApOwo+IAlpZiAocmV0ICE9IDApCj4gCQlnb3RvIG91
dDsKPgo+IAkvKiBgb3BgIHdhc24ndCBjaGFuZ2VkIGR1cmluZyB3cml0ZSAqLwo+IAlvcC5mbGFn
cyA9IDA7Cj4gCW9wLnNpemUgPSBzaXplb2YoKmZlYXR1cmVzKTsKPgo+IAlyZXQgPSB2aG9zdF92
ZmlvX3JlYWQoZGV2LCAmb3ApOwo+IAlpZiAocmV0ICE9IDApCj4gCQlnb3RvIG91dDsKPgo+IAkq
ZmVhdHVyZXMgPSBvcC5wYXlsb2FkLnU2NDsKPiBvdXQ6Cj4gCXJldHVybiByZXQ7Cj4gfQo+Cj4g
Mi4gTk9USUZJWV9SRUdJT04gKG1tYXAtYWJsZSkKPgo+IFRoZSByZWdpb24gZGVzY3JpYmVkIGJ5
IE5PVElGWV9SRUdJT04gd2lsbCBiZSB1c2VkIHRvIG5vdGlmeQo+IHRoZSBkZXZpY2UuCj4KPiBF
YWNoIHF1ZXVlIHdpbGwgaGF2ZSBhIHBhZ2UgZm9yIG5vdGlmaWNhdGlvbiwgYW5kIGl0IGNhbiBi
ZSBtYXBwZWQKPiB0byBWTSAoaWYgaGFyZHdhcmUgYWxzbyBzdXBwb3J0cyksIGFuZCB0aGUgdmly
dGlvIGRyaXZlciBpbiB0aGUgVk0KPiB3aWxsIGJlIGFibGUgdG8gbm90aWZ5IHRoZSBkZXZpY2Ug
ZGlyZWN0bHkuCj4KPiBUaGUgcmVnaW9uIGRlc2NyaWJlZCBieSBOT1RJRllfUkVHSU9OIGlzIGFs
c28gd3JpdGUtYWJsZS4gSWYKPiB0aGUgYWNjZWxlcmF0b3IncyBub3RpZmljYXRpb24gcmVnaXN0
ZXIocykgY2Fubm90IGJlIG1hcHBlZCB0bwo+IHRoZSBWTSwgd3JpdGUoKSBjYW4gYWxzbyBiZSB1
c2VkIHRvIG5vdGlmeSB0aGUgZGV2aWNlLiBTb21ldGhpbmcKPiBsaWtlIHRoaXM6Cj4KPiB2b2lk
IG5vdGlmeV9yZWxheSh2b2lkICpvcGFxdWUpCj4gewo+IAkuLi4uLi4KPiAJb2Zmc2V0ID0gaG9z
dF9wYWdlX3NpemUgKiBxdWV1ZV9pZHg7Cj4KPiAJcmV0ID0gcHdyaXRlNjQodmZpby0+ZGV2aWNl
X2ZkLCAmcXVldWVfaWR4LCBzaXplb2YocXVldWVfaWR4KSwKPiAJCQl2ZmlvLT5ub3RpZnlfb2Zm
c2V0ICsgb2Zmc2V0KTsKPiAJLi4uLi4uCj4gfQo+Cj4gMy4gVkZJTyBpbnRlcnJ1cHQgaW9jdGwg
QVBJCj4KPiBWRklPIGludGVycnVwdCBpb2N0bCBBUEkgaXMgdXNlZCB0byBzZXR1cCBkZXZpY2Ug
aW50ZXJydXB0cy4KPiBJUlEtYnlwYXNzIGNhbiBhbHNvIGJlIHN1cHBvcnRlZC4KPgo+IEN1cnJl
bnRseSwgdGhlIGRhdGEgcGF0aCBpbnRlcnJ1cHQgY2FuIGJlIGNvbmZpZ3VyZWQgdmlhIHRoZQo+
IFZGSU9fVkhPU1RfVlFfSVJRX0lOREVYIHdpdGggdmlydHF1ZXVlJ3MgY2FsbGZkLgoKCkhvdyBh
Ym91dCBETUEgQVBJPyBEbyB5b3UgZXhwZWN0IHRvIHVzZSBWRklPIElPTU1VIEFQSSBvciB1c2lu
ZyB2aG9zdCAKU0VUX01FTV9UQUJMRT8gVkZJTyBJT01NVSBBUEkgaXMgbW9yZSBnZW5lcmljIGZv
ciBzdXJlIGJ1dCB3aXRoIApTRVRfTUVNX1RBQkxFIERNQSBjYW4gYmUgZG9uZSBhdCB0aGUgbGV2
ZWwgb2YgcGFyZW50IGRldmljZSB3aGljaCBtZWFucyAKaXQgY2FuIHdvcmsgZm9yIGUuZyB0aGUg
Y2FyZCB3aXRoIG9uLWNoaXAgSU9NTVUuCgpBbmQgd2hhdCdzIHRoZSBwbGFuIGZvciB2SU9NTVU/
CgoKPgo+IFNpZ25lZC1vZmYtYnk6IFRpd2VpIEJpZSA8dGl3ZWkuYmllQGludGVsLmNvbT4KPiAt
LS0KPiAgIGRyaXZlcnMvdmhvc3QvTWFrZWZpbGUgICAgIHwgICAyICsKPiAgIGRyaXZlcnMvdmhv
c3QvdmRwYS5jICAgICAgIHwgNzcwICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysKPiAgIGluY2x1ZGUvbGludXgvdmRwYV9tZGV2LmggIHwgIDcyICsrKysKPiAgIGluY2x1ZGUv
dWFwaS9saW51eC92ZmlvLmggIHwgIDE5ICsKPiAgIGluY2x1ZGUvdWFwaS9saW51eC92aG9zdC5o
IHwgIDI1ICsrCj4gICA1IGZpbGVzIGNoYW5nZWQsIDg4OCBpbnNlcnRpb25zKCspCj4gICBjcmVh
dGUgbW9kZSAxMDA2NDQgZHJpdmVycy92aG9zdC92ZHBhLmMKPiAgIGNyZWF0ZSBtb2RlIDEwMDY0
NCBpbmNsdWRlL2xpbnV4L3ZkcGFfbWRldi5oCgoKV2UgcHJvYmFibHkgbmVlZCBzb21lIHNhbXBs
ZSBwYXJlbnQgZGV2aWNlIGltcGxlbWVudGF0aW9uLiBJdCBjb3VsZCBiZSBhIApzb2Z0d2FyZSBk
YXRhcGF0aCBsaWtlIGUuZyB3ZSBjYW4gc3RhcnQgZnJvbSB2aXJ0aW8tbmV0IGRldmljZSBpbiBn
dWVzdCAKb3IgYSB2aG9zdC90YXAgb24gaG9zdC4KClRoYW5rcwoKCj4KPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy92aG9zdC9NYWtlZmlsZSBiL2RyaXZlcnMvdmhvc3QvTWFrZWZpbGUKPiBpbmRleCA2
YzZkZjI0Zjc3MGMuLmNhYmI3MTA5NTk0MCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL3Zob3N0L01h
a2VmaWxlCj4gKysrIGIvZHJpdmVycy92aG9zdC9NYWtlZmlsZQo+IEBAIC0xMCw0ICsxMCw2IEBA
IHZob3N0X3Zzb2NrLXkgOj0gdnNvY2subwo+ICAgCj4gICBvYmotJChDT05GSUdfVkhPU1RfUklO
RykgKz0gdnJpbmdoLm8KPiAgIAo+ICtvYmotJChDT05GSUdfVkhPU1RfVkZJTykgKz0gdmRwYS5v
Cj4gKwo+ICAgb2JqLSQoQ09ORklHX1ZIT1NUKQkrPSB2aG9zdC5vCj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvdmhvc3QvdmRwYS5jIGIvZHJpdmVycy92aG9zdC92ZHBhLmMKPiBuZXcgZmlsZSBtb2Rl
IDEwMDY0NAo+IGluZGV4IDAwMDAwMDAwMDAwMC4uNWM5NDI2ZTJhMDkxCj4gLS0tIC9kZXYvbnVs
bAo+ICsrKyBiL2RyaXZlcnMvdmhvc3QvdmRwYS5jCj4gQEAgLTAsMCArMSw3NzAgQEAKPiArLy8g
U1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKPiArLyoKPiArICogQ29weXJpZ2h0IChD
KSAyMDE4LTIwMTkgSW50ZWwgQ29ycG9yYXRpb24uCj4gKyAqLwo+ICsKPiArI2luY2x1ZGUgPGxp
bnV4L21vZHVsZS5oPgo+ICsjaW5jbHVkZSA8bGludXgva2VybmVsLmg+Cj4gKyNpbmNsdWRlIDxs
aW51eC92ZmlvLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC92aG9zdC5oPgo+ICsjaW5jbHVkZSA8bGlu
dXgvbWRldi5oPgo+ICsjaW5jbHVkZSA8bGludXgvdmRwYV9tZGV2Lmg+Cj4gKyNpbmNsdWRlIDxh
c20vdWFjY2Vzcy5oPgo+ICsKPiArI2RlZmluZSBWRFBBX0NPTkZJR19TSVpFCQkweDEwMDAwMDAK
PiArCj4gKyNkZWZpbmUgVkRQQV9WRklPX1ZIT1NUX09GRlNFVF9TSElGVAk0MAo+ICsjZGVmaW5l
IFZEUEFfVkZJT19WSE9TVF9PRkZTRVRfTUFTSyBcCj4gKwkJKCgxVUxMIDw8IFZEUEFfVkZJT19W
SE9TVF9PRkZTRVRfU0hJRlQpIC0gMSkKPiArI2RlZmluZSBWRFBBX1ZGSU9fVkhPU1RfT0ZGU0VU
X1RPX0lOREVYKG9mZnNldCkgXAo+ICsJCSgob2Zmc2V0KSA+PiBWRFBBX1ZGSU9fVkhPU1RfT0ZG
U0VUX1NISUZUKQo+ICsjZGVmaW5lIFZEUEFfVkZJT19WSE9TVF9JTkRFWF9UT19PRkZTRVQoaW5k
ZXgpIFwKPiArCQkoKHU2NCkoaW5kZXgpIDw8IFZEUEFfVkZJT19WSE9TVF9PRkZTRVRfU0hJRlQp
Cj4gKyNkZWZpbmUgVkRQQV9WRklPX1ZIT1NUX1JFR0lPTl9PRkZTRVQob2Zmc2V0KSBcCj4gKwkJ
KChvZmZzZXQpICYgVkRQQV9WRklPX1ZIT1NUX09GRlNFVF9NQVNLKQo+ICsKPiArc3RydWN0IHZk
cGFfZGV2ICp2ZHBhX2FsbG9jKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwgdm9pZCAqcHJpdmF0
ZSwKPiArCQkJICAgIGludCBtYXhfdnJpbmdzKQo+ICt7Cj4gKwlzdHJ1Y3QgdmRwYV9kZXYgKnZk
cGE7Cj4gKwlzaXplX3Qgc2l6ZTsKPiArCj4gKwlzaXplID0gc2l6ZW9mKHN0cnVjdCB2ZHBhX2Rl
dikgKyBtYXhfdnJpbmdzICoKPiArCQkJc2l6ZW9mKHN0cnVjdCB2ZHBhX3ZyaW5nX2luZm8pOwo+
ICsKPiArCXZkcGEgPSBremFsbG9jKHNpemUsIEdGUF9LRVJORUwpOwo+ICsJaWYgKHZkcGEgPT0g
TlVMTCkKPiArCQlyZXR1cm4gTlVMTDsKPiArCj4gKwltdXRleF9pbml0KCZ2ZHBhLT5vcHNfbG9j
ayk7Cj4gKwo+ICsJdmRwYS0+bWRldiA9IG1kZXY7Cj4gKwl2ZHBhLT5wcml2YXRlID0gcHJpdmF0
ZTsKPiArCXZkcGEtPm1heF92cmluZ3MgPSBtYXhfdnJpbmdzOwo+ICsKPiArCXJldHVybiB2ZHBh
Owo+ICt9Cj4gK0VYUE9SVF9TWU1CT0wodmRwYV9hbGxvYyk7Cj4gKwo+ICt2b2lkIHZkcGFfZnJl
ZShzdHJ1Y3QgdmRwYV9kZXYgKnZkcGEpCj4gK3sKPiArCXN0cnVjdCBtZGV2X2RldmljZSAqbWRl
djsKPiArCj4gKwltZGV2ID0gdmRwYS0+bWRldjsKPiArCj4gKwl2ZHBhLT5vcHMtPnN0b3AodmRw
YSk7Cj4gKwltZGV2X3NldF9kcnZkYXRhKG1kZXYsIE5VTEwpOwo+ICsJbXV0ZXhfZGVzdHJveSgm
dmRwYS0+b3BzX2xvY2spOwo+ICsJa2ZyZWUodmRwYSk7Cj4gK30KPiArRVhQT1JUX1NZTUJPTCh2
ZHBhX2ZyZWUpOwo+ICsKPiArc3RhdGljIHNzaXplX3QgdmRwYV9oYW5kbGVfY29uZmlnX3JlYWQo
c3RydWN0IG1kZXZfZGV2aWNlICptZGV2LAo+ICsJCWNoYXIgX191c2VyICpidWYsIHNpemVfdCBj
b3VudCwgbG9mZl90ICpwcG9zKQo+ICt7Cj4gKwlzdHJ1Y3QgdmRwYV9kZXYgKnZkcGE7Cj4gKwlz
dHJ1Y3Qgdmhvc3RfdmZpb19vcCAqb3AgPSBOVUxMOwo+ICsJbG9mZl90IHBvcyA9ICpwcG9zOwo+
ICsJbG9mZl90IG9mZnNldDsKPiArCWludCByZXQ7Cj4gKwo+ICsJdmRwYSA9IG1kZXZfZ2V0X2Ry
dmRhdGEobWRldik7Cj4gKwlpZiAoIXZkcGEpIHsKPiArCQlyZXQgPSAtRU5PREVWOwo+ICsJCWdv
dG8gb3V0Owo+ICsJfQo+ICsKPiArCW9mZnNldCA9IFZEUEFfVkZJT19WSE9TVF9SRUdJT05fT0ZG
U0VUKHBvcyk7Cj4gKwlpZiAob2Zmc2V0ICE9IDApIHsKPiArCQlyZXQgPSAtRUlOVkFMOwo+ICsJ
CWdvdG8gb3V0Owo+ICsJfQo+ICsKPiArCWlmICghdmRwYS0+cGVuZGluZ19yZXBseSkgewo+ICsJ
CXJldCA9IDA7Cj4gKwkJZ290byBvdXQ7Cj4gKwl9Cj4gKwo+ICsJdmRwYS0+cGVuZGluZ19yZXBs
eSA9IGZhbHNlOwo+ICsKPiArCW9wID0ga3phbGxvYyhWSE9TVF9WRklPX09QX0hEUl9TSVpFICsg
VkhPU1RfVkZJT19PUF9QQVlMT0FEX01BWF9TSVpFLAo+ICsJCSAgICAgR0ZQX0tFUk5FTCk7Cj4g
KwlpZiAob3AgPT0gTlVMTCkgewo+ICsJCXJldCA9IC1FTk9NRU07Cj4gKwkJZ290byBvdXQ7Cj4g
Kwl9Cj4gKwo+ICsJb3AtPnJlcXVlc3QgPSB2ZHBhLT5wZW5kaW5nLnJlcXVlc3Q7Cj4gKwo+ICsJ
c3dpdGNoIChvcC0+cmVxdWVzdCkgewo+ICsJY2FzZSBWSE9TVF9HRVRfVlJJTkdfQkFTRToKPiAr
CQlvcC0+cGF5bG9hZC5zdGF0ZSA9IHZkcGEtPnBlbmRpbmcucGF5bG9hZC5zdGF0ZTsKPiArCQlv
cC0+c2l6ZSA9IHNpemVvZihvcC0+cGF5bG9hZC5zdGF0ZSk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNl
IFZIT1NUX0dFVF9GRUFUVVJFUzoKPiArCQlvcC0+cGF5bG9hZC51NjQgPSB2ZHBhLT5wZW5kaW5n
LnBheWxvYWQudTY0Owo+ICsJCW9wLT5zaXplID0gc2l6ZW9mKG9wLT5wYXlsb2FkLnU2NCk7Cj4g
KwkJYnJlYWs7Cj4gKwlkZWZhdWx0Ogo+ICsJCXJldCA9IC1FSU5WQUw7Cj4gKwkJZ290byBvdXRf
ZnJlZTsKPiArCX0KPiArCj4gKwlpZiAob3AtPnNpemUgKyBWSE9TVF9WRklPX09QX0hEUl9TSVpF
ICE9IGNvdW50KSB7Cj4gKwkJcmV0ID0gLUVJTlZBTDsKPiArCQlnb3RvIG91dF9mcmVlOwo+ICsJ
fQo+ICsKPiArCWlmIChjb3B5X3RvX3VzZXIoYnVmLCBvcCwgY291bnQpKSB7Cj4gKwkJcmV0ID0g
LUVGQVVMVDsKPiArCQlnb3RvIG91dF9mcmVlOwo+ICsJfQo+ICsKPiArCXJldCA9IGNvdW50Owo+
ICsKPiArb3V0X2ZyZWU6Cj4gKwlrZnJlZShvcCk7Cj4gK291dDoKPiArCXJldHVybiByZXQ7Cj4g
K30KPiArCj4gK3NzaXplX3QgdmRwYV9yZWFkKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwgY2hh
ciBfX3VzZXIgKmJ1ZiwKPiArCQkgIHNpemVfdCBjb3VudCwgbG9mZl90ICpwcG9zKQo+ICt7Cj4g
KwlpbnQgZG9uZSA9IDA7Cj4gKwl1bnNpZ25lZCBpbnQgaW5kZXg7Cj4gKwlsb2ZmX3QgcG9zID0g
KnBwb3M7Cj4gKwlzdHJ1Y3QgdmRwYV9kZXYgKnZkcGE7Cj4gKwo+ICsJdmRwYSA9IG1kZXZfZ2V0
X2RydmRhdGEobWRldik7Cj4gKwlpZiAoIXZkcGEpCj4gKwkJcmV0dXJuIC1FTk9ERVY7Cj4gKwo+
ICsJbXV0ZXhfbG9jaygmdmRwYS0+b3BzX2xvY2spOwo+ICsKPiArCWluZGV4ID0gVkRQQV9WRklP
X1ZIT1NUX09GRlNFVF9UT19JTkRFWChwb3MpOwo+ICsKPiArCXN3aXRjaCAoaW5kZXgpIHsKPiAr
CWNhc2UgVkZJT19WSE9TVF9DT05GSUdfUkVHSU9OX0lOREVYOgo+ICsJCWRvbmUgPSB2ZHBhX2hh
bmRsZV9jb25maWdfcmVhZChtZGV2LCBidWYsIGNvdW50LCBwcG9zKTsKPiArCQlicmVhazsKPiAr
CX0KPiArCj4gKwlpZiAoZG9uZSA+IDApCj4gKwkJKnBwb3MgKz0gZG9uZTsKPiArCj4gKwltdXRl
eF91bmxvY2soJnZkcGEtPm9wc19sb2NrKTsKPiArCj4gKwlyZXR1cm4gZG9uZTsKPiArfQo+ICtF
WFBPUlRfU1lNQk9MKHZkcGFfcmVhZCk7Cj4gKwo+ICtzdGF0aWMgaW50IHZob3N0X3NldF92cmlu
Z19hZGRyKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwKPiArCQlzdHJ1Y3Qgdmhvc3RfdnJpbmdf
YWRkciAqYWRkcikKPiArewo+ICsJc3RydWN0IHZkcGFfZGV2ICp2ZHBhOwo+ICsJaW50IHFpZCA9
IGFkZHItPmluZGV4Owo+ICsJc3RydWN0IHZkcGFfdnJpbmdfaW5mbyAqdnJpbmc7Cj4gKwo+ICsJ
dmRwYSA9IG1kZXZfZ2V0X2RydmRhdGEobWRldik7Cj4gKwlpZiAoIXZkcGEpCj4gKwkJcmV0dXJu
IC1FTk9ERVY7Cj4gKwo+ICsJaWYgKHFpZCA+PSB2ZHBhLT5tYXhfdnJpbmdzKQo+ICsJCXJldHVy
biAtRUlOVkFMOwo+ICsKPiArCWlmIChxaWQgPj0gdmRwYS0+bnJfdnJpbmcpCj4gKwkJdmRwYS0+
bnJfdnJpbmcgPSBxaWQgKyAxOwo+ICsKPiArCXZyaW5nID0gJnZkcGEtPnZyaW5nX2luZm9bcWlk
XTsKPiArCj4gKwl2cmluZy0+ZGVzY191c2VyX2FkZHIgPSBhZGRyLT5kZXNjX3VzZXJfYWRkcjsK
PiArCXZyaW5nLT51c2VkX3VzZXJfYWRkciA9IGFkZHItPnVzZWRfdXNlcl9hZGRyOwo+ICsJdnJp
bmctPmF2YWlsX3VzZXJfYWRkciA9IGFkZHItPmF2YWlsX3VzZXJfYWRkcjsKPiArCXZyaW5nLT5s
b2dfZ3Vlc3RfYWRkciA9IGFkZHItPmxvZ19ndWVzdF9hZGRyOwo+ICsKPiArCXJldHVybiAwOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZob3N0X3NldF92cmluZ19udW0oc3RydWN0IG1kZXZfZGV2
aWNlICptZGV2LAo+ICsJCXN0cnVjdCB2aG9zdF92cmluZ19zdGF0ZSAqbnVtKQo+ICt7Cj4gKwlz
dHJ1Y3QgdmRwYV9kZXYgKnZkcGE7Cj4gKwlpbnQgcWlkID0gbnVtLT5pbmRleDsKPiArCXN0cnVj
dCB2ZHBhX3ZyaW5nX2luZm8gKnZyaW5nOwo+ICsKPiArCXZkcGEgPSBtZGV2X2dldF9kcnZkYXRh
KG1kZXYpOwo+ICsJaWYgKCF2ZHBhKQo+ICsJCXJldHVybiAtRU5PREVWOwo+ICsKPiArCWlmIChx
aWQgPj0gdmRwYS0+bWF4X3ZyaW5ncykKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCj4gKwl2cmlu
ZyA9ICZ2ZHBhLT52cmluZ19pbmZvW3FpZF07Cj4gKwo+ICsJdnJpbmctPnNpemUgPSBudW0tPm51
bTsKPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGludCB2aG9zdF9zZXRfdnJp
bmdfYmFzZShzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYsCj4gKwkJc3RydWN0IHZob3N0X3ZyaW5n
X3N0YXRlICpiYXNlKQo+ICt7Cj4gKwlzdHJ1Y3QgdmRwYV9kZXYgKnZkcGE7Cj4gKwlpbnQgcWlk
ID0gYmFzZS0+aW5kZXg7Cj4gKwlzdHJ1Y3QgdmRwYV92cmluZ19pbmZvICp2cmluZzsKPiArCj4g
Kwl2ZHBhID0gbWRldl9nZXRfZHJ2ZGF0YShtZGV2KTsKPiArCWlmICghdmRwYSkKPiArCQlyZXR1
cm4gLUVOT0RFVjsKPiArCj4gKwlpZiAocWlkID49IHZkcGEtPm1heF92cmluZ3MpCj4gKwkJcmV0
dXJuIC1FSU5WQUw7Cj4gKwo+ICsJdnJpbmcgPSAmdmRwYS0+dnJpbmdfaW5mb1txaWRdOwo+ICsK
PiArCXZyaW5nLT5iYXNlID0gYmFzZS0+bnVtOwo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+
ICtzdGF0aWMgaW50IHZob3N0X2dldF92cmluZ19iYXNlKHN0cnVjdCBtZGV2X2RldmljZSAqbWRl
diwKPiArCQlzdHJ1Y3Qgdmhvc3RfdnJpbmdfc3RhdGUgKmJhc2UpCj4gK3sKPiArCXN0cnVjdCB2
ZHBhX2RldiAqdmRwYTsKPiArCWludCBxaWQgPSBiYXNlLT5pbmRleDsKPiArCj4gKwl2ZHBhID0g
bWRldl9nZXRfZHJ2ZGF0YShtZGV2KTsKPiArCWlmICghdmRwYSkKPiArCQlyZXR1cm4gLUVOT0RF
VjsKPiArCj4gKwl2ZHBhLT5wZW5kaW5nX3JlcGx5ID0gdHJ1ZTsKPiArCXZkcGEtPnBlbmRpbmcu
cmVxdWVzdCA9IFZIT1NUX0dFVF9WUklOR19CQVNFOwo+ICsJdmRwYS0+cGVuZGluZy5wYXlsb2Fk
LnN0YXRlLmluZGV4ID0gcWlkOwo+ICsJdmRwYS0+cGVuZGluZy5wYXlsb2FkLnN0YXRlLm51bSA9
IHZkcGEtPnZyaW5nX2luZm9bcWlkXS5iYXNlOwo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+
ICtzdGF0aWMgaW50IHZob3N0X3NldF9sb2dfYmFzZShzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYs
IHU2NCAqbG9nX2Jhc2UpCj4gK3sKPiArCXN0cnVjdCB2ZHBhX2RldiAqdmRwYTsKPiArCj4gKwl2
ZHBhID0gbWRldl9nZXRfZHJ2ZGF0YShtZGV2KTsKPiArCWlmICghdmRwYSkKPiArCQlyZXR1cm4g
LUVOT0RFVjsKPiArCj4gKwl2ZHBhLT5sb2dfYmFzZSA9ICpsb2dfYmFzZTsKPiArCXJldHVybiAw
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZob3N0X3NldF9mZWF0dXJlcyhzdHJ1Y3QgbWRldl9k
ZXZpY2UgKm1kZXYsIHU2NCAqZmVhdHVyZXMpCj4gK3sKPiArCXN0cnVjdCB2ZHBhX2RldiAqdmRw
YTsKPiArCj4gKwl2ZHBhID0gbWRldl9nZXRfZHJ2ZGF0YShtZGV2KTsKPiArCWlmICghdmRwYSkK
PiArCQlyZXR1cm4gLUVOT0RFVjsKPiArCj4gKwl2ZHBhLT5mZWF0dXJlcyA9ICpmZWF0dXJlczsK
PiArCXZkcGEtPm9wcy0+c2V0X2ZlYXR1cmVzKHZkcGEpOwo+ICsKPiArCXJldHVybiAwOwo+ICt9
Cj4gKwo+ICtzdGF0aWMgaW50IHZob3N0X2dldF9mZWF0dXJlcyhzdHJ1Y3QgbWRldl9kZXZpY2Ug
Km1kZXYsIHU2NCAqZmVhdHVyZXMpCj4gK3sKPiArCXN0cnVjdCB2ZHBhX2RldiAqdmRwYTsKPiAr
Cj4gKwl2ZHBhID0gbWRldl9nZXRfZHJ2ZGF0YShtZGV2KTsKPiArCWlmICghdmRwYSkKPiArCQly
ZXR1cm4gLUVOT0RFVjsKPiArCj4gKwl2ZHBhLT5wZW5kaW5nX3JlcGx5ID0gdHJ1ZTsKPiArCXZk
cGEtPnBlbmRpbmcucmVxdWVzdCA9IFZIT1NUX0dFVF9GRUFUVVJFUzsKPiArCXZkcGEtPnBlbmRp
bmcucGF5bG9hZC51NjQgPQo+ICsJCXZkcGEtPm9wcy0+c3VwcG9ydGVkX2ZlYXR1cmVzKHZkcGEp
Owo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZob3N0X3NldF9vd25l
cihzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYpCj4gK3sKPiArCS8vIFRPRE8KPiArCXJldHVybiAw
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZob3N0X3Jlc2V0X293bmVyKHN0cnVjdCBtZGV2X2Rl
dmljZSAqbWRldikKPiArewo+ICsJLy8gVE9ETwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0
YXRpYyBpbnQgdmhvc3Rfc2V0X3N0YXRlKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwgdTY0ICpz
dGF0ZSkKPiArewo+ICsJc3RydWN0IHZkcGFfZGV2ICp2ZHBhOwo+ICsKPiArCXZkcGEgPSBtZGV2
X2dldF9kcnZkYXRhKG1kZXYpOwo+ICsJaWYgKCF2ZHBhKQo+ICsJCXJldHVybiAtRU5PREVWOwo+
ICsKPiArCWlmICgqc3RhdGUgPj0gVkhPU1RfREVWSUNFX1NfTUFYKQo+ICsJCXJldHVybiAtRUlO
VkFMOwo+ICsKPiArCWlmICh2ZHBhLT5zdGF0ZSA9PSAqc3RhdGUpCj4gKwkJcmV0dXJuIDA7Cj4g
Kwo+ICsJdmRwYS0+c3RhdGUgPSAqc3RhdGU7Cj4gKwo+ICsJc3dpdGNoICh2ZHBhLT5zdGF0ZSkg
ewo+ICsJY2FzZSBWSE9TVF9ERVZJQ0VfU19SVU5OSU5HOgo+ICsJCXZkcGEtPm9wcy0+c3RhcnQo
dmRwYSk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIFZIT1NUX0RFVklDRV9TX1NUT1BQRUQ6Cj4gKwkJ
dmRwYS0+b3BzLT5zdG9wKHZkcGEpOwo+ICsJCWJyZWFrOwo+ICsJfQo+ICsKPiArCXJldHVybiAw
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgc3NpemVfdCB2ZHBhX2hhbmRsZV9jb25maWdfd3JpdGUoc3Ry
dWN0IG1kZXZfZGV2aWNlICptZGV2LAo+ICsJCWNvbnN0IGNoYXIgX191c2VyICpidWYsIHNpemVf
dCBjb3VudCwgbG9mZl90ICpwcG9zKQo+ICt7Cj4gKwlzdHJ1Y3Qgdmhvc3RfdmZpb19vcCAqb3Ag
PSBOVUxMOwo+ICsJbG9mZl90IHBvcyA9ICpwcG9zOwo+ICsJbG9mZl90IG9mZnNldDsKPiArCWlu
dCByZXQ7Cj4gKwo+ICsJb2Zmc2V0ID0gVkRQQV9WRklPX1ZIT1NUX1JFR0lPTl9PRkZTRVQocG9z
KTsKPiArCWlmIChvZmZzZXQgIT0gMCkgewo+ICsJCXJldCA9IC1FSU5WQUw7Cj4gKwkJZ290byBv
dXQ7Cj4gKwl9Cj4gKwo+ICsJaWYgKGNvdW50IDwgVkhPU1RfVkZJT19PUF9IRFJfU0laRSkgewo+
ICsJCXJldCA9IC1FSU5WQUw7Cj4gKwkJZ290byBvdXQ7Cj4gKwl9Cj4gKwo+ICsJb3AgPSBremFs
bG9jKFZIT1NUX1ZGSU9fT1BfSERSX1NJWkUgKyBWSE9TVF9WRklPX09QX1BBWUxPQURfTUFYX1NJ
WkUsCj4gKwkJICAgICBHRlBfS0VSTkVMKTsKPiArCWlmIChvcCA9PSBOVUxMKSB7Cj4gKwkJcmV0
ID0gLUVOT01FTTsKPiArCQlnb3RvIG91dDsKPiArCX0KPiArCj4gKwlpZiAoY29weV9mcm9tX3Vz
ZXIob3AsIGJ1ZiwgVkhPU1RfVkZJT19PUF9IRFJfU0laRSkpIHsKPiArCQlyZXQgPSAtRUlOVkFM
Owo+ICsJCWdvdG8gb3V0X2ZyZWU7Cj4gKwl9Cj4gKwo+ICsJaWYgKG9wLT5zaXplID4gVkhPU1Rf
VkZJT19PUF9QQVlMT0FEX01BWF9TSVpFIHx8Cj4gKwkgICAgb3AtPnNpemUgKyBWSE9TVF9WRklP
X09QX0hEUl9TSVpFICE9IGNvdW50KSB7Cj4gKwkJcmV0ID0gLUVJTlZBTDsKPiArCQlnb3RvIG91
dF9mcmVlOwo+ICsJfQo+ICsKPiArCWlmIChjb3B5X2Zyb21fdXNlcigmb3AtPnBheWxvYWQsIGJ1
ZiArIFZIT1NUX1ZGSU9fT1BfSERSX1NJWkUsCj4gKwkJCSAgIG9wLT5zaXplKSkgewo+ICsJCXJl
dCA9IC1FRkFVTFQ7Cj4gKwkJZ290byBvdXRfZnJlZTsKPiArCX0KPiArCj4gKwlzd2l0Y2ggKG9w
LT5yZXF1ZXN0KSB7Cj4gKwljYXNlIFZIT1NUX1NFVF9MT0dfQkFTRToKPiArCQl2aG9zdF9zZXRf
bG9nX2Jhc2UobWRldiwgJm9wLT5wYXlsb2FkLnU2NCk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIFZI
T1NUX1NFVF9WUklOR19BRERSOgo+ICsJCXZob3N0X3NldF92cmluZ19hZGRyKG1kZXYsICZvcC0+
cGF5bG9hZC5hZGRyKTsKPiArCQlicmVhazsKPiArCWNhc2UgVkhPU1RfU0VUX1ZSSU5HX05VTToK
PiArCQl2aG9zdF9zZXRfdnJpbmdfbnVtKG1kZXYsICZvcC0+cGF5bG9hZC5zdGF0ZSk7Cj4gKwkJ
YnJlYWs7Cj4gKwljYXNlIFZIT1NUX1NFVF9WUklOR19CQVNFOgo+ICsJCXZob3N0X3NldF92cmlu
Z19iYXNlKG1kZXYsICZvcC0+cGF5bG9hZC5zdGF0ZSk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIFZI
T1NUX0dFVF9WUklOR19CQVNFOgo+ICsJCXZob3N0X2dldF92cmluZ19iYXNlKG1kZXYsICZvcC0+
cGF5bG9hZC5zdGF0ZSk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIFZIT1NUX1NFVF9GRUFUVVJFUzoK
PiArCQl2aG9zdF9zZXRfZmVhdHVyZXMobWRldiwgJm9wLT5wYXlsb2FkLnU2NCk7Cj4gKwkJYnJl
YWs7Cj4gKwljYXNlIFZIT1NUX0dFVF9GRUFUVVJFUzoKPiArCQl2aG9zdF9nZXRfZmVhdHVyZXMo
bWRldiwgJm9wLT5wYXlsb2FkLnU2NCk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIFZIT1NUX1NFVF9P
V05FUjoKPiArCQl2aG9zdF9zZXRfb3duZXIobWRldik7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIFZI
T1NUX1JFU0VUX09XTkVSOgo+ICsJCXZob3N0X3Jlc2V0X293bmVyKG1kZXYpOwo+ICsJCWJyZWFr
Owo+ICsJY2FzZSBWSE9TVF9ERVZJQ0VfU0VUX1NUQVRFOgo+ICsJCXZob3N0X3NldF9zdGF0ZSht
ZGV2LCAmb3AtPnBheWxvYWQudTY0KTsKPiArCQlicmVhazsKPiArCWRlZmF1bHQ6Cj4gKwkJYnJl
YWs7Cj4gKwl9Cj4gKwo+ICsJcmV0ID0gY291bnQ7Cj4gKwo+ICtvdXRfZnJlZToKPiArCWtmcmVl
KG9wKTsKPiArb3V0Ogo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3RhdGljIHNzaXplX3Qg
dmRwYV9oYW5kbGVfbm90aWZ5X3dyaXRlKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwKPiArCQlj
b25zdCBjaGFyIF9fdXNlciAqYnVmLCBzaXplX3QgY291bnQsIGxvZmZfdCAqcHBvcykKPiArewo+
ICsJc3RydWN0IHZkcGFfZGV2ICp2ZHBhOwo+ICsJaW50IHFpZDsKPiArCj4gKwl2ZHBhID0gbWRl
dl9nZXRfZHJ2ZGF0YShtZGV2KTsKPiArCWlmICghdmRwYSkKPiArCQlyZXR1cm4gLUVOT0RFVjsK
PiArCj4gKwlpZiAoY291bnQgPCBzaXplb2YocWlkKSkKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiAr
Cj4gKwlpZiAoY29weV9mcm9tX3VzZXIoJnFpZCwgYnVmLCBzaXplb2YocWlkKSkpCj4gKwkJcmV0
dXJuIC1FSU5WQUw7Cj4gKwo+ICsJdmRwYS0+b3BzLT5ub3RpZnkodmRwYSwgcWlkKTsKPiArCj4g
KwlyZXR1cm4gY291bnQ7Cj4gK30KPiArCj4gK3NzaXplX3QgdmRwYV93cml0ZShzdHJ1Y3QgbWRl
dl9kZXZpY2UgKm1kZXYsIGNvbnN0IGNoYXIgX191c2VyICpidWYsCj4gKwkJICAgc2l6ZV90IGNv
dW50LCBsb2ZmX3QgKnBwb3MpCj4gK3sKPiArCWludCBkb25lID0gMDsKPiArCXVuc2lnbmVkIGlu
dCBpbmRleDsKPiArCWxvZmZfdCBwb3MgPSAqcHBvczsKPiArCXN0cnVjdCB2ZHBhX2RldiAqdmRw
YTsKPiArCj4gKwl2ZHBhID0gbWRldl9nZXRfZHJ2ZGF0YShtZGV2KTsKPiArCWlmICghdmRwYSkK
PiArCQlyZXR1cm4gLUVOT0RFVjsKPiArCj4gKwltdXRleF9sb2NrKCZ2ZHBhLT5vcHNfbG9jayk7
Cj4gKwo+ICsJaW5kZXggPSBWRFBBX1ZGSU9fVkhPU1RfT0ZGU0VUX1RPX0lOREVYKHBvcyk7Cj4g
Kwo+ICsJc3dpdGNoIChpbmRleCkgewo+ICsJY2FzZSBWRklPX1ZIT1NUX0NPTkZJR19SRUdJT05f
SU5ERVg6Cj4gKwkJZG9uZSA9IHZkcGFfaGFuZGxlX2NvbmZpZ193cml0ZShtZGV2LCBidWYsIGNv
dW50LCBwcG9zKTsKPiArCQlicmVhazsKPiArCWNhc2UgVkZJT19WSE9TVF9OT1RJRllfUkVHSU9O
X0lOREVYOgo+ICsJCWRvbmUgPSB2ZHBhX2hhbmRsZV9ub3RpZnlfd3JpdGUobWRldiwgYnVmLCBj
b3VudCwgcHBvcyk7Cj4gKwkJYnJlYWs7Cj4gKwl9Cj4gKwo+ICsJaWYgKGRvbmUgPiAwKQo+ICsJ
CSpwcG9zICs9IGRvbmU7Cj4gKwo+ICsJbXV0ZXhfdW5sb2NrKCZ2ZHBhLT5vcHNfbG9jayk7Cj4g
Kwo+ICsJcmV0dXJuIGRvbmU7Cj4gK30KPiArRVhQT1JUX1NZTUJPTCh2ZHBhX3dyaXRlKTsKPiAr
Cj4gK3N0YXRpYyBpbnQgdmRwYV9nZXRfcmVnaW9uX2luZm8oc3RydWN0IG1kZXZfZGV2aWNlICpt
ZGV2LAo+ICsJCQkJc3RydWN0IHZmaW9fcmVnaW9uX2luZm8gKnJlZ2lvbl9pbmZvLAo+ICsJCQkJ
dTE2ICpjYXBfdHlwZV9pZCwgdm9pZCAqKmNhcF90eXBlKQo+ICt7Cj4gKwlzdHJ1Y3QgdmRwYV9k
ZXYgKnZkcGE7Cj4gKwl1MzIgaW5kZXgsIGZsYWdzOwo+ICsJdTY0IHNpemUgPSAwOwo+ICsKPiAr
CWlmICghbWRldikKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCj4gKwl2ZHBhID0gbWRldl9nZXRf
ZHJ2ZGF0YShtZGV2KTsKPiArCWlmICghdmRwYSkKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCj4g
KwlpbmRleCA9IHJlZ2lvbl9pbmZvLT5pbmRleDsKPiArCWlmIChpbmRleCA+PSBWRklPX1ZIT1NU
X05VTV9SRUdJT05TKQo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsKPiArCW11dGV4X2xvY2soJnZk
cGEtPm9wc19sb2NrKTsKPiArCj4gKwlmbGFncyA9IFZGSU9fUkVHSU9OX0lORk9fRkxBR19SRUFE
IHwgVkZJT19SRUdJT05fSU5GT19GTEFHX1dSSVRFOwo+ICsKPiArCXN3aXRjaCAoaW5kZXgpIHsK
PiArCWNhc2UgVkZJT19WSE9TVF9DT05GSUdfUkVHSU9OX0lOREVYOgo+ICsJCXNpemUgPSBWRFBB
X0NPTkZJR19TSVpFOwo+ICsJCWJyZWFrOwo+ICsJY2FzZSBWRklPX1ZIT1NUX05PVElGWV9SRUdJ
T05fSU5ERVg6Cj4gKwkJc2l6ZSA9ICh1NjQpdmRwYS0+bWF4X3ZyaW5ncyA8PCBQQUdFX1NISUZU
Owo+ICsJCWZsYWdzIHw9IFZGSU9fUkVHSU9OX0lORk9fRkxBR19NTUFQOwo+ICsJCWJyZWFrOwo+
ICsJZGVmYXVsdDoKPiArCQlzaXplID0gMDsKPiArCQlicmVhazsKPiArCX0KPiArCj4gKwlyZWdp
b25faW5mby0+c2l6ZSA9IHNpemU7Cj4gKwlyZWdpb25faW5mby0+b2Zmc2V0ID0gVkRQQV9WRklP
X1ZIT1NUX0lOREVYX1RPX09GRlNFVChpbmRleCk7Cj4gKwlyZWdpb25faW5mby0+ZmxhZ3MgPSBm
bGFnczsKPiArCW11dGV4X3VubG9jaygmdmRwYS0+b3BzX2xvY2spOwo+ICsJcmV0dXJuIDA7Cj4g
K30KPiArCj4gK3N0YXRpYyBpbnQgdmRwYV9yZXNldChzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYp
Cj4gK3sKPiArCXN0cnVjdCB2ZHBhX2RldiAqdmRwYTsKPiArCj4gKwlpZiAoIW1kZXYpCj4gKwkJ
cmV0dXJuIC1FSU5WQUw7Cj4gKwo+ICsJdmRwYSA9IG1kZXZfZ2V0X2RydmRhdGEobWRldik7Cj4g
KwlpZiAoIXZkcGEpCj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30K
PiArCj4gK3N0YXRpYyBpbnQgdmRwYV9nZXRfZGV2aWNlX2luZm8oc3RydWN0IG1kZXZfZGV2aWNl
ICptZGV2LAo+ICsJCQkJc3RydWN0IHZmaW9fZGV2aWNlX2luZm8gKmRldl9pbmZvKQo+ICt7Cj4g
KwlzdHJ1Y3QgdmRwYV9kZXYgKnZkcGE7Cj4gKwo+ICsJdmRwYSA9IG1kZXZfZ2V0X2RydmRhdGEo
bWRldik7Cj4gKwlpZiAoIXZkcGEpCj4gKwkJcmV0dXJuIC1FTk9ERVY7Cj4gKwo+ICsJZGV2X2lu
Zm8tPmZsYWdzID0gVkZJT19ERVZJQ0VfRkxBR1NfVkhPU1QgfCBWRklPX0RFVklDRV9SRVNFVDsK
PiArCWRldl9pbmZvLT5udW1fcmVnaW9ucyA9IFZGSU9fVkhPU1RfTlVNX1JFR0lPTlM7Cj4gKwlk
ZXZfaW5mby0+bnVtX2lycXMgPSBWRklPX1ZIT1NUX05VTV9JUlFTOwo+ICsKPiArCXJldHVybiAw
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZkcGFfZ2V0X2lycV9pbmZvKHN0cnVjdCBtZGV2X2Rl
dmljZSAqbWRldiwKPiArCQkJICAgICBzdHJ1Y3QgdmZpb19pcnFfaW5mbyAqaW5mbykKPiArewo+
ICsJc3RydWN0IHZkcGFfZGV2ICp2ZHBhOwo+ICsKPiArCXZkcGEgPSBtZGV2X2dldF9kcnZkYXRh
KG1kZXYpOwo+ICsJaWYgKCF2ZHBhKQo+ICsJCXJldHVybiAtRU5PREVWOwo+ICsKPiArCWlmIChp
bmZvLT5pbmRleCAhPSBWRklPX1ZIT1NUX1ZRX0lSUV9JTkRFWCkKPiArCQlyZXR1cm4gLUVJTlZB
TDsKPiArCj4gKwlpbmZvLT5mbGFncyA9IFZGSU9fSVJRX0lORk9fRVZFTlRGRDsKPiArCWluZm8t
PmNvdW50ID0gdmRwYS0+bWF4X3ZyaW5nczsKPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiAr
c3RhdGljIGludCB2ZHBhX3NldF9pcnFzKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldiwgdWludDMy
X3QgZmxhZ3MsCj4gKwkJCSB1bnNpZ25lZCBpbnQgaW5kZXgsIHVuc2lnbmVkIGludCBzdGFydCwK
PiArCQkJIHVuc2lnbmVkIGludCBjb3VudCwgdm9pZCAqZGF0YSkKPiArewo+ICsJc3RydWN0IHZk
cGFfZGV2ICp2ZHBhOwo+ICsJaW50ICpmZCA9IGRhdGEsIGk7Cj4gKwo+ICsJdmRwYSA9IG1kZXZf
Z2V0X2RydmRhdGEobWRldik7Cj4gKwlpZiAoIXZkcGEpCj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4g
Kwo+ICsJaWYgKGluZGV4ICE9IFZGSU9fVkhPU1RfVlFfSVJRX0lOREVYKQo+ICsJCXJldHVybiAt
RU5PVFNVUFA7Cj4gKwo+ICsJZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspCj4gKwkJdmRwYS0+
b3BzLT5zZXRfZXZlbnRmZCh2ZHBhLCBzdGFydCArIGksCj4gKwkJCShmbGFncyAmIFZGSU9fSVJR
X1NFVF9EQVRBX0VWRU5URkQpID8gZmRbaV0gOiAtMSk7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30K
PiArCj4gK2xvbmcgdmRwYV9pb2N0bChzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYsIHVuc2lnbmVk
IGludCBjbWQsIHVuc2lnbmVkIGxvbmcgYXJnKQo+ICt7Cj4gKwlpbnQgcmV0ID0gMDsKPiArCXVu
c2lnbmVkIGxvbmcgbWluc3o7Cj4gKwlzdHJ1Y3QgdmRwYV9kZXYgKnZkcGE7Cj4gKwo+ICsJaWYg
KCFtZGV2KQo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsKPiArCXZkcGEgPSBtZGV2X2dldF9kcnZk
YXRhKG1kZXYpOwo+ICsJaWYgKCF2ZHBhKQo+ICsJCXJldHVybiAtRU5PREVWOwo+ICsKPiArCXN3
aXRjaCAoY21kKSB7Cj4gKwljYXNlIFZGSU9fREVWSUNFX0dFVF9JTkZPOgo+ICsJewo+ICsJCXN0
cnVjdCB2ZmlvX2RldmljZV9pbmZvIGluZm87Cj4gKwo+ICsJCW1pbnN6ID0gb2Zmc2V0b2ZlbmQo
c3RydWN0IHZmaW9fZGV2aWNlX2luZm8sIG51bV9pcnFzKTsKPiArCj4gKwkJaWYgKGNvcHlfZnJv
bV91c2VyKCZpbmZvLCAodm9pZCBfX3VzZXIgKilhcmcsIG1pbnN6KSkKPiArCQkJcmV0dXJuIC1F
RkFVTFQ7Cj4gKwo+ICsJCWlmIChpbmZvLmFyZ3N6IDwgbWluc3opCj4gKwkJCXJldHVybiAtRUlO
VkFMOwo+ICsKPiArCQlyZXQgPSB2ZHBhX2dldF9kZXZpY2VfaW5mbyhtZGV2LCAmaW5mbyk7Cj4g
KwkJaWYgKHJldCkKPiArCQkJcmV0dXJuIHJldDsKPiArCj4gKwkJaWYgKGNvcHlfdG9fdXNlcigo
dm9pZCBfX3VzZXIgKilhcmcsICZpbmZvLCBtaW5zeikpCj4gKwkJCXJldHVybiAtRUZBVUxUOwo+
ICsKPiArCQlyZXR1cm4gMDsKPiArCX0KPiArCWNhc2UgVkZJT19ERVZJQ0VfR0VUX1JFR0lPTl9J
TkZPOgo+ICsJewo+ICsJCXN0cnVjdCB2ZmlvX3JlZ2lvbl9pbmZvIGluZm87Cj4gKwkJdTE2IGNh
cF90eXBlX2lkID0gMDsKPiArCQl2b2lkICpjYXBfdHlwZSA9IE5VTEw7Cj4gKwo+ICsJCW1pbnN6
ID0gb2Zmc2V0b2ZlbmQoc3RydWN0IHZmaW9fcmVnaW9uX2luZm8sIG9mZnNldCk7Cj4gKwo+ICsJ
CWlmIChjb3B5X2Zyb21fdXNlcigmaW5mbywgKHZvaWQgX191c2VyICopYXJnLCBtaW5zeikpCj4g
KwkJCXJldHVybiAtRUZBVUxUOwo+ICsKPiArCQlpZiAoaW5mby5hcmdzeiA8IG1pbnN6KQo+ICsJ
CQlyZXR1cm4gLUVJTlZBTDsKPiArCj4gKwkJcmV0ID0gdmRwYV9nZXRfcmVnaW9uX2luZm8obWRl
diwgJmluZm8sICZjYXBfdHlwZV9pZCwKPiArCQkJCQkgICAmY2FwX3R5cGUpOwo+ICsJCWlmIChy
ZXQpCj4gKwkJCXJldHVybiByZXQ7Cj4gKwo+ICsJCWlmIChjb3B5X3RvX3VzZXIoKHZvaWQgX191
c2VyICopYXJnLCAmaW5mbywgbWluc3opKQo+ICsJCQlyZXR1cm4gLUVGQVVMVDsKPiArCj4gKwkJ
cmV0dXJuIDA7Cj4gKwl9Cj4gKwljYXNlIFZGSU9fREVWSUNFX0dFVF9JUlFfSU5GTzoKPiArCXsK
PiArCQlzdHJ1Y3QgdmZpb19pcnFfaW5mbyBpbmZvOwo+ICsKPiArCQltaW5zeiA9IG9mZnNldG9m
ZW5kKHN0cnVjdCB2ZmlvX2lycV9pbmZvLCBjb3VudCk7Cj4gKwo+ICsJCWlmIChjb3B5X2Zyb21f
dXNlcigmaW5mbywgKHZvaWQgX191c2VyICopYXJnLCBtaW5zeikpCj4gKwkJCXJldHVybiAtRUZB
VUxUOwo+ICsKPiArCQlpZiAoaW5mby5hcmdzeiA8IG1pbnN6IHx8IGluZm8uaW5kZXggPj0gdmRw
YS0+bWF4X3ZyaW5ncykKPiArCQkJcmV0dXJuIC1FSU5WQUw7Cj4gKwo+ICsJCXJldCA9IHZkcGFf
Z2V0X2lycV9pbmZvKG1kZXYsICZpbmZvKTsKPiArCQlpZiAocmV0KQo+ICsJCQlyZXR1cm4gcmV0
Owo+ICsKPiArCQlpZiAoY29weV90b191c2VyKCh2b2lkIF9fdXNlciAqKWFyZywgJmluZm8sIG1p
bnN6KSkKPiArCQkJcmV0dXJuIC1FRkFVTFQ7Cj4gKwo+ICsJCXJldHVybiAwOwo+ICsJfQo+ICsJ
Y2FzZSBWRklPX0RFVklDRV9TRVRfSVJRUzoKPiArCXsKPiArCQlzdHJ1Y3QgdmZpb19pcnFfc2V0
IGhkcjsKPiArCQlzaXplX3QgZGF0YV9zaXplID0gMDsKPiArCQl1OCAqZGF0YSA9IE5VTEw7Cj4g
Kwo+ICsJCW1pbnN6ID0gb2Zmc2V0b2ZlbmQoc3RydWN0IHZmaW9faXJxX3NldCwgY291bnQpOwo+
ICsKPiArCQlpZiAoY29weV9mcm9tX3VzZXIoJmhkciwgKHZvaWQgX191c2VyICopYXJnLCBtaW5z
eikpCj4gKwkJCXJldHVybiAtRUZBVUxUOwo+ICsKPiArCQlyZXQgPSB2ZmlvX3NldF9pcnFzX3Zh
bGlkYXRlX2FuZF9wcmVwYXJlKCZoZHIsIHZkcGEtPm1heF92cmluZ3MsCj4gKwkJCQkJCQkgVkZJ
T19WSE9TVF9OVU1fSVJRUywKPiArCQkJCQkJCSAmZGF0YV9zaXplKTsKPiArCQlpZiAocmV0KQo+
ICsJCQlyZXR1cm4gcmV0Owo+ICsKPiArCQlpZiAoZGF0YV9zaXplKSB7Cj4gKwkJCWRhdGEgPSBt
ZW1kdXBfdXNlcigodm9pZCBfX3VzZXIgKikoYXJnICsgbWluc3opLAo+ICsJCQkJCSAgIGRhdGFf
c2l6ZSk7Cj4gKwkJCWlmIChJU19FUlIoZGF0YSkpCj4gKwkJCQlyZXR1cm4gUFRSX0VSUihkYXRh
KTsKPiArCQl9Cj4gKwo+ICsJCXJldCA9IHZkcGFfc2V0X2lycXMobWRldiwgaGRyLmZsYWdzLCBo
ZHIuaW5kZXgsIGhkci5zdGFydCwKPiArCQkJCWhkci5jb3VudCwgZGF0YSk7Cj4gKwo+ICsJCWtm
cmVlKGRhdGEpOwo+ICsJCXJldHVybiByZXQ7Cj4gKwl9Cj4gKwljYXNlIFZGSU9fREVWSUNFX1JF
U0VUOgo+ICsJCXJldHVybiB2ZHBhX3Jlc2V0KG1kZXYpOwo+ICsJfQo+ICsJcmV0dXJuIC1FTk9U
VFk7Cj4gK30KPiArRVhQT1JUX1NZTUJPTCh2ZHBhX2lvY3RsKTsKPiArCj4gK3N0YXRpYyBjb25z
dCBzdHJ1Y3Qgdm1fb3BlcmF0aW9uc19zdHJ1Y3QgdmRwYV9tbV9vcHMgPSB7Cj4gKyNpZmRlZiBD
T05GSUdfSEFWRV9JT1JFTUFQX1BST1QKPiArCS5hY2Nlc3MgPSBnZW5lcmljX2FjY2Vzc19waHlz
Cj4gKyNlbmRpZgo+ICt9Owo+ICsKPiAraW50IHZkcGFfbW1hcChzdHJ1Y3QgbWRldl9kZXZpY2Ug
Km1kZXYsIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKQo+ICt7Cj4gKwlzdHJ1Y3QgdmRwYV9k
ZXYgKnZkcGE7Cj4gKwl1bnNpZ25lZCBpbnQgaW5kZXg7Cj4gKwlsb2ZmX3QgcG9zOwo+ICsJbG9m
Zl90IG9mZnNldDsKPiArCWludCBxaWQsIHJldDsKPiArCj4gKwl2ZHBhID0gbWRldl9nZXRfZHJ2
ZGF0YShtZGV2KTsKPiArCWlmICghdmRwYSkKPiArCQlyZXR1cm4gLUVOT0RFVjsKPiArCj4gKwlw
b3MgPSB2bWEtPnZtX3Bnb2ZmIDw8IFBBR0VfU0hJRlQ7Cj4gKwo+ICsJaW5kZXggPSBWRFBBX1ZG
SU9fVkhPU1RfT0ZGU0VUX1RPX0lOREVYKHBvcyk7Cj4gKwlvZmZzZXQgPSBWRFBBX1ZGSU9fVkhP
U1RfUkVHSU9OX09GRlNFVChwb3MpOwo+ICsKPiArCXFpZCA9IG9mZnNldCA+PiBQQUdFX1NISUZU
Owo+ICsKPiArCWlmICh2bWEtPnZtX2VuZCA8IHZtYS0+dm1fc3RhcnQpCj4gKwkJcmV0dXJuIC1F
SU5WQUw7Cj4gKwlpZiAoKHZtYS0+dm1fZmxhZ3MgJiBWTV9TSEFSRUQpID09IDApCj4gKwkJcmV0
dXJuIC1FSU5WQUw7Cj4gKwlpZiAoaW5kZXggIT0gVkZJT19WSE9TVF9OT1RJRllfUkVHSU9OX0lO
REVYKQo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsJaWYgKHFpZCA8IDAgfHwgcWlkID49IHZkcGEt
Pm1heF92cmluZ3MpCj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwo+ICsJaWYgKHZtYS0+dm1fZW5k
IC0gdm1hLT52bV9zdGFydCA+IFBBR0VfU0laRSkKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCj4g
KwlpZiAodmRwYS0+b3BzLT5nZXRfbm90aWZ5X2FkZHIgPT0gTlVMTCkKPiArCQlyZXR1cm4gLUVO
T1RTVVBQOwo+ICsKPiArCW11dGV4X2xvY2soJnZkcGEtPm9wc19sb2NrKTsKPiArCj4gKwl2bWEt
PnZtX29wcyA9ICZ2ZHBhX21tX29wczsKPiArCXZtYS0+dm1fcGFnZV9wcm90ID0gcGdwcm90X25v
bmNhY2hlZCh2bWEtPnZtX3BhZ2VfcHJvdCk7Cj4gKwo+ICsJdm1hLT52bV9wZ29mZiA9IHZkcGEt
Pm9wcy0+Z2V0X25vdGlmeV9hZGRyKHZkcGEsIHFpZCkgPj4gUEFHRV9TSElGVDsKPiArCj4gKwly
ZXQgPSByZW1hcF9wZm5fcmFuZ2Uodm1hLCB2bWEtPnZtX3N0YXJ0LCB2bWEtPnZtX3Bnb2ZmLAo+
ICsJCQl2bWEtPnZtX2VuZCAtIHZtYS0+dm1fc3RhcnQsIHZtYS0+dm1fcGFnZV9wcm90KTsKPiAr
Cj4gKwltdXRleF91bmxvY2soJnZkcGEtPm9wc19sb2NrKTsKPiArCj4gKwlyZXR1cm4gcmV0Owo+
ICt9Cj4gK0VYUE9SVF9TWU1CT0wodmRwYV9tbWFwKTsKPiArCj4gK2ludCB2ZHBhX29wZW4oc3Ry
dWN0IG1kZXZfZGV2aWNlICptZGV2KQo+ICt7Cj4gKwlyZXR1cm4gMDsKPiArfQo+ICtFWFBPUlRf
U1lNQk9MKHZkcGFfb3Blbik7Cj4gKwo+ICt2b2lkIHZkcGFfY2xvc2Uoc3RydWN0IG1kZXZfZGV2
aWNlICptZGV2KQo+ICt7Cj4gK30KPiArRVhQT1JUX1NZTUJPTCh2ZHBhX2Nsb3NlKTsKPiArCj4g
K01PRFVMRV9WRVJTSU9OKCIwLjAuMCIpOwo+ICtNT0RVTEVfTElDRU5TRSgiR1BMIHYyIik7Cj4g
K01PRFVMRV9ERVNDUklQVElPTigiSGFyZHdhcmUgdmhvc3QgYWNjZWxlcmF0b3IgYWJzdHJhY3Rp
b24iKTsKPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC92ZHBhX21kZXYuaCBiL2luY2x1ZGUv
bGludXgvdmRwYV9tZGV2LmgKPiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAw
MDAwMC4uNGJiZGY3ZTJlNzEyCj4gLS0tIC9kZXYvbnVsbAo+ICsrKyBiL2luY2x1ZGUvbGludXgv
dmRwYV9tZGV2LmgKPiBAQCAtMCwwICsxLDcyIEBACj4gKy8vIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wCj4gKy8qCj4gKyAqIENvcHlyaWdodCAoQykgMjAxOC0yMDE5IEludGVsIENv
cnBvcmF0aW9uLgo+ICsgKi8KPiArCj4gKyNpZm5kZWYgVkRQQV9NREVWX0gKPiArI2RlZmluZSBW
RFBBX01ERVZfSAo+ICsKPiArc3RydWN0IG1kZXZfZGV2aWNlOwo+ICtzdHJ1Y3QgdmRwYV9kZXY7
Cj4gKwo+ICsvKgo+ICsgKiBYWFg6IEFueSBjb21tZW50cyBhYm91dCB0aGUgdkRQQSBBUEkgZGVz
aWduIGZvciBkcml2ZXJzCj4gKyAqICAgICAgd291bGQgYmUgYXBwcmVjaWF0ZWQhCj4gKyAqLwo+
ICsKPiArdHlwZWRlZiBpbnQgKCp2ZHBhX3N0YXJ0X2RldmljZV90KShzdHJ1Y3QgdmRwYV9kZXYg
KnZkcGEpOwo+ICt0eXBlZGVmIGludCAoKnZkcGFfc3RvcF9kZXZpY2VfdCkoc3RydWN0IHZkcGFf
ZGV2ICp2ZHBhKTsKPiArdHlwZWRlZiBpbnQgKCp2ZHBhX3NldF9mZWF0dXJlc190KShzdHJ1Y3Qg
dmRwYV9kZXYgKnZkcGEpOwo+ICt0eXBlZGVmIGludCAoKnZkcGFfc2V0X2V2ZW50ZmRfdCkoc3Ry
dWN0IHZkcGFfZGV2ICp2ZHBhLCBpbnQgcXVldWVfaWR4LCBpbnQgZmQpOwo+ICt0eXBlZGVmIHU2
NCAoKnZkcGFfc3VwcG9ydGVkX2ZlYXR1cmVzX3QpKHN0cnVjdCB2ZHBhX2RldiAqdmRwYSk7Cj4g
K3R5cGVkZWYgdm9pZCAoKnZkcGFfbm90aWZ5X2RldmljZV90KShzdHJ1Y3QgdmRwYV9kZXYgKnZk
cGEsIGludCBxdWV1ZV9pZHgpOwo+ICt0eXBlZGVmIHU2NCAoKnZkcGFfZ2V0X25vdGlmeV9hZGRy
X3QpKHN0cnVjdCB2ZHBhX2RldiAqdmRwYSwgaW50IHF1ZXVlX2lkeCk7Cj4gKwo+ICtzdHJ1Y3Qg
dmRwYV9kZXZpY2Vfb3BzIHsKPiArCXZkcGFfc3RhcnRfZGV2aWNlX3QJCXN0YXJ0Owo+ICsJdmRw
YV9zdG9wX2RldmljZV90CQlzdG9wOwo+ICsJdmRwYV9zZXRfZXZlbnRmZF90CQlzZXRfZXZlbnRm
ZDsKPiArCXZkcGFfc3VwcG9ydGVkX2ZlYXR1cmVzX3QJc3VwcG9ydGVkX2ZlYXR1cmVzOwo+ICsJ
dmRwYV9ub3RpZnlfZGV2aWNlX3QJCW5vdGlmeTsKPiArCXZkcGFfZ2V0X25vdGlmeV9hZGRyX3QJ
CWdldF9ub3RpZnlfYWRkcjsKPiArCXZkcGFfc2V0X2ZlYXR1cmVzX3QJCXNldF9mZWF0dXJlczsK
PiArfTsKPiArCj4gK3N0cnVjdCB2ZHBhX3ZyaW5nX2luZm8gewo+ICsJdTY0IGRlc2NfdXNlcl9h
ZGRyOwo+ICsJdTY0IHVzZWRfdXNlcl9hZGRyOwo+ICsJdTY0IGF2YWlsX3VzZXJfYWRkcjsKPiAr
CXU2NCBsb2dfZ3Vlc3RfYWRkcjsKPiArCXUxNiBzaXplOwo+ICsJdTE2IGJhc2U7Cj4gK307Cj4g
Kwo+ICtzdHJ1Y3QgdmRwYV9kZXYgewo+ICsJc3RydWN0IG1kZXZfZGV2aWNlICptZGV2Owo+ICsJ
c3RydWN0IG11dGV4IG9wc19sb2NrOwo+ICsJaW50IG5yX3ZyaW5nOwo+ICsJdTY0IGZlYXR1cmVz
Owo+ICsJdTY0IHN0YXRlOwo+ICsJYm9vbCBwZW5kaW5nX3JlcGx5Owo+ICsJc3RydWN0IHZob3N0
X3ZmaW9fb3AgcGVuZGluZzsKPiArCWNvbnN0IHN0cnVjdCB2ZHBhX2RldmljZV9vcHMgKm9wczsK
PiArCXZvaWQgKnByaXZhdGU7Cj4gKwlpbnQgbWF4X3ZyaW5nczsKPiArCXVpbnQ2NF90IGxvZ19i
YXNlOwo+ICsJdWludDY0X3QgbG9nX3NpemU7Cj4gKwlzdHJ1Y3QgdmRwYV92cmluZ19pbmZvIHZy
aW5nX2luZm9bMF07Cj4gK307Cj4gKwo+ICtzdHJ1Y3QgdmRwYV9kZXYgKnZkcGFfYWxsb2Moc3Ry
dWN0IG1kZXZfZGV2aWNlICptZGV2LCB2b2lkICpwcml2YXRlLAo+ICsJCQkgICAgaW50IG1heF92
cmluZ3MpOwo+ICt2b2lkIHZkcGFfZnJlZShzdHJ1Y3QgdmRwYV9kZXYgKnZkcGEpOwo+ICtzc2l6
ZV90IHZkcGFfcmVhZChzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYsIGNoYXIgX191c2VyICpidWYs
Cj4gKwkJICBzaXplX3QgY291bnQsIGxvZmZfdCAqcHBvcyk7Cj4gK3NzaXplX3QgdmRwYV93cml0
ZShzdHJ1Y3QgbWRldl9kZXZpY2UgKm1kZXYsIGNvbnN0IGNoYXIgX191c2VyICpidWYsCj4gKwkJ
ICAgc2l6ZV90IGNvdW50LCBsb2ZmX3QgKnBwb3MpOwo+ICtsb25nIHZkcGFfaW9jdGwoc3RydWN0
IG1kZXZfZGV2aWNlICptZGV2LCB1bnNpZ25lZCBpbnQgY21kLCB1bnNpZ25lZCBsb25nIGFyZyk7
Cj4gK2ludCB2ZHBhX21tYXAoc3RydWN0IG1kZXZfZGV2aWNlICptZGV2LCBzdHJ1Y3Qgdm1fYXJl
YV9zdHJ1Y3QgKnZtYSk7Cj4gK2ludCB2ZHBhX29wZW4oc3RydWN0IG1kZXZfZGV2aWNlICptZGV2
KTsKPiArdm9pZCB2ZHBhX2Nsb3NlKHN0cnVjdCBtZGV2X2RldmljZSAqbWRldik7Cj4gKwo+ICsj
ZW5kaWYgLyogVkRQQV9NREVWX0ggKi8KPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xpbnV4
L3ZmaW8uaCBiL2luY2x1ZGUvdWFwaS9saW51eC92ZmlvLmgKPiBpbmRleCA4ZjEwNzQ4ZGFjNzku
LjZjNTcxOGFiN2VlYiAxMDA2NDQKPiAtLS0gYS9pbmNsdWRlL3VhcGkvbGludXgvdmZpby5oCj4g
KysrIGIvaW5jbHVkZS91YXBpL2xpbnV4L3ZmaW8uaAo+IEBAIC0yMDEsNiArMjAxLDcgQEAgc3Ry
dWN0IHZmaW9fZGV2aWNlX2luZm8gewo+ICAgI2RlZmluZSBWRklPX0RFVklDRV9GTEFHU19BTUJB
ICAoMSA8PCAzKQkvKiB2ZmlvLWFtYmEgZGV2aWNlICovCj4gICAjZGVmaW5lIFZGSU9fREVWSUNF
X0ZMQUdTX0NDVwkoMSA8PCA0KQkvKiB2ZmlvLWNjdyBkZXZpY2UgKi8KPiAgICNkZWZpbmUgVkZJ
T19ERVZJQ0VfRkxBR1NfQVAJKDEgPDwgNSkJLyogdmZpby1hcCBkZXZpY2UgKi8KPiArI2RlZmlu
ZSBWRklPX0RFVklDRV9GTEFHU19WSE9TVAkoMSA8PCA2KQkvKiB2ZmlvLXZob3N0IGRldmljZSAq
Lwo+ICAgCV9fdTMyCW51bV9yZWdpb25zOwkvKiBNYXggcmVnaW9uIGluZGV4ICsgMSAqLwo+ICAg
CV9fdTMyCW51bV9pcnFzOwkvKiBNYXggSVJRIGluZGV4ICsgMSAqLwo+ICAgfTsKPiBAQCAtMjE3
LDYgKzIxOCw3IEBAIHN0cnVjdCB2ZmlvX2RldmljZV9pbmZvIHsKPiAgICNkZWZpbmUgVkZJT19E
RVZJQ0VfQVBJX0FNQkFfU1RSSU5HCQkidmZpby1hbWJhIgo+ICAgI2RlZmluZSBWRklPX0RFVklD
RV9BUElfQ0NXX1NUUklORwkJInZmaW8tY2N3Igo+ICAgI2RlZmluZSBWRklPX0RFVklDRV9BUElf
QVBfU1RSSU5HCQkidmZpby1hcCIKPiArI2RlZmluZSBWRklPX0RFVklDRV9BUElfVkhPU1RfU1RS
SU5HCQkidmZpby12aG9zdCIKPiAgIAo+ICAgLyoqCj4gICAgKiBWRklPX0RFVklDRV9HRVRfUkVH
SU9OX0lORk8gLSBfSU9XUihWRklPX1RZUEUsIFZGSU9fQkFTRSArIDgsCj4gQEAgLTU3Myw2ICs1
NzUsMjMgQEAgZW51bSB7Cj4gICAJVkZJT19DQ1dfTlVNX0lSUVMKPiAgIH07Cj4gICAKPiArLyoK
PiArICogVGhlIHZmaW8tdmhvc3QgYnVzIGRyaXZlciBtYWtlcyB1c2Ugb2YgdGhlIGZvbGxvd2lu
ZyBmaXhlZCByZWdpb24gYW5kCj4gKyAqIElSUSBpbmRleCBtYXBwaW5nLiBVbmltcGxlbWVudGVk
IHJlZ2lvbnMgcmV0dXJuIGEgc2l6ZSBvZiB6ZXJvLgo+ICsgKiBVbmltcGxlbWVudGVkIElSUSB0
eXBlcyByZXR1cm4gYSBjb3VudCBvZiB6ZXJvLgo+ICsgKi8KPiArCj4gK2VudW0gewo+ICsJVkZJ
T19WSE9TVF9DT05GSUdfUkVHSU9OX0lOREVYLAo+ICsJVkZJT19WSE9TVF9OT1RJRllfUkVHSU9O
X0lOREVYLAo+ICsJVkZJT19WSE9TVF9OVU1fUkVHSU9OUwo+ICt9Owo+ICsKPiArZW51bSB7Cj4g
KwlWRklPX1ZIT1NUX1ZRX0lSUV9JTkRFWCwKPiArCVZGSU9fVkhPU1RfTlVNX0lSUVMKPiArfTsK
PiArCj4gICAvKioKPiAgICAqIFZGSU9fREVWSUNFX0dFVF9QQ0lfSE9UX1JFU0VUX0lORk8gLSBf
SU9SVyhWRklPX1RZUEUsIFZGSU9fQkFTRSArIDEyLAo+ICAgICoJCQkJCSAgICAgIHN0cnVjdCB2
ZmlvX3BjaV9ob3RfcmVzZXRfaW5mbykKPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xpbnV4
L3Zob3N0LmggYi9pbmNsdWRlL3VhcGkvbGludXgvdmhvc3QuaAo+IGluZGV4IDQwZDAyOGVlZDY0
NS4uYWQ5NWI5MGM1YzA1IDEwMDY0NAo+IC0tLSBhL2luY2x1ZGUvdWFwaS9saW51eC92aG9zdC5o
Cj4gKysrIGIvaW5jbHVkZS91YXBpL2xpbnV4L3Zob3N0LmgKPiBAQCAtMTE2LDQgKzExNiwyOSBA
QAo+ICAgI2RlZmluZSBWSE9TVF9WU09DS19TRVRfR1VFU1RfQ0lECV9JT1coVkhPU1RfVklSVElP
LCAweDYwLCBfX3U2NCkKPiAgICNkZWZpbmUgVkhPU1RfVlNPQ0tfU0VUX1JVTk5JTkcJCV9JT1co
VkhPU1RfVklSVElPLCAweDYxLCBpbnQpCj4gICAKPiArLyogVkhPU1RfREVWSUNFIHNwZWNpZmlj
IGRlZmluZXMgKi8KPiArCj4gKyNkZWZpbmUgVkhPU1RfREVWSUNFX1NFVF9TVEFURSBfSU9XKFZI
T1NUX1ZJUlRJTywgMHg3MCwgX191NjQpCj4gKwo+ICsjZGVmaW5lIFZIT1NUX0RFVklDRV9TX1NU
T1BQRUQgMAo+ICsjZGVmaW5lIFZIT1NUX0RFVklDRV9TX1JVTk5JTkcgMQo+ICsjZGVmaW5lIFZI
T1NUX0RFVklDRV9TX01BWCAgICAgMgo+ICsKPiArc3RydWN0IHZob3N0X3ZmaW9fb3Agewo+ICsJ
X191NjQgcmVxdWVzdDsKPiArCV9fdTMyIGZsYWdzOwo+ICsJLyogRmxhZyB2YWx1ZXM6ICovCj4g
KyNkZWZpbmUgVkhPU1RfVkZJT19ORUVEX1JFUExZIDB4MSAvKiBXaGV0aGVyIG5lZWQgcmVwbHkg
Ki8KPiArCV9fdTMyIHNpemU7Cj4gKwl1bmlvbiB7Cj4gKwkJX191NjQgdTY0Owo+ICsJCXN0cnVj
dCB2aG9zdF92cmluZ19zdGF0ZSBzdGF0ZTsKPiArCQlzdHJ1Y3Qgdmhvc3RfdnJpbmdfYWRkciBh
ZGRyOwo+ICsJfSBwYXlsb2FkOwo+ICt9Owo+ICsKPiArI2RlZmluZSBWSE9TVF9WRklPX09QX0hE
Ul9TSVpFIFwKPiArCQkoKHVuc2lnbmVkIGxvbmcpJigoc3RydWN0IHZob3N0X3ZmaW9fb3AgKilO
VUxMKS0+cGF5bG9hZCkKPiArI2RlZmluZSBWSE9TVF9WRklPX09QX1BBWUxPQURfTUFYX1NJWkUg
MTAyNCAvKiBGSVhNRSBUQkQgKi8KPiArCj4gICAjZW5kaWYKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZp
cnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGlu
dXhmb3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
