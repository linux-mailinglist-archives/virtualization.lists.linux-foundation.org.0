Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
	by mail.lfdr.de (Postfix) with ESMTPS id 2AE061978F7
	for <lists.virtualization@lfdr.de>; Mon, 30 Mar 2020 12:20:41 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by whitealder.osuosl.org (Postfix) with ESMTP id B2DDC87ABA;
	Mon, 30 Mar 2020 10:20:39 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id ASM+UBbVjGCD; Mon, 30 Mar 2020 10:20:32 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by whitealder.osuosl.org (Postfix) with ESMTP id 0B67C87CDC;
	Mon, 30 Mar 2020 10:20:14 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id E9C35C07FF;
	Mon, 30 Mar 2020 10:20:13 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 9A262C07FF
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:58 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by whitealder.osuosl.org (Postfix) with ESMTP id 86D2C8757F
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:58 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id kRc085YvqSwL
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:54 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by whitealder.osuosl.org (Postfix) with ESMTPS id 99B6087A3D
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:52 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 71C10305D3D1; Mon, 30 Mar 2020 13:13:01 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 4CE67305B7A5;
 Mon, 30 Mar 2020 13:13:01 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v8 75/81] KVM: introspection: add KVMI_EVENT_PF
Date: Mon, 30 Mar 2020 13:13:02 +0300
Message-Id: <20200330101308.21702-76-alazar@bitdefender.com>
In-Reply-To: <20200330101308.21702-1-alazar@bitdefender.com>
References: <20200330101308.21702-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBldmVudCBp
cyBzZW50IHdoZW4gYSAjUEYgb2NjdXJzIGR1ZSB0byBhIGZhaWxlZCBwZXJtaXNzaW9uIGNoZWNr
CmluIHRoZSBzaGFkb3cgcGFnZSB0YWJsZXMsIGZvciBhIHBhZ2UgaW4gd2hpY2ggdGhlIGludHJv
c3BlY3Rpb24gdG9vbApoYXMgc2hvd24gaW50ZXJlc3QuCgpTaWduZWQtb2ZmLWJ5OiBNaWhhaSBE
b27Im3UgPG1kb250dUBiaXRkZWZlbmRlci5jb20+CkNvLWRldmVsb3BlZC1ieTogQWRhbGJlcnQg
TGF6xINyIDxhbGF6YXJAYml0ZGVmZW5kZXIuY29tPgpTaWduZWQtb2ZmLWJ5OiBBZGFsYmVydCBM
YXrEg3IgPGFsYXphckBiaXRkZWZlbmRlci5jb20+Ci0tLQogRG9jdW1lbnRhdGlvbi92aXJ0L2t2
bS9rdm1pLnJzdCAgICAgICAgICAgICAgIHwgIDUwICsrKysrCiBhcmNoL3g4Ni9pbmNsdWRlL2Fz
bS9rdm1pX2hvc3QuaCAgICAgICAgICAgICAgfCAgIDEgKwogYXJjaC94ODYva3ZtL2t2bWkuYyAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDI3ICsrKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2
bWkuaCAgICAgICAgICAgICAgICAgICAgIHwgIDEwICsKIC4uLi90ZXN0aW5nL3NlbGZ0ZXN0cy9r
dm0veDg2XzY0L2t2bWlfdGVzdC5jICB8ICA3NCArKysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0
aW9uL2t2bWkuYyAgICAgICAgICAgICAgICAgfCAyMDUgKysrKysrKysrKysrKysrKysrCiB2aXJ0
L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmggICAgICAgICAgICAgfCAgIDQgKwogdmlydC9r
dm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jICAgICAgICAgICAgIHwgIDE4ICsrCiA4IGZpbGVz
IGNoYW5nZWQsIDM4OSBpbnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi92
aXJ0L2t2bS9rdm1pLnJzdCBiL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKaW5kZXgg
ZmU2YzcxZjg0ZGQ3Li4zOTUyYWVmOWFmOWMgMTAwNjQ0Ci0tLSBhL0RvY3VtZW50YXRpb24vdmly
dC9rdm0va3ZtaS5yc3QKKysrIGIvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdApAQCAt
NTUxLDYgKzU1MSw3IEBAIHRoZSBmb2xsb3dpbmcgZXZlbnRzOjoKIAlLVk1JX0VWRU5UX0RFU0NS
SVBUT1IKIAlLVk1JX0VWRU5UX0hZUEVSQ0FMTAogCUtWTUlfRVZFTlRfTVNSCisJS1ZNSV9FVkVO
VF9QRgogCUtWTUlfRVZFTlRfWFNFVEJWCiAKIFdoZW4gYW4gZXZlbnQgaXMgZW5hYmxlZCwgdGhl
IGludHJvc3BlY3Rpb24gdG9vbCBpcyBub3RpZmllZCBhbmQKQEAgLTEyODIsMyArMTI4Myw1MiBA
QCByZWdpc3RlciAoc2VlICoqS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTKiopLgogCiBgYGt2bWlf
ZXZlbnRgYCwgdGhlIE1TUiBudW1iZXIsIHRoZSBvbGQgdmFsdWUgYW5kIHRoZSBuZXcgdmFsdWUg
YXJlCiBzZW50IHRvIHRoZSBpbnRyb3NwZWN0aW9uIHRvb2wuIFRoZSAqQ09OVElOVUUqIGFjdGlv
biB3aWxsIHNldCB0aGUgYGBuZXdfdmFsYGAuCisKKzEwLiBLVk1JX0VWRU5UX1BGCistLS0tLS0t
LS0tLS0tLS0tLQorCis6QXJjaGl0ZWN0dXJlczogeDg2Cis6VmVyc2lvbnM6ID49IDEKKzpBY3Rp
b25zOiBDT05USU5VRSwgQ1JBU0gsIFJFVFJZCis6UGFyYW1ldGVyczoKKworOjoKKworCXN0cnVj
dCBrdm1pX2V2ZW50OworCXN0cnVjdCBrdm1pX2V2ZW50X3BmIHsKKwkJX191NjQgZ3ZhOworCQlf
X3U2NCBncGE7CisJCV9fdTggYWNjZXNzOworCQlfX3U4IHBhZGRpbmcxOworCQlfX3UxNiBwYWRk
aW5nMjsKKwkJX191MzIgcGFkZGluZzM7CisJfTsKKworOlJldHVybnM6CisKKzo6CisKKwlzdHJ1
Y3Qga3ZtaV92Y3B1X2hkcjsKKwlzdHJ1Y3Qga3ZtaV9ldmVudF9yZXBseTsKKworVGhpcyBldmVu
dCBpcyBzZW50IHdoZW4gYSBoeXBlcnZpc29yIHBhZ2UgZmF1bHQgb2NjdXJzIGR1ZSB0byBhIGZh
aWxlZAorcGVybWlzc2lvbiBjaGVjayBpbiB0aGUgc2hhZG93IHBhZ2UgdGFibGVzLCB0aGUgaW50
cm9zcGVjdGlvbiBoYXMgYmVlbgorZW5hYmxlZCBmb3IgdGhpcyBldmVudCAoc2VlICpLVk1JX1ZQ
VUNfQ09OVFJPTF9FVkVOVFMqKSBhbmQgdGhlIGV2ZW50IHdhcworZ2VuZXJhdGVkIGZvciBhIHBh
Z2UgaW4gd2hpY2ggdGhlIGludHJvc3BlY3Rpb24gdG9vbCBoYXMgc2hvd24gaW50ZXJlc3QKKyhp
ZS4gaGFzIHByZXZpb3VzbHkgdG91Y2hlZCBpdCBieSBhZGp1c3RpbmcgdGhlIHNwdGUgcGVybWlz
c2lvbnMpLgorCitUaGUgc2hhZG93IHBhZ2UgdGFibGVzIGNhbiBiZSB1c2VkIGJ5IHRoZSBpbnRy
b3NwZWN0aW9uIHRvb2wgdG8gZ3VhcmFudGVlCit0aGUgcHVycG9zZSBvZiBjb2RlIGFyZWFzIGlu
c2lkZSB0aGUgZ3Vlc3QgKGNvZGUsIHJvZGF0YSwgc3RhY2ssIGhlYXAKK2V0Yy4pIEVhY2ggYXR0
ZW1wdCBhdCBhbiBvcGVyYXRpb24gdW5maXR0aW5nIGZvciBhIGNlcnRhaW4gbWVtb3J5CityYW5n
ZSAoZWcuIGV4ZWN1dGUgY29kZSBpbiBoZWFwKSB0cmlnZ2VycyBhIHBhZ2UgZmF1bHQgYW5kIGdp
dmVzIHRoZQoraW50cm9zcGVjdGlvbiB0b29sIHRoZSBjaGFuY2UgdG8gYXVkaXQgdGhlIGNvZGUg
YXR0ZW1wdGluZyB0aGUgb3BlcmF0aW9uLgorCitgYGt2bWlfZXZlbnRgYCwgZ3Vlc3QgdmlydHVh
bCBhZGRyZXNzIChvciAweGZmZmZmZmZmL1VOTUFQUEVEX0dWQSksCitndWVzdCBwaHlzaWNhbCBh
ZGRyZXNzIGFuZCB0aGUgYWNjZXNzIGZsYWdzIChlZy4gS1ZNSV9QQUdFX0FDQ0VTU19SKQorYXJl
IHNlbnQgdG8gdGhlIGludHJvc3BlY3Rpb24gdG9vbC4KKworVGhlICpDT05USU5VRSogYWN0aW9u
IHdpbGwgY29udGludWUgdGhlIHBhZ2UgZmF1bHQgaGFuZGxpbmcgdmlhIGVtdWxhdGlvbi4KKwor
VGhlICpSRVRSWSogYWN0aW9uIGlzIHVzZWQgYnkgdGhlIGludHJvc3BlY3Rpb24gdG9vbCB0byBy
ZXRyeSB0aGUKK2V4ZWN1dGlvbiBvZiB0aGUgY3VycmVudCBpbnN0cnVjdGlvbiwgdXN1YWxseSBi
ZWNhdXNlIGl0IGNoYW5nZWQgdGhlCitpbnN0cnVjdGlvbiBwb2ludGVyIG9yIHRoZSBwYWdlIHJl
c3RyaWN0aW9ucy4KZGlmZiAtLWdpdCBhL2FyY2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5o
IGIvYXJjaC94ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmgKaW5kZXggNDQ2ZjZjM2RkZjRlLi44
ZDBjM2VkMzAyMWIgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5o
CisrKyBiL2FyY2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5oCkBAIC0zOSw2ICszOSw3IEBA
IHN0cnVjdCBrdm1fdmNwdV9hcmNoX2ludHJvc3BlY3Rpb24gewogfTsKIAogc3RydWN0IGt2bV9h
cmNoX2ludHJvc3BlY3Rpb24geworCXN0cnVjdCBrdm1fcGFnZV90cmFja19ub3RpZmllcl9ub2Rl
IGtwdG5fbm9kZTsKIH07CiAKICNkZWZpbmUgU0xPVFNfU0laRSBCSVRTX1RPX0xPTkdTKEtWTV9N
RU1fU0xPVFNfTlVNKQpkaWZmIC0tZ2l0IGEvYXJjaC94ODYva3ZtL2t2bWkuYyBiL2FyY2gveDg2
L2t2bS9rdm1pLmMKaW5kZXggMzI4NzgzZDllMzQxLi4wNjgyOWUxYzU3MzcgMTAwNjQ0Ci0tLSBh
L2FyY2gveDg2L2t2bS9rdm1pLmMKKysrIGIvYXJjaC94ODYva3ZtL2t2bWkuYwpAQCAtMTE3OCwz
ICsxMTc4LDMwIEBAIGludCBrdm1pX2FyY2hfY21kX3NldF9wYWdlX2FjY2VzcyhzdHJ1Y3Qga3Zt
X2ludHJvc3BlY3Rpb24gKmt2bWksCiAJcmV0dXJuIGVjOwogfQogCitib29sIGt2bWlfYXJjaF9w
Zl9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIGdwYV90IGdwYSwgZ3ZhX3QgZ3ZhLAorCQkJ
dTggYWNjZXNzKQoreworCWJvb2wgcmV0ID0gZmFsc2U7CisJdTMyIGFjdGlvbjsKKworCWFjdGlv
biA9IGt2bWlfbXNnX3NlbmRfcGYodmNwdSwgZ3BhLCBndmEsIGFjY2Vzcyk7CisKKwlzd2l0Y2gg
KGFjdGlvbikgeworCWNhc2UgS1ZNSV9FVkVOVF9BQ1RJT05fQ09OVElOVUU6CisJCXJldCA9IHRy
dWU7CisJCWJyZWFrOworCWNhc2UgS1ZNSV9FVkVOVF9BQ1RJT05fUkVUUlk6CisJCWJyZWFrOwor
CWRlZmF1bHQ6CisJCWt2bWlfaGFuZGxlX2NvbW1vbl9ldmVudF9hY3Rpb25zKHZjcHUtPmt2bSwg
YWN0aW9uLCAiUEYiKTsKKwl9CisKKwlyZXR1cm4gcmV0OworfQorCitib29sIGt2bWlfYXJjaF9w
Zl9vZl9pbnRlcmVzdChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCit7CisJcmV0dXJuIGt2bV94ODZf
b3BzLT5zcHRfZmF1bHQodmNwdSkgJiYKKwkgICAgICAha3ZtX3g4Nl9vcHMtPmdwdF90cmFuc2xh
dGlvbl9mYXVsdCh2Y3B1KTsKK30KKwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2
bWkuaCBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKaW5kZXggZGEwY2UzZTQxY2RkLi5kZjE5
MjkzNmIwMTcgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKKysrIGIvaW5j
bHVkZS91YXBpL2xpbnV4L2t2bWkuaApAQCAtNTUsNiArNTUsNyBAQCBlbnVtIHsKIAlLVk1JX0VW
RU5UX1hTRVRCViAgICAgPSA2LAogCUtWTUlfRVZFTlRfREVTQ1JJUFRPUiA9IDcsCiAJS1ZNSV9F
VkVOVF9NU1IgICAgICAgID0gOCwKKwlLVk1JX0VWRU5UX1BGICAgICAgICAgPSA5LAogCiAJS1ZN
SV9OVU1fRVZFTlRTCiB9OwpAQCAtMTkxLDQgKzE5MiwxMyBAQCBzdHJ1Y3Qga3ZtaV9ldmVudF9y
ZXBseSB7CiAJX191MzIgcGFkZGluZzI7CiB9OwogCitzdHJ1Y3Qga3ZtaV9ldmVudF9wZiB7CisJ
X191NjQgZ3ZhOworCV9fdTY0IGdwYTsKKwlfX3U4IGFjY2VzczsKKwlfX3U4IHBhZGRpbmcxOwor
CV9fdTE2IHBhZGRpbmcyOworCV9fdTMyIHBhZGRpbmczOworfTsKKwogI2VuZGlmIC8qIF9VQVBJ
X19MSU5VWF9LVk1JX0ggKi8KZGlmZiAtLWdpdCBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2
bS94ODZfNjQva3ZtaV90ZXN0LmMgYi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0
L2t2bWlfdGVzdC5jCmluZGV4IGMyYWIyOGY2NDI3Zi4uNDhjYjU0NjIzNGMwIDEwMDY0NAotLS0g
YS90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCisrKyBiL3Rv
b2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKQEAgLTQyLDYgKzQy
LDExIEBAIHN0cnVjdCB2Y3B1X3JlcGx5IHsKIAlzdHJ1Y3Qga3ZtaV9ldmVudF9yZXBseSByZXBs
eTsKIH07CiAKK3N0cnVjdCBwZl9ldiB7CisJc3RydWN0IGt2bWlfZXZlbnQgY29tbW9uOworCXN0
cnVjdCBrdm1pX2V2ZW50X3BmIHBmOworfTsKKwogc3RydWN0IHZjcHVfd29ya2VyX2RhdGEgewog
CXN0cnVjdCBrdm1fdm0gKnZtOwogCWludCB2Y3B1X2lkOwpAQCAtNTEsNiArNTYsMTAgQEAgc3Ry
dWN0IHZjcHVfd29ya2VyX2RhdGEgewogCWJvb2wgcmVzdGFydF9vbl9zaHV0ZG93bjsKIH07CiAK
K3R5cGVkZWYgdm9pZCAoKmZjdF9wZl9ldmVudCkoc3RydWN0IGt2bV92bSAqdm0sIHN0cnVjdCBr
dm1pX21zZ19oZHIgKmhkciwKKwkJCQlzdHJ1Y3QgcGZfZXYgKmV2LAorCQkJCXN0cnVjdCB2Y3B1
X3JlcGx5ICpycGwpOworCiBlbnVtIHsKIAlHVUVTVF9URVNUX05PT1AgPSAwLAogCUdVRVNUX1RF
U1RfQlAsCkBAIC01OCw2ICs2Nyw3IEBAIGVudW0gewogCUdVRVNUX1RFU1RfREVTQ1JJUFRPUiwK
IAlHVUVTVF9URVNUX0hZUEVSQ0FMTCwKIAlHVUVTVF9URVNUX01TUiwKKwlHVUVTVF9URVNUX1BG
LAogCUdVRVNUX1RFU1RfWFNFVEJWLAogfTsKIApAQCAtMTA3LDYgKzExNywxMSBAQCBzdGF0aWMg
dm9pZCBndWVzdF9tc3JfdGVzdCh2b2lkKQogCXdybXNyKE1TUl9NSVNDX0ZFQVRVUkVTX0VOQUJM
RVMsIG1zcik7CiB9CiAKK3N0YXRpYyB2b2lkIGd1ZXN0X3BmX3Rlc3Qodm9pZCkKK3sKKwkqKCh1
aW50OF90ICopdGVzdF9ndmEpID0gUkVBRF9PTkNFKHRlc3Rfd3JpdGVfcGF0dGVybik7Cit9CisK
IC8qIGZyb20gZnB1L2ludGVybmFsLmggKi8KIHN0YXRpYyB1NjQgeGdldGJ2KHUzMiBpbmRleCkK
IHsKQEAgLTE2Nyw2ICsxODIsOSBAQCBzdGF0aWMgdm9pZCBndWVzdF9jb2RlKHZvaWQpCiAJCWNh
c2UgR1VFU1RfVEVTVF9NU1I6CiAJCQlndWVzdF9tc3JfdGVzdCgpOwogCQkJYnJlYWs7CisJCWNh
c2UgR1VFU1RfVEVTVF9QRjoKKwkJCWd1ZXN0X3BmX3Rlc3QoKTsKKwkJCWJyZWFrOwogCQljYXNl
IEdVRVNUX1RFU1RfWFNFVEJWOgogCQkJZ3Vlc3RfeHNldGJ2X3Rlc3QoKTsKIAkJCWJyZWFrOwpA
QCAtMTU5MCw2ICsxNjA4LDYxIEBAIHN0YXRpYyB2b2lkIHRlc3RfY21kX3ZtX3NldF9wYWdlX2Fj
Y2VzcyhzdHJ1Y3Qga3ZtX3ZtICp2bSkKIAlzZXRfcGFnZV9hY2Nlc3MoZ3BhLCBmdWxsX2FjY2Vz
cyk7CiB9CiAKK3N0YXRpYyB2b2lkIHRlc3RfcGYoc3RydWN0IGt2bV92bSAqdm0sIGZjdF9wZl9l
dmVudCBjYmspCit7CisJX191MTYgZXZlbnRfaWQgPSBLVk1JX0VWRU5UX1BGOworCXN0cnVjdCB2
Y3B1X3dvcmtlcl9kYXRhIGRhdGEgPSB7CisJCS52bSA9IHZtLAorCQkudmNwdV9pZCA9IFZDUFVf
SUQsCisJCS50ZXN0X2lkID0gR1VFU1RfVEVTVF9QRiwKKwl9OworCXN0cnVjdCBrdm1pX21zZ19o
ZHIgaGRyOworCXN0cnVjdCB2Y3B1X3JlcGx5IHJwbCA9IHt9OworCXB0aHJlYWRfdCB2Y3B1X3Ro
cmVhZDsKKwlzdHJ1Y3QgcGZfZXYgZXY7CisKKwlzZXRfcGFnZV9hY2Nlc3ModGVzdF9ncGEsIEtW
TUlfUEFHRV9BQ0NFU1NfUik7CisKKwllbmFibGVfdmNwdV9ldmVudCh2bSwgZXZlbnRfaWQpOwor
CisJbmV3X3Rlc3Rfd3JpdGVfcGF0dGVybih2bSk7CisKKwl2Y3B1X3RocmVhZCA9IHN0YXJ0X3Zj
cHVfd29ya2VyKCZkYXRhKTsKKworCXJlY2VpdmVfZXZlbnQoJmhkciwgJmV2LmNvbW1vbiwgc2l6
ZW9mKGV2KSwgZXZlbnRfaWQpOworCisJREVCVUcoIlBGIGV2ZW50LCBncGEgMHglbGx4LCBndmEg
MHglbGx4LCBhY2Nlc3MgMHgleFxuIiwKKwkJZXYucGYuZ3BhLCBldi5wZi5ndmEsIGV2LnBmLmFj
Y2Vzcyk7CisKKwlURVNUX0FTU0VSVChldi5wZi5ncGEgPT0gdGVzdF9ncGEgJiYgZXYucGYuZ3Zh
ID09IHRlc3RfZ3ZhLAorCQkiVW5leHBlY3RlZCAjUEYgZXZlbnQsIGdwYSAweCVsbHggKGV4cGVu
ZGVkIDB4JWxseCksIGd2YSAweCVsbHggKGV4cGVjdGVkIDB4JWxseClcbiIsCisJCWV2LnBmLmdw
YSwgdGVzdF9ncGEsIGV2LnBmLmd2YSwgdGVzdF9ndmEpOworCisJY2JrKHZtLCAmaGRyLCAmZXYs
ICZycGwpOworCisJc3RvcF92Y3B1X3dvcmtlcih2Y3B1X3RocmVhZCwgJmRhdGEpOworCisJVEVT
VF9BU1NFUlQoKigodWludDhfdCAqKXRlc3RfaHZhKSA9PSB0ZXN0X3dyaXRlX3BhdHRlcm4sCisJ
CSJXcml0ZSBmYWlsZWQsIGV4cGVjdGVkIDB4JXgsIHJlc3VsdCAweCV4XG4iLAorCQl0ZXN0X3dy
aXRlX3BhdHRlcm4sICooKHVpbnQ4X3QgKil0ZXN0X2h2YSkpOworCisJZGlzYWJsZV92Y3B1X2V2
ZW50KHZtLCBldmVudF9pZCk7Cit9CisKK3N0YXRpYyB2b2lkIGNia190ZXN0X2V2ZW50X3BmKHN0
cnVjdCBrdm1fdm0gKnZtLCBzdHJ1Y3Qga3ZtaV9tc2dfaGRyICpoZHIsCisJCQkJc3RydWN0IHBm
X2V2ICpldiwgc3RydWN0IHZjcHVfcmVwbHkgKnJwbCkKK3sKKwlzZXRfcGFnZV9hY2Nlc3ModGVz
dF9ncGEsIEtWTUlfUEFHRV9BQ0NFU1NfUiB8IEtWTUlfUEFHRV9BQ0NFU1NfVyk7CisKKwlyZXBs
eV90b19ldmVudChoZHIsICZldi0+Y29tbW9uLCBLVk1JX0VWRU5UX0FDVElPTl9SRVRSWSwKKwkJ
CXJwbCwgc2l6ZW9mKCpycGwpKTsKK30KKworc3RhdGljIHZvaWQgdGVzdF9ldmVudF9wZihzdHJ1
Y3Qga3ZtX3ZtICp2bSkKK3sKKwl0ZXN0X3BmKHZtLCBjYmtfdGVzdF9ldmVudF9wZik7Cit9CisK
IHN0YXRpYyB2b2lkIHRlc3RfaW50cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkKIHsKIAlz
cmFuZG9tKHRpbWUoMCkpOwpAQCAtMTYyMSw2ICsxNjk0LDcgQEAgc3RhdGljIHZvaWQgdGVzdF9p
bnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQogCXRlc3RfZXZlbnRfZGVzY3JpcHRvcih2
bSk7CiAJdGVzdF9jbWRfdmNwdV9jb250cm9sX21zcih2bSk7CiAJdGVzdF9jbWRfdm1fc2V0X3Bh
Z2VfYWNjZXNzKHZtKTsKKwl0ZXN0X2V2ZW50X3BmKHZtKTsKIAogCXVuaG9va19pbnRyb3NwZWN0
aW9uKHZtKTsKIH0KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jIGIv
dmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKaW5kZXggMjYyOWQzZDFmNjhjLi5lMTNiNTU4
NTZlOWMgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCisrKyBiL3Zp
cnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCkBAIC0xOCw2ICsxOCwyMSBAQCBERUNMQVJFX0JJ
VE1BUChLdm1pX2tub3duX2V2ZW50cywgS1ZNSV9OVU1fRVZFTlRTKTsKIERFQ0xBUkVfQklUTUFQ
KEt2bWlfa25vd25fdm1fZXZlbnRzLCBLVk1JX05VTV9FVkVOVFMpOwogREVDTEFSRV9CSVRNQVAo
S3ZtaV9rbm93bl92Y3B1X2V2ZW50cywgS1ZNSV9OVU1fRVZFTlRTKTsKIAorc3RhdGljIGJvb2wg
a3ZtaV90cmFja19wcmVyZWFkKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgZ3BhX3QgZ3BhLCBndmFf
dCBndmEsCisJCQkgICAgICAgaW50IGJ5dGVzLAorCQkJICAgICAgIHN0cnVjdCBrdm1fcGFnZV90
cmFja19ub3RpZmllcl9ub2RlICpub2RlKTsKK3N0YXRpYyBib29sIGt2bWlfdHJhY2tfcHJld3Jp
dGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsIGd2YV90IGd2YSwKKwkJCQljb25z
dCB1OCAqbmV3LCBpbnQgYnl0ZXMsCisJCQkJc3RydWN0IGt2bV9wYWdlX3RyYWNrX25vdGlmaWVy
X25vZGUgKm5vZGUpOworc3RhdGljIGJvb2wga3ZtaV90cmFja19wcmVleGVjKHN0cnVjdCBrdm1f
dmNwdSAqdmNwdSwgZ3BhX3QgZ3BhLCBndmFfdCBndmEsCisJCQkgICAgICAgc3RydWN0IGt2bV9w
YWdlX3RyYWNrX25vdGlmaWVyX25vZGUgKm5vZGUpOworc3RhdGljIHZvaWQga3ZtaV90cmFja19j
cmVhdGVfc2xvdChzdHJ1Y3Qga3ZtICprdm0sCisJCQkJICAgc3RydWN0IGt2bV9tZW1vcnlfc2xv
dCAqc2xvdCwKKwkJCQkgICB1bnNpZ25lZCBsb25nIG5wYWdlcywKKwkJCQkgICBzdHJ1Y3Qga3Zt
X3BhZ2VfdHJhY2tfbm90aWZpZXJfbm9kZSAqbm9kZSk7CitzdGF0aWMgdm9pZCBrdm1pX3RyYWNr
X2ZsdXNoX3Nsb3Qoc3RydWN0IGt2bSAqa3ZtLCBzdHJ1Y3Qga3ZtX21lbW9yeV9zbG90ICpzbG90
LAorCQkJCSAgc3RydWN0IGt2bV9wYWdlX3RyYWNrX25vdGlmaWVyX25vZGUgKm5vZGUpOworCiBz
dGF0aWMgc3RydWN0IGttZW1fY2FjaGUgKm1zZ19jYWNoZTsKIHN0YXRpYyBzdHJ1Y3Qga21lbV9j
YWNoZSAqam9iX2NhY2hlOwogc3RhdGljIHN0cnVjdCBrbWVtX2NhY2hlICpyYWRpeF9jYWNoZTsK
QEAgLTk0LDYgKzEwOSw3IEBAIHN0YXRpYyB2b2lkIHNldHVwX2tub3duX2V2ZW50cyh2b2lkKQog
CXNldF9iaXQoS1ZNSV9FVkVOVF9IWVBFUkNBTEwsIEt2bWlfa25vd25fdmNwdV9ldmVudHMpOwog
CXNldF9iaXQoS1ZNSV9FVkVOVF9NU1IsIEt2bWlfa25vd25fdmNwdV9ldmVudHMpOwogCXNldF9i
aXQoS1ZNSV9FVkVOVF9QQVVTRV9WQ1BVLCBLdm1pX2tub3duX3ZjcHVfZXZlbnRzKTsKKwlzZXRf
Yml0KEtWTUlfRVZFTlRfUEYsIEt2bWlfa25vd25fdmNwdV9ldmVudHMpOwogCXNldF9iaXQoS1ZN
SV9FVkVOVF9UUkFQLCBLdm1pX2tub3duX3ZjcHVfZXZlbnRzKTsKIAlzZXRfYml0KEtWTUlfRVZF
TlRfWFNFVEJWLCBLdm1pX2tub3duX3ZjcHVfZXZlbnRzKTsKIApAQCAtMjg4LDYgKzMwNCwxMiBA
QCBhbGxvY19rdm1pKHN0cnVjdCBrdm0gKmt2bSwgY29uc3Qgc3RydWN0IGt2bV9pbnRyb3NwZWN0
aW9uX2hvb2sgKmhvb2spCiAJCQlHRlBfS0VSTkVMICYgfl9fR0ZQX0RJUkVDVF9SRUNMQUlNKTsK
IAlyd2xvY2tfaW5pdCgma3ZtaS0+YWNjZXNzX3RyZWVfbG9jayk7CiAKKwlrdm1pLT5hcmNoLmtw
dG5fbm9kZS50cmFja19wcmVyZWFkID0ga3ZtaV90cmFja19wcmVyZWFkOworCWt2bWktPmFyY2gu
a3B0bl9ub2RlLnRyYWNrX3ByZXdyaXRlID0ga3ZtaV90cmFja19wcmV3cml0ZTsKKwlrdm1pLT5h
cmNoLmtwdG5fbm9kZS50cmFja19wcmVleGVjID0ga3ZtaV90cmFja19wcmVleGVjOworCWt2bWkt
PmFyY2gua3B0bl9ub2RlLnRyYWNrX2NyZWF0ZV9zbG90ID0ga3ZtaV90cmFja19jcmVhdGVfc2xv
dDsKKwlrdm1pLT5hcmNoLmtwdG5fbm9kZS50cmFja19mbHVzaF9zbG90ID0ga3ZtaV90cmFja19m
bHVzaF9zbG90OworCiAJa3ZtX2Zvcl9lYWNoX3ZjcHUoaSwgdmNwdSwga3ZtKSB7CiAJCWludCBl
cnIgPSBjcmVhdGVfdmNwdWkodmNwdSk7CiAKQEAgLTMxOSw2ICszNDEsOCBAQCBzdGF0aWMgdm9p
ZCBfX2t2bWlfdW5ob29rKHN0cnVjdCBrdm0gKmt2bSkKIAlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rp
b24gKmt2bWkgPSBLVk1JKGt2bSk7CiAKIAl3YWl0X2Zvcl9jb21wbGV0aW9uX2tpbGxhYmxlKCZr
dm0tPmt2bWlfY29tcGxldGUpOworCisJa3ZtX3BhZ2VfdHJhY2tfdW5yZWdpc3Rlcl9ub3RpZmll
cihrdm0sICZrdm1pLT5hcmNoLmtwdG5fbm9kZSk7CiAJa3ZtaV9zb2NrX3B1dChrdm1pKTsKIH0K
IApAQCAtMzY2LDYgKzM5MCw4IEBAIHN0YXRpYyBpbnQgX19rdm1pX2hvb2soc3RydWN0IGt2bSAq
a3ZtLAogCWlmICgha3ZtaV9zb2NrX2dldChrdm1pLCBob29rLT5mZCkpCiAJCXJldHVybiAtRUlO
VkFMOwogCisJa3ZtX3BhZ2VfdHJhY2tfcmVnaXN0ZXJfbm90aWZpZXIoa3ZtLCAma3ZtaS0+YXJj
aC5rcHRuX25vZGUpOworCiAJcmV0dXJuIDA7CiB9CiAKQEAgLTEwOTIsMyArMTExOCwxODIgQEAg
aW50IGt2bWlfY21kX3NldF9wYWdlX2FjY2VzcyhzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2
bWksIHU2NCBncGEsIHU4IGFjY2VzcykKIAlyZXR1cm4ga3ZtaV9zZXRfZ2ZuX2FjY2Vzcyhrdm1p
LT5rdm0sIGdmbiwgYWNjZXNzKTsKIH0KIAorc3RhdGljIGludCBrdm1pX2dldF9nZm5fYWNjZXNz
KHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSwgY29uc3QgZ2ZuX3QgZ2ZuLAorCQkJICAg
ICAgIHU4ICphY2Nlc3MpCit7CisJc3RydWN0IGt2bWlfbWVtX2FjY2VzcyAqbTsKKworCXJlYWRf
bG9jaygma3ZtaS0+YWNjZXNzX3RyZWVfbG9jayk7CisJbSA9IF9fa3ZtaV9nZXRfZ2ZuX2FjY2Vz
cyhrdm1pLCBnZm4pOworCWlmIChtKQorCQkqYWNjZXNzID0gbS0+YWNjZXNzOworCXJlYWRfdW5s
b2NrKCZrdm1pLT5hY2Nlc3NfdHJlZV9sb2NrKTsKKworCXJldHVybiBtID8gMCA6IC0xOworfQor
CitzdGF0aWMgYm9vbCBrdm1pX3Jlc3RyaWN0ZWRfYWNjZXNzKHN0cnVjdCBrdm1faW50cm9zcGVj
dGlvbiAqa3ZtaSwgZ3BhX3QgZ3BhLAorCQkJCSAgIHU4IGFjY2VzcykKK3sKKwl1OCBhbGxvd2Vk
X2FjY2VzczsKKwlpbnQgZXJyOworCisJZXJyID0ga3ZtaV9nZXRfZ2ZuX2FjY2Vzcyhrdm1pLCBn
cGFfdG9fZ2ZuKGdwYSksICZhbGxvd2VkX2FjY2Vzcyk7CisJaWYgKGVycikKKwkJcmV0dXJuIGZh
bHNlOworCisJLyoKKwkgKiBXZSB3YW50IHRvIGJlIG5vdGlmaWVkIG9ubHkgZm9yIHZpb2xhdGlv
bnMgaW52b2x2aW5nIGFjY2VzcworCSAqIGJpdHMgdGhhdCB3ZSd2ZSBzcGVjaWZpY2FsbHkgY2xl
YXJlZAorCSAqLworCWlmIChhY2Nlc3MgJiAofmFsbG93ZWRfYWNjZXNzKSkKKwkJcmV0dXJuIHRy
dWU7CisKKwlyZXR1cm4gZmFsc2U7Cit9CisKK3N0YXRpYyBib29sIGlzX3BmX29mX2ludGVyZXN0
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgZ3BhX3QgZ3BhLCB1OCBhY2Nlc3MpCit7CisJc3RydWN0
IGt2bSAqa3ZtID0gdmNwdS0+a3ZtOworCisJaWYgKCFrdm1pX2FyY2hfcGZfb2ZfaW50ZXJlc3Qo
dmNwdSkpCisJCXJldHVybiBmYWxzZTsKKworCXJldHVybiBrdm1pX3Jlc3RyaWN0ZWRfYWNjZXNz
KEtWTUkoa3ZtKSwgZ3BhLCBhY2Nlc3MpOworfQorCitzdGF0aWMgYm9vbCBrdm1pX3BmX2V2ZW50
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgZ3BhX3QgZ3BhLCBndmFfdCBndmEsCisJCQkgIGludCBh
Y2Nlc3MpCit7CisJaWYgKCFpc19wZl9vZl9pbnRlcmVzdCh2Y3B1LCBncGEsIGFjY2VzcykpCisJ
CXJldHVybiB0cnVlOworCisJcmV0dXJuIGt2bWlfYXJjaF9wZl9ldmVudCh2Y3B1LCBncGEsIGd2
YSwgYWNjZXNzKTsKK30KKworc3RhdGljIGJvb2wga3ZtaV90cmFja19wcmVyZWFkKHN0cnVjdCBr
dm1fdmNwdSAqdmNwdSwgZ3BhX3QgZ3BhLCBndmFfdCBndmEsCisJCQkgICAgICAgaW50IGJ5dGVz
LAorCQkJICAgICAgIHN0cnVjdCBrdm1fcGFnZV90cmFja19ub3RpZmllcl9ub2RlICpub2RlKQor
eworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaTsKKwlib29sIHJldCA9IHRydWU7CisK
Kwlrdm1pID0ga3ZtaV9nZXQodmNwdS0+a3ZtKTsKKwlpZiAoIWt2bWkpCisJCXJldHVybiB0cnVl
OworCisJaWYgKGlzX2V2ZW50X2VuYWJsZWQodmNwdSwgS1ZNSV9FVkVOVF9QRikpCisJCXJldCA9
IGt2bWlfcGZfZXZlbnQodmNwdSwgZ3BhLCBndmEsIEtWTUlfUEFHRV9BQ0NFU1NfUik7CisKKwlr
dm1pX3B1dCh2Y3B1LT5rdm0pOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGJvb2wga3Zt
aV90cmFja19wcmV3cml0ZShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIGdwYV90IGdwYSwgZ3ZhX3Qg
Z3ZhLAorCQkJCWNvbnN0IHU4ICpuZXcsIGludCBieXRlcywKKwkJCQlzdHJ1Y3Qga3ZtX3BhZ2Vf
dHJhY2tfbm90aWZpZXJfbm9kZSAqbm9kZSkKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24g
Kmt2bWk7CisJYm9vbCByZXQgPSB0cnVlOworCisJa3ZtaSA9IGt2bWlfZ2V0KHZjcHUtPmt2bSk7
CisJaWYgKCFrdm1pKQorCQlyZXR1cm4gdHJ1ZTsKKworCWlmIChpc19ldmVudF9lbmFibGVkKHZj
cHUsIEtWTUlfRVZFTlRfUEYpKQorCQlyZXQgPSBrdm1pX3BmX2V2ZW50KHZjcHUsIGdwYSwgZ3Zh
LCBLVk1JX1BBR0VfQUNDRVNTX1cpOworCisJa3ZtaV9wdXQodmNwdS0+a3ZtKTsKKworCXJldHVy
biByZXQ7Cit9CisKK3N0YXRpYyBib29sIGt2bWlfdHJhY2tfcHJlZXhlYyhzdHJ1Y3Qga3ZtX3Zj
cHUgKnZjcHUsIGdwYV90IGdwYSwgZ3ZhX3QgZ3ZhLAorCQkJICAgICAgIHN0cnVjdCBrdm1fcGFn
ZV90cmFja19ub3RpZmllcl9ub2RlICpub2RlKQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlv
biAqa3ZtaTsKKwlib29sIHJldCA9IHRydWU7CisKKwlrdm1pID0ga3ZtaV9nZXQodmNwdS0+a3Zt
KTsKKwlpZiAoIWt2bWkpCisJCXJldHVybiB0cnVlOworCisJaWYgKGlzX2V2ZW50X2VuYWJsZWQo
dmNwdSwgS1ZNSV9FVkVOVF9QRikpCisJCXJldCA9IGt2bWlfcGZfZXZlbnQodmNwdSwgZ3BhLCBn
dmEsIEtWTUlfUEFHRV9BQ0NFU1NfWCk7CisKKwlrdm1pX3B1dCh2Y3B1LT5rdm0pOworCisJcmV0
dXJuIHJldDsKK30KKworc3RhdGljIHZvaWQga3ZtaV90cmFja19jcmVhdGVfc2xvdChzdHJ1Y3Qg
a3ZtICprdm0sCisJCQkJICAgc3RydWN0IGt2bV9tZW1vcnlfc2xvdCAqc2xvdCwKKwkJCQkgICB1
bnNpZ25lZCBsb25nIG5wYWdlcywKKwkJCQkgICBzdHJ1Y3Qga3ZtX3BhZ2VfdHJhY2tfbm90aWZp
ZXJfbm9kZSAqbm9kZSkKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWk7CisJZ2Zu
X3Qgc3RhcnQgPSBzbG90LT5iYXNlX2dmbjsKKwljb25zdCBnZm5fdCBlbmQgPSBzdGFydCArIG5w
YWdlczsKKwlpbnQgaWR4OworCisJa3ZtaSA9IGt2bWlfZ2V0KGt2bSk7CisJaWYgKCFrdm1pKQor
CQlyZXR1cm47CisKKwlpZHggPSBzcmN1X3JlYWRfbG9jaygma3ZtLT5zcmN1KTsKKwlzcGluX2xv
Y2soJmt2bS0+bW11X2xvY2spOworCXJlYWRfbG9jaygma3ZtaS0+YWNjZXNzX3RyZWVfbG9jayk7
CisKKwl3aGlsZSAoc3RhcnQgPCBlbmQpIHsKKwkJc3RydWN0IGt2bWlfbWVtX2FjY2VzcyAqbTsK
KworCQltID0gX19rdm1pX2dldF9nZm5fYWNjZXNzKGt2bWksIHN0YXJ0KTsKKwkJaWYgKG0pCisJ
CQlrdm1pX2FyY2hfdXBkYXRlX3BhZ2VfdHJhY2tpbmcoa3ZtLCBzbG90LCBtKTsKKwkJc3RhcnQr
KzsKKwl9CisKKwlyZWFkX3VubG9jaygma3ZtaS0+YWNjZXNzX3RyZWVfbG9jayk7CisJc3Bpbl91
bmxvY2soJmt2bS0+bW11X2xvY2spOworCXNyY3VfcmVhZF91bmxvY2soJmt2bS0+c3JjdSwgaWR4
KTsKKworCWt2bWlfcHV0KGt2bSk7Cit9CisKK3N0YXRpYyB2b2lkIGt2bWlfdHJhY2tfZmx1c2hf
c2xvdChzdHJ1Y3Qga3ZtICprdm0sIHN0cnVjdCBrdm1fbWVtb3J5X3Nsb3QgKnNsb3QsCisJCQkJ
ICBzdHJ1Y3Qga3ZtX3BhZ2VfdHJhY2tfbm90aWZpZXJfbm9kZSAqbm9kZSkKK3sKKwlzdHJ1Y3Qg
a3ZtX2ludHJvc3BlY3Rpb24gKmt2bWk7CisJZ2ZuX3Qgc3RhcnQgPSBzbG90LT5iYXNlX2dmbjsK
Kwljb25zdCBnZm5fdCBlbmQgPSBzdGFydCArIHNsb3QtPm5wYWdlczsKKwlpbnQgaWR4OworCisJ
a3ZtaSA9IGt2bWlfZ2V0KGt2bSk7CisJaWYgKCFrdm1pKQorCQlyZXR1cm47CisKKwlpZHggPSBz
cmN1X3JlYWRfbG9jaygma3ZtLT5zcmN1KTsKKwlzcGluX2xvY2soJmt2bS0+bW11X2xvY2spOwor
CXdyaXRlX2xvY2soJmt2bWktPmFjY2Vzc190cmVlX2xvY2spOworCisJd2hpbGUgKHN0YXJ0IDwg
ZW5kKSB7CisJCXN0cnVjdCBrdm1pX21lbV9hY2Nlc3MgKm07CisKKwkJbSA9IF9fa3ZtaV9nZXRf
Z2ZuX2FjY2Vzcyhrdm1pLCBzdGFydCk7CisJCWlmIChtKSB7CisJCQl1OCBwcmV2X2FjY2VzcyA9
IG0tPmFjY2VzczsKKworCQkJbS0+YWNjZXNzID0gZnVsbF9hY2Nlc3M7CisJCQlrdm1pX2FyY2hf
dXBkYXRlX3BhZ2VfdHJhY2tpbmcoa3ZtLCBzbG90LCBtKTsKKwkJCW0tPmFjY2VzcyA9IHByZXZf
YWNjZXNzOworCQl9CisJCXN0YXJ0Kys7CisJfQorCisJd3JpdGVfdW5sb2NrKCZrdm1pLT5hY2Nl
c3NfdHJlZV9sb2NrKTsKKwlzcGluX3VubG9jaygma3ZtLT5tbXVfbG9jayk7CisJc3JjdV9yZWFk
X3VubG9jaygma3ZtLT5zcmN1LCBpZHgpOworCisJa3ZtaV9wdXQoa3ZtKTsKK30KZGlmZiAtLWdp
dCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCBiL3ZpcnQva3ZtL2ludHJvc3Bl
Y3Rpb24va3ZtaV9pbnQuaAppbmRleCAyMzdiYjA4M2NmMDEuLjYzOWQxNDgxMTkzMyAxMDA2NDQK
LS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCisrKyBiL3ZpcnQva3ZtL2lu
dHJvc3BlY3Rpb24va3ZtaV9pbnQuaApAQCAtNDksNiArNDksNyBAQCBpbnQga3ZtaV9tc2dfc2Vu
ZF91bmhvb2soc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pKTsKIHUzMiBrdm1pX21zZ19z
ZW5kX3ZjcHVfcGF1c2Uoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIHUzMiBrdm1pX21zZ19zZW5k
X2h5cGVyY2FsbChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwogdTMyIGt2bWlfbXNnX3NlbmRfYnAo
c3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1NjQgZ3BhLCB1OCBpbnNuX2xlbik7Cit1MzIga3ZtaV9t
c2dfc2VuZF9wZihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU2NCBncGEsIHU2NCBndmEsIHU4IGFj
Y2Vzcyk7CiAKIC8qIGt2bWkuYyAqLwogdm9pZCAqa3ZtaV9tc2dfYWxsb2Modm9pZCk7CkBAIC0x
MjMsNSArMTI0LDggQEAgdm9pZCBrdm1pX2FyY2hfdXBkYXRlX3BhZ2VfdHJhY2tpbmcoc3RydWN0
IGt2bSAqa3ZtLAogaW50IGt2bWlfYXJjaF9jbWRfc2V0X3BhZ2VfYWNjZXNzKHN0cnVjdCBrdm1f
aW50cm9zcGVjdGlvbiAqa3ZtaSwKIAkJCQkgIGNvbnN0IHN0cnVjdCBrdm1pX21zZ19oZHIgKm1z
ZywKIAkJCQkgIGNvbnN0IHN0cnVjdCBrdm1pX3ZtX3NldF9wYWdlX2FjY2VzcyAqcmVxKTsKK2Jv
b2wga3ZtaV9hcmNoX3BmX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgZ3BhX3QgZ3BhLCBn
dmFfdCBndmEsCisJCQl1OCBhY2Nlc3MpOworYm9vbCBrdm1pX2FyY2hfcGZfb2ZfaW50ZXJlc3Qo
c3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIAogI2VuZGlmCmRpZmYgLS1naXQgYS92aXJ0L2t2bS9p
bnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNn
LmMKaW5kZXggOTczZWQ5ZDkyYmZiLi4xMGQ0ZTQwMzg3ZWYgMTAwNjQ0Ci0tLSBhL3ZpcnQva3Zt
L2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2
bWlfbXNnLmMKQEAgLTk4NCwzICs5ODQsMjEgQEAgdTMyIGt2bWlfbXNnX3NlbmRfYnAoc3RydWN0
IGt2bV92Y3B1ICp2Y3B1LCB1NjQgZ3BhLCB1OCBpbnNuX2xlbikKIAogCXJldHVybiBhY3Rpb247
CiB9CisKK3UzMiBrdm1pX21zZ19zZW5kX3BmKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTY0IGdw
YSwgdTY0IGd2YSwgdTggYWNjZXNzKQoreworCXN0cnVjdCBrdm1pX2V2ZW50X3BmIGU7CisJaW50
IGVyciwgYWN0aW9uOworCisJbWVtc2V0KCZlLCAwLCBzaXplb2YoZSkpOworCWUuZ3BhID0gZ3Bh
OworCWUuZ3ZhID0gZ3ZhOworCWUuYWNjZXNzID0gYWNjZXNzOworCisJZXJyID0ga3ZtaV9zZW5k
X2V2ZW50KHZjcHUsIEtWTUlfRVZFTlRfUEYsICZlLCBzaXplb2YoZSksCisJCQkgICAgICBOVUxM
LCAwLCAmYWN0aW9uKTsKKwlpZiAoZXJyKQorCQlyZXR1cm4gS1ZNSV9FVkVOVF9BQ1RJT05fQ09O
VElOVUU7CisKKwlyZXR1cm4gYWN0aW9uOworfQpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmlydHVhbGl6
YXRpb25AbGlzdHMubGludXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51eGZvdW5k
YXRpb24ub3JnL21haWxtYW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
