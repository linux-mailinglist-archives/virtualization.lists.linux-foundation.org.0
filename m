Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id B0C5A155E4B
	for <lists.virtualization@lfdr.de>; Fri,  7 Feb 2020 19:36:27 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 62E61869B9;
	Fri,  7 Feb 2020 18:36:26 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id pCAtNKnUyE-M; Fri,  7 Feb 2020 18:36:20 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 8E94786A59;
	Fri,  7 Feb 2020 18:36:10 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 7653FC013E;
	Fri,  7 Feb 2020 18:36:10 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id E2FB8C1D81
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:36:03 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by hemlock.osuosl.org (Postfix) with ESMTP id DC91187F8E
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:36:03 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id dAvbWmiCVVKH
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:58 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by hemlock.osuosl.org (Postfix) with ESMTPS id 2C61187FB5
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:58 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 42954305D358; Fri,  7 Feb 2020 20:16:41 +0200 (EET)
Received: from host.bbu.bitdefender.biz (unknown [195.210.4.22])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 1E50A305206E;
 Fri,  7 Feb 2020 20:16:41 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [RFC PATCH v7 58/78] KVM: introspection: add KVMI_EVENT_BREAKPOINT
Date: Fri,  7 Feb 2020 20:16:16 +0200
Message-Id: <20200207181636.1065-59-alazar@bitdefender.com>
In-Reply-To: <20200207181636.1065-1-alazar@bitdefender.com>
References: <20200207181636.1065-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <ncitu@bitdefender.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 Sean Christopherson <sean.j.christopherson@intel.com>,
 virtualization@lists.linux-foundation.org,
 =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBldmVudCBp
cyBzZW50IHdoZW4gYSBicmVha3BvaW50IHdhcyByZWFjaGVkLiBJdCBoYXMgdG8KYmUgZW5hYmxl
ZCB3aXRoIHRoZSBLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMgY29tbWFuZCBmaXJzdC4KClRoZSBp
bnRyb3NwZWN0aW9uIHRvb2wgY2FuIHBsYWNlIGJyZWFrcG9pbnRzIGFuZCB1c2UgdGhlbSBhcyBu
b3RpZmljYXRpb24KZm9yIHdoZW4gdGhlIE9TIG9yIGFuIGFwcGxpY2F0aW9uIGhhcyByZWFjaGVk
IGEgY2VydGFpbiBzdGF0ZSBvciBpcwp0cnlpbmcgdG8gcGVyZm9ybSBhIGNlcnRhaW4gb3BlcmF0
aW9uIChsaWtlIGNyZWF0aW5nIGEgcHJvY2VzcykuCgpTaWduZWQtb2ZmLWJ5OiBNaWhhaSBEb27I
m3UgPG1kb250dUBiaXRkZWZlbmRlci5jb20+CkNvLWRldmVsb3BlZC1ieTogTmljdciZb3IgQ8Ou
yJt1IDxuY2l0dUBiaXRkZWZlbmRlci5jb20+ClNpZ25lZC1vZmYtYnk6IE5pY3XImW9yIEPDrsib
dSA8bmNpdHVAYml0ZGVmZW5kZXIuY29tPgpDby1kZXZlbG9wZWQtYnk6IEFkYWxiZXJ0IExhesSD
ciA8YWxhemFyQGJpdGRlZmVuZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogQWRhbGJlcnQgTGF6xINy
IDxhbGF6YXJAYml0ZGVmZW5kZXIuY29tPgotLS0KIERvY3VtZW50YXRpb24vdmlydC9rdm0va3Zt
aS5yc3QgICAgICAgICAgICAgICB8IDM3ICsrKysrKysrKysrKysKIGFyY2gveDg2L2luY2x1ZGUv
dWFwaS9hc20va3ZtaS5oICAgICAgICAgICAgICB8ICA2ICsrKwogYXJjaC94ODYva3ZtL2t2bWku
YyAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgNTIgKysrKysrKysrKysrKysrKysrKwogYXJj
aC94ODYva3ZtL3N2bS5jICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgMzIgKysrKysrKysr
KysrCiBhcmNoL3g4Ni9rdm0vdm14L3ZteC5jICAgICAgICAgICAgICAgICAgICAgICAgfCAxNiAr
KysrLS0KIGluY2x1ZGUvbGludXgva3ZtaV9ob3N0LmggICAgICAgICAgICAgICAgICAgICB8ICA0
ICsrCiBpbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oICAgICAgICAgICAgICAgICAgICAgfCAgMSAr
CiAuLi4vdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyAgfCA0NiArKysr
KysrKysrKysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyAgICAgICAgICAgICAg
ICAgfCAyOSArKysrKysrKysrLQogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oICAg
ICAgICAgICAgIHwgIDggKystCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgICAg
ICAgICAgICAgfCAyMiArKysrKysrLQogMTEgZmlsZXMgY2hhbmdlZCwgMjQ1IGluc2VydGlvbnMo
KyksIDggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9r
dm1pLnJzdCBiL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKaW5kZXggOTAyNTYxNDFh
MTVkLi40NzA0MDdmMzA5ZDkgMTAwNjQ0Ci0tLSBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3Zt
aS5yc3QKKysrIGIvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdApAQCAtNTMwLDYgKzUz
MCw3IEBAIFVzZSAqS1ZNSV9WTV9DSEVDS19FVkVOVCogZmlyc3QuCiBFbmFibGVzL2Rpc2FibGVz
IHZDUFUgaW50cm9zcGVjdGlvbiBldmVudHMuIFRoaXMgY29tbWFuZCBjYW4gYmUgdXNlZCB3aXRo
CiB0aGUgZm9sbG93aW5nIGV2ZW50czo6CiAKKwlLVk1JX0VWRU5UX0JSRUFLUE9JTlQKIAlLVk1J
X0VWRU5UX0hZUEVSQ0FMTAogCiBXaGVuIGFuIGV2ZW50IGlzIGVuYWJsZWQsIHRoZSBpbnRyb3Nw
ZWN0aW9uIHRvb2wgaXMgbm90aWZpZWQgYW5kIGl0CkBAIC03OTgsMyArNzk5LDM5IEBAIEl0IGlz
IHVzZWQgYnkgdGhlIGNvZGUgcmVzaWRpbmcgaW5zaWRlIHRoZSBpbnRyb3NwZWN0ZWQgZ3Vlc3Qg
dG8gY2FsbCB0aGUKIGludHJvc3BlY3Rpb24gdG9vbCBhbmQgdG8gcmVwb3J0IGNlcnRhaW4gZGV0
YWlscyBhYm91dCBpdHMgb3BlcmF0aW9uLiBGb3IKIGV4YW1wbGUsIGEgY2xhc3NpYyBhbnRpbWFs
d2FyZSByZW1lZGlhdGlvbiB0b29sIGNhbiByZXBvcnQgd2hhdCBpdCBoYXMKIGZvdW5kIGR1cmlu
ZyBhIHNjYW4uCisKKzQuIEtWTUlfRVZFTlRfQlJFQUtQT0lOVAorLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCisKKzpBcmNoaXRlY3R1cmVzOiB4ODYKKzpWZXJzaW9uczogPj0gMQorOkFjdGlvbnM6
IENPTlRJTlVFLCBDUkFTSCwgUkVUUlkKKzpQYXJhbWV0ZXJzOgorCis6OgorCisJc3RydWN0IGt2
bWlfZXZlbnQ7CisJc3RydWN0IGt2bWlfZXZlbnRfYnJlYWtwb2ludCB7CisJCV9fdTY0IGdwYTsK
KwkJX191OCBpbnNuX2xlbjsKKwkJX191OCBwYWRkaW5nWzddOworCX07CisKKzpSZXR1cm5zOgor
Cis6OgorCisJc3RydWN0IGt2bWlfdmNwdV9oZHI7CisJc3RydWN0IGt2bWlfZXZlbnRfcmVwbHk7
CisKK1RoaXMgZXZlbnQgaXMgc2VudCB3aGVuIGEgYnJlYWtwb2ludCB3YXMgcmVhY2hlZCBhbmQg
dGhlIGludHJvc3BlY3Rpb24gaGFzCitiZWVuIGVuYWJsZWQgZm9yIHRoaXMgZXZlbnQgKHNlZSAq
S1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTKikuCisKK1NvbWUgb2YgdGhlc2UgYnJlYWtwb2ludHMg
Y291bGQgaGF2ZSBiZWVuIGluamVjdGVkIGJ5IHRoZSBpbnRyb3NwZWN0aW9uIHRvb2wsCitwbGFj
ZWQgaW4gdGhlIHNsYWNrIHNwYWNlIG9mIHZhcmlvdXMgZnVuY3Rpb25zIGFuZCB1c2VkIGFzIG5v
dGlmaWNhdGlvbgorZm9yIHdoZW4gdGhlIE9TIG9yIGFuIGFwcGxpY2F0aW9uIGhhcyByZWFjaGVk
IGEgY2VydGFpbiBzdGF0ZSBvciBpcwordHJ5aW5nIHRvIHBlcmZvcm0gYSBjZXJ0YWluIG9wZXJh
dGlvbiAobGlrZSBjcmVhdGluZyBhIHByb2Nlc3MpLgorCitgYGt2bWlfZXZlbnRgYCBhbmQgdGhl
IGd1ZXN0IHBoeXNpY2FsIGFkZHJlc3MgYXJlIHNlbnQgdG8gdGhlIGludHJvc3BlY3Rpb24gdG9v
bC4KKworVGhlICpSRVRSWSogYWN0aW9uIGlzIHVzZWQgYnkgdGhlIGludHJvc3BlY3Rpb24gdG9v
bCBmb3IgaXRzIG93biBicmVha3BvaW50cy4KZGlmZiAtLWdpdCBhL2FyY2gveDg2L2luY2x1ZGUv
dWFwaS9hc20va3ZtaS5oIGIvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmgKaW5kZXgg
OTg4MmU2OGNhYjc1Li4xNjA1Nzc3MjU2YTMgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2luY2x1ZGUv
dWFwaS9hc20va3ZtaS5oCisrKyBiL2FyY2gveDg2L2luY2x1ZGUvdWFwaS9hc20va3ZtaS5oCkBA
IC01OSw0ICs1OSwxMCBAQCBzdHJ1Y3Qga3ZtaV92Y3B1X2dldF9jcHVpZF9yZXBseSB7CiAJX191
MzIgZWR4OwogfTsKIAorc3RydWN0IGt2bWlfZXZlbnRfYnJlYWtwb2ludCB7CisJX191NjQgZ3Bh
OworCV9fdTggaW5zbl9sZW47CisJX191OCBwYWRkaW5nWzddOworfTsKKwogI2VuZGlmIC8qIF9V
QVBJX0FTTV9YODZfS1ZNSV9IICovCmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9rdm0va3ZtaS5jIGIv
YXJjaC94ODYva3ZtL2t2bWkuYwppbmRleCBmNTk3YjNjMWNiYTAuLjJjOGMwNjJhNGIxMSAxMDA2
NDQKLS0tIGEvYXJjaC94ODYva3ZtL2t2bWkuYworKysgYi9hcmNoL3g4Ni9rdm0va3ZtaS5jCkBA
IC0xOTIsMyArMTkyLDU1IEBAIHZvaWQga3ZtaV9hcmNoX2h5cGVyY2FsbF9ldmVudChzdHJ1Y3Qg
a3ZtX3ZjcHUgKnZjcHUpCiAJCQkJCQkiSFlQRVJDQUxMIik7CiAJfQogfQorCitzdGF0aWMgaW50
IGt2bWlfY29udHJvbF9icF9pbnRlcmNlcHQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBib29sIGVu
YWJsZSkKK3sKKwlzdHJ1Y3Qga3ZtX2d1ZXN0X2RlYnVnIGRiZyA9IHt9OworCWludCBlcnIgPSAw
OworCisJaWYgKGVuYWJsZSkKKwkJZGJnLmNvbnRyb2wgPSBLVk1fR1VFU1REQkdfRU5BQkxFIHwg
S1ZNX0dVRVNUREJHX1VTRV9TV19CUDsKKwllcnIgPSBrdm1fYXJjaF92Y3B1X3NldF9ndWVzdF9k
ZWJ1Zyh2Y3B1LCAmZGJnKTsKKworCXJldHVybiBlcnI7Cit9CisKK2ludCBrdm1pX2FyY2hfY21k
X2NvbnRyb2xfaW50ZXJjZXB0KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKKwkJCQkgICAgdW5zaWdu
ZWQgaW50IGV2ZW50X2lkLCBib29sIGVuYWJsZSkKK3sKKwlpbnQgZXJyID0gMDsKKworCXN3aXRj
aCAoZXZlbnRfaWQpIHsKKwljYXNlIEtWTUlfRVZFTlRfQlJFQUtQT0lOVDoKKwkJZXJyID0ga3Zt
aV9jb250cm9sX2JwX2ludGVyY2VwdCh2Y3B1LCBlbmFibGUpOworCQlicmVhazsKKwlkZWZhdWx0
OgorCQlicmVhazsKKwl9CisKKwlyZXR1cm4gZXJyOworfQorCit2b2lkIGt2bWlfYXJjaF9icmVh
a3BvaW50X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTY0IGd2YSwgdTggaW5zbl9sZW4p
Cit7CisJdTMyIGFjdGlvbjsKKwl1NjQgZ3BhOworCisJZ3BhID0ga3ZtX21tdV9ndmFfdG9fZ3Bh
X3N5c3RlbSh2Y3B1LCBndmEsIDAsIE5VTEwpOworCisJYWN0aW9uID0ga3ZtaV9tc2dfc2VuZF9i
cCh2Y3B1LCBncGEsIGluc25fbGVuKTsKKwlzd2l0Y2ggKGFjdGlvbikgeworCWNhc2UgS1ZNSV9F
VkVOVF9BQ1RJT05fQ09OVElOVUU6CisJCWt2bV9xdWV1ZV9leGNlcHRpb24odmNwdSwgQlBfVkVD
VE9SKTsKKwkJYnJlYWs7CisJY2FzZSBLVk1JX0VWRU5UX0FDVElPTl9SRVRSWToKKwkJLyogcmlw
IHdhcyBtb3N0IGxpa2VseSBhZGp1c3RlZCBwYXN0IHRoZSBJTlQgMyBpbnN0cnVjdGlvbiAqLwor
CQlicmVhazsKKwlkZWZhdWx0OgorCQlrdm1pX2hhbmRsZV9jb21tb25fZXZlbnRfYWN0aW9ucyh2
Y3B1LT5rdm0sIGFjdGlvbiwgIkJQIik7CisJfQorfQorCit2b2lkIGt2bWlfYXJjaF9yZXN0b3Jl
X2ludGVyY2VwdGlvbihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCit7Cit9CmRpZmYgLS1naXQgYS9h
cmNoL3g4Ni9rdm0vc3ZtLmMgYi9hcmNoL3g4Ni9rdm0vc3ZtLmMKaW5kZXggMzhlY2Q4NmMxZDU4
Li4zN2IwMTg5ODhkN2QgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS9zdm0uYworKysgYi9hcmNo
L3g4Ni9rdm0vc3ZtLmMKQEAgLTI3ODgsMTAgKzI3ODgsNDIgQEAgc3RhdGljIGludCBkYl9pbnRl
cmNlcHRpb24oc3RydWN0IHZjcHVfc3ZtICpzdm0pCiAJcmV0dXJuIDE7CiB9CiAKK3N0YXRpYyB1
bnNpZ25lZCBzdm1fZ2V0X2luc3RydWN0aW9uX2xlbihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCit7
CisJc3RydWN0IHZjcHVfc3ZtICpzdm0gPSB0b19zdm0odmNwdSk7CisJdW5zaWduZWQgbG9uZyBu
ZXh0X3JpcCA9IDAsIHJpcCA9IGt2bV9yaXBfcmVhZCh2Y3B1KTsKKwl1bnNpZ25lZCBpbnNuX2xl
bjsKKworCWlmIChzdGF0aWNfY3B1X2hhcyhYODZfRkVBVFVSRV9OUklQUykpCisJCW5leHRfcmlw
ID0gc3ZtLT52bWNiLT5jb250cm9sLm5leHRfcmlwOworCisJaWYgKCFuZXh0X3JpcCkgeworCQlp
ZiAoIWt2bV9lbXVsYXRlX2luc3RydWN0aW9uKHZjcHUsIEVNVUxUWVBFX1NLSVApKQorCQkJcmV0
dXJuIDA7CisKKwkJbmV4dF9yaXAgPSBrdm1fcmlwX3JlYWQodmNwdSk7CisJCWt2bV9yaXBfd3Jp
dGUodmNwdSwgcmlwKTsKKwl9CisKKwlpbnNuX2xlbiA9IG5leHRfcmlwIC0gcmlwOworCWlmIChp
bnNuX2xlbiA+IE1BWF9JTlNUX1NJWkUpIHsKKwkJcHJfZXJyKCIlczogaXAgMHglbHggbmV4dCAw
eCVseFxuIiwKKwkJICAgICAgIF9fZnVuY19fLCByaXAsIG5leHRfcmlwKTsKKwkJcmV0dXJuIDA7
CisJfQorCisJcmV0dXJuIGluc25fbGVuOworfQorCiBzdGF0aWMgaW50IGJwX2ludGVyY2VwdGlv
bihzdHJ1Y3QgdmNwdV9zdm0gKnN2bSkKIHsKIAlzdHJ1Y3Qga3ZtX3J1biAqa3ZtX3J1biA9IHN2
bS0+dmNwdS5ydW47CiAKKwlpZiAoIWt2bWlfYnJlYWtwb2ludF9ldmVudCgmc3ZtLT52Y3B1LCBz
dm0tPnZtY2ItPnNhdmUuY3MuYmFzZSArCisJCQkJCSAgICAgICBzdm0tPnZtY2ItPnNhdmUucmlw
LAorCQkJCSAgIHN2bV9nZXRfaW5zdHJ1Y3Rpb25fbGVuKCZzdm0tPnZjcHUpKSkKKwkJcmV0dXJu
IDE7CisKIAlrdm1fcnVuLT5leGl0X3JlYXNvbiA9IEtWTV9FWElUX0RFQlVHOwogCWt2bV9ydW4t
PmRlYnVnLmFyY2gucGMgPSBzdm0tPnZtY2ItPnNhdmUuY3MuYmFzZSArIHN2bS0+dm1jYi0+c2F2
ZS5yaXA7CiAJa3ZtX3J1bi0+ZGVidWcuYXJjaC5leGNlcHRpb24gPSBCUF9WRUNUT1I7CmRpZmYg
LS1naXQgYS9hcmNoL3g4Ni9rdm0vdm14L3ZteC5jIGIvYXJjaC94ODYva3ZtL3ZteC92bXguYwpp
bmRleCA0NzVmNWViNmM0YzIuLmQyMzFmZjI1ZjQ2NyAxMDA2NDQKLS0tIGEvYXJjaC94ODYva3Zt
L3ZteC92bXguYworKysgYi9hcmNoL3g4Ni9rdm0vdm14L3ZteC5jCkBAIC00NjIwLDcgKzQ2MjAs
NyBAQCBzdGF0aWMgaW50IGhhbmRsZV9leGNlcHRpb25fbm1pKHN0cnVjdCBrdm1fdmNwdSAqdmNw
dSkKIAlzdHJ1Y3QgdmNwdV92bXggKnZteCA9IHRvX3ZteCh2Y3B1KTsKIAlzdHJ1Y3Qga3ZtX3J1
biAqa3ZtX3J1biA9IHZjcHUtPnJ1bjsKIAl1MzIgaW50cl9pbmZvLCBleF9ubywgZXJyb3JfY29k
ZTsKLQl1bnNpZ25lZCBsb25nIGNyMiwgcmlwLCBkcjY7CisJdW5zaWduZWQgbG9uZyBjcjIsIGRy
NjsKIAl1MzIgdmVjdF9pbmZvOwogCiAJdmVjdF9pbmZvID0gdm14LT5pZHRfdmVjdG9yaW5nX2lu
Zm87CkBAIC00Njk4LDcgKzQ2OTgsMTAgQEAgc3RhdGljIGludCBoYW5kbGVfZXhjZXB0aW9uX25t
aShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCiAJCWt2bV9ydW4tPmRlYnVnLmFyY2guZHI2ID0gZHI2
IHwgRFI2X0ZJWEVEXzE7CiAJCWt2bV9ydW4tPmRlYnVnLmFyY2guZHI3ID0gdm1jc19yZWFkbChH
VUVTVF9EUjcpOwogCQkvKiBmYWxsIHRocm91Z2ggKi8KLQljYXNlIEJQX1ZFQ1RPUjoKKwljYXNl
IEJQX1ZFQ1RPUjogeworCQl1bnNpZ25lZCBsb25nIGd2YSA9IHZtY3NfcmVhZGwoR1VFU1RfQ1Nf
QkFTRSkgKworCQkJa3ZtX3JpcF9yZWFkKHZjcHUpOworCiAJCS8qCiAJCSAqIFVwZGF0ZSBpbnN0
cnVjdGlvbiBsZW5ndGggYXMgd2UgbWF5IHJlaW5qZWN0ICNCUCBmcm9tCiAJCSAqIHVzZXIgc3Bh
Y2Ugd2hpbGUgaW4gZ3Vlc3QgZGVidWdnaW5nIG1vZGUuIFJlYWRpbmcgaXQgZm9yCkBAIC00NzA2
LDExICs0NzA5LDE2IEBAIHN0YXRpYyBpbnQgaGFuZGxlX2V4Y2VwdGlvbl9ubWkoc3RydWN0IGt2
bV92Y3B1ICp2Y3B1KQogCQkgKi8KIAkJdm14LT52Y3B1LmFyY2guZXZlbnRfZXhpdF9pbnN0X2xl
biA9CiAJCQl2bWNzX3JlYWQzMihWTV9FWElUX0lOU1RSVUNUSU9OX0xFTik7CisKKwkJaWYgKCFr
dm1pX2JyZWFrcG9pbnRfZXZlbnQodmNwdSwgZ3ZhLAorCQkJCQkgICB2bXgtPnZjcHUuYXJjaC5l
dmVudF9leGl0X2luc3RfbGVuKSkKKwkJCXJldHVybiAxOworCiAJCWt2bV9ydW4tPmV4aXRfcmVh
c29uID0gS1ZNX0VYSVRfREVCVUc7Ci0JCXJpcCA9IGt2bV9yaXBfcmVhZCh2Y3B1KTsKLQkJa3Zt
X3J1bi0+ZGVidWcuYXJjaC5wYyA9IHZtY3NfcmVhZGwoR1VFU1RfQ1NfQkFTRSkgKyByaXA7CisJ
CWt2bV9ydW4tPmRlYnVnLmFyY2gucGMgPSBndmE7CiAJCWt2bV9ydW4tPmRlYnVnLmFyY2guZXhj
ZXB0aW9uID0gZXhfbm87CiAJCWJyZWFrOworCX0KIAlkZWZhdWx0OgogCQlrdm1fcnVuLT5leGl0
X3JlYXNvbiA9IEtWTV9FWElUX0VYQ0VQVElPTjsKIAkJa3ZtX3J1bi0+ZXguZXhjZXB0aW9uID0g
ZXhfbm87CmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oIGIvaW5jbHVkZS9s
aW51eC9rdm1pX2hvc3QuaAppbmRleCAwYTg1YmZiZDBjMGMuLjU3ZTkxYzg2NTlhMyAxMDA2NDQK
LS0tIGEvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaAorKysgYi9pbmNsdWRlL2xpbnV4L2t2bWlf
aG9zdC5oCkBAIC03Niw2ICs3Niw3IEBAIGludCBrdm1pX2lvY3RsX3ByZXVuaG9vayhzdHJ1Y3Qg
a3ZtICprdm0pOwogCiB2b2lkIGt2bWlfaGFuZGxlX3JlcXVlc3RzKHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSk7CiBib29sIGt2bWlfaHlwZXJjYWxsX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7
Citib29sIGt2bWlfYnJlYWtwb2ludF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU2NCBn
dmEsIHU4IGluc25fbGVuKTsKIAogI2Vsc2UKIApAQCAtODcsNiArODgsOSBAQCBzdGF0aWMgaW5s
aW5lIHZvaWQga3ZtaV92Y3B1X3VuaW5pdChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpIHsgfQogCiBz
dGF0aWMgaW5saW5lIHZvaWQga3ZtaV9oYW5kbGVfcmVxdWVzdHMoc3RydWN0IGt2bV92Y3B1ICp2
Y3B1KSB7IH0KIHN0YXRpYyBpbmxpbmUgYm9vbCBrdm1pX2h5cGVyY2FsbF9ldmVudChzdHJ1Y3Qg
a3ZtX3ZjcHUgKnZjcHUpIHsgcmV0dXJuIGZhbHNlOyB9CitzdGF0aWMgaW5saW5lIGJvb2wga3Zt
aV9icmVha3BvaW50X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTY0IGd2YSwKKwkJCQkJ
IHU4IGluc25fbGVuKQorCQkJeyByZXR1cm4gdHJ1ZTsgfQogCiAjZW5kaWYgLyogQ09ORklHX0tW
TV9JTlRST1NQRUNUSU9OICovCiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1p
LmggYi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oCmluZGV4IDIwZTJmMTU0YWI4OC4uZWVjMzNl
ODViMGM3IDEwMDY0NAotLS0gYS9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oCisrKyBiL2luY2x1
ZGUvdWFwaS9saW51eC9rdm1pLmgKQEAgLTQwLDYgKzQwLDcgQEAgZW51bSB7CiAJS1ZNSV9FVkVO
VF9VTkhPT0sgICAgID0gMCwKIAlLVk1JX0VWRU5UX1BBVVNFX1ZDUFUgPSAxLAogCUtWTUlfRVZF
TlRfSFlQRVJDQUxMICA9IDIsCisJS1ZNSV9FVkVOVF9CUkVBS1BPSU5UID0gMywKIAogCUtWTUlf
TlVNX0VWRU5UUwogfTsKZGlmZiAtLWdpdCBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94
ODZfNjQva3ZtaV90ZXN0LmMgYi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2
bWlfdGVzdC5jCmluZGV4IGVmNGUzM2U5MmZmZi4uMzMxNjRhYzc1Y2E5IDEwMDY0NAotLS0gYS90
b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCisrKyBiL3Rvb2xz
L3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKQEAgLTQ4LDYgKzQ4LDcg
QEAgc3RydWN0IHZjcHVfd29ya2VyX2RhdGEgewogCiBlbnVtIHsKIAlHVUVTVF9URVNUX05PT1Ag
PSAwLAorCUdVRVNUX1RFU1RfQlAsCiAJR1VFU1RfVEVTVF9IWVBFUkNBTEwsCiB9OwogCkBAIC02
Miw2ICs2MywxMSBAQCBzdGF0aWMgaW50IGd1ZXN0X3Rlc3RfaWQodm9pZCkKIAlyZXR1cm4gUkVB
RF9PTkNFKHRlc3RfaWQpOwogfQogCitzdGF0aWMgdm9pZCBndWVzdF9icF90ZXN0KHZvaWQpCit7
CisJYXNtIHZvbGF0aWxlKCJpbnQzIik7Cit9CisKIHN0YXRpYyB2b2lkIGd1ZXN0X2h5cGVyY2Fs
bF90ZXN0KHZvaWQpCiB7CiAJYXNtIHZvbGF0aWxlKCJtb3YgJDM0LCAlcmF4Iik7CkBAIC03Niw2
ICs4Miw5IEBAIHN0YXRpYyB2b2lkIGd1ZXN0X2NvZGUodm9pZCkKIAkJc3dpdGNoIChndWVzdF90
ZXN0X2lkKCkpIHsKIAkJY2FzZSBHVUVTVF9URVNUX05PT1A6CiAJCQlicmVhazsKKwkJY2FzZSBH
VUVTVF9URVNUX0JQOgorCQkJZ3Vlc3RfYnBfdGVzdCgpOworCQkJYnJlYWs7CiAJCWNhc2UgR1VF
U1RfVEVTVF9IWVBFUkNBTEw6CiAJCQlndWVzdF9oeXBlcmNhbGxfdGVzdCgpOwogCQkJYnJlYWs7
CkBAIC05ODQsNiArOTkzLDQyIEBAIHN0YXRpYyB2b2lkIHRlc3RfZXZlbnRfaHlwZXJjYWxsKHN0
cnVjdCBrdm1fdm0gKnZtKQogCWRpc2FibGVfdmNwdV9ldmVudCh2bSwgZXZlbnRfaWQpOwogfQog
CitzdGF0aWMgdm9pZCB0ZXN0X2V2ZW50X2JyZWFrcG9pbnQoc3RydWN0IGt2bV92bSAqdm0pCit7
CisJc3RydWN0IHZjcHVfd29ya2VyX2RhdGEgZGF0YSA9IHsKKwkJLnZtID0gdm0sCisJCS52Y3B1
X2lkID0gVkNQVV9JRCwKKwkJLnRlc3RfaWQgPSBHVUVTVF9URVNUX0JQLAorCX07CisJc3RydWN0
IGt2bWlfbXNnX2hkciBoZHI7CisJc3RydWN0IHsKKwkJc3RydWN0IGt2bWlfZXZlbnQgY29tbW9u
OworCQlzdHJ1Y3Qga3ZtaV9ldmVudF9icmVha3BvaW50IGJwOworCX0gZXY7CisJc3RydWN0IHZj
cHVfcmVwbHkgcnBsID0ge307CisJX191MTYgZXZlbnRfaWQgPSBLVk1JX0VWRU5UX0JSRUFLUE9J
TlQ7CisJcHRocmVhZF90IHZjcHVfdGhyZWFkOworCisJZW5hYmxlX3ZjcHVfZXZlbnQodm0sIGV2
ZW50X2lkKTsKKworCXZjcHVfdGhyZWFkID0gc3RhcnRfdmNwdV93b3JrZXIoJmRhdGEpOworCisJ
cmVjZWl2ZV9ldmVudCgmaGRyLCAmZXYuY29tbW9uLCBzaXplb2YoZXYpLCBldmVudF9pZCk7CisK
KwlERUJVRygiQnJlYWtwb2ludCBldmVudCwgcmlwIDB4JWxseCwgbGVuICV1XG4iLAorCQlldi5j
b21tb24uYXJjaC5yZWdzLnJpcCwgZXYuYnAuaW5zbl9sZW4pOworCisJZXYuY29tbW9uLmFyY2gu
cmVncy5yaXAgKz0gZXYuYnAuaW5zbl9sZW47CisJX19zZXRfcmVnaXN0ZXJzKHZtLCAmZXYuY29t
bW9uLmFyY2gucmVncyk7CisKKwlyZXBseV90b19ldmVudCgmaGRyLCAmZXYuY29tbW9uLCBLVk1J
X0VWRU5UX0FDVElPTl9SRVRSWSwKKwkJCSZycGwsIHNpemVvZihycGwpKTsKKworCXN0b3BfdmNw
dV93b3JrZXIodmNwdV90aHJlYWQsICZkYXRhKTsKKworCWRpc2FibGVfdmNwdV9ldmVudCh2bSwg
ZXZlbnRfaWQpOworfQorCiBzdGF0aWMgdm9pZCB0ZXN0X2ludHJvc3BlY3Rpb24oc3RydWN0IGt2
bV92bSAqdm0pCiB7CiAJc2V0dXBfc29ja2V0KCk7CkBAIC0xMDA0LDYgKzEwNDksNyBAQCBzdGF0
aWMgdm9pZCB0ZXN0X2ludHJvc3BlY3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCiAJdGVzdF9jbWRf
dmNwdV9zZXRfcmVnaXN0ZXJzKHZtKTsKIAl0ZXN0X2NtZF92Y3B1X2dldF9jcHVpZCh2bSk7CiAJ
dGVzdF9ldmVudF9oeXBlcmNhbGwodm0pOworCXRlc3RfZXZlbnRfYnJlYWtwb2ludCh2bSk7CiAK
IAl1bmhvb2tfaW50cm9zcGVjdGlvbih2bSk7CiB9CmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRy
b3NwZWN0aW9uL2t2bWkuYyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCmluZGV4IGEx
YzA1OTQ4OWRlYS4uMTllYTk0ZGMwZTFkIDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0
aW9uL2t2bWkuYworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwpAQCAtMTY1LDYg
KzE2NSw4IEBAIHN0YXRpYyB2b2lkIGZyZWVfdmNwdWkoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQog
CiAJa2ZyZWUodmNwdWkpOwogCXZjcHUtPmt2bWkgPSBOVUxMOworCisJa3ZtaV9tYWtlX3JlcXVl
c3QodmNwdSwgZmFsc2UpOwogfQogCiBzdGF0aWMgdm9pZCBmcmVlX2t2bWkoc3RydWN0IGt2bSAq
a3ZtKQpAQCAtNTU1LDcgKzU1Nyw3IEBAIGludCBrdm1pX2NtZF92Y3B1X2NvbnRyb2xfZXZlbnRz
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKIAllbHNlCiAJCWNsZWFyX2JpdChldmVudF9pZCwgdmNw
dWktPmV2X21hc2spOwogCi0JcmV0dXJuIDA7CisJcmV0dXJuIGt2bWlfYXJjaF9jbWRfY29udHJv
bF9pbnRlcmNlcHQodmNwdSwgZXZlbnRfaWQsIGVuYWJsZSk7CiB9CiAKIHVuc2lnbmVkIGxvbmcg
Z2ZuX3RvX2h2YV9zYWZlKHN0cnVjdCBrdm0gKmt2bSwgZ2ZuX3QgZ2ZuKQpAQCAtNzc3LDcgKzc3
OSw3IEBAIHZvaWQga3ZtaV9oYW5kbGVfcmVxdWVzdHMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQog
CiAJa3ZtaSA9IGt2bWlfZ2V0KHZjcHUtPmt2bSk7CiAJaWYgKCFrdm1pKQotCQlyZXR1cm47CisJ
CWdvdG8gb3V0OwogCiAJZm9yICg7OykgewogCQlrdm1pX3J1bl9qb2JzKHZjcHUpOwpAQCAtNzg5
LDYgKzc5MSw5IEBAIHZvaWQga3ZtaV9oYW5kbGVfcmVxdWVzdHMoc3RydWN0IGt2bV92Y3B1ICp2
Y3B1KQogCX0KIAogCWt2bWlfcHV0KHZjcHUtPmt2bSk7CisKK291dDoKKwlrdm1pX2FyY2hfcmVz
dG9yZV9pbnRlcmNlcHRpb24odmNwdSk7CiB9CiAKIGludCBrdm1pX2NtZF92Y3B1X3BhdXNlKHN0
cnVjdCBrdm1fdmNwdSAqdmNwdSwgYm9vbCB3YWl0KQpAQCAtODUwLDMgKzg1NSwyMyBAQCBib29s
IGt2bWlfaHlwZXJjYWxsX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKIAogCXJldHVybiBy
ZXQ7CiB9CisKK2Jvb2wga3ZtaV9icmVha3BvaW50X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNw
dSwgdTY0IGd2YSwgdTggaW5zbl9sZW4pCit7CisJc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICpr
dm1pOworCWJvb2wgcmV0ID0gZmFsc2U7CisKKwlrdm1pID0ga3ZtaV9nZXQodmNwdS0+a3ZtKTsK
KwlpZiAoIWt2bWkpCisJCXJldHVybiB0cnVlOworCisJaWYgKGlzX2V2ZW50X2VuYWJsZWQodmNw
dSwgS1ZNSV9FVkVOVF9CUkVBS1BPSU5UKSkKKwkJa3ZtaV9hcmNoX2JyZWFrcG9pbnRfZXZlbnQo
dmNwdSwgZ3ZhLCBpbnNuX2xlbik7CisJZWxzZQorCQlyZXQgPSB0cnVlOworCisJa3ZtaV9wdXQo
dmNwdS0+a3ZtKTsKKworCXJldHVybiByZXQ7Cit9CitFWFBPUlRfU1lNQk9MKGt2bWlfYnJlYWtw
b2ludF9ldmVudCk7CmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50
LmggYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmgKaW5kZXggM2RiY2Y5NDRhNjA2
Li4wNmYyYzViNjg1N2EgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9p
bnQuaAorKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmgKQEAgLTIyLDcgKzIy
LDggQEAKIAkJCSAgQklUKEtWTUlfRVZFTlRfVU5IT09LKSBcCiAJCSkKICNkZWZpbmUgS1ZNSV9L
Tk9XTl9WQ1BVX0VWRU5UUyAoIFwKLQkJCSAgICBCSVQoS1ZNSV9FVkVOVF9IWVBFUkNBTEwpIFwK
KwkJCSAgICBCSVQoS1ZNSV9FVkVOVF9CUkVBS1BPSU5UKSBcCisJCQkgIHwgQklUKEtWTUlfRVZF
TlRfSFlQRVJDQUxMKSBcCiAJCQkgIHwgQklUKEtWTUlfRVZFTlRfUEFVU0VfVkNQVSkgXAogCQkp
CiAKQEAgLTY2LDYgKzY3LDcgQEAgYm9vbCBrdm1pX21zZ19wcm9jZXNzKHN0cnVjdCBrdm1faW50
cm9zcGVjdGlvbiAqa3ZtaSk7CiBpbnQga3ZtaV9tc2dfc2VuZF91bmhvb2soc3RydWN0IGt2bV9p
bnRyb3NwZWN0aW9uICprdm1pKTsKIHUzMiBrdm1pX21zZ19zZW5kX3ZjcHVfcGF1c2Uoc3RydWN0
IGt2bV92Y3B1ICp2Y3B1KTsKIHUzMiBrdm1pX21zZ19zZW5kX2h5cGVyY2FsbChzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUpOwordTMyIGt2bWlfbXNnX3NlbmRfYnAoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
LCB1NjQgZ3BhLCB1OCBpbnNuX2xlbik7CiAKIC8qIGt2bWkuYyAqLwogdm9pZCAqa3ZtaV9tc2df
YWxsb2Modm9pZCk7CkBAIC05NCw2ICs5Niw3IEBAIGludCBrdm1pX2NtZF92Y3B1X3NldF9yZWdp
c3RlcnMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LAogCQkJCWNvbnN0IHN0cnVjdCBrdm1fcmVncyAq
cmVncyk7CiAKIC8qIGFyY2ggKi8KK3ZvaWQga3ZtaV9hcmNoX3Jlc3RvcmVfaW50ZXJjZXB0aW9u
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7CiBpbnQga3ZtaV9hcmNoX2NtZF92Y3B1X2dldF9pbmZv
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKIAkJCQlzdHJ1Y3Qga3ZtaV92Y3B1X2dldF9pbmZvX3Jl
cGx5ICpycGwpOwogdm9pZCBrdm1pX2FyY2hfc2V0dXBfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2
Y3B1LCBzdHJ1Y3Qga3ZtaV9ldmVudCAqZXYpOwpAQCAtMTA3LDUgKzExMCw4IEBAIGludCBrdm1p
X2FyY2hfY21kX3ZjcHVfZ2V0X2NwdWlkKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKIAkJCQkgc3Ry
dWN0IGt2bWlfdmNwdV9nZXRfY3B1aWRfcmVwbHkgKnJwbCk7CiBib29sIGt2bWlfYXJjaF9pc19h
Z2VudF9oeXBlcmNhbGwoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIHZvaWQga3ZtaV9hcmNoX2h5
cGVyY2FsbF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwordm9pZCBrdm1pX2FyY2hfYnJl
YWtwb2ludF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU2NCBndmEsIHU4IGluc25fbGVu
KTsKK2ludCBrdm1pX2FyY2hfY21kX2NvbnRyb2xfaW50ZXJjZXB0KHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSwKKwkJCQkgICAgdW5zaWduZWQgaW50IGV2ZW50X2lkLCBib29sIGVuYWJsZSk7CiAKICNl
bmRpZgpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jIGIvdmly
dC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCmluZGV4IGJjZGYxMDRlYWE0My4uNjc3NjJi
YWEyODFhIDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKKysr
IGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCkBAIC00MzAsOSArNDMwLDEyIEBA
IHN0YXRpYyBpbnQgaGFuZGxlX3ZjcHVfY29udHJvbF9ldmVudHMoY29uc3Qgc3RydWN0IGt2bWlf
dmNwdV9jbWRfam9iICpqb2IsCiAJCWVjID0gLUtWTV9FSU5WQUw7CiAJZWxzZSBpZiAoIWlzX2V2
ZW50X2FsbG93ZWQoa3ZtaSwgcmVxLT5ldmVudF9pZCkpCiAJCWVjID0gLUtWTV9FUEVSTTsKLQll
bHNlCisJZWxzZSB7CiAJCWVjID0ga3ZtaV9jbWRfdmNwdV9jb250cm9sX2V2ZW50cyhqb2ItPnZj
cHUsIHJlcS0+ZXZlbnRfaWQsCiAJCQkJCQkgIHJlcS0+ZW5hYmxlKTsKKwkJaWYgKGVjKQorCQkJ
ZWMgPSAtS1ZNX0VPUE5PVFNVUFA7CisJfQogCiAJcmV0dXJuIGt2bWlfbXNnX3ZjcHVfcmVwbHko
am9iLCBtc2csIGVjLCBOVUxMLCAwKTsKIH0KQEAgLTg4MCwzICs4ODMsMjAgQEAgdTMyIGt2bWlf
bXNnX3NlbmRfaHlwZXJjYWxsKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKIAogCXJldHVybiBhY3Rp
b247CiB9CisKK3UzMiBrdm1pX21zZ19zZW5kX2JwKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTY0
IGdwYSwgdTggaW5zbl9sZW4pCit7CisJc3RydWN0IGt2bWlfZXZlbnRfYnJlYWtwb2ludCBlOwor
CWludCBlcnIsIGFjdGlvbjsKKworCW1lbXNldCgmZSwgMCwgc2l6ZW9mKGUpKTsKKwllLmdwYSA9
IGdwYTsKKwllLmluc25fbGVuID0gaW5zbl9sZW47CisKKwllcnIgPSBrdm1pX3NlbmRfZXZlbnQo
dmNwdSwgS1ZNSV9FVkVOVF9CUkVBS1BPSU5ULCAmZSwgc2l6ZW9mKGUpLAorCQkJICAgICAgTlVM
TCwgMCwgJmFjdGlvbik7CisJaWYgKGVycikKKwkJcmV0dXJuIEtWTUlfRVZFTlRfQUNUSU9OX0NP
TlRJTlVFOworCisJcmV0dXJuIGFjdGlvbjsKK30KX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxp
emF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3Vu
ZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
