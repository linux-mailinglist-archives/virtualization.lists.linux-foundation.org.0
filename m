Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
	by mail.lfdr.de (Postfix) with ESMTPS id CC22A2C3C69
	for <lists.virtualization@lfdr.de>; Wed, 25 Nov 2020 10:42:29 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by hemlock.osuosl.org (Postfix) with ESMTP id 7C098874BE;
	Wed, 25 Nov 2020 09:42:28 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id i3RlI+6aBLnp; Wed, 25 Nov 2020 09:42:24 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by hemlock.osuosl.org (Postfix) with ESMTP id C5CDA874C3;
	Wed, 25 Nov 2020 09:42:09 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id B47B0C163C;
	Wed, 25 Nov 2020 09:42:09 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 0D787C163C
 for <virtualization@lists.linux-foundation.org>;
 Wed, 25 Nov 2020 09:42:05 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by whitealder.osuosl.org (Postfix) with ESMTP id EF41286D7B
 for <virtualization@lists.linux-foundation.org>;
 Wed, 25 Nov 2020 09:42:04 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id o0ZG2KQJMtot
 for <virtualization@lists.linux-foundation.org>;
 Wed, 25 Nov 2020 09:41:58 +0000 (UTC)
X-Greylist: from auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by whitealder.osuosl.org (Postfix) with ESMTPS id B05FB86D7A
 for <virtualization@lists.linux-foundation.org>;
 Wed, 25 Nov 2020 09:41:55 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 8D162305D3E6; Wed, 25 Nov 2020 11:35:55 +0200 (EET)
Received: from localhost.localdomain (unknown [91.199.104.27])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 6568E3072784;
 Wed, 25 Nov 2020 11:35:55 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v10 78/81] KVM: introspection: add KVMI_VCPU_EVENT_SINGLESTEP
Date: Wed, 25 Nov 2020 11:35:57 +0200
Message-Id: <20201125093600.2766-79-alazar@bitdefender.com>
In-Reply-To: <20201125093600.2766-1-alazar@bitdefender.com>
References: <20201125093600.2766-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <nicu.citu@icloud.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTmljdciZb3IgQ8OuyJt1IDxuaWN1LmNpdHVAaWNsb3VkLmNvbT4KClRoaXMgZXZlbnQg
aXMgc2VudCBhZnRlciBlYWNoIGluc3RydWN0aW9uIHdoZW4gdGhlIHNpbmdsZXN0ZXAgaGFzIGJl
ZW4KZW5hYmxlZCBmb3IgYSB2Q1BVLgoKU2lnbmVkLW9mZi1ieTogTmljdciZb3IgQ8OuyJt1IDxu
aWN1LmNpdHVAaWNsb3VkLmNvbT4KQ28tZGV2ZWxvcGVkLWJ5OiBBZGFsYmVydCBMYXrEg3IgPGFs
YXphckBiaXRkZWZlbmRlci5jb20+ClNpZ25lZC1vZmYtYnk6IEFkYWxiZXJ0IExhesSDciA8YWxh
emFyQGJpdGRlZmVuZGVyLmNvbT4KLS0tCiBEb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0
ICAgICAgICAgICAgICAgfCAzMSArKysrKysrKysrKwogYXJjaC94ODYva3ZtL2t2bWkuYyAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHwgIDEgKwogYXJjaC94ODYva3ZtL2t2bWlfbXNnLmMgICAg
ICAgICAgICAgICAgICAgICAgIHwgIDYgKysrCiBhcmNoL3g4Ni9rdm0vdm14L3ZteC5jICAgICAg
ICAgICAgICAgICAgICAgICAgfCAgNiArKysKIGluY2x1ZGUvbGludXgva3ZtaV9ob3N0LmggICAg
ICAgICAgICAgICAgICAgICB8ICA0ICsrCiBpbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oICAgICAg
ICAgICAgICAgICAgICAgfCAgNiArKysKIC4uLi90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0
L2t2bWlfdGVzdC5jICB8IDU0ICsrKysrKysrKysrKysrKysrLS0KIHZpcnQva3ZtL2ludHJvc3Bl
Y3Rpb24va3ZtaS5jICAgICAgICAgICAgICAgICB8IDQzICsrKysrKysrKysrKysrKwogdmlydC9r
dm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oICAgICAgICAgICAgIHwgIDEgKwogdmlydC9rdm0v
aW50cm9zcGVjdGlvbi9rdm1pX21zZy5jICAgICAgICAgICAgIHwgMTcgKysrKysrCiAxMCBmaWxl
cyBjaGFuZ2VkLCAxNjYgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0IGIvRG9jdW1lbnRhdGlvbi92aXJ0L2t2
bS9rdm1pLnJzdAppbmRleCBjODgyMjkxMmQ4YzguLjRiMmU3ODA5ZjA1MiAxMDA2NDQKLS0tIGEv
RG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdAorKysgYi9Eb2N1bWVudGF0aW9uL3ZpcnQv
a3ZtL2t2bWkucnN0CkBAIC01NjUsNiArNTY1LDcgQEAgYmVjYXVzZSB0aGVzZSBhcmUgc2VudCBh
cyBhIHJlc3VsdCBvZiBjZXJ0YWluIGNvbW1hbmRzIChidXQgdGhleSBjYW4gYmUKIGRpc2FsbG93
ZWQgYnkgdGhlIGRldmljZSBtYW5hZ2VyKSA6OgogCiAJS1ZNSV9WQ1BVX0VWRU5UX1BBVVNFCisJ
S1ZNSV9WQ1BVX0VWRU5UX1NJTkdMRVNURVAKIAlLVk1JX1ZDUFVfRVZFTlRfVFJBUAogCiBUaGUg
Vk0gZXZlbnRzIChlLmcuICpLVk1JX1ZNX0VWRU5UX1VOSE9PSyopIGFyZSBjb250cm9sbGVkIHdp
dGgKQEAgLTEwNjMsOCArMTA2NCwxMiBAQCBFbmFibGVzL2Rpc2FibGVzIHNpbmdsZXN0ZXAgZm9y
IHRoZSBzZWxlY3RlZCB2Q1BVLgogVGhlIGludHJvc3BlY3Rpb24gdG9vbCBzaG91bGQgdXNlICpL
Vk1JX0dFVF9WRVJTSU9OKiwgdG8gY2hlY2sKIGlmIHRoZSBoYXJkd2FyZSBzdXBwb3J0cyBzaW5n
bGVzdGVwIChzZWUgKipLVk1JX0dFVF9WRVJTSU9OKiopLgogCitBZnRlciBldmVyeSBpbnN0cnVj
dGlvbiwgYSAqS1ZNSV9WQ1BVX0VWRU5UX1NJTkdMRVNURVAqIGV2ZW50IGlzIHNlbnQKK3RvIHRo
ZSBpbnRyb3NwZWN0aW9uIHRvb2wuCisKIDpFcnJvcnM6CiAKKyogLUtWTV9FUEVSTSAgLSB0aGUg
KktWTUlfVkNQVV9FVkVOVF9TSU5HTEVTVEVQKiBldmVudCBpcyBkaXNhbGxvd2VkCiAqIC1LVk1f
RU9QTk9UU1VQUCAtIHRoZSBoYXJkd2FyZSBkb2Vzbid0IHN1cHBvcnQgc2luZ2xlc3RlcAogKiAt
S1ZNX0VJTlZBTCAtIHRoZSBwYWRkaW5nIGlzIG5vdCB6ZXJvCiAqIC1LVk1fRUFHQUlOIC0gdGhl
IHNlbGVjdGVkIHZDUFUgY2FuJ3QgYmUgaW50cm9zcGVjdGVkIHlldApAQCAtMTUwOCwzICsxNTEz
LDI5IEBAIGVtdWxhdGlvbikuCiBUaGUgKlJFVFJZKiBhY3Rpb24gaXMgdXNlZCBieSB0aGUgaW50
cm9zcGVjdGlvbiB0b29sIHRvIHJldHJ5IHRoZQogZXhlY3V0aW9uIG9mIHRoZSBjdXJyZW50IGlu
c3RydWN0aW9uLCB1c3VhbGx5IGJlY2F1c2UgaXQgY2hhbmdlZCB0aGUKIGluc3RydWN0aW9uIHBv
aW50ZXIgb3IgdGhlIHBhZ2UgcmVzdHJpY3Rpb25zLgorCisxMS4gS1ZNSV9WQ1BVX0VWRU5UX1NJ
TkdMRVNURVAKKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorCis6QXJjaGl0ZWN0dXJl
czogeDg2Cis6VmVyc2lvbnM6ID49IDEKKzpBY3Rpb25zOiBDT05USU5VRSwgQ1JBU0gKKzpQYXJh
bWV0ZXJzOgorCis6OgorCisJc3RydWN0IGt2bWlfdmNwdV9ldmVudDsKKworOlJldHVybnM6CisK
Kzo6CisKKwlzdHJ1Y3Qga3ZtaV92Y3B1X2hkcjsKKwlzdHJ1Y3Qga3ZtaV92Y3B1X2V2ZW50X3Jl
cGx5OworCXN0cnVjdCBrdm1pX3ZjcHVfZXZlbnRfc2luZ2xlc3RlcCB7CisJCV9fdTggZmFpbGVk
OworCQlfX3U4IHBhZGRpbmdbN107CisJfTsKKworVGhpcyBldmVudCBpcyBzZW50IGFmdGVyIGVh
Y2ggaW5zdHJ1Y3Rpb24sIGFzIGxvbmcgYXMgdGhlIHNpbmdsZXN0ZXAgaXMKK2VuYWJsZWQgZm9y
IHRoZSBjdXJyZW50IHZDUFUgKHNlZSAqKktWTUlfVkNQVV9DT05UUk9MX1NJTkdMRVNURVAqKiku
CmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9rdm0va3ZtaS5jIGIvYXJjaC94ODYva3ZtL2t2bWkuYwpp
bmRleCAzMWEyZGUyNGRlMjkuLmIwMTBkMjM2OTc1NiAxMDA2NDQKLS0tIGEvYXJjaC94ODYva3Zt
L2t2bWkuYworKysgYi9hcmNoL3g4Ni9rdm0va3ZtaS5jCkBAIC0xOCw2ICsxOCw3IEBAIHZvaWQg
a3ZtaV9hcmNoX2luaXRfdmNwdV9ldmVudHNfbWFzayh1bnNpZ25lZCBsb25nICpzdXBwb3J0ZWQp
CiAJc2V0X2JpdChLVk1JX1ZDUFVfRVZFTlRfREVTQ1JJUFRPUiwgc3VwcG9ydGVkKTsKIAlzZXRf
Yml0KEtWTUlfVkNQVV9FVkVOVF9NU1IsIHN1cHBvcnRlZCk7CiAJc2V0X2JpdChLVk1JX1ZDUFVf
RVZFTlRfUEYsIHN1cHBvcnRlZCk7CisJc2V0X2JpdChLVk1JX1ZDUFVfRVZFTlRfU0lOR0xFU1RF
UCwgc3VwcG9ydGVkKTsKIAlzZXRfYml0KEtWTUlfVkNQVV9FVkVOVF9UUkFQLCBzdXBwb3J0ZWQp
OwogCXNldF9iaXQoS1ZNSV9WQ1BVX0VWRU5UX1hTRVRCViwgc3VwcG9ydGVkKTsKIH0KZGlmZiAt
LWdpdCBhL2FyY2gveDg2L2t2bS9rdm1pX21zZy5jIGIvYXJjaC94ODYva3ZtL2t2bWlfbXNnLmMK
aW5kZXggOGI1OWY5ZjczYzVkLi5jNGI0M2IzYjdiOTIgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2
bS9rdm1pX21zZy5jCisrKyBiL2FyY2gveDg2L2t2bS9rdm1pX21zZy5jCkBAIC0yODUsNiArMjg1
LDEyIEBAIHN0YXRpYyBpbnQgaGFuZGxlX3ZjcHVfY29udHJvbF9zaW5nbGVzdGVwKGNvbnN0IHN0
cnVjdCBrdm1pX3ZjcHVfbXNnX2pvYiAqam9iLAogCXN0cnVjdCBrdm1fdmNwdSAqdmNwdSA9IGpv
Yi0+dmNwdTsKIAlpbnQgZWMgPSAwOwogCisJaWYgKCFrdm1pX2lzX2V2ZW50X2FsbG93ZWQoS1ZN
SSh2Y3B1LT5rdm0pLAorCQkJCSAgIEtWTUlfVkNQVV9FVkVOVF9TSU5HTEVTVEVQKSkgeworCQll
YyA9IC1LVk1fRVBFUk07CisJCWdvdG8gcmVwbHk7CisJfQorCiAJaWYgKG5vbl96ZXJvX3BhZGRp
bmcocmVxLT5wYWRkaW5nLCBBUlJBWV9TSVpFKHJlcS0+cGFkZGluZykpIHx8CiAJICAgIHJlcS0+
ZW5hYmxlID4gMSkgewogCQllYyA9IC1LVk1fRUlOVkFMOwpkaWZmIC0tZ2l0IGEvYXJjaC94ODYv
a3ZtL3ZteC92bXguYyBiL2FyY2gveDg2L2t2bS92bXgvdm14LmMKaW5kZXggMDFkMThjOTI0M2Jj
Li40ODA0ZWFhMDEyZGUgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS92bXgvdm14LmMKKysrIGIv
YXJjaC94ODYva3ZtL3ZteC92bXguYwpAQCAtNTYxNCw2ICs1NjE0LDcgQEAgc3RhdGljIGludCBo
YW5kbGVfaW52YWxpZF9vcChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCiAKIHN0YXRpYyBpbnQgaGFu
ZGxlX21vbml0b3JfdHJhcChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCiB7CisJa3ZtaV9zaW5nbGVz
dGVwX2RvbmUodmNwdSk7CiAJcmV0dXJuIDE7CiB9CiAKQEAgLTYxNDIsNiArNjE0MywxMSBAQCBz
dGF0aWMgaW50IHZteF9oYW5kbGVfZXhpdChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIGZhc3RwYXRo
X3QgZXhpdF9mYXN0cGF0aCkKIAkJfQogCX0KIAorCWlmIChrdm1pX3ZjcHVfcnVubmluZ19zaW5n
bGVzdGVwKHZjcHUpICYmCisJICAgIGV4aXRfcmVhc29uICE9IEVYSVRfUkVBU09OX0VQVF9WSU9M
QVRJT04gJiYKKwkgICAgZXhpdF9yZWFzb24gIT0gRVhJVF9SRUFTT05fTU9OSVRPUl9UUkFQX0ZM
QUcpCisJCWt2bWlfc2luZ2xlc3RlcF9mYWlsZWQodmNwdSk7CisKIAlpZiAoZXhpdF9mYXN0cGF0
aCAhPSBFWElUX0ZBU1RQQVRIX05PTkUpCiAJCXJldHVybiAxOwogCmRpZmYgLS1naXQgYS9pbmNs
dWRlL2xpbnV4L2t2bWlfaG9zdC5oIGIvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaAppbmRleCBl
MjEwM2FiOWQwZDUuLmVjMzhlNDM0YzhlOSAxMDA2NDQKLS0tIGEvaW5jbHVkZS9saW51eC9rdm1p
X2hvc3QuaAorKysgYi9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oCkBAIC04MSw2ICs4MSw4IEBA
IHZvaWQga3ZtaV9oYW5kbGVfcmVxdWVzdHMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIGJvb2wg
a3ZtaV9oeXBlcmNhbGxfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIGJvb2wga3ZtaV9i
cmVha3BvaW50X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTY0IGd2YSwgdTggaW5zbl9s
ZW4pOwogYm9vbCBrdm1pX3ZjcHVfcnVubmluZ19zaW5nbGVzdGVwKHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSk7Cit2b2lkIGt2bWlfc2luZ2xlc3RlcF9kb25lKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7
Cit2b2lkIGt2bWlfc2luZ2xlc3RlcF9mYWlsZWQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIAog
I2Vsc2UKIApAQCAtOTcsNiArOTksOCBAQCBzdGF0aWMgaW5saW5lIGJvb2wga3ZtaV9icmVha3Bv
aW50X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTY0IGd2YSwKIAkJCQkJIHU4IGluc25f
bGVuKSB7IHJldHVybiB0cnVlOyB9CiBzdGF0aWMgaW5saW5lIGJvb2wga3ZtaV92Y3B1X3J1bm5p
bmdfc2luZ2xlc3RlcChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCiAJCQl7IHJldHVybiBmYWxzZTsg
fQorc3RhdGljIGlubGluZSB2b2lkIGt2bWlfc2luZ2xlc3RlcF9kb25lKHN0cnVjdCBrdm1fdmNw
dSAqdmNwdSkgeyB9CitzdGF0aWMgaW5saW5lIHZvaWQga3ZtaV9zaW5nbGVzdGVwX2ZhaWxlZChz
dHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpIHsgfQogCiAjZW5kaWYgLyogQ09ORklHX0tWTV9JTlRST1NQ
RUNUSU9OICovCiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmggYi9pbmNs
dWRlL3VhcGkvbGludXgva3ZtaS5oCmluZGV4IDkxMTI2NjA3YjdlYi4uOWM2NDYyMjlhMjVhIDEw
MDY0NAotLS0gYS9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oCisrKyBiL2luY2x1ZGUvdWFwaS9s
aW51eC9rdm1pLmgKQEAgLTc0LDYgKzc0LDcgQEAgZW51bSB7CiAJS1ZNSV9WQ1BVX0VWRU5UX0RF
U0NSSVBUT1IgPSBLVk1JX1ZDUFVfRVZFTlRfSUQoNiksCiAJS1ZNSV9WQ1BVX0VWRU5UX01TUiAg
ICAgICAgPSBLVk1JX1ZDUFVfRVZFTlRfSUQoNyksCiAJS1ZNSV9WQ1BVX0VWRU5UX1BGICAgICAg
ICAgPSBLVk1JX1ZDUFVfRVZFTlRfSUQoOCksCisJS1ZNSV9WQ1BVX0VWRU5UX1NJTkdMRVNURVAg
PSBLVk1JX1ZDUFVfRVZFTlRfSUQoOSksCiAKIAlLVk1JX05FWFRfVkNQVV9FVkVOVAogfTsKQEAg
LTIyNyw0ICsyMjgsOSBAQCBzdHJ1Y3Qga3ZtaV92Y3B1X2NvbnRyb2xfc2luZ2xlc3RlcCB7CiAJ
X191OCBwYWRkaW5nWzddOwogfTsKIAorc3RydWN0IGt2bWlfdmNwdV9ldmVudF9zaW5nbGVzdGVw
IHsKKwlfX3U4IGZhaWxlZDsKKwlfX3U4IHBhZGRpbmdbN107Cit9OworCiAjZW5kaWYgLyogX1VB
UElfX0xJTlVYX0tWTUlfSCAqLwpkaWZmIC0tZ2l0IGEvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMv
a3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZf
NjQva3ZtaV90ZXN0LmMKaW5kZXggZDk1OTIxNmFhYzlkLi5jNmY0MWY1NGY5YjAgMTAwNjQ0Ci0t
LSBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKKysrIGIv
dG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYwpAQCAtMTgzNCwx
MiArMTgzNCw2MCBAQCBzdGF0aWMgdm9pZCBjbWRfdmNwdV9zaW5nbGVzdGVwKHN0cnVjdCBrdm1f
dm0gKnZtLCBfX3U4IGVuYWJsZSwKIAkJCSAgICZyZXEuaGRyLCBzaXplb2YocmVxKSwgTlVMTCwg
MCwgZXhwZWN0ZWRfZXJyKTsKIH0KIAorc3RhdGljIHZvaWQgX19jb250cm9sX3NpbmdsZXN0ZXAo
Ym9vbCBlbmFibGUpCit7CisJc3RydWN0IHsKKwkJc3RydWN0IGt2bWlfbXNnX2hkciBoZHI7CisJ
CXN0cnVjdCBrdm1pX3ZjcHVfaGRyIHZjcHVfaGRyOworCQlzdHJ1Y3Qga3ZtaV92Y3B1X2NvbnRy
b2xfc2luZ2xlc3RlcCBjbWQ7CisJfSByZXEgPSB7fTsKKwlpbnQgcjsKKworCXJlcS5jbWQuZW5h
YmxlID0gZW5hYmxlID8gMSA6IDA7CisKKwlyID0gX19kb192Y3B1MF9jb21tYW5kKEtWTUlfVkNQ
VV9DT05UUk9MX1NJTkdMRVNURVAsCisJCQkgICAgICZyZXEuaGRyLCBzaXplb2YocmVxKSwgTlVM
TCwgMCk7CisJVEVTVF9BU1NFUlQociA9PSAwLAorCQkiS1ZNSV9WQ1BVX0NPTlRST0xfU0lOR0xF
U1RFUCBmYWlsZWQsIGVycm9yICVkKCVzKVxuIiwKKwkJLXIsIGt2bV9zdHJlcnJvcigtcikpOwor
fQorCitzdGF0aWMgdm9pZCB0ZXN0X3NpbmdsZXN0ZXBfZXZlbnQoX191MTYgZXZlbnRfaWQpCit7
CisJc3RydWN0IHsKKwkJc3RydWN0IHZjcHVfZXZlbnQgdmNwdV9ldjsKKwkJc3RydWN0IGt2bWlf
dmNwdV9ldmVudF9zaW5nbGVzdGVwIHNpbmdsZXN0ZXA7CisJfSBldjsKKwlib29sIGVuYWJsZSA9
IHRydWUsIGRpc2FibGUgPSBmYWxzZTsKKwlzdHJ1Y3QgdmNwdV9yZXBseSBycGwgPSB7IH07CisJ
c3RydWN0IGt2bWlfbXNnX2hkciBoZHI7CisKKwlfX2NvbnRyb2xfc2luZ2xlc3RlcChlbmFibGUp
OworCisJcmVjZWl2ZV92Y3B1X2V2ZW50KCZoZHIsICZldi52Y3B1X2V2LCBzaXplb2YoZXYpLCBl
dmVudF9pZCk7CisKKwlwcl9kZWJ1ZygiU0lOR0xFU1RFUCBldmVudCwgcmlwIDB4JWxseCBzdWNj
ZXNzICVkXG4iLAorCQkgZXYudmNwdV9ldi5jb21tb24uYXJjaC5yZWdzLnJpcCwgIWV2LnNpbmds
ZXN0ZXAuZmFpbGVkKTsKKwlURVNUX0FTU0VSVCghZXYuc2luZ2xlc3RlcC5mYWlsZWQsICJTaW5n
bGVzdGVwIGZhaWxlZCIpOworCisJX19jb250cm9sX3NpbmdsZXN0ZXAoZGlzYWJsZSk7CisKKwly
ZXBseV90b19ldmVudCgmaGRyLCAmZXYudmNwdV9ldiwgS1ZNSV9FVkVOVF9BQ1RJT05fQ09OVElO
VUUsCisJCSAgICAgICAmcnBsLCBzaXplb2YocnBsKSk7Cit9CisKIHN0YXRpYyB2b2lkIHRlc3Rf
c3VwcG9ydGVkX3NpbmdsZXN0ZXAoc3RydWN0IGt2bV92bSAqdm0pCiB7Ci0JX191OCBkaXNhYmxl
ID0gMCwgZW5hYmxlID0gMSwgZW5hYmxlX2ludmFsID0gMjsKKwlzdHJ1Y3QgdmNwdV93b3JrZXJf
ZGF0YSBkYXRhID0gey52bSA9IHZtLCAudmNwdV9pZCA9IFZDUFVfSUQgfTsKKwlfX3UxNiBldmVu
dF9pZCA9IEtWTUlfVkNQVV9FVkVOVF9TSU5HTEVTVEVQOworCV9fdTggZW5hYmxlX2ludmFsID0g
MjsKKwlwdGhyZWFkX3QgdmNwdV90aHJlYWQ7CiAKLQljbWRfdmNwdV9zaW5nbGVzdGVwKHZtLCBl
bmFibGUsIDApOwotCWNtZF92Y3B1X3NpbmdsZXN0ZXAodm0sIGRpc2FibGUsIDApOworCWVuYWJs
ZV92Y3B1X2V2ZW50KHZtLCBldmVudF9pZCk7CisJdmNwdV90aHJlYWQgPSBzdGFydF92Y3B1X3dv
cmtlcigmZGF0YSk7CisJdGVzdF9zaW5nbGVzdGVwX2V2ZW50KGV2ZW50X2lkKTsKKwl3YWl0X3Zj
cHVfd29ya2VyKHZjcHVfdGhyZWFkKTsKKwlkaXNhYmxlX3ZjcHVfZXZlbnQodm0sIGV2ZW50X2lk
KTsKIAogCWNtZF92Y3B1X3NpbmdsZXN0ZXAodm0sIGVuYWJsZV9pbnZhbCwgLUtWTV9FSU5WQUwp
OwogfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMgYi92aXJ0L2t2
bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwppbmRleCBmNjIwMzk2ZDE4ODcuLjMwNTdmOWYzNDNjMCAx
MDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKKysrIGIvdmlydC9rdm0v
aW50cm9zcGVjdGlvbi9rdm1pLmMKQEAgLTExOTIsMyArMTE5Miw0NiBAQCBib29sIGt2bWlfdmNw
dV9ydW5uaW5nX3NpbmdsZXN0ZXAoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQogCXJldHVybiByZXQ7
CiB9CiBFWFBPUlRfU1lNQk9MKGt2bWlfdmNwdV9ydW5uaW5nX3NpbmdsZXN0ZXApOworCitzdGF0
aWMgdm9pZCBrdm1pX3NpbmdsZXN0ZXBfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBib29s
IHN1Y2Nlc3MpCit7CisJdTMyIGFjdGlvbjsKKworCWFjdGlvbiA9IGt2bWlfbXNnX3NlbmRfdmNw
dV9zaW5nbGVzdGVwKHZjcHUsIHN1Y2Nlc3MpOworCXN3aXRjaCAoYWN0aW9uKSB7CisJY2FzZSBL
Vk1JX0VWRU5UX0FDVElPTl9DT05USU5VRToKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJa3ZtaV9o
YW5kbGVfY29tbW9uX2V2ZW50X2FjdGlvbnModmNwdSwgYWN0aW9uKTsKKwl9Cit9CisKK3N0YXRp
YyB2b2lkIGt2bWlfaGFuZGxlX3NpbmdsZXN0ZXBfZXhpdChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUs
IGJvb2wgc3VjY2VzcykKK3sKKwlzdHJ1Y3Qga3ZtX3ZjcHVfaW50cm9zcGVjdGlvbiAqdmNwdWk7
CisJc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pOworCXN0cnVjdCBrdm0gKmt2bSA9IHZj
cHUtPmt2bTsKKworCWt2bWkgPSBrdm1pX2dldChrdm0pOworCWlmICgha3ZtaSkKKwkJcmV0dXJu
OworCisJdmNwdWkgPSBWQ1BVSSh2Y3B1KTsKKworCWlmICh2Y3B1aS0+c2luZ2xlc3RlcC5sb29w
KQorCQlrdm1pX3NpbmdsZXN0ZXBfZXZlbnQodmNwdSwgc3VjY2Vzcyk7CisKKwlrdm1pX3B1dChr
dm0pOworfQorCit2b2lkIGt2bWlfc2luZ2xlc3RlcF9kb25lKHN0cnVjdCBrdm1fdmNwdSAqdmNw
dSkKK3sKKwlrdm1pX2hhbmRsZV9zaW5nbGVzdGVwX2V4aXQodmNwdSwgdHJ1ZSk7Cit9CitFWFBP
UlRfU1lNQk9MKGt2bWlfc2luZ2xlc3RlcF9kb25lKTsKKwordm9pZCBrdm1pX3NpbmdsZXN0ZXBf
ZmFpbGVkKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKK3sKKwlrdm1pX2hhbmRsZV9zaW5nbGVzdGVw
X2V4aXQodmNwdSwgZmFsc2UpOworfQorRVhQT1JUX1NZTUJPTChrdm1pX3NpbmdsZXN0ZXBfZmFp
bGVkKTsKZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCBiL3Zp
cnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaAppbmRleCA0ODE1ZmE2MWIxMzYuLjVmNGJj
ZGYyN2Q2YSAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCisr
KyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaApAQCAtNjQsNiArNjQsNyBAQCB1
MzIga3ZtaV9tc2dfc2VuZF92Y3B1X3BhdXNlKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7CiB1MzIg
a3ZtaV9tc2dfc2VuZF92Y3B1X2h5cGVyY2FsbChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwogdTMy
IGt2bWlfbXNnX3NlbmRfdmNwdV9icChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU2NCBncGEsIHU4
IGluc25fbGVuKTsKIHUzMiBrdm1pX21zZ19zZW5kX3ZjcHVfcGYoc3RydWN0IGt2bV92Y3B1ICp2
Y3B1LCB1NjQgZ3BhLCB1NjQgZ3ZhLCB1OCBhY2Nlc3MpOwordTMyIGt2bWlfbXNnX3NlbmRfdmNw
dV9zaW5nbGVzdGVwKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgYm9vbCBzdWNjZXNzKTsKIAogLyog
a3ZtaS5jICovCiB2b2lkICprdm1pX21zZ19hbGxvYyh2b2lkKTsKZGlmZiAtLWdpdCBhL3ZpcnQv
a3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3Zt
aV9tc2cuYwppbmRleCBlZTg4N2FkZTYyY2IuLmZhMGRiMDA1NzBmNCAxMDA2NDQKLS0tIGEvdmly
dC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rp
b24va3ZtaV9tc2cuYwpAQCAtODkxLDMgKzg5MSwyMCBAQCB1MzIga3ZtaV9tc2dfc2VuZF92Y3B1
X3BmKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTY0IGdwYSwgdTY0IGd2YSwgdTggYWNjZXNzKQog
CiAJcmV0dXJuIGFjdGlvbjsKIH0KKwordTMyIGt2bWlfbXNnX3NlbmRfdmNwdV9zaW5nbGVzdGVw
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgYm9vbCBzdWNjZXNzKQoreworCXN0cnVjdCBrdm1pX3Zj
cHVfZXZlbnRfc2luZ2xlc3RlcCBlOworCXUzMiBhY3Rpb247CisJaW50IGVycjsKKworCW1lbXNl
dCgmZSwgMCwgc2l6ZW9mKGUpKTsKKwllLmZhaWxlZCA9IHN1Y2Nlc3MgPyAwIDogMTsKKworCWVy
ciA9IGt2bWlfc2VuZF92Y3B1X2V2ZW50KHZjcHUsIEtWTUlfVkNQVV9FVkVOVF9TSU5HTEVTVEVQ
LAorCQkJCSAgICZlLCBzaXplb2YoZSksIE5VTEwsIDAsICZhY3Rpb24pOworCWlmIChlcnIpCisJ
CXJldHVybiBLVk1JX0VWRU5UX0FDVElPTl9DT05USU5VRTsKKworCXJldHVybiBhY3Rpb247Cit9
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClZpcnR1YWxp
emF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0cy5saW51eC1mb3VuZGF0aW9u
Lm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcvbWFpbG1hbi9saXN0aW5mby92
aXJ0dWFsaXphdGlvbg==
