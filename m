Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
	by mail.lfdr.de (Postfix) with ESMTPS id 7091C197897
	for <lists.virtualization@lfdr.de>; Mon, 30 Mar 2020 12:13:32 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by whitealder.osuosl.org (Postfix) with ESMTP id F27D3878F4;
	Mon, 30 Mar 2020 10:13:30 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 5tKgE1WgoXeE; Mon, 30 Mar 2020 10:13:25 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by whitealder.osuosl.org (Postfix) with ESMTP id 2D51B87C1C;
	Mon, 30 Mar 2020 10:13:18 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 261F4C07FF;
	Mon, 30 Mar 2020 10:13:18 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id D5CE5C07FF
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:13:15 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by silver.osuosl.org (Postfix) with ESMTP id B7BA023086
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:13:15 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id gLhm-TRwwSAC
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:12:57 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by silver.osuosl.org (Postfix) with ESMTPS id CF10923026
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:12:56 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 D9AE3307503A; Mon, 30 Mar 2020 13:12:54 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id B83CA305B7A1;
 Mon, 30 Mar 2020 13:12:54 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v8 39/81] KVM: introspection: add hook/unhook ioctls
Date: Mon, 30 Mar 2020 13:12:26 +0300
Message-Id: <20200330101308.21702-40-alazar@bitdefender.com>
In-Reply-To: <20200330101308.21702-1-alazar@bitdefender.com>
References: <20200330101308.21702-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <ncitu@bitdefender.com>,
 =?UTF-8?q?Mircea=20C=C3=AErjaliu?= <mcirjaliu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gaG9vaywgYSBuZXcgdGhyZWFkIGlzIGNyZWF0ZWQgdG8gaGFuZGxlIHRoZSBtZXNzYWdlcyBj
b21pbmcgZnJvbSB0aGUKaW50cm9zcGVjdGlvbiB0b29sIChjb21tYW5kcyBvciBldmVudCByZXBs
aWVzKS4KCkNvLWRldmVsb3BlZC1ieTogTWlyY2VhIEPDrnJqYWxpdSA8bWNpcmphbGl1QGJpdGRl
ZmVuZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogTWlyY2VhIEPDrnJqYWxpdSA8bWNpcmphbGl1QGJp
dGRlZmVuZGVyLmNvbT4KQ28tZGV2ZWxvcGVkLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5jaXR1QGJp
dGRlZmVuZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogTmljdciZb3IgQ8OuyJt1IDxuY2l0dUBiaXRk
ZWZlbmRlci5jb20+ClNpZ25lZC1vZmYtYnk6IEFkYWxiZXJ0IExhesSDciA8YWxhemFyQGJpdGRl
ZmVuZGVyLmNvbT4KLS0tCiBEb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2FwaS5yc3QgICAgICAgICAg
ICAgICAgfCAgNTAgKysrKysrCiBhcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1pX2hvc3QuaCAgICAg
ICAgICAgICAgfCAgIDggKwogYXJjaC94ODYva3ZtL01ha2VmaWxlICAgICAgICAgICAgICAgICAg
ICAgICAgIHwgICAyICstCiBhcmNoL3g4Ni9rdm0veDg2LmMgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfCAgIDUgKwogaW5jbHVkZS9saW51eC9rdm1faG9zdC5oICAgICAgICAgICAgICAgICAg
ICAgIHwgICA0ICsKIGluY2x1ZGUvbGludXgva3ZtaV9ob3N0LmggICAgICAgICAgICAgICAgICAg
ICB8ICAxNyArKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2bS5oICAgICAgICAgICAgICAgICAgICAg
IHwgIDEwICsrCiBpbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oICAgICAgICAgICAgICAgICAgICAg
fCAgMTMgKysKIHRvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS9NYWtlZmlsZSAgICAgICAgICB8
ICAgMSArCiAuLi4vdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyAgfCAg
ODMgKysrKysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyAgICAgICAgICAgICAg
ICAgfCAxNjEgKysrKysrKysrKysrKysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlf
aW50LmggICAgICAgICAgICAgfCAgMjAgKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlf
bXNnLmMgICAgICAgICAgICAgfCAgMzkgKysrKysKIHZpcnQva3ZtL2t2bV9tYWluLmMgICAgICAg
ICAgICAgICAgICAgICAgICAgICB8ICAxMSArKwogMTQgZmlsZXMgY2hhbmdlZCwgNDIzIGluc2Vy
dGlvbnMoKyksIDEgZGVsZXRpb24oLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBhcmNoL3g4Ni9pbmNs
dWRlL2FzbS9rdm1pX2hvc3QuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGluY2x1ZGUvdWFwaS9saW51
eC9rdm1pLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0v
eDg2XzY0L2t2bWlfdGVzdC5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgdmlydC9rdm0vaW50cm9zcGVj
dGlvbi9rdm1pX21zZy5jCgpkaWZmIC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9hcGku
cnN0IGIvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9hcGkucnN0CmluZGV4IGViZDM4M2ZiYTkzOS4u
M2ZmNDJlNWU2ZDYzIDEwMDY0NAotLS0gYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2FwaS5yc3QK
KysrIGIvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9hcGkucnN0CkBAIC00NjQ4LDYgKzQ2NDgsNTYg
QEAgVGhpcyBpb2N0bCByZXNldHMgVkNQVSByZWdpc3RlcnMgYW5kIGNvbnRyb2wgc3RydWN0dXJl
cyBhY2NvcmRpbmcgdG8KIHRoZSBjbGVhciBjcHUgcmVzZXQgZGVmaW5pdGlvbiBpbiB0aGUgUE9Q
LiBIb3dldmVyLCB0aGUgY3B1IGlzIG5vdCBwdXQKIGludG8gRVNBIG1vZGUuIFRoaXMgcmVzZXQg
aXMgYSBzdXBlcnNldCBvZiB0aGUgaW5pdGlhbCByZXNldC4KIAorNC4xMjUgS1ZNX0lOVFJPU1BF
Q1RJT05fSE9PSworLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorCis6Q2FwYWJpbGl0eTog
S1ZNX0NBUF9JTlRST1NQRUNUSU9OCis6QXJjaGl0ZWN0dXJlczogeDg2Cis6VHlwZTogdm0gaW9j
dGwKKzpQYXJhbWV0ZXJzOiBzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKGluKQorOlJldHVybnM6
IDAgb24gc3VjY2VzcywgYSBuZWdhdGl2ZSB2YWx1ZSBvbiBlcnJvcgorCitFcnJvcnM6CisKKyAg
PT09PT09ICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09CisgIEVGQVVMVCAgICAgdGhlIGludHJvc3BlY3Rpb24gaXMgbm90IGVuYWJs
ZWQKKyAgRU5PTUVNICAgICB0aGUgbWVtb3J5IGFsbG9jYXRpb24gZmFpbGVkCisgIEVFWElTVCAg
ICAgdGhlIFZNIGlzIGFscmVhZHkgaW50cm9zcGVjdGVkCisgIEVJTlZBTCAgICAgdGhlIGZpbGUg
ZGVzY3JpcHRvciBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYW4gYWN0aXZlIHNvY2tldAorICBFSU5W
QUwgICAgIHRoZSBwYWRkaW5nIGlzIG5vdCB6ZXJvCisgIEVQRVJNICAgICAgdGhlIGludHJvc3Bl
Y3Rpb24gaXMgZGlzYWJsZWQgKGt2bS5pbnRyb3NwZWN0aW9uPTApCisgID09PT09PSAgICAgPT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQor
CitUaGlzIGlvY3RsIGlzIHVzZWQgdG8gZW5hYmxlIHRoZSBpbnRyb3NwZWN0aW9uIG9mIHRoZSBj
dXJyZW50IFZNLgorCis6OgorCisgIHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiB7CisJX19zMzIg
ZmQ7CisJX191MzIgcGFkZGluZzsKKwlfX3U4IHV1aWRbMTZdOworICB9OworCitmZCBpcyB0aGUg
ZmlsZSBkZXNjcmlwdG9yIG9mIGEgc29ja2V0IGNvbm5lY3RlZCB0byB0aGUgaW50cm9zcGVjdGlv
biB0b29sLAorCitwYWRkaW5nIG11c3QgYmUgemVybyAoaXQgbWlnaHQgYmUgdXNlZCBpbiB0aGUg
ZnV0dXJlKSwKKwordXVpZCBpcyB1c2VkIGZvciBkZWJ1ZyBhbmQgZXJyb3IgbWVzc2FnZXMuCisK
K1RoZSBLVk1JIHZlcnNpb24gY2FuIGJlIHJldHJpZXZlZCB1c2luZyB0aGUgS1ZNX0NBUF9JTlRS
T1NQRUNUSU9OIG9mCit0aGUgS1ZNX0NIRUNLX0VYVEVOU0lPTiBpb2N0bCgpIGF0IHJ1bi10aW1l
LgorCis0LjEyNiBLVk1fSU5UUk9TUEVDVElPTl9VTkhPT0sKKy0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLQorCis6Q2FwYWJpbGl0eTogS1ZNX0NBUF9JTlRST1NQRUNUSU9OCis6QXJjaGl0
ZWN0dXJlczogeDg2Cis6VHlwZTogdm0gaW9jdGwKKzpQYXJhbWV0ZXJzOiBub25lCis6UmV0dXJu
czogMCBvbiBzdWNjZXNzLCBhIG5lZ2F0aXZlIHZhbHVlIG9uIGVycm9yCisKK1RoaXMgaW9jdGwg
aXMgdXNlZCB0byBmcmVlIGFsbCBpbnRyb3NwZWN0aW9uIHN0cnVjdHVyZXMKK3JlbGF0ZWQgdG8g
dGhpcyBWTS4KIAogNS4gVGhlIGt2bV9ydW4gc3RydWN0dXJlCiA9PT09PT09PT09PT09PT09PT09
PT09PT0KZGlmZiAtLWdpdCBhL2FyY2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5oIGIvYXJj
aC94ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMDAwMDAwLi4zOGMzOTgyNjI5MTMKLS0tIC9kZXYvbnVsbAorKysgYi9hcmNoL3g4Ni9p
bmNsdWRlL2FzbS9rdm1pX2hvc3QuaApAQCAtMCwwICsxLDggQEAKKy8qIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBHUEwtMi4wICovCisjaWZuZGVmIF9BU01fWDg2X0tWTUlfSE9TVF9ICisjZGVm
aW5lIF9BU01fWDg2X0tWTUlfSE9TVF9ICisKK3N0cnVjdCBrdm1fYXJjaF9pbnRyb3NwZWN0aW9u
IHsKK307CisKKyNlbmRpZiAvKiBfQVNNX1g4Nl9LVk1JX0hPU1RfSCAqLwpkaWZmIC0tZ2l0IGEv
YXJjaC94ODYva3ZtL01ha2VmaWxlIGIvYXJjaC94ODYva3ZtL01ha2VmaWxlCmluZGV4IGY0NDMx
OThmNzgyYy4uOWQwNWI1YmYyMzYwIDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9rdm0vTWFrZWZpbGUK
KysrIGIvYXJjaC94ODYva3ZtL01ha2VmaWxlCkBAIC05LDcgKzksNyBAQCBLVk1JIDo9ICQoS1ZN
KS9pbnRyb3NwZWN0aW9uCiBrdm0teQkJCSs9ICQoS1ZNKS9rdm1fbWFpbi5vICQoS1ZNKS9jb2Fs
ZXNjZWRfbW1pby5vIFwKIAkJCQkkKEtWTSkvZXZlbnRmZC5vICQoS1ZNKS9pcnFjaGlwLm8gJChL
Vk0pL3ZmaW8ubwoga3ZtLSQoQ09ORklHX0tWTV9BU1lOQ19QRikJKz0gJChLVk0pL2FzeW5jX3Bm
Lm8KLWt2bS0kKENPTkZJR19LVk1fSU5UUk9TUEVDVElPTikgKz0gJChLVk1JKS9rdm1pLm8KK2t2
bS0kKENPTkZJR19LVk1fSU5UUk9TUEVDVElPTikgKz0gJChLVk1JKS9rdm1pLm8gJChLVk1JKS9r
dm1pX21zZy5vCiAKIGt2bS15CQkJKz0geDg2Lm8gZW11bGF0ZS5vIGk4MjU5Lm8gaXJxLm8gbGFw
aWMubyBcCiAJCQkgICBpODI1NC5vIGlvYXBpYy5vIGlycV9jb21tLm8gY3B1aWQubyBwbXUubyBt
dHJyLm8gXApkaWZmIC0tZ2l0IGEvYXJjaC94ODYva3ZtL3g4Ni5jIGIvYXJjaC94ODYva3ZtL3g4
Ni5jCmluZGV4IDJhYWEwZGQ4YjAyYS4uNGZhMTFjOTk4MzI1IDEwMDY0NAotLS0gYS9hcmNoL3g4
Ni9rdm0veDg2LmMKKysrIGIvYXJjaC94ODYva3ZtL3g4Ni5jCkBAIC0zNDAzLDYgKzM0MDMsMTEg
QEAgaW50IGt2bV92bV9pb2N0bF9jaGVja19leHRlbnNpb24oc3RydWN0IGt2bSAqa3ZtLCBsb25n
IGV4dCkKIAljYXNlIEtWTV9DQVBfSFlQRVJWX0VOTElHSFRFTkVEX1ZNQ1M6CiAJCXIgPSBrdm1f
eDg2X29wcy0+bmVzdGVkX2VuYWJsZV9ldm1jcyAhPSBOVUxMOwogCQlicmVhazsKKyNpZmRlZiBD
T05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04KKwljYXNlIEtWTV9DQVBfSU5UUk9TUEVDVElPTjoKKwkJ
ciA9IEtWTUlfVkVSU0lPTjsKKwkJYnJlYWs7CisjZW5kaWYKIAlkZWZhdWx0OgogCQlicmVhazsK
IAl9CmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2t2bV9ob3N0LmggYi9pbmNsdWRlL2xpbnV4
L2t2bV9ob3N0LmgKaW5kZXggNWQxYTczYjVkOTRmLi4xZjFiMGRmZmFiYWEgMTAwNjQ0Ci0tLSBh
L2luY2x1ZGUvbGludXgva3ZtX2hvc3QuaAorKysgYi9pbmNsdWRlL2xpbnV4L2t2bV9ob3N0LmgK
QEAgLTUwMSw2ICs1MDEsMTAgQEAgc3RydWN0IGt2bSB7CiAJc3RydWN0IHNyY3Vfc3RydWN0IHNy
Y3U7CiAJc3RydWN0IHNyY3Vfc3RydWN0IGlycV9zcmN1OwogCXBpZF90IHVzZXJzcGFjZV9waWQ7
CisJc3RydWN0IG11dGV4IGt2bWlfbG9jazsKKwlyZWZjb3VudF90IGt2bWlfcmVmOworCXN0cnVj
dCBjb21wbGV0aW9uIGt2bWlfY29tcGxldGU7CisJc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICpr
dm1pOwogfTsKIAogI2RlZmluZSBrdm1fZXJyKGZtdCwgLi4uKSBcCmRpZmYgLS1naXQgYS9pbmNs
dWRlL2xpbnV4L2t2bWlfaG9zdC5oIGIvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaAppbmRleCA4
Y2Q2MTNmZGQ0ZjIuLmM4YjljODdlY2ZmMiAxMDA2NDQKLS0tIGEvaW5jbHVkZS9saW51eC9rdm1p
X2hvc3QuaAorKysgYi9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oCkBAIC0yLDggKzIsMjIgQEAK
ICNpZm5kZWYgX19LVk1JX0hPU1RfSAogI2RlZmluZSBfX0tWTUlfSE9TVF9ICiAKKyNpbmNsdWRl
IDx1YXBpL2xpbnV4L2t2bWkuaD4KKwogc3RydWN0IGt2bTsKIAorI2luY2x1ZGUgPGFzbS9rdm1p
X2hvc3QuaD4KKworc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uIHsKKwlzdHJ1Y3Qga3ZtX2FyY2hf
aW50cm9zcGVjdGlvbiBhcmNoOworCXN0cnVjdCBrdm0gKmt2bTsKKworCXV1aWRfdCB1dWlkOwor
CisJc3RydWN0IHNvY2tldCAqc29jazsKKwlzdHJ1Y3QgdGFza19zdHJ1Y3QgKnJlY3Y7Cit9Owor
CiAjaWZkZWYgQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OCiAKIGludCBrdm1pX2luaXQodm9pZCk7
CkBAIC0xMSw2ICsyNSw5IEBAIHZvaWQga3ZtaV91bmluaXQodm9pZCk7CiB2b2lkIGt2bWlfY3Jl
YXRlX3ZtKHN0cnVjdCBrdm0gKmt2bSk7CiB2b2lkIGt2bWlfZGVzdHJveV92bShzdHJ1Y3Qga3Zt
ICprdm0pOwogCitpbnQga3ZtaV9pb2N0bF9ob29rKHN0cnVjdCBrdm0gKmt2bSwgdm9pZCBfX3Vz
ZXIgKmFyZ3ApOworaW50IGt2bWlfaW9jdGxfdW5ob29rKHN0cnVjdCBrdm0gKmt2bSk7CisKICNl
bHNlCiAKIHN0YXRpYyBpbmxpbmUgaW50IGt2bWlfaW5pdCh2b2lkKSB7IHJldHVybiAwOyB9CmRp
ZmYgLS1naXQgYS9pbmNsdWRlL3VhcGkvbGludXgva3ZtLmggYi9pbmNsdWRlL3VhcGkvbGludXgv
a3ZtLmgKaW5kZXggNGI5NWY5YTMxYTJmLi42ZDEwNzZlZDkzYTcgMTAwNjQ0Ci0tLSBhL2luY2x1
ZGUvdWFwaS9saW51eC9rdm0uaAorKysgYi9pbmNsdWRlL3VhcGkvbGludXgva3ZtLmgKQEAgLTEw
MTAsNiArMTAxMCw3IEBAIHN0cnVjdCBrdm1fcHBjX3Jlc2l6ZV9ocHQgewogI2RlZmluZSBLVk1f
Q0FQX0FSTV9OSVNWX1RPX1VTRVIgMTc3CiAjZGVmaW5lIEtWTV9DQVBfQVJNX0lOSkVDVF9FWFRf
REFCVCAxNzgKICNkZWZpbmUgS1ZNX0NBUF9TMzkwX1ZDUFVfUkVTRVRTIDE3OQorI2RlZmluZSBL
Vk1fQ0FQX0lOVFJPU1BFQ1RJT04gMTgwCiAKICNpZmRlZiBLVk1fQ0FQX0lSUV9ST1VUSU5HCiAK
QEAgLTE1NTgsNiArMTU1OSwxNSBAQCBzdHJ1Y3Qga3ZtX3Nldl9kYmcgewogCV9fdTMyIGxlbjsK
IH07CiAKK3N0cnVjdCBrdm1faW50cm9zcGVjdGlvbl9ob29rIHsKKwlfX3MzMiBmZDsKKwlfX3Uz
MiBwYWRkaW5nOworCV9fdTggdXVpZFsxNl07Cit9OworCisjZGVmaW5lIEtWTV9JTlRST1NQRUNU
SU9OX0hPT0sgICAgX0lPVyhLVk1JTywgMHhjMywgc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uX2hv
b2spCisjZGVmaW5lIEtWTV9JTlRST1NQRUNUSU9OX1VOSE9PSyAgX0lPKEtWTUlPLCAweGM0KQor
CiAjZGVmaW5lIEtWTV9ERVZfQVNTSUdOX0VOQUJMRV9JT01NVQkoMSA8PCAwKQogI2RlZmluZSBL
Vk1fREVWX0FTU0lHTl9QQ0lfMl8zCQkoMSA8PCAxKQogI2RlZmluZSBLVk1fREVWX0FTU0lHTl9N
QVNLX0lOVFgJKDEgPDwgMikKZGlmZiAtLWdpdCBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgg
Yi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAw
MDAwMDAwMDAwMC4uMzRkZGE5MTAxNmRiCi0tLSAvZGV2L251bGwKKysrIGIvaW5jbHVkZS91YXBp
L2xpbnV4L2t2bWkuaApAQCAtMCwwICsxLDEzIEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogR1BMLTIuMCBXSVRIIExpbnV4LXN5c2NhbGwtbm90ZSAqLworI2lmbmRlZiBfVUFQSV9fTElO
VVhfS1ZNSV9ICisjZGVmaW5lIF9VQVBJX19MSU5VWF9LVk1JX0gKKworLyoKKyAqIEtWTUkgc3Ry
dWN0dXJlcyBhbmQgZGVmaW5pdGlvbnMKKyAqLworCitlbnVtIHsKKwlLVk1JX1ZFUlNJT04gPSAw
eDAwMDAwMDAxCit9OworCisjZW5kaWYgLyogX1VBUElfX0xJTlVYX0tWTUlfSCAqLwpkaWZmIC0t
Z2l0IGEvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL01ha2VmaWxlIGIvdG9vbHMvdGVzdGlu
Zy9zZWxmdGVzdHMva3ZtL01ha2VmaWxlCmluZGV4IGQ5MWM1M2I3MjZlNi4uZWQzMzRmZDQ4Y2U0
IDEwMDY0NAotLS0gYS90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0vTWFrZWZpbGUKKysrIGIv
dG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL01ha2VmaWxlCkBAIC0xNSw2ICsxNSw3IEBAIExJ
QktWTV9zMzkweCA9IGxpYi9zMzkweC9wcm9jZXNzb3IuYyBsaWIvczM5MHgvdWNhbGwuYwogVEVT
VF9HRU5fUFJPR1NfeDg2XzY0ID0geDg2XzY0L2NyNF9jcHVpZF9zeW5jX3Rlc3QKIFRFU1RfR0VO
X1BST0dTX3g4Nl82NCArPSB4ODZfNjQvZXZtY3NfdGVzdAogVEVTVF9HRU5fUFJPR1NfeDg2XzY0
ICs9IHg4Nl82NC9oeXBlcnZfY3B1aWQKK1RFU1RfR0VOX1BST0dTX3g4Nl82NCArPSB4ODZfNjQv
a3ZtaV90ZXN0CiBURVNUX0dFTl9QUk9HU194ODZfNjQgKz0geDg2XzY0L21taW9fd2FybmluZ190
ZXN0CiBURVNUX0dFTl9QUk9HU194ODZfNjQgKz0geDg2XzY0L3BsYXRmb3JtX2luZm9fdGVzdAog
VEVTVF9HRU5fUFJPR1NfeDg2XzY0ICs9IHg4Nl82NC9zZXRfc3JlZ3NfdGVzdApkaWZmIC0tZ2l0
IGEvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyBiL3Rvb2xz
L3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4xMDBmMDVjNTE4YWEKLS0tIC9kZXYvbnVsbAorKysg
Yi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCkBAIC0wLDAg
KzEsODMgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogS1ZN
IGludHJvc3BlY3Rpb24gdGVzdHMKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMjAsIEJpdGRlZmVu
ZGVyIFMuUi5MLgorICovCisKKyNkZWZpbmUgX0dOVV9TT1VSQ0UgLyogZm9yIHByb2dyYW1faW52
b2NhdGlvbl9zaG9ydF9uYW1lICovCisjaW5jbHVkZSA8c3lzL3R5cGVzLmg+CisjaW5jbHVkZSA8
c3lzL3NvY2tldC5oPgorCisjaW5jbHVkZSAidGVzdF91dGlsLmgiCisKKyNpbmNsdWRlICJrdm1f
dXRpbC5oIgorI2luY2x1ZGUgInByb2Nlc3Nvci5oIgorI2luY2x1ZGUgIi4uL2xpYi9rdm1fdXRp
bF9pbnRlcm5hbC5oIgorCisjaW5jbHVkZSAibGludXgva3ZtaS5oIgorCisjZGVmaW5lIFZDUFVf
SUQgICAgICAgICA1CisKK3N0YXRpYyBpbnQgc29ja2V0X3BhaXJbMl07CisjZGVmaW5lIEt2bV9z
b2NrZXQgICAgICAgc29ja2V0X3BhaXJbMF0KKyNkZWZpbmUgVXNlcnNwYWNlX3NvY2tldCBzb2Nr
ZXRfcGFpclsxXQorCit2b2lkIHNldHVwX3NvY2tldCh2b2lkKQoreworCWludCByOworCisJciA9
IHNvY2tldHBhaXIoQUZfVU5JWCwgU09DS19TVFJFQU0sIDAsIHNvY2tldF9wYWlyKTsKKwlURVNU
X0FTU0VSVChyID09IDAsCisJCSJzb2NrZXRwYWlyKCkgZmFpbGVkLCBlcnJubyAlZCAoJXMpXG4i
LAorCQllcnJubywgc3RyZXJyb3IoZXJybm8pKTsKK30KKworc3RhdGljIHZvaWQgaG9va19pbnRy
b3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlv
bl9ob29rIGhvb2sgPSB7LmZkID0gS3ZtX3NvY2tldH07CisJaW50IHI7CisKKwlyID0gaW9jdGwo
dm0tPmZkLCBLVk1fSU5UUk9TUEVDVElPTl9IT09LLCAmaG9vayk7CisJVEVTVF9BU1NFUlQociA9
PSAwLAorCQkiS1ZNX0lOVFJPU1BFQ1RJT05fSE9PSyBmYWlsZWQsIGVycm5vICVkICglcylcbiIs
CisJCWVycm5vLCBzdHJlcnJvcihlcnJubykpOworfQorCitzdGF0aWMgdm9pZCB1bmhvb2tfaW50
cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkKK3sKKwlpbnQgcjsKKworCXIgPSBpb2N0bCh2
bS0+ZmQsIEtWTV9JTlRST1NQRUNUSU9OX1VOSE9PSywgTlVMTCk7CisJVEVTVF9BU1NFUlQociA9
PSAwLAorCQkiS1ZNX0lOVFJPU1BFQ1RJT05fVU5IT09LIGZhaWxlZCwgZXJybm8gJWQgKCVzKVxu
IiwKKwkJZXJybm8sIHN0cmVycm9yKGVycm5vKSk7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3RfaW50
cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkKK3sKKwlzZXR1cF9zb2NrZXQoKTsKKwlob29r
X2ludHJvc3BlY3Rpb24odm0pOworCXVuaG9va19pbnRyb3NwZWN0aW9uKHZtKTsKK30KKworaW50
IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKK3sKKwlzdHJ1Y3Qga3ZtX3ZtICp2bTsKKwlp
bnQgdmVyc2lvbjsKKworCXZlcnNpb24gPSBrdm1fY2hlY2tfY2FwKEtWTV9DQVBfSU5UUk9TUEVD
VElPTik7CisJaWYgKHZlcnNpb24gIT0gS1ZNSV9WRVJTSU9OKSB7CisJCWZwcmludGYoc3RkZXJy
LAorCQkJIktWTV9DQVBfSU5UUk9TUEVDVElPTiBub3QgYXZhaWxhYmxlLCBza2lwcGluZyB0ZXN0
c1xuIik7CisJCWV4aXQoS1NGVF9TS0lQKTsKKwl9CisKKwl2bSA9IHZtX2NyZWF0ZV9kZWZhdWx0
KFZDUFVfSUQsIDAsIE5VTEwpOworCXZjcHVfc2V0X2NwdWlkKHZtLCBWQ1BVX0lELCBrdm1fZ2V0
X3N1cHBvcnRlZF9jcHVpZCgpKTsKKworCXRlc3RfaW50cm9zcGVjdGlvbih2bSk7CisKKwlrdm1f
dm1fZnJlZSh2bSk7CisJcmV0dXJuIDA7Cit9CmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3Nw
ZWN0aW9uL2t2bWkuYyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCmluZGV4IGM3NGRk
YjgwNzVjZC4uZWNlYmIwMGI0MjQ1IDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9u
L2t2bWkuYworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwpAQCAtNiw2ICs2LDcg
QEAKICAqCiAgKi8KICNpbmNsdWRlICJrdm1pX2ludC5oIgorI2luY2x1ZGUgPGxpbnV4L2t0aHJl
YWQuaD4KIAogaW50IGt2bWlfaW5pdCh2b2lkKQogewpAQCAtMTYsMTAgKzE3LDE3MCBAQCB2b2lk
IGt2bWlfdW5pbml0KHZvaWQpCiB7CiB9CiAKK3N0YXRpYyB2b2lkIGZyZWVfa3ZtaShzdHJ1Y3Qg
a3ZtICprdm0pCit7CisJa2ZyZWUoa3ZtLT5rdm1pKTsKKwlrdm0tPmt2bWkgPSBOVUxMOworfQor
CitzdGF0aWMgc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICoKK2FsbG9jX2t2bWkoc3RydWN0IGt2
bSAqa3ZtLCBjb25zdCBzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb25faG9vayAqaG9vaykKK3sKKwlz
dHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWk7CisKKwlrdm1pID0ga3phbGxvYyhzaXplb2Yo
Kmt2bWkpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWt2bWkpCisJCXJldHVybiBOVUxMOworCisJQlVJ
TERfQlVHX09OKHNpemVvZihob29rLT51dWlkKSAhPSBzaXplb2Yoa3ZtaS0+dXVpZCkpOworCW1l
bWNweSgma3ZtaS0+dXVpZCwgJmhvb2stPnV1aWQsIHNpemVvZihrdm1pLT51dWlkKSk7CisKKwlr
dm1pLT5rdm0gPSBrdm07CisKKwlyZXR1cm4ga3ZtaTsKK30KKworc3RhdGljIHZvaWQga3ZtaV9k
ZXN0cm95KHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSkKK3sKKwlzdHJ1Y3Qga3ZtICpr
dm0gPSBrdm1pLT5rdm07CisKKwlmcmVlX2t2bWkoa3ZtKTsKK30KKworc3RhdGljIHZvaWQga3Zt
aV9zdG9wX3JlY3ZfdGhyZWFkKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSkKK3sKKwlr
dm1pX3NvY2tfc2h1dGRvd24oa3ZtaSk7Cit9CisKK3N0YXRpYyB2b2lkIF9fa3ZtaV91bmhvb2so
c3RydWN0IGt2bSAqa3ZtKQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSA9IEtW
TUkoa3ZtKTsKKworCXdhaXRfZm9yX2NvbXBsZXRpb25fa2lsbGFibGUoJmt2bS0+a3ZtaV9jb21w
bGV0ZSk7CisJa3ZtaV9zb2NrX3B1dChrdm1pKTsKK30KKworc3RhdGljIHZvaWQga3ZtaV91bmhv
b2soc3RydWN0IGt2bSAqa3ZtKQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaTsK
KworCW11dGV4X2xvY2soJmt2bS0+a3ZtaV9sb2NrKTsKKworCWt2bWkgPSBLVk1JKGt2bSk7CisJ
aWYgKGt2bWkpIHsKKwkJa3ZtaV9zdG9wX3JlY3ZfdGhyZWFkKGt2bWkpOworCQlfX2t2bWlfdW5o
b29rKGt2bSk7CisJCWt2bWlfZGVzdHJveShrdm1pKTsKKwl9CisKKwltdXRleF91bmxvY2soJmt2
bS0+a3ZtaV9sb2NrKTsKK30KKworaW50IGt2bWlfaW9jdGxfdW5ob29rKHN0cnVjdCBrdm0gKmt2
bSkKK3sKKwlrdm1pX3VuaG9vayhrdm0pOworCXJldHVybiAwOworfQorCit2b2lkIGt2bWlfcHV0
KHN0cnVjdCBrdm0gKmt2bSkKK3sKKwlpZiAocmVmY291bnRfZGVjX2FuZF90ZXN0KCZrdm0tPmt2
bWlfcmVmKSkKKwkJY29tcGxldGUoJmt2bS0+a3ZtaV9jb21wbGV0ZSk7Cit9CisKK3N0YXRpYyBp
bnQgX19rdm1pX2hvb2soc3RydWN0IGt2bSAqa3ZtLAorCQkgICAgICAgY29uc3Qgc3RydWN0IGt2
bV9pbnRyb3NwZWN0aW9uX2hvb2sgKmhvb2spCit7CisJc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9u
ICprdm1pID0gS1ZNSShrdm0pOworCisJaWYgKCFrdm1pX3NvY2tfZ2V0KGt2bWksIGhvb2stPmZk
KSkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBrdm1p
X3JlY3ZfdGhyZWFkKHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2
bWkgPSBhcmc7CisKKwl3aGlsZSAoa3ZtaV9tc2dfcHJvY2Vzcyhrdm1pKSkKKwkJOworCisJLyoK
KwkgKiBTaWduYWwgdXNlcnNwYWNlICh3aGljaCBtaWdodCB3YWl0IGZvciBQT0xMSFVQIG9ubHkp
CisJICogYW5kIHByZXZlbnQgdGhlIHZDUFVzIGZyb20gc2VuZGluZyBvdGhlciBldmVudHMuCisJ
ICovCisJa3ZtaV9zb2NrX3NodXRkb3duKGt2bWkpOworCisJa3ZtaV9wdXQoa3ZtaS0+a3ZtKTsK
KwlyZXR1cm4gMDsKK30KKworaW50IGt2bWlfaG9vayhzdHJ1Y3Qga3ZtICprdm0sIGNvbnN0IHN0
cnVjdCBrdm1faW50cm9zcGVjdGlvbl9ob29rICpob29rKQoreworCXN0cnVjdCBrdm1faW50cm9z
cGVjdGlvbiAqa3ZtaTsKKwlpbnQgZXJyID0gMDsKKworCW11dGV4X2xvY2soJmt2bS0+a3ZtaV9s
b2NrKTsKKworCWlmIChrdm0tPmt2bWkpIHsKKwkJZXJyID0gLUVFWElTVDsKKwkJZ290byBvdXQ7
CisJfQorCisJa3ZtaSA9IGFsbG9jX2t2bWkoa3ZtLCBob29rKTsKKwlpZiAoIWt2bWkpIHsKKwkJ
ZXJyID0gLUVOT01FTTsKKwkJZ290byBvdXQ7CisJfQorCisJa3ZtLT5rdm1pID0ga3ZtaTsKKwor
CWVyciA9IF9fa3ZtaV9ob29rKGt2bSwgaG9vayk7CisJaWYgKGVycikKKwkJZ290byBkZXN0cm95
OworCisJaW5pdF9jb21wbGV0aW9uKCZrdm0tPmt2bWlfY29tcGxldGUpOworCisJcmVmY291bnRf
c2V0KCZrdm0tPmt2bWlfcmVmLCAxKTsKKworCWt2bWktPnJlY3YgPSBrdGhyZWFkX3J1bihrdm1p
X3JlY3ZfdGhyZWFkLCBrdm1pLCAia3ZtaS1yZWN2Iik7CisJaWYgKElTX0VSUihrdm1pLT5yZWN2
KSkgeworCQllcnIgPSAtRU5PTUVNOworCQlrdm1pX3B1dChrdm0pOworCQlnb3RvIHVuaG9vazsK
Kwl9CisKKwlnb3RvIG91dDsKKwordW5ob29rOgorCV9fa3ZtaV91bmhvb2soa3ZtKTsKK2Rlc3Ry
b3k6CisJa3ZtaV9kZXN0cm95KGt2bWkpOworb3V0OgorCW11dGV4X3VubG9jaygma3ZtLT5rdm1p
X2xvY2spOworCXJldHVybiBlcnI7Cit9CisKK2ludCBrdm1pX2lvY3RsX2hvb2soc3RydWN0IGt2
bSAqa3ZtLCB2b2lkIF9fdXNlciAqYXJncCkKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb25f
aG9vayBpOworCisJaWYgKGNvcHlfZnJvbV91c2VyKCZpLCBhcmdwLCBzaXplb2YoaSkpKQorCQly
ZXR1cm4gLUVGQVVMVDsKKworCWlmIChpLnBhZGRpbmcpCisJCXJldHVybiAtRUlOVkFMOworCisJ
cmV0dXJuIGt2bWlfaG9vayhrdm0sICZpKTsKK30KKwogdm9pZCBrdm1pX2NyZWF0ZV92bShzdHJ1
Y3Qga3ZtICprdm0pCiB7CisJbXV0ZXhfaW5pdCgma3ZtLT5rdm1pX2xvY2spOwogfQogCiB2b2lk
IGt2bWlfZGVzdHJveV92bShzdHJ1Y3Qga3ZtICprdm0pCiB7CisJa3ZtaV91bmhvb2soa3ZtKTsK
IH0KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCBiL3ZpcnQv
a3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaAppbmRleCAzNGFmOTI2Zjk4MzguLjFjOWNjMTVh
YjRkOSAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCisrKyBi
L3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaApAQCAtNCw0ICs0LDI0IEBACiAKICNp
bmNsdWRlIDxsaW51eC9rdm1faG9zdC5oPgogCisjZGVmaW5lIGt2bWlfd2Fybihrdm1pLCBmbXQs
IC4uLikgXAorCWt2bV9pbmZvKCIlcFUgV0FSTklORzogIiBmbXQsICZrdm1pLT51dWlkLCAjIyBf
X1ZBX0FSR1NfXykKKyNkZWZpbmUga3ZtaV93YXJuX29uY2Uoa3ZtaSwgZm10LCAuLi4pICh7ICAg
ICAgICAgICAgICAgICAgICAgXAorCQlzdGF0aWMgYm9vbCBfX3NlY3Rpb24oLmRhdGEub25jZSkg
X193YXJuZWQ7ICAgXAorCQlpZiAoIV9fd2FybmVkKSB7ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgXAorCQkJX193YXJuZWQgPSB0cnVlOyAgICAgICAgICAgICAgICAgICAgICBcCisJCQlr
dm1pX3dhcm4oa3ZtaSwgZm10LCAjIyBfX1ZBX0FSR1NfXyk7IFwKKwkJfSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKwl9KQorI2RlZmluZSBrdm1pX2Vycihr
dm1pLCBmbXQsIC4uLikgXAorCWt2bV9pbmZvKCIlcFUgRVJST1I6ICIgZm10LCAma3ZtaS0+dXVp
ZCwgIyMgX19WQV9BUkdTX18pCisKKyNkZWZpbmUgS1ZNSShrdm0pICgoa3ZtKS0+a3ZtaSkKKwor
Lyoga3ZtaV9tc2cuYyAqLworYm9vbCBrdm1pX3NvY2tfZ2V0KHN0cnVjdCBrdm1faW50cm9zcGVj
dGlvbiAqa3ZtaSwgaW50IGZkKTsKK3ZvaWQga3ZtaV9zb2NrX3NodXRkb3duKHN0cnVjdCBrdm1f
aW50cm9zcGVjdGlvbiAqa3ZtaSk7Cit2b2lkIGt2bWlfc29ja19wdXQoc3RydWN0IGt2bV9pbnRy
b3NwZWN0aW9uICprdm1pKTsKK2Jvb2wga3ZtaV9tc2dfcHJvY2VzcyhzdHJ1Y3Qga3ZtX2ludHJv
c3BlY3Rpb24gKmt2bWkpOworCiAjZW5kaWYKZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3Bl
Y3Rpb24va3ZtaV9tc2cuYyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYwpuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmY5ZTY2Mjc0ZmI0MwotLS0gL2Rl
di9udWxsCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYwpAQCAtMCwwICsx
LDM5IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyoKKyAqIEtWTSBp
bnRyb3NwZWN0aW9uIChtZXNzYWdlIGhhbmRsaW5nKQorICoKKyAqIENvcHlyaWdodCAoQykgMjAx
Ny0yMDIwIEJpdGRlZmVuZGVyIFMuUi5MLgorICoKKyAqLworI2luY2x1ZGUgPGxpbnV4L25ldC5o
PgorI2luY2x1ZGUgImt2bWlfaW50LmgiCisKK2Jvb2wga3ZtaV9zb2NrX2dldChzdHJ1Y3Qga3Zt
X2ludHJvc3BlY3Rpb24gKmt2bWksIGludCBmZCkKK3sKKwlzdHJ1Y3Qgc29ja2V0ICpzb2NrOwor
CWludCByOworCisJc29jayA9IHNvY2tmZF9sb29rdXAoZmQsICZyKTsKKwlpZiAoIXNvY2spCisJ
CXJldHVybiBmYWxzZTsKKworCWt2bWktPnNvY2sgPSBzb2NrOworCisJcmV0dXJuIHRydWU7Cit9
CisKK3ZvaWQga3ZtaV9zb2NrX3B1dChzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkpCit7
CisJaWYgKGt2bWktPnNvY2spCisJCXNvY2tmZF9wdXQoa3ZtaS0+c29jayk7Cit9CisKK3ZvaWQg
a3ZtaV9zb2NrX3NodXRkb3duKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSkKK3sKKwlr
ZXJuZWxfc29ja19zaHV0ZG93bihrdm1pLT5zb2NrLCBTSFVUX1JEV1IpOworfQorCitib29sIGt2
bWlfbXNnX3Byb2Nlc3Moc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pKQoreworCXJldHVy
biBmYWxzZTsKK30KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2t2bV9tYWluLmMgYi92aXJ0L2t2bS9r
dm1fbWFpbi5jCmluZGV4IGI0MzkyM2I1YWE3OS4uODI2MzRiZTU2MGU2IDEwMDY0NAotLS0gYS92
aXJ0L2t2bS9rdm1fbWFpbi5jCisrKyBiL3ZpcnQva3ZtL2t2bV9tYWluLmMKQEAgLTM1ODAsNiAr
MzU4MCwxNyBAQCBzdGF0aWMgbG9uZyBrdm1fdm1faW9jdGwoc3RydWN0IGZpbGUgKmZpbHAsCiAJ
Y2FzZSBLVk1fQ0hFQ0tfRVhURU5TSU9OOgogCQlyID0ga3ZtX3ZtX2lvY3RsX2NoZWNrX2V4dGVu
c2lvbl9nZW5lcmljKGt2bSwgYXJnKTsKIAkJYnJlYWs7CisjaWZkZWYgQ09ORklHX0tWTV9JTlRS
T1NQRUNUSU9OCisJY2FzZSBLVk1fSU5UUk9TUEVDVElPTl9IT09LOgorCQlpZiAoZW5hYmxlX2lu
dHJvc3BlY3Rpb24pCisJCQlyID0ga3ZtaV9pb2N0bF9ob29rKGt2bSwgYXJncCk7CisJCWVsc2UK
KwkJCXIgPSAtRVBFUk07CisJCWJyZWFrOworCWNhc2UgS1ZNX0lOVFJPU1BFQ1RJT05fVU5IT09L
OgorCQlyID0ga3ZtaV9pb2N0bF91bmhvb2soa3ZtKTsKKwkJYnJlYWs7CisjZW5kaWYgLyogQ09O
RklHX0tWTV9JTlRST1NQRUNUSU9OICovCiAJZGVmYXVsdDoKIAkJciA9IGt2bV9hcmNoX3ZtX2lv
Y3RsKGZpbHAsIGlvY3RsLCBhcmcpOwogCX0KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0
aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0
aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
