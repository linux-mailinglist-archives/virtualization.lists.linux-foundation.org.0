Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 9386F1978C8
	for <lists.virtualization@lfdr.de>; Mon, 30 Mar 2020 12:20:04 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 4E97B86ADD;
	Mon, 30 Mar 2020 10:20:03 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id Eg7yX4mzP9tS; Mon, 30 Mar 2020 10:19:58 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 953C586A79;
	Mon, 30 Mar 2020 10:19:55 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 7DF80C07FF;
	Mon, 30 Mar 2020 10:19:55 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id EB324C1D7E
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:51 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by fraxinus.osuosl.org (Postfix) with ESMTP id DAB0986A11
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:51 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id OPapHvIuXk1L
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:50 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by fraxinus.osuosl.org (Postfix) with ESMTPS id 6B0CF86A1D
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:50 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 5A6BD305D486; Mon, 30 Mar 2020 13:12:58 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 3B832305B7A3;
 Mon, 30 Mar 2020 13:12:58 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v8 60/81] KVM: introspection: add KVMI_EVENT_HYPERCALL
Date: Mon, 30 Mar 2020 13:12:47 +0300
Message-Id: <20200330101308.21702-61-alazar@bitdefender.com>
In-Reply-To: <20200330101308.21702-1-alazar@bitdefender.com>
References: <20200330101308.21702-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBldmVudCBp
cyBzZW50IG9uIGEgc3BlY2lmaWMgaHlwZXJjYWxsLgoKSXQgaXMgdXNlZCBieSB0aGUgY29kZSBy
ZXNpZGluZyBpbnNpZGUgdGhlIGludHJvc3BlY3RlZCBndWVzdCB0byBjYWxsIHRoZQppbnRyb3Nw
ZWN0aW9uIHRvb2wgYW5kIHRvIHJlcG9ydCBjZXJ0YWluIGRldGFpbHMgYWJvdXQgaXRzIG9wZXJh
dGlvbi4KRm9yIGV4YW1wbGUsIGEgY2xhc3NpYyBhbnRpbWFsd2FyZSByZW1lZGlhdGlvbiB0b29s
IGNhbiByZXBvcnQKd2hhdCBpdCBoYXMgZm91bmQgZHVyaW5nIGEgc2Nhbi4KClNpZ25lZC1vZmYt
Ynk6IE1paGFpIERvbsibdSA8bWRvbnR1QGJpdGRlZmVuZGVyLmNvbT4KQ28tZGV2ZWxvcGVkLWJ5
OiBBZGFsYmVydCBMYXrEg3IgPGFsYXphckBiaXRkZWZlbmRlci5jb20+ClNpZ25lZC1vZmYtYnk6
IEFkYWxiZXJ0IExhesSDciA8YWxhemFyQGJpdGRlZmVuZGVyLmNvbT4KLS0tCiBEb2N1bWVudGF0
aW9uL3ZpcnQva3ZtL2h5cGVyY2FsbHMucnN0ICAgICAgICAgfCAzNSArKysrKysrKysrKysrKysK
IERvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QgICAgICAgICAgICAgICB8IDM2ICsrKysr
KysrKysrKysrKy0KIGFyY2gveDg2L2luY2x1ZGUvdWFwaS9hc20va3ZtaS5oICAgICAgICAgICAg
ICB8ICAyICsKIGFyY2gveDg2L2t2bS9rdm1pLmMgICAgICAgICAgICAgICAgICAgICAgICAgICB8
IDMzICsrKysrKysrKysrKysrCiBhcmNoL3g4Ni9rdm0veDg2LmMgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgfCAxOCArKysrKystLQogaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaCAgICAgICAg
ICAgICAgICAgICAgIHwgIDIgKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2bV9wYXJhLmggICAgICAg
ICAgICAgICAgIHwgIDEgKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCAgICAgICAgICAgICAg
ICAgICAgIHwgIDEgKwogLi4uL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0
LmMgIHwgNDMgKysrKysrKysrKysrKysrKysrKwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1p
LmMgICAgICAgICAgICAgICAgIHwgMjMgKysrKysrKysrKwogdmlydC9rdm0vaW50cm9zcGVjdGlv
bi9rdm1pX2ludC5oICAgICAgICAgICAgIHwgMTAgKysrKysKIHZpcnQva3ZtL2ludHJvc3BlY3Rp
b24va3ZtaV9tc2cuYyAgICAgICAgICAgICB8IDEyICsrKysrKwogMTIgZmlsZXMgY2hhbmdlZCwg
MjExIGluc2VydGlvbnMoKyksIDUgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvRG9jdW1lbnRh
dGlvbi92aXJ0L2t2bS9oeXBlcmNhbGxzLnJzdCBiL0RvY3VtZW50YXRpb24vdmlydC9rdm0vaHlw
ZXJjYWxscy5yc3QKaW5kZXggODEyOTRhYWVhMDdhLi4xYTNjZWUzNjkxNzEgMTAwNjQ0Ci0tLSBh
L0RvY3VtZW50YXRpb24vdmlydC9rdm0vaHlwZXJjYWxscy5yc3QKKysrIGIvRG9jdW1lbnRhdGlv
bi92aXJ0L2t2bS9oeXBlcmNhbGxzLnJzdApAQCAtMTY5LDMgKzE2OSwzOCBAQCBhMDogZGVzdGlu
YXRpb24gQVBJQyBJRAogCiA6VXNhZ2UgZXhhbXBsZTogV2hlbiBzZW5kaW5nIGEgY2FsbC1mdW5j
dGlvbiBJUEktbWFueSB0byB2Q1BVcywgeWllbGQgaWYKIAkgICAgICAgIGFueSBvZiB0aGUgSVBJ
IHRhcmdldCB2Q1BVcyB3YXMgcHJlZW1wdGVkLgorCis5LiBLVk1fSENfWEVOX0hWTV9PUAorLS0t
LS0tLS0tLS0tLS0tLS0tLS0KKworOkFyY2hpdGVjdHVyZTogeDg2Cis6U3RhdHVzOiBhY3RpdmUK
KzpQdXJwb3NlOiBUbyBlbmFibGUgY29tbXVuaWNhdGlvbiBiZXR3ZWVuIGEgZ3Vlc3QgYWdlbnQg
YW5kIGEgVk1JIGFwcGxpY2F0aW9uCisKK1VzYWdlOgorCitBbiBldmVudCB3aWxsIGJlIHNlbnQg
dG8gdGhlIFZNSSBhcHBsaWNhdGlvbiAoc2VlIGt2bWkucnN0KSBpZiB0aGUgZm9sbG93aW5nCity
ZWdpc3RlcnMsIHdoaWNoIGRpZmZlciBiZXR3ZWVuIDMyYml0IGFuZCA2NGJpdCwgaGF2ZSB0aGUg
Zm9sbG93aW5nIHZhbHVlczoKKworICAgICAgID09PT09PT09ICAgID09PT09ICAgICA9PT09PQor
ICAgICAgIDMyYml0ICAgICAgIDY0Yml0ICAgICB2YWx1ZQorICAgICAgID09PT09PT09ICAgID09
PT09ICAgICA9PT09PQorICAgICAgIGVieCAoYTApICAgIHJkaSAgICAgICBLVk1fSENfWEVOX0hW
TV9PUF9HVUVTVF9SRVFVRVNUX1ZNX0VWRU5UCisgICAgICAgZWN4IChhMSkgICAgcnNpICAgICAg
IDAKKyAgICAgICA9PT09PT09PSAgICA9PT09PSAgICAgPT09PT0KKworVGhpcyBzcGVjaWZpY2F0
aW9uIGNvcGllcyBYZW4ncyB7IF9fSFlQRVJWSVNPUl9odm1fb3AsCitIVk1PUF9ndWVzdF9yZXF1
ZXN0X3ZtX2V2ZW50IH0gaHlwZXJjYWxsIGFuZCBjYW4gb3JpZ2luYXRlIGZyb20ga2VybmVsIG9y
Cit1c2Vyc3BhY2UuCisKK0l0IHJldHVybnMgMCBpZiBzdWNjZXNzZnVsLCBvciBhIG5lZ2F0aXZl
IFBPU0lYLjEgZXJyb3IgY29kZSBpZiBpdCBmYWlscy4gVGhlCithYnNlbmNlIG9mIGFuIGFjdGl2
ZSBWTUkgYXBwbGljYXRpb24gaXMgbm90IHNpZ25hbGVkIGluIGFueSB3YXkuCisKK1RoZSBmb2xs
b3dpbmcgcmVnaXN0ZXJzIGFyZSBjbG9iYmVyZWQ6CisKKyAgKiAzMmJpdDogZWR4LCBlc2ksIGVk
aSwgZWJwCisgICogNjRiaXQ6IHJkeCwgcjEwLCByOCwgcjkKKworSW4gcGFydGljdWxhciwgZm9y
IEtWTV9IQ19YRU5fSFZNX09QX0dVRVNUX1JFUVVFU1RfVk1fRVZFTlQsIHRoZSBsYXN0IHR3bwor
cmVnaXN0ZXJzIGNhbiBiZSBwb2lzb25lZCBkZWxpYmVyYXRlbHkgYW5kIGNhbm5vdCBiZSB1c2Vk
IGZvciBwYXNzaW5nCitpbmZvcm1hdGlvbi4KZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRpb24vdmly
dC9rdm0va3ZtaS5yc3QgYi9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CmluZGV4IDc2
YjIyNTg1ZmVlZS4uNDc1YjA5OTI0ZTA2IDEwMDY0NAotLS0gYS9Eb2N1bWVudGF0aW9uL3ZpcnQv
a3ZtL2t2bWkucnN0CisrKyBiL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKQEAgLTU0
Myw3ICs1NDMsMTAgQEAgY29tbWFuZCkgYmVmb3JlIHJldHVybmluZyB0byBndWVzdC4KIAogCXN0
cnVjdCBrdm1pX2Vycm9yX2NvZGUKIAotRW5hYmxlcy9kaXNhYmxlcyB2Q1BVIGludHJvc3BlY3Rp
b24gZXZlbnRzLgorRW5hYmxlcy9kaXNhYmxlcyB2Q1BVIGludHJvc3BlY3Rpb24gZXZlbnRzLiBU
aGlzIGNvbW1hbmQgY2FuIGJlIHVzZWQgd2l0aAordGhlIGZvbGxvd2luZyBldmVudHM6OgorCisJ
S1ZNSV9FVkVOVF9IWVBFUkNBTEwKIAogV2hlbiBhbiBldmVudCBpcyBlbmFibGVkLCB0aGUgaW50
cm9zcGVjdGlvbiB0b29sIGlzIG5vdGlmaWVkIGFuZAogbXVzdCByZXBseSB3aXRoOiBjb250aW51
ZSwgcmV0cnksIGNyYXNoLCBldGMuIChzZWUgKipFdmVudHMqKiBiZWxvdykuCkBAIC03ODEsMyAr
Nzg0LDM0IEBAIFRoaXMgZXZlbnQgaXMgc2VudCBpbiByZXNwb25zZSB0byBhICpLVk1JX1ZDUFVf
UEFVU0UqIGNvbW1hbmQgYW5kCiBjYW5ub3QgYmUgZGlzYWJsZWQgdmlhICpLVk1JX1ZDUFVfQ09O
VFJPTF9FVkVOVFMqLgogQmVjYXVzZSBpdCBoYXMgYSBsb3cgcHJpb3JpdHksIGl0IHdpbGwgYmUg
c2VudCBhZnRlciBhbnkgb3RoZXIgdkNQVQogaW50cm9zcGVjdGlvbiBldmVudCBhbmQgd2hlbiBu
byB2Q1BVIGludHJvc3BlY3Rpb24gY29tbWFuZCBpcyBxdWV1ZWQuCisKKzMuIEtWTUlfRVZFTlRf
SFlQRVJDQUxMCistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorCis6QXJjaGl0ZWN0dXJlczogeDg2
Cis6VmVyc2lvbnM6ID49IDEKKzpBY3Rpb25zOiBDT05USU5VRSwgQ1JBU0gKKzpQYXJhbWV0ZXJz
OgorCis6OgorCisJc3RydWN0IGt2bWlfZXZlbnQ7CisKKzpSZXR1cm5zOgorCis6OgorCisJc3Ry
dWN0IGt2bWlfdmNwdV9oZHI7CisJc3RydWN0IGt2bWlfZXZlbnRfcmVwbHk7CisKK1RoaXMgZXZl
bnQgaXMgc2VudCBvbiBhIHNwZWNpZmljIHVzZXIgaHlwZXJjYWxsIHdoZW4gdGhlIGludHJvc3Bl
Y3Rpb24gaGFzCitiZWVuIGVuYWJsZWQgZm9yIHRoaXMgZXZlbnQgKHNlZSAqS1ZNSV9WQ1BVX0NP
TlRST0xfRVZFTlRTKikuCisKK1RoZSBoeXBlcmNhbGwgbnVtYmVyIG11c3QgYmUgYGBLVk1fSENf
WEVOX0hWTV9PUGBgIHdpdGggdGhlCitgYEtWTV9IQ19YRU5fSFZNX09QX0dVRVNUX1JFUVVFU1Rf
Vk1fRVZFTlRgYCBzdWItZnVuY3Rpb24KKyhzZWUgaHlwZXJjYWxscy50eHQpLgorCitJdCBpcyB1
c2VkIGJ5IHRoZSBjb2RlIHJlc2lkaW5nIGluc2lkZSB0aGUgaW50cm9zcGVjdGVkIGd1ZXN0IHRv
IGNhbGwgdGhlCitpbnRyb3NwZWN0aW9uIHRvb2wgYW5kIHRvIHJlcG9ydCBjZXJ0YWluIGRldGFp
bHMgYWJvdXQgaXRzIG9wZXJhdGlvbi4gRm9yCitleGFtcGxlLCBhIGNsYXNzaWMgYW50aW1hbHdh
cmUgcmVtZWRpYXRpb24gdG9vbCBjYW4gcmVwb3J0IHdoYXQgaXQgaGFzCitmb3VuZCBkdXJpbmcg
YSBzY2FuLgpkaWZmIC0tZ2l0IGEvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmggYi9h
cmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaAppbmRleCA1N2M0OGFjZTQxN2YuLjk4ODJl
NjhjYWI3NSAxMDA2NDQKLS0tIGEvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmgKKysr
IGIvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmgKQEAgLTgsNiArOCw4IEBACiAKICNp
bmNsdWRlIDxhc20va3ZtLmg+CiAKKyNkZWZpbmUgS1ZNX0hDX1hFTl9IVk1fT1BfR1VFU1RfUkVR
VUVTVF9WTV9FVkVOVCAyNAorCiBzdHJ1Y3Qga3ZtaV9ldmVudF9hcmNoIHsKIAlfX3U4IG1vZGU7
CQkvKiAyLCA0IG9yIDggKi8KIAlfX3U4IHBhZGRpbmdbN107CmRpZmYgLS1naXQgYS9hcmNoL3g4
Ni9rdm0va3ZtaS5jIGIvYXJjaC94ODYva3ZtL2t2bWkuYwppbmRleCBlZGU4YzdjYmRmMWUuLjc5
MzBmNmRlMWE0MCAxMDA2NDQKLS0tIGEvYXJjaC94ODYva3ZtL2t2bWkuYworKysgYi9hcmNoL3g4
Ni9rdm0va3ZtaS5jCkBAIC0yMDgsMyArMjA4LDM2IEBAIGludCBrdm1pX2FyY2hfY21kX3ZjcHVf
Z2V0X2NwdWlkKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKIAogCXJldHVybiAwOwogfQorCitib29s
IGt2bWlfYXJjaF9pc19hZ2VudF9oeXBlcmNhbGwoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQorewor
CXVuc2lnbmVkIGxvbmcgc3ViZnVuYzEsIHN1YmZ1bmMyOworCWJvb2wgbG9uZ21vZGUgPSBpc182
NF9iaXRfbW9kZSh2Y3B1KTsKKworCWlmIChsb25nbW9kZSkgeworCQlzdWJmdW5jMSA9IGt2bV9y
ZGlfcmVhZCh2Y3B1KTsKKwkJc3ViZnVuYzIgPSBrdm1fcnNpX3JlYWQodmNwdSk7CisJfSBlbHNl
IHsKKwkJc3ViZnVuYzEgPSBrdm1fcmJ4X3JlYWQodmNwdSk7CisJCXN1YmZ1bmMxICY9IDB4RkZG
RkZGRkY7CisJCXN1YmZ1bmMyID0ga3ZtX3JjeF9yZWFkKHZjcHUpOworCQlzdWJmdW5jMiAmPSAw
eEZGRkZGRkZGOworCX0KKworCXJldHVybiAoc3ViZnVuYzEgPT0gS1ZNX0hDX1hFTl9IVk1fT1Bf
R1VFU1RfUkVRVUVTVF9WTV9FVkVOVAorCQkmJiBzdWJmdW5jMiA9PSAwKTsKK30KKwordm9pZCBr
dm1pX2FyY2hfaHlwZXJjYWxsX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKK3sKKwl1MzIg
YWN0aW9uOworCisJYWN0aW9uID0ga3ZtaV9tc2dfc2VuZF9oeXBlcmNhbGwodmNwdSk7CisJc3dp
dGNoIChhY3Rpb24pIHsKKwljYXNlIEtWTUlfRVZFTlRfQUNUSU9OX0NPTlRJTlVFOgorCQlicmVh
azsKKwlkZWZhdWx0OgorCQlrdm1pX2hhbmRsZV9jb21tb25fZXZlbnRfYWN0aW9ucyh2Y3B1LT5r
dm0sIGFjdGlvbiwKKwkJCQkJCSJIWVBFUkNBTEwiKTsKKwl9Cit9CmRpZmYgLS1naXQgYS9hcmNo
L3g4Ni9rdm0veDg2LmMgYi9hcmNoL3g4Ni9rdm0veDg2LmMKaW5kZXggOTY3YzgzNzkxYjM3Li5i
YWQ2NjQyMGYwNTQgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS94ODYuYworKysgYi9hcmNoL3g4
Ni9rdm0veDg2LmMKQEAgLTc1NDYsMTEgKzc1NDYsMTQgQEAgaW50IGt2bV9lbXVsYXRlX2h5cGVy
Y2FsbChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCiB7CiAJdW5zaWduZWQgbG9uZyBuciwgYTAsIGEx
LCBhMiwgYTMsIHJldDsKIAlpbnQgb3BfNjRfYml0OwotCi0JaWYgKGt2bV9odl9oeXBlcmNhbGxf
ZW5hYmxlZCh2Y3B1LT5rdm0pKQotCQlyZXR1cm4ga3ZtX2h2X2h5cGVyY2FsbCh2Y3B1KTsKKwli
b29sIGt2bWlfaGM7CiAKIAluciA9IGt2bV9yYXhfcmVhZCh2Y3B1KTsKKwlrdm1pX2hjID0gKHUz
MiluciA9PSBLVk1fSENfWEVOX0hWTV9PUDsKKworCWlmIChrdm1faHZfaHlwZXJjYWxsX2VuYWJs
ZWQodmNwdS0+a3ZtKSAmJiAha3ZtaV9oYykKKwkJcmV0dXJuIGt2bV9odl9oeXBlcmNhbGwodmNw
dSk7CisKIAlhMCA9IGt2bV9yYnhfcmVhZCh2Y3B1KTsKIAlhMSA9IGt2bV9yY3hfcmVhZCh2Y3B1
KTsKIAlhMiA9IGt2bV9yZHhfcmVhZCh2Y3B1KTsKQEAgLTc1NjcsNyArNzU3MCw3IEBAIGludCBr
dm1fZW11bGF0ZV9oeXBlcmNhbGwoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQogCQlhMyAmPSAweEZG
RkZGRkZGOwogCX0KIAotCWlmIChrdm1feDg2X29wcy0+Z2V0X2NwbCh2Y3B1KSAhPSAwKSB7CisJ
aWYgKGt2bV94ODZfb3BzLT5nZXRfY3BsKHZjcHUpICE9IDAgJiYgIWt2bWlfaGMpIHsKIAkJcmV0
ID0gLUtWTV9FUEVSTTsKIAkJZ290byBvdXQ7CiAJfQpAQCAtNzU5Myw2ICs3NTk2LDEzIEBAIGlu
dCBrdm1fZW11bGF0ZV9oeXBlcmNhbGwoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQogCQlrdm1fc2No
ZWRfeWllbGQodmNwdS0+a3ZtLCBhMCk7CiAJCXJldCA9IDA7CiAJCWJyZWFrOworI2lmZGVmIENP
TkZJR19LVk1fSU5UUk9TUEVDVElPTgorCWNhc2UgS1ZNX0hDX1hFTl9IVk1fT1A6CisJCXJldCA9
IDA7CisJCWlmICgha3ZtaV9oeXBlcmNhbGxfZXZlbnQodmNwdSkpCisJCQlyZXQgPSAtS1ZNX0VO
T1NZUzsKKwkJYnJlYWs7CisjZW5kaWYgLyogQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OICovCiAJ
ZGVmYXVsdDoKIAkJcmV0ID0gLUtWTV9FTk9TWVM7CiAJCWJyZWFrOwpkaWZmIC0tZ2l0IGEvaW5j
bHVkZS9saW51eC9rdm1pX2hvc3QuaCBiL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmgKaW5kZXgg
ZmUwNzFhOTI1MTBjLi5hYzc4ZjI4NDVlNWYgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbGludXgva3Zt
aV9ob3N0LmgKKysrIGIvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaApAQCAtNzUsNiArNzUsNyBA
QCBpbnQga3ZtaV9pb2N0bF9ldmVudChzdHJ1Y3Qga3ZtICprdm0sIHZvaWQgX191c2VyICphcmdw
KTsKIGludCBrdm1pX2lvY3RsX3ByZXVuaG9vayhzdHJ1Y3Qga3ZtICprdm0pOwogCiB2b2lkIGt2
bWlfaGFuZGxlX3JlcXVlc3RzKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7Citib29sIGt2bWlfaHlw
ZXJjYWxsX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7CiAKICNlbHNlCiAKQEAgLTg1LDYg
Kzg2LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIGt2bWlfZGVzdHJveV92bShzdHJ1Y3Qga3ZtICpr
dm0pIHsgfQogc3RhdGljIGlubGluZSB2b2lkIGt2bWlfdmNwdV91bmluaXQoc3RydWN0IGt2bV92
Y3B1ICp2Y3B1KSB7IH0KIAogc3RhdGljIGlubGluZSB2b2lkIGt2bWlfaGFuZGxlX3JlcXVlc3Rz
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkgeyB9CitzdGF0aWMgaW5saW5lIGJvb2wga3ZtaV9oeXBl
cmNhbGxfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KSB7IHJldHVybiBmYWxzZTsgfQogCiAj
ZW5kaWYgLyogQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OICovCiAKZGlmZiAtLWdpdCBhL2luY2x1
ZGUvdWFwaS9saW51eC9rdm1fcGFyYS5oIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bV9wYXJhLmgK
aW5kZXggM2NlMzg4MjQ5NjgyLi41M2NlYmJlMjIwOTkgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFw
aS9saW51eC9rdm1fcGFyYS5oCisrKyBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1fcGFyYS5oCkBA
IC0zMyw2ICszMyw3IEBACiAjZGVmaW5lIEtWTV9IQ19DTE9DS19QQUlSSU5HCQk5CiAjZGVmaW5l
IEtWTV9IQ19TRU5EX0lQSQkJMTAKICNkZWZpbmUgS1ZNX0hDX1NDSEVEX1lJRUxECQkxMQorI2Rl
ZmluZSBLVk1fSENfWEVOX0hWTV9PUAkJMzQgLyogWGVuJ3MgX19IWVBFUlZJU09SX2h2bV9vcCAq
LwogCiAvKgogICogaHlwZXJjYWxscyB1c2UgYXJjaGl0ZWN0dXJlIHNwZWNpZmljCmRpZmYgLS1n
aXQgYS9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWku
aAppbmRleCAzNjg4ZmEyNmRiYWYuLjE5MTM3YmQ0Y2FmYyAxMDA2NDQKLS0tIGEvaW5jbHVkZS91
YXBpL2xpbnV4L2t2bWkuaAorKysgYi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oCkBAIC0zOCw2
ICszOCw3IEBAIGVudW0gewogZW51bSB7CiAJS1ZNSV9FVkVOVF9VTkhPT0sgICAgID0gMCwKIAlL
Vk1JX0VWRU5UX1BBVVNFX1ZDUFUgPSAxLAorCUtWTUlfRVZFTlRfSFlQRVJDQUxMICA9IDIsCiAK
IAlLVk1JX05VTV9FVkVOVFMKIH07CmRpZmYgLS1naXQgYS90b29scy90ZXN0aW5nL3NlbGZ0ZXN0
cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jIGIvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4
Nl82NC9rdm1pX3Rlc3QuYwppbmRleCAxOGNlN2RkZDkxMzYuLmFlZmM4M2JjNjk1NSAxMDA2NDQK
LS0tIGEvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYworKysg
Yi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCkBAIC00OSw2
ICs0OSw3IEBAIHN0cnVjdCB2Y3B1X3dvcmtlcl9kYXRhIHsKIAogZW51bSB7CiAJR1VFU1RfVEVT
VF9OT09QID0gMCwKKwlHVUVTVF9URVNUX0hZUEVSQ0FMTCwKIH07CiAKICNkZWZpbmUgR1VFU1Rf
UkVRVUVTVF9URVNUKCkgICAgIEdVRVNUX1NZTkMoMCkKQEAgLTYyLDEyICs2MywyMyBAQCBzdGF0
aWMgaW50IGd1ZXN0X3Rlc3RfaWQodm9pZCkKIAlyZXR1cm4gUkVBRF9PTkNFKHRlc3RfaWQpOwog
fQogCitzdGF0aWMgdm9pZCBndWVzdF9oeXBlcmNhbGxfdGVzdCh2b2lkKQoreworCWFzbSB2b2xh
dGlsZSgibW92ICQzNCwgJXJheCIpOworCWFzbSB2b2xhdGlsZSgibW92ICQyNCwgJXJkaSIpOwor
CWFzbSB2b2xhdGlsZSgibW92ICQwLCAlcnNpIik7CisJYXNtIHZvbGF0aWxlKCIuYnl0ZSAweDBm
LDB4MDEsMHhjMSIpOworfQorCiBzdGF0aWMgdm9pZCBndWVzdF9jb2RlKHZvaWQpCiB7CiAJd2hp
bGUgKHRydWUpIHsKIAkJc3dpdGNoIChndWVzdF90ZXN0X2lkKCkpIHsKIAkJY2FzZSBHVUVTVF9U
RVNUX05PT1A6CiAJCQlicmVhazsKKwkJY2FzZSBHVUVTVF9URVNUX0hZUEVSQ0FMTDoKKwkJCWd1
ZXN0X2h5cGVyY2FsbF90ZXN0KCk7CisJCQlicmVhazsKIAkJfQogCQlHVUVTVF9TSUdOQUxfVEVT
VF9ET05FKCk7CiAJfQpAQCAtOTQyLDYgKzk1NCwzNiBAQCBzdGF0aWMgdm9pZCB0ZXN0X2NtZF92
Y3B1X2dldF9jcHVpZChzdHJ1Y3Qga3ZtX3ZtICp2bSkKIAkgICAgICBmdW5jdGlvbiwgaW5kZXgs
IHJwbC5lYXgsIHJwbC5lYngsIHJwbC5lY3gsIHJwbC5lZHgpOwogfQogCitzdGF0aWMgdm9pZCB0
ZXN0X2V2ZW50X2h5cGVyY2FsbChzdHJ1Y3Qga3ZtX3ZtICp2bSkKK3sKKwlzdHJ1Y3QgdmNwdV93
b3JrZXJfZGF0YSBkYXRhID0geworCQkudm0gPSB2bSwKKwkJLnZjcHVfaWQgPSBWQ1BVX0lELAor
CQkudGVzdF9pZCA9IEdVRVNUX1RFU1RfSFlQRVJDQUxMLAorCX07CisJc3RydWN0IGt2bWlfbXNn
X2hkciBoZHI7CisJc3RydWN0IGt2bWlfZXZlbnQgZXY7CisJc3RydWN0IHZjcHVfcmVwbHkgcnBs
ID0ge307CisJX191MTYgZXZlbnRfaWQgPSBLVk1JX0VWRU5UX0hZUEVSQ0FMTDsKKwlwdGhyZWFk
X3QgdmNwdV90aHJlYWQ7CisKKwllbmFibGVfdmNwdV9ldmVudCh2bSwgZXZlbnRfaWQpOworCisJ
dmNwdV90aHJlYWQgPSBzdGFydF92Y3B1X3dvcmtlcigmZGF0YSk7CisKKwlyZWNlaXZlX2V2ZW50
KCZoZHIsICZldiwgc2l6ZW9mKGV2KSwgZXZlbnRfaWQpOworCisJREVCVUcoIkh5cGVyY2FsbCBl
dmVudCwgcmlwIDB4JWxseFxuIiwKKwkJZXYuYXJjaC5yZWdzLnJpcCk7CisKKwlyZXBseV90b19l
dmVudCgmaGRyLCAmZXYsIEtWTUlfRVZFTlRfQUNUSU9OX0NPTlRJTlVFLAorCQkJJnJwbCwgc2l6
ZW9mKHJwbCkpOworCisJc3RvcF92Y3B1X3dvcmtlcih2Y3B1X3RocmVhZCwgJmRhdGEpOworCisJ
ZGlzYWJsZV92Y3B1X2V2ZW50KHZtLCBldmVudF9pZCk7Cit9CisKIHN0YXRpYyB2b2lkIHRlc3Rf
aW50cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkKIHsKIAlzcmFuZG9tKHRpbWUoMCkpOwpA
QCAtOTYyLDYgKzEwMDQsNyBAQCBzdGF0aWMgdm9pZCB0ZXN0X2ludHJvc3BlY3Rpb24oc3RydWN0
IGt2bV92bSAqdm0pCiAJdGVzdF9jbWRfdmNwdV9nZXRfcmVnaXN0ZXJzKHZtKTsKIAl0ZXN0X2Nt
ZF92Y3B1X3NldF9yZWdpc3RlcnModm0pOwogCXRlc3RfY21kX3ZjcHVfZ2V0X2NwdWlkKHZtKTsK
Kwl0ZXN0X2V2ZW50X2h5cGVyY2FsbCh2bSk7CiAKIAl1bmhvb2tfaW50cm9zcGVjdGlvbih2bSk7
CiB9CmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyBiL3ZpcnQva3Zt
L2ludHJvc3BlY3Rpb24va3ZtaS5jCmluZGV4IGQxODk4YmY4ZGExYS4uMjg2Y2ZjN2ViZjhhIDEw
MDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYworKysgYi92aXJ0L2t2bS9p
bnRyb3NwZWN0aW9uL2t2bWkuYwpAQCAtNzgsNiArNzgsNyBAQCBzdGF0aWMgdm9pZCBzZXR1cF9r
bm93bl9ldmVudHModm9pZCkKIAlzZXRfYml0KEtWTUlfRVZFTlRfVU5IT09LLCBLdm1pX2tub3du
X3ZtX2V2ZW50cyk7CiAKIAliaXRtYXBfemVybyhLdm1pX2tub3duX3ZjcHVfZXZlbnRzLCBLVk1J
X05VTV9FVkVOVFMpOworCXNldF9iaXQoS1ZNSV9FVkVOVF9IWVBFUkNBTEwsIEt2bWlfa25vd25f
dmNwdV9ldmVudHMpOwogCXNldF9iaXQoS1ZNSV9FVkVOVF9QQVVTRV9WQ1BVLCBLdm1pX2tub3du
X3ZjcHVfZXZlbnRzKTsKIAogCWJpdG1hcF9vcihLdm1pX2tub3duX2V2ZW50cywgS3ZtaV9rbm93
bl92bV9ldmVudHMsCkBAIC04MzksMyArODQwLDI1IEBAIHZvaWQga3ZtaV9wb3N0X3JlcGx5KHN0
cnVjdCBrdm1fdmNwdSAqdmNwdSkKIAkJdmNwdWktPmhhdmVfZGVsYXllZF9yZWdzID0gZmFsc2U7
CiAJfQogfQorCitib29sIGt2bWlfaHlwZXJjYWxsX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNw
dSkKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWk7CisJYm9vbCByZXQgPSBmYWxz
ZTsKKworCWlmICgha3ZtaV9hcmNoX2lzX2FnZW50X2h5cGVyY2FsbCh2Y3B1KSkKKwkJcmV0dXJu
IHJldDsKKworCWt2bWkgPSBrdm1pX2dldCh2Y3B1LT5rdm0pOworCWlmICgha3ZtaSkKKwkJcmV0
dXJuIHJldDsKKworCWlmIChpc19ldmVudF9lbmFibGVkKHZjcHUsIEtWTUlfRVZFTlRfSFlQRVJD
QUxMKSkgeworCQlrdm1pX2FyY2hfaHlwZXJjYWxsX2V2ZW50KHZjcHUpOworCQlyZXQgPSB0cnVl
OworCX0KKworCWt2bWlfcHV0KHZjcHUtPmt2bSk7CisKKwlyZXR1cm4gcmV0OworfQpkaWZmIC0t
Z2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oIGIvdmlydC9rdm0vaW50cm9z
cGVjdGlvbi9rdm1pX2ludC5oCmluZGV4IGEyODk2NjkxMjQyNy4uNDI2YjFlNjMzNTI4IDEwMDY0
NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmgKKysrIGIvdmlydC9rdm0v
aW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCkBAIC0yMyw2ICsyMywxMSBAQCBleHRlcm4gREVDTEFS
RV9CSVRNQVAoS3ZtaV9rbm93bl92Y3B1X2V2ZW50cywgS1ZNSV9OVU1fRVZFTlRTKTsKICNkZWZp
bmUgS1ZNSShrdm0pICgoa3ZtKS0+a3ZtaSkKICNkZWZpbmUgVkNQVUkodmNwdSkgKCh2Y3B1KS0+
a3ZtaSkKIAorc3RhdGljIGlubGluZSBib29sIGlzX2V2ZW50X2VuYWJsZWQoc3RydWN0IGt2bV92
Y3B1ICp2Y3B1LCBpbnQgZXZlbnQpCit7CisJcmV0dXJuIHRlc3RfYml0KGV2ZW50LCBWQ1BVSSh2
Y3B1KS0+ZXZfZW5hYmxlX21hc2spOworfQorCiAvKiBrdm1pX21zZy5jICovCiBib29sIGt2bWlf
c29ja19nZXQoc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pLCBpbnQgZmQpOwogdm9pZCBr
dm1pX3NvY2tfc2h1dGRvd24oc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pKTsKQEAgLTMw
LDYgKzM1LDcgQEAgdm9pZCBrdm1pX3NvY2tfcHV0KHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAq
a3ZtaSk7CiBib29sIGt2bWlfbXNnX3Byb2Nlc3Moc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICpr
dm1pKTsKIGludCBrdm1pX21zZ19zZW5kX3VuaG9vayhzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24g
Kmt2bWkpOwogdTMyIGt2bWlfbXNnX3NlbmRfdmNwdV9wYXVzZShzdHJ1Y3Qga3ZtX3ZjcHUgKnZj
cHUpOwordTMyIGt2bWlfbXNnX3NlbmRfaHlwZXJjYWxsKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7
CiAKIC8qIGt2bWkuYyAqLwogdm9pZCAqa3ZtaV9tc2dfYWxsb2Modm9pZCk7CkBAIC00MCw2ICs0
Niw4IEBAIGludCBrdm1pX2FkZF9qb2Ioc3RydWN0IGt2bV92Y3B1ICp2Y3B1LAogCQkgdm9pZCAq
Y3R4LCB2b2lkICgqZnJlZV9mY3QpKHZvaWQgKmN0eCkpOwogdm9pZCBrdm1pX3J1bl9qb2JzKHN0
cnVjdCBrdm1fdmNwdSAqdmNwdSk7CiB2b2lkIGt2bWlfcG9zdF9yZXBseShzdHJ1Y3Qga3ZtX3Zj
cHUgKnZjcHUpOwordm9pZCBrdm1pX2hhbmRsZV9jb21tb25fZXZlbnRfYWN0aW9ucyhzdHJ1Y3Qg
a3ZtICprdm0sCisJCQkJICAgICAgdTMyIGFjdGlvbiwgY29uc3QgY2hhciAqc3RyKTsKIGludCBr
dm1pX2NtZF92bV9jb250cm9sX2V2ZW50cyhzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWks
CiAJCQkJdW5zaWduZWQgaW50IGV2ZW50X2lkLCBib29sIGVuYWJsZSk7CiBpbnQga3ZtaV9jbWRf
dmNwdV9jb250cm9sX2V2ZW50cyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCkBAIC02OSw1ICs3Nyw3
IEBAIGludCBrdm1pX2FyY2hfY21kX3ZjcHVfZ2V0X3JlZ2lzdGVycyhzdHJ1Y3Qga3ZtX3ZjcHUg
KnZjcHUsCiBpbnQga3ZtaV9hcmNoX2NtZF92Y3B1X2dldF9jcHVpZChzdHJ1Y3Qga3ZtX3ZjcHUg
KnZjcHUsCiAJCQkJIGNvbnN0IHN0cnVjdCBrdm1pX3ZjcHVfZ2V0X2NwdWlkICpyZXEsCiAJCQkJ
IHN0cnVjdCBrdm1pX3ZjcHVfZ2V0X2NwdWlkX3JlcGx5ICpycGwpOworYm9vbCBrdm1pX2FyY2hf
aXNfYWdlbnRfaHlwZXJjYWxsKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7Cit2b2lkIGt2bWlfYXJj
aF9oeXBlcmNhbGxfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIAogI2VuZGlmCmRpZmYg
LS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgYi92aXJ0L2t2bS9pbnRy
b3NwZWN0aW9uL2t2bWlfbXNnLmMKaW5kZXggZDM4ODljZTZlNDFiLi40YjM2MjVkODlkNTIgMTAw
NjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYworKysgYi92aXJ0L2t2
bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKQEAgLTgzNywzICs4MzcsMTUgQEAgdTMyIGt2bWlf
bXNnX3NlbmRfdmNwdV9wYXVzZShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCiAKIAlyZXR1cm4gYWN0
aW9uOwogfQorCit1MzIga3ZtaV9tc2dfc2VuZF9oeXBlcmNhbGwoc3RydWN0IGt2bV92Y3B1ICp2
Y3B1KQoreworCWludCBlcnIsIGFjdGlvbjsKKworCWVyciA9IGt2bWlfc2VuZF9ldmVudCh2Y3B1
LCBLVk1JX0VWRU5UX0hZUEVSQ0FMTCwgTlVMTCwgMCwKKwkJCSAgICAgIE5VTEwsIDAsICZhY3Rp
b24pOworCWlmIChlcnIpCisJCXJldHVybiBLVk1JX0VWRU5UX0FDVElPTl9DT05USU5VRTsKKwor
CXJldHVybiBhY3Rpb247Cit9Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0
cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcv
bWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
