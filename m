Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp4.osuosl.org (smtp4.osuosl.org [IPv6:2605:bc80:3010::137])
	by mail.lfdr.de (Postfix) with ESMTPS id DC775707B42
	for <lists.virtualization@lfdr.de>; Thu, 18 May 2023 09:41:24 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp4.osuosl.org (Postfix) with ESMTP id CE93842832;
	Thu, 18 May 2023 07:41:21 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org CE93842832
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
	by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id kDA1H08P-Vnm; Thu, 18 May 2023 07:41:20 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp4.osuosl.org (Postfix) with ESMTPS id EA0A442836;
	Thu, 18 May 2023 07:41:19 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org EA0A442836
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 3632DC0089;
	Thu, 18 May 2023 07:41:19 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp2.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 2C80FC002A
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 07:41:18 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp2.osuosl.org (Postfix) with ESMTP id 03A3840436
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 07:41:18 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 03A3840436
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
 by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id UkrMfVIpTr0Y
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 07:41:16 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org E2239401A4
Received: from out30-101.freemail.mail.aliyun.com
 (out30-101.freemail.mail.aliyun.com [115.124.30.101])
 by smtp2.osuosl.org (Postfix) with ESMTPS id E2239401A4
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 07:41:15 +0000 (UTC)
X-Alimail-AntiSpam: AC=PASS; BC=-1|-1; BR=01201311R171e4; CH=green; DM=||false|;
 DS=||; FP=0|-1|-1|-1|0|-1|-1|-1; HT=ay29a033018045168;
 MF=xuanzhuo@linux.alibaba.com; NM=1; PH=DS; RN=4; SR=0;
 TI=SMTPD_---0Vivvcrg_1684395669; 
Received: from localhost(mailfrom:xuanzhuo@linux.alibaba.com
 fp:SMTPD_---0Vivvcrg_1684395669) by smtp.aliyun-inc.com;
 Thu, 18 May 2023 15:41:10 +0800
Message-ID: <1684395232.2129312-1-xuanzhuo@linux.alibaba.com>
Subject: Re: [PATCH vhost v9 05/12] virtio_ring: split: virtqueue_add_split()
 support premapped
Date: Thu, 18 May 2023 15:33:52 +0800
From: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
To: "Michael S. Tsirkin" <mst@redhat.com>
References: <20230517022249.20790-1-xuanzhuo@linux.alibaba.com>
 <20230517022249.20790-6-xuanzhuo@linux.alibaba.com>
 <CACGkMEu7+kDPiWmULXW_saW6pb5yF=gnqXRkSWcYbZCiJmszHQ@mail.gmail.com>
 <20230518030701-mutt-send-email-mst@kernel.org>
In-Reply-To: <20230518030701-mutt-send-email-mst@kernel.org>
Cc: Christoph Hellwig <hch@infradead.org>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gVGh1LCAxOCBNYXkgMjAyMyAwMzoxMToyNSAtMDQwMCwgIk1pY2hhZWwgUy4gVHNpcmtpbiIg
PG1zdEByZWRoYXQuY29tPiB3cm90ZToKPiBPbiBUaHUsIE1heSAxOCwgMjAyMyBhdCAwMjo1MTo1
N1BNICswODAwLCBKYXNvbiBXYW5nIHdyb3RlOgo+ID4gT24gV2VkLCBNYXkgMTcsIDIwMjMgYXQg
MTA6MjPigK9BTSBYdWFuIFpodW8gPHh1YW56aHVvQGxpbnV4LmFsaWJhYmEuY29tPiB3cm90ZToK
PiA+ID4KPiA+ID4gdmlydHF1ZXVlX2FkZF9zcGxpdCgpIG9ubHkgc3VwcG9ydHMgdmlydHVhbCBh
ZGRyZXNzZXMsIGRtYSBpcyBjb21wbGV0ZWQKPiA+ID4gaW4gdmlydHF1ZXVlX2FkZF9zcGxpdCgp
Lgo+ID4gPgo+ID4gPiBJbiBzb21lIHNjZW5hcmlvcyAoc3VjaCBhcyB0aGUgQUZfWERQIHNjZW5h
cmlvKSwgdGhlIG1lbW9yeSBpcyBhbGxvY2F0ZWQKPiA+ID4gYW5kIERNQSBpcyBjb21wbGV0ZWQg
aW4gYWR2YW5jZSwgc28gaXQgaXMgbmVjZXNzYXJ5IGZvciB1cyB0byBzdXBwb3J0Cj4gPiA+IHBh
c3NpbmcgdGhlIERNQSBhZGRyZXNzIHRvIHZpcnRxdWV1ZV9hZGRfc3BsaXQoKS4KPiA+ID4KPiA+
ID4gUmVjb3JkIHRoaXMgaW5mb3JtYXRpb24gaW4gZGVzY19zdGF0ZSwgd2UgY2FuIHNraXAgdW5t
YXAgYmFzZWQgb24gdGhpcwo+ID4gPiB3aGVuIGV4ZWN1dGluZyBkbWEgdW5tYXAuCj4gPgo+ID4g
SSB3b3VsZCBhbHNvIHN1Z2dlc3QgZG9jdW1lbnRpbmcgd2h5IGEgcGVyIGRlc2NyaXB0b3IgbWV0
YWRhdGEgaXMKPiA+IG5lZWRlZCBpbnN0ZWFkIG9mIGEgcGVyIHZpcnRxdWV1ZSBvbmUuCj4KPiBJ
IHRoaW5rIHdlIGNvdWxkIG1ha2UgaXQgcGVyIHZpcnRxdWV1ZS4gVGhhdCB3b3VsZCBtZWFuIGFs
bCBjb2RlIGluCj4gdmlydGlvIG5ldCB3b3VsZCBoYXZlIHRvIGNoYW5nZSB0byBkbyBkbWEgbWFw
cGluZyBpdHNlbGYgaW5zdGVhZCBvZgo+IHJlbHlpbmcgb24gdmlydGlvIGNvcmUgdGhvdWdoLiAg
V2hpY2ggaXMgbWF5YmUgYSBnb29kIGlkZWE/IERlZmluaXRlbHkgYQo+IHZlcnkgaW50cnVzaXZl
IGNoYW5nZSB0aG91Z2gsIHdpbGwgbmVlZCBhIGxvdCBvZiBwZXJmb3JtYW5jZSB0ZXN0aW5nCj4g
dG8gbWFrZSBzdXJlIHdlIGRvbid0IGJyZWFrIGFueXRoaW5nLgoKSW4gZmFjdCwgd2UgaGF2ZSB0
cmllZCB0aGlzIGlkZWEuCgpUaGUgcHJvYmxlbSBpcyB0aGUgZGV0YWNoIGFuZCB1bm1hcC4KCldl
IG5lZWQgdG8gZ2V0IGFsbCBETUEgQWRkcmVzc2VzIGZyb20gdmlydGlvLXJpbmcgdG8gdW5tYXAu
IEN1cnJlbnRseSwgaXQgZG9lcwpub3Qgc3VwcG9ydCB0byByZXR1cm4gdGhlIERNQSBBZGRyZXNz
LCBhbmQgZm9yIFNLQiwgd2UgbmVlZCB0byBnZXQgbXVsdGlwbGUgRE1BCkFkZHJlc3NlcyBhdCBv
bmUgdGltZS4KClRoaXMgbmVlZCB0byBtb2RpZnkgdGhlIGxvZ2ljIG9mIFZpcnRpby1SaW5nIGRl
dGFjaC4gQmVzaWRlcyB0aGlzLCBJIGFsc28gYWdyZWUKd2l0aCB0aGlzIGlkZWEuCgpUaGFua3Mu
CgoKPgo+Cj4KPgo+ID4gPgo+ID4gPiBTaWduZWQtb2ZmLWJ5OiBYdWFuIFpodW8gPHh1YW56aHVv
QGxpbnV4LmFsaWJhYmEuY29tPgo+ID4gPiAtLS0KPiA+ID4gIGRyaXZlcnMvdmlydGlvL3ZpcnRp
b19yaW5nLmMgfCAzOCArKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0KPiA+ID4g
IDEgZmlsZSBjaGFuZ2VkLCAyOSBpbnNlcnRpb25zKCspLCA5IGRlbGV0aW9ucygtKQo+ID4gPgo+
ID4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy92aXJ0aW8vdmlydGlvX3JpbmcuYyBiL2RyaXZlcnMv
dmlydGlvL3ZpcnRpb19yaW5nLmMKPiA+ID4gaW5kZXggZTJmYzUwYzA1YmVjLi5iZDVlODRhZmFi
MzcgMTAwNjQ0Cj4gPiA+IC0tLSBhL2RyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5nLmMKPiA+ID4g
KysrIGIvZHJpdmVycy92aXJ0aW8vdmlydGlvX3JpbmcuYwo+ID4gPiBAQCAtNzAsNiArNzAsNyBA
QAo+ID4gPiAgc3RydWN0IHZyaW5nX2Rlc2Nfc3RhdGVfc3BsaXQgewo+ID4gPiAgICAgICAgIHZv
aWQgKmRhdGE7ICAgICAgICAgICAgICAgICAgICAgLyogRGF0YSBmb3IgY2FsbGJhY2suICovCj4g
PiA+ICAgICAgICAgc3RydWN0IHZyaW5nX2Rlc2MgKmluZGlyX2Rlc2M7ICAvKiBJbmRpcmVjdCBk
ZXNjcmlwdG9yLCBpZiBhbnkuICovCj4gPiA+ICsgICAgICAgYm9vbCBwcmVtYXBwZWQ7ICAgICAg
ICAgICAgICAgICAvKiBETUEgbWFwcGluZyBpcyBkb25lIGJ5IGRyaXZlci4gKi8KPiA+Cj4gPiBH
b2luZyBiYWNrIHRvIHRoZSBvcmlnaW5hbCBkaXNjdXNzaW9uIGFyb3VuZCB3aGVyZSB0aGlzIHNo
b3VsZCBiZQo+ID4gcGxhY2VkLiBJIHdvbmRlciBpZiB3ZSBjYW4gZmluZCBhIGNvbW1vbiBwbGFj
ZSB0byBzdG9yZSB0aGlzIHNpbmNlIGl0Cj4gPiBoYXMgbm90aGluZyByZWxhdGVkIHRvIHZpcnRx
dWV1ZSBsYXlvdXQuIE1heWJlIGRlc2NfZXh0cmE/IEFuZCBpdAo+ID4gd291bGQgYmUgZXZlbiBi
ZXR0ZXIgaWYgd2UgY2FuIGF2b2lkIHN0cmVzc2luZyB0aGUgY2FjaGUgbGlrZSBhYm92ZS4KPiA+
Cj4gPiA+ICB9Owo+ID4gPgo+ID4gPiAgc3RydWN0IHZyaW5nX2Rlc2Nfc3RhdGVfcGFja2VkIHsK
PiA+ID4gQEAgLTM1Niw4ICszNTcsMTQgQEAgc3RhdGljIHN0cnVjdCBkZXZpY2UgKnZyaW5nX2Rt
YV9kZXYoY29uc3Qgc3RydWN0IHZyaW5nX3ZpcnRxdWV1ZSAqdnEpCj4gPiA+Cj4gPiA+ICAvKiBN
YXAgb25lIHNnIGVudHJ5LiAqLwo+ID4gPiAgc3RhdGljIGludCB2cmluZ19tYXBfb25lX3NnKGNv
bnN0IHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLCBzdHJ1Y3Qgc2NhdHRlcmxpc3QgKnNnLAo+
ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24g
ZGlyZWN0aW9uLCBzdGF0aWMgZG1hX2FkZHJfdCAqYWRkcikKPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGVudW0gZG1hX2RhdGFfZGlyZWN0aW9uIGRpcmVjdGlvbiwKPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgcHJlbWFwcGVkLCBkbWFfYWRkcl90ICphZGRy
KQo+ID4KPiA+IGhhdmluZyB0aGluZ3MgbGlrZToKPiA+Cj4gPiBpbnQgZnVuYyhib29sIGRvKQo+
ID4gewo+ID4gaWYgKCFkbykKPiA+ICAgICByZXR1cm47Cj4gPiB9Cj4gPgo+ID4gaXMgYSBoaW50
IHRoYXQgdGhlIGNoZWNrIG5lZWRzIHRvIGJlIGRvbmUgYnkgdGhlIGNhbGxlcj8KPiA+Cj4gPiBB
bmQgdGhpcyBjaGFuZ2Ugc2hvdWxkIHdvcmsgZm9yIGJvdGggcGFja2VkIGFuZCBzcGxpdC4gSSB0
aGluayB3ZSBuZWVkCj4gPiB0byBzcXVhc2ggdGhlIHBhY2tlZCBjaGFuZ2VzIGhlcmUuCj4gPgo+
ID4gTG9va2luZyBhdCBob3cgcGFja2VkIHZpcnRxdWV1ZSB1c2VzIHRoaXMgaW4gdGhpcyBwYXRj
aCwgSSBkb24ndCB0aGluawo+ID4gdGhpcyBwYXRjaCBjYW4gZXZlbiBiZSBidWlsdC4gSSB3aWxs
IHdhaXQgZm9yIGEgbmV3IHZlcnNpb24gYW5kCj4gPiBjb250aW51ZSB0aGUgcmV2aWV3IGZyb20g
dGhlcmUuCj4gPgo+ID4gVGhhbmtzCj4gPgo+ID4KPiA+Cj4gPiA+ICB7Cj4gPiA+ICsgICAgICAg
aWYgKHByZW1hcHBlZCkgewo+ID4gPiArICAgICAgICAgICAgICAgKmFkZHIgPSBzZ19kbWFfYWRk
cmVzcyhzZyk7Cj4gPiA+ICsgICAgICAgICAgICAgICByZXR1cm4gMDsKPiA+ID4gKyAgICAgICB9
Cj4gPiA+ICsKPiA+ID4gICAgICAgICBpZiAoIXZxLT51c2VfZG1hX2FwaSkgewo+ID4gPiAgICAg
ICAgICAgICAgICAgLyoKPiA+ID4gICAgICAgICAgICAgICAgICAqIElmIERNQSBpcyBub3QgdXNl
ZCwgS01TQU4gZG9lc24ndCBrbm93IHRoYXQgdGhlIHNjYXR0ZXJsaXN0Cj4gPiA+IEBAIC00NDUs
NyArNDUyLDcgQEAgc3RhdGljIHZvaWQgdnJpbmdfdW5tYXBfb25lX3NwbGl0X2luZGlyZWN0KGNv
bnN0IHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLAo+ID4gPiAgfQo+ID4gPgo+ID4gPiAgc3Rh
dGljIHVuc2lnbmVkIGludCB2cmluZ191bm1hcF9vbmVfc3BsaXQoY29uc3Qgc3RydWN0IHZyaW5n
X3ZpcnRxdWV1ZSAqdnEsCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVuc2lnbmVkIGludCBpKQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgaSwgYm9vbCBwcmVtYXBwZWQpCj4gPiA+ICB7Cj4g
PiA+ICAgICAgICAgc3RydWN0IHZyaW5nX2Rlc2NfZXh0cmEgKmV4dHJhID0gdnEtPnNwbGl0LmRl
c2NfZXh0cmE7Cj4gPiA+ICAgICAgICAgdTE2IGZsYWdzOwo+ID4gPiBAQCAtNDYyLDYgKzQ2OSw5
IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgdnJpbmdfdW5tYXBfb25lX3NwbGl0KGNvbnN0IHN0cnVj
dCB2cmluZ192aXJ0cXVldWUgKnZxLAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAoZmxhZ3MgJiBWUklOR19ERVNDX0ZfV1JJVEUpID8KPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgRE1BX0ZST01fREVWSUNFIDogRE1BX1RPX0RFVklDRSk7Cj4gPiA+
ICAgICAgICAgfSBlbHNlIHsKPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChwcmVtYXBwZWQpCj4g
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0Owo+ID4gPiArCj4gPiA+ICAgICAg
ICAgICAgICAgICBkbWFfdW5tYXBfcGFnZSh2cmluZ19kbWFfZGV2KHZxKSwKPiA+ID4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhW2ldLmFkZHIsCj4gPiA+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBleHRyYVtpXS5sZW4sCj4gPiA+IEBAIC01MzIsNiArNTQyLDcg
QEAgc3RhdGljIGlubGluZSBpbnQgdmlydHF1ZXVlX2FkZF9zcGxpdChzdHJ1Y3QgdmlydHF1ZXVl
ICpfdnEsCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWdu
ZWQgaW50IGluX3NncywKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB2b2lkICpkYXRhLAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHZvaWQgKmN0eCwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBi
b29sIHByZW1hcHBlZCwKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBnZnBfdCBnZnApCj4gPiA+ICB7Cj4gPiA+ICAgICAgICAgc3RydWN0IHZyaW5nX3ZpcnRxdWV1
ZSAqdnEgPSB0b192dnEoX3ZxKTsKPiA+ID4gQEAgLTU5NSw3ICs2MDYsNyBAQCBzdGF0aWMgaW5s
aW5lIGludCB2aXJ0cXVldWVfYWRkX3NwbGl0KHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ID4g
ICAgICAgICAgICAgICAgIGZvciAoc2cgPSBzZ3Nbbl07IHNnOyBzZyA9IHNnX25leHQoc2cpKSB7
Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGRtYV9hZGRyX3QgYWRkcjsKPiA+ID4KPiA+
ID4gLSAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZyaW5nX21hcF9vbmVfc2codnEsIHNnLCBE
TUFfVE9fREVWSUNFLCAmYWRkcikpCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmICh2
cmluZ19tYXBfb25lX3NnKHZxLCBzZywgRE1BX1RPX0RFVklDRSwgcHJlbWFwcGVkLCAmYWRkcikp
Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byB1bm1hcF9yZWxlYXNl
Owo+ID4gPgo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2ID0gaTsKPiA+ID4gQEAg
LTYxMSw3ICs2MjIsNyBAQCBzdGF0aWMgaW5saW5lIGludCB2aXJ0cXVldWVfYWRkX3NwbGl0KHN0
cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ID4gICAgICAgICAgICAgICAgIGZvciAoc2cgPSBzZ3Nb
bl07IHNnOyBzZyA9IHNnX25leHQoc2cpKSB7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAg
IGRtYV9hZGRyX3QgYWRkcjsKPiA+ID4KPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgaWYg
KHZyaW5nX21hcF9vbmVfc2codnEsIHNnLCBETUFfRlJPTV9ERVZJQ0UsICZhZGRyKSkKPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZyaW5nX21hcF9vbmVfc2codnEsIHNnLCBETUFf
RlJPTV9ERVZJQ0UsIHByZW1hcHBlZCwgJmFkZHIpKQo+ID4gPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGdvdG8gdW5tYXBfcmVsZWFzZTsKPiA+ID4KPiA+ID4gICAgICAgICAgICAg
ICAgICAgICAgICAgcHJldiA9IGk7Cj4gPiA+IEBAIC02NTcsNiArNjY4LDcgQEAgc3RhdGljIGlu
bGluZSBpbnQgdmlydHF1ZXVlX2FkZF9zcGxpdChzdHJ1Y3QgdmlydHF1ZXVlICpfdnEsCj4gPiA+
Cj4gPiA+ICAgICAgICAgLyogU3RvcmUgdG9rZW4gYW5kIGluZGlyZWN0IGJ1ZmZlciBzdGF0ZS4g
Ki8KPiA+ID4gICAgICAgICB2cS0+c3BsaXQuZGVzY19zdGF0ZVtoZWFkXS5kYXRhID0gZGF0YTsK
PiA+ID4gKyAgICAgICB2cS0+c3BsaXQuZGVzY19zdGF0ZVtoZWFkXS5wcmVtYXBwZWQgPSBwcmVt
YXBwZWQ7Cj4gPiA+ICAgICAgICAgaWYgKGluZGlyZWN0KQo+ID4gPiAgICAgICAgICAgICAgICAg
dnEtPnNwbGl0LmRlc2Nfc3RhdGVbaGVhZF0uaW5kaXJfZGVzYyA9IGRlc2M7Cj4gPiA+ICAgICAg
ICAgZWxzZQo+ID4gPiBAQCAtNjg2LDYgKzY5OCwxNCBAQCBzdGF0aWMgaW5saW5lIGludCB2aXJ0
cXVldWVfYWRkX3NwbGl0KHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ID4gICAgICAgICByZXR1
cm4gMDsKPiA+ID4KPiA+ID4gIHVubWFwX3JlbGVhc2U6Cj4gPiA+ICsgICAgICAgaWYgKHByZW1h
cHBlZCkgewo+ID4gPiArICAgICAgICAgICAgICAgaWYgKGluZGlyZWN0KQo+ID4gPiArICAgICAg
ICAgICAgICAgICAgICAgICBrZnJlZShkZXNjKTsKPiA+ID4gKwo+ID4gPiArICAgICAgICAgICAg
ICAgRU5EX1VTRSh2cSk7Cj4gPiA+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiA+
ID4gKyAgICAgICB9Cj4gPiA+ICsKPiA+ID4gICAgICAgICBlcnJfaWR4ID0gaTsKPiA+ID4KPiA+
ID4gICAgICAgICBpZiAoaW5kaXJlY3QpCj4gPiA+IEBAIC03MDAsNyArNzIwLDcgQEAgc3RhdGlj
IGlubGluZSBpbnQgdmlydHF1ZXVlX2FkZF9zcGxpdChzdHJ1Y3QgdmlydHF1ZXVlICpfdnEsCj4g
PiA+ICAgICAgICAgICAgICAgICAgICAgICAgIHZyaW5nX3VubWFwX29uZV9zcGxpdF9pbmRpcmVj
dCh2cSwgJmRlc2NbaV0pOwo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBpID0gdmlydGlv
MTZfdG9fY3B1KF92cS0+dmRldiwgZGVzY1tpXS5uZXh0KTsKPiA+ID4gICAgICAgICAgICAgICAg
IH0gZWxzZQo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBpID0gdnJpbmdfdW5tYXBfb25l
X3NwbGl0KHZxLCBpKTsKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgaSA9IHZyaW5nX3Vu
bWFwX29uZV9zcGxpdCh2cSwgaSwgZmFsc2UpOwo+ID4gPiAgICAgICAgIH0KPiA+ID4KPiA+ID4g
ICAgICAgICBpZiAoaW5kaXJlY3QpCj4gPiA+IEBAIC03NTcsMTIgKzc3NywxMiBAQCBzdGF0aWMg
dm9pZCBkZXRhY2hfYnVmX3NwbGl0KHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLCB1bnNpZ25l
ZCBpbnQgaGVhZCwKPiA+ID4gICAgICAgICBpID0gaGVhZDsKPiA+ID4KPiA+ID4gICAgICAgICB3
aGlsZSAodnEtPnNwbGl0LnZyaW5nLmRlc2NbaV0uZmxhZ3MgJiBuZXh0ZmxhZykgewo+ID4gPiAt
ICAgICAgICAgICAgICAgdnJpbmdfdW5tYXBfb25lX3NwbGl0KHZxLCBpKTsKPiA+ID4gKyAgICAg
ICAgICAgICAgIHZyaW5nX3VubWFwX29uZV9zcGxpdCh2cSwgaSwgc3RhdGUtPnByZW1hcHBlZCk7
Cj4gPiA+ICAgICAgICAgICAgICAgICBpID0gdnEtPnNwbGl0LmRlc2NfZXh0cmFbaV0ubmV4dDsK
PiA+ID4gICAgICAgICAgICAgICAgIHZxLT52cS5udW1fZnJlZSsrOwo+ID4gPiAgICAgICAgIH0K
PiA+ID4KPiA+ID4gLSAgICAgICB2cmluZ191bm1hcF9vbmVfc3BsaXQodnEsIGkpOwo+ID4gPiAr
ICAgICAgIHZyaW5nX3VubWFwX29uZV9zcGxpdCh2cSwgaSwgc3RhdGUtPnByZW1hcHBlZCk7Cj4g
PiA+ICAgICAgICAgdnEtPnNwbGl0LmRlc2NfZXh0cmFbaV0ubmV4dCA9IHZxLT5mcmVlX2hlYWQ7
Cj4gPiA+ICAgICAgICAgdnEtPmZyZWVfaGVhZCA9IGhlYWQ7Cj4gPiA+Cj4gPiA+IEBAIC03ODMs
NyArODAzLDcgQEAgc3RhdGljIHZvaWQgZGV0YWNoX2J1Zl9zcGxpdChzdHJ1Y3QgdnJpbmdfdmly
dHF1ZXVlICp2cSwgdW5zaWduZWQgaW50IGhlYWQsCj4gPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgVlJJTkdfREVTQ19GX0lORElSRUNUKSk7Cj4gPiA+ICAgICAgICAgICAgICAg
ICBCVUdfT04obGVuID09IDAgfHwgbGVuICUgc2l6ZW9mKHN0cnVjdCB2cmluZ19kZXNjKSk7Cj4g
PiA+Cj4gPiA+IC0gICAgICAgICAgICAgICBpZiAodnEtPnVzZV9kbWFfYXBpKSB7Cj4gPiA+ICsg
ICAgICAgICAgICAgICBpZiAodnEtPnVzZV9kbWFfYXBpICYmICFzdGF0ZS0+cHJlbWFwcGVkKSB7
Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBsZW4gLyBzaXpl
b2Yoc3RydWN0IHZyaW5nX2Rlc2MpOyBqKyspCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdnJpbmdfdW5tYXBfb25lX3NwbGl0X2luZGlyZWN0KHZxLCAmaW5kaXJfZGVzY1tq
XSk7Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+IEBAIC0yMTQzLDcgKzIxNjMsNyBAQCBz
dGF0aWMgaW5saW5lIGludCB2aXJ0cXVldWVfYWRkKHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+
ID4gICAgICAgICByZXR1cm4gdnEtPnBhY2tlZF9yaW5nID8gdmlydHF1ZXVlX2FkZF9wYWNrZWQo
X3ZxLCBzZ3MsIHRvdGFsX3NnLAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgb3V0X3NncywgaW5fc2dzLCBkYXRhLCBjdHgsIGdmcCkgOgo+ID4gPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB2aXJ0cXVldWVfYWRkX3NwbGl0KF92cSwgc2dzLCB0
b3RhbF9zZywKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91
dF9zZ3MsIGluX3NncywgZGF0YSwgY3R4LCBnZnApOwo+ID4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgb3V0X3NncywgaW5fc2dzLCBkYXRhLCBjdHgsIHByZW1hcHBl
ZCwgZ2ZwKTsKPiA+ID4gIH0KPiA+ID4KPiA+ID4gIC8qKgo+ID4gPiAtLQo+ID4gPiAyLjMyLjAu
My5nMDExOTVjZjlmCj4gPiA+Cj4KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0aW9uQGxp
c3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0aW9uLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
