Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp2.osuosl.org (smtp2.osuosl.org [IPv6:2605:bc80:3010::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 6D1334244A8
	for <lists.virtualization@lfdr.de>; Wed,  6 Oct 2021 19:40:57 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp2.osuosl.org (Postfix) with ESMTP id 4138F40D95;
	Wed,  6 Oct 2021 17:40:54 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
	by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 7BBFWHW4lBkO; Wed,  6 Oct 2021 17:40:52 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp2.osuosl.org (Postfix) with ESMTPS id AC765408E7;
	Wed,  6 Oct 2021 17:40:51 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 88857C0022;
	Wed,  6 Oct 2021 17:40:51 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp2.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 106E1C000D
 for <virtualization@lists.linux-foundation.org>;
 Wed,  6 Oct 2021 17:40:46 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp2.osuosl.org (Postfix) with ESMTP id ABECA40886
 for <virtualization@lists.linux-foundation.org>;
 Wed,  6 Oct 2021 17:40:44 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
 by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id KBV5BI8jKUGO
 for <virtualization@lists.linux-foundation.org>;
 Wed,  6 Oct 2021 17:40:43 +0000 (UTC)
X-Greylist: from auto-whitelisted by SQLgrey-1.8.0
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by smtp2.osuosl.org (Postfix) with ESMTPS id CC858407EA
 for <virtualization@lists.linux-foundation.org>;
 Wed,  6 Oct 2021 17:40:42 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 CE21F307CAF2; Wed,  6 Oct 2021 20:31:05 +0300 (EEST)
Received: from localhost (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id AB87F305FFA0;
 Wed,  6 Oct 2021 20:31:05 +0300 (EEST)
X-Is-Junk-Enabled: fGZTSsP0qEJE2AIKtlSuFiRRwg9xyHmJ
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v12 30/77] KVM: introspection: add hook/unhook ioctls
Date: Wed,  6 Oct 2021 20:30:26 +0300
Message-Id: <20211006173113.26445-31-alazar@bitdefender.com>
In-Reply-To: <20211006173113.26445-1-alazar@bitdefender.com>
References: <20211006173113.26445-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: Tamas K Lengyel <tamas@tklengyel.com>, Wanpeng Li <wanpengli@tencent.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <nicu.citu@icloud.com>,
 Sean Christopherson <seanjc@google.com>, Joerg Roedel <joro@8bytes.org>,
 virtualization@lists.linux-foundation.org,
 =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Mathieu Tarral <mathieu.tarral@protonmail.com>,
 =?UTF-8?q?Mircea=20C=C3=AErjaliu?= <mcirjaliu@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>, Jim Mattson <jmattson@google.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gaG9vaywgYSBuZXcgdGhyZWFkIGlzIGNyZWF0ZWQgdG8gaGFuZGxlIHRoZSBtZXNzYWdlcyBj
b21pbmcgZnJvbSB0aGUKaW50cm9zcGVjdGlvbiB0b29sIChjb21tYW5kcyBvciBldmVudCByZXBs
aWVzKS4gVGhlIFZNIHJlbGF0ZWQgY29tbWFuZHMKYXJlIGhhbmRsZWQgYnkgdGhpcyB0aHJlYWQs
IHdoaWxlIHRoZSB2Q1BVIGNvbW1hbmRzIGFuZCBldmVudHMgcmVwbGllcwphcmUgZGlzcGF0Y2hl
ZCB0byB0aGUgdkNQVSB0aHJlYWRzLgoKT24gdW5ob29rLCB0aGUgc29ja2V0IGlzIHNodXQgZG93
biwgd2hpY2ggd2lsbCBzaWduYWw6IHRoZSByZWNlaXZpbmcKdGhyZWFkIHRvIHF1aXQgKGJlY2F1
c2UgaXQgbWlnaHQgYmUgYmxvY2tlZCBpbiByZWN2bXNnKCkpIGFuZCB0aGUKaW50cm9zcGVjdGlv
biB0b29sIHRvIGNsZWFuIHVwLgoKVGhlIG11dGV4IGlzIHVzZWQgdG8gcHJvdGVjdCB0aGUgJ2t2
bS0+a3ZtaScgcG9pbnRlciB3aGVuIGFjY2Vzc2VkCnRocm91Z2ggaW9jdGxzLgoKVGhlIHJlZmVy
ZW5jZSBjb3VudGVyIGlzIGluY3JlbWVudGVkIGJ5IHRoZSByZWNlaXZpbmcgdGhyZWFkIChmb3IK
aXRzIGVudGlyZSBsaWZlIHRpbWUpIGFuZCBieSB0aGUgdkNQVSB0aHJlYWRzIHdoaWxlIHNlbmRp
bmcgZXZlbnRzIG9yCmhhbmRsaW5nIGNvbW1hbmRzLgoKVGhlIGNvbXBsZXRpb24gb2JqZWN0cyBp
cyBzZXQgd2hlbiB0aGUgcmVmZXJlbmNlIGNvdW50ZXIgcmVhY2hlcyB6ZXJvLAphbGxvd2luZyB0
aGUgdW5ob29rIHByb2Nlc3MgdG8gY29udGludWUgYW5kIGZyZWUgdGhlIGludHJvc3BlY3Rpb24K
c3RydWN0dXJlcy4KCkNvLWRldmVsb3BlZC1ieTogTWlyY2VhIEPDrnJqYWxpdSA8bWNpcmphbGl1
QGJpdGRlZmVuZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogTWlyY2VhIEPDrnJqYWxpdSA8bWNpcmph
bGl1QGJpdGRlZmVuZGVyLmNvbT4KQ28tZGV2ZWxvcGVkLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5p
Y3UuY2l0dUBpY2xvdWQuY29tPgpTaWduZWQtb2ZmLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5pY3Uu
Y2l0dUBpY2xvdWQuY29tPgpTaWduZWQtb2ZmLWJ5OiBBZGFsYmVydCBMYXrEg3IgPGFsYXphckBi
aXRkZWZlbmRlci5jb20+Ci0tLQogRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9hcGkucnN0ICAgICAg
ICAgICAgICAgIHwgIDY0ICsrKysrKysKIGFyY2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5o
ICAgICAgICAgICAgICB8ICAgOCArCiBhcmNoL3g4Ni9rdm0vTWFrZWZpbGUgICAgICAgICAgICAg
ICAgICAgICAgICAgfCAgIDIgKy0KIGFyY2gveDg2L2t2bS94ODYuYyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB8ICAgNSArCiBpbmNsdWRlL2xpbnV4L2t2bV9ob3N0LmggICAgICAgICAgICAg
ICAgICAgICAgfCAgIDUgKwogaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaCAgICAgICAgICAgICAg
ICAgICAgIHwgIDE4ICsrCiBpbmNsdWRlL3VhcGkvbGludXgva3ZtLmggICAgICAgICAgICAgICAg
ICAgICAgfCAgMTAgKysKIGluY2x1ZGUvdWFwaS9saW51eC9rdm1pLmggICAgICAgICAgICAgICAg
ICAgICB8ICAxMyArKwogdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL01ha2VmaWxlICAgICAg
ICAgIHwgICAxICsKIC4uLi90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5j
ICB8ICA5NCArKysrKysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyAgICAgICAg
ICAgICAgICAgfCAxNjAgKysrKysrKysrKysrKysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9u
L2t2bWlfaW50LmggICAgICAgICAgICAgfCAgMTAgKysKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24v
a3ZtaV9tc2cuYyAgICAgICAgICAgICB8ICAzOSArKysrKwogdmlydC9rdm0va3ZtX21haW4uYyAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDIxICsrKwogMTQgZmlsZXMgY2hhbmdlZCwgNDQ5
IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBhcmNoL3g4
Ni9pbmNsdWRlL2FzbS9rdm1pX2hvc3QuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGluY2x1ZGUvdWFw
aS9saW51eC9rdm1pLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0b29scy90ZXN0aW5nL3NlbGZ0ZXN0
cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgdmlydC9rdm0vaW50
cm9zcGVjdGlvbi9rdm1pX21zZy5jCgpkaWZmIC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2
bS9hcGkucnN0IGIvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9hcGkucnN0CmluZGV4IDBjMGJmMjY0
MjZiMy4uNjgyMzgwNDI1ZWY2IDEwMDY0NAotLS0gYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2Fw
aS5yc3QKKysrIGIvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9hcGkucnN0CkBAIC01NDczLDYgKzU0
NzMsNTkgQEAgdGhlIHRyYWlsaW5nIGBgJ1wwJ2BgLCBpcyBpbmRpY2F0ZWQgYnkgYGBuYW1lX3Np
emVgYCBpbiB0aGUgaGVhZGVyLgogVGhlIFN0YXRzIERhdGEgYmxvY2sgY29udGFpbnMgYW4gYXJy
YXkgb2YgNjQtYml0IHZhbHVlcyBpbiB0aGUgc2FtZSBvcmRlcgogYXMgdGhlIGRlc2NyaXB0b3Jz
IGluIERlc2NyaXB0b3JzIGJsb2NrLgogCis0LjEzNCBLVk1fSU5UUk9TUEVDVElPTl9IT09LCist
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisKKzpDYXBhYmlsaXR5OiBLVk1fQ0FQX0lOVFJP
U1BFQ1RJT04KKzpBcmNoaXRlY3R1cmVzOiB4ODYKKzpUeXBlOiB2bSBpb2N0bAorOlBhcmFtZXRl
cnM6IHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAoaW4pCis6UmV0dXJuczogMCBvbiBzdWNjZXNz
LCBhIG5lZ2F0aXZlIHZhbHVlIG9uIGVycm9yCisKK0Vycm9yczoKKworICA9PT09PT0gICAgID09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
KyAgRU5PTUVNICAgICB0aGUgbWVtb3J5IGFsbG9jYXRpb24gZmFpbGVkCisgIEVFWElTVCAgICAg
dGhlIFZNIGlzIGFscmVhZHkgaW50cm9zcGVjdGVkCisgIEVJTlZBTCAgICAgdGhlIGZpbGUgZGVz
Y3JpcHRvciBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYW4gYWN0aXZlIHNvY2tldAorICBFSU5WQUwg
ICAgIHRoZSBwYWRkaW5nIGlzIG5vdCB6ZXJvCisgIEVQRVJNICAgICAgdGhlIGludHJvc3BlY3Rp
b24gaXMgZGlzYWJsZWQgKGt2bS5pbnRyb3NwZWN0aW9uPTApCisgID09PT09PSAgICAgPT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorCitU
aGlzIGlvY3RsIGlzIHVzZWQgdG8gZW5hYmxlIHRoZSBpbnRyb3NwZWN0aW9uIG9mIHRoZSBjdXJy
ZW50IFZNLgorCis6OgorCisgIHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiB7CisJX19zMzIgZmQ7
CisJX191MzIgcGFkZGluZzsKKwlfX3U4IHV1aWRbMTZdOworICB9OworCitmZCBpcyB0aGUgZmls
ZSBkZXNjcmlwdG9yIG9mIGEgc29ja2V0IGNvbm5lY3RlZCB0byB0aGUgaW50cm9zcGVjdGlvbiB0
b29sLAorCitwYWRkaW5nIG11c3QgYmUgemVybyAoaXQgbWlnaHQgYmUgdXNlZCBpbiB0aGUgZnV0
dXJlKSwKKwordXVpZCBpcyB1c2VkIGZvciBkZWJ1ZyBhbmQgZXJyb3IgbWVzc2FnZXMuCisKKzQu
MTM1IEtWTV9JTlRST1NQRUNUSU9OX1VOSE9PSworLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCisKKzpDYXBhYmlsaXR5OiBLVk1fQ0FQX0lOVFJPU1BFQ1RJT04KKzpBcmNoaXRlY3R1cmVz
OiB4ODYKKzpUeXBlOiB2bSBpb2N0bAorOlBhcmFtZXRlcnM6IG5vbmUKKzpSZXR1cm5zOiAwIG9u
IHN1Y2Nlc3MsIGEgbmVnYXRpdmUgdmFsdWUgb24gZXJyb3IKKworRXJyb3JzOgorCisgID09PT09
PSAgICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PQorICBFUEVSTSAgICAgIHRoZSBpbnRyb3NwZWN0aW9uIGlzIGRpc2FibGVkIChrdm0u
aW50cm9zcGVjdGlvbj0wKQorICA9PT09PT0gICAgID09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KKworVGhpcyBpb2N0bCBpcyB1c2VkIHRv
IGZyZWUgYWxsIGludHJvc3BlY3Rpb24gc3RydWN0dXJlcworcmVsYXRlZCB0byB0aGlzIFZNLgor
CiA1LiBUaGUga3ZtX3J1biBzdHJ1Y3R1cmUKID09PT09PT09PT09PT09PT09PT09PT09PQogCkBA
IC03NDQwLDMgKzc0OTMsMTQgQEAgVGhlIGFyZ3VtZW50IHRvIEtWTV9FTkFCTEVfQ0FQIGlzIGFs
c28gYSBiaXRtYXNrLCBhbmQgbXVzdCBiZSBhIHN1YnNldAogb2YgdGhlIHJlc3VsdCBvZiBLVk1f
Q0hFQ0tfRVhURU5TSU9OLiAgS1ZNIHdpbGwgZm9yd2FyZCB0byB1c2Vyc3BhY2UKIHRoZSBoeXBl
cmNhbGxzIHdob3NlIGNvcnJlc3BvbmRpbmcgYml0IGlzIGluIHRoZSBhcmd1bWVudCwgYW5kIHJl
dHVybgogRU5PU1lTIGZvciB0aGUgb3RoZXJzLgorCis4LjM1IEtWTV9DQVBfSU5UUk9TUEVDVElP
TgorLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKworOkFyY2hpdGVjdHVyZXM6IHg4NgorCitU
aGlzIGNhcGFiaWxpdHkgaW5kaWNhdGVzIHRoYXQgS1ZNIHN1cHBvcnRzIFZNIGludHJvc3BlY3Rp
b24KK2FuZCBpdCBpcyBlbmFibGVkLgorCitUaGUgS1ZNX0NIRUNLX0VYVEVOU0lPTiBpb2N0bCBy
ZXR1cm5zIHRoZSBpbnRyb3NwZWN0aW9uIEFQSSB2ZXJzaW9uCisoYSBudW1iZXIgbGFyZ2VyIHRo
YW4gMCkuCmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1pX2hvc3QuaCBiL2Fy
Y2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4
IDAwMDAwMDAwMDAwMC4uMzhjMzk4MjYyOTEzCi0tLSAvZGV2L251bGwKKysrIGIvYXJjaC94ODYv
aW5jbHVkZS9hc20va3ZtaV9ob3N0LmgKQEAgLTAsMCArMSw4IEBACisvKiBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMCAqLworI2lmbmRlZiBfQVNNX1g4Nl9LVk1JX0hPU1RfSAorI2Rl
ZmluZSBfQVNNX1g4Nl9LVk1JX0hPU1RfSAorCitzdHJ1Y3Qga3ZtX2FyY2hfaW50cm9zcGVjdGlv
biB7Cit9OworCisjZW5kaWYgLyogX0FTTV9YODZfS1ZNSV9IT1NUX0ggKi8KZGlmZiAtLWdpdCBh
L2FyY2gveDg2L2t2bS9NYWtlZmlsZSBiL2FyY2gveDg2L2t2bS9NYWtlZmlsZQppbmRleCBlZDJh
YTMwOGViNzcuLjNhMGNjNDJmMzZjOSAxMDA2NDQKLS0tIGEvYXJjaC94ODYva3ZtL01ha2VmaWxl
CisrKyBiL2FyY2gveDg2L2t2bS9NYWtlZmlsZQpAQCAtMTQsNyArMTQsNyBAQCBrdm0teQkJCSs9
ICQoS1ZNKS9rdm1fbWFpbi5vICQoS1ZNKS9jb2FsZXNjZWRfbW1pby5vIFwKIAkJCQkkKEtWTSkv
ZXZlbnRmZC5vICQoS1ZNKS9pcnFjaGlwLm8gJChLVk0pL3ZmaW8ubyBcCiAJCQkJJChLVk0pL2Rp
cnR5X3JpbmcubyAkKEtWTSkvYmluYXJ5X3N0YXRzLm8KIGt2bS0kKENPTkZJR19LVk1fQVNZTkNf
UEYpCSs9ICQoS1ZNKS9hc3luY19wZi5vCi1rdm0tJChDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04p
ICs9ICQoS1ZNSSkva3ZtaS5vCitrdm0tJChDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04pICs9ICQo
S1ZNSSkva3ZtaS5vICQoS1ZNSSkva3ZtaV9tc2cubwogCiBrdm0teQkJCSs9IHg4Ni5vIGVtdWxh
dGUubyBpODI1OS5vIGlycS5vIGxhcGljLm8gXAogCQkJICAgaTgyNTQubyBpb2FwaWMubyBpcnFf
Y29tbS5vIGNwdWlkLm8gcG11Lm8gbXRyci5vIFwKZGlmZiAtLWdpdCBhL2FyY2gveDg2L2t2bS94
ODYuYyBiL2FyY2gveDg2L2t2bS94ODYuYwppbmRleCBhYjk3ZTAxNzVjMDQuLmVlMDhmYjMzMGYw
ZiAxMDA2NDQKLS0tIGEvYXJjaC94ODYva3ZtL3g4Ni5jCisrKyBiL2FyY2gveDg2L2t2bS94ODYu
YwpAQCAtNTksNiArNTksNyBAQAogI2luY2x1ZGUgPGxpbnV4L21lbV9lbmNyeXB0Lmg+CiAjaW5j
bHVkZSA8bGludXgvZW50cnkta3ZtLmg+CiAjaW5jbHVkZSA8bGludXgvc3VzcGVuZC5oPgorI2lu
Y2x1ZGUgPGxpbnV4L2t2bWlfaG9zdC5oPgogCiAjaW5jbHVkZSA8dHJhY2UvZXZlbnRzL2t2bS5o
PgogCkBAIC00MTE5LDYgKzQxMjAsMTAgQEAgaW50IGt2bV92bV9pb2N0bF9jaGVja19leHRlbnNp
b24oc3RydWN0IGt2bSAqa3ZtLCBsb25nIGV4dCkKIAkJZWxzZQogCQkJciA9IDA7CiAJCWJyZWFr
OworCWNhc2UgS1ZNX0NBUF9JTlRST1NQRUNUSU9OOgorCQlpZiAoZW5hYmxlX2ludHJvc3BlY3Rp
b24pCisJCQlyID0ga3ZtaV92ZXJzaW9uKCk7CisJCWJyZWFrOwogCWRlZmF1bHQ6CiAJCWJyZWFr
OwogCX0KZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgva3ZtX2hvc3QuaCBiL2luY2x1ZGUvbGlu
dXgva3ZtX2hvc3QuaAppbmRleCAyZTQzMDBiZjkzNmYuLmY5ZjVjNjYxYzA1NiAxMDA2NDQKLS0t
IGEvaW5jbHVkZS9saW51eC9rdm1faG9zdC5oCisrKyBiL2luY2x1ZGUvbGludXgva3ZtX2hvc3Qu
aApAQCAtNjIyLDYgKzYyMiwxMSBAQCBzdHJ1Y3Qga3ZtIHsKIAlzdHJ1Y3Qgbm90aWZpZXJfYmxv
Y2sgcG1fbm90aWZpZXI7CiAjZW5kaWYKIAljaGFyIHN0YXRzX2lkW0tWTV9TVEFUU19OQU1FX1NJ
WkVdOworCisJc3RydWN0IG11dGV4IGt2bWlfbG9jazsKKwlyZWZjb3VudF90IGt2bWlfcmVmOwor
CXN0cnVjdCBjb21wbGV0aW9uIGt2bWlfY29tcGxldGU7CisJc3RydWN0IGt2bV9pbnRyb3NwZWN0
aW9uICprdm1pOwogfTsKIAogI2RlZmluZSBrdm1fZXJyKGZtdCwgLi4uKSBcCmRpZmYgLS1naXQg
YS9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oIGIvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaApp
bmRleCAxZTBhNzNjMmExOTAuLjg1NzRiOTY4ODczNiAxMDA2NDQKLS0tIGEvaW5jbHVkZS9saW51
eC9rdm1pX2hvc3QuaAorKysgYi9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oCkBAIC00LDEzICs0
LDMxIEBACiAKICNpZmRlZiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04KIAorI2luY2x1ZGUgPGFz
bS9rdm1pX2hvc3QuaD4KKworc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uIHsKKwlzdHJ1Y3Qga3Zt
X2FyY2hfaW50cm9zcGVjdGlvbiBhcmNoOworCXN0cnVjdCBrdm0gKmt2bTsKKworCXV1aWRfdCB1
dWlkOworCisJc3RydWN0IHNvY2tldCAqc29jazsKKwlzdHJ1Y3QgdGFza19zdHJ1Y3QgKnJlY3Y7
Cit9OworCitpbnQga3ZtaV92ZXJzaW9uKHZvaWQpOwogaW50IGt2bWlfaW5pdCh2b2lkKTsKIHZv
aWQga3ZtaV91bmluaXQodm9pZCk7CiB2b2lkIGt2bWlfY3JlYXRlX3ZtKHN0cnVjdCBrdm0gKmt2
bSk7CiB2b2lkIGt2bWlfZGVzdHJveV92bShzdHJ1Y3Qga3ZtICprdm0pOwogCitpbnQga3ZtaV9p
b2N0bF9ob29rKHN0cnVjdCBrdm0gKmt2bSwKKwkJICAgIGNvbnN0IHN0cnVjdCBrdm1faW50cm9z
cGVjdGlvbl9ob29rICpob29rKTsKK2ludCBrdm1pX2lvY3RsX3VuaG9vayhzdHJ1Y3Qga3ZtICpr
dm0pOworCiAjZWxzZQogCitzdGF0aWMgaW5saW5lIGludCBrdm1pX3ZlcnNpb24odm9pZCkgeyBy
ZXR1cm4gMDsgfQogc3RhdGljIGlubGluZSBpbnQga3ZtaV9pbml0KHZvaWQpIHsgcmV0dXJuIDA7
IH0KIHN0YXRpYyBpbmxpbmUgdm9pZCBrdm1pX3VuaW5pdCh2b2lkKSB7IH0KIHN0YXRpYyBpbmxp
bmUgdm9pZCBrdm1pX2NyZWF0ZV92bShzdHJ1Y3Qga3ZtICprdm0pIHsgfQpkaWZmIC0tZ2l0IGEv
aW5jbHVkZS91YXBpL2xpbnV4L2t2bS5oIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bS5oCmluZGV4
IDMyMmI0YjU4OGQ3NS4uZTMzMjEzZjEyM2IwIDEwMDY0NAotLS0gYS9pbmNsdWRlL3VhcGkvbGlu
dXgva3ZtLmgKKysrIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bS5oCkBAIC0xMTIwLDYgKzExMjAs
NyBAQCBzdHJ1Y3Qga3ZtX3BwY19yZXNpemVfaHB0IHsKICNkZWZpbmUgS1ZNX0NBUF9CSU5BUllf
U1RBVFNfRkQgMjAzCiAjZGVmaW5lIEtWTV9DQVBfRVhJVF9PTl9FTVVMQVRJT05fRkFJTFVSRSAy
MDQKICNkZWZpbmUgS1ZNX0NBUF9BUk1fTVRFIDIwNQorI2RlZmluZSBLVk1fQ0FQX0lOVFJPU1BF
Q1RJT04gMjA2CiAKICNpZmRlZiBLVk1fQ0FQX0lSUV9ST1VUSU5HCiAKQEAgLTE4MTYsNiArMTgx
NywxNSBAQCBzdHJ1Y3Qga3ZtX3Nldl9yZWNlaXZlX3VwZGF0ZV9kYXRhIHsKIAlfX3UzMiB0cmFu
c19sZW47CiB9OwogCitzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb25faG9vayB7CisJX19zMzIgZmQ7
CisJX191MzIgcGFkZGluZzsKKwlfX3U4IHV1aWRbMTZdOworfTsKKworI2RlZmluZSBLVk1fSU5U
Uk9TUEVDVElPTl9IT09LICAgIF9JT1coS1ZNSU8sIDB4YzgsIHN0cnVjdCBrdm1faW50cm9zcGVj
dGlvbl9ob29rKQorI2RlZmluZSBLVk1fSU5UUk9TUEVDVElPTl9VTkhPT0sgIF9JTyhLVk1JTywg
MHhjOSkKKwogI2RlZmluZSBLVk1fREVWX0FTU0lHTl9FTkFCTEVfSU9NTVUJKDEgPDwgMCkKICNk
ZWZpbmUgS1ZNX0RFVl9BU1NJR05fUENJXzJfMwkJKDEgPDwgMSkKICNkZWZpbmUgS1ZNX0RFVl9B
U1NJR05fTUFTS19JTlRYCSgxIDw8IDIpCmRpZmYgLS1naXQgYS9pbmNsdWRlL3VhcGkvbGludXgv
a3ZtaS5oIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaApuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwMDAwMDAuLjM0ZGRhOTEwMTZkYgotLS0gL2Rldi9udWxsCisrKyBiL2luY2x1
ZGUvdWFwaS9saW51eC9rdm1pLmgKQEAgLTAsMCArMSwxMyBAQAorLyogU1BEWC1MaWNlbnNlLUlk
ZW50aWZpZXI6IEdQTC0yLjAgV0lUSCBMaW51eC1zeXNjYWxsLW5vdGUgKi8KKyNpZm5kZWYgX1VB
UElfX0xJTlVYX0tWTUlfSAorI2RlZmluZSBfVUFQSV9fTElOVVhfS1ZNSV9ICisKKy8qCisgKiBL
Vk1JIHN0cnVjdHVyZXMgYW5kIGRlZmluaXRpb25zCisgKi8KKworZW51bSB7CisJS1ZNSV9WRVJT
SU9OID0gMHgwMDAwMDAwMQorfTsKKworI2VuZGlmIC8qIF9VQVBJX19MSU5VWF9LVk1JX0ggKi8K
ZGlmZiAtLWdpdCBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS9NYWtlZmlsZSBiL3Rvb2xz
L3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS9NYWtlZmlsZQppbmRleCBkMTc3NGY0NjEzOTMuLjI0YTY2
YmQ2MjZkOSAxMDA2NDQKLS0tIGEvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL01ha2VmaWxl
CisrKyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS9NYWtlZmlsZQpAQCAtNDcsNiArNDcs
NyBAQCBURVNUX0dFTl9QUk9HU194ODZfNjQgKz0geDg2XzY0L2h5cGVydl9jbG9jawogVEVTVF9H
RU5fUFJPR1NfeDg2XzY0ICs9IHg4Nl82NC9oeXBlcnZfY3B1aWQKIFRFU1RfR0VOX1BST0dTX3g4
Nl82NCArPSB4ODZfNjQvaHlwZXJ2X2ZlYXR1cmVzCiBURVNUX0dFTl9QUk9HU194ODZfNjQgKz0g
eDg2XzY0L2t2bV9wdl90ZXN0CitURVNUX0dFTl9QUk9HU194ODZfNjQgKz0geDg2XzY0L2t2bWlf
dGVzdAogVEVTVF9HRU5fUFJPR1NfeDg2XzY0ICs9IHg4Nl82NC9tbWlvX3dhcm5pbmdfdGVzdAog
VEVTVF9HRU5fUFJPR1NfeDg2XzY0ICs9IHg4Nl82NC9tbXVfcm9sZV90ZXN0CiBURVNUX0dFTl9Q
Uk9HU194ODZfNjQgKz0geDg2XzY0L3BsYXRmb3JtX2luZm9fdGVzdApkaWZmIC0tZ2l0IGEvdG9v
bHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyBiL3Rvb2xzL3Rlc3Rp
bmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMDAwMDAwMDAwMDAwLi5lOTFmM2RhMTFlODMKLS0tIC9kZXYvbnVsbAorKysgYi90b29s
cy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCkBAIC0wLDAgKzEsOTQg
QEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogS1ZNIGludHJv
c3BlY3Rpb24gdGVzdHMKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMjAsIEJpdGRlZmVuZGVyIFMu
Ui5MLgorICovCisKKyNkZWZpbmUgX0dOVV9TT1VSQ0UgLyogZm9yIHByb2dyYW1faW52b2NhdGlv
bl9zaG9ydF9uYW1lICovCisjaW5jbHVkZSA8c3lzL3R5cGVzLmg+CisjaW5jbHVkZSA8c3lzL3Nv
Y2tldC5oPgorCisjaW5jbHVkZSAidGVzdF91dGlsLmgiCisKKyNpbmNsdWRlICJrdm1fdXRpbC5o
IgorI2luY2x1ZGUgInByb2Nlc3Nvci5oIgorI2luY2x1ZGUgIi4uL2xpYi9rdm1fdXRpbF9pbnRl
cm5hbC5oIgorCisjaW5jbHVkZSAibGludXgva3ZtaS5oIgorCisjZGVmaW5lIFZDUFVfSUQgMQor
CitzdGF0aWMgaW50IHNvY2tldF9wYWlyWzJdOworI2RlZmluZSBLdm1fc29ja2V0ICAgICAgIHNv
Y2tldF9wYWlyWzBdCisjZGVmaW5lIFVzZXJzcGFjZV9zb2NrZXQgc29ja2V0X3BhaXJbMV0KKwor
dm9pZCBzZXR1cF9zb2NrZXQodm9pZCkKK3sKKwlpbnQgcjsKKworCXIgPSBzb2NrZXRwYWlyKEFG
X1VOSVgsIFNPQ0tfU1RSRUFNLCAwLCBzb2NrZXRfcGFpcik7CisJVEVTVF9BU1NFUlQociA9PSAw
LAorCQkic29ja2V0cGFpcigpIGZhaWxlZCwgZXJybm8gJWQgKCVzKVxuIiwKKwkJZXJybm8sIHN0
cmVycm9yKGVycm5vKSk7Cit9CisKK3N0YXRpYyB2b2lkIGRvX2hvb2tfaW9jdGwoc3RydWN0IGt2
bV92bSAqdm0sIF9fczMyIGZkLCBpbnQgZXhwZWN0ZWRfZXJyKQoreworCXN0cnVjdCBrdm1faW50
cm9zcGVjdGlvbl9ob29rIGhvb2sgPSB7IC5mZCA9IGZkLCB9OworCWludCByOworCisJciA9IGlv
Y3RsKHZtLT5mZCwgS1ZNX0lOVFJPU1BFQ1RJT05fSE9PSywgJmhvb2spOworCVRFU1RfQVNTRVJU
KHIgPT0gMCB8fCBlcnJubyA9PSBleHBlY3RlZF9lcnIsCisJCSJLVk1fSU5UUk9TUEVDVElPTl9I
T09LIGZhaWxlZCwgZXJybm8gJWQgKCVzKSwgZXhwZWN0ZWQgJWQsIGZkICVkXG4iLAorCQllcnJu
bywgc3RyZXJyb3IoZXJybm8pLCBleHBlY3RlZF9lcnIsIGZkKTsKK30KKworc3RhdGljIHZvaWQg
aG9va19pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQoreworCS8qIGRvX2hvb2tfaW9j
dGwodm0sIC0xLCBFSU5WQUwpOyAqLworCisJLyoKKwkgKiBUaGUgbGFzdCBjYWxsIGZhaWxlZCAi
dG9vIGxhdGUiLgorCSAqIFdlIGhhdmUgdG8gbGV0IHRoZSB2Q1BVIHJ1biBhbmQgY2xlYW4gdXAg
aXRzIHN0cnVjdHVyZXMsCisJICogb3RoZXJ3aXNlIHRoZSBuZXh0IGNhbGwgd2lsbCBmYWlsIHdp
dGggRUVYSVNULgorCSAqLworCisJZG9faG9va19pb2N0bCh2bSwgS3ZtX3NvY2tldCwgMCk7CisJ
ZG9faG9va19pb2N0bCh2bSwgS3ZtX3NvY2tldCwgRUVYSVNUKTsKK30KKworc3RhdGljIHZvaWQg
dW5ob29rX2ludHJvc3BlY3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCit7CisJaW50IHI7CisKKwly
ID0gaW9jdGwodm0tPmZkLCBLVk1fSU5UUk9TUEVDVElPTl9VTkhPT0ssIE5VTEwpOworCVRFU1Rf
QVNTRVJUKHIgPT0gMCwKKwkJIktWTV9JTlRST1NQRUNUSU9OX1VOSE9PSyBmYWlsZWQsIGVycm5v
ICVkICglcylcbiIsCisJCWVycm5vLCBzdHJlcnJvcihlcnJubykpOworfQorCitzdGF0aWMgdm9p
ZCB0ZXN0X2ludHJvc3BlY3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCit7CisJc2V0dXBfc29ja2V0
KCk7CisJaG9va19pbnRyb3NwZWN0aW9uKHZtKTsKKwl1bmhvb2tfaW50cm9zcGVjdGlvbih2bSk7
Cit9CisKK2ludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCit7CisJc3RydWN0IGt2bV92
bSAqdm07CisKKwlpZiAoIWt2bV9jaGVja19jYXAoS1ZNX0NBUF9JTlRST1NQRUNUSU9OKSkgewor
CQlwcmludF9za2lwKCJLVk1fQ0FQX0lOVFJPU1BFQ1RJT04gbm90IGF2YWlsYWJsZSIpOworCQll
eGl0KEtTRlRfU0tJUCk7CisJfQorCisJdm0gPSB2bV9jcmVhdGVfZGVmYXVsdChWQ1BVX0lELCAw
LCBOVUxMKTsKKwl2Y3B1X3NldF9jcHVpZCh2bSwgVkNQVV9JRCwga3ZtX2dldF9zdXBwb3J0ZWRf
Y3B1aWQoKSk7CisKKwl0ZXN0X2ludHJvc3BlY3Rpb24odm0pOworCisJa3ZtX3ZtX2ZyZWUodm0p
OworCXJldHVybiAwOworfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1p
LmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwppbmRleCBmNWI2YmJiZDkyYjkuLjEw
NzZlNWE5YmYzZCAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKKysr
IGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKQEAgLTUsNiArNSw3IEBACiAgKiBDb3B5
cmlnaHQgKEMpIDIwMTctMjAyMSBCaXRkZWZlbmRlciBTLlIuTC4KICAqCiAgKi8KKyNpbmNsdWRl
IDxsaW51eC9rdGhyZWFkLmg+CiAjaW5jbHVkZSAia3ZtaV9pbnQuaCIKIAogaW50IGt2bWlfaW5p
dCh2b2lkKQpAQCAtMTIsMTQgKzEzLDE3MyBAQCBpbnQga3ZtaV9pbml0KHZvaWQpCiAJcmV0dXJu
IDA7CiB9CiAKK2ludCBrdm1pX3ZlcnNpb24odm9pZCkKK3sKKwlyZXR1cm4gS1ZNSV9WRVJTSU9O
OworfQorCiB2b2lkIGt2bWlfdW5pbml0KHZvaWQpCiB7CiB9CiAKK3N0YXRpYyB2b2lkIGt2bWlf
ZnJlZShzdHJ1Y3Qga3ZtICprdm0pCit7CisJa2ZyZWUoa3ZtLT5rdm1pKTsKKwlrdm0tPmt2bWkg
PSBOVUxMOworfQorCitzdGF0aWMgc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICoKK2t2bWlfYWxs
b2Moc3RydWN0IGt2bSAqa3ZtLCBjb25zdCBzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb25faG9vayAq
aG9vaykKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWk7CisKKwlrdm1pID0ga3ph
bGxvYyhzaXplb2YoKmt2bWkpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWt2bWkpCisJCXJldHVybiBO
VUxMOworCisJQlVJTERfQlVHX09OKHNpemVvZihob29rLT51dWlkKSAhPSBzaXplb2Yoa3ZtaS0+
dXVpZCkpOworCW1lbWNweSgma3ZtaS0+dXVpZCwgJmhvb2stPnV1aWQsIHNpemVvZihrdm1pLT51
dWlkKSk7CisKKwlrdm1pLT5rdm0gPSBrdm07CisKKwlyZXR1cm4ga3ZtaTsKK30KKworc3RhdGlj
IHZvaWQga3ZtaV9kZXN0cm95KHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSkKK3sKKwlz
dHJ1Y3Qga3ZtICprdm0gPSBrdm1pLT5rdm07CisKKwlrdm1pX2ZyZWUoa3ZtKTsKK30KKworc3Rh
dGljIHZvaWQga3ZtaV9zdG9wX3JlY3ZfdGhyZWFkKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAq
a3ZtaSkKK3sKKwlrdm1pX3NvY2tfc2h1dGRvd24oa3ZtaSk7Cit9CisKK3N0YXRpYyB2b2lkIF9f
a3ZtaV91bmhvb2soc3RydWN0IGt2bSAqa3ZtKQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlv
biAqa3ZtaSA9IEtWTUkoa3ZtKTsKKworCXdhaXRfZm9yX2NvbXBsZXRpb25fa2lsbGFibGUoJmt2
bS0+a3ZtaV9jb21wbGV0ZSk7CisJa3ZtaV9zb2NrX3B1dChrdm1pKTsKK30KKworc3RhdGljIHZv
aWQga3ZtaV91bmhvb2soc3RydWN0IGt2bSAqa3ZtKQoreworCXN0cnVjdCBrdm1faW50cm9zcGVj
dGlvbiAqa3ZtaTsKKworCW11dGV4X2xvY2soJmt2bS0+a3ZtaV9sb2NrKTsKKworCWt2bWkgPSBL
Vk1JKGt2bSk7CisJaWYgKGt2bWkpIHsKKwkJa3ZtaV9zdG9wX3JlY3ZfdGhyZWFkKGt2bWkpOwor
CQlfX2t2bWlfdW5ob29rKGt2bSk7CisJCWt2bWlfZGVzdHJveShrdm1pKTsKKwl9CisKKwltdXRl
eF91bmxvY2soJmt2bS0+a3ZtaV9sb2NrKTsKK30KKworaW50IGt2bWlfaW9jdGxfdW5ob29rKHN0
cnVjdCBrdm0gKmt2bSkKK3sKKwlrdm1pX3VuaG9vayhrdm0pOworCXJldHVybiAwOworfQorCitz
dGF0aWMgdm9pZCBrdm1pX3B1dChzdHJ1Y3Qga3ZtICprdm0pCit7CisJaWYgKHJlZmNvdW50X2Rl
Y19hbmRfdGVzdCgma3ZtLT5rdm1pX3JlZikpCisJCWNvbXBsZXRlKCZrdm0tPmt2bWlfY29tcGxl
dGUpOworfQorCitzdGF0aWMgaW50IF9fa3ZtaV9ob29rKHN0cnVjdCBrdm0gKmt2bSwKKwkJICAg
ICAgIGNvbnN0IHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbl9ob29rICpob29rKQoreworCXN0cnVj
dCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSA9IEtWTUkoa3ZtKTsKKworCWlmICgha3ZtaV9zb2Nr
X2dldChrdm1pLCBob29rLT5mZCkpCisJCXJldHVybiAtRUlOVkFMOworCisJcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyBpbnQga3ZtaV9yZWN2X3RocmVhZCh2b2lkICphcmcpCit7CisJc3RydWN0IGt2
bV9pbnRyb3NwZWN0aW9uICprdm1pID0gYXJnOworCisJd2hpbGUgKGt2bWlfbXNnX3Byb2Nlc3Mo
a3ZtaSkpCisJCTsKKworCS8qIFNpZ25hbCB1c2Vyc3BhY2UgYW5kIHByZXZlbnQgdGhlIHZDUFVz
IGZyb20gc2VuZGluZyBldmVudHMuICovCisJa3ZtaV9zb2NrX3NodXRkb3duKGt2bWkpOworCisJ
a3ZtaV9wdXQoa3ZtaS0+a3ZtKTsKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBrdm1pX2hv
b2soc3RydWN0IGt2bSAqa3ZtLAorCQkgICAgIGNvbnN0IHN0cnVjdCBrdm1faW50cm9zcGVjdGlv
bl9ob29rICpob29rKQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaTsKKwlpbnQg
ZXJyID0gMDsKKworCW11dGV4X2xvY2soJmt2bS0+a3ZtaV9sb2NrKTsKKworCWlmIChrdm0tPmt2
bWkpIHsKKwkJZXJyID0gLUVFWElTVDsKKwkJZ290byBvdXQ7CisJfQorCisJa3ZtaSA9IGt2bWlf
YWxsb2Moa3ZtLCBob29rKTsKKwlpZiAoIWt2bWkpIHsKKwkJZXJyID0gLUVOT01FTTsKKwkJZ290
byBvdXQ7CisJfQorCisJa3ZtLT5rdm1pID0ga3ZtaTsKKworCWVyciA9IF9fa3ZtaV9ob29rKGt2
bSwgaG9vayk7CisJaWYgKGVycikKKwkJZ290byBkZXN0cm95OworCisJaW5pdF9jb21wbGV0aW9u
KCZrdm0tPmt2bWlfY29tcGxldGUpOworCisJcmVmY291bnRfc2V0KCZrdm0tPmt2bWlfcmVmLCAx
KTsKKworCWt2bWktPnJlY3YgPSBrdGhyZWFkX3J1bihrdm1pX3JlY3ZfdGhyZWFkLCBrdm1pLCAi
a3ZtaS1yZWN2Iik7CisJaWYgKElTX0VSUihrdm1pLT5yZWN2KSkgeworCQllcnIgPSAtRU5PTUVN
OworCQlrdm1pX3B1dChrdm0pOworCQlnb3RvIHVuaG9vazsKKwl9CisKKwlnb3RvIG91dDsKKwor
dW5ob29rOgorCV9fa3ZtaV91bmhvb2soa3ZtKTsKK2Rlc3Ryb3k6CisJa3ZtaV9kZXN0cm95KGt2
bWkpOworb3V0OgorCW11dGV4X3VubG9jaygma3ZtLT5rdm1pX2xvY2spOworCXJldHVybiBlcnI7
Cit9CisKK2ludCBrdm1pX2lvY3RsX2hvb2soc3RydWN0IGt2bSAqa3ZtLAorCQkgICAgY29uc3Qg
c3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uX2hvb2sgKmhvb2spCit7CisJaWYgKGhvb2stPnBhZGRp
bmcpCisJCXJldHVybiAtRUlOVkFMOworCisJcmV0dXJuIGt2bWlfaG9vayhrdm0sIGhvb2spOwor
fQorCiB2b2lkIGt2bWlfY3JlYXRlX3ZtKHN0cnVjdCBrdm0gKmt2bSkKIHsKKwltdXRleF9pbml0
KCZrdm0tPmt2bWlfbG9jayk7CiB9CiAKIHZvaWQga3ZtaV9kZXN0cm95X3ZtKHN0cnVjdCBrdm0g
Kmt2bSkKIHsKKwlrdm1pX3VuaG9vayhrdm0pOwogfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50
cm9zcGVjdGlvbi9rdm1pX2ludC5oIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5o
CmluZGV4IGJkYjQyMjhmZGE1Yi4uYzg5ODc1YmQyYmFjIDEwMDY0NAotLS0gYS92aXJ0L2t2bS9p
bnRyb3NwZWN0aW9uL2t2bWlfaW50LmgKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1p
X2ludC5oCkBAIC0zLDUgKzMsMTUgQEAKICNkZWZpbmUgX19LVk1JX0lOVF9ICiAKICNpbmNsdWRl
IDxsaW51eC9rdm1faG9zdC5oPgorI2luY2x1ZGUgPGxpbnV4L2t2bWlfaG9zdC5oPgorI2luY2x1
ZGUgPHVhcGkvbGludXgva3ZtaS5oPgorCisjZGVmaW5lIEtWTUkoa3ZtKSAoKGt2bSktPmt2bWkp
CisKKy8qIGt2bWlfbXNnLmMgKi8KK2Jvb2wga3ZtaV9zb2NrX2dldChzdHJ1Y3Qga3ZtX2ludHJv
c3BlY3Rpb24gKmt2bWksIGludCBmZCk7Cit2b2lkIGt2bWlfc29ja19zaHV0ZG93bihzdHJ1Y3Qg
a3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkpOwordm9pZCBrdm1pX3NvY2tfcHV0KHN0cnVjdCBrdm1f
aW50cm9zcGVjdGlvbiAqa3ZtaSk7Citib29sIGt2bWlfbXNnX3Byb2Nlc3Moc3RydWN0IGt2bV9p
bnRyb3NwZWN0aW9uICprdm1pKTsKIAogI2VuZGlmCmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRy
b3NwZWN0aW9uL2t2bWlfbXNnLmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi45Mzg3YjE0MjdjYmUKLS0t
IC9kZXYvbnVsbAorKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKQEAgLTAs
MCArMSwzOSBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKKy8qCisgKiBL
Vk0gaW50cm9zcGVjdGlvbiAobWVzc2FnZSBoYW5kbGluZykKKyAqCisgKiBDb3B5cmlnaHQgKEMp
IDIwMTctMjAyMSBCaXRkZWZlbmRlciBTLlIuTC4KKyAqCisgKi8KKyNpbmNsdWRlIDxsaW51eC9u
ZXQuaD4KKyNpbmNsdWRlICJrdm1pX2ludC5oIgorCitib29sIGt2bWlfc29ja19nZXQoc3RydWN0
IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pLCBpbnQgZmQpCit7CisJc3RydWN0IHNvY2tldCAqc29j
azsKKwlpbnQgZXJyOworCisJc29jayA9IHNvY2tmZF9sb29rdXAoZmQsICZlcnIpOworCWlmICgh
c29jaykKKwkJcmV0dXJuIGZhbHNlOworCisJa3ZtaS0+c29jayA9IHNvY2s7CisKKwlyZXR1cm4g
dHJ1ZTsKK30KKwordm9pZCBrdm1pX3NvY2tfcHV0KHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAq
a3ZtaSkKK3sKKwlpZiAoa3ZtaS0+c29jaykKKwkJc29ja2ZkX3B1dChrdm1pLT5zb2NrKTsKK30K
Kwordm9pZCBrdm1pX3NvY2tfc2h1dGRvd24oc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1p
KQoreworCWtlcm5lbF9zb2NrX3NodXRkb3duKGt2bWktPnNvY2ssIFNIVVRfUkRXUik7Cit9CisK
K2Jvb2wga3ZtaV9tc2dfcHJvY2VzcyhzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkpCit7
CisJcmV0dXJuIGZhbHNlOworfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0va3ZtX21haW4uYyBiL3Zp
cnQva3ZtL2t2bV9tYWluLmMKaW5kZXggYzIxNTg3YzQyYmUyLi4zMTJjY2VkZDMzNDAgMTAwNjQ0
Ci0tLSBhL3ZpcnQva3ZtL2t2bV9tYWluLmMKKysrIGIvdmlydC9rdm0va3ZtX21haW4uYwpAQCAt
NDU0Miw2ICs0NTQyLDI3IEBAIHN0YXRpYyBsb25nIGt2bV92bV9pb2N0bChzdHJ1Y3QgZmlsZSAq
ZmlscCwKIAljYXNlIEtWTV9HRVRfU1RBVFNfRkQ6CiAJCXIgPSBrdm1fdm1faW9jdGxfZ2V0X3N0
YXRzX2ZkKGt2bSk7CiAJCWJyZWFrOworI2lmZGVmIENPTkZJR19LVk1fSU5UUk9TUEVDVElPTgor
CWNhc2UgS1ZNX0lOVFJPU1BFQ1RJT05fSE9PSzogeworCQlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rp
b25faG9vayBob29rOworCisJCXIgPSAtRVBFUk07CisJCWlmICghZW5hYmxlX2ludHJvc3BlY3Rp
b24pCisJCQlnb3RvIG91dDsKKworCQlyID0gLUVGQVVMVDsKKwkJaWYgKGNvcHlfZnJvbV91c2Vy
KCZob29rLCBhcmdwLCBzaXplb2YoaG9vaykpKQorCQkJZ290byBvdXQ7CisKKwkJciA9IGt2bWlf
aW9jdGxfaG9vayhrdm0sICZob29rKTsKKwkJYnJlYWs7CisJfQorCWNhc2UgS1ZNX0lOVFJPU1BF
Q1RJT05fVU5IT09LOgorCQlyID0gLUVQRVJNOworCQlpZiAoZW5hYmxlX2ludHJvc3BlY3Rpb24p
CisJCQlyID0ga3ZtaV9pb2N0bF91bmhvb2soa3ZtKTsKKwkJYnJlYWs7CisjZW5kaWYgLyogQ09O
RklHX0tWTV9JTlRST1NQRUNUSU9OICovCiAJZGVmYXVsdDoKIAkJciA9IGt2bV9hcmNoX3ZtX2lv
Y3RsKGZpbHAsIGlvY3RsLCBhcmcpOwogCX0KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0
aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0
aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
