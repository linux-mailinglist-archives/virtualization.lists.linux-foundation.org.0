Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id DF7F11978BF
	for <lists.virtualization@lfdr.de>; Mon, 30 Mar 2020 12:19:58 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 9CF4B86A2D;
	Mon, 30 Mar 2020 10:19:57 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 75rmmdwfNV-m; Mon, 30 Mar 2020 10:19:53 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id A767786A32;
	Mon, 30 Mar 2020 10:19:53 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 8D5E5C1D7E;
	Mon, 30 Mar 2020 10:19:53 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 01720C07FF
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:50 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by hemlock.osuosl.org (Postfix) with ESMTP id E5ABB88437
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:49 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id yRd8BzWZ1iD5
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:48 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by hemlock.osuosl.org (Postfix) with ESMTPS id 3EB41883AC
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:48 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 E4A22305D3CE; Mon, 30 Mar 2020 13:13:00 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id B983A305B7A3;
 Mon, 30 Mar 2020 13:13:00 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v8 72/81] KVM: introspection: add KVMI_VCPU_CONTROL_MSR and
 KVMI_EVENT_MSR
Date: Mon, 30 Mar 2020 13:12:59 +0300
Message-Id: <20200330101308.21702-73-alazar@bitdefender.com>
In-Reply-To: <20200330101308.21702-1-alazar@bitdefender.com>
References: <20200330101308.21702-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <ncitu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBjb21tYW5k
IGlzIHVzZWQgdG8gZW5hYmxlL2Rpc2FibGUgaW50cm9zcGVjdGlvbiBmb3IgYSBzcGVjaWZpYwpN
U1IuIFRoZSBLVk1JX0VWRU5UX01TUiBldmVudCBpcyBzZW50IHdoZW4gdGhlIHRyYWNrZWQgTVNS
IGlzIGdvaW5nIHRvCmJlIGNoYW5nZWQuIFRoZSBpbnRyb3NwZWN0aW9uIHRvb2wgY2FuIHJlc3Bv
bmQgYnkgYWxsb3dpbmcgdGhlIGd1ZXN0IHRvCmNvbnRpbnVlIHdpdGggbm9ybWFsIGV4ZWN1dGlv
biBvciBieSBkaXNjYXJkaW5nIHRoZSBjaGFuZ2UuCgpUaGlzIGlzIG1lYW50IHRvIHByZXZlbnQg
bWFsaWNpb3VzIGNoYW5nZXMgdG8gTVNScwpzdWNoIGFzIE1TUl9JQTMyX1NZU0VOVEVSX0VJUC4K
ClNpZ25lZC1vZmYtYnk6IE1paGFpIERvbsibdSA8bWRvbnR1QGJpdGRlZmVuZGVyLmNvbT4KQ28t
ZGV2ZWxvcGVkLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5jaXR1QGJpdGRlZmVuZGVyLmNvbT4KU2ln
bmVkLW9mZi1ieTogTmljdciZb3IgQ8OuyJt1IDxuY2l0dUBiaXRkZWZlbmRlci5jb20+CkNvLWRl
dmVsb3BlZC1ieTogQWRhbGJlcnQgTGF6xINyIDxhbGF6YXJAYml0ZGVmZW5kZXIuY29tPgpTaWdu
ZWQtb2ZmLWJ5OiBBZGFsYmVydCBMYXrEg3IgPGFsYXphckBiaXRkZWZlbmRlci5jb20+Ci0tLQog
RG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdCAgICAgICAgICAgICAgIHwgIDc1ICsrKysr
KysrKwogYXJjaC94ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmggICAgICAgICAgICAgIHwgIDEy
ICsrCiBhcmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaCAgICAgICAgICAgICAgfCAgMTgg
KysKIGFyY2gveDg2L2t2bS9rdm1pLmMgICAgICAgICAgICAgICAgICAgICAgICAgICB8IDE1NyAr
KysrKysrKysrKysrKysrKysKIGFyY2gveDg2L2t2bS94ODYuYyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB8ICAgMyArCiBpbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oICAgICAgICAgICAgICAg
ICAgICAgfCAgIDIgKwogLi4uL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0
LmMgIHwgMTAyICsrKysrKysrKysrKwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMgICAg
ICAgICAgICAgICAgIHwgICAxICsKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCAg
ICAgICAgICAgICB8ICAgMiArCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgICAg
ICAgICAgICAgfCAgMTMgKysKIDEwIGZpbGVzIGNoYW5nZWQsIDM4NSBpbnNlcnRpb25zKCspCgpk
aWZmIC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdCBiL0RvY3VtZW50YXRp
b24vdmlydC9rdm0va3ZtaS5yc3QKaW5kZXggNmY2NTUxMjMwZTExLi4zYjlkYjk0M2E1NDkgMTAw
NjQ0Ci0tLSBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKKysrIGIvRG9jdW1lbnRh
dGlvbi92aXJ0L2t2bS9rdm1pLnJzdApAQCAtNTUwLDYgKzU1MCw3IEBAIHRoZSBmb2xsb3dpbmcg
ZXZlbnRzOjoKIAlLVk1JX0VWRU5UX0NSCiAJS1ZNSV9FVkVOVF9ERVNDUklQVE9SCiAJS1ZNSV9F
VkVOVF9IWVBFUkNBTEwKKwlLVk1JX0VWRU5UX01TUgogCUtWTUlfRVZFTlRfWFNFVEJWCiAKIFdo
ZW4gYW4gZXZlbnQgaXMgZW5hYmxlZCwgdGhlIGludHJvc3BlY3Rpb24gdG9vbCBpcyBub3RpZmll
ZCBhbmQKQEAgLTg0Myw2ICs4NDQsNDUgQEAgUmV0dXJucyB0aGUgZ3Vlc3QgbWVtb3J5IHR5cGUg
Zm9yIGEgc3BlY2lmaWMgcGh5c2ljYWwgYWRkcmVzcy4KICogLUtWTV9FSU5WQUwgLSB0aGUgcGFk
ZGluZyBpcyBub3QgemVybwogKiAtS1ZNX0VBR0FJTiAtIHRoZSBzZWxlY3RlZCB2Q1BVIGNhbid0
IGJlIGludHJvc3BlY3RlZCB5ZXQKIAorMTkuIEtWTUlfVkNQVV9DT05UUk9MX01TUgorLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLQorCis6QXJjaGl0ZWN0dXJlczogeDg2Cis6VmVyc2lvbnM6ID49
IDEKKzpQYXJhbWV0ZXJzOgorCis6OgorCisJc3RydWN0IGt2bWlfdmNwdV9oZHI7CisJc3RydWN0
IGt2bWlfdmNwdV9jb250cm9sX21zciB7CisJCV9fdTggZW5hYmxlOworCQlfX3U4IHBhZGRpbmcx
OworCQlfX3UxNiBwYWRkaW5nMjsKKwkJX191MzIgbXNyOworCX07CisKKzpSZXR1cm5zOgorCis6
OgorCisJc3RydWN0IGt2bWlfZXJyb3JfY29kZQorCitFbmFibGVzL2Rpc2FibGVzIGludHJvc3Bl
Y3Rpb24gZm9yIGEgc3BlY2lmaWMgTVNSIGFuZCBtdXN0IGJlIHVzZWQKK2luIGFkZGl0aW9uIHRv
ICpLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMqIHdpdGggdGhlICpLVk1JX0VWRU5UX01TUiogSUQg
c2V0LgorCitDdXJyZW50bHksIG9ubHkgTVNScyB3aXRoaW4gdGhlIGZvbGxvd2luZyB0d28gcmFu
Z2VzIGFyZSBzdXBwb3J0ZWQuIFRyeWluZwordG8gY29udHJvbCBldmVudHMgZm9yIGFueSBvdGhl
ciByZWdpc3RlciB3aWxsIGZhaWwgd2l0aCAtS1ZNX0VJTlZBTDo6CisKKwkwICAgICAgICAgIC4u
LiAweDAwMDAxZmZmCisJMHhjMDAwMDAwMCAuLi4gMHhjMDAwMWZmZgorCis6RXJyb3JzOgorCisq
IC1LVk1fRUlOVkFMIC0gdGhlIHNlbGVjdGVkIHZDUFUgaXMgaW52YWxpZAorKiAtS1ZNX0VJTlZB
TCAtIHRoZSBzcGVjaWZpZWQgTVNSIGlzIGludmFsaWQKKyogLUtWTV9FSU5WQUwgLSB0aGUgcGFk
ZGluZyBpcyBub3QgemVybworKiAtS1ZNX0VBR0FJTiAtIHRoZSBzZWxlY3RlZCB2Q1BVIGNhbid0
IGJlIGludHJvc3BlY3RlZCB5ZXQKKwogRXZlbnRzCiA9PT09PT0KIApAQCAtMTE0OCwzICsxMTg4
LDM4IEBAIGludHJvc3BlY3Rpb24gaGFzIGJlZW4gZW5hYmxlZCBmb3IgdGhpcyBldmVudCAoc2Vl
ICoqS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTKiopCiAJS1ZNSV9ERVNDX1RSCiAKIGBgd3JpdGVg
YCBpcyAxIGlmIHRoZSBkZXNjcmlwdG9yIHdhcyB3cml0dGVuLCAwIG90aGVyd2lzZS4KKworOS4g
S1ZNSV9FVkVOVF9NU1IKKy0tLS0tLS0tLS0tLS0tLS0tCisKKzpBcmNoaXRlY3R1cmVzOiB4ODYK
KzpWZXJzaW9uczogPj0gMQorOkFjdGlvbnM6IENPTlRJTlVFLCBDUkFTSAorOlBhcmFtZXRlcnM6
CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV9ldmVudDsKKwlzdHJ1Y3Qga3ZtaV9ldmVudF9tc3Igewor
CQlfX3UzMiBtc3I7CisJCV9fdTMyIHBhZGRpbmc7CisJCV9fdTY0IG9sZF92YWx1ZTsKKwkJX191
NjQgbmV3X3ZhbHVlOworCX07CisKKzpSZXR1cm5zOgorCis6OgorCisJc3RydWN0IGt2bWlfdmNw
dV9oZHI7CisJc3RydWN0IGt2bWlfZXZlbnRfcmVwbHk7CisJc3RydWN0IGt2bWlfZXZlbnRfbXNy
X3JlcGx5IHsKKwkJX191NjQgbmV3X3ZhbDsKKwl9OworCitUaGlzIGV2ZW50IGlzIHNlbnQgd2hl
biBhIG1vZGVsIHNwZWNpZmljIHJlZ2lzdGVyIGlzIGdvaW5nIHRvIGJlIGNoYW5nZWQKK2FuZCB0
aGUgaW50cm9zcGVjdGlvbiBoYXMgYmVlbiBlbmFibGVkIGZvciB0aGlzIGV2ZW50IGFuZCBmb3Ig
dGhpcyBzcGVjaWZpYworcmVnaXN0ZXIgKHNlZSAqKktWTUlfVkNQVV9DT05UUk9MX0VWRU5UUyoq
KS4KKworYGBrdm1pX2V2ZW50YGAsIHRoZSBNU1IgbnVtYmVyLCB0aGUgb2xkIHZhbHVlIGFuZCB0
aGUgbmV3IHZhbHVlIGFyZQorc2VudCB0byB0aGUgaW50cm9zcGVjdGlvbiB0b29sLiBUaGUgKkNP
TlRJTlVFKiBhY3Rpb24gd2lsbCBzZXQgdGhlIGBgbmV3X3ZhbGBgLgpkaWZmIC0tZ2l0IGEvYXJj
aC94ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmggYi9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1p
X2hvc3QuaAppbmRleCAzYzRiYmE4OGI1MGQuLmE5MzI2YzhlODI1MiAxMDA2NDQKLS0tIGEvYXJj
aC94ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmgKKysrIGIvYXJjaC94ODYvaW5jbHVkZS9hc20v
a3ZtaV9ob3N0LmgKQEAgLTIsNyArMiwxMCBAQAogI2lmbmRlZiBfQVNNX1g4Nl9LVk1JX0hPU1Rf
SAogI2RlZmluZSBfQVNNX1g4Nl9LVk1JX0hPU1RfSAogCitzdHJ1Y3QgbXNyX2RhdGE7CisKICNk
ZWZpbmUgS1ZNSV9OVU1fQ1IgNQorI2RlZmluZSBLVk1JX05VTV9NU1IgMHgyMDAwCiAKIHN0cnVj
dCBrdm1pX21vbml0b3JfaW50ZXJjZXB0aW9uIHsKIAlib29sIGt2bWlfaW50ZXJjZXB0ZWQ7CkBA
IC0xNSw2ICsxOCwxMiBAQCBzdHJ1Y3Qga3ZtaV9pbnRlcmNlcHRpb24gewogCXN0cnVjdCBrdm1p
X21vbml0b3JfaW50ZXJjZXB0aW9uIGJyZWFrcG9pbnQ7CiAJc3RydWN0IGt2bWlfbW9uaXRvcl9p
bnRlcmNlcHRpb24gY3IzdzsKIAlzdHJ1Y3Qga3ZtaV9tb25pdG9yX2ludGVyY2VwdGlvbiBkZXNj
cmlwdG9yOworCXN0cnVjdCB7CisJCXN0cnVjdCB7CisJCQlERUNMQVJFX0JJVE1BUChsb3csIEtW
TUlfTlVNX01TUik7CisJCQlERUNMQVJFX0JJVE1BUChoaWdoLCBLVk1JX05VTV9NU1IpOworCQl9
IGt2bWlfbWFzazsKKwl9IG1zcnc7CiB9OwogCiBzdHJ1Y3Qga3ZtX3ZjcHVfYXJjaF9pbnRyb3Nw
ZWN0aW9uIHsKQEAgLTM0LDYgKzQzLDcgQEAgYm9vbCBrdm1pX21vbml0b3JfY3Izd19pbnRlcmNl
cHQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBib29sIGVuYWJsZSk7CiB2b2lkIGt2bWlfeHNldGJ2
X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7CiBib29sIGt2bWlfbW9uaXRvcl9kZXNjX2lu
dGVyY2VwdChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIGJvb2wgZW5hYmxlKTsKIGJvb2wga3ZtaV9k
ZXNjcmlwdG9yX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTggZGVzY3JpcHRvciwgYm9v
bCB3cml0ZSk7Citib29sIGt2bWlfbXNyX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgc3Ry
dWN0IG1zcl9kYXRhICptc3IpOwogCiAjZWxzZSAvKiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04g
Ki8KIApAQCAtNTAsNiArNjAsOCBAQCBzdGF0aWMgaW5saW5lIGJvb2wga3ZtaV9tb25pdG9yX2Rl
c2NfaW50ZXJjZXB0KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKIAkJCQkJICAgICAgIGJvb2wgZW5h
YmxlKSB7IHJldHVybiBmYWxzZTsgfQogc3RhdGljIGlubGluZSBib29sIGt2bWlfZGVzY3JpcHRv
cl9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU4IGRlc2NyaXB0b3IsCiAJCQkJCSBib29s
IHdyaXRlKSB7IHJldHVybiB0cnVlOyB9CitzdGF0aWMgaW5saW5lIGJvb2wga3ZtaV9tc3JfZXZl
bnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBzdHJ1Y3QgbXNyX2RhdGEgKm1zcikKKwkJCQl7IHJl
dHVybiB0cnVlOyB9CiAKICNlbmRpZiAvKiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04gKi8KIApk
aWZmIC0tZ2l0IGEvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmggYi9hcmNoL3g4Ni9p
bmNsdWRlL3VhcGkvYXNtL2t2bWkuaAppbmRleCA2OTFhNTAxMjAwYjMuLmU0ZDU5MTkxMmYzNyAx
MDA2NDQKLS0tIGEvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmgKKysrIGIvYXJjaC94
ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmgKQEAgLTEyMSw0ICsxMjEsMjIgQEAgc3RydWN0IGt2
bWlfZXZlbnRfZGVzY3JpcHRvciB7CiAJX191OCBwYWRkaW5nWzZdOwogfTsKIAorc3RydWN0IGt2
bWlfdmNwdV9jb250cm9sX21zciB7CisJX191OCBlbmFibGU7CisJX191OCBwYWRkaW5nMTsKKwlf
X3UxNiBwYWRkaW5nMjsKKwlfX3UzMiBtc3I7Cit9OworCitzdHJ1Y3Qga3ZtaV9ldmVudF9tc3Ig
eworCV9fdTMyIG1zcjsKKwlfX3UzMiBwYWRkaW5nOworCV9fdTY0IG9sZF92YWx1ZTsKKwlfX3U2
NCBuZXdfdmFsdWU7Cit9OworCitzdHJ1Y3Qga3ZtaV9ldmVudF9tc3JfcmVwbHkgeworCV9fdTY0
IG5ld192YWw7Cit9OworCiAjZW5kaWYgLyogX1VBUElfQVNNX1g4Nl9LVk1JX0ggKi8KZGlmZiAt
LWdpdCBhL2FyY2gveDg2L2t2bS9rdm1pLmMgYi9hcmNoL3g4Ni9rdm0va3ZtaS5jCmluZGV4IDEx
MTc4YmQ3NWNiNC4uYjU3YjQzMjBhMTlmIDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9rdm0va3ZtaS5j
CisrKyBiL2FyY2gveDg2L2t2bS9rdm1pLmMKQEAgLTQxOCw2ICs0MTgsNzYgQEAgc3RhdGljIHZv
aWQga3ZtaV9hcmNoX2Rpc2FibGVfZGVzY19pbnRlcmNlcHQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
KQogCXZjcHUtPmFyY2gua3ZtaS0+ZGVzY3JpcHRvci5rdm1faW50ZXJjZXB0ZWQgPSBmYWxzZTsK
IH0KIAorc3RhdGljIGJvb2wga3ZtaV9tc3JfdmFsaWQodW5zaWduZWQgaW50IG1zcikKK3sKKwly
ZXR1cm4gbXNyIDw9IDB4MWZmZiB8fCAobXNyID49IDB4YzAwMDAwMDAgJiYgbXNyIDw9IDB4YzAw
MDFmZmYpOworfQorCitzdGF0aWMgdW5zaWduZWQgbG9uZyAqbXNyX21hc2soc3RydWN0IGt2bV92
Y3B1ICp2Y3B1LCB1bnNpZ25lZCBpbnQgKm1zcikKK3sKKwlzd2l0Y2ggKCptc3IpIHsKKwljYXNl
IDAgLi4uIDB4MWZmZjoKKwkJcmV0dXJuIHZjcHUtPmFyY2gua3ZtaS0+bXNydy5rdm1pX21hc2su
bG93OworCWNhc2UgMHhjMDAwMDAwMCAuLi4gMHhjMDAwMWZmZjoKKwkJKm1zciAmPSAweDFmZmY7
CisJCXJldHVybiB2Y3B1LT5hcmNoLmt2bWktPm1zcncua3ZtaV9tYXNrLmhpZ2g7CisJfQorCisJ
cmV0dXJuIE5VTEw7Cit9CisKK3N0YXRpYyBib29sIHRlc3RfbXNyX21hc2soc3RydWN0IGt2bV92
Y3B1ICp2Y3B1LCB1bnNpZ25lZCBpbnQgbXNyKQoreworCXVuc2lnbmVkIGxvbmcgKm1hc2sgPSBt
c3JfbWFzayh2Y3B1LCAmbXNyKTsKKworCWlmICghbWFzaykKKwkJcmV0dXJuIGZhbHNlOworCisJ
cmV0dXJuICEhdGVzdF9iaXQobXNyLCBtYXNrKTsKK30KKworc3RhdGljIGJvb2wgbXNyX2NvbnRy
b2woc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1bnNpZ25lZCBpbnQgbXNyLCBib29sIGVuYWJsZSkK
K3sKKwl1bnNpZ25lZCBsb25nICptYXNrID0gbXNyX21hc2sodmNwdSwgJm1zcik7CisKKwlpZiAo
IW1hc2spCisJCXJldHVybiBmYWxzZTsKKworCWlmIChlbmFibGUpCisJCXNldF9iaXQobXNyLCBt
YXNrKTsKKwllbHNlCisJCWNsZWFyX2JpdChtc3IsIG1hc2spOworCisJcmV0dXJuIHRydWU7Cit9
CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgbXNyX21hc2tfdG9fYmFzZShzdHJ1Y3Qga3ZtX3ZjcHUg
KnZjcHUsIHVuc2lnbmVkIGxvbmcgKm1hc2spCit7CisJaWYgKG1hc2sgPT0gdmNwdS0+YXJjaC5r
dm1pLT5tc3J3Lmt2bWlfbWFzay5oaWdoKQorCQlyZXR1cm4gMHhjMDAwMDAwMDsKKworCXJldHVy
biAwOworfQorCitzdGF0aWMgdm9pZCBrdm1pX2FyY2hfZGlzYWJsZV9tc3JfaW50ZXJjZXB0KHN0
cnVjdCBrdm1fdmNwdSAqdmNwdSwKKwkJCQkJICAgIHVuc2lnbmVkIGxvbmcgKm1hc2spCit7CisJ
dW5zaWduZWQgaW50IG1zcl9iYXNlID0gbXNyX21hc2tfdG9fYmFzZSh2Y3B1LCBtYXNrKTsKKwlp
bnQgb2Zmc2V0ID0gLTE7CisKKwlmb3IgKDs7KSB7CisJCW9mZnNldCA9IGZpbmRfbmV4dF9iaXQo
bWFzaywgS1ZNSV9OVU1fTVNSLCBvZmZzZXQgKyAxKTsKKworCQlpZiAob2Zmc2V0ID49IEtWTUlf
TlVNX01TUikKKwkJCWJyZWFrOworCisJCWt2bV94ODZfb3BzLT5jb250cm9sX21zcl9pbnRlcmNl
cHQodmNwdSwgbXNyX2Jhc2UgKyBvZmZzZXQsCisJCQkJCQkgICBNU1JfVFlQRV9XLCBmYWxzZSk7
CisJfQorCisJYml0bWFwX3plcm8obWFzaywgS1ZNSV9OVU1fTVNSKTsKK30KKwogaW50IGt2bWlf
YXJjaF9jbWRfY29udHJvbF9pbnRlcmNlcHQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LAogCQkJCSAg
ICB1bnNpZ25lZCBpbnQgZXZlbnRfaWQsIGJvb2wgZW5hYmxlKQogewpAQCAtNDY3LDYgKzUzNyw4
IEBAIGJvb2wga3ZtaV9hcmNoX3Jlc3RvcmVfaW50ZXJjZXB0aW9uKHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSkKIAlrdm1pX2FyY2hfZGlzYWJsZV9icF9pbnRlcmNlcHQodmNwdSk7CiAJa3ZtaV9hcmNo
X2Rpc2FibGVfY3Izd19pbnRlcmNlcHQodmNwdSk7CiAJa3ZtaV9hcmNoX2Rpc2FibGVfZGVzY19p
bnRlcmNlcHQodmNwdSk7CisJa3ZtaV9hcmNoX2Rpc2FibGVfbXNyX2ludGVyY2VwdCh2Y3B1LCBh
cmNoX3ZjcHVpLT5tc3J3Lmt2bWlfbWFzay5sb3cpOworCWt2bWlfYXJjaF9kaXNhYmxlX21zcl9p
bnRlcmNlcHQodmNwdSwgYXJjaF92Y3B1aS0+bXNydy5rdm1pX21hc2suaGlnaCk7CiAKIAlyZXR1
cm4gdHJ1ZTsKIH0KQEAgLTg0OSwzICs5MjEsODggQEAgYm9vbCBrdm1pX2Rlc2NyaXB0b3JfZXZl
bnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1OCBkZXNjcmlwdG9yLCBib29sIHdyaXRlKQogCXJl
dHVybiByZXQ7CiB9CiBFWFBPUlRfU1lNQk9MKGt2bWlfZGVzY3JpcHRvcl9ldmVudCk7CisKK2lu
dCBrdm1pX2FyY2hfY21kX3ZjcHVfY29udHJvbF9tc3Ioc3RydWN0IGt2bV92Y3B1ICp2Y3B1LAor
CQkJCSAgIGNvbnN0IHN0cnVjdCBrdm1pX3ZjcHVfY29udHJvbF9tc3IgKnJlcSkKK3sKKwlpZiAo
cmVxLT5wYWRkaW5nMSB8fCByZXEtPnBhZGRpbmcyKQorCQlyZXR1cm4gLUtWTV9FSU5WQUw7CisK
KwlpZiAoIWt2bWlfbXNyX3ZhbGlkKHJlcS0+bXNyKSkKKwkJcmV0dXJuIC1LVk1fRUlOVkFMOwor
CisJa3ZtX3g4Nl9vcHMtPmNvbnRyb2xfbXNyX2ludGVyY2VwdCh2Y3B1LCByZXEtPm1zciwgTVNS
X1RZUEVfVywKKwkJCQkJICAgcmVxLT5lbmFibGUpOworCW1zcl9jb250cm9sKHZjcHUsIHJlcS0+
bXNyLCByZXEtPmVuYWJsZSk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHUzMiBrdm1pX3Nl
bmRfbXNyKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTMyIG1zciwgdTY0IG9sZF92YWx1ZSwKKwkJ
CSB1NjQgbmV3X3ZhbHVlLCB1NjQgKnJldF92YWx1ZSkKK3sKKwlzdHJ1Y3Qga3ZtaV9ldmVudF9t
c3IgZTsKKwlzdHJ1Y3Qga3ZtaV9ldmVudF9tc3JfcmVwbHkgcjsKKwlpbnQgZXJyLCBhY3Rpb247
CisKKwltZW1zZXQoJmUsIDAsIHNpemVvZihlKSk7CisJZS5tc3IgPSBtc3I7CisJZS5vbGRfdmFs
dWUgPSBvbGRfdmFsdWU7CisJZS5uZXdfdmFsdWUgPSBuZXdfdmFsdWU7CisKKwllcnIgPSBrdm1p
X3NlbmRfZXZlbnQodmNwdSwgS1ZNSV9FVkVOVF9NU1IsICZlLCBzaXplb2YoZSksCisJCQkgICAg
ICAmciwgc2l6ZW9mKHIpLCAmYWN0aW9uKTsKKwlpZiAoZXJyKQorCQlyZXR1cm4gS1ZNSV9FVkVO
VF9BQ1RJT05fQ09OVElOVUU7CisKKwkqcmV0X3ZhbHVlID0gci5uZXdfdmFsOworCXJldHVybiBh
Y3Rpb247Cit9CisKK3N0YXRpYyBib29sIF9fa3ZtaV9tc3JfZXZlbnQoc3RydWN0IGt2bV92Y3B1
ICp2Y3B1LCBzdHJ1Y3QgbXNyX2RhdGEgKm1zcikKK3sKKwlzdHJ1Y3QgbXNyX2RhdGEgb2xkX21z
ciA9IHsKKwkJLmhvc3RfaW5pdGlhdGVkID0gdHJ1ZSwKKwkJLmluZGV4ID0gbXNyLT5pbmRleCwK
Kwl9OworCWJvb2wgcmV0ID0gZmFsc2U7CisJdTY0IHJldF92YWx1ZSA9IG1zci0+ZGF0YTsKKwl1
MzIgYWN0aW9uOworCisJaWYgKCF0ZXN0X21zcl9tYXNrKHZjcHUsIG1zci0+aW5kZXgpKQorCQly
ZXR1cm4gdHJ1ZTsKKwlpZiAoa3ZtX3g4Nl9vcHMtPmdldF9tc3IodmNwdSwgJm9sZF9tc3IpKQor
CQlyZXR1cm4gdHJ1ZTsKKwlpZiAob2xkX21zci5kYXRhID09IG1zci0+ZGF0YSkKKwkJcmV0dXJu
IHRydWU7CisKKwlhY3Rpb24gPSBrdm1pX3NlbmRfbXNyKHZjcHUsIG1zci0+aW5kZXgsIG9sZF9t
c3IuZGF0YSwgbXNyLT5kYXRhLAorCQkJICAgICAgICZyZXRfdmFsdWUpOworCXN3aXRjaCAoYWN0
aW9uKSB7CisJY2FzZSBLVk1JX0VWRU5UX0FDVElPTl9DT05USU5VRToKKwkJbXNyLT5kYXRhID0g
cmV0X3ZhbHVlOworCQlyZXQgPSB0cnVlOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlrdm1pX2hh
bmRsZV9jb21tb25fZXZlbnRfYWN0aW9ucyh2Y3B1LT5rdm0sIGFjdGlvbiwgIk1TUiIpOworCX0K
KworCXJldHVybiByZXQ7Cit9CisKK2Jvb2wga3ZtaV9tc3JfZXZlbnQoc3RydWN0IGt2bV92Y3B1
ICp2Y3B1LCBzdHJ1Y3QgbXNyX2RhdGEgKm1zcikKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rp
b24gKmt2bWk7CisJYm9vbCByZXQgPSB0cnVlOworCisJa3ZtaSA9IGt2bWlfZ2V0KHZjcHUtPmt2
bSk7CisJaWYgKCFrdm1pKQorCQlyZXR1cm4gdHJ1ZTsKKworCWlmIChpc19ldmVudF9lbmFibGVk
KHZjcHUsIEtWTUlfRVZFTlRfTVNSKSkKKwkJcmV0ID0gX19rdm1pX21zcl9ldmVudCh2Y3B1LCBt
c3IpOworCisJa3ZtaV9wdXQodmNwdS0+a3ZtKTsKKworCXJldHVybiByZXQ7Cit9CmRpZmYgLS1n
aXQgYS9hcmNoL3g4Ni9rdm0veDg2LmMgYi9hcmNoL3g4Ni9rdm0veDg2LmMKaW5kZXggYWIwYWQz
YjZlYmMyLi5jZTJmOWQ0N2Q2ZjYgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS94ODYuYworKysg
Yi9hcmNoL3g4Ni9rdm0veDg2LmMKQEAgLTE0OTAsNiArMTQ5MCw5IEBAIHN0YXRpYyBpbnQgX19r
dm1fc2V0X21zcihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHUzMiBpbmRleCwgdTY0IGRhdGEsCiAJ
bXNyLmluZGV4ID0gaW5kZXg7CiAJbXNyLmhvc3RfaW5pdGlhdGVkID0gaG9zdF9pbml0aWF0ZWQ7
CiAKKwlpZiAoIWhvc3RfaW5pdGlhdGVkICYmICFrdm1pX21zcl9ldmVudCh2Y3B1LCAmbXNyKSkK
KwkJcmV0dXJuIDE7CisKIAlyZXR1cm4ga3ZtX3g4Nl9vcHMtPnNldF9tc3IodmNwdSwgJm1zcik7
CiB9CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmggYi9pbmNsdWRlL3Vh
cGkvbGludXgva3ZtaS5oCmluZGV4IDJjY2M0MDQ1MTM3Zi4uMDRlNjk3MWVhMGFmIDEwMDY0NAot
LS0gYS9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oCisrKyBiL2luY2x1ZGUvdWFwaS9saW51eC9r
dm1pLmgKQEAgLTM4LDYgKzM4LDcgQEAgZW51bSB7CiAKIAlLVk1JX1ZDUFVfR0VUX1hTQVZFICAg
ICA9IDE4LAogCUtWTUlfVkNQVV9HRVRfTVRSUl9UWVBFID0gMTksCisJS1ZNSV9WQ1BVX0NPTlRS
T0xfTVNSICAgPSAyMCwKIAogCUtWTUlfTlVNX01FU1NBR0VTCiB9OwpAQCAtNTEsNiArNTIsNyBA
QCBlbnVtIHsKIAlLVk1JX0VWRU5UX1RSQVAgICAgICAgPSA1LAogCUtWTUlfRVZFTlRfWFNFVEJW
ICAgICA9IDYsCiAJS1ZNSV9FVkVOVF9ERVNDUklQVE9SID0gNywKKwlLVk1JX0VWRU5UX01TUiAg
ICAgICAgPSA4LAogCiAJS1ZNSV9OVU1fRVZFTlRTCiB9OwpkaWZmIC0tZ2l0IGEvdG9vbHMvdGVz
dGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2Vs
ZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKaW5kZXggNGYyZGUzMDRhNmY4Li45NTVlZjU1
ZTEzNDYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3Zt
aV90ZXN0LmMKKysrIGIvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rl
c3QuYwpAQCAtNTcsNiArNTcsNyBAQCBlbnVtIHsKIAlHVUVTVF9URVNUX0NSLAogCUdVRVNUX1RF
U1RfREVTQ1JJUFRPUiwKIAlHVUVTVF9URVNUX0hZUEVSQ0FMTCwKKwlHVUVTVF9URVNUX01TUiwK
IAlHVUVTVF9URVNUX1hTRVRCViwKIH07CiAKQEAgLTk3LDYgKzk4LDE1IEBAIHN0YXRpYyB2b2lk
IGd1ZXN0X2h5cGVyY2FsbF90ZXN0KHZvaWQpCiAJYXNtIHZvbGF0aWxlKCIuYnl0ZSAweDBmLDB4
MDEsMHhjMSIpOwogfQogCitzdGF0aWMgdm9pZCBndWVzdF9tc3JfdGVzdCh2b2lkKQoreworCXVp
bnQ2NF90IG1zcjsKKworCW1zciA9IHJkbXNyKE1TUl9NSVNDX0ZFQVRVUkVTX0VOQUJMRVMpOwor
CW1zciB8PSAxOyAvKiBNU1JfTUlTQ19GRUFUVVJFU19FTkFCTEVTX0NQVUlEX0ZBVUxUICovCisJ
d3Jtc3IoTVNSX01JU0NfRkVBVFVSRVNfRU5BQkxFUywgbXNyKTsKK30KKwogLyogZnJvbSBmcHUv
aW50ZXJuYWwuaCAqLwogc3RhdGljIHU2NCB4Z2V0YnYodTMyIGluZGV4KQogewpAQCAtMTU0LDYg
KzE2NCw5IEBAIHN0YXRpYyB2b2lkIGd1ZXN0X2NvZGUodm9pZCkKIAkJY2FzZSBHVUVTVF9URVNU
X0hZUEVSQ0FMTDoKIAkJCWd1ZXN0X2h5cGVyY2FsbF90ZXN0KCk7CiAJCQlicmVhazsKKwkJY2Fz
ZSBHVUVTVF9URVNUX01TUjoKKwkJCWd1ZXN0X21zcl90ZXN0KCk7CisJCQlicmVhazsKIAkJY2Fz
ZSBHVUVTVF9URVNUX1hTRVRCVjoKIAkJCWd1ZXN0X3hzZXRidl90ZXN0KCk7CiAJCQlicmVhazsK
QEAgLTE0MzcsNiArMTQ1MCw5NCBAQCBzdGF0aWMgdm9pZCB0ZXN0X2V2ZW50X2Rlc2NyaXB0b3Io
c3RydWN0IGt2bV92bSAqdm0pCiAJZGlzYWJsZV92Y3B1X2V2ZW50KHZtLCBldmVudF9pZCk7CiB9
CiAKK3N0YXRpYyBpbnQgY21kX2NvbnRyb2xfbXNyKHN0cnVjdCBrdm1fdm0gKnZtLCBfX3UzMiBt
c3IsIGJvb2wgZW5hYmxlKQoreworCXN0cnVjdCB7CisJCXN0cnVjdCBrdm1pX21zZ19oZHIgaGRy
OworCQlzdHJ1Y3Qga3ZtaV92Y3B1X2hkciB2Y3B1X2hkcjsKKwkJc3RydWN0IGt2bWlfdmNwdV9j
b250cm9sX21zciBjbWQ7CisJfSByZXEgPSB7fTsKKworCXJlcS5jbWQubXNyID0gbXNyOworCXJl
cS5jbWQuZW5hYmxlID0gZW5hYmxlID8gMSA6IDA7CisKKwlyZXR1cm4gZG9fdmNwdTBfY29tbWFu
ZCh2bSwgS1ZNSV9WQ1BVX0NPTlRST0xfTVNSLAorCQkJCSZyZXEuaGRyLCBzaXplb2YocmVxKSwg
TlVMTCwgMCk7Cit9CisKK3N0YXRpYyB2b2lkIGVuYWJsZV9tc3JfZXZlbnRzKHN0cnVjdCBrdm1f
dm0gKnZtLCBfX3UzMiBtc3IpCit7CisJaW50IHI7CisKKwllbmFibGVfdmNwdV9ldmVudCh2bSwg
S1ZNSV9FVkVOVF9NU1IpOworCisJciA9IGNtZF9jb250cm9sX21zcih2bSwgbXNyLCB0cnVlKTsK
KwlURVNUX0FTU0VSVChyID09IDAsCisJCSJLVk1JX0VWRU5UX01TUiBmYWlsZWQsIGVycm9yICVk
KCVzKVxuIiwKKwkJLXIsIGt2bV9zdHJlcnJvcigtcikpOworfQorCitzdGF0aWMgdm9pZCBkaXNh
YmxlX21zcl9ldmVudHMoc3RydWN0IGt2bV92bSAqdm0sIF9fdTMyIG1zcikKK3sKKwlpbnQgcjsK
KworCXIgPSBjbWRfY29udHJvbF9tc3Iodm0sIG1zciwgZmFsc2UpOworCVRFU1RfQVNTRVJUKHIg
PT0gMCwKKwkJIktWTUlfRVZFTlRfTVNSIGZhaWxlZCwgZXJyb3IgJWQoJXMpXG4iLAorCQktciwg
a3ZtX3N0cmVycm9yKC1yKSk7CisKKwlkaXNhYmxlX3ZjcHVfZXZlbnQodm0sIEtWTUlfRVZFTlRf
TVNSKTsKK30KKworc3RhdGljIHZvaWQgdGVzdF9jbWRfdmNwdV9jb250cm9sX21zcihzdHJ1Y3Qg
a3ZtX3ZtICp2bSkKK3sKKwlzdHJ1Y3QgdmNwdV93b3JrZXJfZGF0YSBkYXRhID0geworCQkudm0g
PSB2bSwKKwkJLnZjcHVfaWQgPSBWQ1BVX0lELAorCQkudGVzdF9pZCA9IEdVRVNUX1RFU1RfTVNS
LAorCX07CisJc3RydWN0IGt2bWlfbXNnX2hkciBoZHI7CisJc3RydWN0IHsKKwkJc3RydWN0IGt2
bWlfZXZlbnQgY29tbW9uOworCQlzdHJ1Y3Qga3ZtaV9ldmVudF9tc3IgbXNyOworCX0gZXY7CisJ
c3RydWN0IHsKKwkJc3RydWN0IHZjcHVfcmVwbHkgY29tbW9uOworCQlzdHJ1Y3Qga3ZtaV9ldmVu
dF9tc3JfcmVwbHkgbXNyOworCX0gcnBsID0ge307CisJX191MTYgZXZlbnRfaWQgPSBLVk1JX0VW
RU5UX01TUjsKKwlfX3UzMiBtc3IgPSBNU1JfTUlTQ19GRUFUVVJFU19FTkFCTEVTOworCXVpbnQ2
NF90IG1zcl9kYXRhOworCXB0aHJlYWRfdCB2Y3B1X3RocmVhZDsKKworCWVuYWJsZV9tc3JfZXZl
bnRzKHZtLCBtc3IpOworCisJdmNwdV90aHJlYWQgPSBzdGFydF92Y3B1X3dvcmtlcigmZGF0YSk7
CisKKwlyZWNlaXZlX2V2ZW50KCZoZHIsICZldi5jb21tb24sIHNpemVvZihldiksIGV2ZW50X2lk
KTsKKworCURFQlVHKCJNU1IgMHgleCwgb2xkIDB4JWxseCwgbmV3IDB4JWxseFxuIiwKKwkJZXYu
bXNyLm1zciwgZXYubXNyLm9sZF92YWx1ZSwgZXYubXNyLm5ld192YWx1ZSk7CisKKwlURVNUX0FT
U0VSVChldi5tc3IubXNyID09IG1zciwKKwkJIlVuZXhwZWN0ZWQgTVNSIGV2ZW50LCByZWNlaXZl
ZCBNU1IgMHgleCwgZXhwZWN0ZWQgTVNSIDB4JXgiLAorCQlldi5tc3IubXNyLCBtc3IpOworCisJ
cnBsLm1zci5uZXdfdmFsID0gZXYubXNyLm9sZF92YWx1ZTsKKworCXJlcGx5X3RvX2V2ZW50KCZo
ZHIsICZldi5jb21tb24sIEtWTUlfRVZFTlRfQUNUSU9OX0NPTlRJTlVFLAorCQkJJnJwbC5jb21t
b24sIHNpemVvZihycGwpKTsKKworCXN0b3BfdmNwdV93b3JrZXIodmNwdV90aHJlYWQsICZkYXRh
KTsKKworCWRpc2FibGVfbXNyX2V2ZW50cyh2bSwgbXNyKTsKKworCW1zcl9kYXRhID0gdmNwdV9n
ZXRfbXNyKHZtLCBWQ1BVX0lELCBtc3IpOworCVRFU1RfQVNTRVJUKG1zcl9kYXRhID09IGV2Lm1z
ci5vbGRfdmFsdWUsCisJCSJGYWlsZWQgdG8gYmxvY2sgTVNSIDB4JXggdXBkYXRlLCB2YWx1ZSAw
eCV4LCBleHBlY3RlZCAweCV4IiwKKwkJbXNyLCBtc3JfZGF0YSwgZXYubXNyLm9sZF92YWx1ZSk7
Cit9CisKIHN0YXRpYyB2b2lkIHRlc3RfaW50cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkK
IHsKIAlzcmFuZG9tKHRpbWUoMCkpOwpAQCAtMTQ2Niw2ICsxNTY3LDcgQEAgc3RhdGljIHZvaWQg
dGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQogCXRlc3RfY21kX3ZjcHVfZ2V0
X3hzYXZlKHZtKTsKIAl0ZXN0X2NtZF92Y3B1X2dldF9tdHJyX3R5cGUodm0pOwogCXRlc3RfZXZl
bnRfZGVzY3JpcHRvcih2bSk7CisJdGVzdF9jbWRfdmNwdV9jb250cm9sX21zcih2bSk7CiAKIAl1
bmhvb2tfaW50cm9zcGVjdGlvbih2bSk7CiB9CmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3Nw
ZWN0aW9uL2t2bWkuYyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCmluZGV4IGRiNzk3
NDRlNWQyZi4uYTg1OGFiYTE2NzJkIDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9u
L2t2bWkuYworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwpAQCAtODIsNiArODIs
NyBAQCBzdGF0aWMgdm9pZCBzZXR1cF9rbm93bl9ldmVudHModm9pZCkKIAlzZXRfYml0KEtWTUlf
RVZFTlRfQ1IsIEt2bWlfa25vd25fdmNwdV9ldmVudHMpOwogCXNldF9iaXQoS1ZNSV9FVkVOVF9E
RVNDUklQVE9SLCBLdm1pX2tub3duX3ZjcHVfZXZlbnRzKTsKIAlzZXRfYml0KEtWTUlfRVZFTlRf
SFlQRVJDQUxMLCBLdm1pX2tub3duX3ZjcHVfZXZlbnRzKTsKKwlzZXRfYml0KEtWTUlfRVZFTlRf
TVNSLCBLdm1pX2tub3duX3ZjcHVfZXZlbnRzKTsKIAlzZXRfYml0KEtWTUlfRVZFTlRfUEFVU0Vf
VkNQVSwgS3ZtaV9rbm93bl92Y3B1X2V2ZW50cyk7CiAJc2V0X2JpdChLVk1JX0VWRU5UX1RSQVAs
IEt2bWlfa25vd25fdmNwdV9ldmVudHMpOwogCXNldF9iaXQoS1ZNSV9FVkVOVF9YU0VUQlYsIEt2
bWlfa25vd25fdmNwdV9ldmVudHMpOwpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlv
bi9rdm1pX2ludC5oIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCmluZGV4IDcy
YzlkM2ExYTRiNi4uYmE0YmRmYWVmMjBkIDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0
aW9uL2t2bWlfaW50LmgKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCkBA
IC0xMDcsNSArMTA3LDcgQEAgaW50IGt2bWlfYXJjaF9jbWRfdmNwdV9nZXRfeHNhdmUoc3RydWN0
IGt2bV92Y3B1ICp2Y3B1LAogCQkJCSBzdHJ1Y3Qga3ZtaV92Y3B1X2dldF94c2F2ZV9yZXBseSAq
KmRlc3QsCiAJCQkJIHNpemVfdCAqZGVzdF9zaXplKTsKIGludCBrdm1pX2FyY2hfY21kX3ZjcHVf
Z2V0X210cnJfdHlwZShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU2NCBncGEsIHU4ICp0eXBlKTsK
K2ludCBrdm1pX2FyY2hfY21kX3ZjcHVfY29udHJvbF9tc3Ioc3RydWN0IGt2bV92Y3B1ICp2Y3B1
LAorCQkJCSAgIGNvbnN0IHN0cnVjdCBrdm1pX3ZjcHVfY29udHJvbF9tc3IgKnJlcSk7CiAKICNl
bmRpZgpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jIGIvdmly
dC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCmluZGV4IDc4YWU1MmYwNWMyOS4uMTkxYjYw
YzI5MGVlIDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKKysr
IGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCkBAIC0zMSw2ICszMSw3IEBAIHN0
YXRpYyBjb25zdCBjaGFyICpjb25zdCBtc2dfSURzW10gPSB7CiAJW0tWTUlfVk1fV1JJVEVfUEhZ
U0lDQUxdICAgICA9ICJLVk1JX1ZNX1dSSVRFX1BIWVNJQ0FMIiwKIAlbS1ZNSV9WQ1BVX0NPTlRS
T0xfQ1JdICAgICAgID0gIktWTUlfVkNQVV9DT05UUk9MX0NSIiwKIAlbS1ZNSV9WQ1BVX0NPTlRS
T0xfRVZFTlRTXSAgID0gIktWTUlfVkNQVV9DT05UUk9MX0VWRU5UUyIsCisJW0tWTUlfVkNQVV9D
T05UUk9MX01TUl0gICAgICA9ICJLVk1JX1ZDUFVfQ09OVFJPTF9NU1IiLAogCVtLVk1JX1ZDUFVf
R0VUX0NQVUlEXSAgICAgICAgPSAiS1ZNSV9WQ1BVX0dFVF9DUFVJRCIsCiAJW0tWTUlfVkNQVV9H
RVRfSU5GT10gICAgICAgICA9ICJLVk1JX1ZDUFVfR0VUX0lORk8iLAogCVtLVk1JX1ZDUFVfR0VU
X01UUlJfVFlQRV0gICAgPSAiS1ZNSV9WQ1BVX0dFVF9NVFJSX1RZUEUiLApAQCAtNTkyLDYgKzU5
MywxNyBAQCBzdGF0aWMgaW50IGhhbmRsZV92Y3B1X2dldF9tdHJyX3R5cGUoY29uc3Qgc3RydWN0
IGt2bWlfdmNwdV9jbWRfam9iICpqb2IsCiAJcmV0dXJuIGt2bWlfbXNnX3ZjcHVfcmVwbHkoam9i
LCBtc2csIGVjLCAmcnBsLCBzaXplb2YocnBsKSk7CiB9CiAKK3N0YXRpYyBpbnQgaGFuZGxlX3Zj
cHVfY29udHJvbF9tc3IoY29uc3Qgc3RydWN0IGt2bWlfdmNwdV9jbWRfam9iICpqb2IsCisJCQkJ
ICAgY29uc3Qgc3RydWN0IGt2bWlfbXNnX2hkciAqbXNnLAorCQkJCSAgIGNvbnN0IHZvaWQgKnJl
cSkKK3sKKwlpbnQgZWM7CisKKwllYyA9IGt2bWlfYXJjaF9jbWRfdmNwdV9jb250cm9sX21zcihq
b2ItPnZjcHUsIHJlcSk7CisKKwlyZXR1cm4ga3ZtaV9tc2dfdmNwdV9yZXBseShqb2IsIG1zZywg
ZWMsIE5VTEwsIDApOworfQorCiAvKgogICogVGhlc2UgY29tbWFuZHMgYXJlIGV4ZWN1dGVkIGZy
b20gdGhlIHZDUFUgdGhyZWFkLiBUaGUgcmVjZWl2aW5nIHRocmVhZAogICogcGFzc2VzIHRoZSBt
ZXNzYWdlcyB1c2luZyBhIG5ld2x5IGFsbG9jYXRlZCAnc3RydWN0IGt2bWlfdmNwdV9jbWRfam9i
JwpAQCAtNjAzLDYgKzYxNSw3IEBAIHN0YXRpYyBpbnQoKmNvbnN0IG1zZ192Y3B1W10pKGNvbnN0
IHN0cnVjdCBrdm1pX3ZjcHVfY21kX2pvYiAqLAogCVtLVk1JX0VWRU5UXSAgICAgICAgICAgICAg
ICAgPSBoYW5kbGVfZXZlbnRfcmVwbHksCiAJW0tWTUlfVkNQVV9DT05UUk9MX0NSXSAgICAgICA9
IGhhbmRsZV92Y3B1X2NvbnRyb2xfY3IsCiAJW0tWTUlfVkNQVV9DT05UUk9MX0VWRU5UU10gICA9
IGhhbmRsZV92Y3B1X2NvbnRyb2xfZXZlbnRzLAorCVtLVk1JX1ZDUFVfQ09OVFJPTF9NU1JdICAg
ICAgPSBoYW5kbGVfdmNwdV9jb250cm9sX21zciwKIAlbS1ZNSV9WQ1BVX0dFVF9DUFVJRF0gICAg
ICAgID0gaGFuZGxlX2dldF9jcHVpZCwKIAlbS1ZNSV9WQ1BVX0dFVF9JTkZPXSAgICAgICAgID0g
aGFuZGxlX2dldF92Y3B1X2luZm8sCiAJW0tWTUlfVkNQVV9HRVRfTVRSUl9UWVBFXSAgICA9IGhh
bmRsZV92Y3B1X2dldF9tdHJyX3R5cGUsCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlv
bkBsaXN0cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlv
bi5vcmcvbWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
