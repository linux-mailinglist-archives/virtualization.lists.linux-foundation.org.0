Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 778AB1978C4
	for <lists.virtualization@lfdr.de>; Mon, 30 Mar 2020 12:20:01 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 0CDED86A63;
	Mon, 30 Mar 2020 10:20:00 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id QVZ1d5fnntNX; Mon, 30 Mar 2020 10:19:56 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id EB0A886A5C;
	Mon, 30 Mar 2020 10:19:54 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id C3919C1D7E;
	Mon, 30 Mar 2020 10:19:54 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id C4A77C07FF
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:51 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by fraxinus.osuosl.org (Postfix) with ESMTP id BEBCF86A11
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:51 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id xzi12MB2-b0n
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:50 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by fraxinus.osuosl.org (Postfix) with ESMTPS id 6C47486A22
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:50 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 CCD76305FFAE; Mon, 30 Mar 2020 13:12:57 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id AFE3B305B7A2;
 Mon, 30 Mar 2020 13:12:57 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v8 56/81] KVM: introspection: add KVMI_VCPU_CONTROL_EVENTS
Date: Mon, 30 Mar 2020 13:12:43 +0300
Message-Id: <20200330101308.21702-57-alazar@bitdefender.com>
In-Reply-To: <20200330101308.21702-1-alazar@bitdefender.com>
References: <20200330101308.21702-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBjb21tYW5k
IGVuYWJsZXMvZGlzYWJsZXMgdkNQVSBpbnRyb3NwZWN0aW9uIGV2ZW50cy4KCkJ5IGRlZmF1bHQs
IGFsbCBldmVudHMgYXJlIGRpc2FibGVkLgoKU2lnbmVkLW9mZi1ieTogTWloYWkgRG9uyJt1IDxt
ZG9udHVAYml0ZGVmZW5kZXIuY29tPgpDby1kZXZlbG9wZWQtYnk6IEFkYWxiZXJ0IExhesSDciA8
YWxhemFyQGJpdGRlZmVuZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogQWRhbGJlcnQgTGF6xINyIDxh
bGF6YXJAYml0ZGVmZW5kZXIuY29tPgotLS0KIERvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5y
c3QgICAgICAgICAgICAgICB8IDUyICsrKysrKysrKysrLQogaW5jbHVkZS9saW51eC9rdm1pX2hv
c3QuaCAgICAgICAgICAgICAgICAgICAgIHwgIDIgKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2bWku
aCAgICAgICAgICAgICAgICAgICAgIHwgMjYgKysrLS0tCiAuLi4vdGVzdGluZy9zZWxmdGVzdHMv
a3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyAgfCA4MSArKysrKysrKysrKysrKysrKysrCiB2aXJ0L2t2
bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyAgICAgICAgICAgICAgICAgfCAxNSArKystCiB2aXJ0L2t2
bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmggICAgICAgICAgICAgfCAgMyArCiB2aXJ0L2t2bS9p
bnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgICAgICAgICAgICAgfCA0OSArKysrKysrKy0tLQogNyBm
aWxlcyBjaGFuZ2VkLCAyMDUgaW5zZXJ0aW9ucygrKSwgMjMgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdCBiL0RvY3VtZW50YXRpb24vdmly
dC9rdm0va3ZtaS5yc3QKaW5kZXggZDg0MWQyNjZiMWE5Li5iMGViMjY0OWIxMGMgMTAwNjQ0Ci0t
LSBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKKysrIGIvRG9jdW1lbnRhdGlvbi92
aXJ0L2t2bS9rdm1pLnJzdApAQCAtMzc1LDYgKzM3NSw5IEBAIHRoZSBmb2xsb3dpbmcgZXZlbnRz
OjoKIAogCUtWTUlfRVZFTlRfVU5IT09LCiAKK1RoZSB2Q1BVIGV2ZW50cyAoZS5nLiAqS1ZNSV9F
VkVOVF9QQVVTRV9WQ1BVKikgYXJlIGNvbnRyb2xsZWQgd2l0aAordGhlICpLVk1JX1ZDUFVfQ09O
VFJPTF9FVkVOVFMqIGNvbW1hbmQuCisKIDpFcnJvcnM6CiAKICogLUtWTV9FSU5WQUwgLSB0aGUg
cGFkZGluZyBpcyBub3QgemVybwpAQCAtNTE3LDEyICs1MjAsNTkgQEAgY29tbWFuZCkgYmVmb3Jl
IHJldHVybmluZyB0byBndWVzdC4KICogLUtWTV9FQlVTWSAgLSB0aGUgc2VsZWN0ZWQgdkNQVSBo
YXMgdG9vIG1hbnkgcXVldWVkICpLVk1JX0VWRU5UX1BBVVNFX1ZDUFUqIGV2ZW50cwogKiAtS1ZN
X0VQRVJNICAtIHRoZSAqS1ZNSV9FVkVOVF9QQVVTRV9WQ1BVKiBldmVudCBpcyBkaXNhbGxvd2Vk
CiAKKzEwLiBLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMKKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0KKworOkFyY2hpdGVjdHVyZXM6IGFsbAorOlZlcnNpb25zOiA+PSAxCis6UGFyYW1ldGVy
czoKKworOjoKKworCXN0cnVjdCBrdm1pX3ZjcHVfaGRyOworCXN0cnVjdCBrdm1pX3ZjcHVfY29u
dHJvbF9ldmVudHMgeworCQlfX3UxNiBldmVudF9pZDsKKwkJX191OCBlbmFibGU7CisJCV9fdTgg
cGFkZGluZzE7CisJCV9fdTMyIHBhZGRpbmcyOworCX07CisKKzpSZXR1cm5zOgorCis6OgorCisJ
c3RydWN0IGt2bWlfZXJyb3JfY29kZQorCitFbmFibGVzL2Rpc2FibGVzIHZDUFUgaW50cm9zcGVj
dGlvbiBldmVudHMuCisKK1doZW4gYW4gZXZlbnQgaXMgZW5hYmxlZCwgdGhlIGludHJvc3BlY3Rp
b24gdG9vbCBpcyBub3RpZmllZCBhbmQKK211c3QgcmVwbHkgd2l0aDogY29udGludWUsIHJldHJ5
LCBjcmFzaCwgZXRjLiAoc2VlICoqRXZlbnRzKiogYmVsb3cpLgorCitUaGUgZm9sbG93aW5nIHZD
UFUgZXZlbnRzIGRvIG5vdCBuZWVkIHRvIGJlIGVuYWJsZWQgb3IgZGlzYWJsZWQsCitiZWNhdXNl
IHRoZXNlIGFyZSBzZW50IGFzIGEgcmVzdWx0IG9mIGNlcnRhaW4gY29tbWFuZHM6OgorCisJS1ZN
SV9FVkVOVF9QQVVTRV9WQ1BVCisKK0hvd2V2ZXIsIHRoZSBldmVudHMgbWVudGlvbmVkIGFib3Zl
IGNhbiBiZSBkaXNhbGxvd2VkLgorCitUaGUgVk0gZXZlbnRzIChlLmcuICpLVk1JX0VWRU5UX1VO
SE9PSyopIGFyZSBjb250cm9sbGVkIHdpdGgKK3RoZSAqS1ZNSV9WTV9DT05UUk9MX0VWRU5UUyog
Y29tbWFuZC4KKworOkVycm9yczoKKworKiAtS1ZNX0VJTlZBTCAtIHRoZSBwYWRkaW5nIGlzIG5v
dCB6ZXJvCisqIC1LVk1fRUlOVkFMIC0gdGhlIHNlbGVjdGVkIHZDUFUgaXMgaW52YWxpZAorKiAt
S1ZNX0VJTlZBTCAtIHRoZSBldmVudCBJRCBpcyB1bmtub3duICh1c2UgKktWTUlfVk1fQ0hFQ0tf
RVZFTlQqIGZpcnN0KQorKiAtS1ZNX0VQRVJNIC0gdGhlIGFjY2VzcyBpcyBkaXNhbGxvd2VkICh1
c2UgKktWTUlfVk1fQ0hFQ0tfRVZFTlQqIGZpcnN0KQorKiAtS1ZNX0VBR0FJTiAtIHRoZSBzZWxl
Y3RlZCB2Q1BVIGNhbid0IGJlIGludHJvc3BlY3RlZCB5ZXQKKwogRXZlbnRzCiA9PT09PT0KIAog
QWxsIGludHJvc3BlY3Rpb24gZXZlbnRzIChWTSBvciB2Q1BVIHJlbGF0ZWQpIGFyZSBzZW50CiB1
c2luZyB0aGUgKktWTUlfRVZFTlQqIG1lc3NhZ2UgaWQuIE5vIGV2ZW50IHdpbGwgYmUgc2VudCB1
bmxlc3MKLWl0IGlzIGV4cGxpY2l0bHkgZW5hYmxlZCBvciByZXF1ZXN0ZWQgKGVnLiAqS1ZNSV9F
VkVOVF9QQVVTRV9WQ1BVKikuCitpdCBpcyBleHBsaWNpdGx5IGVuYWJsZWQgKHNlZSAqS1ZNSV9W
TV9DT05UUk9MX0VWRU5UUyogYW5kICpLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMqKQorb3IgcmVx
dWVzdGVkIChlZy4gKktWTUlfRVZFTlRfUEFVU0VfVkNQVSopLgogCiBUaGUgKktWTUlfRVZFTlRf
VU5IT09LKiBldmVudCBkb2Vzbid0IGhhdmUgYSByZXBseSBhbmQgc2hhcmUgdGhlIGt2bWlfZXZl
bnQKIHN0cnVjdHVyZSwgZm9yIGNvbnNpc3RlbmN5IHdpdGggdGhlIHZDUFUgZXZlbnRzLgpkaWZm
IC0tZ2l0IGEvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaCBiL2luY2x1ZGUvbGludXgva3ZtaV9o
b3N0LmgKaW5kZXggNDllNjg3NzdhMzkwLi44ZThhYjlkODM2ZmUgMTAwNjQ0Ci0tLSBhL2luY2x1
ZGUvbGludXgva3ZtaV9ob3N0LmgKKysrIGIvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaApAQCAt
MzYsNiArMzYsOCBAQCBzdHJ1Y3Qga3ZtX3ZjcHVfaW50cm9zcGVjdGlvbiB7CiAKIAlzdHJ1Y3Qg
a3ZtaV92Y3B1X3JlcGx5IHJlcGx5OwogCWJvb2wgd2FpdGluZ19mb3JfcmVwbHk7CisKKwlERUNM
QVJFX0JJVE1BUChldl9lbmFibGVfbWFzaywgS1ZNSV9OVU1fRVZFTlRTKTsKIH07CiAKIHN0cnVj
dCBrdm1faW50cm9zcGVjdGlvbiB7CmRpZmYgLS1naXQgYS9pbmNsdWRlL3VhcGkvbGludXgva3Zt
aS5oIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaAppbmRleCBlNmE0NjY3NTQ2YjUuLmUzNjFk
NmU2NTYzZCAxMDA2NDQKLS0tIGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaAorKysgYi9pbmNs
dWRlL3VhcGkvbGludXgva3ZtaS5oCkBAIC0xNywxNiArMTcsMTcgQEAgZW51bSB7CiBlbnVtIHsK
IAlLVk1JX0VWRU5UICAgICAgICAgICAgID0gMSwKIAotCUtWTUlfR0VUX1ZFUlNJT04gICAgICAg
PSAyLAotCUtWTUlfVk1fQ0hFQ0tfQ09NTUFORCAgPSAzLAotCUtWTUlfVk1fQ0hFQ0tfRVZFTlQg
ICAgPSA0LAotCUtWTUlfVk1fR0VUX0lORk8gICAgICAgPSA1LAotCUtWTUlfVk1fQ09OVFJPTF9F
VkVOVFMgPSA2LAotCUtWTUlfVk1fUkVBRF9QSFlTSUNBTCAgPSA3LAotCUtWTUlfVk1fV1JJVEVf
UEhZU0lDQUwgPSA4LAorCUtWTUlfR0VUX1ZFUlNJT04gICAgICAgICA9IDIsCisJS1ZNSV9WTV9D
SEVDS19DT01NQU5EICAgID0gMywKKwlLVk1JX1ZNX0NIRUNLX0VWRU5UICAgICAgPSA0LAorCUtW
TUlfVk1fR0VUX0lORk8gICAgICAgICA9IDUsCisJS1ZNSV9WTV9DT05UUk9MX0VWRU5UUyAgID0g
NiwKKwlLVk1JX1ZNX1JFQURfUEhZU0lDQUwgICAgPSA3LAorCUtWTUlfVk1fV1JJVEVfUEhZU0lD
QUwgICA9IDgsCiAKLQlLVk1JX1ZDUFVfR0VUX0lORk8gICAgID0gOSwKLQlLVk1JX1ZDUFVfUEFV
U0UgICAgICAgID0gMTAsCisJS1ZNSV9WQ1BVX0dFVF9JTkZPICAgICAgID0gOSwKKwlLVk1JX1ZD
UFVfUEFVU0UgICAgICAgICAgPSAxMCwKKwlLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMgPSAxMSwK
IAogCUtWTUlfTlVNX01FU1NBR0VTCiB9OwpAQCAtMTIzLDYgKzEyNCwxMyBAQCBzdHJ1Y3Qga3Zt
aV92Y3B1X3BhdXNlIHsKIAlfX3UzMiBwYWRkaW5nMzsKIH07CiAKK3N0cnVjdCBrdm1pX3ZjcHVf
Y29udHJvbF9ldmVudHMgeworCV9fdTE2IGV2ZW50X2lkOworCV9fdTggZW5hYmxlOworCV9fdTgg
cGFkZGluZzE7CisJX191MzIgcGFkZGluZzI7Cit9OworCiBzdHJ1Y3Qga3ZtaV9ldmVudCB7CiAJ
X191MTYgc2l6ZTsKIAlfX3UxNiB2Y3B1OwpkaWZmIC0tZ2l0IGEvdG9vbHMvdGVzdGluZy9zZWxm
dGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2
bS94ODZfNjQva3ZtaV90ZXN0LmMKaW5kZXggOTkwYzc4YTdhZjBhLi45NDM3ODA2NmQ2OWEgMTAw
NjQ0Ci0tLSBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMK
KysrIGIvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYwpAQCAt
OTcsNiArOTcsMTEgQEAgc3RhdGljIHZvaWQgdG9nZ2xlX2V2ZW50X3Blcm1pc3Npb24oc3RydWN0
IGt2bV92bSAqdm0sIF9fczMyIGlkLCBib29sIGFsbG93KQogCQlpZCwgZXJybm8sIHN0cmVycm9y
KGVycm5vKSk7CiB9CiAKK3N0YXRpYyB2b2lkIGRpc2FsbG93X2V2ZW50KHN0cnVjdCBrdm1fdm0g
KnZtLCBfX3MzMiBldmVudF9pZCkKK3sKKwl0b2dnbGVfZXZlbnRfcGVybWlzc2lvbih2bSwgZXZl
bnRfaWQsIGZhbHNlKTsKK30KKwogc3RhdGljIHZvaWQgYWxsb3dfZXZlbnQoc3RydWN0IGt2bV92
bSAqdm0sIF9fczMyIGV2ZW50X2lkKQogewogCXRvZ2dsZV9ldmVudF9wZXJtaXNzaW9uKHZtLCBl
dmVudF9pZCwgdHJ1ZSk7CkBAIC03MjcsNiArNzMyLDgxIEBAIHN0YXRpYyB2b2lkIHRlc3RfcGF1
c2Uoc3RydWN0IGt2bV92bSAqdm0pCiAJc3RvcF92Y3B1X3dvcmtlcih2Y3B1X3RocmVhZCwgJmRh
dGEpOwogfQogCitzdGF0aWMgaW50IGNtZF92Y3B1X2NvbnRyb2xfZXZlbnQoc3RydWN0IGt2bV92
bSAqdm0sIF9fdTE2IGV2ZW50X2lkLAorCQkJCSAgYm9vbCBlbmFibGUpCit7CisJc3RydWN0IHsK
KwkJc3RydWN0IGt2bWlfbXNnX2hkciBoZHI7CisJCXN0cnVjdCBrdm1pX3ZjcHVfaGRyIHZjcHVf
aGRyOworCQlzdHJ1Y3Qga3ZtaV92Y3B1X2NvbnRyb2xfZXZlbnRzIGNtZDsKKwl9IHJlcSA9IHt9
OworCisJcmVxLmNtZC5ldmVudF9pZCA9IGV2ZW50X2lkOworCXJlcS5jbWQuZW5hYmxlID0gZW5h
YmxlID8gMSA6IDA7CisKKwlyZXR1cm4gZG9fdmNwdTBfY29tbWFuZCh2bSwgS1ZNSV9WQ1BVX0NP
TlRST0xfRVZFTlRTLAorCQkJCSZyZXEuaGRyLCBzaXplb2YocmVxKSwgTlVMTCwgMCk7Cit9CisK
K3N0YXRpYyB2b2lkIGVuYWJsZV92Y3B1X2V2ZW50KHN0cnVjdCBrdm1fdm0gKnZtLCBfX3UxNiBl
dmVudF9pZCkKK3sKKwlpbnQgcjsKKworCXIgPSBjbWRfdmNwdV9jb250cm9sX2V2ZW50KHZtLCBl
dmVudF9pZCwgdHJ1ZSk7CisJVEVTVF9BU1NFUlQociA9PSAwLAorCQkiS1ZNSV9WQ1BVX0NPTlRS
T0xfRVZFTlRTIGZhaWxlZCB0byBlbmFibGUgdkNQVSBldmVudCAlZCwgZXJyb3IgJWQoJXMpXG4i
LAorCQlldmVudF9pZCwgLXIsIGt2bV9zdHJlcnJvcigtcikpOworfQorCitzdGF0aWMgdm9pZCBk
aXNhYmxlX3ZjcHVfZXZlbnQoc3RydWN0IGt2bV92bSAqdm0sIF9fdTE2IGV2ZW50X2lkKQorewor
CWludCByOworCisJciA9IGNtZF92Y3B1X2NvbnRyb2xfZXZlbnQodm0sIGV2ZW50X2lkLCBmYWxz
ZSk7CisJVEVTVF9BU1NFUlQociA9PSAwLAorCQkiS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTIGZh
aWxlZCB0byBkaXNhYmxlIHZDUFUgZXZlbnQgJWQsIGVycm9yICVkKCVzKVxuIiwKKwkJZXZlbnRf
aWQsIC1yLCBrdm1fc3RyZXJyb3IoLXIpKTsKK30KKworc3RhdGljIHZvaWQgdGVzdF9kaXNhbGxv
d2VkX3ZjcHVfZXZlbnQoc3RydWN0IGt2bV92bSAqdm0sIF9fdTE2IGV2ZW50X2lkKQoreworCWJv
b2wgZW5hYmxlID0gdHJ1ZTsKKwlpbnQgcjsKKworCWRpc2FsbG93X2V2ZW50KHZtLCBldmVudF9p
ZCk7CisKKwlyID0gY21kX3ZjcHVfY29udHJvbF9ldmVudCh2bSwgZXZlbnRfaWQsIGVuYWJsZSk7
CisJVEVTVF9BU1NFUlQociA9PSAtS1ZNX0VQRVJNLAorCQkiS1ZNSV9WQ1BVX0NPTlRST0xfRVZF
TlRTIGRpZG4ndCBmYWlsZWQgd2l0aCBLVk1fRVBFUk0sIGlkICVkLCBlcnJvciAlZCAoJXMpXG4i
LAorCQlldmVudF9pZCwgLXIsIGt2bV9zdHJlcnJvcigtcikpOworCisJYWxsb3dfZXZlbnQodm0s
IGV2ZW50X2lkKTsKK30KKworc3RhdGljIHZvaWQgdGVzdF9pbnZhbGlkX3ZjcHVfZXZlbnQoc3Ry
dWN0IGt2bV92bSAqdm0sIF9fdTE2IGV2ZW50X2lkKQoreworCWJvb2wgZW5hYmxlID0gdHJ1ZTsK
KwlpbnQgcjsKKworCXIgPSBjbWRfdmNwdV9jb250cm9sX2V2ZW50KHZtLCBldmVudF9pZCwgZW5h
YmxlKTsKKwlURVNUX0FTU0VSVChyID09IC1LVk1fRUlOVkFMLAorCQkiY21kX3ZjcHVfY29udHJv
bF9ldmVudCBkaWRuJ3QgZmFpbGVkIHdpdGggS1ZNX0VJTlZBTCwgaWQgJWQsIGVycm9yICVkICgl
cylcbiIsCisJCWV2ZW50X2lkLCAtciwga3ZtX3N0cmVycm9yKC1yKSk7Cit9CisKK3N0YXRpYyB2
b2lkIHRlc3RfY21kX3ZjcHVfY29udHJvbF9ldmVudHMoc3RydWN0IGt2bV92bSAqdm0pCit7CisJ
X191MTYgdmFsaWRfaWQgPSBLVk1JX0VWRU5UX1BBVVNFX1ZDUFU7CisJX191MTYgaW52YWxpZF9p
ZCA9IDB4ZmZmZjsKKworCWVuYWJsZV92Y3B1X2V2ZW50KHZtLCB2YWxpZF9pZCk7CisJZGlzYWJs
ZV92Y3B1X2V2ZW50KHZtLCB2YWxpZF9pZCk7CisKKwl0ZXN0X2Rpc2FsbG93ZWRfdmNwdV9ldmVu
dCh2bSwgdmFsaWRfaWQpOworCisJdGVzdF9pbnZhbGlkX3ZjcHVfZXZlbnQodm0sIGludmFsaWRf
aWQpOworfQorCiBzdGF0aWMgdm9pZCB0ZXN0X2ludHJvc3BlY3Rpb24oc3RydWN0IGt2bV92bSAq
dm0pCiB7CiAJc3JhbmRvbSh0aW1lKDApKTsKQEAgLTc0Myw2ICs4MjMsNyBAQCBzdGF0aWMgdm9p
ZCB0ZXN0X2ludHJvc3BlY3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCiAJdGVzdF9tZW1vcnlfYWNj
ZXNzKHZtKTsKIAl0ZXN0X2NtZF9nZXRfdmNwdV9pbmZvKHZtKTsKIAl0ZXN0X3BhdXNlKHZtKTsK
Kwl0ZXN0X2NtZF92Y3B1X2NvbnRyb2xfZXZlbnRzKHZtKTsKIAogCXVuaG9va19pbnRyb3NwZWN0
aW9uKHZtKTsKIH0KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jIGIv
dmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKaW5kZXggNTE3ZTc3YWIzOWMyLi5iNmIzZWZk
MDg1YzQgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCisrKyBiL3Zp
cnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCkBAIC0xNiw3ICsxNiw3IEBACiBzdGF0aWMgREVD
TEFSRV9CSVRNQVAoS3ZtaV9hbHdheXNfYWxsb3dlZF9jb21tYW5kcywgS1ZNSV9OVU1fQ09NTUFO
RFMpOwogREVDTEFSRV9CSVRNQVAoS3ZtaV9rbm93bl9ldmVudHMsIEtWTUlfTlVNX0VWRU5UUyk7
CiBERUNMQVJFX0JJVE1BUChLdm1pX2tub3duX3ZtX2V2ZW50cywgS1ZNSV9OVU1fRVZFTlRTKTsK
LXN0YXRpYyBERUNMQVJFX0JJVE1BUChLdm1pX2tub3duX3ZjcHVfZXZlbnRzLCBLVk1JX05VTV9F
VkVOVFMpOworREVDTEFSRV9CSVRNQVAoS3ZtaV9rbm93bl92Y3B1X2V2ZW50cywgS1ZNSV9OVU1f
RVZFTlRTKTsKIAogc3RhdGljIHN0cnVjdCBrbWVtX2NhY2hlICptc2dfY2FjaGU7CiBzdGF0aWMg
c3RydWN0IGttZW1fY2FjaGUgKmpvYl9jYWNoZTsKQEAgLTU3Niw2ICs1NzYsMTkgQEAgaW50IGt2
bWlfY21kX3ZtX2NvbnRyb2xfZXZlbnRzKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSwK
IAlyZXR1cm4gMDsKIH0KIAoraW50IGt2bWlfY21kX3ZjcHVfY29udHJvbF9ldmVudHMoc3RydWN0
IGt2bV92Y3B1ICp2Y3B1LAorCQkJCSB1bnNpZ25lZCBpbnQgZXZlbnRfaWQsIGJvb2wgZW5hYmxl
KQoreworCXN0cnVjdCBrdm1fdmNwdV9pbnRyb3NwZWN0aW9uICp2Y3B1aSA9IFZDUFVJKHZjcHUp
OworCisJaWYgKGVuYWJsZSkKKwkJc2V0X2JpdChldmVudF9pZCwgdmNwdWktPmV2X2VuYWJsZV9t
YXNrKTsKKwllbHNlCisJCWNsZWFyX2JpdChldmVudF9pZCwgdmNwdWktPmV2X2VuYWJsZV9tYXNr
KTsKKworCXJldHVybiAwOworfQorCiBzdGF0aWMgdW5zaWduZWQgbG9uZyBnZm5fdG9faHZhX3Nh
ZmUoc3RydWN0IGt2bSAqa3ZtLCBnZm5fdCBnZm4pCiB7CiAJdW5zaWduZWQgbG9uZyBodmE7CmRp
ZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmggYi92aXJ0L2t2bS9p
bnRyb3NwZWN0aW9uL2t2bWlfaW50LmgKaW5kZXggOGZlNzRiMzJhNWY2Li5lOTQzNTY1MTZhMDUg
MTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaAorKysgYi92aXJ0
L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmgKQEAgLTE4LDYgKzE4LDcgQEAKIAogZXh0ZXJu
IERFQ0xBUkVfQklUTUFQKEt2bWlfa25vd25fZXZlbnRzLCBLVk1JX05VTV9FVkVOVFMpOwogZXh0
ZXJuIERFQ0xBUkVfQklUTUFQKEt2bWlfa25vd25fdm1fZXZlbnRzLCBLVk1JX05VTV9FVkVOVFMp
OworZXh0ZXJuIERFQ0xBUkVfQklUTUFQKEt2bWlfa25vd25fdmNwdV9ldmVudHMsIEtWTUlfTlVN
X0VWRU5UUyk7CiAKICNkZWZpbmUgS1ZNSShrdm0pICgoa3ZtKS0+a3ZtaSkKICNkZWZpbmUgVkNQ
VUkodmNwdSkgKCh2Y3B1KS0+a3ZtaSkKQEAgLTM5LDYgKzQwLDggQEAgaW50IGt2bWlfYWRkX2pv
YihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCiB2b2lkIGt2bWlfcnVuX2pvYnMoc3RydWN0IGt2bV92
Y3B1ICp2Y3B1KTsKIGludCBrdm1pX2NtZF92bV9jb250cm9sX2V2ZW50cyhzdHJ1Y3Qga3ZtX2lu
dHJvc3BlY3Rpb24gKmt2bWksCiAJCQkJdW5zaWduZWQgaW50IGV2ZW50X2lkLCBib29sIGVuYWJs
ZSk7CitpbnQga3ZtaV9jbWRfdmNwdV9jb250cm9sX2V2ZW50cyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZj
cHUsCisJCQkJIHVuc2lnbmVkIGludCBldmVudF9pZCwgYm9vbCBlbmFibGUpOwogaW50IGt2bWlf
Y21kX3JlYWRfcGh5c2ljYWwoc3RydWN0IGt2bSAqa3ZtLCB1NjQgZ3BhLCBzaXplX3Qgc2l6ZSwK
IAkJCSAgIGludCAoKnNlbmQpKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqLAogCQkJCQljb25z
dCBzdHJ1Y3Qga3ZtaV9tc2dfaGRyKiwKZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rp
b24va3ZtaV9tc2cuYyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYwppbmRleCBh
NTY5MjZmMjJiYzYuLmY4MTlkMGE5NDJkYyAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVj
dGlvbi9rdm1pX21zZy5jCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYwpA
QCAtMjAsMTYgKzIwLDE3IEBAIHN0cnVjdCBrdm1pX3ZjcHVfY21kX2pvYiB7CiB9OwogCiBzdGF0
aWMgY29uc3QgY2hhciAqY29uc3QgbXNnX0lEc1tdID0gewotCVtLVk1JX0VWRU5UXSAgICAgICAg
ICAgICA9ICJLVk1JX0VWRU5UIiwKLQlbS1ZNSV9HRVRfVkVSU0lPTl0gICAgICAgPSAiS1ZNSV9H
RVRfVkVSU0lPTiIsCi0JW0tWTUlfVk1fQ0hFQ0tfQ09NTUFORF0gID0gIktWTUlfVk1fQ0hFQ0tf
Q09NTUFORCIsCi0JW0tWTUlfVk1fQ0hFQ0tfRVZFTlRdICAgID0gIktWTUlfVk1fQ0hFQ0tfRVZF
TlQiLAotCVtLVk1JX1ZNX0NPTlRST0xfRVZFTlRTXSA9ICJLVk1JX1ZNX0NPTlRST0xfRVZFTlRT
IiwKLQlbS1ZNSV9WTV9HRVRfSU5GT10gICAgICAgPSAiS1ZNSV9WTV9HRVRfSU5GTyIsCi0JW0tW
TUlfVk1fUkVBRF9QSFlTSUNBTF0gID0gIktWTUlfVk1fUkVBRF9QSFlTSUNBTCIsCi0JW0tWTUlf
Vk1fV1JJVEVfUEhZU0lDQUxdID0gIktWTUlfVk1fV1JJVEVfUEhZU0lDQUwiLAotCVtLVk1JX1ZD
UFVfR0VUX0lORk9dICAgICA9ICJLVk1JX1ZDUFVfR0VUX0lORk8iLAotCVtLVk1JX1ZDUFVfUEFV
U0VdICAgICAgICA9ICJLVk1JX1ZDUFVfUEFVU0UiLAorCVtLVk1JX0VWRU5UXSAgICAgICAgICAg
ICAgID0gIktWTUlfRVZFTlQiLAorCVtLVk1JX0dFVF9WRVJTSU9OXSAgICAgICAgID0gIktWTUlf
R0VUX1ZFUlNJT04iLAorCVtLVk1JX1ZNX0NIRUNLX0NPTU1BTkRdICAgID0gIktWTUlfVk1fQ0hF
Q0tfQ09NTUFORCIsCisJW0tWTUlfVk1fQ0hFQ0tfRVZFTlRdICAgICAgPSAiS1ZNSV9WTV9DSEVD
S19FVkVOVCIsCisJW0tWTUlfVk1fQ09OVFJPTF9FVkVOVFNdICAgPSAiS1ZNSV9WTV9DT05UUk9M
X0VWRU5UUyIsCisJW0tWTUlfVk1fR0VUX0lORk9dICAgICAgICAgPSAiS1ZNSV9WTV9HRVRfSU5G
TyIsCisJW0tWTUlfVk1fUkVBRF9QSFlTSUNBTF0gICAgPSAiS1ZNSV9WTV9SRUFEX1BIWVNJQ0FM
IiwKKwlbS1ZNSV9WTV9XUklURV9QSFlTSUNBTF0gICA9ICJLVk1JX1ZNX1dSSVRFX1BIWVNJQ0FM
IiwKKwlbS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTXSA9ICJLVk1JX1ZDUFVfQ09OVFJPTF9FVkVO
VFMiLAorCVtLVk1JX1ZDUFVfR0VUX0lORk9dICAgICAgID0gIktWTUlfVkNQVV9HRVRfSU5GTyIs
CisJW0tWTUlfVkNQVV9QQVVTRV0gICAgICAgICAgPSAiS1ZNSV9WQ1BVX1BBVVNFIiwKIH07CiAK
IHN0YXRpYyBjb25zdCBjaGFyICppZDJzdHIodTE2IGlkKQpAQCAtNDQyLDYgKzQ0MywyOSBAQCBz
dGF0aWMgaW50IGhhbmRsZV9ldmVudF9yZXBseShjb25zdCBzdHJ1Y3Qga3ZtaV92Y3B1X2NtZF9q
b2IgKmpvYiwKIAlyZXR1cm4gZXhwZWN0ZWQtPmVycm9yOwogfQogCitzdGF0aWMgaW50IGhhbmRs
ZV92Y3B1X2NvbnRyb2xfZXZlbnRzKGNvbnN0IHN0cnVjdCBrdm1pX3ZjcHVfY21kX2pvYiAqam9i
LAorCQkJCSAgICAgIGNvbnN0IHN0cnVjdCBrdm1pX21zZ19oZHIgKm1zZywKKwkJCQkgICAgICBj
b25zdCB2b2lkICpfcmVxKQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSA9IEtW
TUkoam9iLT52Y3B1LT5rdm0pOworCWNvbnN0IHN0cnVjdCBrdm1pX3ZjcHVfY29udHJvbF9ldmVu
dHMgKnJlcSA9IF9yZXE7CisJaW50IGVjOworCisJaWYgKHJlcS0+cGFkZGluZzEgfHwgcmVxLT5w
YWRkaW5nMiB8fCByZXEtPmVuYWJsZSA+IDEpCisJCWVjID0gLUtWTV9FSU5WQUw7CisJZWxzZSBp
ZiAocmVxLT5ldmVudF9pZCA+PSBLVk1JX05VTV9FVkVOVFMpCisJCWVjID0gLUtWTV9FSU5WQUw7
CisJZWxzZSBpZiAoIXRlc3RfYml0KHJlcS0+ZXZlbnRfaWQsIEt2bWlfa25vd25fdmNwdV9ldmVu
dHMpKQorCQllYyA9IC1LVk1fRUlOVkFMOworCWVsc2UgaWYgKCFpc19ldmVudF9hbGxvd2VkKGt2
bWksIHJlcS0+ZXZlbnRfaWQpKQorCQllYyA9IC1LVk1fRVBFUk07CisJZWxzZQorCQllYyA9IGt2
bWlfY21kX3ZjcHVfY29udHJvbF9ldmVudHMoam9iLT52Y3B1LCByZXEtPmV2ZW50X2lkLAorCQkJ
CQkJICByZXEtPmVuYWJsZSA9PSAxKTsKKworCXJldHVybiBrdm1pX21zZ192Y3B1X3JlcGx5KGpv
YiwgbXNnLCBlYywgTlVMTCwgMCk7Cit9CisKIC8qCiAgKiBUaGVzZSBjb21tYW5kcyBhcmUgZXhl
Y3V0ZWQgZnJvbSB0aGUgdkNQVSB0aHJlYWQuIFRoZSByZWNlaXZpbmcgdGhyZWFkCiAgKiBwYXNz
ZXMgdGhlIG1lc3NhZ2VzIHVzaW5nIGEgbmV3bHkgYWxsb2NhdGVkICdzdHJ1Y3Qga3ZtaV92Y3B1
X2NtZF9qb2InCkBAIC00NTAsOCArNDc0LDkgQEAgc3RhdGljIGludCBoYW5kbGVfZXZlbnRfcmVw
bHkoY29uc3Qgc3RydWN0IGt2bWlfdmNwdV9jbWRfam9iICpqb2IsCiAgKi8KIHN0YXRpYyBpbnQo
KmNvbnN0IG1zZ192Y3B1W10pKGNvbnN0IHN0cnVjdCBrdm1pX3ZjcHVfY21kX2pvYiAqLAogCQkJ
ICAgICAgY29uc3Qgc3RydWN0IGt2bWlfbXNnX2hkciAqLCBjb25zdCB2b2lkICopID0gewotCVtL
Vk1JX0VWRU5UXSAgICAgICAgID0gaGFuZGxlX2V2ZW50X3JlcGx5LAotCVtLVk1JX1ZDUFVfR0VU
X0lORk9dID0gaGFuZGxlX2dldF92Y3B1X2luZm8sCisJW0tWTUlfRVZFTlRdICAgICAgICAgICAg
ICAgPSBoYW5kbGVfZXZlbnRfcmVwbHksCisJW0tWTUlfVkNQVV9DT05UUk9MX0VWRU5UU10gPSBo
YW5kbGVfdmNwdV9jb250cm9sX2V2ZW50cywKKwlbS1ZNSV9WQ1BVX0dFVF9JTkZPXSAgICAgICA9
IGhhbmRsZV9nZXRfdmNwdV9pbmZvLAogfTsKIAogc3RhdGljIGJvb2wgaXNfdmNwdV9jb21tYW5k
KHUxNiBpZCkKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
VmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZv
dW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL3ZpcnR1YWxpemF0aW9u
