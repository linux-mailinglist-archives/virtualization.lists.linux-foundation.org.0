Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id CD9BB2C3C5D
	for <lists.virtualization@lfdr.de>; Wed, 25 Nov 2020 10:42:19 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 811D886A90;
	Wed, 25 Nov 2020 09:42:18 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id ajnmjoELSUp4; Wed, 25 Nov 2020 09:42:17 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 85DE686A27;
	Wed, 25 Nov 2020 09:42:16 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 5DB1FC0052;
	Wed, 25 Nov 2020 09:42:16 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 5F139C1D9F
 for <virtualization@lists.linux-foundation.org>;
 Wed, 25 Nov 2020 09:42:06 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by whitealder.osuosl.org (Postfix) with ESMTP id 5646F86D8B
 for <virtualization@lists.linux-foundation.org>;
 Wed, 25 Nov 2020 09:42:06 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id XIbvTqDwlEpb
 for <virtualization@lists.linux-foundation.org>;
 Wed, 25 Nov 2020 09:41:58 +0000 (UTC)
X-Greylist: from auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by whitealder.osuosl.org (Postfix) with ESMTPS id A447886D76
 for <virtualization@lists.linux-foundation.org>;
 Wed, 25 Nov 2020 09:41:55 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 C3453305D498; Wed, 25 Nov 2020 11:35:50 +0200 (EET)
Received: from localhost.localdomain (unknown [91.199.104.27])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 9E5283072785;
 Wed, 25 Nov 2020 11:35:50 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v10 49/81] KVM: introspection: add support for vCPU events
Date: Wed, 25 Nov 2020 11:35:28 +0200
Message-Id: <20201125093600.2766-50-alazar@bitdefender.com>
In-Reply-To: <20201125093600.2766-1-alazar@bitdefender.com>
References: <20201125093600.2766-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>, virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

VGhpcyBpcyB0aGUgY29tbW9uIGNvZGUgdXNlZCBieSB2Q1BVIHRocmVhZHMgdG8gc2VuZCBldmVu
dHMgYW5kIHdhaXQgZm9yCnJlcGxpZXMgKHJlY2VpdmVkIGFuZCBkaXNwYXRjaGVkIGJ5IHRoZSBy
ZWNlaXZpbmcgdGhyZWFkKS4gV2hpbGUgd2FpdGluZwpmb3IgYW4gZXZlbnQgcmVwbHksIHRoZSB2
Q1BVIHRocmVhZCB3aWxsIGhhbmRsZSBhbnkgaW50cm9zcGVjdGlvbiBjb21tYW5kCmFscmVhZHkg
cXVldWVkIG9yIHJlY2VpdmVkIGR1cmluZyB0aGlzIHBlcmlvZC4KClNpZ25lZC1vZmYtYnk6IEFk
YWxiZXJ0IExhesSDciA8YWxhemFyQGJpdGRlZmVuZGVyLmNvbT4KLS0tCiBEb2N1bWVudGF0aW9u
L3ZpcnQva3ZtL2t2bWkucnN0ICAgfCAgNTYgKysrKysrKysrKy0KIGFyY2gveDg2L2luY2x1ZGUv
dWFwaS9hc20va3ZtaS5oICB8ICAyMCArKysrCiBhcmNoL3g4Ni9rdm0va3ZtaS5jICAgICAgICAg
ICAgICAgfCAgODUgKysrKysrKysrKysrKysrKwogaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaCAg
ICAgICAgIHwgIDExICsrKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCAgICAgICAgIHwgIDIz
ICsrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyAgICAgfCAgIDEgKwogdmlydC9r
dm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oIHwgICA2ICsrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0
aW9uL2t2bWlfbXNnLmMgfCAxNTYgKysrKysrKysrKysrKysrKysrKysrKysrKysrKystCiA4IGZp
bGVzIGNoYW5nZWQsIDM1NCBpbnNlcnRpb25zKCspLCA0IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdp
dCBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QgYi9Eb2N1bWVudGF0aW9uL3ZpcnQv
a3ZtL2t2bWkucnN0CmluZGV4IGE3MWZiNzhkNTQ2ZS4uNWU5OWJhZjdlMmYzIDEwMDY0NAotLS0g
YS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CisrKyBiL0RvY3VtZW50YXRpb24vdmly
dC9rdm0va3ZtaS5yc3QKQEAgLTUyMSw3ICs1MjEsNjEgQEAgVGhlIG1lc3NhZ2UgZGF0YSBiZWdp
bnMgd2l0aCBhIGNvbW1vbiBzdHJ1Y3R1cmUgaGF2aW5nIHRoZSBldmVudCBpZDo6CiAJCV9fdTE2
IHBhZGRpbmdbM107CiAJfTsKIAotU3BlY2lmaWMgZXZlbnQgZGF0YSBjYW4gZm9sbG93IHRoaXMg
Y29tbW9uIHN0cnVjdHVyZS4KK1RoZSB2Q1BVIGludHJvc3BlY3Rpb24gZXZlbnRzIGFyZSBzZW50
IHVzaW5nIHRoZSBLVk1JX1ZDUFVfRVZFTlQgbWVzc2FnZSBpZC4KK05vIGV2ZW50IGlzIHNlbnQg
dW5sZXNzIGl0IGlzIGV4cGxpY2l0bHkgZW5hYmxlZCBvciByZXF1ZXN0ZWQKKyhlLmcuICpLVk1J
X1ZDUFVfRVZFTlRfUEFVU0UqKS4KK0EgdkNQVSBldmVudCBiZWdpbnMgd2l0aCBhIGNvbW1vbiBz
dHJ1Y3R1cmUgaGF2aW5nIHRoZSBzaXplIG9mIHRoZQorc3RydWN0dXJlIGFuZCB0aGUgdkNQVSBp
bmRleDo6CisKKwlzdHJ1Y3Qga3ZtaV92Y3B1X2V2ZW50IHsKKwkJX191MTYgc2l6ZTsKKwkJX191
MTYgdmNwdTsKKwkJX191MzIgcGFkZGluZzsKKwkJc3RydWN0IGt2bWlfdmNwdV9ldmVudF9hcmNo
IGFyY2g7CisJfTsKKworT24geDg2OjoKKworCXN0cnVjdCBrdm1pX3ZjcHVfZXZlbnRfYXJjaCB7
CisJCV9fdTggbW9kZTsKKwkJX191OCBwYWRkaW5nWzddOworCQlzdHJ1Y3Qga3ZtX3JlZ3MgcmVn
czsKKwkJc3RydWN0IGt2bV9zcmVncyBzcmVnczsKKwkJc3RydWN0IHsKKwkJCV9fdTY0IHN5c2Vu
dGVyX2NzOworCQkJX191NjQgc3lzZW50ZXJfZXNwOworCQkJX191NjQgc3lzZW50ZXJfZWlwOwor
CQkJX191NjQgZWZlcjsKKwkJCV9fdTY0IHN0YXI7CisJCQlfX3U2NCBsc3RhcjsKKwkJCV9fdTY0
IGNzdGFyOworCQkJX191NjQgcGF0OworCQkJX191NjQgc2hhZG93X2dzOworCQl9IG1zcnM7CisJ
fTsKKworSXQgY29udGFpbnMgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHZDUFUgc3RhdGUgYXQgdGhl
IHRpbWUgb2YgdGhlIGV2ZW50LgorCitBIHZDUFUgZXZlbnQgcmVwbHkgYmVnaW5zIHdpdGggdHdv
IGNvbW1vbiBzdHJ1Y3R1cmVzOjoKKworCXN0cnVjdCBrdm1pX3ZjcHVfaGRyOworCXN0cnVjdCBr
dm1pX3ZjcHVfZXZlbnRfcmVwbHkgeworCQlfX3U4IGFjdGlvbjsKKwkJX191OCBldmVudDsKKwkJ
X191MTYgcGFkZGluZzE7CisJCV9fdTMyIHBhZGRpbmcyOworCX07CisKK0FsbCBldmVudHMgYWNj
ZXB0IHRoZSBLVk1JX0VWRU5UX0FDVElPTl9DUkFTSCBhY3Rpb24sIHdoaWNoIHN0b3BzIHRoZQor
Z3Vlc3QgdW5ncmFjZWZ1bGx5LCBidXQgYXMgc29vbiBhcyBwb3NzaWJsZS4KKworTW9zdCBldmVu
dHMgYWNjZXB0IHRoZSBLVk1JX0VWRU5UX0FDVElPTl9DT05USU5VRSBhY3Rpb24sIHdoaWNoCitt
ZWFucyB0aGF0IEtWTSB3aWxsIGNvbnRpbnVlIGhhbmRsaW5nIHRoZSBldmVudC4KKworU29tZSBl
dmVudHMgYWNjZXB0IHRoZSBLVk1JX0VWRU5UX0FDVElPTl9SRVRSWSBhY3Rpb24sIHdoaWNoIG1l
YW5zIHRoYXQKK0tWTSB3aWxsIHN0b3AgaGFuZGxpbmcgdGhlIGV2ZW50IGFuZCByZS1lbnRlciBp
biBndWVzdC4KKworU3BlY2lmaWMgZXZlbnQgZGF0YSBjYW4gZm9sbG93IHRoZXNlIGNvbW1vbiBz
dHJ1Y3R1cmVzLgogCiAxLiBLVk1JX1ZNX0VWRU5UX1VOSE9PSwogLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0KZGlmZiAtLWdpdCBhL2FyY2gveDg2L2luY2x1ZGUvdWFwaS9hc20va3ZtaS5oIGIvYXJj
aC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmgKaW5kZXggMmI2MTkyZTFhOWE0Li45ZDlkZjA5
ZDM4MWEgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2luY2x1ZGUvdWFwaS9hc20va3ZtaS5oCisrKyBi
L2FyY2gveDg2L2luY2x1ZGUvdWFwaS9hc20va3ZtaS5oCkBAIC02LDggKzYsMjggQEAKICAqIEtW
TSBpbnRyb3NwZWN0aW9uIC0geDg2IHNwZWNpZmljIHN0cnVjdHVyZXMgYW5kIGRlZmluaXRpb25z
CiAgKi8KIAorI2luY2x1ZGUgPGFzbS9rdm0uaD4KKwogc3RydWN0IGt2bWlfdmNwdV9nZXRfaW5m
b19yZXBseSB7CiAJX191NjQgdHNjX3NwZWVkOwogfTsKIAorc3RydWN0IGt2bWlfdmNwdV9ldmVu
dF9hcmNoIHsKKwlfX3U4IG1vZGU7CQkvKiAyLCA0IG9yIDggKi8KKwlfX3U4IHBhZGRpbmdbN107
CisJc3RydWN0IGt2bV9yZWdzIHJlZ3M7CisJc3RydWN0IGt2bV9zcmVncyBzcmVnczsKKwlzdHJ1
Y3QgeworCQlfX3U2NCBzeXNlbnRlcl9jczsKKwkJX191NjQgc3lzZW50ZXJfZXNwOworCQlfX3U2
NCBzeXNlbnRlcl9laXA7CisJCV9fdTY0IGVmZXI7CisJCV9fdTY0IHN0YXI7CisJCV9fdTY0IGxz
dGFyOworCQlfX3U2NCBjc3RhcjsKKwkJX191NjQgcGF0OworCQlfX3U2NCBzaGFkb3dfZ3M7CisJ
fSBtc3JzOworfTsKKwogI2VuZGlmIC8qIF9VQVBJX0FTTV9YODZfS1ZNSV9IICovCmRpZmYgLS1n
aXQgYS9hcmNoL3g4Ni9rdm0va3ZtaS5jIGIvYXJjaC94ODYva3ZtL2t2bWkuYwppbmRleCAzNTc0
MmQ5MjdiZTUuLjM4M2IxOWRjZjA1NCAxMDA2NDQKLS0tIGEvYXJjaC94ODYva3ZtL2t2bWkuYwor
KysgYi9hcmNoL3g4Ni9rdm0va3ZtaS5jCkBAIC01LDYgKzUsOTEgQEAKICAqIENvcHlyaWdodCAo
QykgMjAxOS0yMDIwIEJpdGRlZmVuZGVyIFMuUi5MLgogICovCiAKKyNpbmNsdWRlICJsaW51eC9r
dm1faG9zdC5oIgorI2luY2x1ZGUgIng4Ni5oIgorI2luY2x1ZGUgIi4uLy4uLy4uL3ZpcnQva3Zt
L2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCIKKwogdm9pZCBrdm1pX2FyY2hfaW5pdF92Y3B1X2V2
ZW50c19tYXNrKHVuc2lnbmVkIGxvbmcgKnN1cHBvcnRlZCkKIHsKIH0KKworc3RhdGljIHVuc2ln
bmVkIGludCBrdm1pX3ZjcHVfbW9kZShjb25zdCBzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCisJCQkJ
ICAgY29uc3Qgc3RydWN0IGt2bV9zcmVncyAqc3JlZ3MpCit7CisJdW5zaWduZWQgaW50IG1vZGUg
PSAwOworCisJaWYgKGlzX2xvbmdfbW9kZSgoc3RydWN0IGt2bV92Y3B1ICopIHZjcHUpKSB7CisJ
CWlmIChzcmVncy0+Y3MubCkKKwkJCW1vZGUgPSA4OworCQllbHNlIGlmICghc3JlZ3MtPmNzLmRi
KQorCQkJbW9kZSA9IDI7CisJCWVsc2UKKwkJCW1vZGUgPSA0OworCX0gZWxzZSBpZiAoc3JlZ3Mt
PmNyMCAmIFg4Nl9DUjBfUEUpIHsKKwkJaWYgKCFzcmVncy0+Y3MuZGIpCisJCQltb2RlID0gMjsK
KwkJZWxzZQorCQkJbW9kZSA9IDQ7CisJfSBlbHNlIGlmICghc3JlZ3MtPmNzLmRiKSB7CisJCW1v
ZGUgPSAyOworCX0gZWxzZSB7CisJCW1vZGUgPSA0OworCX0KKworCXJldHVybiBtb2RlOworfQor
CitzdGF0aWMgdm9pZCBrdm1pX2dldF9tc3JzKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKKwkJCSAg
c3RydWN0IGt2bWlfdmNwdV9ldmVudF9hcmNoICpldmVudCkKK3sKKwlzdHJ1Y3QgbXNyX2RhdGEg
bXNyOworCisJbXNyLmhvc3RfaW5pdGlhdGVkID0gdHJ1ZTsKKworCW1zci5pbmRleCA9IE1TUl9J
QTMyX1NZU0VOVEVSX0NTOworCWt2bV94ODZfb3BzLmdldF9tc3IodmNwdSwgJm1zcik7CisJZXZl
bnQtPm1zcnMuc3lzZW50ZXJfY3MgPSBtc3IuZGF0YTsKKworCW1zci5pbmRleCA9IE1TUl9JQTMy
X1NZU0VOVEVSX0VTUDsKKwlrdm1feDg2X29wcy5nZXRfbXNyKHZjcHUsICZtc3IpOworCWV2ZW50
LT5tc3JzLnN5c2VudGVyX2VzcCA9IG1zci5kYXRhOworCisJbXNyLmluZGV4ID0gTVNSX0lBMzJf
U1lTRU5URVJfRUlQOworCWt2bV94ODZfb3BzLmdldF9tc3IodmNwdSwgJm1zcik7CisJZXZlbnQt
Pm1zcnMuc3lzZW50ZXJfZWlwID0gbXNyLmRhdGE7CisKKwltc3IuaW5kZXggPSBNU1JfRUZFUjsK
Kwlrdm1feDg2X29wcy5nZXRfbXNyKHZjcHUsICZtc3IpOworCWV2ZW50LT5tc3JzLmVmZXIgPSBt
c3IuZGF0YTsKKworCW1zci5pbmRleCA9IE1TUl9TVEFSOworCWt2bV94ODZfb3BzLmdldF9tc3Io
dmNwdSwgJm1zcik7CisJZXZlbnQtPm1zcnMuc3RhciA9IG1zci5kYXRhOworCisJbXNyLmluZGV4
ID0gTVNSX0xTVEFSOworCWt2bV94ODZfb3BzLmdldF9tc3IodmNwdSwgJm1zcik7CisJZXZlbnQt
Pm1zcnMubHN0YXIgPSBtc3IuZGF0YTsKKworCW1zci5pbmRleCA9IE1TUl9DU1RBUjsKKwlrdm1f
eDg2X29wcy5nZXRfbXNyKHZjcHUsICZtc3IpOworCWV2ZW50LT5tc3JzLmNzdGFyID0gbXNyLmRh
dGE7CisKKwltc3IuaW5kZXggPSBNU1JfSUEzMl9DUl9QQVQ7CisJa3ZtX3g4Nl9vcHMuZ2V0X21z
cih2Y3B1LCAmbXNyKTsKKwlldmVudC0+bXNycy5wYXQgPSBtc3IuZGF0YTsKKworCW1zci5pbmRl
eCA9IE1TUl9LRVJORUxfR1NfQkFTRTsKKwlrdm1feDg2X29wcy5nZXRfbXNyKHZjcHUsICZtc3Ip
OworCWV2ZW50LT5tc3JzLnNoYWRvd19ncyA9IG1zci5kYXRhOworfQorCit2b2lkIGt2bWlfYXJj
aF9zZXR1cF92Y3B1X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKKwkJCQlzdHJ1Y3Qga3Zt
aV92Y3B1X2V2ZW50ICpldikKK3sKKwlzdHJ1Y3Qga3ZtaV92Y3B1X2V2ZW50X2FyY2ggKmV2ZW50
ID0gJmV2LT5hcmNoOworCisJa3ZtX2FyY2hfdmNwdV9nZXRfcmVncyh2Y3B1LCAmZXZlbnQtPnJl
Z3MpOworCWt2bV9hcmNoX3ZjcHVfZ2V0X3NyZWdzKHZjcHUsICZldmVudC0+c3JlZ3MpOworCWV2
LT5hcmNoLm1vZGUgPSBrdm1pX3ZjcHVfbW9kZSh2Y3B1LCAmZXZlbnQtPnNyZWdzKTsKKwlrdm1p
X2dldF9tc3JzKHZjcHUsIGV2ZW50KTsKK30KZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgva3Zt
aV9ob3N0LmggYi9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oCmluZGV4IDU5ZTY0NWQ5ZWEzNC4u
NGE0M2U1MWE0NGM5IDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oCisrKyBi
L2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmgKQEAgLTYsNiArNiwxNCBAQAogCiAjaW5jbHVkZSA8
YXNtL2t2bWlfaG9zdC5oPgogCitzdHJ1Y3Qga3ZtaV92Y3B1X3JlcGx5IHsKKwlpbnQgZXJyb3I7
CisJdTMyIGFjdGlvbjsKKwl1MzIgc2VxOworCXZvaWQgKmRhdGE7CisJc2l6ZV90IHNpemU7Cit9
OworCiBzdHJ1Y3Qga3ZtaV9qb2IgewogCXN0cnVjdCBsaXN0X2hlYWQgbGluazsKIAl2b2lkICpj
dHg7CkBAIC0yMCw2ICsyOCw5IEBAIHN0cnVjdCBrdm1fdmNwdV9pbnRyb3NwZWN0aW9uIHsKIAlz
cGlubG9ja190IGpvYl9sb2NrOwogCiAJYXRvbWljX3QgcGF1c2VfcmVxdWVzdHM7CisKKwlzdHJ1
Y3Qga3ZtaV92Y3B1X3JlcGx5IHJlcGx5OworCWJvb2wgd2FpdGluZ19mb3JfcmVwbHk7CiB9Owog
CiBzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gewpkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xp
bnV4L2t2bWkuaCBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKaW5kZXggYmI5MGQwM2YwNTli
Li42YTU3ZWZiNTY2NGQgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKKysr
IGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaApAQCAtOCw2ICs4LDcgQEAKIAogI2luY2x1ZGUg
PGxpbnV4L2tlcm5lbC5oPgogI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisjaW5jbHVkZSA8YXNt
L2t2bWkuaD4KIAogZW51bSB7CiAJS1ZNSV9WRVJTSU9OID0gMHgwMDAwMDAwMQpAQCAtMzIsNiAr
MzMsOCBAQCBlbnVtIHsKIH07CiAKIGVudW0geworCUtWTUlfVkNQVV9FVkVOVCA9IEtWTUlfVkNQ
VV9NRVNTQUdFX0lEKDApLAorCiAJS1ZNSV9WQ1BVX0dFVF9JTkZPID0gS1ZNSV9WQ1BVX01FU1NB
R0VfSUQoMSksCiAKIAlLVk1JX05FWFRfVkNQVV9NRVNTQUdFCkBAIC01MCw2ICs1MywxMiBAQCBl
bnVtIHsKIAlLVk1JX05FWFRfVkNQVV9FVkVOVAogfTsKIAorZW51bSB7CisJS1ZNSV9FVkVOVF9B
Q1RJT05fQ09OVElOVUUgPSAwLAorCUtWTUlfRVZFTlRfQUNUSU9OX1JFVFJZICAgID0gMSwKKwlL
Vk1JX0VWRU5UX0FDVElPTl9DUkFTSCAgICA9IDIsCit9OworCiBzdHJ1Y3Qga3ZtaV9tc2dfaGRy
IHsKIAlfX3UxNiBpZDsKIAlfX3UxNiBzaXplOwpAQCAtMTIzLDQgKzEzMiwxOCBAQCBzdHJ1Y3Qg
a3ZtaV92bV9wYXVzZV92Y3B1IHsKIAlfX3UzMiBwYWRkaW5nMjsKIH07CiAKK3N0cnVjdCBrdm1p
X3ZjcHVfZXZlbnQgeworCV9fdTE2IHNpemU7CisJX191MTYgdmNwdTsKKwlfX3UzMiBwYWRkaW5n
OworCXN0cnVjdCBrdm1pX3ZjcHVfZXZlbnRfYXJjaCBhcmNoOworfTsKKworc3RydWN0IGt2bWlf
dmNwdV9ldmVudF9yZXBseSB7CisJX191OCBhY3Rpb247CisJX191OCBldmVudDsKKwlfX3UxNiBw
YWRkaW5nMTsKKwlfX3UzMiBwYWRkaW5nMjsKK307CisKICNlbmRpZiAvKiBfVUFQSV9fTElOVVhf
S1ZNSV9IICovCmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyBiL3Zp
cnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCmluZGV4IDQ5OTkxMzJhNjViYy4uNzcxZTZiNTQ1
Njk4IDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYworKysgYi92aXJ0
L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwpAQCAtMzY4LDYgKzM2OCw3IEBAIHN0YXRpYyB2b2lk
IGt2bWlfam9iX3JlbGVhc2VfdmNwdShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHZvaWQgKmN0eCkK
IAlzdHJ1Y3Qga3ZtX3ZjcHVfaW50cm9zcGVjdGlvbiAqdmNwdWkgPSBWQ1BVSSh2Y3B1KTsKIAog
CWF0b21pY19zZXQoJnZjcHVpLT5wYXVzZV9yZXF1ZXN0cywgMCk7CisJdmNwdWktPndhaXRpbmdf
Zm9yX3JlcGx5ID0gZmFsc2U7CiB9CiAKIHN0YXRpYyB2b2lkIGt2bWlfcmVsZWFzZV92Y3B1cyhz
dHJ1Y3Qga3ZtICprdm0pCmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlf
aW50LmggYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmgKaW5kZXggZjFjYWE2N2Ri
ZGMzLi42NWQ4YzFjMzc3OTYgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3Zt
aV9pbnQuaAorKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmgKQEAgLTMyLDYg
KzMyLDkgQEAgdm9pZCBrdm1pX3NvY2tfc2h1dGRvd24oc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9u
ICprdm1pKTsKIHZvaWQga3ZtaV9zb2NrX3B1dChzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2
bWkpOwogYm9vbCBrdm1pX21zZ19wcm9jZXNzKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3Zt
aSk7CiBpbnQga3ZtaV9tc2dfc2VuZF91bmhvb2soc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICpr
dm1pKTsKK2ludCBrdm1pX3NlbmRfdmNwdV9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHUz
MiBldl9pZCwKKwkJCSB2b2lkICpldiwgc2l6ZV90IGV2X3NpemUsCisJCQkgdm9pZCAqcnBsLCBz
aXplX3QgcnBsX3NpemUsIHUzMiAqYWN0aW9uKTsKIGludCBrdm1pX21zZ192Y3B1X3JlcGx5KGNv
bnN0IHN0cnVjdCBrdm1pX3ZjcHVfbXNnX2pvYiAqam9iLAogCQkJY29uc3Qgc3RydWN0IGt2bWlf
bXNnX2hkciAqbXNnLCBpbnQgZXJyLAogCQkJY29uc3Qgdm9pZCAqcnBsLCBzaXplX3QgcnBsX3Np
emUpOwpAQCAtNDYsNiArNDksNyBAQCBib29sIGt2bWlfaXNfa25vd25fdm1fZXZlbnQodTE2IGlk
KTsKIGludCBrdm1pX2FkZF9qb2Ioc3RydWN0IGt2bV92Y3B1ICp2Y3B1LAogCQkgdm9pZCAoKmZj
dCkoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB2b2lkICpjdHgpLAogCQkgdm9pZCAqY3R4LCB2b2lk
ICgqZnJlZV9mY3QpKHZvaWQgKmN0eCkpOwordm9pZCBrdm1pX3J1bl9qb2JzKHN0cnVjdCBrdm1f
dmNwdSAqdmNwdSk7CiBpbnQga3ZtaV9jbWRfdm1fY29udHJvbF9ldmVudHMoc3RydWN0IGt2bV9p
bnRyb3NwZWN0aW9uICprdm1pLAogCQkJICAgICAgIHUxNiBldmVudF9pZCwgYm9vbCBlbmFibGUp
OwogaW50IGt2bWlfY21kX3JlYWRfcGh5c2ljYWwoc3RydWN0IGt2bSAqa3ZtLCB1NjQgZ3BhLCBz
aXplX3Qgc2l6ZSwKQEAgLTYwLDUgKzY0LDcgQEAgaW50IGt2bWlfY21kX3ZjcHVfcGF1c2Uoc3Ry
dWN0IGt2bV92Y3B1ICp2Y3B1LCBib29sIHdhaXQpOwogLyogYXJjaCAqLwogdm9pZCBrdm1pX2Fy
Y2hfaW5pdF92Y3B1X2V2ZW50c19tYXNrKHVuc2lnbmVkIGxvbmcgKnN1cHBvcnRlZCk7CiBrdm1p
X3ZjcHVfbXNnX2pvYl9mY3Qga3ZtaV9hcmNoX3ZjcHVfbXNnX2hhbmRsZXIodTE2IGlkKTsKK3Zv
aWQga3ZtaV9hcmNoX3NldHVwX3ZjcHVfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LAorCQkJ
CXN0cnVjdCBrdm1pX3ZjcHVfZXZlbnQgKmV2KTsKIAogI2VuZGlmCmRpZmYgLS1naXQgYS92aXJ0
L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2
bWlfbXNnLmMKaW5kZXggMDJiZGVjNWJmYmU3Li40NjdjODgxODViZTEgMTAwNjQ0Ci0tLSBhL3Zp
cnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0
aW9uL2t2bWlfbXNnLmMKQEAgLTI5OSw2ICsyOTksNjYgQEAgc3RhdGljIGJvb2wgaXNfdm1fY29t
bWFuZCh1MTYgaWQpCiAJcmV0dXJuIGlzX3ZtX21lc3NhZ2UoaWQpICYmIGlkICE9IEtWTUlfVk1f
RVZFTlQ7CiB9CiAKK3N0YXRpYyBpbnQgY2hlY2tfZXZlbnRfcmVwbHkoY29uc3Qgc3RydWN0IGt2
bWlfbXNnX2hkciAqbXNnLAorCQkJICAgICBjb25zdCBzdHJ1Y3Qga3ZtaV92Y3B1X2V2ZW50X3Jl
cGx5ICpyZXBseSwKKwkJCSAgICAgY29uc3Qgc3RydWN0IGt2bWlfdmNwdV9yZXBseSAqZXhwZWN0
ZWQsCisJCQkgICAgIHU4ICphY3Rpb24sIHNpemVfdCAqcmVjZWl2ZWQpCit7CisJc2l6ZV90IG1z
Z19zaXplLCBjb21tb24sIGV2ZW50X3NpemU7CisJaW50IGVyciA9IC1FSU5WQUw7CisKKwlpZiAo
dW5saWtlbHkobXNnLT5zZXEgIT0gZXhwZWN0ZWQtPnNlcSkpCisJCXJldHVybiBlcnI7CisKKwlt
c2dfc2l6ZSA9IG1zZy0+c2l6ZTsKKwljb21tb24gPSBzaXplb2Yoc3RydWN0IGt2bWlfdmNwdV9o
ZHIpICsgc2l6ZW9mKCpyZXBseSk7CisKKwlpZiAoY2hlY2tfc3ViX292ZXJmbG93KG1zZ19zaXpl
LCBjb21tb24sICZldmVudF9zaXplKSkKKwkJcmV0dXJuIGVycjsKKworCWlmICh1bmxpa2VseShl
dmVudF9zaXplID4gZXhwZWN0ZWQtPnNpemUpKQorCQlyZXR1cm4gZXJyOworCisJaWYgKHVubGlr
ZWx5KHJlcGx5LT5wYWRkaW5nMSB8fCByZXBseS0+cGFkZGluZzIpKQorCQlyZXR1cm4gZXJyOwor
CisJKnJlY2VpdmVkID0gZXZlbnRfc2l6ZTsKKwkqYWN0aW9uID0gcmVwbHktPmFjdGlvbjsKKwly
ZXR1cm4gMDsKK30KKworc3RhdGljIGludCBoYW5kbGVfdmNwdV9ldmVudF9yZXBseShjb25zdCBz
dHJ1Y3Qga3ZtaV92Y3B1X21zZ19qb2IgKmpvYiwKKwkJCQkgICBjb25zdCBzdHJ1Y3Qga3ZtaV9t
c2dfaGRyICptc2csCisJCQkJICAgY29uc3Qgdm9pZCAqcnBsKQoreworCXN0cnVjdCBrdm1fdmNw
dV9pbnRyb3NwZWN0aW9uICp2Y3B1aSA9IFZDUFVJKGpvYi0+dmNwdSk7CisJc3RydWN0IGt2bWlf
dmNwdV9yZXBseSAqZXhwZWN0ZWQgPSAmdmNwdWktPnJlcGx5OworCWNvbnN0IHN0cnVjdCBrdm1p
X3ZjcHVfZXZlbnRfcmVwbHkgKnJlcGx5ID0gcnBsOworCWNvbnN0IHZvaWQgKnJlcGx5X2RhdGEg
PSByZXBseSArIDE7CisJc2l6ZV90IHVzZWZ1bCwgcmVjZWl2ZWQ7CisJdTggYWN0aW9uOworCisJ
ZXhwZWN0ZWQtPmVycm9yID0gY2hlY2tfZXZlbnRfcmVwbHkobXNnLCByZXBseSwgZXhwZWN0ZWQs
ICZhY3Rpb24sCisJCQkJCSAgICAmcmVjZWl2ZWQpOworCWlmICh1bmxpa2VseShleHBlY3RlZC0+
ZXJyb3IpKQorCQlnb3RvIG91dDsKKworCXVzZWZ1bCA9IG1pbihyZWNlaXZlZCwgZXhwZWN0ZWQt
PnNpemUpOworCWlmICh1c2VmdWwpCisJCW1lbWNweShleHBlY3RlZC0+ZGF0YSwgcmVwbHlfZGF0
YSwgdXNlZnVsKTsKKworCWlmIChleHBlY3RlZC0+c2l6ZSA+IHVzZWZ1bCkKKwkJbWVtc2V0KChj
aGFyICopZXhwZWN0ZWQtPmRhdGEgKyB1c2VmdWwsIDAsCisJCQlleHBlY3RlZC0+c2l6ZSAtIHVz
ZWZ1bCk7CisKKwlleHBlY3RlZC0+YWN0aW9uID0gYWN0aW9uOworCWV4cGVjdGVkLT5lcnJvciA9
IDA7CisKK291dDoKKwl2Y3B1aS0+d2FpdGluZ19mb3JfcmVwbHkgPSBmYWxzZTsKKwlyZXR1cm4g
ZXhwZWN0ZWQtPmVycm9yOworfQorCiAvKgogICogVGhlc2UgZnVuY3Rpb25zIGFyZSBleGVjdXRl
ZCBmcm9tIHRoZSB2Q1BVIHRocmVhZC4gVGhlIHJlY2VpdmluZyB0aHJlYWQKICAqIHBhc3NlcyB0
aGUgbWVzc2FnZXMgdXNpbmcgYSBuZXdseSBhbGxvY2F0ZWQgJ3N0cnVjdCBrdm1pX3ZjcHVfbXNn
X2pvYicKQEAgLTMwNiw2ICszNjYsNyBAQCBzdGF0aWMgYm9vbCBpc192bV9jb21tYW5kKHUxNiBp
ZCkKICAqIHNlbmRpbmcgYmFjayB0aGUgcmVwbHkpLgogICovCiBzdGF0aWMga3ZtaV92Y3B1X21z
Z19qb2JfZmN0IGNvbnN0IG1zZ192Y3B1W10gPSB7CisJW0tWTUlfVkNQVV9FVkVOVF0gPSBoYW5k
bGVfdmNwdV9ldmVudF9yZXBseSwKIH07CiAKIHN0YXRpYyBrdm1pX3ZjcHVfbXNnX2pvYl9mY3Qg
Z2V0X3ZjcHVfbXNnX2hhbmRsZXIodTE2IGlkKQpAQCAtMzI5LDcgKzM5MCw3IEBAIHN0YXRpYyBi
b29sIGlzX3ZjcHVfbWVzc2FnZSh1MTYgaWQpCiAKIHN0YXRpYyBib29sIGlzX3ZjcHVfY29tbWFu
ZCh1MTYgaWQpCiB7Ci0JcmV0dXJuIGlzX3ZjcHVfbWVzc2FnZShpZCk7CisJcmV0dXJuIGlzX3Zj
cHVfbWVzc2FnZShpZCkgJiYgaWQgIT0gS1ZNSV9WQ1BVX0VWRU5UOwogfQogCiBzdGF0aWMgdm9p
ZCBrdm1pX2pvYl92Y3B1X21zZyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHZvaWQgKmN0eCkKQEAg
LTQyMiw3ICs0ODMsOCBAQCBzdGF0aWMgaW50IGt2bWlfbXNnX2hhbmRsZV92bV9jbWQoc3RydWN0
IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pLAogCiBzdGF0aWMgYm9vbCB2Y3B1X2Nhbl9oYW5kbGVf
bWVzc2FnZXMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQogewotCXJldHVybiB2Y3B1LT5hcmNoLm1w
X3N0YXRlICE9IEtWTV9NUF9TVEFURV9VTklOSVRJQUxJWkVEOworCXJldHVybiBWQ1BVSSh2Y3B1
KS0+d2FpdGluZ19mb3JfcmVwbHkKKwkJfHwgdmNwdS0+YXJjaC5tcF9zdGF0ZSAhPSBLVk1fTVBf
U1RBVEVfVU5JTklUSUFMSVpFRDsKIH0KIAogc3RhdGljIGludCBrdm1pX2dldF92Y3B1X2lmX3Jl
YWR5KHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSwKQEAgLTQ2Nyw3ICs1MjksOCBAQCBz
dGF0aWMgaW50IGt2bWlfbXNnX2hhbmRsZV92Y3B1X21zZyhzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rp
b24gKmt2bWksCiAJc3RydWN0IGt2bV92Y3B1ICp2Y3B1ID0gTlVMTDsKIAlpbnQgZXJyLCBlYzsK
IAotCWlmICgha3ZtaV9pc19jb21tYW5kX2FsbG93ZWQoa3ZtaSwgbXNnLT5pZCkpCisJaWYgKG1z
Zy0+aWQgIT0gS1ZNSV9WQ1BVX0VWRU5UICYmCisJICAgICFrdm1pX2lzX2NvbW1hbmRfYWxsb3dl
ZChrdm1pLCBtc2ctPmlkKSkKIAkJcmV0dXJuIGt2bWlfbXNnX3ZtX3JlcGx5X2VjKGt2bWksIG1z
ZywgLUtWTV9FUEVSTSk7CiAKIAlpZiAodmNwdV9oZHItPnBhZGRpbmcxIHx8IHZjcHVfaGRyLT5w
YWRkaW5nMikKQEAgLTU0NywzICs2MTAsOTAgQEAgaW50IGt2bWlfbXNnX3NlbmRfdW5ob29rKHN0
cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSkKIAogCXJldHVybiBrdm1pX3NvY2tfd3JpdGUo
a3ZtaSwgdmVjLCBuLCBtc2dfc2l6ZSk7CiB9CisKK3N0YXRpYyBpbnQga3ZtaV93YWl0X2Zvcl9y
ZXBseShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCit7CisJc3RydWN0IHJjdXdhaXQgKndhaXRwID0g
a3ZtX2FyY2hfdmNwdV9nZXRfd2FpdCh2Y3B1KTsKKwlzdHJ1Y3Qga3ZtX3ZjcHVfaW50cm9zcGVj
dGlvbiAqdmNwdWkgPSBWQ1BVSSh2Y3B1KTsKKwlpbnQgZXJyID0gMDsKKworCXdoaWxlICh2Y3B1
aS0+d2FpdGluZ19mb3JfcmVwbHkgJiYgIWVycikgeworCQlrdm1pX3J1bl9qb2JzKHZjcHUpOwor
CisJCWVyciA9IHJjdXdhaXRfd2FpdF9ldmVudCh3YWl0cCwKKwkJCSF2Y3B1aS0+d2FpdGluZ19m
b3JfcmVwbHkgfHwKKwkJCSFsaXN0X2VtcHR5KCZ2Y3B1aS0+am9iX2xpc3QpLAorCQkJVEFTS19L
SUxMQUJMRSk7CisJfQorCisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIHZvaWQga3ZtaV9zZXR1
cF92Y3B1X3JlcGx5KHN0cnVjdCBrdm1fdmNwdV9pbnRyb3NwZWN0aW9uICp2Y3B1aSwKKwkJCQkg
IHUzMiBtc2dfc2VxLCB2b2lkICpycGwsIHNpemVfdCBycGxfc2l6ZSkKK3sKKwltZW1zZXQoJnZj
cHVpLT5yZXBseSwgMCwgc2l6ZW9mKHZjcHVpLT5yZXBseSkpOworCisJdmNwdWktPnJlcGx5LnNl
cSA9IG1zZ19zZXE7CisJdmNwdWktPnJlcGx5LmRhdGEgPSBycGw7CisJdmNwdWktPnJlcGx5LnNp
emUgPSBycGxfc2l6ZTsKKwl2Y3B1aS0+cmVwbHkuZXJyb3IgPSAtRUlOVFI7CisJdmNwdWktPndh
aXRpbmdfZm9yX3JlcGx5ID0gdHJ1ZTsKK30KKworc3RhdGljIGludCBrdm1pX2ZpbGxfYW5kX3Nl
bnRfdmNwdV9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCisJCQkJCSB1MzIgZXZfaWQsIHZv
aWQgKmV2LAorCQkJCQkgc2l6ZV90IGV2X3NpemUsIHUzMiBtc2dfc2VxKQoreworCXN0cnVjdCBr
dm1pX21zZ19oZHIgbXNnX2hkcjsKKwlzdHJ1Y3Qga3ZtaV9ldmVudF9oZHIgZXZfaGRyOworCXN0
cnVjdCBrdm1pX3ZjcHVfZXZlbnQgY29tbW9uOworCXN0cnVjdCBrdmVjIHZlY1tdID0geworCQl7
Lmlvdl9iYXNlID0gJm1zZ19oZHIsIC5pb3ZfbGVuID0gc2l6ZW9mKG1zZ19oZHIpfSwKKwkJey5p
b3ZfYmFzZSA9ICZldl9oZHIsICAuaW92X2xlbiA9IHNpemVvZihldl9oZHIpIH0sCisJCXsuaW92
X2Jhc2UgPSAmY29tbW9uLCAgLmlvdl9sZW4gPSBzaXplb2YoY29tbW9uKSB9LAorCQl7Lmlvdl9i
YXNlID0gZXYsICAgICAgIC5pb3ZfbGVuID0gZXZfc2l6ZSAgICAgICAgfSwKKwl9OworCXNpemVf
dCBtc2dfc2l6ZSA9IHNpemVvZihtc2dfaGRyKSArIHNpemVvZihldl9oZHIpCisJCQkrIHNpemVv
Zihjb21tb24pICsgZXZfc2l6ZTsKKwlzaXplX3QgbiA9IEFSUkFZX1NJWkUodmVjKSAtIChldl9z
aXplID09IDAgPyAxIDogMCk7CisJc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pID0gS1ZN
SSh2Y3B1LT5rdm0pOworCisJa3ZtaV9maWxsX2V2X21zZ19oZHIoa3ZtaSwgJm1zZ19oZHIsICZl
dl9oZHIsIEtWTUlfVkNQVV9FVkVOVCwKKwkJCSAgICAgbXNnX3NlcSwgbXNnX3NpemUsIGV2X2lk
KTsKKworCWNvbW1vbi5zaXplID0gc2l6ZW9mKGNvbW1vbik7CisJY29tbW9uLnZjcHUgPSBrdm1f
dmNwdV9nZXRfaWR4KHZjcHUpOworCisJa3ZtaV9hcmNoX3NldHVwX3ZjcHVfZXZlbnQodmNwdSwg
JmNvbW1vbik7CisKKwlyZXR1cm4ga3ZtaV9zb2NrX3dyaXRlKGt2bWksIHZlYywgbiwgbXNnX3Np
emUpOworfQorCitpbnQga3ZtaV9zZW5kX3ZjcHVfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
LCB1MzIgZXZfaWQsCisJCQkgdm9pZCAqZXYsIHNpemVfdCBldl9zaXplLAorCQkJIHZvaWQgKnJw
bCwgc2l6ZV90IHJwbF9zaXplLCB1MzIgKmFjdGlvbikKK3sKKwlzdHJ1Y3Qga3ZtX3ZjcHVfaW50
cm9zcGVjdGlvbiAqdmNwdWkgPSBWQ1BVSSh2Y3B1KTsKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rp
b24gKmt2bWkgPSBLVk1JKHZjcHUtPmt2bSk7CisJdTMyIG1zZ19zZXEgPSBhdG9taWNfaW5jX3Jl
dHVybigma3ZtaS0+ZXZfc2VxKTsKKwlpbnQgZXJyOworCisJa3ZtaV9zZXR1cF92Y3B1X3JlcGx5
KHZjcHVpLCBtc2dfc2VxLCBycGwsIHJwbF9zaXplKTsKKworCWVyciA9IGt2bWlfZmlsbF9hbmRf
c2VudF92Y3B1X2V2ZW50KHZjcHUsIGV2X2lkLCBldiwgZXZfc2l6ZSwgbXNnX3NlcSk7CisJaWYg
KGVycikKKwkJZ290byBvdXQ7CisKKwllcnIgPSBrdm1pX3dhaXRfZm9yX3JlcGx5KHZjcHUpOwor
CWlmICghZXJyKQorCQllcnIgPSB2Y3B1aS0+cmVwbHkuZXJyb3I7CisKK291dDoKKwlpZiAoZXJy
KQorCQlrdm1pX3NvY2tfc2h1dGRvd24oa3ZtaSk7CisJZWxzZQorCQkqYWN0aW9uID0gdmNwdWkt
PnJlcGx5LmFjdGlvbjsKKworCXJldHVybiBlcnI7Cit9Cl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0
dWFsaXphdGlvbkBsaXN0cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4
Zm91bmRhdGlvbi5vcmcvbWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
