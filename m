Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp2.osuosl.org (smtp2.osuosl.org [140.211.166.133])
	by mail.lfdr.de (Postfix) with ESMTPS id E11BB7259B7
	for <lists.virtualization@lfdr.de>; Wed,  7 Jun 2023 11:12:07 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp2.osuosl.org (Postfix) with ESMTP id 35BBD400D0;
	Wed,  7 Jun 2023 09:12:06 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 35BBD400D0
Authentication-Results: smtp2.osuosl.org;
	dkim=fail reason="signature verification failed" (2048-bit key) header.d=gmail.com header.i=@gmail.com header.a=rsa-sha256 header.s=20221208 header.b=hrcoUew4
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
	by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id Of6Bd-FqRJlC; Wed,  7 Jun 2023 09:12:04 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by smtp2.osuosl.org (Postfix) with ESMTPS id 2793840568;
	Wed,  7 Jun 2023 09:12:04 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 2793840568
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 71641C008C;
	Wed,  7 Jun 2023 09:12:03 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp2.osuosl.org (smtp2.osuosl.org [IPv6:2605:bc80:3010::133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id A65CCC0029
 for <virtualization@lists.linux-foundation.org>;
 Wed,  7 Jun 2023 09:12:02 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp2.osuosl.org (Postfix) with ESMTP id 80DE04052C
 for <virtualization@lists.linux-foundation.org>;
 Wed,  7 Jun 2023 09:12:02 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 80DE04052C
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
 by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id H4NGROr4GYxl
 for <virtualization@lists.linux-foundation.org>;
 Wed,  7 Jun 2023 09:12:01 +0000 (UTC)
X-Greylist: whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 696B1400D0
Received: from mail-lj1-x22a.google.com (mail-lj1-x22a.google.com
 [IPv6:2a00:1450:4864:20::22a])
 by smtp2.osuosl.org (Postfix) with ESMTPS id 696B1400D0
 for <virtualization@lists.linux-foundation.org>;
 Wed,  7 Jun 2023 09:12:00 +0000 (UTC)
Received: by mail-lj1-x22a.google.com with SMTP id
 38308e7fff4ca-2b1a46ad09fso80692821fa.2
 for <virtualization@lists.linux-foundation.org>;
 Wed, 07 Jun 2023 02:11:59 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20221208; t=1686129117; x=1688721117;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:from:to:cc:subject:date
 :message-id:reply-to;
 bh=JmPNYkBgrmBcmDwp1wXLEF1VLnBZxU0TCJ0B7RX359k=;
 b=hrcoUew4GGOgY40QjZuk7As8VKuxPtSWlU/7nxoalftJquDHyowB6Zu2S5VQedVR6c
 7Z2Qi5OEuZKw3bh+7i5H6qJVvvMuo7vnSgjT5a+7HwuxJqvTgQYn/g2F2xwXXuhFgjU6
 76enUw8Z4MPsy4j76fuqchWqroxgoqTfs4HjNVSmLC+odutswLD8CTP9Hv81gDXrx8iw
 tyxT6kq39fqNNJ/s4Z0NkMyBg3mCxSxRee/tR/35h2qPNvonzxYOUvjb8TSMzrruwEnn
 ndYrw74QOFuLQoiWWISJMxEaNX0O77dro3z7CHGVarUfqBuY2611iDd7Wizkk2VzVv7s
 GM7w==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20221208; t=1686129117; x=1688721117;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
 :subject:date:message-id:reply-to;
 bh=JmPNYkBgrmBcmDwp1wXLEF1VLnBZxU0TCJ0B7RX359k=;
 b=GAR4W42CR46Ee7mgX7nvGUs+9J9umdTMNV8rg3sKvIR0+4Yo/WKCVfsoqhHc4MGXzi
 +/ab9dscilsNKsZI1oHEJH5c+AEQTOgnkMvJfnRDRBrffxwW1z0hvv8EBKMsTJkVYMrF
 AhSL2CiJ312w7zFh9OaSDKDAOOiwK0OLG84CUzrO3uq9qNrb5U8kPaq7B8bXC5cYKzbC
 s8k1WN7dhbGXXhxv3N7G8WlqgjqjJd5I9pXWbU4x3HahbMYyq+vp96CIzBOE0BQXKvPB
 J4ov/wWA0cPDgrfgnKaUP4f5gsxq5urMWeu4OOlRvZzv5rrURINoH0peUBYxDxzkEnVf
 mpvQ==
X-Gm-Message-State: AC+VfDwpQg4Hb/VpbHs80FmTSG5oAv0GEyBXhlRutyIVcpWXhx9qD3Mi
 okBD3yVg1fYq7Er7S5Z4e95rgqfiXSLRA9uLZis=
X-Google-Smtp-Source: ACHHUZ4+IankWNLxq713gEGAKkVxMY49FhO2XKyFb3yhltguoaC+YZX+xpZ8FWm7NhEeCd5N/2zEHRlAMh9Ykm2d5wU=
X-Received: by 2002:a2e:3013:0:b0:2ac:8e5a:1054 with SMTP id
 w19-20020a2e3013000000b002ac8e5a1054mr1913896ljw.0.1686129117219; Wed, 07 Jun
 2023 02:11:57 -0700 (PDT)
MIME-Version: 1.0
References: <20230526054621.18371-1-liangchen.linux@gmail.com>
 <20230526054621.18371-2-liangchen.linux@gmail.com>
 <CACGkMEv+5150S4ooWFMnUs-GpwRYgRMTku0ZgkFpH5iFR1qQsw@mail.gmail.com>
 <CAKhg4tL2b9LEsaNuLi94Zf9XQ4S2FyoXWzW9wTTkrU8L1qNQcQ@mail.gmail.com>
 <20230528023956-mutt-send-email-mst@kernel.org>
 <CAKhg4t+8TsNZ-0hzfo63qCh_uFYHCmyZR+Fx+rC8garnMBt9jw@mail.gmail.com>
 <1685502651.282807-1-xuanzhuo@linux.alibaba.com>
In-Reply-To: <1685502651.282807-1-xuanzhuo@linux.alibaba.com>
From: Liang Chen <liangchen.linux@gmail.com>
Date: Wed, 7 Jun 2023 17:11:44 +0800
Message-ID: <CAKhg4tJ=+gLp0PYvcfaZD6CrjJUtp6CZjf_ww8wZ7P7Db28V3w@mail.gmail.com>
Subject: Re: [PATCH net-next 2/5] virtio_net: Add page_pool support to improve
 performance
To: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
Cc: "Michael S. Tsirkin" <mst@redhat.com>, netdev@vger.kernel.org,
 linux-kernel@vger.kernel.org, alexander.duyck@gmail.com,
 virtualization@lists.linux-foundation.org, edumazet@google.com,
 kuba@kernel.org, pabeni@redhat.com, davem@davemloft.net
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gV2VkLCBNYXkgMzEsIDIwMjMgYXQgMTE6MTLigK9BTSBYdWFuIFpodW8gPHh1YW56aHVvQGxp
bnV4LmFsaWJhYmEuY29tPiB3cm90ZToKPgo+IE9uIE1vbiwgMjkgTWF5IDIwMjMgMTU6Mjg6MTcg
KzA4MDAsIExpYW5nIENoZW4gPGxpYW5nY2hlbi5saW51eEBnbWFpbC5jb20+IHdyb3RlOgo+ID4g
T24gU3VuLCBNYXkgMjgsIDIwMjMgYXQgMjo0MOKAr1BNIE1pY2hhZWwgUy4gVHNpcmtpbiA8bXN0
QHJlZGhhdC5jb20+IHdyb3RlOgo+ID4gPgo+ID4gPiBPbiBTYXQsIE1heSAyNywgMjAyMyBhdCAw
ODozNTowMVBNICswODAwLCBMaWFuZyBDaGVuIHdyb3RlOgo+ID4gPiA+IE9uIEZyaSwgTWF5IDI2
LCAyMDIzIGF0IDI6NTHigK9QTSBKYXNvbiBXYW5nIDxqYXNvd2FuZ0ByZWRoYXQuY29tPiB3cm90
ZToKPiA+ID4gPiA+Cj4gPiA+ID4gPiBPbiBGcmksIE1heSAyNiwgMjAyMyBhdCAxOjQ24oCvUE0g
TGlhbmcgQ2hlbiA8bGlhbmdjaGVuLmxpbnV4QGdtYWlsLmNvbT4gd3JvdGU6Cj4gPiA+ID4gPiA+
Cj4gPiA+ID4gPiA+IFRoZSBpbXBsZW1lbnRhdGlvbiBhdCB0aGUgbW9tZW50IHVzZXMgb25lIHBh
Z2UgcGVyIHBhY2tldCBpbiBib3RoIHRoZQo+ID4gPiA+ID4gPiBub3JtYWwgYW5kIFhEUCBwYXRo
Lgo+ID4gPiA+ID4KPiA+ID4gPiA+IEl0J3MgYmV0dGVyIHRvIGV4cGxhaW4gd2h5IHdlIG5lZWQg
YSBwYWdlIHBvb2wgYW5kIGhvdyBpdCBjYW4gaGVscCB0aGUKPiA+ID4gPiA+IHBlcmZvcm1hbmNl
Lgo+ID4gPiA+ID4KPiA+ID4gPgo+ID4gPiA+IFN1cmUsIEkgd2lsbCBpbmNsdWRlIHRoYXQgb24g
djIuCj4gPiA+ID4gPiA+IEluIGFkZGl0aW9uLCBpbnRyb2R1Y2luZyBhIG1vZHVsZSBwYXJhbWV0
ZXIgdG8gZW5hYmxlCj4gPiA+ID4gPiA+IG9yIGRpc2FibGUgdGhlIHVzYWdlIG9mIHBhZ2UgcG9v
bCAoZGlzYWJsZWQgYnkgZGVmYXVsdCkuCj4gPiA+ID4gPgo+ID4gPiA+ID4gSWYgcGFnZSBwb29s
IHdpbnMgZm9yIG1vc3Qgb2YgdGhlIGNhc2VzLCBhbnkgcmVhc29uIHRvIGRpc2FibGUgaXQgYnkg
ZGVmYXVsdD8KPiA+ID4gPiA+Cj4gPiA+ID4KPiA+ID4gPiBUaGFuayB5b3UgZm9yIHJhaXNpbmcg
dGhlIHBvaW50LiBJdCBkb2VzIG1ha2Ugc2Vuc2UgdG8gZW5hYmxlIGl0IGJ5IGRlZmF1bHQuCj4g
PiA+Cj4gPiA+IEknZCBsaWtlIHRvIHNlZSBtb3JlIGJlbmNobWFya3MgcGxzIHRoZW4sIHdpdGgg
YSB2YXJpZXR5IG9mIHBhY2tldAo+ID4gPiBzaXplcywgdWRwIGFuZCB0Y3AuCj4gPiA+Cj4gPgo+
ID4gU3VyZSwgbW9yZSBiZW5jaG1hcmtzIHdpbGwgYmUgcHJvdmlkZWQuIFRoYW5rcy4KPgo+Cj4g
SSB0aGluayBzby4KPgo+IEkgZGlkIHRoaXMsIGJ1dCBJIGRpZCBub3QgZm91bmQgYW55IGltcHJv
dmUuIFNvIEkgZ2F2ZSB1cCBpdC4KPgo+IFRoYW5rcy4KPgo+CgpPdXIgVURQIGJlbmNobWFyayBz
aG93cyBhIHN0ZWFkeSAwLjggcGVyY2VudCBjaGFuZ2UgaW4gUFBTCm1lYXN1cmVtZW50LiBIb3dl
dmVyLCB3aGVuIGNvbmR1Y3RpbmcgaXBlcmYgVENQIHN0cmVhbSBwZXJmb3JtYW5jZQp0ZXN0aW5n
LCB0aGUgcmVzdWx0cyB2YXJ5IGRlcGVuZGluZyBvbiB0aGUgcGFja2V0IHNpemUgYW5kIHRlc3Rp
bmcKc2V0dXAuIFdpdGggc21hbGwgcGFja2V0IHNpemVzLCB0aGUgcGVyZm9ybWFuY2UgYWN0dWFs
bHkgZHJvcHMKc2xpZ2h0bHkgZHVlIHRvIHRoZSByZWFzb25zIEkgZXhwbGFpbmVkIGluIHRoZSBw
cmV2aW91cyBlbWFpbC4gT24gdGhlCm90aGVyIGhhbmQsIHdpdGggbGFyZ2UgcGFja2V0cywgd2Ug
bmVlZCB0byBlbnN1cmUgdGhhdCB0aGUgc2VuZGVyIHNpZGUKZG9lc24ndCBiZWNvbWUgdGhlIGJv
dHRsZW5lY2suIFRvIGFjaGlldmUgdGhpcywgb3VyIHNldHVwIHVzZXMgYQpzaW5nbGUtY29yZSB2
bSB0byBrZWVwIHRoZSByZWNlaXZlciBidXN5LCB3aGljaCBhbGxvd3MgdXMgdG8gaWRlbnRpZnkK
cGVyZm9ybWFuY2UgZGlmZmVyZW5jZXMgaW4gdGhlIHJlY2VpdmluZyBwYXRoLgoKClRoYW5rcywK
TGlhbmcKCgoKCj4gPgo+ID4KPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gSW4gc2luZ2xlLWNvcmUg
dm0gdGVzdGluZyBlbnZpcm9ubWVudHMsIGl0IGdpdmVzIGEgbW9kZXN0IHBlcmZvcm1hbmNlIGdh
aW4KPiA+ID4gPiA+ID4gaW4gdGhlIG5vcm1hbCBwYXRoLgo+ID4gPiA+ID4gPiAgIFVwc3RyZWFt
IGNvZGViYXNlOiA0Ny41IEdiaXRzL3NlYwo+ID4gPiA+ID4gPiAgIFVwc3RyZWFtIGNvZGViYXNl
ICsgcGFnZV9wb29sIHN1cHBvcnQ6IDUwLjIgR2JpdHMvc2VjCj4gPiA+ID4gPiA+Cj4gPiA+ID4g
PiA+IEluIG11bHRpLWNvcmUgdm0gdGVzdGluZyBlbnZpcm9ubWVudHMsIFRoZSBtb3N0IHNpZ25p
ZmljYW50IHBlcmZvcm1hbmNlCj4gPiA+ID4gPiA+IGdhaW4gaXMgb2JzZXJ2ZWQgaW4gWERQIGNw
dW1hcDoKPiA+ID4gPiA+ID4gICBVcHN0cmVhbSBjb2RlYmFzZTogMS4zOCBHYml0cy9zZWMKPiA+
ID4gPiA+ID4gICBVcHN0cmVhbSBjb2RlYmFzZSArIHBhZ2VfcG9vbCBzdXBwb3J0OiA5Ljc0IEdi
aXRzL3NlYwo+ID4gPiA+ID4KPiA+ID4gPiA+IFBsZWFzZSBzaG93IG1vcmUgZGV0YWlscyBvbiB0
aGUgdGVzdC4gRS5nIHdoaWNoIGtpbmRzIG9mIHRlc3RzIGhhdmUKPiA+ID4gPiA+IHlvdSBtZWFz
dXJlZD8KPiA+ID4gPiA+Cj4gPiA+ID4gPiBCdHcsIGl0IHdvdWxkIGJlIGJldHRlciB0byBtZWFz
dXJlIFBQUyBhcyB3ZWxsLgo+ID4gPiA+ID4KPiA+ID4gPgo+ID4gPiA+IFN1cmUuIEl0IHdpbGwg
YmUgYWRkZWQgb24gdjIuCj4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+IFdpdGggdGhpcyBmb3VuZGF0
aW9uLCB3ZSBjYW4gZnVydGhlciBpbnRlZ3JhdGUgcGFnZSBwb29sIGZyYWdtZW50YXRpb24gYW5k
Cj4gPiA+ID4gPiA+IERNQSBtYXAvdW5tYXAgc3VwcG9ydC4KPiA+ID4gPiA+ID4KPiA+ID4gPiA+
ID4gU2lnbmVkLW9mZi1ieTogTGlhbmcgQ2hlbiA8bGlhbmdjaGVuLmxpbnV4QGdtYWlsLmNvbT4K
PiA+ID4gPiA+ID4gLS0tCj4gPiA+ID4gPiA+ICBkcml2ZXJzL25ldC92aXJ0aW9fbmV0LmMgfCAx
ODggKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tCj4gPiA+ID4gPgo+ID4g
PiA+ID4gSSBiZWxpZXZlIHdlIHNob3VsZCBtYWtlIHZpcnRpby1uZXQgdG8gc2VsZWN0IENPTkZJ
R19QQUdFX1BPT0wgb3IgZG8KPiA+ID4gPiA+IHRoZSBpZmRlZiB0cmlja3MgYXQgbGVhc3QuCj4g
PiA+ID4gPgo+ID4gPiA+Cj4gPiA+ID4gU3VyZS4gaXQgd2lsbCBiZSBkb25lIG9uIHYyLgo+ID4g
PiA+ID4gPiAgMSBmaWxlIGNoYW5nZWQsIDE0NiBpbnNlcnRpb25zKCspLCA0MiBkZWxldGlvbnMo
LSkKPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L3ZpcnRp
b19uZXQuYyBiL2RyaXZlcnMvbmV0L3ZpcnRpb19uZXQuYwo+ID4gPiA+ID4gPiBpbmRleCBjNWRj
YTBkOTJlNjQuLjk5YzBjYTBjMTc4MSAxMDA2NDQKPiA+ID4gPiA+ID4gLS0tIGEvZHJpdmVycy9u
ZXQvdmlydGlvX25ldC5jCj4gPiA+ID4gPiA+ICsrKyBiL2RyaXZlcnMvbmV0L3ZpcnRpb19uZXQu
Ywo+ID4gPiA+ID4gPiBAQCAtMzEsNiArMzEsOSBAQCBtb2R1bGVfcGFyYW0oY3N1bSwgYm9vbCwg
MDQ0NCk7Cj4gPiA+ID4gPiA+ICBtb2R1bGVfcGFyYW0oZ3NvLCBib29sLCAwNDQ0KTsKPiA+ID4g
PiA+ID4gIG1vZHVsZV9wYXJhbShuYXBpX3R4LCBib29sLCAwNjQ0KTsKPiA+ID4gPiA+ID4KPiA+
ID4gPiA+ID4gK3N0YXRpYyBib29sIHBhZ2VfcG9vbF9lbmFibGVkOwo+ID4gPiA+ID4gPiArbW9k
dWxlX3BhcmFtKHBhZ2VfcG9vbF9lbmFibGVkLCBib29sLCAwNDAwKTsKPiA+ID4gPiA+ID4gKwo+
ID4gPiA+ID4gPiAgLyogRklYTUU6IE1UVSBpbiBjb25maWcuICovCj4gPiA+ID4gPiA+ICAjZGVm
aW5lIEdPT0RfUEFDS0VUX0xFTiAoRVRIX0hMRU4gKyBWTEFOX0hMRU4gKyBFVEhfREFUQV9MRU4p
Cj4gPiA+ID4gPiA+ICAjZGVmaW5lIEdPT0RfQ09QWV9MRU4gIDEyOAo+ID4gPiA+ID4gPiBAQCAt
MTU5LDYgKzE2Miw5IEBAIHN0cnVjdCByZWNlaXZlX3F1ZXVlIHsKPiA+ID4gPiA+ID4gICAgICAg
ICAvKiBDaGFpbiBwYWdlcyBieSB0aGUgcHJpdmF0ZSBwdHIuICovCj4gPiA+ID4gPiA+ICAgICAg
ICAgc3RydWN0IHBhZ2UgKnBhZ2VzOwo+ID4gPiA+ID4gPgo+ID4gPiA+ID4gPiArICAgICAgIC8q
IFBhZ2UgcG9vbCAqLwo+ID4gPiA+ID4gPiArICAgICAgIHN0cnVjdCBwYWdlX3Bvb2wgKnBhZ2Vf
cG9vbDsKPiA+ID4gPiA+ID4gKwo+ID4gPiA+ID4gPiAgICAgICAgIC8qIEF2ZXJhZ2UgcGFja2V0
IGxlbmd0aCBmb3IgbWVyZ2VhYmxlIHJlY2VpdmUgYnVmZmVycy4gKi8KPiA+ID4gPiA+ID4gICAg
ICAgICBzdHJ1Y3QgZXdtYV9wa3RfbGVuIG1yZ19hdmdfcGt0X2xlbjsKPiA+ID4gPiA+ID4KPiA+
ID4gPiA+ID4gQEAgLTQ1OSw2ICs0NjUsMTQgQEAgc3RhdGljIHN0cnVjdCBza19idWZmICp2aXJ0
bmV0X2J1aWxkX3NrYih2b2lkICpidWYsIHVuc2lnbmVkIGludCBidWZsZW4sCj4gPiA+ID4gPiA+
ICAgICAgICAgcmV0dXJuIHNrYjsKPiA+ID4gPiA+ID4gIH0KPiA+ID4gPiA+ID4KPiA+ID4gPiA+
ID4gK3N0YXRpYyB2b2lkIHZpcnRuZXRfcHV0X3BhZ2Uoc3RydWN0IHJlY2VpdmVfcXVldWUgKnJx
LCBzdHJ1Y3QgcGFnZSAqcGFnZSkKPiA+ID4gPiA+ID4gK3sKPiA+ID4gPiA+ID4gKyAgICAgICBp
ZiAocnEtPnBhZ2VfcG9vbCkKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgIHBhZ2VfcG9vbF9w
dXRfZnVsbF9wYWdlKHJxLT5wYWdlX3Bvb2wsIHBhZ2UsIHRydWUpOwo+ID4gPiA+ID4gPiArICAg
ICAgIGVsc2UKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOwo+ID4g
PiA+ID4gPiArfQo+ID4gPiA+ID4gPiArCj4gPiA+ID4gPiA+ICAvKiBDYWxsZWQgZnJvbSBib3R0
b20gaGFsZiBjb250ZXh0ICovCj4gPiA+ID4gPiA+ICBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKnBh
Z2VfdG9fc2tiKHN0cnVjdCB2aXJ0bmV0X2luZm8gKnZpLAo+ID4gPiA+ID4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCByZWNlaXZlX3F1ZXVlICpycSwKPiA+ID4g
PiA+ID4gQEAgLTU1NSw3ICs1NjksNyBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKnBhZ2VfdG9f
c2tiKHN0cnVjdCB2aXJ0bmV0X2luZm8gKnZpLAo+ID4gPiA+ID4gPiAgICAgICAgIGhkciA9IHNr
Yl92bmV0X2hkcihza2IpOwo+ID4gPiA+ID4gPiAgICAgICAgIG1lbWNweShoZHIsIGhkcl9wLCBo
ZHJfbGVuKTsKPiA+ID4gPiA+ID4gICAgICAgICBpZiAocGFnZV90b19mcmVlKQo+ID4gPiA+ID4g
PiAtICAgICAgICAgICAgICAgcHV0X3BhZ2UocGFnZV90b19mcmVlKTsKPiA+ID4gPiA+ID4gKyAg
ICAgICAgICAgICAgIHZpcnRuZXRfcHV0X3BhZ2UocnEsIHBhZ2VfdG9fZnJlZSk7Cj4gPiA+ID4g
PiA+Cj4gPiA+ID4gPiA+ICAgICAgICAgcmV0dXJuIHNrYjsKPiA+ID4gPiA+ID4gIH0KPiA+ID4g
PiA+ID4gQEAgLTgwMiw3ICs4MTYsNyBAQCBzdGF0aWMgaW50IHZpcnRuZXRfeGRwX3htaXQoc3Ry
dWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gPiA+ID4gICAgICAgICByZXR1cm4gcmV0Owo+ID4g
PiA+ID4gPiAgfQo+ID4gPiA+ID4gPgo+ID4gPiA+ID4gPiAtc3RhdGljIHZvaWQgcHV0X3hkcF9m
cmFncyhzdHJ1Y3QgeGRwX2J1ZmYgKnhkcCkKPiA+ID4gPiA+ID4gK3N0YXRpYyB2b2lkIHB1dF94
ZHBfZnJhZ3Moc3RydWN0IHhkcF9idWZmICp4ZHAsIHN0cnVjdCByZWNlaXZlX3F1ZXVlICpycSkK
PiA+ID4gPiA+ID4gIHsKPiA+ID4gPiA+Cj4gPiA+ID4gPiBycSBjb3VsZCBiZSBmZXRjaGVkIGZy
b20geGRwX3J4cV9pbmZvPwo+ID4gPiA+Cj4gPiA+ID4gWWVhaCwgaXQgaGFzIHRoZSBxdWV1ZV9p
bmRleCB0aGVyZS4KPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ICAgICAgICAgc3RydWN0IHNrYl9zaGFy
ZWRfaW5mbyAqc2hpbmZvOwo+ID4gPiA+ID4gPiAgICAgICAgIHN0cnVjdCBwYWdlICp4ZHBfcGFn
ZTsKPiA+ID4gPiA+ID4gQEAgLTgxMiw3ICs4MjYsNyBAQCBzdGF0aWMgdm9pZCBwdXRfeGRwX2Zy
YWdzKHN0cnVjdCB4ZHBfYnVmZiAqeGRwKQo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgc2hp
bmZvID0geGRwX2dldF9zaGFyZWRfaW5mb19mcm9tX2J1ZmYoeGRwKTsKPiA+ID4gPiA+ID4gICAg
ICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzaGluZm8tPm5yX2ZyYWdzOyBpKyspIHsKPiA+
ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgeGRwX3BhZ2UgPSBza2JfZnJhZ19wYWdl
KCZzaGluZm8tPmZyYWdzW2ldKTsKPiA+ID4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAg
cHV0X3BhZ2UoeGRwX3BhZ2UpOwo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICB2
aXJ0bmV0X3B1dF9wYWdlKHJxLCB4ZHBfcGFnZSk7Cj4gPiA+ID4gPiA+ICAgICAgICAgICAgICAg
ICB9Cj4gPiA+ID4gPiA+ICAgICAgICAgfQo+ID4gPiA+ID4gPiAgfQo+ID4gPiA+ID4gPiBAQCAt
OTAzLDcgKzkxNywxMSBAQCBzdGF0aWMgc3RydWN0IHBhZ2UgKnhkcF9saW5lYXJpemVfcGFnZShz
dHJ1Y3QgcmVjZWl2ZV9xdWV1ZSAqcnEsCj4gPiA+ID4gPiA+ICAgICAgICAgaWYgKHBhZ2Vfb2Zm
ICsgKmxlbiArIHRhaWxyb29tID4gUEFHRV9TSVpFKQo+ID4gPiA+ID4gPiAgICAgICAgICAgICAg
ICAgcmV0dXJuIE5VTEw7Cj4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+IC0gICAgICAgcGFnZSA9IGFs
bG9jX3BhZ2UoR0ZQX0FUT01JQyk7Cj4gPiA+ID4gPiA+ICsgICAgICAgaWYgKHJxLT5wYWdlX3Bv
b2wpCj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICBwYWdlID0gcGFnZV9wb29sX2Rldl9hbGxv
Y19wYWdlcyhycS0+cGFnZV9wb29sKTsKPiA+ID4gPiA+ID4gKyAgICAgICBlbHNlCj4gPiA+ID4g
PiA+ICsgICAgICAgICAgICAgICBwYWdlID0gYWxsb2NfcGFnZShHRlBfQVRPTUlDKTsKPiA+ID4g
PiA+ID4gKwo+ID4gPiA+ID4gPiAgICAgICAgIGlmICghcGFnZSkKPiA+ID4gPiA+ID4gICAgICAg
ICAgICAgICAgIHJldHVybiBOVUxMOwo+ID4gPiA+ID4gPgo+ID4gPiA+ID4gPiBAQCAtOTI2LDIx
ICs5NDQsMjQgQEAgc3RhdGljIHN0cnVjdCBwYWdlICp4ZHBfbGluZWFyaXplX3BhZ2Uoc3RydWN0
IHJlY2VpdmVfcXVldWUgKnJxLAo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgICogaXMgc2Vu
ZGluZyBwYWNrZXQgbGFyZ2VyIHRoYW4gdGhlIE1UVS4KPiA+ID4gPiA+ID4gICAgICAgICAgICAg
ICAgICAqLwo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgaWYgKChwYWdlX29mZiArIGJ1Zmxl
biArIHRhaWxyb29tKSA+IFBBR0VfU0laRSkgewo+ID4gPiA+ID4gPiAtICAgICAgICAgICAgICAg
ICAgICAgICBwdXRfcGFnZShwKTsKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAg
dmlydG5ldF9wdXRfcGFnZShycSwgcCk7Cj4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAgIGdvdG8gZXJyX2J1ZjsKPiA+ID4gPiA+ID4gICAgICAgICAgICAgICAgIH0KPiA+ID4gPiA+
ID4KPiA+ID4gPiA+ID4gICAgICAgICAgICAgICAgIG1lbWNweShwYWdlX2FkZHJlc3MocGFnZSkg
KyBwYWdlX29mZiwKPiA+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICBwYWdlX2FkZHJl
c3MocCkgKyBvZmYsIGJ1Zmxlbik7Cj4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgICBwYWdlX29m
ZiArPSBidWZsZW47Cj4gPiA+ID4gPiA+IC0gICAgICAgICAgICAgICBwdXRfcGFnZShwKTsKPiA+
ID4gPiA+ID4gKyAgICAgICAgICAgICAgIHZpcnRuZXRfcHV0X3BhZ2UocnEsIHApOwo+ID4gPiA+
ID4gPiAgICAgICAgIH0KPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gICAgICAgICAvKiBIZWFkcm9v
bSBkb2VzIG5vdCBjb250cmlidXRlIHRvIHBhY2tldCBsZW5ndGggKi8KPiA+ID4gPiA+ID4gICAg
ICAgICAqbGVuID0gcGFnZV9vZmYgLSBWSVJUSU9fWERQX0hFQURST09NOwo+ID4gPiA+ID4gPiAg
ICAgICAgIHJldHVybiBwYWdlOwo+ID4gPiA+ID4gPiAgZXJyX2J1ZjoKPiA+ID4gPiA+ID4gLSAg
ICAgICBfX2ZyZWVfcGFnZXMocGFnZSwgMCk7Cj4gPiA+ID4gPiA+ICsgICAgICAgaWYgKHJxLT5w
YWdlX3Bvb2wpCj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICBwYWdlX3Bvb2xfcHV0X2Z1bGxf
cGFnZShycS0+cGFnZV9wb29sLCBwYWdlLCB0cnVlKTsKPiA+ID4gPiA+ID4gKyAgICAgICBlbHNl
Cj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICBfX2ZyZWVfcGFnZXMocGFnZSwgMCk7Cj4gPiA+
ID4gPiA+ICAgICAgICAgcmV0dXJuIE5VTEw7Cj4gPiA+ID4gPiA+ICB9Cj4gPiA+ID4gPiA+Cj4g
PiA+ID4gPiA+IEBAIC0xMTQ0LDcgKzExNjUsNyBAQCBzdGF0aWMgdm9pZCBtZXJnZWFibGVfYnVm
X2ZyZWUoc3RydWN0IHJlY2VpdmVfcXVldWUgKnJxLCBpbnQgbnVtX2J1ZiwKPiA+ID4gPiA+ID4g
ICAgICAgICAgICAgICAgIH0KPiA+ID4gPiA+ID4gICAgICAgICAgICAgICAgIHN0YXRzLT5ieXRl
cyArPSBsZW47Cj4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgICBwYWdlID0gdmlydF90b19oZWFk
X3BhZ2UoYnVmKTsKPiA+ID4gPiA+ID4gLSAgICAgICAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOwo+
ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgdmlydG5ldF9wdXRfcGFnZShycSwgcGFnZSk7Cj4g
PiA+ID4gPiA+ICAgICAgICAgfQo+ID4gPiA+ID4gPiAgfQo+ID4gPiA+ID4gPgo+ID4gPiA+ID4g
PiBAQCAtMTI2NCw3ICsxMjg1LDcgQEAgc3RhdGljIGludCB2aXJ0bmV0X2J1aWxkX3hkcF9idWZm
X21yZyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAg
Y3VyX2ZyYWdfc2l6ZSA9IHRydWVzaXplOwo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgeGRw
X2ZyYWdzX3RydWVzeiArPSBjdXJfZnJhZ19zaXplOwo+ID4gPiA+ID4gPiAgICAgICAgICAgICAg
ICAgaWYgKHVubGlrZWx5KGxlbiA+IHRydWVzaXplIC0gcm9vbSB8fCBjdXJfZnJhZ19zaXplID4g
UEFHRV9TSVpFKSkgewo+ID4gPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBwdXRfcGFn
ZShwYWdlKTsKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgdmlydG5ldF9wdXRf
cGFnZShycSwgcGFnZSk7Cj4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIHByX2Rl
YnVnKCIlczogcnggZXJyb3I6IGxlbiAldSBleGNlZWRzIHRydWVzaXplICVsdVxuIiwKPiA+ID4g
PiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV2LT5uYW1lLCBsZW4sICh1
bnNpZ25lZCBsb25nKSh0cnVlc2l6ZSAtIHJvb20pKTsKPiA+ID4gPiA+ID4gICAgICAgICAgICAg
ICAgICAgICAgICAgZGV2LT5zdGF0cy5yeF9sZW5ndGhfZXJyb3JzKys7Cj4gPiA+ID4gPiA+IEBA
IC0xMjgzLDcgKzEzMDQsNyBAQCBzdGF0aWMgaW50IHZpcnRuZXRfYnVpbGRfeGRwX2J1ZmZfbXJn
KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gPiA+ID4gPiA+ICAgICAgICAgcmV0dXJuIDA7Cj4g
PiA+ID4gPiA+Cj4gPiA+ID4gPiA+ICBlcnI6Cj4gPiA+ID4gPiA+IC0gICAgICAgcHV0X3hkcF9m
cmFncyh4ZHApOwo+ID4gPiA+ID4gPiArICAgICAgIHB1dF94ZHBfZnJhZ3MoeGRwLCBycSk7Cj4g
PiA+ID4gPiA+ICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gPiA+ID4gPiA+ICB9Cj4gPiA+ID4g
PiA+Cj4gPiA+ID4gPiA+IEBAIC0xMzQ0LDcgKzEzNjUsMTAgQEAgc3RhdGljIHZvaWQgKm1lcmdl
YWJsZV94ZHBfZ2V0X2J1ZihzdHJ1Y3QgdmlydG5ldF9pbmZvICp2aSwKPiA+ID4gPiA+ID4gICAg
ICAgICAgICAgICAgIGlmICgqbGVuICsgeGRwX3Jvb20gPiBQQUdFX1NJWkUpCj4gPiA+ID4gPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBOVUxMOwo+ID4gPiA+ID4gPgo+ID4gPiA+
ID4gPiAtICAgICAgICAgICAgICAgeGRwX3BhZ2UgPSBhbGxvY19wYWdlKEdGUF9BVE9NSUMpOwo+
ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgaWYgKHJxLT5wYWdlX3Bvb2wpCj4gPiA+ID4gPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgIHhkcF9wYWdlID0gcGFnZV9wb29sX2Rldl9hbGxvY19w
YWdlcyhycS0+cGFnZV9wb29sKTsKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgIGVsc2UKPiA+
ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgeGRwX3BhZ2UgPSBhbGxvY19wYWdlKEdG
UF9BVE9NSUMpOwo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgaWYgKCF4ZHBfcGFnZSkKPiA+
ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7Cj4gPiA+ID4gPiA+
Cj4gPiA+ID4gPiA+IEBAIC0xMzU0LDcgKzEzNzgsNyBAQCBzdGF0aWMgdm9pZCAqbWVyZ2VhYmxl
X3hkcF9nZXRfYnVmKHN0cnVjdCB2aXJ0bmV0X2luZm8gKnZpLAo+ID4gPiA+ID4gPgo+ID4gPiA+
ID4gPiAgICAgICAgICpmcmFtZV9zeiA9IFBBR0VfU0laRTsKPiA+ID4gPiA+ID4KPiA+ID4gPiA+
ID4gLSAgICAgICBwdXRfcGFnZSgqcGFnZSk7Cj4gPiA+ID4gPiA+ICsgICAgICAgdmlydG5ldF9w
dXRfcGFnZShycSwgKnBhZ2UpOwo+ID4gPiA+ID4gPgo+ID4gPiA+ID4gPiAgICAgICAgICpwYWdl
ID0geGRwX3BhZ2U7Cj4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+IEBAIC0xNDAwLDYgKzE0MjQsOCBA
QCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKnJlY2VpdmVfbWVyZ2VhYmxlX3hkcChzdHJ1Y3QgbmV0
X2RldmljZSAqZGV2LAo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgaGVhZF9za2IgPSBidWls
ZF9za2JfZnJvbV94ZHBfYnVmZihkZXYsIHZpLCAmeGRwLCB4ZHBfZnJhZ3NfdHJ1ZXN6KTsKPiA+
ID4gPiA+ID4gICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghaGVhZF9za2IpKQo+ID4gPiA+
ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiA+ID4gPiA+ID4gKyAgICAgICAg
ICAgICAgIGlmIChycS0+cGFnZV9wb29sKQo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgICAg
ICAgICBza2JfbWFya19mb3JfcmVjeWNsZShoZWFkX3NrYik7Cj4gPiA+ID4gPiA+ICAgICAgICAg
ICAgICAgICByZXR1cm4gaGVhZF9za2I7Cj4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ICAgICAgICAg
Y2FzZSBYRFBfVFg6Cj4gPiA+ID4gPiA+IEBAIC0xNDEwLDEwICsxNDM2LDEwIEBAIHN0YXRpYyBz
dHJ1Y3Qgc2tfYnVmZiAqcmVjZWl2ZV9tZXJnZWFibGVfeGRwKHN0cnVjdCBuZXRfZGV2aWNlICpk
ZXYsCj4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgICBicmVhazsKPiA+ID4gPiA+ID4gICAgICAg
ICB9Cj4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+IC0gICAgICAgcHV0X3hkcF9mcmFncygmeGRwKTsK
PiA+ID4gPiA+ID4gKyAgICAgICBwdXRfeGRwX2ZyYWdzKCZ4ZHAsIHJxKTsKPiA+ID4gPiA+ID4K
PiA+ID4gPiA+ID4gIGVycl94ZHA6Cj4gPiA+ID4gPiA+IC0gICAgICAgcHV0X3BhZ2UocGFnZSk7
Cj4gPiA+ID4gPiA+ICsgICAgICAgdmlydG5ldF9wdXRfcGFnZShycSwgcGFnZSk7Cj4gPiA+ID4g
PiA+ICAgICAgICAgbWVyZ2VhYmxlX2J1Zl9mcmVlKHJxLCBudW1fYnVmLCBkZXYsIHN0YXRzKTsK
PiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gICAgICAgICBzdGF0cy0+eGRwX2Ryb3BzKys7Cj4gPiA+
ID4gPiA+IEBAIC0xNDY3LDYgKzE0OTMsOSBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKnJlY2Vp
dmVfbWVyZ2VhYmxlKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gPiA+ID4gPiA+ICAgICAgICAg
aGVhZF9za2IgPSBwYWdlX3RvX3NrYih2aSwgcnEsIHBhZ2UsIG9mZnNldCwgbGVuLCB0cnVlc2l6
ZSwgaGVhZHJvb20pOwo+ID4gPiA+ID4gPiAgICAgICAgIGN1cnJfc2tiID0gaGVhZF9za2I7Cj4g
PiA+ID4gPiA+Cj4gPiA+ID4gPiA+ICsgICAgICAgaWYgKHJxLT5wYWdlX3Bvb2wpCj4gPiA+ID4g
PiA+ICsgICAgICAgICAgICAgICBza2JfbWFya19mb3JfcmVjeWNsZShjdXJyX3NrYik7Cj4gPiA+
ID4gPiA+ICsKPiA+ID4gPiA+ID4gICAgICAgICBpZiAodW5saWtlbHkoIWN1cnJfc2tiKSkKPiA+
ID4gPiA+ID4gICAgICAgICAgICAgICAgIGdvdG8gZXJyX3NrYjsKPiA+ID4gPiA+ID4gICAgICAg
ICB3aGlsZSAoLS1udW1fYnVmKSB7Cj4gPiA+ID4gPiA+IEBAIC0xNTA5LDYgKzE1MzgsOCBAQCBz
dGF0aWMgc3RydWN0IHNrX2J1ZmYgKnJlY2VpdmVfbWVyZ2VhYmxlKHN0cnVjdCBuZXRfZGV2aWNl
ICpkZXYsCj4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfc2tiID0gbnNr
YjsKPiA+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgaGVhZF9za2ItPnRydWVzaXpl
ICs9IG5za2ItPnRydWVzaXplOwo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBu
dW1fc2tiX2ZyYWdzID0gMDsKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYg
KHJxLT5wYWdlX3Bvb2wpCj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc2tiX21hcmtfZm9yX3JlY3ljbGUoY3Vycl9za2IpOwo+ID4gPiA+ID4gPiAgICAgICAgICAg
ICAgICAgfQo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgaWYgKGN1cnJfc2tiICE9IGhlYWRf
c2tiKSB7Cj4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRfc2tiLT5kYXRh
X2xlbiArPSBsZW47Cj4gPiA+ID4gPiA+IEBAIC0xNTE3LDcgKzE1NDgsNyBAQCBzdGF0aWMgc3Ry
dWN0IHNrX2J1ZmYgKnJlY2VpdmVfbWVyZ2VhYmxlKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4g
PiA+ID4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgICBv
ZmZzZXQgPSBidWYgLSBwYWdlX2FkZHJlc3MocGFnZSk7Cj4gPiA+ID4gPiA+ICAgICAgICAgICAg
ICAgICBpZiAoc2tiX2Nhbl9jb2FsZXNjZShjdXJyX3NrYiwgbnVtX3NrYl9mcmFncywgcGFnZSwg
b2Zmc2V0KSkgewo+ID4gPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBwdXRfcGFnZShw
YWdlKTsKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgdmlydG5ldF9wdXRfcGFn
ZShycSwgcGFnZSk7Cj4gPiA+ID4gPgo+ID4gPiA+ID4gSSB3b25kZXIgd2h5IG5vdCB3ZSBjYW4n
dCBkbyB0aGlzIGR1cmluZyBidWZmZXIgYWxsb2NhdGlvbiBsaWtlIG90aGVyIGRyaXZlcnM/Cj4g
PiA+ID4gPgo+ID4gPiA+Cj4gPiA+ID4gU29ycnksIEkgZG9uJ3QgcXVpdGUgdW5kZXJzdGFuZCB0
aGUgcG9pbnQgaGVyZS4gV291bGQgeW91IHBsZWFzZQo+ID4gPiA+IGVsYWJvcmF0ZSBhIGJpdCBt
b3JlPwo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBza2JfY29hbGVzY2Vfcnhf
ZnJhZyhjdXJyX3NrYiwgbnVtX3NrYl9mcmFncyAtIDEsCj4gPiA+ID4gPiA+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbiwgdHJ1ZXNpemUpOwo+ID4gPiA+
ID4gPiAgICAgICAgICAgICAgICAgfSBlbHNlIHsKPiA+ID4gPiA+ID4gQEAgLTE1MzAsNyArMTU2
MSw3IEBAIHN0YXRpYyBzdHJ1Y3Qgc2tfYnVmZiAqcmVjZWl2ZV9tZXJnZWFibGUoc3RydWN0IG5l
dF9kZXZpY2UgKmRldiwKPiA+ID4gPiA+ID4gICAgICAgICByZXR1cm4gaGVhZF9za2I7Cj4gPiA+
ID4gPiA+Cj4gPiA+ID4gPiA+ICBlcnJfc2tiOgo+ID4gPiA+ID4gPiAtICAgICAgIHB1dF9wYWdl
KHBhZ2UpOwo+ID4gPiA+ID4gPiArICAgICAgIHZpcnRuZXRfcHV0X3BhZ2UocnEsIHBhZ2UpOwo+
ID4gPiA+ID4gPiAgICAgICAgIG1lcmdlYWJsZV9idWZfZnJlZShycSwgbnVtX2J1ZiwgZGV2LCBz
dGF0cyk7Cj4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ICBlcnJfYnVmOgo+ID4gPiA+ID4gPiBAQCAt
MTczNywzMSArMTc2OCw0MCBAQCBzdGF0aWMgaW50IGFkZF9yZWN2YnVmX21lcmdlYWJsZShzdHJ1
Y3QgdmlydG5ldF9pbmZvICp2aSwKPiA+ID4gPiA+ID4gICAgICAgICAgKiBkaXNhYmxlZCBHU08g
Zm9yIFhEUCwgaXQgd29uJ3QgYmUgYSBiaWcgaXNzdWUuCj4gPiA+ID4gPiA+ICAgICAgICAgICov
Cj4gPiA+ID4gPiA+ICAgICAgICAgbGVuID0gZ2V0X21lcmdlYWJsZV9idWZfbGVuKHJxLCAmcnEt
Pm1yZ19hdmdfcGt0X2xlbiwgcm9vbSk7Cj4gPiA+ID4gPiA+IC0gICAgICAgaWYgKHVubGlrZWx5
KCFza2JfcGFnZV9mcmFnX3JlZmlsbChsZW4gKyByb29tLCBhbGxvY19mcmFnLCBnZnApKSkKPiA+
ID4gPiA+ID4gLSAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+ID4gPiA+ID4gPiArICAg
ICAgIGlmIChycS0+cGFnZV9wb29sKSB7Cj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICBzdHJ1
Y3QgcGFnZSAqcGFnZTsKPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gLSAgICAgICBidWYgPSAoY2hh
ciAqKXBhZ2VfYWRkcmVzcyhhbGxvY19mcmFnLT5wYWdlKSArIGFsbG9jX2ZyYWctPm9mZnNldDsK
PiA+ID4gPiA+ID4gLSAgICAgICBidWYgKz0gaGVhZHJvb207IC8qIGFkdmFuY2UgYWRkcmVzcyBs
ZWF2aW5nIGhvbGUgYXQgZnJvbnQgb2YgcGt0ICovCj4gPiA+ID4gPiA+IC0gICAgICAgZ2V0X3Bh
Z2UoYWxsb2NfZnJhZy0+cGFnZSk7Cj4gPiA+ID4gPiA+IC0gICAgICAgYWxsb2NfZnJhZy0+b2Zm
c2V0ICs9IGxlbiArIHJvb207Cj4gPiA+ID4gPiA+IC0gICAgICAgaG9sZSA9IGFsbG9jX2ZyYWct
PnNpemUgLSBhbGxvY19mcmFnLT5vZmZzZXQ7Cj4gPiA+ID4gPiA+IC0gICAgICAgaWYgKGhvbGUg
PCBsZW4gKyByb29tKSB7Cj4gPiA+ID4gPiA+IC0gICAgICAgICAgICAgICAvKiBUbyBhdm9pZCBp
bnRlcm5hbCBmcmFnbWVudGF0aW9uLCBpZiB0aGVyZSBpcyB2ZXJ5IGxpa2VseSBub3QKPiA+ID4g
PiA+ID4gLSAgICAgICAgICAgICAgICAqIGVub3VnaCBzcGFjZSBmb3IgYW5vdGhlciBidWZmZXIs
IGFkZCB0aGUgcmVtYWluaW5nIHNwYWNlIHRvCj4gPiA+ID4gPiA+IC0gICAgICAgICAgICAgICAg
KiB0aGUgY3VycmVudCBidWZmZXIuCj4gPiA+ID4gPiA+IC0gICAgICAgICAgICAgICAgKiBYRFAg
Y29yZSBhc3N1bWVzIHRoYXQgZnJhbWVfc2l6ZSBvZiB4ZHBfYnVmZiBhbmQgdGhlIGxlbmd0aAo+
ID4gPiA+ID4gPiAtICAgICAgICAgICAgICAgICogb2YgdGhlIGZyYWcgYXJlIFBBR0VfU0laRSwg
c28gd2UgZGlzYWJsZSB0aGUgaG9sZSBtZWNoYW5pc20uCj4gPiA+ID4gPiA+IC0gICAgICAgICAg
ICAgICAgKi8KPiA+ID4gPiA+ID4gLSAgICAgICAgICAgICAgIGlmICghaGVhZHJvb20pCj4gPiA+
ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGxlbiArPSBob2xlOwo+ID4gPiA+ID4gPiAt
ICAgICAgICAgICAgICAgYWxsb2NfZnJhZy0+b2Zmc2V0ICs9IGhvbGU7Cj4gPiA+ID4gPiA+IC0g
ICAgICAgfQo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgcGFnZSA9IHBhZ2VfcG9vbF9kZXZf
YWxsb2NfcGFnZXMocnEtPnBhZ2VfcG9vbCk7Cj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICBp
ZiAodW5saWtlbHkoIXBhZ2UpKQo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBy
ZXR1cm4gLUVOT01FTTsKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgIGJ1ZiA9IChjaGFyICop
cGFnZV9hZGRyZXNzKHBhZ2UpOwo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgYnVmICs9IGhl
YWRyb29tOyAvKiBhZHZhbmNlIGFkZHJlc3MgbGVhdmluZyBob2xlIGF0IGZyb250IG9mIHBrdCAq
Lwo+ID4gPiA+ID4gPiArICAgICAgIH0gZWxzZSB7Cj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAg
ICBpZiAodW5saWtlbHkoIXNrYl9wYWdlX2ZyYWdfcmVmaWxsKGxlbiArIHJvb20sIGFsbG9jX2Zy
YWcsIGdmcCkpKQo+ID4gPiA+ID4KPiA+ID4gPiA+IFdoeSBub3Qgc2ltcGx5IHVzZSBhIGhlbHBl
ciBsaWtlIHZpcnRuZXRfcGFnZV9mcmFnX3JlZmlsbCgpIGFuZCBhZGQKPiA+ID4gPiA+IHRoZSBw
YWdlX3Bvb2wgYWxsb2NhdGlvbiBsb2dpYyB0aGVyZT8gSXQgaGVscHMgdG8gcmVkdWNlIHRoZQo+
ID4gPiA+ID4gY2hhbmdlc2V0Lgo+ID4gPiA+ID4KPiA+ID4gPgo+ID4gPiA+IFN1cmUuIFdpbGwg
ZG8gdGhhdCBvbiB2Mi4KPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu
IC1FTk9NRU07Cj4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICBidWYgPSAo
Y2hhciAqKXBhZ2VfYWRkcmVzcyhhbGxvY19mcmFnLT5wYWdlKSArIGFsbG9jX2ZyYWctPm9mZnNl
dDsKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgIGJ1ZiArPSBoZWFkcm9vbTsgLyogYWR2YW5j
ZSBhZGRyZXNzIGxlYXZpbmcgaG9sZSBhdCBmcm9udCBvZiBwa3QgKi8KPiA+ID4gPiA+ID4gKyAg
ICAgICAgICAgICAgIGdldF9wYWdlKGFsbG9jX2ZyYWctPnBhZ2UpOwo+ID4gPiA+ID4gPiArICAg
ICAgICAgICAgICAgYWxsb2NfZnJhZy0+b2Zmc2V0ICs9IGxlbiArIHJvb207Cj4gPiA+ID4gPiA+
ICsgICAgICAgICAgICAgICBob2xlID0gYWxsb2NfZnJhZy0+c2l6ZSAtIGFsbG9jX2ZyYWctPm9m
ZnNldDsKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChob2xlIDwgbGVuICsgcm9vbSkg
ewo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAvKiBUbyBhdm9pZCBpbnRlcm5h
bCBmcmFnbWVudGF0aW9uLCBpZiB0aGVyZSBpcyB2ZXJ5IGxpa2VseSBub3QKPiA+ID4gPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICogZW5vdWdoIHNwYWNlIGZvciBhbm90aGVyIGJ1ZmZl
ciwgYWRkIHRoZSByZW1haW5pbmcgc3BhY2UgdG8KPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICogdGhlIGN1cnJlbnQgYnVmZmVyLgo+ID4gPiA+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgKiBYRFAgY29yZSBhc3N1bWVzIHRoYXQgZnJhbWVfc2l6ZSBvZiB4ZHBfYnVm
ZiBhbmQgdGhlIGxlbmd0aAo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgKiBv
ZiB0aGUgZnJhZyBhcmUgUEFHRV9TSVpFLCBzbyB3ZSBkaXNhYmxlIHRoZSBob2xlIG1lY2hhbmlz
bS4KPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICovCj4gPiA+ID4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGlmICghaGVhZHJvb20pCj4gPiA+ID4gPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbGVuICs9IGhvbGU7Cj4gPiA+ID4gPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGFsbG9jX2ZyYWctPm9mZnNldCArPSBob2xlOwo+ID4gPiA+ID4gPiAr
ICAgICAgICAgICAgICAgfQo+ID4gPiA+ID4gPiArICAgICAgIH0KPiA+ID4gPiA+ID4gICAgICAg
ICBzZ19pbml0X29uZShycS0+c2csIGJ1ZiwgbGVuKTsKPiA+ID4gPiA+ID4gICAgICAgICBjdHgg
PSBtZXJnZWFibGVfbGVuX3RvX2N0eChsZW4gKyByb29tLCBoZWFkcm9vbSk7Cj4gPiA+ID4gPiA+
ICAgICAgICAgZXJyID0gdmlydHF1ZXVlX2FkZF9pbmJ1Zl9jdHgocnEtPnZxLCBycS0+c2csIDEs
IGJ1ZiwgY3R4LCBnZnApOwo+ID4gPiA+ID4gPiAgICAgICAgIGlmIChlcnIgPCAwKQo+ID4gPiA+
ID4gPiAtICAgICAgICAgICAgICAgcHV0X3BhZ2UodmlydF90b19oZWFkX3BhZ2UoYnVmKSk7Cj4g
PiA+ID4gPiA+ICsgICAgICAgICAgICAgICB2aXJ0bmV0X3B1dF9wYWdlKHJxLCB2aXJ0X3RvX2hl
YWRfcGFnZShidWYpKTsKPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gICAgICAgICByZXR1cm4gZXJy
Owo+ID4gPiA+ID4gPiAgfQo+ID4gPiA+ID4gPiBAQCAtMTk5NCw4ICsyMDM0LDE1IEBAIHN0YXRp
YyBpbnQgdmlydG5ldF9lbmFibGVfcXVldWVfcGFpcihzdHJ1Y3QgdmlydG5ldF9pbmZvICp2aSwg
aW50IHFwX2luZGV4KQo+ID4gPiA+ID4gPiAgICAgICAgIGlmIChlcnIgPCAwKQo+ID4gPiA+ID4g
PiAgICAgICAgICAgICAgICAgcmV0dXJuIGVycjsKPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gLSAg
ICAgICBlcnIgPSB4ZHBfcnhxX2luZm9fcmVnX21lbV9tb2RlbCgmdmktPnJxW3FwX2luZGV4XS54
ZHBfcnhxLAo+ID4gPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIE1FTV9UWVBFX1BBR0VfU0hBUkVELCBOVUxMKTsKPiA+ID4gPiA+ID4gKyAgICAgICBpZiAo
dmktPnJxW3FwX2luZGV4XS5wYWdlX3Bvb2wpCj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICBl
cnIgPSB4ZHBfcnhxX2luZm9fcmVnX21lbV9tb2RlbCgmdmktPnJxW3FwX2luZGV4XS54ZHBfcnhx
LAo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgTUVNX1RZUEVfUEFHRV9QT09MLAo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmktPnJxW3FwX2luZGV4XS5wYWdlX3Bvb2wp
Owo+ID4gPiA+ID4gPiArICAgICAgIGVsc2UKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgIGVy
ciA9IHhkcF9yeHFfaW5mb19yZWdfbWVtX21vZGVsKCZ2aS0+cnFbcXBfaW5kZXhdLnhkcF9yeHEs
Cj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBNRU1fVFlQRV9QQUdFX1NIQVJFRCwKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwpOwo+ID4gPiA+ID4gPiArCj4gPiA+
ID4gPiA+ICAgICAgICAgaWYgKGVyciA8IDApCj4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgICBn
b3RvIGVycl94ZHBfcmVnX21lbV9tb2RlbDsKPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gQEAgLTI5
NTEsNiArMjk5OCw3IEBAIHN0YXRpYyB2b2lkIHZpcnRuZXRfZ2V0X3N0cmluZ3Moc3RydWN0IG5l
dF9kZXZpY2UgKmRldiwgdTMyIHN0cmluZ3NldCwgdTggKmRhdGEpCj4gPiA+ID4gPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgZXRodG9vbF9zcHJpbnRmKCZwLCAidHhfcXVldWVf
JXVfJXMiLCBpLAo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB2aXJ0bmV0X3NxX3N0YXRzX2Rlc2Nbal0uZGVzYyk7Cj4gPiA+ID4gPiA+
ICAgICAgICAgICAgICAgICB9Cj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICBwYWdlX3Bvb2xf
ZXRodG9vbF9zdGF0c19nZXRfc3RyaW5ncyhwKTsKPiA+ID4gPiA+ID4gICAgICAgICAgICAgICAg
IGJyZWFrOwo+ID4gPiA+ID4gPiAgICAgICAgIH0KPiA+ID4gPiA+ID4gIH0KPiA+ID4gPiA+ID4g
QEAgLTI5NjIsMTIgKzMwMTAsMzAgQEAgc3RhdGljIGludCB2aXJ0bmV0X2dldF9zc2V0X2NvdW50
KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIGludCBzc2V0KQo+ID4gPiA+ID4gPiAgICAgICAgIHN3
aXRjaCAoc3NldCkgewo+ID4gPiA+ID4gPiAgICAgICAgIGNhc2UgRVRIX1NTX1NUQVRTOgo+ID4g
PiA+ID4gPiAgICAgICAgICAgICAgICAgcmV0dXJuIHZpLT5jdXJyX3F1ZXVlX3BhaXJzICogKFZJ
UlRORVRfUlFfU1RBVFNfTEVOICsKPiA+ID4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBWSVJUTkVUX1NRX1NUQVRTX0xFTik7Cj4gPiA+ID4gPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVklSVE5FVF9T
UV9TVEFUU19MRU4gKwo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAocGFnZV9wb29sX2VuYWJsZWQgJiYgdmktPm1lcmdlYWJsZV9yeF9i
dWZzID8KPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHBhZ2VfcG9vbF9ldGh0b29sX3N0YXRzX2dldF9jb3VudCgpIDogMCkpOwo+ID4g
PiA+ID4gPiAgICAgICAgIGRlZmF1bHQ6Cj4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgICByZXR1
cm4gLUVPUE5PVFNVUFA7Cj4gPiA+ID4gPiA+ICAgICAgICAgfQo+ID4gPiA+ID4gPiAgfQo+ID4g
PiA+ID4gPgo+ID4gPiA+ID4gPiArc3RhdGljIHZvaWQgdmlydG5ldF9nZXRfcGFnZV9wb29sX3N0
YXRzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHU2NCAqZGF0YSkKPiA+ID4gPiA+ID4gK3sKPiA+
ID4gPiA+ID4gKyNpZmRlZiBDT05GSUdfUEFHRV9QT09MX1NUQVRTCj4gPiA+ID4gPiA+ICsgICAg
ICAgc3RydWN0IHZpcnRuZXRfaW5mbyAqdmkgPSBuZXRkZXZfcHJpdihkZXYpOwo+ID4gPiA+ID4g
PiArICAgICAgIHN0cnVjdCBwYWdlX3Bvb2xfc3RhdHMgcHBfc3RhdHMgPSB7fTsKPiA+ID4gPiA+
ID4gKyAgICAgICBpbnQgaTsKPiA+ID4gPiA+ID4gKwo+ID4gPiA+ID4gPiArICAgICAgIGZvciAo
aSA9IDA7IGkgPCB2aS0+Y3Vycl9xdWV1ZV9wYWlyczsgaSsrKSB7Cj4gPiA+ID4gPiA+ICsgICAg
ICAgICAgICAgICBpZiAoIXZpLT5ycVtpXS5wYWdlX3Bvb2wpCj4gPiA+ID4gPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGNvbnRpbnVlOwo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgcGFn
ZV9wb29sX2dldF9zdGF0cyh2aS0+cnFbaV0ucGFnZV9wb29sLCAmcHBfc3RhdHMpOwo+ID4gPiA+
ID4gPiArICAgICAgIH0KPiA+ID4gPiA+ID4gKyAgICAgICBwYWdlX3Bvb2xfZXRodG9vbF9zdGF0
c19nZXQoZGF0YSwgJnBwX3N0YXRzKTsKPiA+ID4gPiA+ID4gKyNlbmRpZiAvKiBDT05GSUdfUEFH
RV9QT09MX1NUQVRTICovCj4gPiA+ID4gPiA+ICt9Cj4gPiA+ID4gPiA+ICsKPiA+ID4gPiA+ID4g
IHN0YXRpYyB2b2lkIHZpcnRuZXRfZ2V0X2V0aHRvb2xfc3RhdHMoc3RydWN0IG5ldF9kZXZpY2Ug
KmRldiwKPiA+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3QgZXRodG9vbF9zdGF0cyAqc3RhdHMsIHU2NCAqZGF0YSkKPiA+ID4gPiA+ID4gIHsKPiA+
ID4gPiA+ID4gQEAgLTMwMDMsNiArMzA2OSw4IEBAIHN0YXRpYyB2b2lkIHZpcnRuZXRfZ2V0X2V0
aHRvb2xfc3RhdHMoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gPiA+ID4gICAgICAgICAg
ICAgICAgIH0gd2hpbGUgKHU2NF9zdGF0c19mZXRjaF9yZXRyeSgmc3EtPnN0YXRzLnN5bmNwLCBz
dGFydCkpOwo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgaWR4ICs9IFZJUlRORVRfU1FfU1RB
VFNfTEVOOwo+ID4gPiA+ID4gPiAgICAgICAgIH0KPiA+ID4gPiA+ID4gKwo+ID4gPiA+ID4gPiAr
ICAgICAgIHZpcnRuZXRfZ2V0X3BhZ2VfcG9vbF9zdGF0cyhkZXYsICZkYXRhW2lkeF0pOwo+ID4g
PiA+ID4gPiAgfQo+ID4gPiA+ID4gPgo+ID4gPiA+ID4gPiAgc3RhdGljIHZvaWQgdmlydG5ldF9n
ZXRfY2hhbm5lbHMoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gPiA+ID4gQEAgLTM2MjMs
NiArMzY5MSw4IEBAIHN0YXRpYyB2b2lkIHZpcnRuZXRfZnJlZV9xdWV1ZXMoc3RydWN0IHZpcnRu
ZXRfaW5mbyAqdmkpCj4gPiA+ID4gPiA+ICAgICAgICAgZm9yIChpID0gMDsgaSA8IHZpLT5tYXhf
cXVldWVfcGFpcnM7IGkrKykgewo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgX19uZXRpZl9u
YXBpX2RlbCgmdmktPnJxW2ldLm5hcGkpOwo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgX19u
ZXRpZl9uYXBpX2RlbCgmdmktPnNxW2ldLm5hcGkpOwo+ID4gPiA+ID4gPiArICAgICAgICAgICAg
ICAgaWYgKHZpLT5ycVtpXS5wYWdlX3Bvb2wpCj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgIHBhZ2VfcG9vbF9kZXN0cm95KHZpLT5ycVtpXS5wYWdlX3Bvb2wpOwo+ID4gPiA+ID4g
PiAgICAgICAgIH0KPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gICAgICAgICAvKiBXZSBjYWxsZWQg
X19uZXRpZl9uYXBpX2RlbCgpLAo+ID4gPiA+ID4gPiBAQCAtMzY3OSwxMiArMzc0OSwxOSBAQCBz
dGF0aWMgdm9pZCB2aXJ0bmV0X3JxX2ZyZWVfdW51c2VkX2J1ZihzdHJ1Y3QgdmlydHF1ZXVlICp2
cSwgdm9pZCAqYnVmKQo+ID4gPiA+ID4gPiAgICAgICAgIHN0cnVjdCB2aXJ0bmV0X2luZm8gKnZp
ID0gdnEtPnZkZXYtPnByaXY7Cj4gPiA+ID4gPiA+ICAgICAgICAgaW50IGkgPSB2cTJyeHEodnEp
Owo+ID4gPiA+ID4gPgo+ID4gPiA+ID4gPiAtICAgICAgIGlmICh2aS0+bWVyZ2VhYmxlX3J4X2J1
ZnMpCj4gPiA+ID4gPiA+IC0gICAgICAgICAgICAgICBwdXRfcGFnZSh2aXJ0X3RvX2hlYWRfcGFn
ZShidWYpKTsKPiA+ID4gPiA+ID4gLSAgICAgICBlbHNlIGlmICh2aS0+YmlnX3BhY2tldHMpCj4g
PiA+ID4gPiA+ICsgICAgICAgaWYgKHZpLT5tZXJnZWFibGVfcnhfYnVmcykgewo+ID4gPiA+ID4g
PiArICAgICAgICAgICAgICAgaWYgKHZpLT5ycVtpXS5wYWdlX3Bvb2wpIHsKPiA+ID4gPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgcGFnZV9wb29sX3B1dF9mdWxsX3BhZ2UodmktPnJxW2ld
LnBhZ2VfcG9vbCwKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdmlydF90b19oZWFkX3BhZ2UoYnVmKSwKPiA+ID4gPiA+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSk7Cj4gPiA+ID4g
PiA+ICsgICAgICAgICAgICAgICB9IGVsc2Ugewo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAg
ICAgICAgICBwdXRfcGFnZSh2aXJ0X3RvX2hlYWRfcGFnZShidWYpKTsKPiA+ID4gPiA+ID4gKyAg
ICAgICAgICAgICAgIH0KPiA+ID4gPiA+ID4gKyAgICAgICB9IGVsc2UgaWYgKHZpLT5iaWdfcGFj
a2V0cykgewo+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgZ2l2ZV9wYWdlcygmdmktPnJxW2ld
LCBidWYpOwo+ID4gPiA+ID4KPiA+ID4gPiA+IEFueSByZWFzb24gb25seSBtZXJnZWFibGUgd2Vy
ZSBtb2RpZmllZCBidXQgbm90IGZvciBzbWFsbCBhbmQgYmlnPwo+ID4gPiA+ID4KPiA+ID4gPiA+
IFRoYW5rcwo+ID4gPiA+ID4KPiA+ID4gPgo+ID4gPiA+IEJpZyBtb2RlIHVzZXMgdGhlIHBhZ2Ug
Y2hhaW4gdG8gcmVjeWNsZSBwYWdlcywgdGh1cyB0aGUgdXNpbmcgb2YKPiA+ID4gPiAicHJpdmF0
ZSIgb2YgdGhlIGJ1ZmZlciBwYWdlLiBJIHdpbGwgdGFrZSBmdXJ0aGVyIGxvb2sgaW50byB0aGF0
IHRvCj4gPiA+ID4gc2VlIGlmIGl0IGlzIGJldHRlciB0byB1c2UgcGFnZSBwb29sIGluIHRoZXNl
IGNhc2VzLiBUaGFua3MhCj4gPiA+ID4KPiA+ID4gPgo+ID4gPiA+Cj4gPiA+ID4gPiA+IC0gICAg
ICAgZWxzZQo+ID4gPiA+ID4gPiArICAgICAgIH0gZWxzZSB7Cj4gPiA+ID4gPiA+ICAgICAgICAg
ICAgICAgICBwdXRfcGFnZSh2aXJ0X3RvX2hlYWRfcGFnZShidWYpKTsKPiA+ID4gPiA+ID4gKyAg
ICAgICB9Cj4gPiA+ID4gPiA+ICB9Cj4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ICBzdGF0aWMgdm9p
ZCBmcmVlX3VudXNlZF9idWZzKHN0cnVjdCB2aXJ0bmV0X2luZm8gKnZpKQo+ID4gPiA+ID4gPiBA
QCAtMzcxOCw2ICszNzk1LDI2IEBAIHN0YXRpYyB2b2lkIHZpcnRuZXRfZGVsX3ZxcyhzdHJ1Y3Qg
dmlydG5ldF9pbmZvICp2aSkKPiA+ID4gPiA+ID4gICAgICAgICB2aXJ0bmV0X2ZyZWVfcXVldWVz
KHZpKTsKPiA+ID4gPiA+ID4gIH0KPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gK3N0YXRpYyB2b2lk
IHZpcnRuZXRfYWxsb2NfcGFnZV9wb29sKHN0cnVjdCByZWNlaXZlX3F1ZXVlICpycSkKPiA+ID4g
PiA+ID4gK3sKPiA+ID4gPiA+ID4gKyAgICAgICBzdHJ1Y3QgdmlydGlvX2RldmljZSAqdmRldiA9
IHJxLT52cS0+dmRldjsKPiA+ID4gPiA+ID4gKwo+ID4gPiA+ID4gPiArICAgICAgIHN0cnVjdCBw
YWdlX3Bvb2xfcGFyYW1zIHBwX3BhcmFtcyA9IHsKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAg
IC5vcmRlciA9IDAsCj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICAucG9vbF9zaXplID0gcnEt
PnZxLT5udW1fbWF4LAo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgLm5pZCA9IGRldl90b19u
b2RlKHZkZXYtPmRldi5wYXJlbnQpLAo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgLmRldiA9
IHZkZXYtPmRldi5wYXJlbnQsCj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICAub2Zmc2V0ID0g
MCwKPiA+ID4gPiA+ID4gKyAgICAgICB9Owo+ID4gPiA+ID4gPiArCj4gPiA+ID4gPiA+ICsgICAg
ICAgcnEtPnBhZ2VfcG9vbCA9IHBhZ2VfcG9vbF9jcmVhdGUoJnBwX3BhcmFtcyk7Cj4gPiA+ID4g
PiA+ICsgICAgICAgaWYgKElTX0VSUihycS0+cGFnZV9wb29sKSkgewo+ID4gPiA+ID4gPiArICAg
ICAgICAgICAgICAgZGV2X3dhcm4oJnZkZXYtPmRldiwgInBhZ2UgcG9vbCBjcmVhdGlvbiBmYWls
ZWQ6ICVsZFxuIiwKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgIFBUUl9FUlIo
cnEtPnBhZ2VfcG9vbCkpOwo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgcnEtPnBhZ2VfcG9v
bCA9IE5VTEw7Cj4gPiA+ID4gPiA+ICsgICAgICAgfQo+ID4gPiA+ID4gPiArfQo+ID4gPiA+ID4g
PiArCj4gPiA+ID4gPiA+ICAvKiBIb3cgbGFyZ2Ugc2hvdWxkIGEgc2luZ2xlIGJ1ZmZlciBiZSBz
byBhIHF1ZXVlIGZ1bGwgb2YgdGhlc2UgY2FuIGZpdCBhdAo+ID4gPiA+ID4gPiAgICogbGVhc3Qg
b25lIGZ1bGwgcGFja2V0Pwo+ID4gPiA+ID4gPiAgICogTG9naWMgYmVsb3cgYXNzdW1lcyB0aGUg
bWVyZ2VhYmxlIGJ1ZmZlciBoZWFkZXIgaXMgdXNlZC4KPiA+ID4gPiA+ID4gQEAgLTM4MDEsNiAr
Mzg5OCwxMyBAQCBzdGF0aWMgaW50IHZpcnRuZXRfZmluZF92cXMoc3RydWN0IHZpcnRuZXRfaW5m
byAqdmkpCj4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgICB2aS0+cnFbaV0udnEgPSB2cXNbcnhx
MnZxKGkpXTsKPiA+ID4gPiA+ID4gICAgICAgICAgICAgICAgIHZpLT5ycVtpXS5taW5fYnVmX2xl
biA9IG1lcmdlYWJsZV9taW5fYnVmX2xlbih2aSwgdmktPnJxW2ldLnZxKTsKPiA+ID4gPiA+ID4g
ICAgICAgICAgICAgICAgIHZpLT5zcVtpXS52cSA9IHZxc1t0eHEydnEoaSldOwo+ID4gPiA+ID4g
PiArCj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICBpZiAocGFnZV9wb29sX2VuYWJsZWQgJiYg
dmktPm1lcmdlYWJsZV9yeF9idWZzKQo+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICB2aXJ0bmV0X2FsbG9jX3BhZ2VfcG9vbCgmdmktPnJxW2ldKTsKPiA+ID4gPiA+ID4gKyAgICAg
ICAgICAgICAgIGVsc2UKPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZGV2X3dh
cm4oJnZpLT52ZGV2LT5kZXYsCj4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICJwYWdlIHBvb2wgb25seSBzdXBwb3J0IG1lcmdlYWJsZSBtb2RlXG4iKTsKPiA+ID4g
PiA+ID4gKwo+ID4gPiA+ID4gPiAgICAgICAgIH0KPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gICAg
ICAgICAvKiBydW4gaGVyZTogcmV0ID09IDAuICovCj4gPiA+ID4gPiA+IC0tCj4gPiA+ID4gPiA+
IDIuMzEuMQo+ID4gPiA+ID4gPgo+ID4gPiA+ID4KPiA+ID4KX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZp
cnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGlu
dXhmb3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u

