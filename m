Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
	by mail.lfdr.de (Postfix) with ESMTPS id 8F3701978FE
	for <lists.virtualization@lfdr.de>; Mon, 30 Mar 2020 12:20:48 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by whitealder.osuosl.org (Postfix) with ESMTP id 34D1F8757F;
	Mon, 30 Mar 2020 10:20:47 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id R7xf0T1oOIIj; Mon, 30 Mar 2020 10:20:39 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by whitealder.osuosl.org (Postfix) with ESMTP id 411EE87D51;
	Mon, 30 Mar 2020 10:20:15 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 2C7D8C07FF;
	Mon, 30 Mar 2020 10:20:15 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id E71CAC07FF
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:20:07 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by silver.osuosl.org (Postfix) with ESMTP id D21522036D
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:20:07 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id XbJyREs4qmdr
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:58 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by silver.osuosl.org (Postfix) with ESMTPS id 9C80A231CB
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:54 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 410FF305FFA0; Mon, 30 Mar 2020 13:12:56 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 28588305B7A0;
 Mon, 30 Mar 2020 13:12:56 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v8 46/81] KVM: introspection: add KVMI_VM_CONTROL_EVENTS
Date: Mon, 30 Mar 2020 13:12:33 +0300
Message-Id: <20200330101308.21702-47-alazar@bitdefender.com>
In-Reply-To: <20200330101308.21702-1-alazar@bitdefender.com>
References: <20200330101308.21702-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>, virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

V2l0aCB0aGlzIGNvbW1hbmQgdGhlIGludHJvc3BlY3Rpb24gdG9vbCBlbmFibGVzL2Rpc2FibGVz
IFZNIGV2ZW50cwooaWUuIEtWTUlfRVZFTlRfVU5IT09LKS4KCkJ5IGRlZmF1bHQsIGFsbCBldmVu
dHMgYXJlIGRpc2FibGVkLgoKU2lnbmVkLW9mZi1ieTogQWRhbGJlcnQgTGF6xINyIDxhbGF6YXJA
Yml0ZGVmZW5kZXIuY29tPgotLS0KIERvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QgICAg
ICAgICAgICAgICB8IDQ0ICsrKysrKysrKysrKystLQogaW5jbHVkZS9saW51eC9rdm1pX2hvc3Qu
aCAgICAgICAgICAgICAgICAgICAgIHwgIDIgKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCAg
ICAgICAgICAgICAgICAgICAgIHwgMTggKysrKystLQogLi4uL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2
bS94ODZfNjQva3ZtaV90ZXN0LmMgIHwgNTQgKysrKysrKysrKysrKysrKysrKwogdmlydC9rdm0v
aW50cm9zcGVjdGlvbi9rdm1pLmMgICAgICAgICAgICAgICAgIHwgMjEgKysrKysrKy0KIHZpcnQv
a3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCAgICAgICAgICAgICB8ICAzICsrCiB2aXJ0L2t2
bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgICAgICAgICAgICAgfCAzMSArKysrKysrKystLQog
NyBmaWxlcyBjaGFuZ2VkLCAxNTkgaW5zZXJ0aW9ucygrKSwgMTQgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdCBiL0RvY3VtZW50YXRpb24v
dmlydC9rdm0va3ZtaS5yc3QKaW5kZXggZTY1MmJkZDY1MDUyLi43YTQ3ZmFkZTdmMDggMTAwNjQ0
Ci0tLSBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKKysrIGIvRG9jdW1lbnRhdGlv
bi92aXJ0L2t2bS9rdm1pLnJzdApAQCAtMzQwLDExICszNDAsNDUgQEAgVGhpcyBjb21tYW5kIGlz
IGFsd2F5cyBhbGxvd2VkLgogCiBSZXR1cm5zIHRoZSBudW1iZXIgb2Ygb25saW5lIHZDUFVzLgog
Cis1LiBLVk1JX1ZNX0NPTlRST0xfRVZFTlRTCistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisK
KzpBcmNoaXRlY3R1cmVzOiBhbGwKKzpWZXJzaW9uczogPj0gMQorOlBhcmFtZXRlcnM6CisKKzo6
CisKKwlzdHJ1Y3Qga3ZtaV92bV9jb250cm9sX2V2ZW50cyB7CisJCV9fdTE2IGV2ZW50X2lkOwor
CQlfX3U4IGVuYWJsZTsKKwkJX191OCBwYWRkaW5nMTsKKwkJX191MzIgcGFkZGluZzI7CisJfTsK
KworOlJldHVybnM6CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV9lcnJvcl9jb2RlCisKK0VuYWJsZXMv
ZGlzYWJsZXMgVk0gaW50cm9zcGVjdGlvbiBldmVudHMuIFRoaXMgY29tbWFuZCBjYW4gYmUgdXNl
ZCB3aXRoCit0aGUgZm9sbG93aW5nIGV2ZW50czo6CisKKwlLVk1JX0VWRU5UX1VOSE9PSworCis6
RXJyb3JzOgorCisqIC1LVk1fRUlOVkFMIC0gdGhlIHBhZGRpbmcgaXMgbm90IHplcm8KKyogLUtW
TV9FSU5WQUwgLSB0aGUgZXZlbnQgSUQgaXMgdW5rbm93biAodXNlICpLVk1JX1ZNX0NIRUNLX0VW
RU5UKiBmaXJzdCkKKyogLUtWTV9FUEVSTSAtIHRoZSBhY2Nlc3MgaXMgZGlzYWxsb3dlZCAodXNl
ICpLVk1JX1ZNX0NIRUNLX0VWRU5UKiBmaXJzdCkKKwogRXZlbnRzCiA9PT09PT0KIAogQWxsIGlu
dHJvc3BlY3Rpb24gZXZlbnRzIChWTSBvciB2Q1BVIHJlbGF0ZWQpIGFyZSBzZW50Ci11c2luZyB0
aGUgKktWTUlfRVZFTlQqIG1lc3NhZ2UgaWQuCit1c2luZyB0aGUgKktWTUlfRVZFTlQqIG1lc3Nh
Z2UgaWQuIE5vIGV2ZW50IHdpbGwgYmUgc2VudCB1bmxlc3MKK2l0IGlzIGV4cGxpY2l0bHkgZW5h
YmxlZC4KIAogVGhlICpLVk1JX0VWRU5UX1VOSE9PSyogZXZlbnQgZG9lc24ndCBoYXZlIGEgcmVw
bHkgYW5kIHNoYXJlIHRoZSBrdm1pX2V2ZW50CiBzdHJ1Y3R1cmUsIGZvciBjb25zaXN0ZW5jeSB3
aXRoIHRoZSB2Q1BVIGV2ZW50cy4KQEAgLTM5OCw2ICs0MzIsOCBAQCBTcGVjaWZpYyBkYXRhIGNh
biBmb2xsb3cgdGhlc2UgY29tbW9uIHN0cnVjdHVyZXMuCiAKIDpSZXR1cm5zOiBub25lCiAKLVRo
aXMgZXZlbnQgaXMgc2VudCB3aGVuIHRoZSBkZXZpY2UgbWFuYWdlciBoYXMgdG8gcGF1c2Uvc3Rv
cC9taWdyYXRlIHRoZQotZ3Vlc3QgKHNlZSAqKlVuaG9va2luZyoqKS4gIFRoZSBpbnRyb3NwZWN0
aW9uIHRvb2wgaGFzIGEgY2hhbmNlIHRvIHVuaG9vawotYW5kIGNsb3NlIHRoZSBLVk1JIGNoYW5u
ZWwgKHNpZ25hbGluZyB0aGF0IHRoZSBvcGVyYXRpb24gY2FuIHByb2NlZWQpLgorVGhpcyBldmVu
dCBpcyBzZW50IHdoZW4gdGhlIGRldmljZSBtYW5hZ2VyIGhhcyB0byBwYXVzZS9zdG9wL21pZ3Jh
dGUKK3RoZSBndWVzdCAoc2VlICoqVW5ob29raW5nKiopIGFuZCB0aGUgaW50cm9zcGVjdGlvbiBo
YXMgYmVlbiBlbmFibGVkCitmb3IgdGhpcyBldmVudCAoc2VlICoqS1ZNSV9WTV9DT05UUk9MX0VW
RU5UUyoqKS4gVGhlIGludHJvc3BlY3Rpb24gdG9vbAoraGFzIGEgY2hhbmNlIHRvIHVuaG9vayBh
bmQgY2xvc2UgdGhlIEtWTUkgY2hhbm5lbCAoc2lnbmFsaW5nIHRoYXQgdGhlCitvcGVyYXRpb24g
Y2FuIHByb2NlZWQpLgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaCBiL2lu
Y2x1ZGUvbGludXgva3ZtaV9ob3N0LmgKaW5kZXggMTgwZTI2MzM1YThmLi40MWIyMmFmNzcxZmIg
MTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmgKKysrIGIvaW5jbHVkZS9saW51
eC9rdm1pX2hvc3QuaApAQCAtMjIsNiArMjIsOCBAQCBzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24g
ewogCURFQ0xBUkVfQklUTUFQKGNtZF9hbGxvd19tYXNrLCBLVk1JX05VTV9DT01NQU5EUyk7CiAJ
REVDTEFSRV9CSVRNQVAoZXZlbnRfYWxsb3dfbWFzaywgS1ZNSV9OVU1fRVZFTlRTKTsKIAorCURF
Q0xBUkVfQklUTUFQKHZtX2V2ZW50X2VuYWJsZV9tYXNrLCBLVk1JX05VTV9FVkVOVFMpOworCiAJ
YXRvbWljX3QgZXZfc2VxOwogfTsKIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2
bWkuaCBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKaW5kZXggNjg5ZWJhMzJjMDMxLi42NmUw
NGE4MmYwNTQgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKKysrIGIvaW5j
bHVkZS91YXBpL2xpbnV4L2t2bWkuaApAQCAtMTUsMTIgKzE1LDEzIEBAIGVudW0gewogfTsKIAog
ZW51bSB7Ci0JS1ZNSV9FVkVOVCAgICAgICAgICAgID0gMSwKKwlLVk1JX0VWRU5UICAgICAgICAg
ICAgID0gMSwKIAotCUtWTUlfR0VUX1ZFUlNJT04gICAgICA9IDIsCi0JS1ZNSV9WTV9DSEVDS19D
T01NQU5EID0gMywKLQlLVk1JX1ZNX0NIRUNLX0VWRU5UICAgPSA0LAotCUtWTUlfVk1fR0VUX0lO
Rk8gICAgICA9IDUsCisJS1ZNSV9HRVRfVkVSU0lPTiAgICAgICA9IDIsCisJS1ZNSV9WTV9DSEVD
S19DT01NQU5EICA9IDMsCisJS1ZNSV9WTV9DSEVDS19FVkVOVCAgICA9IDQsCisJS1ZNSV9WTV9H
RVRfSU5GTyAgICAgICA9IDUsCisJS1ZNSV9WTV9DT05UUk9MX0VWRU5UUyA9IDYsCiAKIAlLVk1J
X05VTV9NRVNTQUdFUwogfTsKQEAgLTc1LDYgKzc2LDEzIEBAIHN0cnVjdCBrdm1pX3ZtX2dldF9p
bmZvX3JlcGx5IHsKIAlfX3UzMiBwYWRkaW5nWzNdOwogfTsKIAorc3RydWN0IGt2bWlfdm1fY29u
dHJvbF9ldmVudHMgeworCV9fdTE2IGV2ZW50X2lkOworCV9fdTggZW5hYmxlOworCV9fdTggcGFk
ZGluZzE7CisJX191MzIgcGFkZGluZzI7Cit9OworCiBzdHJ1Y3Qga3ZtaV9ldmVudCB7CiAJX191
MTYgc2l6ZTsKIAlfX3UxNiB2Y3B1OwpkaWZmIC0tZ2l0IGEvdG9vbHMvdGVzdGluZy9zZWxmdGVz
dHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94
ODZfNjQva3ZtaV90ZXN0LmMKaW5kZXggOWNiNjVmOGM5NDZmLi5jM2JlZWEzZmViMjYgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKKysr
IGIvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYwpAQCAtMjQ1
LDkgKzI0NSwxNSBAQCBzdGF0aWMgaW50IGNtZF9jaGVja19ldmVudChfX3UxNiBpZCkKIAogc3Rh
dGljIHZvaWQgdGVzdF9jbWRfY2hlY2tfZXZlbnQodm9pZCkKIHsKKwlfX3UxNiB2YWxpZF9pZCA9
IEtWTUlfRVZFTlRfVU5IT09LOwogCV9fdTE2IGludmFsaWRfaWQgPSAweGZmZmY7CiAJaW50IHI7
CiAKKwlyID0gY21kX2NoZWNrX2V2ZW50KHZhbGlkX2lkKTsKKwlURVNUX0FTU0VSVChyID09IDAs
CisJCSJLVk1JX1ZNX0NIRUNLX0VWRU5UIGZhaWxlZCwgZXJyb3IgJWQgKCVzKVxuIiwKKwkJLXIs
IGt2bV9zdHJlcnJvcigtcikpOworCiAJciA9IGNtZF9jaGVja19ldmVudChpbnZhbGlkX2lkKTsK
IAlURVNUX0FTU0VSVChyID09IC1LVk1fRU5PRU5ULAogCQkiS1ZNSV9WTV9DSEVDS19FVkVOVCBk
aWRuJ3QgZmFpbGVkIHdpdGggLUtWTV9FTk9FTlQsIGVycm9yICVkICglcylcbiIsCkBAIC0yOTgs
MTUgKzMwNCw2MiBAQCBzdGF0aWMgdm9pZCByZWNlaXZlX2V2ZW50KHN0cnVjdCBrdm1pX21zZ19o
ZHIgKmhkciwgc3RydWN0IGt2bWlfZXZlbnQgKmV2LAogCQlldi0+ZXZlbnQsIGV2ZW50X2lkKTsK
IH0KIAorc3RhdGljIGludCBjbWRfdm1fY29udHJvbF9ldmVudHMoX191MTYgZXZlbnRfaWQsIGJv
b2wgZW5hYmxlKQoreworCXN0cnVjdCB7CisJCXN0cnVjdCBrdm1pX21zZ19oZHIgaGRyOworCQlz
dHJ1Y3Qga3ZtaV92bV9jb250cm9sX2V2ZW50cyBjbWQ7CisJfSByZXEgPSB7fTsKKworCXJlcS5j
bWQuZXZlbnRfaWQgPSBldmVudF9pZDsKKwlyZXEuY21kLmVuYWJsZSA9IGVuYWJsZSA/IDEgOiAw
OworCisJcmV0dXJuIGRvX2NvbW1hbmQoS1ZNSV9WTV9DT05UUk9MX0VWRU5UUywgJnJlcS5oZHIs
IHNpemVvZihyZXEpLAorCQkJICAgICBOVUxMLCAwKTsKK30KKworc3RhdGljIHZvaWQgZW5hYmxl
X3ZtX2V2ZW50KF9fdTE2IGV2ZW50X2lkKQoreworCWludCByOworCisJciA9IGNtZF92bV9jb250
cm9sX2V2ZW50cyhldmVudF9pZCwgdHJ1ZSk7CisJVEVTVF9BU1NFUlQociA9PSAwLAorCQkiS1ZN
SV9WTV9DT05UUk9MX0VWRU5UUyBmYWlsZWQgdG8gZW5hYmxlIFZNIGV2ZW50ICVkLCBlcnJvciAl
ZCAoJXMpXG4iLAorCQlldmVudF9pZCwgLXIsIGt2bV9zdHJlcnJvcigtcikpOworfQorCitzdGF0
aWMgdm9pZCBkaXNhYmxlX3ZtX2V2ZW50KF9fdTE2IGV2ZW50X2lkKQoreworCWludCByOworCisJ
ciA9IGNtZF92bV9jb250cm9sX2V2ZW50cyhldmVudF9pZCwgZmFsc2UpOworCVRFU1RfQVNTRVJU
KHIgPT0gMCwKKwkJIktWTUlfVk1fQ09OVFJPTF9FVkVOVFMgZmFpbGVkIHRvIGRpc2FibGUgVk0g
ZXZlbnQgJWQsIGVycm9yICVkICglcylcbiIsCisJCWV2ZW50X2lkLCAtciwga3ZtX3N0cmVycm9y
KC1yKSk7Cit9CisKIHN0YXRpYyB2b2lkIHRlc3RfZXZlbnRfdW5ob29rKHN0cnVjdCBrdm1fdm0g
KnZtKQogewogCV9fdTE2IGlkID0gS1ZNSV9FVkVOVF9VTkhPT0s7CiAJc3RydWN0IGt2bWlfbXNn
X2hkciBoZHI7CiAJc3RydWN0IGt2bWlfZXZlbnQgZXY7CiAKKwllbmFibGVfdm1fZXZlbnQoaWQp
OworCiAJdHJpZ2dlcl9ldmVudF91bmhvb2tfbm90aWZpY2F0aW9uKHZtKTsKIAogCXJlY2VpdmVf
ZXZlbnQoJmhkciwgJmV2LCBzaXplb2YoZXYpLCBpZCk7CisKKwlkaXNhYmxlX3ZtX2V2ZW50KGlk
KTsKK30KKworc3RhdGljIHZvaWQgdGVzdF9jbWRfdm1fY29udHJvbF9ldmVudHModm9pZCkKK3sK
KwlfX3UxNiBpZCA9IEtWTUlfRVZFTlRfVU5IT09LOworCisJZW5hYmxlX3ZtX2V2ZW50KGlkKTsK
KworCWRpc2FibGVfdm1fZXZlbnQoaWQpOwogfQogCiBzdGF0aWMgdm9pZCB0ZXN0X2ludHJvc3Bl
Y3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCkBAIC0zMjAsNiArMzczLDcgQEAgc3RhdGljIHZvaWQg
dGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQogCXRlc3RfY21kX2NoZWNrX2V2
ZW50KCk7CiAJdGVzdF9jbWRfZ2V0X3ZtX2luZm8oKTsKIAl0ZXN0X2V2ZW50X3VuaG9vayh2bSk7
CisJdGVzdF9jbWRfdm1fY29udHJvbF9ldmVudHMoKTsKIAogCXVuaG9va19pbnRyb3NwZWN0aW9u
KHZtKTsKIH0KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jIGIvdmly
dC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKaW5kZXggYmY2ZDVlYzk1MWM4Li5lYzQ1MTViZTVh
Y2MgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCisrKyBiL3ZpcnQv
a3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCkBAIC0xMiw3ICsxMiw3IEBACiAKIHN0YXRpYyBERUNM
QVJFX0JJVE1BUChLdm1pX2Fsd2F5c19hbGxvd2VkX2NvbW1hbmRzLCBLVk1JX05VTV9DT01NQU5E
Uyk7CiBERUNMQVJFX0JJVE1BUChLdm1pX2tub3duX2V2ZW50cywgS1ZNSV9OVU1fRVZFTlRTKTsK
LXN0YXRpYyBERUNMQVJFX0JJVE1BUChLdm1pX2tub3duX3ZtX2V2ZW50cywgS1ZNSV9OVU1fRVZF
TlRTKTsKK0RFQ0xBUkVfQklUTUFQKEt2bWlfa25vd25fdm1fZXZlbnRzLCBLVk1JX05VTV9FVkVO
VFMpOwogc3RhdGljIERFQ0xBUkVfQklUTUFQKEt2bWlfa25vd25fdmNwdV9ldmVudHMsIEtWTUlf
TlVNX0VWRU5UUyk7CiAKIHN0YXRpYyBzdHJ1Y3Qga21lbV9jYWNoZSAqbXNnX2NhY2hlOwpAQCAt
MzYwLDEwICszNjAsMTggQEAgaW50IGt2bWlfaW9jdGxfY29tbWFuZChzdHJ1Y3Qga3ZtICprdm0s
IHZvaWQgX191c2VyICphcmdwKQogCXJldHVybiBlcnI7CiB9CiAKK3N0YXRpYyBib29sIGlzX3Zt
X2V2ZW50X2VuYWJsZWQoc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pLCBpbnQgZXZlbnQp
Cit7CisJcmV0dXJuIHRlc3RfYml0KGV2ZW50LCBrdm1pLT52bV9ldmVudF9lbmFibGVfbWFzayk7
Cit9CisKIHN0YXRpYyBib29sIGt2bWlfdW5ob29rX2V2ZW50KHN0cnVjdCBrdm1faW50cm9zcGVj
dGlvbiAqa3ZtaSkKIHsKIAlpbnQgZXJyOwogCisJaWYgKCFpc192bV9ldmVudF9lbmFibGVkKGt2
bWksIEtWTUlfRVZFTlRfVU5IT09LKSkKKwkJcmV0dXJuIGZhbHNlOworCiAJZXJyID0ga3ZtaV9t
c2dfc2VuZF91bmhvb2soa3ZtaSk7CiAKIAlyZXR1cm4gIWVycjsKQEAgLTM4OSwzICszOTcsMTQg
QEAgaW50IGt2bWlfaW9jdGxfcHJldW5ob29rKHN0cnVjdCBrdm0gKmt2bSkKIAltdXRleF91bmxv
Y2soJmt2bS0+a3ZtaV9sb2NrKTsKIAlyZXR1cm4gZXJyOwogfQorCitpbnQga3ZtaV9jbWRfdm1f
Y29udHJvbF9ldmVudHMoc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pLAorCQkJCXVuc2ln
bmVkIGludCBldmVudF9pZCwgYm9vbCBlbmFibGUpCit7CisJaWYgKGVuYWJsZSkKKwkJc2V0X2Jp
dChldmVudF9pZCwga3ZtaS0+dm1fZXZlbnRfZW5hYmxlX21hc2spOworCWVsc2UKKwkJY2xlYXJf
Yml0KGV2ZW50X2lkLCBrdm1pLT52bV9ldmVudF9lbmFibGVfbWFzayk7CisKKwlyZXR1cm4gMDsK
K30KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCBiL3ZpcnQv
a3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaAppbmRleCBlY2QwNjI1ZTBjOWUuLjc1MDc4MjQ4
YTY5YyAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCisrKyBi
L3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaApAQCAtMTcsNiArMTcsNyBAQAogCWt2
bV9pbmZvKCIlcFUgRVJST1I6ICIgZm10LCAma3ZtaS0+dXVpZCwgIyMgX19WQV9BUkdTX18pCiAK
IGV4dGVybiBERUNMQVJFX0JJVE1BUChLdm1pX2tub3duX2V2ZW50cywgS1ZNSV9OVU1fRVZFTlRT
KTsKK2V4dGVybiBERUNMQVJFX0JJVE1BUChLdm1pX2tub3duX3ZtX2V2ZW50cywgS1ZNSV9OVU1f
RVZFTlRTKTsKIAogI2RlZmluZSBLVk1JKGt2bSkgKChrdm0pLT5rdm1pKQogCkBAIC0zMCw1ICsz
MSw3IEBAIGludCBrdm1pX21zZ19zZW5kX3VuaG9vayhzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24g
Kmt2bWkpOwogLyoga3ZtaS5jICovCiB2b2lkICprdm1pX21zZ19hbGxvYyh2b2lkKTsKIHZvaWQg
a3ZtaV9tc2dfZnJlZSh2b2lkICphZGRyKTsKK2ludCBrdm1pX2NtZF92bV9jb250cm9sX2V2ZW50
cyhzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWksCisJCQkJdW5zaWduZWQgaW50IGV2ZW50
X2lkLCBib29sIGVuYWJsZSk7CiAKICNlbmRpZgpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9z
cGVjdGlvbi9rdm1pX21zZy5jIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCmlu
ZGV4IGIzODEyNzNiNzM1NS4uNGQ4OTdjNjUwODViIDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRy
b3NwZWN0aW9uL2t2bWlfbXNnLmMKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21z
Zy5jCkBAIC0xNzEsMTUgKzE3MSwzOCBAQCBzdGF0aWMgaW50IGhhbmRsZV9nZXRfaW5mbyhzdHJ1
Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWksCiAJcmV0dXJuIGt2bWlfbXNnX3ZtX3JlcGx5KGt2
bWksIG1zZywgMCwgJnJwbCwgc2l6ZW9mKHJwbCkpOwogfQogCitzdGF0aWMgaW50IGhhbmRsZV92
bV9jb250cm9sX2V2ZW50cyhzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWksCisJCQkJICAg
IGNvbnN0IHN0cnVjdCBrdm1pX21zZ19oZHIgKm1zZywKKwkJCQkgICAgY29uc3Qgdm9pZCAqX3Jl
cSkKK3sKKwljb25zdCBzdHJ1Y3Qga3ZtaV92bV9jb250cm9sX2V2ZW50cyAqcmVxID0gX3JlcTsK
KwlpbnQgZWM7CisKKwlpZiAocmVxLT5wYWRkaW5nMSB8fCByZXEtPnBhZGRpbmcyIHx8IHJlcS0+
ZW5hYmxlID4gMSkKKwkJZWMgPSAtS1ZNX0VJTlZBTDsKKwllbHNlIGlmIChyZXEtPmV2ZW50X2lk
ID49IEtWTUlfTlVNX0VWRU5UUykKKwkJZWMgPSAtS1ZNX0VJTlZBTDsKKwllbHNlIGlmICghdGVz
dF9iaXQocmVxLT5ldmVudF9pZCwgS3ZtaV9rbm93bl92bV9ldmVudHMpKQorCQllYyA9IC1LVk1f
RUlOVkFMOworCWVsc2UgaWYgKCFpc19ldmVudF9hbGxvd2VkKGt2bWksIHJlcS0+ZXZlbnRfaWQp
KQorCQllYyA9IC1LVk1fRVBFUk07CisJZWxzZQorCQllYyA9IGt2bWlfY21kX3ZtX2NvbnRyb2xf
ZXZlbnRzKGt2bWksIHJlcS0+ZXZlbnRfaWQsCisJCQkJCQlyZXEtPmVuYWJsZSA9PSAxKTsKKwor
CXJldHVybiBrdm1pX21zZ192bV9yZXBseShrdm1pLCBtc2csIGVjLCBOVUxMLCAwKTsKK30KKwog
LyoKICAqIFRoZXNlIGNvbW1hbmRzIGFyZSBleGVjdXRlZCBieSB0aGUgcmVjZWl2aW5nIHRocmVh
ZC93b3JrZXIuCiAgKi8KIHN0YXRpYyBpbnQoKmNvbnN0IG1zZ192bVtdKShzdHJ1Y3Qga3ZtX2lu
dHJvc3BlY3Rpb24gKiwKIAkJCSAgICBjb25zdCBzdHJ1Y3Qga3ZtaV9tc2dfaGRyICosIGNvbnN0
IHZvaWQgKikgPSB7Ci0JW0tWTUlfR0VUX1ZFUlNJT05dICAgICAgPSBoYW5kbGVfZ2V0X3ZlcnNp
b24sCi0JW0tWTUlfVk1fQ0hFQ0tfQ09NTUFORF0gPSBoYW5kbGVfY2hlY2tfY29tbWFuZCwKLQlb
S1ZNSV9WTV9DSEVDS19FVkVOVF0gICA9IGhhbmRsZV9jaGVja19ldmVudCwKLQlbS1ZNSV9WTV9H
RVRfSU5GT10gICAgICA9IGhhbmRsZV9nZXRfaW5mbywKKwlbS1ZNSV9HRVRfVkVSU0lPTl0gICAg
ICAgPSBoYW5kbGVfZ2V0X3ZlcnNpb24sCisJW0tWTUlfVk1fQ0hFQ0tfQ09NTUFORF0gID0gaGFu
ZGxlX2NoZWNrX2NvbW1hbmQsCisJW0tWTUlfVk1fQ0hFQ0tfRVZFTlRdICAgID0gaGFuZGxlX2No
ZWNrX2V2ZW50LAorCVtLVk1JX1ZNX0NPTlRST0xfRVZFTlRTXSA9IGhhbmRsZV92bV9jb250cm9s
X2V2ZW50cywKKwlbS1ZNSV9WTV9HRVRfSU5GT10gICAgICAgPSBoYW5kbGVfZ2V0X2luZm8sCiB9
OwogCiBzdGF0aWMgYm9vbCBpc192bV9jb21tYW5kKHUxNiBpZCkKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0
ClZpcnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMu
bGludXhmb3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
