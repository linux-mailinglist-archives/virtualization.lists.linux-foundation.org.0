Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
	by mail.lfdr.de (Postfix) with ESMTPS id C8BD11978E2
	for <lists.virtualization@lfdr.de>; Mon, 30 Mar 2020 12:20:21 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by hemlock.osuosl.org (Postfix) with ESMTP id 6E3D2884EE;
	Mon, 30 Mar 2020 10:20:20 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id TzAgwQD0oNdb; Mon, 30 Mar 2020 10:20:15 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by hemlock.osuosl.org (Postfix) with ESMTP id 96E43884F5;
	Mon, 30 Mar 2020 10:20:13 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 6B4AEC1D7E;
	Mon, 30 Mar 2020 10:20:13 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
 by lists.linuxfoundation.org (Postfix) with ESMTP id A1D96C07FF
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:57 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by whitealder.osuosl.org (Postfix) with ESMTP id 9B84187C0A
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:57 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id hrmqsQsCk9Ji
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:52 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by whitealder.osuosl.org (Postfix) with ESMTPS id 5D51F8757F
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:52 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 8997F307503B; Mon, 30 Mar 2020 13:12:59 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 393E6305B7A2;
 Mon, 30 Mar 2020 13:12:59 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v8 65/81] KVM: introspection: add KVMI_VCPU_INJECT_EXCEPTION +
 KVMI_EVENT_TRAP
Date: Mon, 30 Mar 2020 13:12:52 +0300
Message-Id: <20200330101308.21702-66-alazar@bitdefender.com>
In-Reply-To: <20200330101308.21702-1-alazar@bitdefender.com>
References: <20200330101308.21702-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <ncitu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhlIEtWTUlfVkNQ
VV9JTkpFQ1RfRVhDRVBUSU9OIGNvbW1hbmQgaXMgdXNlZCBieSB0aGUgaW50cm9zcGVjdGlvbiB0
b29sCnRvIGluamVjdCBleGNlcHRpb25zLCBmb3IgZXhhbXBsZSwgdG8gZ2V0IGEgcGFnZSBmcm9t
IHN3YXAuCgpUaGUgZXhjZXB0aW9uIGlzIHF1ZXVlZCByaWdodCBiZWZvcmUgZW50ZXJpbmcgdGhl
IGd1ZXN0IHVubGVzcyB0aGVyZSBpcwphbHJlYWR5IGFuIGV4Y2VwdGlvbiBwZW5kaW5nLiBUaGUg
aW50cm9zcGVjdGlvbiB0b29sIGlzIG5vdGlmaWVkIHdpdGgKYW4gS1ZNSV9FVkVOVF9UUkFQIGV2
ZW50IGFib3V0IHRoZSBzdWNjZXNzIG9mIHRoZSBpbmplY3Rpb24uICBJbiBjYXNlCm9mIGZhaWx1
cmUsIHRoZSBpbnRyb3NwZWNpb24gdG9vbCBpcyBleHBlY3RlZCB0byB0cnkgYWdhaW4gbGF0ZXIu
CgpTaWduZWQtb2ZmLWJ5OiBNaWhhaSBEb27Im3UgPG1kb250dUBiaXRkZWZlbmRlci5jb20+CkNv
LWRldmVsb3BlZC1ieTogTmljdciZb3IgQ8OuyJt1IDxuY2l0dUBiaXRkZWZlbmRlci5jb20+ClNp
Z25lZC1vZmYtYnk6IE5pY3XImW9yIEPDrsibdSA8bmNpdHVAYml0ZGVmZW5kZXIuY29tPgpDby1k
ZXZlbG9wZWQtYnk6IEFkYWxiZXJ0IExhesSDciA8YWxhemFyQGJpdGRlZmVuZGVyLmNvbT4KU2ln
bmVkLW9mZi1ieTogQWRhbGJlcnQgTGF6xINyIDxhbGF6YXJAYml0ZGVmZW5kZXIuY29tPgotLS0K
IERvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QgICAgICAgICAgICAgICB8ICA3NCArKysr
KysrKysrKysKIGFyY2gveDg2L2luY2x1ZGUvdWFwaS9hc20va3ZtaS5oICAgICAgICAgICAgICB8
ICAxNCArKysKIGFyY2gveDg2L2t2bS9rdm1pLmMgICAgICAgICAgICAgICAgICAgICAgICAgICB8
IDEwMyArKysrKysrKysrKysrKysrKwogYXJjaC94ODYva3ZtL3g4Ni5jICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHwgICAzICsKIGluY2x1ZGUvbGludXgva3ZtaV9ob3N0LmggICAgICAgICAg
ICAgICAgICAgICB8ICAxMiArKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCAgICAgICAgICAg
ICAgICAgICAgIHwgIDE2ICstLQogLi4uL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3Zt
aV90ZXN0LmMgIHwgMTA5ICsrKysrKysrKysrKysrKysrLQogdmlydC9rdm0vaW50cm9zcGVjdGlv
bi9rdm1pLmMgICAgICAgICAgICAgICAgIHwgIDQ2ICsrKysrKysrCiB2aXJ0L2t2bS9pbnRyb3Nw
ZWN0aW9uL2t2bWlfaW50LmggICAgICAgICAgICAgfCAgIDggKysKIHZpcnQva3ZtL2ludHJvc3Bl
Y3Rpb24va3ZtaV9tc2cuYyAgICAgICAgICAgICB8ICA4MSArKysrKysrKystLS0tCiAxMCBmaWxl
cyBjaGFuZ2VkLCA0MzMgaW5zZXJ0aW9ucygrKSwgMzMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0
IGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdCBiL0RvY3VtZW50YXRpb24vdmlydC9r
dm0va3ZtaS5yc3QKaW5kZXggYzYyNGFiNTliZDBlLi5kNmEwOWZhYzRmNTIgMTAwNjQ0Ci0tLSBh
L0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKKysrIGIvRG9jdW1lbnRhdGlvbi92aXJ0
L2t2bS9rdm1pLnJzdApAQCAtNTU3LDYgKzU1Nyw3IEBAIFRoZSBmb2xsb3dpbmcgdkNQVSBldmVu
dHMgZG8gbm90IG5lZWQgdG8gYmUgZW5hYmxlZCBvciBkaXNhYmxlZCwKIGJlY2F1c2UgdGhlc2Ug
YXJlIHNlbnQgYXMgYSByZXN1bHQgb2YgY2VydGFpbiBjb21tYW5kczo6CiAKIAlLVk1JX0VWRU5U
X1BBVVNFX1ZDUFUKKwlLVk1JX0VWRU5UX1RSQVAKIAogSG93ZXZlciwgdGhlIGV2ZW50cyBtZW50
aW9uZWQgYWJvdmUgY2FuIGJlIGRpc2FsbG93ZWQuCiAKQEAgLTcxNSw2ICs3MTYsNDYgQEAgSUQg
c2V0LgogKiAtS1ZNX0VJTlZBTCAtIHRoZSBwYWRkaW5nIGlzIG5vdCB6ZXJvCiAqIC1LVk1fRUFH
QUlOIC0gdGhlIHNlbGVjdGVkIHZDUFUgY2FuJ3QgYmUgaW50cm9zcGVjdGVkIHlldAogCisxNS4g
S1ZNSV9WQ1BVX0lOSkVDVF9FWENFUFRJT04KKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQorCis6QXJjaGl0ZWN0dXJlczogeDg2Cis6VmVyc2lvbnM6ID49IDEKKzpQYXJhbWV0ZXJzOgor
Cis6OgorCisJc3RydWN0IGt2bWlfdmNwdV9oZHI7CisJc3RydWN0IGt2bWlfdmNwdV9pbmplY3Rf
ZXhjZXB0aW9uIHsKKwkJX191OCBucjsKKwkJX191OCBwYWRkaW5nMTsKKwkJX191MTYgcGFkZGlu
ZzI7CisJCV9fdTMyIGVycm9yX2NvZGU7CisJCV9fdTY0IGFkZHJlc3M7CisJfTsKKworOlJldHVy
bnM6CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV9lcnJvcl9jb2RlCisKK0luamVjdHMgYSB2Q1BVIGV4
Y2VwdGlvbiB3aXRoIG9yIHdpdGhvdXQgYW4gZXJyb3IgY29kZS4gSW4gY2FzZSBvZiBwYWdlIGZh
dWx0CitleGNlcHRpb24sIHRoZSBndWVzdCB2aXJ0dWFsIGFkZHJlc3MgaGFzIHRvIGJlIHNwZWNp
ZmllZC4KKworVGhlICpLVk1JX0VWRU5UX1RSQVAqIGV2ZW50IHdpbGwgYmUgc2VudCB3aXRoIHRo
ZSBlZmZlY3RpdmUgaW5qZWN0ZWQgZXhwZWN0aW9uLgorCis6RXJyb3JzOgorCisqIC1LVk1fRVBF
Uk0gIC0gdGhlICpLVk1JX0VWRU5UX1RSQVAqIGV2ZW50IGlzIGRpc2FsbG93ZWQKKyogLUtWTV9F
SU5WQUwgLSB0aGUgc2VsZWN0ZWQgdkNQVSBpcyBpbnZhbGlkCisqIC1LVk1fRUlOVkFMIC0gdGhl
IHNwZWNpZmllZCBleGNlcHRpb24gbnVtYmVyIGlzIGludmFsaWQKKyogLUtWTV9FSU5WQUwgLSB0
aGUgc3BlY2lmaWVkIGFkZHJlc3MgaXMgaW52YWxpZAorKiAtS1ZNX0VJTlZBTCAtIHRoZSBwYWRk
aW5nIGlzIG5vdCB6ZXJvCisqIC1LVk1fRUFHQUlOIC0gdGhlIHNlbGVjdGVkIHZDUFUgY2FuJ3Qg
YmUgaW50cm9zcGVjdGVkIHlldAorKiAtS1ZNX0VCVVNZIC0gYW5vdGhlciAqS1ZNSV9WQ1BVX0lO
SkVDVF9FWENFUFRJT04qLSpLVk1JX0VWRU5UX1RSQVAqIHBhaXIKKyAgICAgICAgICAgICAgIGlz
IGluIHByb2dyZXNzCisKIEV2ZW50cwogPT09PT09CiAKQEAgLTkyNSwzICs5NjYsMzYgQEAgcmVn
aXN0ZXIgKHNlZSAqKktWTUlfVkNQVV9DT05UUk9MX0VWRU5UUyoqKS4KIAogYGBrdm1pX2V2ZW50
YGAsIHRoZSBjb250cm9sIHJlZ2lzdGVyIG51bWJlciwgdGhlIG9sZCB2YWx1ZSBhbmQgdGhlIG5l
dyB2YWx1ZQogYXJlIHNlbnQgdG8gdGhlIGludHJvc3BlY3Rpb24gdG9vbC4gVGhlICpDT05USU5V
RSogYWN0aW9uIHdpbGwgc2V0IHRoZSBgYG5ld192YWxgYC4KKworNi4gS1ZNSV9FVkVOVF9UUkFQ
CistLS0tLS0tLS0tLS0tLS0tLS0KKworOkFyY2hpdGVjdHVyZXM6IHg4NgorOlZlcnNpb25zOiA+
PSAxCis6QWN0aW9uczogQ09OVElOVUUsIENSQVNICis6UGFyYW1ldGVyczoKKworOjoKKworCXN0
cnVjdCBrdm1pX2V2ZW50OworCXN0cnVjdCBrdm1pX2V2ZW50X3RyYXAgeworCQlfX3UzMiB2ZWN0
b3I7CisJCV9fdTMyIGVycm9yX2NvZGU7CisJCV9fdTY0IGNyMjsKKwl9OworCis6UmV0dXJuczoK
KworOjoKKworCXN0cnVjdCBrdm1pX3ZjcHVfaGRyOworCXN0cnVjdCBrdm1pX2V2ZW50X3JlcGx5
OworCitUaGlzIGV2ZW50IGlzIHNlbnQgaWYgYSBwcmV2aW91cyAqS1ZNSV9WQ1BVX0lOSkVDVF9F
WENFUFRJT04qIGNvbW1hbmQKK3Rvb2sgcGxhY2UuIEJlY2F1c2UgaXQgaGFzIGEgaGlnaCBwcmlv
cml0eSwgaXQgd2lsbCBiZSBzZW50IGJlZm9yZSBhbnkKK290aGVyIHZDUFUgaW50cm9zcGVjdGlv
biBldmVudC4KKworYGBrdm1pX2V2ZW50YGAsIGV4Y2VwdGlvbi9pbnRlcnJ1cHQgbnVtYmVyICh2
ZWN0b3IpLCBleGNlcHRpb24gY29kZQorKGBgZXJyb3JfY29kZWBgKSBhbmQgQ1IyIGFyZSBzZW50
IHRvIHRoZSBpbnRyb3NwZWN0aW9uIHRvb2wsCit3aGljaCBzaG91bGQgY2hlY2sgaWYgaXRzIGV4
Y2VwdGlvbiBoYXMgYmVlbiBpbmplY3RlZCBvciBvdmVycmlkZGVuLgorCmRpZmYgLS1naXQgYS9h
cmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaCBiL2FyY2gveDg2L2luY2x1ZGUvdWFwaS9h
c20va3ZtaS5oCmluZGV4IGEzZDI5NTU3Y2MxNS4uMDczZGJhYWMwNmIxIDEwMDY0NAotLS0gYS9h
cmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaAorKysgYi9hcmNoL3g4Ni9pbmNsdWRlL3Vh
cGkvYXNtL2t2bWkuaApAQCAtODMsNCArODMsMTggQEAgc3RydWN0IGt2bWlfZXZlbnRfY3JfcmVw
bHkgewogCV9fdTY0IG5ld192YWw7CiB9OwogCitzdHJ1Y3Qga3ZtaV9ldmVudF90cmFwIHsKKwlf
X3UzMiB2ZWN0b3I7CisJX191MzIgZXJyb3JfY29kZTsKKwlfX3U2NCBjcjI7Cit9OworCitzdHJ1
Y3Qga3ZtaV92Y3B1X2luamVjdF9leGNlcHRpb24geworCV9fdTggbnI7CisJX191OCBwYWRkaW5n
MTsKKwlfX3UxNiBwYWRkaW5nMjsKKwlfX3UzMiBlcnJvcl9jb2RlOworCV9fdTY0IGFkZHJlc3M7
Cit9OworCiAjZW5kaWYgLyogX1VBUElfQVNNX1g4Nl9LVk1JX0ggKi8KZGlmZiAtLWdpdCBhL2Fy
Y2gveDg2L2t2bS9rdm1pLmMgYi9hcmNoL3g4Ni9rdm0va3ZtaS5jCmluZGV4IDI4MWViYjQ3ZWFh
Mi4uOWY4ZWY4YTFhMzA2IDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9rdm0va3ZtaS5jCisrKyBiL2Fy
Y2gveDg2L2t2bS9rdm1pLmMKQEAgLTU1OSwzICs1NTksMTA2IEBAIGJvb2wga3ZtaV9jcjNfaW50
ZXJjZXB0ZWQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQogCXJldHVybiByZXQ7CiB9CiBFWFBPUlRf
U1lNQk9MKGt2bWlfY3IzX2ludGVyY2VwdGVkKTsKKworaW50IGt2bWlfYXJjaF9jbWRfdmNwdV9p
bmplY3RfZXhjZXB0aW9uKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTggdmVjdG9yLAorCQkJCQl1
MzIgZXJyb3JfY29kZSwgdTY0IGFkZHJlc3MpCit7CisJc3RydWN0IGt2bV92Y3B1X2ludHJvc3Bl
Y3Rpb24gKnZjcHVpID0gVkNQVUkodmNwdSk7CisJYm9vbCBoYXNfZXJyb3I7CisKKwlpZiAodmNw
dWktPmV4Y2VwdGlvbi5wZW5kaW5nIHx8IHZjcHVpLT5leGNlcHRpb24uc2VuZF9ldmVudCkKKwkJ
cmV0dXJuIC1LVk1fRUJVU1k7CisKKwl2Y3B1aS0+ZXhjZXB0aW9uLnBlbmRpbmcgPSB0cnVlOwor
CisJaGFzX2Vycm9yID0geDg2X2V4Y2VwdGlvbl9oYXNfZXJyb3JfY29kZSh2ZWN0b3IpOworCisJ
dmNwdWktPmV4Y2VwdGlvbi5uciA9IHZlY3RvcjsKKwl2Y3B1aS0+ZXhjZXB0aW9uLmVycm9yX2Nv
ZGUgPSBoYXNfZXJyb3IgPyBlcnJvcl9jb2RlIDogMDsKKwl2Y3B1aS0+ZXhjZXB0aW9uLmVycm9y
X2NvZGVfdmFsaWQgPSBoYXNfZXJyb3I7CisJdmNwdWktPmV4Y2VwdGlvbi5hZGRyZXNzID0gYWRk
cmVzczsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBrdm1pX2FyY2hfcXVldWVfZXhj
ZXB0aW9uKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKK3sKKwlzdHJ1Y3Qga3ZtX3ZjcHVfaW50cm9z
cGVjdGlvbiAqdmNwdWkgPSBWQ1BVSSh2Y3B1KTsKKwlzdHJ1Y3QgeDg2X2V4Y2VwdGlvbiBlID0g
eworCQkudmVjdG9yID0gdmNwdWktPmV4Y2VwdGlvbi5uciwKKwkJLmVycm9yX2NvZGVfdmFsaWQg
PSB2Y3B1aS0+ZXhjZXB0aW9uLmVycm9yX2NvZGVfdmFsaWQsCisJCS5lcnJvcl9jb2RlID0gdmNw
dWktPmV4Y2VwdGlvbi5lcnJvcl9jb2RlLAorCQkuYWRkcmVzcyA9IHZjcHVpLT5leGNlcHRpb24u
YWRkcmVzcywKKwl9OworCisJaWYgKGUudmVjdG9yID09IFBGX1ZFQ1RPUikKKwkJa3ZtX2luamVj
dF9wYWdlX2ZhdWx0KHZjcHUsICZlKTsKKwllbHNlIGlmIChlLmVycm9yX2NvZGVfdmFsaWQpCisJ
CWt2bV9xdWV1ZV9leGNlcHRpb25fZSh2Y3B1LCBlLnZlY3RvciwgZS5lcnJvcl9jb2RlKTsKKwll
bHNlCisJCWt2bV9xdWV1ZV9leGNlcHRpb24odmNwdSwgZS52ZWN0b3IpOworfQorCitzdGF0aWMg
dm9pZCBrdm1pX2FyY2hfc2F2ZV9pbmplY3RlZF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUp
Cit7CisJc3RydWN0IGt2bV92Y3B1X2ludHJvc3BlY3Rpb24gKnZjcHVpID0gVkNQVUkodmNwdSk7
CisKKwl2Y3B1aS0+ZXhjZXB0aW9uLmVycm9yX2NvZGUgPSAwOworCXZjcHVpLT5leGNlcHRpb24u
ZXJyb3JfY29kZV92YWxpZCA9IGZhbHNlOworCisJdmNwdWktPmV4Y2VwdGlvbi5hZGRyZXNzID0g
dmNwdS0+YXJjaC5jcjI7CisJaWYgKHZjcHUtPmFyY2guZXhjZXB0aW9uLmluamVjdGVkKSB7CisJ
CXZjcHVpLT5leGNlcHRpb24ubnIgPSB2Y3B1LT5hcmNoLmV4Y2VwdGlvbi5ucjsKKwkJdmNwdWkt
PmV4Y2VwdGlvbi5lcnJvcl9jb2RlX3ZhbGlkID0KKwkJCXg4Nl9leGNlcHRpb25faGFzX2Vycm9y
X2NvZGUodmNwdS0+YXJjaC5leGNlcHRpb24ubnIpOworCQl2Y3B1aS0+ZXhjZXB0aW9uLmVycm9y
X2NvZGUgPSB2Y3B1LT5hcmNoLmV4Y2VwdGlvbi5lcnJvcl9jb2RlOworCX0gZWxzZSBpZiAodmNw
dS0+YXJjaC5pbnRlcnJ1cHQuaW5qZWN0ZWQpIHsKKwkJdmNwdWktPmV4Y2VwdGlvbi5uciA9IHZj
cHUtPmFyY2guaW50ZXJydXB0Lm5yOworCX0KK30KKwordm9pZCBrdm1pX2FyY2hfaW5qZWN0X2V4
Y2VwdGlvbihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCit7CisJaWYgKCFrdm1fZXZlbnRfbmVlZHNf
cmVpbmplY3Rpb24odmNwdSkpIHsKKwkJa3ZtaV9hcmNoX3F1ZXVlX2V4Y2VwdGlvbih2Y3B1KTsK
KwkJa3ZtX2luamVjdF9wZW5kaW5nX2V4Y2VwdGlvbih2Y3B1KTsKKwl9CisKKwlrdm1pX2FyY2hf
c2F2ZV9pbmplY3RlZF9ldmVudCh2Y3B1KTsKK30KKworc3RhdGljIHUzMiBrdm1pX3NlbmRfdHJh
cChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU4IHZlY3RvciwKKwkJCSAgdTMyIGVycm9yX2NvZGUs
IHU2NCBjcjIpCit7CisJc3RydWN0IGt2bWlfZXZlbnRfdHJhcCBlOworCWludCBlcnIsIGFjdGlv
bjsKKworCW1lbXNldCgmZSwgMCwgc2l6ZW9mKGUpKTsKKwllLnZlY3RvciA9IHZlY3RvcjsKKwll
LmVycm9yX2NvZGUgPSBlcnJvcl9jb2RlOworCWUuY3IyID0gY3IyOworCisJZXJyID0gX19rdm1p
X3NlbmRfZXZlbnQodmNwdSwgS1ZNSV9FVkVOVF9UUkFQLCAmZSwgc2l6ZW9mKGUpLAorCQkJCU5V
TEwsIDAsICZhY3Rpb24pOworCWlmIChlcnIpCisJCXJldHVybiBLVk1JX0VWRU5UX0FDVElPTl9D
T05USU5VRTsKKworCXJldHVybiBhY3Rpb247Cit9CisKK3ZvaWQga3ZtaV9hcmNoX3RyYXBfZXZl
bnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQoreworCXN0cnVjdCBrdm1fdmNwdV9pbnRyb3NwZWN0
aW9uICp2Y3B1aSA9IFZDUFVJKHZjcHUpOworCXUzMiBhY3Rpb247CisKKwlhY3Rpb24gPSBrdm1p
X3NlbmRfdHJhcCh2Y3B1LCB2Y3B1aS0+ZXhjZXB0aW9uLm5yLAorCQkJCXZjcHVpLT5leGNlcHRp
b24uZXJyb3JfY29kZSwKKwkJCQl2Y3B1aS0+ZXhjZXB0aW9uLmFkZHJlc3MpOworCisJc3dpdGNo
IChhY3Rpb24pIHsKKwljYXNlIEtWTUlfRVZFTlRfQUNUSU9OX0NPTlRJTlVFOgorCQlicmVhazsK
KwlkZWZhdWx0OgorCQlrdm1pX2hhbmRsZV9jb21tb25fZXZlbnRfYWN0aW9ucyh2Y3B1LT5rdm0s
IGFjdGlvbiwgIlRSQVAiKTsKKwl9Cit9CmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9rdm0veDg2LmMg
Yi9hcmNoL3g4Ni9rdm0veDg2LmMKaW5kZXggNWI4ODU0MDM4NGI0Li4wZTM3MDRiZWQ2YzQgMTAw
NjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS94ODYuYworKysgYi9hcmNoL3g4Ni9rdm0veDg2LmMKQEAg
LTg0MDgsNiArODQwOCw5IEBAIHN0YXRpYyBpbnQgdmNwdV9lbnRlcl9ndWVzdChzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUpCiAJCWdvdG8gY2FuY2VsX2luamVjdGlvbjsKIAl9CiAKKwlpZiAoIWt2bWlf
ZW50ZXJfZ3Vlc3QodmNwdSkpCisJCXJlcV9pbW1lZGlhdGVfZXhpdCA9IHRydWU7CisKIAlpZiAo
cmVxX2ltbWVkaWF0ZV9leGl0KSB7CiAJCWt2bV9tYWtlX3JlcXVlc3QoS1ZNX1JFUV9FVkVOVCwg
dmNwdSk7CiAJCWt2bV94ODZfb3BzLT5yZXF1ZXN0X2ltbWVkaWF0ZV9leGl0KHZjcHUpOwpkaWZm
IC0tZ2l0IGEvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaCBiL2luY2x1ZGUvbGludXgva3ZtaV9o
b3N0LmgKaW5kZXggOGYyODA2NTMyMGQ4Li5lNjRmMmJiZDAzM2EgMTAwNjQ0Ci0tLSBhL2luY2x1
ZGUvbGludXgva3ZtaV9ob3N0LmgKKysrIGIvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaApAQCAt
NDEsNiArNDEsMTUgQEAgc3RydWN0IGt2bV92Y3B1X2ludHJvc3BlY3Rpb24gewogCiAJc3RydWN0
IGt2bV9yZWdzIGRlbGF5ZWRfcmVnczsKIAlib29sIGhhdmVfZGVsYXllZF9yZWdzOworCisJc3Ry
dWN0IHsKKwkJdTggbnI7CisJCXUzMiBlcnJvcl9jb2RlOworCQlib29sIGVycm9yX2NvZGVfdmFs
aWQ7CisJCXU2NCBhZGRyZXNzOworCQlib29sIHBlbmRpbmc7CisJCWJvb2wgc2VuZF9ldmVudDsK
Kwl9IGV4Y2VwdGlvbjsKIH07CiAKIHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiB7CkBAIC03Nyw2
ICs4Niw3IEBAIGludCBrdm1pX2lvY3RsX3ByZXVuaG9vayhzdHJ1Y3Qga3ZtICprdm0pOwogdm9p
ZCBrdm1pX2hhbmRsZV9yZXF1ZXN0cyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwogYm9vbCBrdm1p
X2h5cGVyY2FsbF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwogYm9vbCBrdm1pX2JyZWFr
cG9pbnRfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1NjQgZ3ZhLCB1OCBpbnNuX2xlbik7
Citib29sIGt2bWlfZW50ZXJfZ3Vlc3Qoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIAogI2Vsc2UK
IApAQCAtOTEsNiArMTAxLDggQEAgc3RhdGljIGlubGluZSBib29sIGt2bWlfaHlwZXJjYWxsX2V2
ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkgeyByZXR1cm4gZmFsc2U7IH0KIHN0YXRpYyBpbmxp
bmUgYm9vbCBrdm1pX2JyZWFrcG9pbnRfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1NjQg
Z3ZhLAogCQkJCQkgdTggaW5zbl9sZW4pCiAJCQl7IHJldHVybiB0cnVlOyB9CitzdGF0aWMgaW5s
aW5lIGJvb2wga3ZtaV9lbnRlcl9ndWVzdChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCisJCQl7IHJl
dHVybiB0cnVlOyB9CiAKICNlbmRpZiAvKiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04gKi8KIApk
aWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCBiL2luY2x1ZGUvdWFwaS9saW51
eC9rdm1pLmgKaW5kZXggMjgyNmFjMGY3NGU1Li4yNjAzZmE3MjE1NGIgMTAwNjQ0Ci0tLSBhL2lu
Y2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKKysrIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaApA
QCAtMjUsMTMgKzI1LDE0IEBAIGVudW0gewogCUtWTUlfVk1fUkVBRF9QSFlTSUNBTCAgICA9IDcs
CiAJS1ZNSV9WTV9XUklURV9QSFlTSUNBTCAgID0gOCwKIAotCUtWTUlfVkNQVV9HRVRfSU5GTyAg
ICAgICA9IDksCi0JS1ZNSV9WQ1BVX1BBVVNFICAgICAgICAgID0gMTAsCi0JS1ZNSV9WQ1BVX0NP
TlRST0xfRVZFTlRTID0gMTEsCi0JS1ZNSV9WQ1BVX0dFVF9SRUdJU1RFUlMgID0gMTIsCi0JS1ZN
SV9WQ1BVX1NFVF9SRUdJU1RFUlMgID0gMTMsCi0JS1ZNSV9WQ1BVX0dFVF9DUFVJRCAgICAgID0g
MTQsCi0JS1ZNSV9WQ1BVX0NPTlRST0xfQ1IgICAgID0gMTUsCisJS1ZNSV9WQ1BVX0dFVF9JTkZP
ICAgICAgICAgPSA5LAorCUtWTUlfVkNQVV9QQVVTRSAgICAgICAgICAgID0gMTAsCisJS1ZNSV9W
Q1BVX0NPTlRST0xfRVZFTlRTICAgPSAxMSwKKwlLVk1JX1ZDUFVfR0VUX1JFR0lTVEVSUyAgICA9
IDEyLAorCUtWTUlfVkNQVV9TRVRfUkVHSVNURVJTICAgID0gMTMsCisJS1ZNSV9WQ1BVX0dFVF9D
UFVJRCAgICAgICAgPSAxNCwKKwlLVk1JX1ZDUFVfQ09OVFJPTF9DUiAgICAgICA9IDE1LAorCUtW
TUlfVkNQVV9JTkpFQ1RfRVhDRVBUSU9OID0gMTYsCiAKIAlLVk1JX05VTV9NRVNTQUdFUwogfTsK
QEAgLTQyLDYgKzQzLDcgQEAgZW51bSB7CiAJS1ZNSV9FVkVOVF9IWVBFUkNBTEwgID0gMiwKIAlL
Vk1JX0VWRU5UX0JSRUFLUE9JTlQgPSAzLAogCUtWTUlfRVZFTlRfQ1IgICAgICAgICA9IDQsCisJ
S1ZNSV9FVkVOVF9UUkFQICAgICAgID0gNSwKIAogCUtWTUlfTlVNX0VWRU5UUwogfTsKZGlmZiAt
LWdpdCBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMgYi90
b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCmluZGV4IDk1OTVl
ODZjZDc5ZS4uNmE2YWQ3MzZkYjM2IDEwMDY0NAotLS0gYS90b29scy90ZXN0aW5nL3NlbGZ0ZXN0
cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCisrKyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2
bS94ODZfNjQva3ZtaV90ZXN0LmMKQEAgLTQ1LDYgKzQ1LDggQEAgc3RydWN0IHZjcHVfd29ya2Vy
X2RhdGEgewogCWludCB2Y3B1X2lkOwogCWludCB0ZXN0X2lkOwogCWJvb2wgc3RvcDsKKwlib29s
IHNodXRkb3duOworCWJvb2wgcmVzdGFydF9vbl9zaHV0ZG93bjsKIH07CiAKIGVudW0gewpAQCAt
NjAzLDExICs2MDUsMTkgQEAgc3RhdGljIHZvaWQgKnZjcHVfd29ya2VyKHZvaWQgKmRhdGEpCiAK
IAkJdmNwdV9ydW4oY3R4LT52bSwgY3R4LT52Y3B1X2lkKTsKIAotCQlURVNUX0FTU0VSVChydW4t
PmV4aXRfcmVhc29uID09IEtWTV9FWElUX0lPLAorCQlURVNUX0FTU0VSVChydW4tPmV4aXRfcmVh
c29uID09IEtWTV9FWElUX0lPCisJCQl8fCAocnVuLT5leGl0X3JlYXNvbiA9PSBLVk1fRVhJVF9T
SFVURE9XTgorCQkJCSYmIGN0eC0+c2h1dGRvd24pLAogCQkJInZjcHVfcnVuKCkgZmFpbGVkLCB0
ZXN0X2lkICVkLCBleGl0IHJlYXNvbiAldSAoJXMpXG4iLAogCQkJY3R4LT50ZXN0X2lkLCBydW4t
PmV4aXRfcmVhc29uLAogCQkJZXhpdF9yZWFzb25fc3RyKHJ1bi0+ZXhpdF9yZWFzb24pKTsKIAor
CQlpZiAocnVuLT5leGl0X3JlYXNvbiA9PSBLVk1fRVhJVF9TSFVURE9XTikgeworCQkJaWYgKGN0
eC0+cmVzdGFydF9vbl9zaHV0ZG93bikKKwkJCQljb250aW51ZTsKKwkJCWJyZWFrOworCQl9CisK
IAkJVEVTVF9BU1NFUlQoZ2V0X3VjYWxsKGN0eC0+dm0sIGN0eC0+dmNwdV9pZCwgJnVjKSwKIAkJ
CSJObyBndWVzdCByZXF1ZXN0XG4iKTsKIApAQCAtMTEyNiw2ICsxMTM2LDEwMiBAQCBzdGF0aWMg
dm9pZCB0ZXN0X2NtZF92Y3B1X2NvbnRyb2xfY3Ioc3RydWN0IGt2bV92bSAqdm0pCiAJCXNyZWdz
LmNyNCwgZXYuY3Iub2xkX3ZhbHVlKTsKIH0KIAorc3RhdGljIHZvaWQgX19pbmplY3RfZXhjZXB0
aW9uKHN0cnVjdCBrdm1fdm0gKnZtLCBpbnQgdmVjdG9yKQoreworCXN0cnVjdCB7CisJCXN0cnVj
dCBrdm1pX21zZ19oZHIgaGRyOworCQlzdHJ1Y3Qga3ZtaV92Y3B1X2hkciB2Y3B1X2hkcjsKKwkJ
c3RydWN0IGt2bWlfdmNwdV9pbmplY3RfZXhjZXB0aW9uIGNtZDsKKwl9IHJlcSA9IHt9OworCV9f
dTE2IHZjcHVfaW5kZXggPSAwOworCWludCByOworCisJcmVxLnZjcHVfaGRyLnZjcHUgPSB2Y3B1
X2luZGV4OworCXJlcS5jbWQubnIgPSB2ZWN0b3I7CisKKwlyID0gZG9fY29tbWFuZChLVk1JX1ZD
UFVfSU5KRUNUX0VYQ0VQVElPTiwKKwkJCSZyZXEuaGRyLCBzaXplb2YocmVxKSwgTlVMTCwgMCk7
CisJVEVTVF9BU1NFUlQociA9PSAwLAorCQkiS1ZNSV9WQ1BVX0lOSkVDVF9FWENFUFRJT04gZmFp
bGVkLCBlcnJvciAlZCglcylcbiIsCisJCS1yLCBrdm1fc3RyZXJyb3IoLXIpKTsKK30KKworc3Rh
dGljIHZvaWQgcmVjZWl2ZV9leGNlcHRpb25fZXZlbnQoc3RydWN0IGt2bV92bSAqdm0sIGludCB2
ZWN0b3IpCit7CisJc3RydWN0IGt2bWlfbXNnX2hkciBoZHI7CisJc3RydWN0IHsKKwkJc3RydWN0
IGt2bWlfZXZlbnQgY29tbW9uOworCQlzdHJ1Y3Qga3ZtaV9ldmVudF90cmFwIHRyYXA7CisJfSBl
djsKKwlzdHJ1Y3QgdmNwdV9yZXBseSBycGwgPSB7fTsKKworCXJlY2VpdmVfZXZlbnQoJmhkciwg
JmV2LmNvbW1vbiwgc2l6ZW9mKGV2KSwgS1ZNSV9FVkVOVF9UUkFQKTsKKworCURFQlVHKCJFeGNl
cHRpb24gZXZlbnQ6IHZlY3RvciAldSwgZXJyb3JfY29kZSAweCV4LCBjcjIgMHglbGx4XG4iLAor
CQlldi50cmFwLnZlY3RvciwgZXYudHJhcC5lcnJvcl9jb2RlLCBldi50cmFwLmNyMik7CisKKwlU
RVNUX0FTU0VSVChldi50cmFwLnZlY3RvciA9PSB2ZWN0b3IsCisJCSJJbmplY3RlZCBleGNlcHRp
b24gJXUgaW5zdGVhZCBvZiAldVxuIiwKKwkJZXYudHJhcC52ZWN0b3IsIHZlY3Rvcik7CisKKwly
ZXBseV90b19ldmVudCgmaGRyLCAmZXYuY29tbW9uLCBLVk1JX0VWRU5UX0FDVElPTl9DT05USU5V
RSwKKwkJCSZycGwsIHNpemVvZihycGwpKTsKK30KKworc3RhdGljIHZvaWQgdGVzdF9jbWRfdmNw
dV9pbmplY3RfZXhjZXB0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQoreworCXN0cnVjdCB2Y3B1X3dv
cmtlcl9kYXRhIGRhdGEgPSB7CisJCS52bSA9IHZtLAorCQkudmNwdV9pZCA9IFZDUFVfSUQsCisJ
CS5zaHV0ZG93biA9IHRydWUsCisJCS5yZXN0YXJ0X29uX3NodXRkb3duID0gdHJ1ZSwKKwl9Owor
CXN0cnVjdCBrdm1pX21zZ19oZHIgaGRyOworCXN0cnVjdCB7CisJCXN0cnVjdCBrdm1pX2V2ZW50
IGNvbW1vbjsKKwkJc3RydWN0IGt2bWlfZXZlbnRfYnJlYWtwb2ludCBicDsKKwl9IGV2OworCXN0
cnVjdCB2Y3B1X3JlcGx5IHJwbCA9IHt9OworCXB0aHJlYWRfdCB2Y3B1X3RocmVhZDsKKwlfX3U4
IHVkX3ZlY3RvciA9IDY7CisJX191OCBicF92ZWN0b3IgPSAzOworCisJaWYgKCFpc19pbnRlbF9j
cHUoKSkgeworCQlERUJVRygiVE9ETzogJXMoKSAtIG1ha2UgaXQgd29yayB3aXRoIEFNRFxuIiwg
X19mdW5jX18pOworCQlyZXR1cm47CisJfQorCisJZW5hYmxlX3ZjcHVfZXZlbnQodm0sIEtWTUlf
RVZFTlRfQlJFQUtQT0lOVCk7CisKKwl2Y3B1X3RocmVhZCA9IHN0YXJ0X3ZjcHVfd29ya2VyKCZk
YXRhKTsKKworCV9faW5qZWN0X2V4Y2VwdGlvbih2bSwgdWRfdmVjdG9yKTsKKworCS8qIGNvbmZp
cm0gdGhhdCBvdXIgZXhjZXB0aW9uIGhhcyBiZWVuIGluamVjdGVkICovCisJcmVjZWl2ZV9leGNl
cHRpb25fZXZlbnQodm0sIHVkX3ZlY3Rvcik7CisKKwlXUklURV9PTkNFKGRhdGEudGVzdF9pZCwg
R1VFU1RfVEVTVF9CUCk7CisKKwlyZWNlaXZlX2V2ZW50KCZoZHIsICZldi5jb21tb24sIHNpemVv
ZihldiksIEtWTUlfRVZFTlRfQlJFQUtQT0lOVCk7CisKKwlfX2luamVjdF9leGNlcHRpb24odm0s
IHVkX3ZlY3Rvcik7CisKKwkvKiBza2lwIHRoZSBicmVha3BvaW50IGluc3RydWN0aW9uLCBuZXh0
IHRpbWUgZ3Vlc3RfYnBfdGVzdCgpIHJ1bnMgKi8KKwlldi5jb21tb24uYXJjaC5yZWdzLnJpcCAr
PSBldi5icC5pbnNuX2xlbjsKKwlfX3NldF9yZWdpc3RlcnModm0sICZldi5jb21tb24uYXJjaC5y
ZWdzKTsKKworCS8qIHJlaW5qZWN0IHRoZSAjQlAgZXhjZXB0aW9uICovCisJcmVwbHlfdG9fZXZl
bnQoJmhkciwgJmV2LmNvbW1vbiwgS1ZNSV9FVkVOVF9BQ1RJT05fQ09OVElOVUUsCisJCQkmcnBs
LCBzaXplb2YocnBsKSk7CisKKwkvKiBjb25maXJtIHRoYXQgb3VyIGluamVjdGlvbiBkaWRuJ3Qg
b3ZlcnJpZGUgdGhlICNCUCBleGNlcHRpb24gKi8KKwlyZWNlaXZlX2V4Y2VwdGlvbl9ldmVudCh2
bSwgYnBfdmVjdG9yKTsKKworCXN0b3BfdmNwdV93b3JrZXIodmNwdV90aHJlYWQsICZkYXRhKTsK
KworCWRpc2FibGVfdmNwdV9ldmVudCh2bSwgS1ZNSV9FVkVOVF9CUkVBS1BPSU5UKTsKK30KKwog
c3RhdGljIHZvaWQgdGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQogewogCXNy
YW5kb20odGltZSgwKSk7CkBAIC0xMTQ5LDYgKzEyNTUsNyBAQCBzdGF0aWMgdm9pZCB0ZXN0X2lu
dHJvc3BlY3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCiAJdGVzdF9ldmVudF9oeXBlcmNhbGwodm0p
OwogCXRlc3RfZXZlbnRfYnJlYWtwb2ludCh2bSk7CiAJdGVzdF9jbWRfdmNwdV9jb250cm9sX2Ny
KHZtKTsKKwl0ZXN0X2NtZF92Y3B1X2luamVjdF9leGNlcHRpb24odm0pOwogCiAJdW5ob29rX2lu
dHJvc3BlY3Rpb24odm0pOwogfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9r
dm1pLmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwppbmRleCA2ZDQyMWNmMjEzZDcu
LjBmMmNlYzdlOWM5MCAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMK
KysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKQEAgLTgyLDYgKzgyLDcgQEAgc3Rh
dGljIHZvaWQgc2V0dXBfa25vd25fZXZlbnRzKHZvaWQpCiAJc2V0X2JpdChLVk1JX0VWRU5UX0NS
LCBLdm1pX2tub3duX3ZjcHVfZXZlbnRzKTsKIAlzZXRfYml0KEtWTUlfRVZFTlRfSFlQRVJDQUxM
LCBLdm1pX2tub3duX3ZjcHVfZXZlbnRzKTsKIAlzZXRfYml0KEtWTUlfRVZFTlRfUEFVU0VfVkNQ
VSwgS3ZtaV9rbm93bl92Y3B1X2V2ZW50cyk7CisJc2V0X2JpdChLVk1JX0VWRU5UX1RSQVAsIEt2
bWlfa25vd25fdmNwdV9ldmVudHMpOwogCiAJYml0bWFwX29yKEt2bWlfa25vd25fZXZlbnRzLCBL
dm1pX2tub3duX3ZtX2V2ZW50cywKIAkJICBLdm1pX2tub3duX3ZjcHVfZXZlbnRzLCBLVk1JX05V
TV9FVkVOVFMpOwpAQCAtODAzLDYgKzgwNCwxNiBAQCBzdGF0aWMgdm9pZCBrdm1pX3ZjcHVfcGF1
c2VfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQogCX0KIH0KIAordm9pZCBrdm1pX3NlbmRf
cGVuZGluZ19ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCit7CisJc3RydWN0IGt2bV92Y3B1
X2ludHJvc3BlY3Rpb24gKnZjcHVpID0gVkNQVUkodmNwdSk7CisKKwlpZiAodmNwdWktPmV4Y2Vw
dGlvbi5zZW5kX2V2ZW50KSB7CisJCWt2bWlfYXJjaF90cmFwX2V2ZW50KHZjcHUpOworCQl2Y3B1
aS0+ZXhjZXB0aW9uLnNlbmRfZXZlbnQgPSBmYWxzZTsKKwl9Cit9CisKIHZvaWQga3ZtaV9oYW5k
bGVfcmVxdWVzdHMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQogewogCXN0cnVjdCBrdm1fdmNwdV9p
bnRyb3NwZWN0aW9uICp2Y3B1aSA9IFZDUFVJKHZjcHUpOwpAQCAtODEyLDYgKzgyMyw4IEBAIHZv
aWQga3ZtaV9oYW5kbGVfcmVxdWVzdHMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQogCWlmICgha3Zt
aSkKIAkJZ290byBvdXQ7CiAKKwlrdm1pX3NlbmRfcGVuZGluZ19ldmVudCh2Y3B1KTsKKwogCWZv
ciAoOzspIHsKIAkJa3ZtaV9ydW5fam9icyh2Y3B1KTsKIApAQCAtOTEwLDMgKzkyMywzNiBAQCBi
b29sIGt2bWlfYnJlYWtwb2ludF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU2NCBndmEs
IHU4IGluc25fbGVuKQogCXJldHVybiByZXQ7CiB9CiBFWFBPUlRfU1lNQk9MKGt2bWlfYnJlYWtw
b2ludF9ldmVudCk7CisKK3N0YXRpYyBib29sIGt2bWlfaW5qZWN0X3BlbmRpbmdfZXhjZXB0aW9u
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKK3sKKwlzdHJ1Y3Qga3ZtX3ZjcHVfaW50cm9zcGVjdGlv
biAqdmNwdWkgPSBWQ1BVSSh2Y3B1KTsKKworCWlmICghdmNwdWktPmV4Y2VwdGlvbi5wZW5kaW5n
KQorCQlyZXR1cm4gZmFsc2U7CisKKwlrdm1pX2FyY2hfaW5qZWN0X2V4Y2VwdGlvbih2Y3B1KTsK
KworCXZjcHVpLT5leGNlcHRpb24uc2VuZF9ldmVudCA9IHRydWU7CisJa3ZtX21ha2VfcmVxdWVz
dChLVk1fUkVRX0lOVFJPU1BFQ1RJT04sIHZjcHUpOworCisJdmNwdWktPmV4Y2VwdGlvbi5wZW5k
aW5nID0gZmFsc2U7CisKKwlyZXR1cm4gdHJ1ZTsKK30KKworYm9vbCBrdm1pX2VudGVyX2d1ZXN0
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2
bWk7CisJYm9vbCByID0gdHJ1ZTsKKworCWt2bWkgPSBrdm1pX2dldCh2Y3B1LT5rdm0pOworCWlm
ICgha3ZtaSkKKwkJcmV0dXJuIHRydWU7CisKKwlpZiAoa3ZtaV9pbmplY3RfcGVuZGluZ19leGNl
cHRpb24odmNwdSkpCisJCXIgPSBmYWxzZTsKKworCWt2bWlfcHV0KHZjcHUtPmt2bSk7CisJcmV0
dXJuIHI7Cit9CmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50Lmgg
Yi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmgKaW5kZXggNTg4YTM4NmEzZjM3Li41
OWE4YjIwYWYwZmQgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQu
aAorKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmgKQEAgLTM2LDYgKzM2LDkg
QEAgYm9vbCBrdm1pX21zZ19wcm9jZXNzKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSk7
CiBpbnQga3ZtaV9zZW5kX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTMyIGV2X2lkLAog
CQkgICAgdm9pZCAqZXYsIHNpemVfdCBldl9zaXplLAogCQkgICAgdm9pZCAqcnBsLCBzaXplX3Qg
cnBsX3NpemUsIGludCAqYWN0aW9uKTsKK2ludCBfX2t2bWlfc2VuZF9ldmVudChzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUsIHUzMiBldl9pZCwKKwkJICAgICAgdm9pZCAqZXYsIHNpemVfdCBldl9zaXpl
LAorCQkgICAgICB2b2lkICpycGwsIHNpemVfdCBycGxfc2l6ZSwgaW50ICphY3Rpb24pOwogaW50
IGt2bWlfbXNnX3NlbmRfdW5ob29rKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSk7CiB1
MzIga3ZtaV9tc2dfc2VuZF92Y3B1X3BhdXNlKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7CiB1MzIg
a3ZtaV9tc2dfc2VuZF9oeXBlcmNhbGwoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKQEAgLTU0LDYg
KzU3LDcgQEAgdm9pZCBrdm1pX2hhbmRsZV9jb21tb25fZXZlbnRfYWN0aW9ucyhzdHJ1Y3Qga3Zt
ICprdm0sCiAJCQkJICAgICAgdTMyIGFjdGlvbiwgY29uc3QgY2hhciAqc3RyKTsKIHN0cnVjdCBr
dm1faW50cm9zcGVjdGlvbiAqIF9fbXVzdF9jaGVjayBrdm1pX2dldChzdHJ1Y3Qga3ZtICprdm0p
Owogdm9pZCBrdm1pX3B1dChzdHJ1Y3Qga3ZtICprdm0pOwordm9pZCBrdm1pX3NlbmRfcGVuZGlu
Z19ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwogaW50IGt2bWlfY21kX3ZtX2NvbnRyb2xf
ZXZlbnRzKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSwKIAkJCQl1bnNpZ25lZCBpbnQg
ZXZlbnRfaWQsIGJvb2wgZW5hYmxlKTsKIGludCBrdm1pX2NtZF92Y3B1X2NvbnRyb2xfZXZlbnRz
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKQEAgLTk1LDUgKzk5LDkgQEAgaW50IGt2bWlfYXJjaF9j
bWRfY29udHJvbF9pbnRlcmNlcHQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LAogCQkJCSAgICB1bnNp
Z25lZCBpbnQgZXZlbnRfaWQsIGJvb2wgZW5hYmxlKTsKIGludCBrdm1pX2FyY2hfY21kX3ZjcHVf
Y29udHJvbF9jcihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCiAJCQkJICBjb25zdCBzdHJ1Y3Qga3Zt
aV92Y3B1X2NvbnRyb2xfY3IgKnJlcSk7CitpbnQga3ZtaV9hcmNoX2NtZF92Y3B1X2luamVjdF9l
eGNlcHRpb24oc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1OCB2ZWN0b3IsCisJCQkJCXUzMiBlcnJv
cl9jb2RlLCB1NjQgYWRkcmVzcyk7Cit2b2lkIGt2bWlfYXJjaF90cmFwX2V2ZW50KHN0cnVjdCBr
dm1fdmNwdSAqdmNwdSk7Cit2b2lkIGt2bWlfYXJjaF9pbmplY3RfZXhjZXB0aW9uKHN0cnVjdCBr
dm1fdmNwdSAqdmNwdSk7CiAKICNlbmRpZgpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVj
dGlvbi9rdm1pX21zZy5jIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCmluZGV4
IDc4OWFhOWYxOTEyZi4uODMwNDMwNzc3NTU2IDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3Nw
ZWN0aW9uL2t2bWlfbXNnLmMKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5j
CkBAIC0yMCwyMSArMjAsMjIgQEAgc3RydWN0IGt2bWlfdmNwdV9jbWRfam9iIHsKIH07CiAKIHN0
YXRpYyBjb25zdCBjaGFyICpjb25zdCBtc2dfSURzW10gPSB7Ci0JW0tWTUlfRVZFTlRdICAgICAg
ICAgICAgICAgPSAiS1ZNSV9FVkVOVCIsCi0JW0tWTUlfR0VUX1ZFUlNJT05dICAgICAgICAgPSAi
S1ZNSV9HRVRfVkVSU0lPTiIsCi0JW0tWTUlfVk1fQ0hFQ0tfQ09NTUFORF0gICAgPSAiS1ZNSV9W
TV9DSEVDS19DT01NQU5EIiwKLQlbS1ZNSV9WTV9DSEVDS19FVkVOVF0gICAgICA9ICJLVk1JX1ZN
X0NIRUNLX0VWRU5UIiwKLQlbS1ZNSV9WTV9DT05UUk9MX0VWRU5UU10gICA9ICJLVk1JX1ZNX0NP
TlRST0xfRVZFTlRTIiwKLQlbS1ZNSV9WTV9HRVRfSU5GT10gICAgICAgICA9ICJLVk1JX1ZNX0dF
VF9JTkZPIiwKLQlbS1ZNSV9WTV9SRUFEX1BIWVNJQ0FMXSAgICA9ICJLVk1JX1ZNX1JFQURfUEhZ
U0lDQUwiLAotCVtLVk1JX1ZNX1dSSVRFX1BIWVNJQ0FMXSAgID0gIktWTUlfVk1fV1JJVEVfUEhZ
U0lDQUwiLAotCVtLVk1JX1ZDUFVfQ09OVFJPTF9DUl0gICAgID0gIktWTUlfVkNQVV9DT05UUk9M
X0NSIiwKLQlbS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTXSA9ICJLVk1JX1ZDUFVfQ09OVFJPTF9F
VkVOVFMiLAotCVtLVk1JX1ZDUFVfR0VUX0NQVUlEXSAgICAgID0gIktWTUlfVkNQVV9HRVRfQ1BV
SUQiLAotCVtLVk1JX1ZDUFVfR0VUX0lORk9dICAgICAgID0gIktWTUlfVkNQVV9HRVRfSU5GTyIs
Ci0JW0tWTUlfVkNQVV9HRVRfUkVHSVNURVJTXSAgPSAiS1ZNSV9WQ1BVX0dFVF9SRUdJU1RFUlMi
LAotCVtLVk1JX1ZDUFVfUEFVU0VdICAgICAgICAgID0gIktWTUlfVkNQVV9QQVVTRSIsCi0JW0tW
TUlfVkNQVV9TRVRfUkVHSVNURVJTXSAgPSAiS1ZNSV9WQ1BVX1NFVF9SRUdJU1RFUlMiLAorCVtL
Vk1JX0VWRU5UXSAgICAgICAgICAgICAgICAgPSAiS1ZNSV9FVkVOVCIsCisJW0tWTUlfR0VUX1ZF
UlNJT05dICAgICAgICAgICA9ICJLVk1JX0dFVF9WRVJTSU9OIiwKKwlbS1ZNSV9WTV9DSEVDS19D
T01NQU5EXSAgICAgID0gIktWTUlfVk1fQ0hFQ0tfQ09NTUFORCIsCisJW0tWTUlfVk1fQ0hFQ0tf
RVZFTlRdICAgICAgICA9ICJLVk1JX1ZNX0NIRUNLX0VWRU5UIiwKKwlbS1ZNSV9WTV9DT05UUk9M
X0VWRU5UU10gICAgID0gIktWTUlfVk1fQ09OVFJPTF9FVkVOVFMiLAorCVtLVk1JX1ZNX0dFVF9J
TkZPXSAgICAgICAgICAgPSAiS1ZNSV9WTV9HRVRfSU5GTyIsCisJW0tWTUlfVk1fUkVBRF9QSFlT
SUNBTF0gICAgICA9ICJLVk1JX1ZNX1JFQURfUEhZU0lDQUwiLAorCVtLVk1JX1ZNX1dSSVRFX1BI
WVNJQ0FMXSAgICAgPSAiS1ZNSV9WTV9XUklURV9QSFlTSUNBTCIsCisJW0tWTUlfVkNQVV9DT05U
Uk9MX0NSXSAgICAgICA9ICJLVk1JX1ZDUFVfQ09OVFJPTF9DUiIsCisJW0tWTUlfVkNQVV9DT05U
Uk9MX0VWRU5UU10gICA9ICJLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMiLAorCVtLVk1JX1ZDUFVf
R0VUX0NQVUlEXSAgICAgICAgPSAiS1ZNSV9WQ1BVX0dFVF9DUFVJRCIsCisJW0tWTUlfVkNQVV9H
RVRfSU5GT10gICAgICAgICA9ICJLVk1JX1ZDUFVfR0VUX0lORk8iLAorCVtLVk1JX1ZDUFVfR0VU
X1JFR0lTVEVSU10gICAgPSAiS1ZNSV9WQ1BVX0dFVF9SRUdJU1RFUlMiLAorCVtLVk1JX1ZDUFVf
SU5KRUNUX0VYQ0VQVElPTl0gPSAiS1ZNSV9WQ1BVX0lOSkVDVF9FWENFUFRJT04iLAorCVtLVk1J
X1ZDUFVfUEFVU0VdICAgICAgICAgICAgPSAiS1ZNSV9WQ1BVX1BBVVNFIiwKKwlbS1ZNSV9WQ1BV
X1NFVF9SRUdJU1RFUlNdICAgID0gIktWTUlfVkNQVV9TRVRfUkVHSVNURVJTIiwKIH07CiAKIHN0
YXRpYyBjb25zdCBjaGFyICppZDJzdHIodTE2IGlkKQpAQCAtNTI2LDYgKzUyNywyNSBAQCBzdGF0
aWMgaW50IGhhbmRsZV92Y3B1X2NvbnRyb2xfY3IoY29uc3Qgc3RydWN0IGt2bWlfdmNwdV9jbWRf
am9iICpqb2IsCiAJcmV0dXJuIGt2bWlfbXNnX3ZjcHVfcmVwbHkoam9iLCBtc2csIGVjLCBOVUxM
LCAwKTsKIH0KIAorc3RhdGljIGludCBoYW5kbGVfdmNwdV9pbmplY3RfZXhjZXB0aW9uKGNvbnN0
IHN0cnVjdCBrdm1pX3ZjcHVfY21kX2pvYiAqam9iLAorCQkJCQljb25zdCBzdHJ1Y3Qga3ZtaV9t
c2dfaGRyICptc2csCisJCQkJCWNvbnN0IHZvaWQgKl9yZXEpCit7CisJY29uc3Qgc3RydWN0IGt2
bWlfdmNwdV9pbmplY3RfZXhjZXB0aW9uICpyZXEgPSBfcmVxOworCWludCBlYzsKKworCWlmICgh
aXNfZXZlbnRfYWxsb3dlZChLVk1JKGpvYi0+dmNwdS0+a3ZtKSwgS1ZNSV9FVkVOVF9UUkFQKSkK
KwkJZWMgPSAtS1ZNX0VQRVJNOworCWVsc2UgaWYgKHJlcS0+cGFkZGluZzEgfHwgcmVxLT5wYWRk
aW5nMikKKwkJZWMgPSAtS1ZNX0VJTlZBTDsKKwllbHNlCisJCWVjID0ga3ZtaV9hcmNoX2NtZF92
Y3B1X2luamVjdF9leGNlcHRpb24oam9iLT52Y3B1LCByZXEtPm5yLAorCQkJCQkJCSByZXEtPmVy
cm9yX2NvZGUsCisJCQkJCQkJIHJlcS0+YWRkcmVzcyk7CisKKwlyZXR1cm4ga3ZtaV9tc2dfdmNw
dV9yZXBseShqb2IsIG1zZywgZWMsIE5VTEwsIDApOworfQorCiAvKgogICogVGhlc2UgY29tbWFu
ZHMgYXJlIGV4ZWN1dGVkIGZyb20gdGhlIHZDUFUgdGhyZWFkLiBUaGUgcmVjZWl2aW5nIHRocmVh
ZAogICogcGFzc2VzIHRoZSBtZXNzYWdlcyB1c2luZyBhIG5ld2x5IGFsbG9jYXRlZCAnc3RydWN0
IGt2bWlfdmNwdV9jbWRfam9iJwpAQCAtNTM0LDEzICs1NTQsMTQgQEAgc3RhdGljIGludCBoYW5k
bGVfdmNwdV9jb250cm9sX2NyKGNvbnN0IHN0cnVjdCBrdm1pX3ZjcHVfY21kX2pvYiAqam9iLAog
ICovCiBzdGF0aWMgaW50KCpjb25zdCBtc2dfdmNwdVtdKShjb25zdCBzdHJ1Y3Qga3ZtaV92Y3B1
X2NtZF9qb2IgKiwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBrdm1pX21zZ19oZHIgKiwgY29uc3Qg
dm9pZCAqKSA9IHsKLQlbS1ZNSV9FVkVOVF0gICAgICAgICAgICAgICA9IGhhbmRsZV9ldmVudF9y
ZXBseSwKLQlbS1ZNSV9WQ1BVX0NPTlRST0xfQ1JdICAgICA9IGhhbmRsZV92Y3B1X2NvbnRyb2xf
Y3IsCi0JW0tWTUlfVkNQVV9DT05UUk9MX0VWRU5UU10gPSBoYW5kbGVfdmNwdV9jb250cm9sX2V2
ZW50cywKLQlbS1ZNSV9WQ1BVX0dFVF9DUFVJRF0gICAgICA9IGhhbmRsZV9nZXRfY3B1aWQsCi0J
W0tWTUlfVkNQVV9HRVRfSU5GT10gICAgICAgPSBoYW5kbGVfZ2V0X3ZjcHVfaW5mbywKLQlbS1ZN
SV9WQ1BVX0dFVF9SRUdJU1RFUlNdICA9IGhhbmRsZV9nZXRfcmVnaXN0ZXJzLAotCVtLVk1JX1ZD
UFVfU0VUX1JFR0lTVEVSU10gID0gaGFuZGxlX3NldF9yZWdpc3RlcnMsCisJW0tWTUlfRVZFTlRd
ICAgICAgICAgICAgICAgICA9IGhhbmRsZV9ldmVudF9yZXBseSwKKwlbS1ZNSV9WQ1BVX0NPTlRS
T0xfQ1JdICAgICAgID0gaGFuZGxlX3ZjcHVfY29udHJvbF9jciwKKwlbS1ZNSV9WQ1BVX0NPTlRS
T0xfRVZFTlRTXSAgID0gaGFuZGxlX3ZjcHVfY29udHJvbF9ldmVudHMsCisJW0tWTUlfVkNQVV9H
RVRfQ1BVSURdICAgICAgICA9IGhhbmRsZV9nZXRfY3B1aWQsCisJW0tWTUlfVkNQVV9HRVRfSU5G
T10gICAgICAgICA9IGhhbmRsZV9nZXRfdmNwdV9pbmZvLAorCVtLVk1JX1ZDUFVfR0VUX1JFR0lT
VEVSU10gICAgPSBoYW5kbGVfZ2V0X3JlZ2lzdGVycywKKwlbS1ZNSV9WQ1BVX0lOSkVDVF9FWENF
UFRJT05dID0gaGFuZGxlX3ZjcHVfaW5qZWN0X2V4Y2VwdGlvbiwKKwlbS1ZNSV9WQ1BVX1NFVF9S
RUdJU1RFUlNdICAgID0gaGFuZGxlX3NldF9yZWdpc3RlcnMsCiB9OwogCiBzdGF0aWMgYm9vbCBp
c192Y3B1X2NvbW1hbmQodTE2IGlkKQpAQCAtNzk3LDkgKzgxOCw5IEBAIHN0YXRpYyB2b2lkIGt2
bWlfc2V0dXBfdmNwdV9yZXBseShzdHJ1Y3Qga3ZtX3ZjcHVfaW50cm9zcGVjdGlvbiAqdmNwdWks
CiAJdmNwdWktPndhaXRpbmdfZm9yX3JlcGx5ID0gdHJ1ZTsKIH0KIAotaW50IGt2bWlfc2VuZF9l
dmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHUzMiBldl9pZCwKLQkJICAgIHZvaWQgKmV2LCBz
aXplX3QgZXZfc2l6ZSwKLQkJICAgIHZvaWQgKnJwbCwgc2l6ZV90IHJwbF9zaXplLCBpbnQgKmFj
dGlvbikKK2ludCBfX2t2bWlfc2VuZF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHUzMiBl
dl9pZCwKKwkJICAgICAgdm9pZCAqZXYsIHNpemVfdCBldl9zaXplLAorCQkgICAgICB2b2lkICpy
cGwsIHNpemVfdCBycGxfc2l6ZSwgaW50ICphY3Rpb24pCiB7CiAJc3RydWN0IGt2bWlfbXNnX2hk
ciBoZHI7CiAJc3RydWN0IGt2bWlfZXZlbnQgY29tbW9uOwpAQCAtODM5LDYgKzg2MCwxNiBAQCBp
bnQga3ZtaV9zZW5kX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTMyIGV2X2lkLAogCXJl
dHVybiBlcnI7CiB9CiAKK2ludCBrdm1pX3NlbmRfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
LCB1MzIgZXZfaWQsCisJCSAgICB2b2lkICpldiwgc2l6ZV90IGV2X3NpemUsCisJCSAgICB2b2lk
ICpycGwsIHNpemVfdCBycGxfc2l6ZSwgaW50ICphY3Rpb24pCit7CisJa3ZtaV9zZW5kX3BlbmRp
bmdfZXZlbnQodmNwdSk7CisKKwlyZXR1cm4gX19rdm1pX3NlbmRfZXZlbnQodmNwdSwgZXZfaWQs
IGV2LCBldl9zaXplLAorCQkJCSBycGwsIHJwbF9zaXplLCBhY3Rpb24pOworfQorCiB1MzIga3Zt
aV9tc2dfc2VuZF92Y3B1X3BhdXNlKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKIHsKIAlpbnQgZXJy
LCBhY3Rpb247Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
ClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0cy5saW51eC1m
b3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcvbWFpbG1hbi9s
aXN0aW5mby92aXJ0dWFsaXphdGlvbg==
