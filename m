Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp1.osuosl.org (smtp1.osuosl.org [140.211.166.138])
	by mail.lfdr.de (Postfix) with ESMTPS id BC2A97134BD
	for <lists.virtualization@lfdr.de>; Sat, 27 May 2023 14:35:25 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp1.osuosl.org (Postfix) with ESMTP id 89CE583CD0;
	Sat, 27 May 2023 12:35:23 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org 89CE583CD0
Authentication-Results: smtp1.osuosl.org;
	dkim=fail reason="signature verification failed" (2048-bit key) header.d=gmail.com header.i=@gmail.com header.a=rsa-sha256 header.s=20221208 header.b=b26Xp4nT
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp1.osuosl.org ([127.0.0.1])
	by localhost (smtp1.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id SsLzBHAuQf5j; Sat, 27 May 2023 12:35:22 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp1.osuosl.org (Postfix) with ESMTPS id 9E99E83EBE;
	Sat, 27 May 2023 12:35:21 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org 9E99E83EBE
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 05B2DC0089;
	Sat, 27 May 2023 12:35:21 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp2.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id E4542C002A
 for <virtualization@lists.linux-foundation.org>;
 Sat, 27 May 2023 12:35:18 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp2.osuosl.org (Postfix) with ESMTP id BEC9A40131
 for <virtualization@lists.linux-foundation.org>;
 Sat, 27 May 2023 12:35:18 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org BEC9A40131
Authentication-Results: smtp2.osuosl.org;
 dkim=pass (2048-bit key) header.d=gmail.com header.i=@gmail.com
 header.a=rsa-sha256 header.s=20221208 header.b=b26Xp4nT
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
 by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id XTsiAD6T2bFp
 for <virtualization@lists.linux-foundation.org>;
 Sat, 27 May 2023 12:35:17 +0000 (UTC)
X-Greylist: whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 030BA400EC
Received: from mail-lj1-x22a.google.com (mail-lj1-x22a.google.com
 [IPv6:2a00:1450:4864:20::22a])
 by smtp2.osuosl.org (Postfix) with ESMTPS id 030BA400EC
 for <virtualization@lists.linux-foundation.org>;
 Sat, 27 May 2023 12:35:16 +0000 (UTC)
Received: by mail-lj1-x22a.google.com with SMTP id
 38308e7fff4ca-2af7081c9ebso17487201fa.1
 for <virtualization@lists.linux-foundation.org>;
 Sat, 27 May 2023 05:35:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20221208; t=1685190915; x=1687782915;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:from:to:cc:subject:date
 :message-id:reply-to;
 bh=ekjweez7jWVSa/V93Gl8rT2iT1XdamZ260zaKqXPBDY=;
 b=b26Xp4nTUA1j1lsws8UqgbEzuPjr5wzipuiafivJOno4IRpeEwdnOe5psdlP5h+nDj
 logJiS8wBHNcZr+1V9XtPFkBcS27uLxnvS8vQO8TLX/aiI4y4FsQq7FtCf1MtNvAtuZ0
 gwgHfVEodHezTikxWOAp96D7MElX6uxLUQ1Y+4da34NSa3mOGrtEBgX7LZlitAkEbrBY
 ICVYwSdwFkM+BQtddE+CCW1+VSyMjZ/IWr9Lss326SKw80u5DVx6E79O1n2a2BVmw3xn
 sKhWIbA0a0ApDHGjQtog4oMFGEau9dTnGVgabjNRnIok9b1OBvk8zF1UBQAe+EaGkD5s
 L1pg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20221208; t=1685190915; x=1687782915;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
 :subject:date:message-id:reply-to;
 bh=ekjweez7jWVSa/V93Gl8rT2iT1XdamZ260zaKqXPBDY=;
 b=Iaw8VQ2Z3y++OwyiOfonn6OrezHxQcK9EK4zgT3X+vm4MRqo2GfG0qgaC7XTlj9ith
 MaRs/V5ssHFE/hqOTB3D2/kJ/L8LZHNptUwDHq7duyVFslmucMmmgDKQDZIzLVF+QFW6
 qrhf7lj3KDHDFkU1biKPtEGViDW+VYDwiCMtrmASZY47PAANDo9+rfKpX7/UyZoh14KE
 d9sHkQhZPo0mhkARPJC6s4MQhlexXZJNSOsqttlWY4s0RayRdqDfjQzcqoF4gzyQCl8l
 +Ui7M34cAB9p6DduWgwbJKPIdxfYOsfdyLdd36T+5dsiYjhooIX10FpthDkOplY2CRJr
 /RRg==
X-Gm-Message-State: AC+VfDyFoKISpDYhhWKg8YkijdZzsKJ8PAMatstToSnisjCYcfvQEiYy
 fxuFS2ot7TpovgeNHf+a8P/gkmYkVG+8Jk9MxXw=
X-Google-Smtp-Source: ACHHUZ5M4SYGvy5AJGzzCZX0eRX6XW8lkKD9ChAle0TH8wXU2xLZsUIweHPWvHTlS4lRQhTcucI/Lck8+oK1Sh9cW5k=
X-Received: by 2002:a2e:9aca:0:b0:29b:80b4:7bf7 with SMTP id
 p10-20020a2e9aca000000b0029b80b47bf7mr1609273ljj.41.1685190914636; Sat, 27
 May 2023 05:35:14 -0700 (PDT)
MIME-Version: 1.0
References: <20230526054621.18371-1-liangchen.linux@gmail.com>
 <20230526054621.18371-2-liangchen.linux@gmail.com>
 <CACGkMEv+5150S4ooWFMnUs-GpwRYgRMTku0ZgkFpH5iFR1qQsw@mail.gmail.com>
In-Reply-To: <CACGkMEv+5150S4ooWFMnUs-GpwRYgRMTku0ZgkFpH5iFR1qQsw@mail.gmail.com>
From: Liang Chen <liangchen.linux@gmail.com>
Date: Sat, 27 May 2023 20:35:01 +0800
Message-ID: <CAKhg4tL2b9LEsaNuLi94Zf9XQ4S2FyoXWzW9wTTkrU8L1qNQcQ@mail.gmail.com>
Subject: Re: [PATCH net-next 2/5] virtio_net: Add page_pool support to improve
 performance
To: Jason Wang <jasowang@redhat.com>
Cc: xuanzhuo@linux.alibaba.com, mst@redhat.com, netdev@vger.kernel.org,
 linux-kernel@vger.kernel.org, alexander.duyck@gmail.com,
 virtualization@lists.linux-foundation.org, edumazet@google.com,
 kuba@kernel.org, pabeni@redhat.com, davem@davemloft.net
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gRnJpLCBNYXkgMjYsIDIwMjMgYXQgMjo1MeKAr1BNIEphc29uIFdhbmcgPGphc293YW5nQHJl
ZGhhdC5jb20+IHdyb3RlOgo+Cj4gT24gRnJpLCBNYXkgMjYsIDIwMjMgYXQgMTo0NuKAr1BNIExp
YW5nIENoZW4gPGxpYW5nY2hlbi5saW51eEBnbWFpbC5jb20+IHdyb3RlOgo+ID4KPiA+IFRoZSBp
bXBsZW1lbnRhdGlvbiBhdCB0aGUgbW9tZW50IHVzZXMgb25lIHBhZ2UgcGVyIHBhY2tldCBpbiBi
b3RoIHRoZQo+ID4gbm9ybWFsIGFuZCBYRFAgcGF0aC4KPgo+IEl0J3MgYmV0dGVyIHRvIGV4cGxh
aW4gd2h5IHdlIG5lZWQgYSBwYWdlIHBvb2wgYW5kIGhvdyBpdCBjYW4gaGVscCB0aGUKPiBwZXJm
b3JtYW5jZS4KPgoKU3VyZSwgSSB3aWxsIGluY2x1ZGUgdGhhdCBvbiB2Mi4KPiA+IEluIGFkZGl0
aW9uLCBpbnRyb2R1Y2luZyBhIG1vZHVsZSBwYXJhbWV0ZXIgdG8gZW5hYmxlCj4gPiBvciBkaXNh
YmxlIHRoZSB1c2FnZSBvZiBwYWdlIHBvb2wgKGRpc2FibGVkIGJ5IGRlZmF1bHQpLgo+Cj4gSWYg
cGFnZSBwb29sIHdpbnMgZm9yIG1vc3Qgb2YgdGhlIGNhc2VzLCBhbnkgcmVhc29uIHRvIGRpc2Fi
bGUgaXQgYnkgZGVmYXVsdD8KPgoKVGhhbmsgeW91IGZvciByYWlzaW5nIHRoZSBwb2ludC4gSXQg
ZG9lcyBtYWtlIHNlbnNlIHRvIGVuYWJsZSBpdCBieSBkZWZhdWx0Lgo+ID4KPiA+IEluIHNpbmds
ZS1jb3JlIHZtIHRlc3RpbmcgZW52aXJvbm1lbnRzLCBpdCBnaXZlcyBhIG1vZGVzdCBwZXJmb3Jt
YW5jZSBnYWluCj4gPiBpbiB0aGUgbm9ybWFsIHBhdGguCj4gPiAgIFVwc3RyZWFtIGNvZGViYXNl
OiA0Ny41IEdiaXRzL3NlYwo+ID4gICBVcHN0cmVhbSBjb2RlYmFzZSArIHBhZ2VfcG9vbCBzdXBw
b3J0OiA1MC4yIEdiaXRzL3NlYwo+ID4KPiA+IEluIG11bHRpLWNvcmUgdm0gdGVzdGluZyBlbnZp
cm9ubWVudHMsIFRoZSBtb3N0IHNpZ25pZmljYW50IHBlcmZvcm1hbmNlCj4gPiBnYWluIGlzIG9i
c2VydmVkIGluIFhEUCBjcHVtYXA6Cj4gPiAgIFVwc3RyZWFtIGNvZGViYXNlOiAxLjM4IEdiaXRz
L3NlYwo+ID4gICBVcHN0cmVhbSBjb2RlYmFzZSArIHBhZ2VfcG9vbCBzdXBwb3J0OiA5Ljc0IEdi
aXRzL3NlYwo+Cj4gUGxlYXNlIHNob3cgbW9yZSBkZXRhaWxzIG9uIHRoZSB0ZXN0LiBFLmcgd2hp
Y2gga2luZHMgb2YgdGVzdHMgaGF2ZQo+IHlvdSBtZWFzdXJlZD8KPgo+IEJ0dywgaXQgd291bGQg
YmUgYmV0dGVyIHRvIG1lYXN1cmUgUFBTIGFzIHdlbGwuCj4KClN1cmUuIEl0IHdpbGwgYmUgYWRk
ZWQgb24gdjIuCj4gPgo+ID4gV2l0aCB0aGlzIGZvdW5kYXRpb24sIHdlIGNhbiBmdXJ0aGVyIGlu
dGVncmF0ZSBwYWdlIHBvb2wgZnJhZ21lbnRhdGlvbiBhbmQKPiA+IERNQSBtYXAvdW5tYXAgc3Vw
cG9ydC4KPiA+Cj4gPiBTaWduZWQtb2ZmLWJ5OiBMaWFuZyBDaGVuIDxsaWFuZ2NoZW4ubGludXhA
Z21haWwuY29tPgo+ID4gLS0tCj4gPiAgZHJpdmVycy9uZXQvdmlydGlvX25ldC5jIHwgMTg4ICsr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tLQo+Cj4gSSBiZWxpZXZlIHdlIHNo
b3VsZCBtYWtlIHZpcnRpby1uZXQgdG8gc2VsZWN0IENPTkZJR19QQUdFX1BPT0wgb3IgZG8KPiB0
aGUgaWZkZWYgdHJpY2tzIGF0IGxlYXN0Lgo+CgpTdXJlLiBpdCB3aWxsIGJlIGRvbmUgb24gdjIu
Cj4gPiAgMSBmaWxlIGNoYW5nZWQsIDE0NiBpbnNlcnRpb25zKCspLCA0MiBkZWxldGlvbnMoLSkK
PiA+Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvdmlydGlvX25ldC5jIGIvZHJpdmVycy9u
ZXQvdmlydGlvX25ldC5jCj4gPiBpbmRleCBjNWRjYTBkOTJlNjQuLjk5YzBjYTBjMTc4MSAxMDA2
NDQKPiA+IC0tLSBhL2RyaXZlcnMvbmV0L3ZpcnRpb19uZXQuYwo+ID4gKysrIGIvZHJpdmVycy9u
ZXQvdmlydGlvX25ldC5jCj4gPiBAQCAtMzEsNiArMzEsOSBAQCBtb2R1bGVfcGFyYW0oY3N1bSwg
Ym9vbCwgMDQ0NCk7Cj4gPiAgbW9kdWxlX3BhcmFtKGdzbywgYm9vbCwgMDQ0NCk7Cj4gPiAgbW9k
dWxlX3BhcmFtKG5hcGlfdHgsIGJvb2wsIDA2NDQpOwo+ID4KPiA+ICtzdGF0aWMgYm9vbCBwYWdl
X3Bvb2xfZW5hYmxlZDsKPiA+ICttb2R1bGVfcGFyYW0ocGFnZV9wb29sX2VuYWJsZWQsIGJvb2ws
IDA0MDApOwo+ID4gKwo+ID4gIC8qIEZJWE1FOiBNVFUgaW4gY29uZmlnLiAqLwo+ID4gICNkZWZp
bmUgR09PRF9QQUNLRVRfTEVOIChFVEhfSExFTiArIFZMQU5fSExFTiArIEVUSF9EQVRBX0xFTikK
PiA+ICAjZGVmaW5lIEdPT0RfQ09QWV9MRU4gIDEyOAo+ID4gQEAgLTE1OSw2ICsxNjIsOSBAQCBz
dHJ1Y3QgcmVjZWl2ZV9xdWV1ZSB7Cj4gPiAgICAgICAgIC8qIENoYWluIHBhZ2VzIGJ5IHRoZSBw
cml2YXRlIHB0ci4gKi8KPiA+ICAgICAgICAgc3RydWN0IHBhZ2UgKnBhZ2VzOwo+ID4KPiA+ICsg
ICAgICAgLyogUGFnZSBwb29sICovCj4gPiArICAgICAgIHN0cnVjdCBwYWdlX3Bvb2wgKnBhZ2Vf
cG9vbDsKPiA+ICsKPiA+ICAgICAgICAgLyogQXZlcmFnZSBwYWNrZXQgbGVuZ3RoIGZvciBtZXJn
ZWFibGUgcmVjZWl2ZSBidWZmZXJzLiAqLwo+ID4gICAgICAgICBzdHJ1Y3QgZXdtYV9wa3RfbGVu
IG1yZ19hdmdfcGt0X2xlbjsKPiA+Cj4gPiBAQCAtNDU5LDYgKzQ2NSwxNCBAQCBzdGF0aWMgc3Ry
dWN0IHNrX2J1ZmYgKnZpcnRuZXRfYnVpbGRfc2tiKHZvaWQgKmJ1ZiwgdW5zaWduZWQgaW50IGJ1
ZmxlbiwKPiA+ICAgICAgICAgcmV0dXJuIHNrYjsKPiA+ICB9Cj4gPgo+ID4gK3N0YXRpYyB2b2lk
IHZpcnRuZXRfcHV0X3BhZ2Uoc3RydWN0IHJlY2VpdmVfcXVldWUgKnJxLCBzdHJ1Y3QgcGFnZSAq
cGFnZSkKPiA+ICt7Cj4gPiArICAgICAgIGlmIChycS0+cGFnZV9wb29sKQo+ID4gKyAgICAgICAg
ICAgICAgIHBhZ2VfcG9vbF9wdXRfZnVsbF9wYWdlKHJxLT5wYWdlX3Bvb2wsIHBhZ2UsIHRydWUp
Owo+ID4gKyAgICAgICBlbHNlCj4gPiArICAgICAgICAgICAgICAgcHV0X3BhZ2UocGFnZSk7Cj4g
PiArfQo+ID4gKwo+ID4gIC8qIENhbGxlZCBmcm9tIGJvdHRvbSBoYWxmIGNvbnRleHQgKi8KPiA+
ICBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKnBhZ2VfdG9fc2tiKHN0cnVjdCB2aXJ0bmV0X2luZm8g
KnZpLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgcmVjZWl2
ZV9xdWV1ZSAqcnEsCj4gPiBAQCAtNTU1LDcgKzU2OSw3IEBAIHN0YXRpYyBzdHJ1Y3Qgc2tfYnVm
ZiAqcGFnZV90b19za2Ioc3RydWN0IHZpcnRuZXRfaW5mbyAqdmksCj4gPiAgICAgICAgIGhkciA9
IHNrYl92bmV0X2hkcihza2IpOwo+ID4gICAgICAgICBtZW1jcHkoaGRyLCBoZHJfcCwgaGRyX2xl
bik7Cj4gPiAgICAgICAgIGlmIChwYWdlX3RvX2ZyZWUpCj4gPiAtICAgICAgICAgICAgICAgcHV0
X3BhZ2UocGFnZV90b19mcmVlKTsKPiA+ICsgICAgICAgICAgICAgICB2aXJ0bmV0X3B1dF9wYWdl
KHJxLCBwYWdlX3RvX2ZyZWUpOwo+ID4KPiA+ICAgICAgICAgcmV0dXJuIHNrYjsKPiA+ICB9Cj4g
PiBAQCAtODAyLDcgKzgxNiw3IEBAIHN0YXRpYyBpbnQgdmlydG5ldF94ZHBfeG1pdChzdHJ1Y3Qg
bmV0X2RldmljZSAqZGV2LAo+ID4gICAgICAgICByZXR1cm4gcmV0Owo+ID4gIH0KPiA+Cj4gPiAt
c3RhdGljIHZvaWQgcHV0X3hkcF9mcmFncyhzdHJ1Y3QgeGRwX2J1ZmYgKnhkcCkKPiA+ICtzdGF0
aWMgdm9pZCBwdXRfeGRwX2ZyYWdzKHN0cnVjdCB4ZHBfYnVmZiAqeGRwLCBzdHJ1Y3QgcmVjZWl2
ZV9xdWV1ZSAqcnEpCj4gPiAgewo+Cj4gcnEgY291bGQgYmUgZmV0Y2hlZCBmcm9tIHhkcF9yeHFf
aW5mbz8KClllYWgsIGl0IGhhcyB0aGUgcXVldWVfaW5kZXggdGhlcmUuCj4KPiA+ICAgICAgICAg
c3RydWN0IHNrYl9zaGFyZWRfaW5mbyAqc2hpbmZvOwo+ID4gICAgICAgICBzdHJ1Y3QgcGFnZSAq
eGRwX3BhZ2U7Cj4gPiBAQCAtODEyLDcgKzgyNiw3IEBAIHN0YXRpYyB2b2lkIHB1dF94ZHBfZnJh
Z3Moc3RydWN0IHhkcF9idWZmICp4ZHApCj4gPiAgICAgICAgICAgICAgICAgc2hpbmZvID0geGRw
X2dldF9zaGFyZWRfaW5mb19mcm9tX2J1ZmYoeGRwKTsKPiA+ICAgICAgICAgICAgICAgICBmb3Ig
KGkgPSAwOyBpIDwgc2hpbmZvLT5ucl9mcmFnczsgaSsrKSB7Cj4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICB4ZHBfcGFnZSA9IHNrYl9mcmFnX3BhZ2UoJnNoaW5mby0+ZnJhZ3NbaV0pOwo+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgcHV0X3BhZ2UoeGRwX3BhZ2UpOwo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgdmlydG5ldF9wdXRfcGFnZShycSwgeGRwX3BhZ2UpOwo+ID4gICAgICAg
ICAgICAgICAgIH0KPiA+ICAgICAgICAgfQo+ID4gIH0KPiA+IEBAIC05MDMsNyArOTE3LDExIEBA
IHN0YXRpYyBzdHJ1Y3QgcGFnZSAqeGRwX2xpbmVhcml6ZV9wYWdlKHN0cnVjdCByZWNlaXZlX3F1
ZXVlICpycSwKPiA+ICAgICAgICAgaWYgKHBhZ2Vfb2ZmICsgKmxlbiArIHRhaWxyb29tID4gUEFH
RV9TSVpFKQo+ID4gICAgICAgICAgICAgICAgIHJldHVybiBOVUxMOwo+ID4KPiA+IC0gICAgICAg
cGFnZSA9IGFsbG9jX3BhZ2UoR0ZQX0FUT01JQyk7Cj4gPiArICAgICAgIGlmIChycS0+cGFnZV9w
b29sKQo+ID4gKyAgICAgICAgICAgICAgIHBhZ2UgPSBwYWdlX3Bvb2xfZGV2X2FsbG9jX3BhZ2Vz
KHJxLT5wYWdlX3Bvb2wpOwo+ID4gKyAgICAgICBlbHNlCj4gPiArICAgICAgICAgICAgICAgcGFn
ZSA9IGFsbG9jX3BhZ2UoR0ZQX0FUT01JQyk7Cj4gPiArCj4gPiAgICAgICAgIGlmICghcGFnZSkK
PiA+ICAgICAgICAgICAgICAgICByZXR1cm4gTlVMTDsKPiA+Cj4gPiBAQCAtOTI2LDIxICs5NDQs
MjQgQEAgc3RhdGljIHN0cnVjdCBwYWdlICp4ZHBfbGluZWFyaXplX3BhZ2Uoc3RydWN0IHJlY2Vp
dmVfcXVldWUgKnJxLAo+ID4gICAgICAgICAgICAgICAgICAqIGlzIHNlbmRpbmcgcGFja2V0IGxh
cmdlciB0aGFuIHRoZSBNVFUuCj4gPiAgICAgICAgICAgICAgICAgICovCj4gPiAgICAgICAgICAg
ICAgICAgaWYgKChwYWdlX29mZiArIGJ1ZmxlbiArIHRhaWxyb29tKSA+IFBBR0VfU0laRSkgewo+
ID4gLSAgICAgICAgICAgICAgICAgICAgICAgcHV0X3BhZ2UocCk7Cj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICB2aXJ0bmV0X3B1dF9wYWdlKHJxLCBwKTsKPiA+ICAgICAgICAgICAgICAgICAg
ICAgICAgIGdvdG8gZXJyX2J1ZjsKPiA+ICAgICAgICAgICAgICAgICB9Cj4gPgo+ID4gICAgICAg
ICAgICAgICAgIG1lbWNweShwYWdlX2FkZHJlc3MocGFnZSkgKyBwYWdlX29mZiwKPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgcGFnZV9hZGRyZXNzKHApICsgb2ZmLCBidWZsZW4pOwo+ID4gICAg
ICAgICAgICAgICAgIHBhZ2Vfb2ZmICs9IGJ1ZmxlbjsKPiA+IC0gICAgICAgICAgICAgICBwdXRf
cGFnZShwKTsKPiA+ICsgICAgICAgICAgICAgICB2aXJ0bmV0X3B1dF9wYWdlKHJxLCBwKTsKPiA+
ICAgICAgICAgfQo+ID4KPiA+ICAgICAgICAgLyogSGVhZHJvb20gZG9lcyBub3QgY29udHJpYnV0
ZSB0byBwYWNrZXQgbGVuZ3RoICovCj4gPiAgICAgICAgICpsZW4gPSBwYWdlX29mZiAtIFZJUlRJ
T19YRFBfSEVBRFJPT007Cj4gPiAgICAgICAgIHJldHVybiBwYWdlOwo+ID4gIGVycl9idWY6Cj4g
PiAtICAgICAgIF9fZnJlZV9wYWdlcyhwYWdlLCAwKTsKPiA+ICsgICAgICAgaWYgKHJxLT5wYWdl
X3Bvb2wpCj4gPiArICAgICAgICAgICAgICAgcGFnZV9wb29sX3B1dF9mdWxsX3BhZ2UocnEtPnBh
Z2VfcG9vbCwgcGFnZSwgdHJ1ZSk7Cj4gPiArICAgICAgIGVsc2UKPiA+ICsgICAgICAgICAgICAg
ICBfX2ZyZWVfcGFnZXMocGFnZSwgMCk7Cj4gPiAgICAgICAgIHJldHVybiBOVUxMOwo+ID4gIH0K
PiA+Cj4gPiBAQCAtMTE0NCw3ICsxMTY1LDcgQEAgc3RhdGljIHZvaWQgbWVyZ2VhYmxlX2J1Zl9m
cmVlKHN0cnVjdCByZWNlaXZlX3F1ZXVlICpycSwgaW50IG51bV9idWYsCj4gPiAgICAgICAgICAg
ICAgICAgfQo+ID4gICAgICAgICAgICAgICAgIHN0YXRzLT5ieXRlcyArPSBsZW47Cj4gPiAgICAg
ICAgICAgICAgICAgcGFnZSA9IHZpcnRfdG9faGVhZF9wYWdlKGJ1Zik7Cj4gPiAtICAgICAgICAg
ICAgICAgcHV0X3BhZ2UocGFnZSk7Cj4gPiArICAgICAgICAgICAgICAgdmlydG5ldF9wdXRfcGFn
ZShycSwgcGFnZSk7Cj4gPiAgICAgICAgIH0KPiA+ICB9Cj4gPgo+ID4gQEAgLTEyNjQsNyArMTI4
NSw3IEBAIHN0YXRpYyBpbnQgdmlydG5ldF9idWlsZF94ZHBfYnVmZl9tcmcoc3RydWN0IG5ldF9k
ZXZpY2UgKmRldiwKPiA+ICAgICAgICAgICAgICAgICBjdXJfZnJhZ19zaXplID0gdHJ1ZXNpemU7
Cj4gPiAgICAgICAgICAgICAgICAgeGRwX2ZyYWdzX3RydWVzeiArPSBjdXJfZnJhZ19zaXplOwo+
ID4gICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShsZW4gPiB0cnVlc2l6ZSAtIHJvb20gfHwg
Y3VyX2ZyYWdfc2l6ZSA+IFBBR0VfU0laRSkpIHsKPiA+IC0gICAgICAgICAgICAgICAgICAgICAg
IHB1dF9wYWdlKHBhZ2UpOwo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgdmlydG5ldF9wdXRf
cGFnZShycSwgcGFnZSk7Cj4gPiAgICAgICAgICAgICAgICAgICAgICAgICBwcl9kZWJ1ZygiJXM6
IHJ4IGVycm9yOiBsZW4gJXUgZXhjZWVkcyB0cnVlc2l6ZSAlbHVcbiIsCj4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBkZXYtPm5hbWUsIGxlbiwgKHVuc2lnbmVkIGxvbmcpKHRy
dWVzaXplIC0gcm9vbSkpOwo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgZGV2LT5zdGF0cy5y
eF9sZW5ndGhfZXJyb3JzKys7Cj4gPiBAQCAtMTI4Myw3ICsxMzA0LDcgQEAgc3RhdGljIGludCB2
aXJ0bmV0X2J1aWxkX3hkcF9idWZmX21yZyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ID4gICAg
ICAgICByZXR1cm4gMDsKPiA+Cj4gPiAgZXJyOgo+ID4gLSAgICAgICBwdXRfeGRwX2ZyYWdzKHhk
cCk7Cj4gPiArICAgICAgIHB1dF94ZHBfZnJhZ3MoeGRwLCBycSk7Cj4gPiAgICAgICAgIHJldHVy
biAtRUlOVkFMOwo+ID4gIH0KPiA+Cj4gPiBAQCAtMTM0NCw3ICsxMzY1LDEwIEBAIHN0YXRpYyB2
b2lkICptZXJnZWFibGVfeGRwX2dldF9idWYoc3RydWN0IHZpcnRuZXRfaW5mbyAqdmksCj4gPiAg
ICAgICAgICAgICAgICAgaWYgKCpsZW4gKyB4ZHBfcm9vbSA+IFBBR0VfU0laRSkKPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgIHJldHVybiBOVUxMOwo+ID4KPiA+IC0gICAgICAgICAgICAgICB4
ZHBfcGFnZSA9IGFsbG9jX3BhZ2UoR0ZQX0FUT01JQyk7Cj4gPiArICAgICAgICAgICAgICAgaWYg
KHJxLT5wYWdlX3Bvb2wpCj4gPiArICAgICAgICAgICAgICAgICAgICAgICB4ZHBfcGFnZSA9IHBh
Z2VfcG9vbF9kZXZfYWxsb2NfcGFnZXMocnEtPnBhZ2VfcG9vbCk7Cj4gPiArICAgICAgICAgICAg
ICAgZWxzZQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgeGRwX3BhZ2UgPSBhbGxvY19wYWdl
KEdGUF9BVE9NSUMpOwo+ID4gICAgICAgICAgICAgICAgIGlmICgheGRwX3BhZ2UpCj4gPiAgICAg
ICAgICAgICAgICAgICAgICAgICByZXR1cm4gTlVMTDsKPiA+Cj4gPiBAQCAtMTM1NCw3ICsxMzc4
LDcgQEAgc3RhdGljIHZvaWQgKm1lcmdlYWJsZV94ZHBfZ2V0X2J1ZihzdHJ1Y3QgdmlydG5ldF9p
bmZvICp2aSwKPiA+Cj4gPiAgICAgICAgICpmcmFtZV9zeiA9IFBBR0VfU0laRTsKPiA+Cj4gPiAt
ICAgICAgIHB1dF9wYWdlKCpwYWdlKTsKPiA+ICsgICAgICAgdmlydG5ldF9wdXRfcGFnZShycSwg
KnBhZ2UpOwo+ID4KPiA+ICAgICAgICAgKnBhZ2UgPSB4ZHBfcGFnZTsKPiA+Cj4gPiBAQCAtMTQw
MCw2ICsxNDI0LDggQEAgc3RhdGljIHN0cnVjdCBza19idWZmICpyZWNlaXZlX21lcmdlYWJsZV94
ZHAoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ICAgICAgICAgICAgICAgICBoZWFkX3NrYiA9
IGJ1aWxkX3NrYl9mcm9tX3hkcF9idWZmKGRldiwgdmksICZ4ZHAsIHhkcF9mcmFnc190cnVlc3op
Owo+ID4gICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghaGVhZF9za2IpKQo+ID4gICAgICAg
ICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gPiArICAgICAgICAgICAgICAgaWYgKHJxLT5wYWdl
X3Bvb2wpCj4gPiArICAgICAgICAgICAgICAgICAgICAgICBza2JfbWFya19mb3JfcmVjeWNsZSho
ZWFkX3NrYik7Cj4gPiAgICAgICAgICAgICAgICAgcmV0dXJuIGhlYWRfc2tiOwo+ID4KPiA+ICAg
ICAgICAgY2FzZSBYRFBfVFg6Cj4gPiBAQCAtMTQxMCwxMCArMTQzNiwxMCBAQCBzdGF0aWMgc3Ry
dWN0IHNrX2J1ZmYgKnJlY2VpdmVfbWVyZ2VhYmxlX3hkcChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2
LAo+ID4gICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gICAgICAgICB9Cj4gPgo+ID4gLSAgICAg
ICBwdXRfeGRwX2ZyYWdzKCZ4ZHApOwo+ID4gKyAgICAgICBwdXRfeGRwX2ZyYWdzKCZ4ZHAsIHJx
KTsKPiA+Cj4gPiAgZXJyX3hkcDoKPiA+IC0gICAgICAgcHV0X3BhZ2UocGFnZSk7Cj4gPiArICAg
ICAgIHZpcnRuZXRfcHV0X3BhZ2UocnEsIHBhZ2UpOwo+ID4gICAgICAgICBtZXJnZWFibGVfYnVm
X2ZyZWUocnEsIG51bV9idWYsIGRldiwgc3RhdHMpOwo+ID4KPiA+ICAgICAgICAgc3RhdHMtPnhk
cF9kcm9wcysrOwo+ID4gQEAgLTE0NjcsNiArMTQ5Myw5IEBAIHN0YXRpYyBzdHJ1Y3Qgc2tfYnVm
ZiAqcmVjZWl2ZV9tZXJnZWFibGUoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ICAgICAgICAg
aGVhZF9za2IgPSBwYWdlX3RvX3NrYih2aSwgcnEsIHBhZ2UsIG9mZnNldCwgbGVuLCB0cnVlc2l6
ZSwgaGVhZHJvb20pOwo+ID4gICAgICAgICBjdXJyX3NrYiA9IGhlYWRfc2tiOwo+ID4KPiA+ICsg
ICAgICAgaWYgKHJxLT5wYWdlX3Bvb2wpCj4gPiArICAgICAgICAgICAgICAgc2tiX21hcmtfZm9y
X3JlY3ljbGUoY3Vycl9za2IpOwo+ID4gKwo+ID4gICAgICAgICBpZiAodW5saWtlbHkoIWN1cnJf
c2tiKSkKPiA+ICAgICAgICAgICAgICAgICBnb3RvIGVycl9za2I7Cj4gPiAgICAgICAgIHdoaWxl
ICgtLW51bV9idWYpIHsKPiA+IEBAIC0xNTA5LDYgKzE1MzgsOCBAQCBzdGF0aWMgc3RydWN0IHNr
X2J1ZmYgKnJlY2VpdmVfbWVyZ2VhYmxlKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gPiAgICAg
ICAgICAgICAgICAgICAgICAgICBjdXJyX3NrYiA9IG5za2I7Cj4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICBoZWFkX3NrYi0+dHJ1ZXNpemUgKz0gbnNrYi0+dHJ1ZXNpemU7Cj4gPiAgICAgICAg
ICAgICAgICAgICAgICAgICBudW1fc2tiX2ZyYWdzID0gMDsKPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgIGlmIChycS0+cGFnZV9wb29sKQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBza2JfbWFya19mb3JfcmVjeWNsZShjdXJyX3NrYik7Cj4gPiAgICAgICAgICAgICAgICAg
fQo+ID4gICAgICAgICAgICAgICAgIGlmIChjdXJyX3NrYiAhPSBoZWFkX3NrYikgewo+ID4gICAg
ICAgICAgICAgICAgICAgICAgICAgaGVhZF9za2ItPmRhdGFfbGVuICs9IGxlbjsKPiA+IEBAIC0x
NTE3LDcgKzE1NDgsNyBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKnJlY2VpdmVfbWVyZ2VhYmxl
KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gPiAgICAgICAgICAgICAgICAgfQo+ID4gICAgICAg
ICAgICAgICAgIG9mZnNldCA9IGJ1ZiAtIHBhZ2VfYWRkcmVzcyhwYWdlKTsKPiA+ICAgICAgICAg
ICAgICAgICBpZiAoc2tiX2Nhbl9jb2FsZXNjZShjdXJyX3NrYiwgbnVtX3NrYl9mcmFncywgcGFn
ZSwgb2Zmc2V0KSkgewo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgcHV0X3BhZ2UocGFnZSk7
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICB2aXJ0bmV0X3B1dF9wYWdlKHJxLCBwYWdlKTsK
Pgo+IEkgd29uZGVyIHdoeSBub3Qgd2UgY2FuJ3QgZG8gdGhpcyBkdXJpbmcgYnVmZmVyIGFsbG9j
YXRpb24gbGlrZSBvdGhlciBkcml2ZXJzPwo+CgpTb3JyeSwgSSBkb24ndCBxdWl0ZSB1bmRlcnN0
YW5kIHRoZSBwb2ludCBoZXJlLiBXb3VsZCB5b3UgcGxlYXNlCmVsYWJvcmF0ZSBhIGJpdCBtb3Jl
Pwo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgc2tiX2NvYWxlc2NlX3J4X2ZyYWcoY3Vycl9z
a2IsIG51bV9za2JfZnJhZ3MgLSAxLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbGVuLCB0cnVlc2l6ZSk7Cj4gPiAgICAgICAgICAgICAgICAgfSBlbHNl
IHsKPiA+IEBAIC0xNTMwLDcgKzE1NjEsNyBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKnJlY2Vp
dmVfbWVyZ2VhYmxlKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gPiAgICAgICAgIHJldHVybiBo
ZWFkX3NrYjsKPiA+Cj4gPiAgZXJyX3NrYjoKPiA+IC0gICAgICAgcHV0X3BhZ2UocGFnZSk7Cj4g
PiArICAgICAgIHZpcnRuZXRfcHV0X3BhZ2UocnEsIHBhZ2UpOwo+ID4gICAgICAgICBtZXJnZWFi
bGVfYnVmX2ZyZWUocnEsIG51bV9idWYsIGRldiwgc3RhdHMpOwo+ID4KPiA+ICBlcnJfYnVmOgo+
ID4gQEAgLTE3MzcsMzEgKzE3NjgsNDAgQEAgc3RhdGljIGludCBhZGRfcmVjdmJ1Zl9tZXJnZWFi
bGUoc3RydWN0IHZpcnRuZXRfaW5mbyAqdmksCj4gPiAgICAgICAgICAqIGRpc2FibGVkIEdTTyBm
b3IgWERQLCBpdCB3b24ndCBiZSBhIGJpZyBpc3N1ZS4KPiA+ICAgICAgICAgICovCj4gPiAgICAg
ICAgIGxlbiA9IGdldF9tZXJnZWFibGVfYnVmX2xlbihycSwgJnJxLT5tcmdfYXZnX3BrdF9sZW4s
IHJvb20pOwo+ID4gLSAgICAgICBpZiAodW5saWtlbHkoIXNrYl9wYWdlX2ZyYWdfcmVmaWxsKGxl
biArIHJvb20sIGFsbG9jX2ZyYWcsIGdmcCkpKQo+ID4gLSAgICAgICAgICAgICAgIHJldHVybiAt
RU5PTUVNOwo+ID4gKyAgICAgICBpZiAocnEtPnBhZ2VfcG9vbCkgewo+ID4gKyAgICAgICAgICAg
ICAgIHN0cnVjdCBwYWdlICpwYWdlOwo+ID4KPiA+IC0gICAgICAgYnVmID0gKGNoYXIgKilwYWdl
X2FkZHJlc3MoYWxsb2NfZnJhZy0+cGFnZSkgKyBhbGxvY19mcmFnLT5vZmZzZXQ7Cj4gPiAtICAg
ICAgIGJ1ZiArPSBoZWFkcm9vbTsgLyogYWR2YW5jZSBhZGRyZXNzIGxlYXZpbmcgaG9sZSBhdCBm
cm9udCBvZiBwa3QgKi8KPiA+IC0gICAgICAgZ2V0X3BhZ2UoYWxsb2NfZnJhZy0+cGFnZSk7Cj4g
PiAtICAgICAgIGFsbG9jX2ZyYWctPm9mZnNldCArPSBsZW4gKyByb29tOwo+ID4gLSAgICAgICBo
b2xlID0gYWxsb2NfZnJhZy0+c2l6ZSAtIGFsbG9jX2ZyYWctPm9mZnNldDsKPiA+IC0gICAgICAg
aWYgKGhvbGUgPCBsZW4gKyByb29tKSB7Cj4gPiAtICAgICAgICAgICAgICAgLyogVG8gYXZvaWQg
aW50ZXJuYWwgZnJhZ21lbnRhdGlvbiwgaWYgdGhlcmUgaXMgdmVyeSBsaWtlbHkgbm90Cj4gPiAt
ICAgICAgICAgICAgICAgICogZW5vdWdoIHNwYWNlIGZvciBhbm90aGVyIGJ1ZmZlciwgYWRkIHRo
ZSByZW1haW5pbmcgc3BhY2UgdG8KPiA+IC0gICAgICAgICAgICAgICAgKiB0aGUgY3VycmVudCBi
dWZmZXIuCj4gPiAtICAgICAgICAgICAgICAgICogWERQIGNvcmUgYXNzdW1lcyB0aGF0IGZyYW1l
X3NpemUgb2YgeGRwX2J1ZmYgYW5kIHRoZSBsZW5ndGgKPiA+IC0gICAgICAgICAgICAgICAgKiBv
ZiB0aGUgZnJhZyBhcmUgUEFHRV9TSVpFLCBzbyB3ZSBkaXNhYmxlIHRoZSBob2xlIG1lY2hhbmlz
bS4KPiA+IC0gICAgICAgICAgICAgICAgKi8KPiA+IC0gICAgICAgICAgICAgICBpZiAoIWhlYWRy
b29tKQo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgbGVuICs9IGhvbGU7Cj4gPiAtICAgICAg
ICAgICAgICAgYWxsb2NfZnJhZy0+b2Zmc2V0ICs9IGhvbGU7Cj4gPiAtICAgICAgIH0KPiA+ICsg
ICAgICAgICAgICAgICBwYWdlID0gcGFnZV9wb29sX2Rldl9hbGxvY19wYWdlcyhycS0+cGFnZV9w
b29sKTsKPiA+ICsgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIXBhZ2UpKQo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gPiArICAgICAgICAgICAgICAgYnVm
ID0gKGNoYXIgKilwYWdlX2FkZHJlc3MocGFnZSk7Cj4gPiArICAgICAgICAgICAgICAgYnVmICs9
IGhlYWRyb29tOyAvKiBhZHZhbmNlIGFkZHJlc3MgbGVhdmluZyBob2xlIGF0IGZyb250IG9mIHBr
dCAqLwo+ID4gKyAgICAgICB9IGVsc2Ugewo+ID4gKyAgICAgICAgICAgICAgIGlmICh1bmxpa2Vs
eSghc2tiX3BhZ2VfZnJhZ19yZWZpbGwobGVuICsgcm9vbSwgYWxsb2NfZnJhZywgZ2ZwKSkpCj4K
PiBXaHkgbm90IHNpbXBseSB1c2UgYSBoZWxwZXIgbGlrZSB2aXJ0bmV0X3BhZ2VfZnJhZ19yZWZp
bGwoKSBhbmQgYWRkCj4gdGhlIHBhZ2VfcG9vbCBhbGxvY2F0aW9uIGxvZ2ljIHRoZXJlPyBJdCBo
ZWxwcyB0byByZWR1Y2UgdGhlCj4gY2hhbmdlc2V0Lgo+CgpTdXJlLiBXaWxsIGRvIHRoYXQgb24g
djIuCj4gPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiA+Cj4gPiAr
ICAgICAgICAgICAgICAgYnVmID0gKGNoYXIgKilwYWdlX2FkZHJlc3MoYWxsb2NfZnJhZy0+cGFn
ZSkgKyBhbGxvY19mcmFnLT5vZmZzZXQ7Cj4gPiArICAgICAgICAgICAgICAgYnVmICs9IGhlYWRy
b29tOyAvKiBhZHZhbmNlIGFkZHJlc3MgbGVhdmluZyBob2xlIGF0IGZyb250IG9mIHBrdCAqLwo+
ID4gKyAgICAgICAgICAgICAgIGdldF9wYWdlKGFsbG9jX2ZyYWctPnBhZ2UpOwo+ID4gKyAgICAg
ICAgICAgICAgIGFsbG9jX2ZyYWctPm9mZnNldCArPSBsZW4gKyByb29tOwo+ID4gKyAgICAgICAg
ICAgICAgIGhvbGUgPSBhbGxvY19mcmFnLT5zaXplIC0gYWxsb2NfZnJhZy0+b2Zmc2V0Owo+ID4g
KyAgICAgICAgICAgICAgIGlmIChob2xlIDwgbGVuICsgcm9vbSkgewo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgLyogVG8gYXZvaWQgaW50ZXJuYWwgZnJhZ21lbnRhdGlvbiwgaWYgdGhlcmUg
aXMgdmVyeSBsaWtlbHkgbm90Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgKiBlbm91Z2gg
c3BhY2UgZm9yIGFub3RoZXIgYnVmZmVyLCBhZGQgdGhlIHJlbWFpbmluZyBzcGFjZSB0bwo+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICogdGhlIGN1cnJlbnQgYnVmZmVyLgo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICogWERQIGNvcmUgYXNzdW1lcyB0aGF0IGZyYW1lX3NpemUgb2Yg
eGRwX2J1ZmYgYW5kIHRoZSBsZW5ndGgKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAqIG9m
IHRoZSBmcmFnIGFyZSBQQUdFX1NJWkUsIHNvIHdlIGRpc2FibGUgdGhlIGhvbGUgbWVjaGFuaXNt
Lgo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICovCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICBpZiAoIWhlYWRyb29tKQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBs
ZW4gKz0gaG9sZTsKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGFsbG9jX2ZyYWctPm9mZnNl
dCArPSBob2xlOwo+ID4gKyAgICAgICAgICAgICAgIH0KPiA+ICsgICAgICAgfQo+ID4gICAgICAg
ICBzZ19pbml0X29uZShycS0+c2csIGJ1ZiwgbGVuKTsKPiA+ICAgICAgICAgY3R4ID0gbWVyZ2Vh
YmxlX2xlbl90b19jdHgobGVuICsgcm9vbSwgaGVhZHJvb20pOwo+ID4gICAgICAgICBlcnIgPSB2
aXJ0cXVldWVfYWRkX2luYnVmX2N0eChycS0+dnEsIHJxLT5zZywgMSwgYnVmLCBjdHgsIGdmcCk7
Cj4gPiAgICAgICAgIGlmIChlcnIgPCAwKQo+ID4gLSAgICAgICAgICAgICAgIHB1dF9wYWdlKHZp
cnRfdG9faGVhZF9wYWdlKGJ1ZikpOwo+ID4gKyAgICAgICAgICAgICAgIHZpcnRuZXRfcHV0X3Bh
Z2UocnEsIHZpcnRfdG9faGVhZF9wYWdlKGJ1ZikpOwo+ID4KPiA+ICAgICAgICAgcmV0dXJuIGVy
cjsKPiA+ICB9Cj4gPiBAQCAtMTk5NCw4ICsyMDM0LDE1IEBAIHN0YXRpYyBpbnQgdmlydG5ldF9l
bmFibGVfcXVldWVfcGFpcihzdHJ1Y3QgdmlydG5ldF9pbmZvICp2aSwgaW50IHFwX2luZGV4KQo+
ID4gICAgICAgICBpZiAoZXJyIDwgMCkKPiA+ICAgICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+
ID4KPiA+IC0gICAgICAgZXJyID0geGRwX3J4cV9pbmZvX3JlZ19tZW1fbW9kZWwoJnZpLT5ycVtx
cF9pbmRleF0ueGRwX3J4cSwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgTUVNX1RZUEVfUEFHRV9TSEFSRUQsIE5VTEwpOwo+ID4gKyAgICAgICBpZiAodmktPnJx
W3FwX2luZGV4XS5wYWdlX3Bvb2wpCj4gPiArICAgICAgICAgICAgICAgZXJyID0geGRwX3J4cV9p
bmZvX3JlZ19tZW1fbW9kZWwoJnZpLT5ycVtxcF9pbmRleF0ueGRwX3J4cSwKPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNRU1fVFlQRV9QQUdFX1BP
T0wsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dmktPnJxW3FwX2luZGV4XS5wYWdlX3Bvb2wpOwo+ID4gKyAgICAgICBlbHNlCj4gPiArICAgICAg
ICAgICAgICAgZXJyID0geGRwX3J4cV9pbmZvX3JlZ19tZW1fbW9kZWwoJnZpLT5ycVtxcF9pbmRl
eF0ueGRwX3J4cSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBNRU1fVFlQRV9QQUdFX1NIQVJFRCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMKTsKPiA+ICsKPiA+ICAgICAgICAgaWYgKGVy
ciA8IDApCj4gPiAgICAgICAgICAgICAgICAgZ290byBlcnJfeGRwX3JlZ19tZW1fbW9kZWw7Cj4g
Pgo+ID4gQEAgLTI5NTEsNiArMjk5OCw3IEBAIHN0YXRpYyB2b2lkIHZpcnRuZXRfZ2V0X3N0cmlu
Z3Moc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgdTMyIHN0cmluZ3NldCwgdTggKmRhdGEpCj4gPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV0aHRvb2xfc3ByaW50ZigmcCwgInR4X3F1
ZXVlXyV1XyVzIiwgaSwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHZpcnRuZXRfc3Ffc3RhdHNfZGVzY1tqXS5kZXNjKTsKPiA+ICAgICAgICAgICAg
ICAgICB9Cj4gPiArICAgICAgICAgICAgICAgcGFnZV9wb29sX2V0aHRvb2xfc3RhdHNfZ2V0X3N0
cmluZ3MocCk7Cj4gPiAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gPiAgICAgICAgIH0KPiA+ICB9
Cj4gPiBAQCAtMjk2MiwxMiArMzAxMCwzMCBAQCBzdGF0aWMgaW50IHZpcnRuZXRfZ2V0X3NzZXRf
Y291bnQoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgaW50IHNzZXQpCj4gPiAgICAgICAgIHN3aXRj
aCAoc3NldCkgewo+ID4gICAgICAgICBjYXNlIEVUSF9TU19TVEFUUzoKPiA+ICAgICAgICAgICAg
ICAgICByZXR1cm4gdmktPmN1cnJfcXVldWVfcGFpcnMgKiAoVklSVE5FVF9SUV9TVEFUU19MRU4g
Kwo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWSVJU
TkVUX1NRX1NUQVRTX0xFTik7Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFZJUlRORVRfU1FfU1RBVFNfTEVOICsKPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChwYWdlX3Bvb2xfZW5hYmxlZCAmJiB2aS0+
bWVyZ2VhYmxlX3J4X2J1ZnMgPwo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHBhZ2VfcG9vbF9ldGh0b29sX3N0YXRzX2dldF9jb3VudCgpIDogMCkp
Owo+ID4gICAgICAgICBkZWZhdWx0Ogo+ID4gICAgICAgICAgICAgICAgIHJldHVybiAtRU9QTk9U
U1VQUDsKPiA+ICAgICAgICAgfQo+ID4gIH0KPiA+Cj4gPiArc3RhdGljIHZvaWQgdmlydG5ldF9n
ZXRfcGFnZV9wb29sX3N0YXRzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHU2NCAqZGF0YSkKPiA+
ICt7Cj4gPiArI2lmZGVmIENPTkZJR19QQUdFX1BPT0xfU1RBVFMKPiA+ICsgICAgICAgc3RydWN0
IHZpcnRuZXRfaW5mbyAqdmkgPSBuZXRkZXZfcHJpdihkZXYpOwo+ID4gKyAgICAgICBzdHJ1Y3Qg
cGFnZV9wb29sX3N0YXRzIHBwX3N0YXRzID0ge307Cj4gPiArICAgICAgIGludCBpOwo+ID4gKwo+
ID4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwgdmktPmN1cnJfcXVldWVfcGFpcnM7IGkrKykgewo+
ID4gKyAgICAgICAgICAgICAgIGlmICghdmktPnJxW2ldLnBhZ2VfcG9vbCkKPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGNvbnRpbnVlOwo+ID4gKyAgICAgICAgICAgICAgIHBhZ2VfcG9vbF9n
ZXRfc3RhdHModmktPnJxW2ldLnBhZ2VfcG9vbCwgJnBwX3N0YXRzKTsKPiA+ICsgICAgICAgfQo+
ID4gKyAgICAgICBwYWdlX3Bvb2xfZXRodG9vbF9zdGF0c19nZXQoZGF0YSwgJnBwX3N0YXRzKTsK
PiA+ICsjZW5kaWYgLyogQ09ORklHX1BBR0VfUE9PTF9TVEFUUyAqLwo+ID4gK30KPiA+ICsKPiA+
ICBzdGF0aWMgdm9pZCB2aXJ0bmV0X2dldF9ldGh0b29sX3N0YXRzKHN0cnVjdCBuZXRfZGV2aWNl
ICpkZXYsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBl
dGh0b29sX3N0YXRzICpzdGF0cywgdTY0ICpkYXRhKQo+ID4gIHsKPiA+IEBAIC0zMDAzLDYgKzMw
NjksOCBAQCBzdGF0aWMgdm9pZCB2aXJ0bmV0X2dldF9ldGh0b29sX3N0YXRzKHN0cnVjdCBuZXRf
ZGV2aWNlICpkZXYsCj4gPiAgICAgICAgICAgICAgICAgfSB3aGlsZSAodTY0X3N0YXRzX2ZldGNo
X3JldHJ5KCZzcS0+c3RhdHMuc3luY3AsIHN0YXJ0KSk7Cj4gPiAgICAgICAgICAgICAgICAgaWR4
ICs9IFZJUlRORVRfU1FfU1RBVFNfTEVOOwo+ID4gICAgICAgICB9Cj4gPiArCj4gPiArICAgICAg
IHZpcnRuZXRfZ2V0X3BhZ2VfcG9vbF9zdGF0cyhkZXYsICZkYXRhW2lkeF0pOwo+ID4gIH0KPiA+
Cj4gPiAgc3RhdGljIHZvaWQgdmlydG5ldF9nZXRfY2hhbm5lbHMoc3RydWN0IG5ldF9kZXZpY2Ug
KmRldiwKPiA+IEBAIC0zNjIzLDYgKzM2OTEsOCBAQCBzdGF0aWMgdm9pZCB2aXJ0bmV0X2ZyZWVf
cXVldWVzKHN0cnVjdCB2aXJ0bmV0X2luZm8gKnZpKQo+ID4gICAgICAgICBmb3IgKGkgPSAwOyBp
IDwgdmktPm1heF9xdWV1ZV9wYWlyczsgaSsrKSB7Cj4gPiAgICAgICAgICAgICAgICAgX19uZXRp
Zl9uYXBpX2RlbCgmdmktPnJxW2ldLm5hcGkpOwo+ID4gICAgICAgICAgICAgICAgIF9fbmV0aWZf
bmFwaV9kZWwoJnZpLT5zcVtpXS5uYXBpKTsKPiA+ICsgICAgICAgICAgICAgICBpZiAodmktPnJx
W2ldLnBhZ2VfcG9vbCkKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VfcG9vbF9kZXN0
cm95KHZpLT5ycVtpXS5wYWdlX3Bvb2wpOwo+ID4gICAgICAgICB9Cj4gPgo+ID4gICAgICAgICAv
KiBXZSBjYWxsZWQgX19uZXRpZl9uYXBpX2RlbCgpLAo+ID4gQEAgLTM2NzksMTIgKzM3NDksMTkg
QEAgc3RhdGljIHZvaWQgdmlydG5ldF9ycV9mcmVlX3VudXNlZF9idWYoc3RydWN0IHZpcnRxdWV1
ZSAqdnEsIHZvaWQgKmJ1ZikKPiA+ICAgICAgICAgc3RydWN0IHZpcnRuZXRfaW5mbyAqdmkgPSB2
cS0+dmRldi0+cHJpdjsKPiA+ICAgICAgICAgaW50IGkgPSB2cTJyeHEodnEpOwo+ID4KPiA+IC0g
ICAgICAgaWYgKHZpLT5tZXJnZWFibGVfcnhfYnVmcykKPiA+IC0gICAgICAgICAgICAgICBwdXRf
cGFnZSh2aXJ0X3RvX2hlYWRfcGFnZShidWYpKTsKPiA+IC0gICAgICAgZWxzZSBpZiAodmktPmJp
Z19wYWNrZXRzKQo+ID4gKyAgICAgICBpZiAodmktPm1lcmdlYWJsZV9yeF9idWZzKSB7Cj4gPiAr
ICAgICAgICAgICAgICAgaWYgKHZpLT5ycVtpXS5wYWdlX3Bvb2wpIHsKPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgIHBhZ2VfcG9vbF9wdXRfZnVsbF9wYWdlKHZpLT5ycVtpXS5wYWdlX3Bvb2ws
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXJ0
X3RvX2hlYWRfcGFnZShidWYpLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdHJ1ZSk7Cj4gPiArICAgICAgICAgICAgICAgfSBlbHNlIHsKPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgIHB1dF9wYWdlKHZpcnRfdG9faGVhZF9wYWdlKGJ1ZikpOwo+
ID4gKyAgICAgICAgICAgICAgIH0KPiA+ICsgICAgICAgfSBlbHNlIGlmICh2aS0+YmlnX3BhY2tl
dHMpIHsKPiA+ICAgICAgICAgICAgICAgICBnaXZlX3BhZ2VzKCZ2aS0+cnFbaV0sIGJ1Zik7Cj4K
PiBBbnkgcmVhc29uIG9ubHkgbWVyZ2VhYmxlIHdlcmUgbW9kaWZpZWQgYnV0IG5vdCBmb3Igc21h
bGwgYW5kIGJpZz8KPgo+IFRoYW5rcwo+CgpCaWcgbW9kZSB1c2VzIHRoZSBwYWdlIGNoYWluIHRv
IHJlY3ljbGUgcGFnZXMsIHRodXMgdGhlIHVzaW5nIG9mCiJwcml2YXRlIiBvZiB0aGUgYnVmZmVy
IHBhZ2UuIEkgd2lsbCB0YWtlIGZ1cnRoZXIgbG9vayBpbnRvIHRoYXQgdG8Kc2VlIGlmIGl0IGlz
IGJldHRlciB0byB1c2UgcGFnZSBwb29sIGluIHRoZXNlIGNhc2VzLiBUaGFua3MhCgoKCj4gPiAt
ICAgICAgIGVsc2UKPiA+ICsgICAgICAgfSBlbHNlIHsKPiA+ICAgICAgICAgICAgICAgICBwdXRf
cGFnZSh2aXJ0X3RvX2hlYWRfcGFnZShidWYpKTsKPiA+ICsgICAgICAgfQo+ID4gIH0KPiA+Cj4g
PiAgc3RhdGljIHZvaWQgZnJlZV91bnVzZWRfYnVmcyhzdHJ1Y3QgdmlydG5ldF9pbmZvICp2aSkK
PiA+IEBAIC0zNzE4LDYgKzM3OTUsMjYgQEAgc3RhdGljIHZvaWQgdmlydG5ldF9kZWxfdnFzKHN0
cnVjdCB2aXJ0bmV0X2luZm8gKnZpKQo+ID4gICAgICAgICB2aXJ0bmV0X2ZyZWVfcXVldWVzKHZp
KTsKPiA+ICB9Cj4gPgo+ID4gK3N0YXRpYyB2b2lkIHZpcnRuZXRfYWxsb2NfcGFnZV9wb29sKHN0
cnVjdCByZWNlaXZlX3F1ZXVlICpycSkKPiA+ICt7Cj4gPiArICAgICAgIHN0cnVjdCB2aXJ0aW9f
ZGV2aWNlICp2ZGV2ID0gcnEtPnZxLT52ZGV2Owo+ID4gKwo+ID4gKyAgICAgICBzdHJ1Y3QgcGFn
ZV9wb29sX3BhcmFtcyBwcF9wYXJhbXMgPSB7Cj4gPiArICAgICAgICAgICAgICAgLm9yZGVyID0g
MCwKPiA+ICsgICAgICAgICAgICAgICAucG9vbF9zaXplID0gcnEtPnZxLT5udW1fbWF4LAo+ID4g
KyAgICAgICAgICAgICAgIC5uaWQgPSBkZXZfdG9fbm9kZSh2ZGV2LT5kZXYucGFyZW50KSwKPiA+
ICsgICAgICAgICAgICAgICAuZGV2ID0gdmRldi0+ZGV2LnBhcmVudCwKPiA+ICsgICAgICAgICAg
ICAgICAub2Zmc2V0ID0gMCwKPiA+ICsgICAgICAgfTsKPiA+ICsKPiA+ICsgICAgICAgcnEtPnBh
Z2VfcG9vbCA9IHBhZ2VfcG9vbF9jcmVhdGUoJnBwX3BhcmFtcyk7Cj4gPiArICAgICAgIGlmIChJ
U19FUlIocnEtPnBhZ2VfcG9vbCkpIHsKPiA+ICsgICAgICAgICAgICAgICBkZXZfd2FybigmdmRl
di0+ZGV2LCAicGFnZSBwb29sIGNyZWF0aW9uIGZhaWxlZDogJWxkXG4iLAo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgIFBUUl9FUlIocnEtPnBhZ2VfcG9vbCkpOwo+ID4gKyAgICAgICAgICAg
ICAgIHJxLT5wYWdlX3Bvb2wgPSBOVUxMOwo+ID4gKyAgICAgICB9Cj4gPiArfQo+ID4gKwo+ID4g
IC8qIEhvdyBsYXJnZSBzaG91bGQgYSBzaW5nbGUgYnVmZmVyIGJlIHNvIGEgcXVldWUgZnVsbCBv
ZiB0aGVzZSBjYW4gZml0IGF0Cj4gPiAgICogbGVhc3Qgb25lIGZ1bGwgcGFja2V0Pwo+ID4gICAq
IExvZ2ljIGJlbG93IGFzc3VtZXMgdGhlIG1lcmdlYWJsZSBidWZmZXIgaGVhZGVyIGlzIHVzZWQu
Cj4gPiBAQCAtMzgwMSw2ICszODk4LDEzIEBAIHN0YXRpYyBpbnQgdmlydG5ldF9maW5kX3Zxcyhz
dHJ1Y3QgdmlydG5ldF9pbmZvICp2aSkKPiA+ICAgICAgICAgICAgICAgICB2aS0+cnFbaV0udnEg
PSB2cXNbcnhxMnZxKGkpXTsKPiA+ICAgICAgICAgICAgICAgICB2aS0+cnFbaV0ubWluX2J1Zl9s
ZW4gPSBtZXJnZWFibGVfbWluX2J1Zl9sZW4odmksIHZpLT5ycVtpXS52cSk7Cj4gPiAgICAgICAg
ICAgICAgICAgdmktPnNxW2ldLnZxID0gdnFzW3R4cTJ2cShpKV07Cj4gPiArCj4gPiArICAgICAg
ICAgICAgICAgaWYgKHBhZ2VfcG9vbF9lbmFibGVkICYmIHZpLT5tZXJnZWFibGVfcnhfYnVmcykK
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgIHZpcnRuZXRfYWxsb2NfcGFnZV9wb29sKCZ2aS0+
cnFbaV0pOwo+ID4gKyAgICAgICAgICAgICAgIGVsc2UKPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgIGRldl93YXJuKCZ2aS0+dmRldi0+ZGV2LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgInBhZ2UgcG9vbCBvbmx5IHN1cHBvcnQgbWVyZ2VhYmxlIG1vZGVcbiIpOwo+ID4g
Kwo+ID4gICAgICAgICB9Cj4gPgo+ID4gICAgICAgICAvKiBydW4gaGVyZTogcmV0ID09IDAuICov
Cj4gPiAtLQo+ID4gMi4zMS4xCj4gPgo+Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlv
bkBsaXN0cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlv
bi5vcmcvbWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
