Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp4.osuosl.org (smtp4.osuosl.org [IPv6:2605:bc80:3010::137])
	by mail.lfdr.de (Postfix) with ESMTPS id B3783707B72
	for <lists.virtualization@lfdr.de>; Thu, 18 May 2023 09:57:36 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp4.osuosl.org (Postfix) with ESMTP id 4501442836;
	Thu, 18 May 2023 07:57:35 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 4501442836
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
	by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id rEHRXPvtEufZ; Thu, 18 May 2023 07:57:34 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp4.osuosl.org (Postfix) with ESMTPS id 7555E4283B;
	Thu, 18 May 2023 07:57:33 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 7555E4283B
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id B8189C0089;
	Thu, 18 May 2023 07:57:32 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp4.osuosl.org (smtp4.osuosl.org [IPv6:2605:bc80:3010::137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id CAE3DC002A
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 07:57:30 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp4.osuosl.org (Postfix) with ESMTP id 975004283A
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 07:57:30 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 975004283A
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
 by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 7lb0ULqpr3qs
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 07:57:28 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 38DB342836
Received: from out30-133.freemail.mail.aliyun.com
 (out30-133.freemail.mail.aliyun.com [115.124.30.133])
 by smtp4.osuosl.org (Postfix) with ESMTPS id 38DB342836
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 07:57:27 +0000 (UTC)
X-Alimail-AntiSpam: AC=PASS; BC=-1|-1; BR=01201311R231e4; CH=green; DM=||false|;
 DS=||; FP=0|-1|-1|-1|0|-1|-1|-1; HT=ay29a033018046049;
 MF=xuanzhuo@linux.alibaba.com; NM=1; PH=DS; RN=4; SR=0;
 TI=SMTPD_---0Vivvm41_1684396641; 
Received: from localhost(mailfrom:xuanzhuo@linux.alibaba.com
 fp:SMTPD_---0Vivvm41_1684396641) by smtp.aliyun-inc.com;
 Thu, 18 May 2023 15:57:21 +0800
Message-ID: <1684396589.894549-2-xuanzhuo@linux.alibaba.com>
Subject: Re: [PATCH vhost v9 05/12] virtio_ring: split: virtqueue_add_split()
 support premapped
Date: Thu, 18 May 2023 15:56:29 +0800
From: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
To: Jason Wang <jasowang@redhat.com>
References: <20230517022249.20790-1-xuanzhuo@linux.alibaba.com>
 <20230517022249.20790-6-xuanzhuo@linux.alibaba.com>
 <CACGkMEu7+kDPiWmULXW_saW6pb5yF=gnqXRkSWcYbZCiJmszHQ@mail.gmail.com>
 <20230518030701-mutt-send-email-mst@kernel.org>
 <1684395232.2129312-1-xuanzhuo@linux.alibaba.com>
 <CACGkMEsgVnwgBiUnT3UfqKji3aNFEqhCXq6zpovjgKa5joAGtQ@mail.gmail.com>
In-Reply-To: <CACGkMEsgVnwgBiUnT3UfqKji3aNFEqhCXq6zpovjgKa5joAGtQ@mail.gmail.com>
Cc: Christoph Hellwig <hch@infradead.org>,
 virtualization@lists.linux-foundation.org,
 "Michael S. Tsirkin" <mst@redhat.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gVGh1LCAxOCBNYXkgMjAyMyAxNTo1NDowOSArMDgwMCwgSmFzb24gV2FuZyA8amFzb3dhbmdA
cmVkaGF0LmNvbT4gd3JvdGU6Cj4gT24gVGh1LCBNYXkgMTgsIDIwMjMgYXQgMzo0MeKAr1BNIFh1
YW4gWmh1byA8eHVhbnpodW9AbGludXguYWxpYmFiYS5jb20+IHdyb3RlOgo+ID4KPiA+IE9uIFRo
dSwgMTggTWF5IDIwMjMgMDM6MTE6MjUgLTA0MDAsICJNaWNoYWVsIFMuIFRzaXJraW4iIDxtc3RA
cmVkaGF0LmNvbT4gd3JvdGU6Cj4gPiA+IE9uIFRodSwgTWF5IDE4LCAyMDIzIGF0IDAyOjUxOjU3
UE0gKzA4MDAsIEphc29uIFdhbmcgd3JvdGU6Cj4gPiA+ID4gT24gV2VkLCBNYXkgMTcsIDIwMjMg
YXQgMTA6MjPigK9BTSBYdWFuIFpodW8gPHh1YW56aHVvQGxpbnV4LmFsaWJhYmEuY29tPiB3cm90
ZToKPiA+ID4gPiA+Cj4gPiA+ID4gPiB2aXJ0cXVldWVfYWRkX3NwbGl0KCkgb25seSBzdXBwb3J0
cyB2aXJ0dWFsIGFkZHJlc3NlcywgZG1hIGlzIGNvbXBsZXRlZAo+ID4gPiA+ID4gaW4gdmlydHF1
ZXVlX2FkZF9zcGxpdCgpLgo+ID4gPiA+ID4KPiA+ID4gPiA+IEluIHNvbWUgc2NlbmFyaW9zIChz
dWNoIGFzIHRoZSBBRl9YRFAgc2NlbmFyaW8pLCB0aGUgbWVtb3J5IGlzIGFsbG9jYXRlZAo+ID4g
PiA+ID4gYW5kIERNQSBpcyBjb21wbGV0ZWQgaW4gYWR2YW5jZSwgc28gaXQgaXMgbmVjZXNzYXJ5
IGZvciB1cyB0byBzdXBwb3J0Cj4gPiA+ID4gPiBwYXNzaW5nIHRoZSBETUEgYWRkcmVzcyB0byB2
aXJ0cXVldWVfYWRkX3NwbGl0KCkuCj4gPiA+ID4gPgo+ID4gPiA+ID4gUmVjb3JkIHRoaXMgaW5m
b3JtYXRpb24gaW4gZGVzY19zdGF0ZSwgd2UgY2FuIHNraXAgdW5tYXAgYmFzZWQgb24gdGhpcwo+
ID4gPiA+ID4gd2hlbiBleGVjdXRpbmcgZG1hIHVubWFwLgo+ID4gPiA+Cj4gPiA+ID4gSSB3b3Vs
ZCBhbHNvIHN1Z2dlc3QgZG9jdW1lbnRpbmcgd2h5IGEgcGVyIGRlc2NyaXB0b3IgbWV0YWRhdGEg
aXMKPiA+ID4gPiBuZWVkZWQgaW5zdGVhZCBvZiBhIHBlciB2aXJ0cXVldWUgb25lLgo+ID4gPgo+
ID4gPiBJIHRoaW5rIHdlIGNvdWxkIG1ha2UgaXQgcGVyIHZpcnRxdWV1ZS4gVGhhdCB3b3VsZCBt
ZWFuIGFsbCBjb2RlIGluCj4gPiA+IHZpcnRpbyBuZXQgd291bGQgaGF2ZSB0byBjaGFuZ2UgdG8g
ZG8gZG1hIG1hcHBpbmcgaXRzZWxmIGluc3RlYWQgb2YKPiA+ID4gcmVseWluZyBvbiB2aXJ0aW8g
Y29yZSB0aG91Z2guICBXaGljaCBpcyBtYXliZSBhIGdvb2QgaWRlYT8gRGVmaW5pdGVseSBhCj4g
PiA+IHZlcnkgaW50cnVzaXZlIGNoYW5nZSB0aG91Z2gsIHdpbGwgbmVlZCBhIGxvdCBvZiBwZXJm
b3JtYW5jZSB0ZXN0aW5nCj4gPiA+IHRvIG1ha2Ugc3VyZSB3ZSBkb24ndCBicmVhayBhbnl0aGlu
Zy4KPiA+Cj4gPiBJbiBmYWN0LCB3ZSBoYXZlIHRyaWVkIHRoaXMgaWRlYS4KPiA+Cj4gPiBUaGUg
cHJvYmxlbSBpcyB0aGUgZGV0YWNoIGFuZCB1bm1hcC4KPiA+Cj4gPiBXZSBuZWVkIHRvIGdldCBh
bGwgRE1BIEFkZHJlc3NlcyBmcm9tIHZpcnRpby1yaW5nIHRvIHVubWFwLiBDdXJyZW50bHksIGl0
IGRvZXMKPiA+IG5vdCBzdXBwb3J0IHRvIHJldHVybiB0aGUgRE1BIEFkZHJlc3MsCj4KPiBJJ20g
bm90IHN1cmUgSSBnb3QgaGVyZSwgYnV0IHdlJ3ZlIGFscmVhZHkgc3RvcmVkIHRoZSBETUEgYWRk
cmVzcyBpbiBkZXNjX2V4dHJhPwoKCkkgbWVhbiB3ZSBuZWVkIHRvIGdldCB0aGUgZG1hIGFkZHJl
c3MgZnJvbSB0aGUgdmlydGlvLWNvcmUgdG8gdmlydGlvLW5ldC4KClRoYW5rcy4KCgo+Cj4gPiBh
bmQgZm9yIFNLQiwgd2UgbmVlZCB0byBnZXQgbXVsdGlwbGUgRE1BCj4gPiBBZGRyZXNzZXMgYXQg
b25lIHRpbWUuCj4KPiBDb3VsZCB5b3UgZWxhYm9yYXRlIG9uIHRoaXM/Cj4KPiBUaGFua3MKPgo+
ID4KPiA+IFRoaXMgbmVlZCB0byBtb2RpZnkgdGhlIGxvZ2ljIG9mIFZpcnRpby1SaW5nIGRldGFj
aC4gQmVzaWRlcyB0aGlzLCBJIGFsc28gYWdyZWUKPiA+IHdpdGggdGhpcyBpZGVhLgo+ID4KPiA+
IFRoYW5rcy4KPiA+Cj4gPgo+ID4gPgo+ID4gPgo+ID4gPgo+ID4gPgo+ID4gPiA+ID4KPiA+ID4g
PiA+IFNpZ25lZC1vZmYtYnk6IFh1YW4gWmh1byA8eHVhbnpodW9AbGludXguYWxpYmFiYS5jb20+
Cj4gPiA+ID4gPiAtLS0KPiA+ID4gPiA+ICBkcml2ZXJzL3ZpcnRpby92aXJ0aW9fcmluZy5jIHwg
MzggKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tCj4gPiA+ID4gPiAgMSBmaWxl
IGNoYW5nZWQsIDI5IGluc2VydGlvbnMoKyksIDkgZGVsZXRpb25zKC0pCj4gPiA+ID4gPgo+ID4g
PiA+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5nLmMgYi9kcml2ZXJz
L3ZpcnRpby92aXJ0aW9fcmluZy5jCj4gPiA+ID4gPiBpbmRleCBlMmZjNTBjMDViZWMuLmJkNWU4
NGFmYWIzNyAxMDA2NDQKPiA+ID4gPiA+IC0tLSBhL2RyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5n
LmMKPiA+ID4gPiA+ICsrKyBiL2RyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5nLmMKPiA+ID4gPiA+
IEBAIC03MCw2ICs3MCw3IEBACj4gPiA+ID4gPiAgc3RydWN0IHZyaW5nX2Rlc2Nfc3RhdGVfc3Bs
aXQgewo+ID4gPiA+ID4gICAgICAgICB2b2lkICpkYXRhOyAgICAgICAgICAgICAgICAgICAgIC8q
IERhdGEgZm9yIGNhbGxiYWNrLiAqLwo+ID4gPiA+ID4gICAgICAgICBzdHJ1Y3QgdnJpbmdfZGVz
YyAqaW5kaXJfZGVzYzsgIC8qIEluZGlyZWN0IGRlc2NyaXB0b3IsIGlmIGFueS4gKi8KPiA+ID4g
PiA+ICsgICAgICAgYm9vbCBwcmVtYXBwZWQ7ICAgICAgICAgICAgICAgICAvKiBETUEgbWFwcGlu
ZyBpcyBkb25lIGJ5IGRyaXZlci4gKi8KPiA+ID4gPgo+ID4gPiA+IEdvaW5nIGJhY2sgdG8gdGhl
IG9yaWdpbmFsIGRpc2N1c3Npb24gYXJvdW5kIHdoZXJlIHRoaXMgc2hvdWxkIGJlCj4gPiA+ID4g
cGxhY2VkLiBJIHdvbmRlciBpZiB3ZSBjYW4gZmluZCBhIGNvbW1vbiBwbGFjZSB0byBzdG9yZSB0
aGlzIHNpbmNlIGl0Cj4gPiA+ID4gaGFzIG5vdGhpbmcgcmVsYXRlZCB0byB2aXJ0cXVldWUgbGF5
b3V0LiBNYXliZSBkZXNjX2V4dHJhPyBBbmQgaXQKPiA+ID4gPiB3b3VsZCBiZSBldmVuIGJldHRl
ciBpZiB3ZSBjYW4gYXZvaWQgc3RyZXNzaW5nIHRoZSBjYWNoZSBsaWtlIGFib3ZlLgo+ID4gPiA+
Cj4gPiA+ID4gPiAgfTsKPiA+ID4gPiA+Cj4gPiA+ID4gPiAgc3RydWN0IHZyaW5nX2Rlc2Nfc3Rh
dGVfcGFja2VkIHsKPiA+ID4gPiA+IEBAIC0zNTYsOCArMzU3LDE0IEBAIHN0YXRpYyBzdHJ1Y3Qg
ZGV2aWNlICp2cmluZ19kbWFfZGV2KGNvbnN0IHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxKQo+
ID4gPiA+ID4KPiA+ID4gPiA+ICAvKiBNYXAgb25lIHNnIGVudHJ5LiAqLwo+ID4gPiA+ID4gIHN0
YXRpYyBpbnQgdnJpbmdfbWFwX29uZV9zZyhjb25zdCBzdHJ1Y3QgdnJpbmdfdmlydHF1ZXVlICp2
cSwgc3RydWN0IHNjYXR0ZXJsaXN0ICpzZywKPiA+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICBlbnVtIGRtYV9kYXRhX2RpcmVjdGlvbiBkaXJlY3Rpb24sIHN0YXRpYyBkbWFfYWRk
cl90ICphZGRyKQo+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudW0gZG1h
X2RhdGFfZGlyZWN0aW9uIGRpcmVjdGlvbiwKPiA+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICBib29sIHByZW1hcHBlZCwgZG1hX2FkZHJfdCAqYWRkcikKPiA+ID4gPgo+ID4gPiA+
IGhhdmluZyB0aGluZ3MgbGlrZToKPiA+ID4gPgo+ID4gPiA+IGludCBmdW5jKGJvb2wgZG8pCj4g
PiA+ID4gewo+ID4gPiA+IGlmICghZG8pCj4gPiA+ID4gICAgIHJldHVybjsKPiA+ID4gPiB9Cj4g
PiA+ID4KPiA+ID4gPiBpcyBhIGhpbnQgdGhhdCB0aGUgY2hlY2sgbmVlZHMgdG8gYmUgZG9uZSBi
eSB0aGUgY2FsbGVyPwo+ID4gPiA+Cj4gPiA+ID4gQW5kIHRoaXMgY2hhbmdlIHNob3VsZCB3b3Jr
IGZvciBib3RoIHBhY2tlZCBhbmQgc3BsaXQuIEkgdGhpbmsgd2UgbmVlZAo+ID4gPiA+IHRvIHNx
dWFzaCB0aGUgcGFja2VkIGNoYW5nZXMgaGVyZS4KPiA+ID4gPgo+ID4gPiA+IExvb2tpbmcgYXQg
aG93IHBhY2tlZCB2aXJ0cXVldWUgdXNlcyB0aGlzIGluIHRoaXMgcGF0Y2gsIEkgZG9uJ3QgdGhp
bmsKPiA+ID4gPiB0aGlzIHBhdGNoIGNhbiBldmVuIGJlIGJ1aWx0LiBJIHdpbGwgd2FpdCBmb3Ig
YSBuZXcgdmVyc2lvbiBhbmQKPiA+ID4gPiBjb250aW51ZSB0aGUgcmV2aWV3IGZyb20gdGhlcmUu
Cj4gPiA+ID4KPiA+ID4gPiBUaGFua3MKPiA+ID4gPgo+ID4gPiA+Cj4gPiA+ID4KPiA+ID4gPiA+
ICB7Cj4gPiA+ID4gPiArICAgICAgIGlmIChwcmVtYXBwZWQpIHsKPiA+ID4gPiA+ICsgICAgICAg
ICAgICAgICAqYWRkciA9IHNnX2RtYV9hZGRyZXNzKHNnKTsKPiA+ID4gPiA+ICsgICAgICAgICAg
ICAgICByZXR1cm4gMDsKPiA+ID4gPiA+ICsgICAgICAgfQo+ID4gPiA+ID4gKwo+ID4gPiA+ID4g
ICAgICAgICBpZiAoIXZxLT51c2VfZG1hX2FwaSkgewo+ID4gPiA+ID4gICAgICAgICAgICAgICAg
IC8qCj4gPiA+ID4gPiAgICAgICAgICAgICAgICAgICogSWYgRE1BIGlzIG5vdCB1c2VkLCBLTVNB
TiBkb2Vzbid0IGtub3cgdGhhdCB0aGUgc2NhdHRlcmxpc3QKPiA+ID4gPiA+IEBAIC00NDUsNyAr
NDUyLDcgQEAgc3RhdGljIHZvaWQgdnJpbmdfdW5tYXBfb25lX3NwbGl0X2luZGlyZWN0KGNvbnN0
IHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLAo+ID4gPiA+ID4gIH0KPiA+ID4gPiA+Cj4gPiA+
ID4gPiAgc3RhdGljIHVuc2lnbmVkIGludCB2cmluZ191bm1hcF9vbmVfc3BsaXQoY29uc3Qgc3Ry
dWN0IHZyaW5nX3ZpcnRxdWV1ZSAqdnEsCj4gPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgaSkKPiA+ID4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBpLCBib29sIHByZW1h
cHBlZCkKPiA+ID4gPiA+ICB7Cj4gPiA+ID4gPiAgICAgICAgIHN0cnVjdCB2cmluZ19kZXNjX2V4
dHJhICpleHRyYSA9IHZxLT5zcGxpdC5kZXNjX2V4dHJhOwo+ID4gPiA+ID4gICAgICAgICB1MTYg
ZmxhZ3M7Cj4gPiA+ID4gPiBAQCAtNDYyLDYgKzQ2OSw5IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQg
dnJpbmdfdW5tYXBfb25lX3NwbGl0KGNvbnN0IHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLAo+
ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGZsYWdzICYgVlJJTkdf
REVTQ19GX1dSSVRFKSA/Cj4gPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBETUFfRlJPTV9ERVZJQ0UgOiBETUFfVE9fREVWSUNFKTsKPiA+ID4gPiA+ICAgICAgICAgfSBl
bHNlIHsKPiA+ID4gPiA+ICsgICAgICAgICAgICAgICBpZiAocHJlbWFwcGVkKQo+ID4gPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXQ7Cj4gPiA+ID4gPiArCj4gPiA+ID4gPiAg
ICAgICAgICAgICAgICAgZG1hX3VubWFwX3BhZ2UodnJpbmdfZG1hX2Rldih2cSksCj4gPiA+ID4g
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFbaV0uYWRkciwKPiA+ID4gPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYVtpXS5sZW4sCj4gPiA+ID4gPiBA
QCAtNTMyLDYgKzU0Miw3IEBAIHN0YXRpYyBpbmxpbmUgaW50IHZpcnRxdWV1ZV9hZGRfc3BsaXQo
c3RydWN0IHZpcnRxdWV1ZSAqX3ZxLAo+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgaW5fc2dzLAo+ID4gPiA+ID4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpkYXRhLAo+ID4gPiA+ID4gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpjdHgsCj4gPiA+ID4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgcHJlbWFwcGVkLAo+ID4gPiA+ID4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZnBfdCBnZnApCj4gPiA+ID4g
PiAgewo+ID4gPiA+ID4gICAgICAgICBzdHJ1Y3QgdnJpbmdfdmlydHF1ZXVlICp2cSA9IHRvX3Z2
cShfdnEpOwo+ID4gPiA+ID4gQEAgLTU5NSw3ICs2MDYsNyBAQCBzdGF0aWMgaW5saW5lIGludCB2
aXJ0cXVldWVfYWRkX3NwbGl0KHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ID4gPiA+ICAgICAg
ICAgICAgICAgICBmb3IgKHNnID0gc2dzW25dOyBzZzsgc2cgPSBzZ19uZXh0KHNnKSkgewo+ID4g
PiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgZG1hX2FkZHJfdCBhZGRyOwo+ID4gPiA+ID4K
PiA+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmICh2cmluZ19tYXBfb25lX3NnKHZx
LCBzZywgRE1BX1RPX0RFVklDRSwgJmFkZHIpKQo+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgaWYgKHZyaW5nX21hcF9vbmVfc2codnEsIHNnLCBETUFfVE9fREVWSUNFLCBwcmVtYXBw
ZWQsICZhZGRyKSkKPiA+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290
byB1bm1hcF9yZWxlYXNlOwo+ID4gPiA+ID4KPiA+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAgIHByZXYgPSBpOwo+ID4gPiA+ID4gQEAgLTYxMSw3ICs2MjIsNyBAQCBzdGF0aWMgaW5saW5l
IGludCB2aXJ0cXVldWVfYWRkX3NwbGl0KHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ID4gPiA+
ICAgICAgICAgICAgICAgICBmb3IgKHNnID0gc2dzW25dOyBzZzsgc2cgPSBzZ19uZXh0KHNnKSkg
ewo+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgZG1hX2FkZHJfdCBhZGRyOwo+ID4g
PiA+ID4KPiA+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmICh2cmluZ19tYXBfb25l
X3NnKHZxLCBzZywgRE1BX0ZST01fREVWSUNFLCAmYWRkcikpCj4gPiA+ID4gPiArICAgICAgICAg
ICAgICAgICAgICAgICBpZiAodnJpbmdfbWFwX29uZV9zZyh2cSwgc2csIERNQV9GUk9NX0RFVklD
RSwgcHJlbWFwcGVkLCAmYWRkcikpCj4gPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGdvdG8gdW5tYXBfcmVsZWFzZTsKPiA+ID4gPiA+Cj4gPiA+ID4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICBwcmV2ID0gaTsKPiA+ID4gPiA+IEBAIC02NTcsNiArNjY4LDcgQEAgc3Rh
dGljIGlubGluZSBpbnQgdmlydHF1ZXVlX2FkZF9zcGxpdChzdHJ1Y3QgdmlydHF1ZXVlICpfdnEs
Cj4gPiA+ID4gPgo+ID4gPiA+ID4gICAgICAgICAvKiBTdG9yZSB0b2tlbiBhbmQgaW5kaXJlY3Qg
YnVmZmVyIHN0YXRlLiAqLwo+ID4gPiA+ID4gICAgICAgICB2cS0+c3BsaXQuZGVzY19zdGF0ZVto
ZWFkXS5kYXRhID0gZGF0YTsKPiA+ID4gPiA+ICsgICAgICAgdnEtPnNwbGl0LmRlc2Nfc3RhdGVb
aGVhZF0ucHJlbWFwcGVkID0gcHJlbWFwcGVkOwo+ID4gPiA+ID4gICAgICAgICBpZiAoaW5kaXJl
Y3QpCj4gPiA+ID4gPiAgICAgICAgICAgICAgICAgdnEtPnNwbGl0LmRlc2Nfc3RhdGVbaGVhZF0u
aW5kaXJfZGVzYyA9IGRlc2M7Cj4gPiA+ID4gPiAgICAgICAgIGVsc2UKPiA+ID4gPiA+IEBAIC02
ODYsNiArNjk4LDE0IEBAIHN0YXRpYyBpbmxpbmUgaW50IHZpcnRxdWV1ZV9hZGRfc3BsaXQoc3Ry
dWN0IHZpcnRxdWV1ZSAqX3ZxLAo+ID4gPiA+ID4gICAgICAgICByZXR1cm4gMDsKPiA+ID4gPiA+
Cj4gPiA+ID4gPiAgdW5tYXBfcmVsZWFzZToKPiA+ID4gPiA+ICsgICAgICAgaWYgKHByZW1hcHBl
ZCkgewo+ID4gPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChpbmRpcmVjdCkKPiA+ID4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGtmcmVlKGRlc2MpOwo+ID4gPiA+ID4gKwo+ID4gPiA+ID4g
KyAgICAgICAgICAgICAgIEVORF9VU0UodnEpOwo+ID4gPiA+ID4gKyAgICAgICAgICAgICAgIHJl
dHVybiAtRU5PTUVNOwo+ID4gPiA+ID4gKyAgICAgICB9Cj4gPiA+ID4gPiArCj4gPiA+ID4gPiAg
ICAgICAgIGVycl9pZHggPSBpOwo+ID4gPiA+ID4KPiA+ID4gPiA+ICAgICAgICAgaWYgKGluZGly
ZWN0KQo+ID4gPiA+ID4gQEAgLTcwMCw3ICs3MjAsNyBAQCBzdGF0aWMgaW5saW5lIGludCB2aXJ0
cXVldWVfYWRkX3NwbGl0KHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ID4gPiA+ICAgICAgICAg
ICAgICAgICAgICAgICAgIHZyaW5nX3VubWFwX29uZV9zcGxpdF9pbmRpcmVjdCh2cSwgJmRlc2Nb
aV0pOwo+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgaSA9IHZpcnRpbzE2X3RvX2Nw
dShfdnEtPnZkZXYsIGRlc2NbaV0ubmV4dCk7Cj4gPiA+ID4gPiAgICAgICAgICAgICAgICAgfSBl
bHNlCj4gPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBpID0gdnJpbmdfdW5tYXBfb25l
X3NwbGl0KHZxLCBpKTsKPiA+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGkgPSB2cmlu
Z191bm1hcF9vbmVfc3BsaXQodnEsIGksIGZhbHNlKTsKPiA+ID4gPiA+ICAgICAgICAgfQo+ID4g
PiA+ID4KPiA+ID4gPiA+ICAgICAgICAgaWYgKGluZGlyZWN0KQo+ID4gPiA+ID4gQEAgLTc1Nywx
MiArNzc3LDEyIEBAIHN0YXRpYyB2b2lkIGRldGFjaF9idWZfc3BsaXQoc3RydWN0IHZyaW5nX3Zp
cnRxdWV1ZSAqdnEsIHVuc2lnbmVkIGludCBoZWFkLAo+ID4gPiA+ID4gICAgICAgICBpID0gaGVh
ZDsKPiA+ID4gPiA+Cj4gPiA+ID4gPiAgICAgICAgIHdoaWxlICh2cS0+c3BsaXQudnJpbmcuZGVz
Y1tpXS5mbGFncyAmIG5leHRmbGFnKSB7Cj4gPiA+ID4gPiAtICAgICAgICAgICAgICAgdnJpbmdf
dW5tYXBfb25lX3NwbGl0KHZxLCBpKTsKPiA+ID4gPiA+ICsgICAgICAgICAgICAgICB2cmluZ191
bm1hcF9vbmVfc3BsaXQodnEsIGksIHN0YXRlLT5wcmVtYXBwZWQpOwo+ID4gPiA+ID4gICAgICAg
ICAgICAgICAgIGkgPSB2cS0+c3BsaXQuZGVzY19leHRyYVtpXS5uZXh0Owo+ID4gPiA+ID4gICAg
ICAgICAgICAgICAgIHZxLT52cS5udW1fZnJlZSsrOwo+ID4gPiA+ID4gICAgICAgICB9Cj4gPiA+
ID4gPgo+ID4gPiA+ID4gLSAgICAgICB2cmluZ191bm1hcF9vbmVfc3BsaXQodnEsIGkpOwo+ID4g
PiA+ID4gKyAgICAgICB2cmluZ191bm1hcF9vbmVfc3BsaXQodnEsIGksIHN0YXRlLT5wcmVtYXBw
ZWQpOwo+ID4gPiA+ID4gICAgICAgICB2cS0+c3BsaXQuZGVzY19leHRyYVtpXS5uZXh0ID0gdnEt
PmZyZWVfaGVhZDsKPiA+ID4gPiA+ICAgICAgICAgdnEtPmZyZWVfaGVhZCA9IGhlYWQ7Cj4gPiA+
ID4gPgo+ID4gPiA+ID4gQEAgLTc4Myw3ICs4MDMsNyBAQCBzdGF0aWMgdm9pZCBkZXRhY2hfYnVm
X3NwbGl0KHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLCB1bnNpZ25lZCBpbnQgaGVhZCwKPiA+
ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVlJJTkdfREVTQ19GX0lORElS
RUNUKSk7Cj4gPiA+ID4gPiAgICAgICAgICAgICAgICAgQlVHX09OKGxlbiA9PSAwIHx8IGxlbiAl
IHNpemVvZihzdHJ1Y3QgdnJpbmdfZGVzYykpOwo+ID4gPiA+ID4KPiA+ID4gPiA+IC0gICAgICAg
ICAgICAgICBpZiAodnEtPnVzZV9kbWFfYXBpKSB7Cj4gPiA+ID4gPiArICAgICAgICAgICAgICAg
aWYgKHZxLT51c2VfZG1hX2FwaSAmJiAhc3RhdGUtPnByZW1hcHBlZCkgewo+ID4gPiA+ID4gICAg
ICAgICAgICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IGxlbiAvIHNpemVvZihzdHJ1Y3Qg
dnJpbmdfZGVzYyk7IGorKykKPiA+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdnJpbmdfdW5tYXBfb25lX3NwbGl0X2luZGlyZWN0KHZxLCAmaW5kaXJfZGVzY1tqXSk7Cj4g
PiA+ID4gPiAgICAgICAgICAgICAgICAgfQo+ID4gPiA+ID4gQEAgLTIxNDMsNyArMjE2Myw3IEBA
IHN0YXRpYyBpbmxpbmUgaW50IHZpcnRxdWV1ZV9hZGQoc3RydWN0IHZpcnRxdWV1ZSAqX3ZxLAo+
ID4gPiA+ID4gICAgICAgICByZXR1cm4gdnEtPnBhY2tlZF9yaW5nID8gdmlydHF1ZXVlX2FkZF9w
YWNrZWQoX3ZxLCBzZ3MsIHRvdGFsX3NnLAo+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIG91dF9zZ3MsIGluX3NncywgZGF0YSwgY3R4LCBnZnApIDoKPiA+
ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpcnRxdWV1ZV9hZGRfc3Bs
aXQoX3ZxLCBzZ3MsIHRvdGFsX3NnLAo+ID4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIG91dF9zZ3MsIGluX3NncywgZGF0YSwgY3R4LCBnZnApOwo+ID4gPiA+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dF9zZ3MsIGluX3Nn
cywgZGF0YSwgY3R4LCBwcmVtYXBwZWQsIGdmcCk7Cj4gPiA+ID4gPiAgfQo+ID4gPiA+ID4KPiA+
ID4gPiA+ICAvKioKPiA+ID4gPiA+IC0tCj4gPiA+ID4gPiAyLjMyLjAuMy5nMDExOTVjZjlmCj4g
PiA+ID4gPgo+ID4gPgo+ID4KPgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmlydHVhbGl6YXRpb25AbGlz
dHMubGludXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51eGZvdW5kYXRpb24ub3Jn
L21haWxtYW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
