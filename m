Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp4.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 918E4434339
	for <lists.virtualization@lfdr.de>; Wed, 20 Oct 2021 04:02:40 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp4.osuosl.org (Postfix) with ESMTP id 9A3B14043C;
	Wed, 20 Oct 2021 02:02:38 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
	by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id n7wnOXTY4fGR; Wed, 20 Oct 2021 02:02:37 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by smtp4.osuosl.org (Postfix) with ESMTPS id D50484036A;
	Wed, 20 Oct 2021 02:02:36 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 7C4EDC000D;
	Wed, 20 Oct 2021 02:02:36 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp2.osuosl.org (smtp2.osuosl.org [IPv6:2605:bc80:3010::133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id CB4DEC000D
 for <virtualization@lists.linux-foundation.org>;
 Wed, 20 Oct 2021 02:02:34 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp2.osuosl.org (Postfix) with ESMTP id ABBB8400DA
 for <virtualization@lists.linux-foundation.org>;
 Wed, 20 Oct 2021 02:02:34 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Authentication-Results: smtp2.osuosl.org (amavisd-new);
 dkim=pass (1024-bit key) header.d=redhat.com
Received: from smtp2.osuosl.org ([127.0.0.1])
 by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id jCo7aKIf3yek
 for <virtualization@lists.linux-foundation.org>;
 Wed, 20 Oct 2021 02:02:33 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [216.205.24.124])
 by smtp2.osuosl.org (Postfix) with ESMTPS id 0350640018
 for <virtualization@lists.linux-foundation.org>;
 Wed, 20 Oct 2021 02:02:32 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1634695352;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=SErjP2lcpuHZQaQNbIs1j8jIrABuzJ0j2o41hgaD9/E=;
 b=dFGejHttN0Mgb91ACssy9fVlLqrC0b0WIl5iffZE6+GJFhP3hwFM5Q/H5j46Su8+i/Zmwu
 tn8KGHBplVoxNq3dp6voT7+PUPzubHdQJNKKXK8EOiwr3tdDAXKPcacnzntEHra8ZbUwcy
 jWvOxwy++j1Y9clJ1DvP5V2jNhVINeM=
Received: from mail-lf1-f72.google.com (mail-lf1-f72.google.com
 [209.85.167.72]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-331-ktVDgY8hPh2uzTqdDrfJ5g-1; Tue, 19 Oct 2021 22:02:30 -0400
X-MC-Unique: ktVDgY8hPh2uzTqdDrfJ5g-1
Received: by mail-lf1-f72.google.com with SMTP id
 y40-20020a0565123f2800b003fded085638so2367414lfa.0
 for <virtualization@lists.linux-foundation.org>;
 Tue, 19 Oct 2021 19:02:30 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20210112;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=SErjP2lcpuHZQaQNbIs1j8jIrABuzJ0j2o41hgaD9/E=;
 b=6JDyz1arUuR58AHdvZcLZ+ZVTgInt4AlyaAUo+SI5APBTv1W6ZZJvBeK3ecDvujylH
 quPp3qq5gjypddZfuRfQyXu05o+pItaJNEWZunkoJNMXoeKCgYTjjmE0IQp/59RivEtJ
 NH8u7d6nEMshqu/YVdKWkBxD1SYMShlWGS6ynMRpLoPgeUza+NJRg9/SYNX0cShbatTZ
 W3JEAJ/PYmkov/BOCYpGsMYZNCG3mJo5q0oI5ZpmxQukM24Bdrk0TeSpgFPWC5F8l/qx
 +7L6pj6fpv3r9bPuydFPZ8FQVN7/tu7yc3PRb2XtDhP3o7BcjxqFXlncsnPGUHZ8kBCH
 ZusA==
X-Gm-Message-State: AOAM532XeyAiH40XPJOpF4TZk7gzhD0IMhD2f1s6RT2gY0+Zx7tz7cw2
 HLXaJOl1mDBmnPloWoOUUsmRsEUqP/tknhbUcywrys8dkDQKu50335fq4NGB2y7MpDTeEALHgOu
 8QHL1INVTigwjuJLGj3QPGjAkQXHuUQUEzJ5XY9qM9d9vWf91fXzozyQ+kQ==
X-Received: by 2002:a2e:5344:: with SMTP id t4mr10267911ljd.362.1634695348891; 
 Tue, 19 Oct 2021 19:02:28 -0700 (PDT)
X-Google-Smtp-Source: ABdhPJyfh/Zq/OnXbvNoKfHqLa5c/xwX4swVF0y3tjxtGI7f8juh6wyhsqyKabkrxGBGBb7vgb4lxQhu+DfKz2xh2aE=
X-Received: by 2002:a2e:5344:: with SMTP id t4mr10267869ljd.362.1634695348494; 
 Tue, 19 Oct 2021 19:02:28 -0700 (PDT)
MIME-Version: 1.0
References: <20211001070603.307037-1-eperezma@redhat.com>
 <20211001070603.307037-21-eperezma@redhat.com>
 <a426c22c-f41a-4e3f-d140-7e7a0defeacb@redhat.com>
 <CAJaqyWcRcm9rwuTqJHS0FmuMrXpoCvF34TzXKQmxXTfZssZ-jA@mail.gmail.com>
In-Reply-To: <CAJaqyWcRcm9rwuTqJHS0FmuMrXpoCvF34TzXKQmxXTfZssZ-jA@mail.gmail.com>
From: Jason Wang <jasowang@redhat.com>
Date: Wed, 20 Oct 2021 10:02:17 +0800
Message-ID: <CACGkMEtgOc6ccaV5fckMwgEccEwL=sfuvkGymjAsQh7Tvn9krw@mail.gmail.com>
Subject: Re: [RFC PATCH v4 20/20] vdpa: Add custom IOTLB translations to SVQ
To: Eugenio Perez Martin <eperezma@redhat.com>
Authentication-Results: relay.mimecast.com;
 auth=pass smtp.auth=CUSA124A263 smtp.mailfrom=jasowang@redhat.com
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Cc: Parav Pandit <parav@mellanox.com>, Markus Armbruster <armbru@redhat.com>,
 "Michael S. Tsirkin" <mst@redhat.com>, qemu-level <qemu-devel@nongnu.org>,
 virtualization <virtualization@lists.linux-foundation.org>,
 Harpreet Singh Anand <hanand@xilinx.com>, Xiao W Wang <xiao.w.wang@intel.com>,
 Stefan Hajnoczi <stefanha@redhat.com>, Eli Cohen <eli@mellanox.com>,
 Eric Blake <eblake@redhat.com>, Michael Lilja <ml@napatech.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gVHVlLCBPY3QgMTksIDIwMjEgYXQgNjoyOSBQTSBFdWdlbmlvIFBlcmV6IE1hcnRpbgo8ZXBl
cmV6bWFAcmVkaGF0LmNvbT4gd3JvdGU6Cj4KPiBPbiBUdWUsIE9jdCAxOSwgMjAyMSBhdCAxMToy
NSBBTSBKYXNvbiBXYW5nIDxqYXNvd2FuZ0ByZWRoYXQuY29tPiB3cm90ZToKPiA+Cj4gPgo+ID4g
5ZyoIDIwMjEvMTAvMSDkuIvljYgzOjA2LCBFdWdlbmlvIFDDqXJleiDlhpnpgZM6Cj4gPiA+IFVz
ZSB0cmFuc2xhdGlvbnMgYWRkZWQgaW4gVmhvc3RJT1ZBVHJlZSBpbiBTVlEuCj4gPiA+Cj4gPiA+
IE5vdyBldmVyeSBlbGVtZW50IG5lZWRzIHRvIHN0b3JlIHRoZSBwcmV2aW91cyBhZGRyZXNzIGFs
c28sIHNvIFZpcnRRdWV1ZQo+ID4gPiBjYW4gY29uc3VtZSB0aGUgZWxlbWVudHMgcHJvcGVybHku
IFRoaXMgYWRkcyBhIGxpdHRsZSBvdmVyaGVhZCBwZXIgVlEKPiA+ID4gZWxlbWVudCwgaGF2aW5n
IHRvIGFsbG9jYXRlIG1vcmUgbWVtb3J5IHRvIHN0YXNoIHRoZW0uIEFzIGEgcG9zc2libGUKPiA+
ID4gb3B0aW1pemF0aW9uLCB0aGlzIGFsbG9jYXRpb24gY291bGQgYmUgYXZvaWRlZCBpZiB0aGUg
ZGVzY3JpcHRvciBpcyBub3QKPiA+ID4gYSBjaGFpbiBidXQgYSBzaW5nbGUgb25lLCBidXQgdGhp
cyBpcyBsZWZ0IHVuZG9uZS4KPiA+ID4KPiA+ID4gVE9ETzogaW92YSByYW5nZSBzaG91bGQgYmUg
cXVlcmllZCBiZWZvcmUsIGFuZCBhZGQgbG9naWMgdG8gZmFpbCB3aGVuCj4gPiA+IEdQQSBpcyBv
dXRzaWRlIG9mIGl0cyByYW5nZSBhbmQgbWVtb3J5IGxpc3RlbmVyIG9yIHN2cSBhZGQgaXQuCj4g
PiA+Cj4gPiA+IFNpZ25lZC1vZmYtYnk6IEV1Z2VuaW8gUMOpcmV6IDxlcGVyZXptYUByZWRoYXQu
Y29tPgo+ID4gPiAtLS0KPiA+ID4gICBody92aXJ0aW8vdmhvc3Qtc2hhZG93LXZpcnRxdWV1ZS5o
IHwgICA0ICstCj4gPiA+ICAgaHcvdmlydGlvL3Zob3N0LXNoYWRvdy12aXJ0cXVldWUuYyB8IDEz
MCArKysrKysrKysrKysrKysrKysrKysrKystLS0tLQo+ID4gPiAgIGh3L3ZpcnRpby92aG9zdC12
ZHBhLmMgICAgICAgICAgICAgfCAgNDAgKysrKysrKystCj4gPiA+ICAgaHcvdmlydGlvL3RyYWNl
LWV2ZW50cyAgICAgICAgICAgICB8ICAgMSArCj4gPiA+ICAgNCBmaWxlcyBjaGFuZ2VkLCAxNTIg
aW5zZXJ0aW9ucygrKSwgMjMgZGVsZXRpb25zKC0pCj4gPiA+Cj4gPiA+IGRpZmYgLS1naXQgYS9o
dy92aXJ0aW8vdmhvc3Qtc2hhZG93LXZpcnRxdWV1ZS5oIGIvaHcvdmlydGlvL3Zob3N0LXNoYWRv
dy12aXJ0cXVldWUuaAo+ID4gPiBpbmRleCBiN2JhYTQyNGE3Li5hMGU2YjUyNjdhIDEwMDY0NAo+
ID4gPiAtLS0gYS9ody92aXJ0aW8vdmhvc3Qtc2hhZG93LXZpcnRxdWV1ZS5oCj4gPiA+ICsrKyBi
L2h3L3ZpcnRpby92aG9zdC1zaGFkb3ctdmlydHF1ZXVlLmgKPiA+ID4gQEAgLTExLDYgKzExLDcg
QEAKPiA+ID4gICAjZGVmaW5lIFZIT1NUX1NIQURPV19WSVJUUVVFVUVfSAo+ID4gPgo+ID4gPiAg
ICNpbmNsdWRlICJody92aXJ0aW8vdmhvc3QuaCIKPiA+ID4gKyNpbmNsdWRlICJody92aXJ0aW8v
dmhvc3QtaW92YS10cmVlLmgiCj4gPiA+Cj4gPiA+ICAgdHlwZWRlZiBzdHJ1Y3QgVmhvc3RTaGFk
b3dWaXJ0cXVldWUgVmhvc3RTaGFkb3dWaXJ0cXVldWU7Cj4gPiA+Cj4gPiA+IEBAIC0yOCw3ICsy
OSw4IEBAIGJvb2wgdmhvc3Rfc3ZxX3N0YXJ0KHN0cnVjdCB2aG9zdF9kZXYgKmRldiwgdW5zaWdu
ZWQgaWR4LAo+ID4gPiAgIHZvaWQgdmhvc3Rfc3ZxX3N0b3Aoc3RydWN0IHZob3N0X2RldiAqZGV2
LCB1bnNpZ25lZCBpZHgsCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICBWaG9zdFNoYWRvd1Zp
cnRxdWV1ZSAqc3ZxKTsKPiA+ID4KPiA+ID4gLVZob3N0U2hhZG93VmlydHF1ZXVlICp2aG9zdF9z
dnFfbmV3KHN0cnVjdCB2aG9zdF9kZXYgKmRldiwgaW50IGlkeCk7Cj4gPiA+ICtWaG9zdFNoYWRv
d1ZpcnRxdWV1ZSAqdmhvc3Rfc3ZxX25ldyhzdHJ1Y3Qgdmhvc3RfZGV2ICpkZXYsIGludCBpZHgs
Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaG9zdElPVkFUcmVl
ICppb3ZhX21hcCk7Cj4gPiA+Cj4gPiA+ICAgdm9pZCB2aG9zdF9zdnFfZnJlZShWaG9zdFNoYWRv
d1ZpcnRxdWV1ZSAqdnEpOwo+ID4gPgo+ID4gPiBkaWZmIC0tZ2l0IGEvaHcvdmlydGlvL3Zob3N0
LXNoYWRvdy12aXJ0cXVldWUuYyBiL2h3L3ZpcnRpby92aG9zdC1zaGFkb3ctdmlydHF1ZXVlLmMK
PiA+ID4gaW5kZXggMmZkMGJhYjc1ZC4uOWRiNTM4NTQ3ZSAxMDA2NDQKPiA+ID4gLS0tIGEvaHcv
dmlydGlvL3Zob3N0LXNoYWRvdy12aXJ0cXVldWUuYwo+ID4gPiArKysgYi9ody92aXJ0aW8vdmhv
c3Qtc2hhZG93LXZpcnRxdWV1ZS5jCj4gPiA+IEBAIC0xMSwxMiArMTEsMTkgQEAKPiA+ID4gICAj
aW5jbHVkZSAiaHcvdmlydGlvL3Zob3N0LXNoYWRvdy12aXJ0cXVldWUuaCIKPiA+ID4gICAjaW5j
bHVkZSAiaHcvdmlydGlvL3Zob3N0LmgiCj4gPiA+ICAgI2luY2x1ZGUgImh3L3ZpcnRpby92aXJ0
aW8tYWNjZXNzLmgiCj4gPiA+ICsjaW5jbHVkZSAiaHcvdmlydGlvL3Zob3N0LWlvdmEtdHJlZS5o
Igo+ID4gPgo+ID4gPiAgICNpbmNsdWRlICJzdGFuZGFyZC1oZWFkZXJzL2xpbnV4L3Zob3N0X3R5
cGVzLmgiCj4gPiA+Cj4gPiA+ICAgI2luY2x1ZGUgInFlbXUvZXJyb3ItcmVwb3J0LmgiCj4gPiA+
ICAgI2luY2x1ZGUgInFlbXUvbWFpbi1sb29wLmgiCj4gPiA+Cj4gPiA+ICt0eXBlZGVmIHN0cnVj
dCBTVlFFbGVtZW50IHsKPiA+ID4gKyAgICBWaXJ0UXVldWVFbGVtZW50IGVsZW07Cj4gPiA+ICsg
ICAgdm9pZCAqKmluX3NnX3N0YXNoOwo+ID4gPiArICAgIHZvaWQgKipvdXRfc2dfc3Rhc2g7Cj4g
PiA+ICt9IFNWUUVsZW1lbnQ7Cj4gPiA+ICsKPiA+ID4gICAvKiBTaGFkb3cgdmlydHF1ZXVlIHRv
IHJlbGF5IG5vdGlmaWNhdGlvbnMgKi8KPiA+ID4gICB0eXBlZGVmIHN0cnVjdCBWaG9zdFNoYWRv
d1ZpcnRxdWV1ZSB7Cj4gPiA+ICAgICAgIC8qIFNoYWRvdyB2cmluZyAqLwo+ID4gPiBAQCAtNDYs
OCArNTMsMTEgQEAgdHlwZWRlZiBzdHJ1Y3QgVmhvc3RTaGFkb3dWaXJ0cXVldWUgewo+ID4gPiAg
ICAgICAvKiBWaXJ0aW8gZGV2aWNlICovCj4gPiA+ICAgICAgIFZpcnRJT0RldmljZSAqdmRldjsK
PiA+ID4KPiA+ID4gKyAgICAvKiBJT1ZBIG1hcHBpbmcgaWYgdXNlZCAqLwo+ID4gPiArICAgIFZo
b3N0SU9WQVRyZWUgKmlvdmFfbWFwOwo+ID4gPiArCj4gPiA+ICAgICAgIC8qIE1hcCBmb3IgcmV0
dXJuaW5nIGd1ZXN0J3MgZGVzY3JpcHRvcnMgKi8KPiA+ID4gLSAgICBWaXJ0UXVldWVFbGVtZW50
ICoqcmluZ19pZF9tYXBzOwo+ID4gPiArICAgIFNWUUVsZW1lbnQgKipyaW5nX2lkX21hcHM7Cj4g
PiA+Cj4gPiA+ICAgICAgIC8qIE5leHQgaGVhZCB0byBleHBvc2UgdG8gZGV2aWNlICovCj4gPiA+
ICAgICAgIHVpbnQxNl90IGF2YWlsX2lkeF9zaGFkb3c7Cj4gPiA+IEBAIC03OSwxMyArODksNiBA
QCBib29sIHZob3N0X3N2cV92YWxpZF9kZXZpY2VfZmVhdHVyZXModWludDY0X3QgKmRldl9mZWF0
dXJlcykKPiA+ID4gICAgICAgICAgICAgICBjb250aW51ZTsKPiA+ID4KPiA+ID4gICAgICAgICAg
IGNhc2UgVklSVElPX0ZfQUNDRVNTX1BMQVRGT1JNOgo+ID4gPiAtICAgICAgICAgICAgLyogU1ZR
IG5lZWRzIHRoaXMgZmVhdHVyZSBkaXNhYmxlZC4gQ2FuJ3QgY29udGludWUgKi8KPiA+ID4gLSAg
ICAgICAgICAgIGlmICgqZGV2X2ZlYXR1cmVzICYgQklUX1VMTChiKSkgewo+ID4gPiAtICAgICAg
ICAgICAgICAgIGNsZWFyX2JpdChiLCBkZXZfZmVhdHVyZXMpOwo+ID4gPiAtICAgICAgICAgICAg
ICAgIHIgPSBmYWxzZTsKPiA+ID4gLSAgICAgICAgICAgIH0KPiA+ID4gLSAgICAgICAgICAgIGJy
ZWFrOwo+ID4gPiAtCj4gPiA+ICAgICAgICAgICBjYXNlIFZJUlRJT19GX1ZFUlNJT05fMToKPiA+
ID4gICAgICAgICAgICAgICAvKiBTVlEgbmVlZHMgdGhpcyBmZWF0dXJlLCBzbyBjYW4ndCBjb250
aW51ZSAqLwo+ID4gPiAgICAgICAgICAgICAgIGlmICghKCpkZXZfZmVhdHVyZXMgJiBCSVRfVUxM
KGIpKSkgewo+ID4gPiBAQCAtMTI2LDYgKzEyOSw2NCBAQCBzdGF0aWMgdm9pZCB2aG9zdF9zdnFf
c2V0X25vdGlmaWNhdGlvbihWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxLCBib29sIGVuYWJsZSkK
PiA+ID4gICAgICAgfQo+ID4gPiAgIH0KPiA+ID4KPiA+ID4gK3N0YXRpYyB2b2lkIHZob3N0X3N2
cV9zdGFzaF9hZGRyKHZvaWQgKioqc3Rhc2gsIGNvbnN0IHN0cnVjdCBpb3ZlYyAqaW92LAo+ID4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IG51bSkKPiA+ID4gK3sK
PiA+ID4gKyAgICBzaXplX3QgaTsKPiA+ID4gKwo+ID4gPiArICAgIGlmIChudW0gPT0gMCkgewo+
ID4gPiArICAgICAgICByZXR1cm47Cj4gPiA+ICsgICAgfQo+ID4gPiArCj4gPiA+ICsgICAgKnN0
YXNoID0gZ19uZXcodm9pZCAqLCBudW0pOwo+ID4gPiArICAgIGZvciAoaSA9IDA7IGkgPCBudW07
ICsraSkgewo+ID4gPiArICAgICAgICAoKnN0YXNoKVtpXSA9IGlvdltpXS5pb3ZfYmFzZTsKPiA+
ID4gKyAgICB9Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyB2b2lkIHZob3N0X3N2cV91
bnN0YXNoX2FkZHIodm9pZCAqKnN0YXNoLCBzdHJ1Y3QgaW92ZWMgKmlvdiwgc2l6ZV90IG51bSkK
PiA+ID4gK3sKPiA+ID4gKyAgICBzaXplX3QgaTsKPiA+ID4gKwo+ID4gPiArICAgIGlmIChudW0g
PT0gMCkgewo+ID4gPiArICAgICAgICByZXR1cm47Cj4gPiA+ICsgICAgfQo+ID4gPiArCj4gPiA+
ICsgICAgZm9yIChpID0gMDsgaSA8IG51bTsgKytpKSB7Cj4gPiA+ICsgICAgICAgIGlvdltpXS5p
b3ZfYmFzZSA9IHN0YXNoW2ldOwo+ID4gPiArICAgIH0KPiA+ID4gKyAgICBnX2ZyZWUoc3Rhc2gp
Owo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICtzdGF0aWMgdm9pZCB2aG9zdF9zdnFfdHJhbnNsYXRl
X2FkZHIoY29uc3QgVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSwKPiA+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgaW92ZWMgKmlvdmVjLCBzaXplX3QgbnVt
KQo+ID4gPiArewo+ID4gPiArICAgIHNpemVfdCBpOwo+ID4gPiArCj4gPiA+ICsgICAgZm9yIChp
ID0gMDsgaSA8IG51bTsgKytpKSB7Cj4gPiA+ICsgICAgICAgIFZob3N0RE1BTWFwIG5lZWRsZSA9
IHsKPiA+ID4gKyAgICAgICAgICAgIC50cmFuc2xhdGVkX2FkZHIgPSBpb3ZlY1tpXS5pb3ZfYmFz
ZSwKPiA+ID4gKyAgICAgICAgICAgIC5zaXplID0gaW92ZWNbaV0uaW92X2xlbiwKPiA+ID4gKyAg
ICAgICAgfTsKPiA+ID4gKyAgICAgICAgc2l6ZV90IG9mZjsKPiA+ID4gKwo+ID4gPiArICAgICAg
ICBjb25zdCBWaG9zdERNQU1hcCAqbWFwID0gdmhvc3RfaW92YV90cmVlX2ZpbmRfaW92YShzdnEt
PmlvdmFfbWFwLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAmbmVlZGxlKTsKPiA+Cj4gPgo+ID4gSXMgaXQgcG9zc2libGUg
dGhhdCB3ZSBlbmQgdXAgd2l0aCBtb3JlIHRoYW4gb25lIG1hcHMgaGVyZT8KPiA+Cj4KPiBBY3R1
YWxseSBpdCBpcyBwb3NzaWJsZSwgc2luY2UgdGhlcmUgaXMgbm8gZ3VhcmFudGVlIHRoYXQgb25l
Cj4gZGVzY3JpcHRvciAob3IgaW5kaXJlY3QgZGVzY3JpcHRvcikgbWFwcyBleGFjdGx5IHRvIG9u
ZSBpb3YuIEl0IGNvdWxkCj4gbWFwIHRvIG1hbnkgaWYgcWVtdSB2YWRkciBpcyBub3QgY29udGln
dW91cyBidXQgR1BBICsgc2l6ZSBpcy4gVGhpcyBpcwo+IHNvbWV0aGluZyB0aGF0IG11c3QgYmUg
Zml4ZWQgZm9yIHRoZSBuZXh0IHJldmlzaW9uLCBzbyB0aGFua3MgZm9yCj4gcG9pbnRpbmcgaXQg
b3V0IQo+Cj4gVGFraW5nIHRoYXQgaW50byBhY2NvdW50LCB0aGUgY29uZGl0aW9uIHRoYXQgc3Zx
IHZyaW5nIGF2YWlsX2lkeCAtCj4gdXNlZF9pZHggd2FzIGFsd2F5cyBsZXNzIG9yIGVxdWFsIHRo
YW4gZ3Vlc3QncyB2cmluZyBhdmFpbF9pZHggLQo+IHVzZWRfaWR4IGlzIG5vdCB0cnVlIGFueW1v
cmUuIENoZWNraW5nIGZvciB0aGF0IGJlZm9yZSBhZGRpbmcgYnVmZmVycwo+IHRvIFNWUSBpcyB0
aGUgZWFzeSBwYXJ0LCBidXQgaG93IGNvdWxkIHdlIHJlY292ZXIgaW4gdGhhdCBjYXNlPwo+Cj4g
SSB0aGluayB0aGF0IHRoZSBlYXN5IHNvbHV0aW9uIGlzIHRvIGNoZWNrIGZvciBtb3JlIGF2YWls
YWJsZSBidWZmZXJzCj4gdW5jb25kaXRpb25hbGx5IGF0IHRoZSBlbmQgb2Ygdmhvc3Rfc3ZxX2hh
bmRsZV9jYWxsLCB3aGljaCBoYW5kbGVzIHRoZQo+IFNWUSB1c2VkIGFuZCBpcyBzdXBwb3NlZCB0
byBtYWtlIG1vcmUgcm9vbSBmb3IgYXZhaWxhYmxlIGJ1ZmZlcnMuIFNvCj4gdmhvc3RfaGFuZGxl
X2d1ZXN0X2tpY2sgd291bGQgbm90IGNoZWNrIGlmIGV2ZW50ZmQgaXMgc2V0IG9yIG5vdAo+IGFu
eW1vcmUuCj4KPiBXb3VsZCB0aGF0IG1ha2Ugc2Vuc2U/CgpZZXMsIEkgdGhpbmsgaXQgc2hvdWxk
IHdvcmsuCgpUaGFua3MKCj4KPiBUaGFua3MhCj4KPiA+Cj4gPiA+ICsgICAgICAgIC8qCj4gPiA+
ICsgICAgICAgICAqIE1hcCBjYW5ub3QgYmUgTlVMTCBzaW5jZSBpb3ZhIG1hcCBjb250YWlucyBh
bGwgZ3Vlc3Qgc3BhY2UgYW5kCj4gPiA+ICsgICAgICAgICAqIHFlbXUgYWxyZWFkeSBoYXMgYSBw
aHlzaWNhbCBhZGRyZXNzIG1hcHBlZAo+ID4gPiArICAgICAgICAgKi8KPiA+ID4gKyAgICAgICAg
YXNzZXJ0KG1hcCk7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICAgLyoKPiA+ID4gKyAgICAgICAgICog
TWFwLT5pb3ZhIGNodW5rIHNpemUgaXMgaWdub3JlZC4gV2hhdCB0byBkbyBpZiBkZXNjcmlwdG9y
Cj4gPiA+ICsgICAgICAgICAqIChhZGRyLCBzaXplKSBkb2VzIG5vdCBmaXQgaXMgZGVsZWdhdGVk
IHRvIHRoZSBkZXZpY2UuCj4gPiA+ICsgICAgICAgICAqLwo+ID4gPiArICAgICAgICBvZmYgPSBu
ZWVkbGUudHJhbnNsYXRlZF9hZGRyIC0gbWFwLT50cmFuc2xhdGVkX2FkZHI7Cj4gPiA+ICsgICAg
ICAgIGlvdmVjW2ldLmlvdl9iYXNlID0gKHZvaWQgKikobWFwLT5pb3ZhICsgb2ZmKTsKPiA+ID4g
KyAgICB9Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gICBzdGF0aWMgdm9pZCB2aG9zdF92cmluZ193
cml0ZV9kZXNjcyhWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxLAo+ID4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBpb3ZlYyAqaW92ZWMsCj4gPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IG51bSwgYm9vbCBt
b3JlX2Rlc2NzLCBib29sIHdyaXRlKQo+ID4gPiBAQCAtMTU2LDggKzIxNyw5IEBAIHN0YXRpYyB2
b2lkIHZob3N0X3ZyaW5nX3dyaXRlX2Rlc2NzKFZob3N0U2hhZG93VmlydHF1ZXVlICpzdnEsCj4g
PiA+ICAgfQo+ID4gPgo+ID4gPiAgIHN0YXRpYyB1bnNpZ25lZCB2aG9zdF9zdnFfYWRkX3NwbGl0
KFZob3N0U2hhZG93VmlydHF1ZXVlICpzdnEsCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBWaXJ0UXVldWVFbGVtZW50ICplbGVtKQo+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgU1ZRRWxlbWVudCAqc3ZxX2VsZW0pCj4gPiA+ICAgewo+
ID4gPiArICAgIFZpcnRRdWV1ZUVsZW1lbnQgKmVsZW0gPSAmc3ZxX2VsZW0tPmVsZW07Cj4gPiA+
ICAgICAgIGludCBoZWFkOwo+ID4gPiAgICAgICB1bnNpZ25lZCBhdmFpbF9pZHg7Cj4gPiA+ICAg
ICAgIHZyaW5nX2F2YWlsX3QgKmF2YWlsID0gc3ZxLT52cmluZy5hdmFpbDsKPiA+ID4gQEAgLTE2
Nyw2ICsyMjksMTIgQEAgc3RhdGljIHVuc2lnbmVkIHZob3N0X3N2cV9hZGRfc3BsaXQoVmhvc3RT
aGFkb3dWaXJ0cXVldWUgKnN2cSwKPiA+ID4gICAgICAgLyogV2UgbmVlZCBzb21lIGRlc2NyaXB0
b3JzIGhlcmUgKi8KPiA+ID4gICAgICAgYXNzZXJ0KGVsZW0tPm91dF9udW0gfHwgZWxlbS0+aW5f
bnVtKTsKPiA+ID4KPiA+ID4gKyAgICB2aG9zdF9zdnFfc3Rhc2hfYWRkcigmc3ZxX2VsZW0tPmlu
X3NnX3N0YXNoLCBlbGVtLT5pbl9zZywgZWxlbS0+aW5fbnVtKTsKPiA+ID4gKyAgICB2aG9zdF9z
dnFfc3Rhc2hfYWRkcigmc3ZxX2VsZW0tPm91dF9zZ19zdGFzaCwgZWxlbS0+b3V0X3NnLCBlbGVt
LT5vdXRfbnVtKTsKPiA+Cj4gPgo+ID4gSSB3b25kZXIgaWYgd2UgY2FuIHNvbHZlIHRoZSB0cmlj
ayBsaWtlIHN0YXNoIGFuZCB1bnN0YXNoIHdpdGggYQo+ID4gZGVkaWNhdGVkIHNncyBpbiBzdnFf
ZWxlbSwgaW5zdGVhZCBvZiByZXVzaW5nIHRoZSBlbGVtLgo+ID4KPgo+IEFjdHVhbGx5IHllcywg
aXQgd291bGQgYmUgd2F5IHNpbXBsZXIgdG8gdXNlIGEgbmV3IHNncyBhcnJheSBpbgo+IHN2cV9l
bGVtLiBJIHdpbGwgY2hhbmdlIHRoYXQuCj4KPiBUaGFua3MhCj4KPiA+IFRoYW5rcwo+ID4KPiA+
Cj4gPiA+ICsKPiA+ID4gKyAgICB2aG9zdF9zdnFfdHJhbnNsYXRlX2FkZHIoc3ZxLCBlbGVtLT5p
bl9zZywgZWxlbS0+aW5fbnVtKTsKPiA+ID4gKyAgICB2aG9zdF9zdnFfdHJhbnNsYXRlX2FkZHIo
c3ZxLCBlbGVtLT5vdXRfc2csIGVsZW0tPm91dF9udW0pOwo+ID4gPiArCj4gPiA+ICAgICAgIHZo
b3N0X3ZyaW5nX3dyaXRlX2Rlc2NzKHN2cSwgZWxlbS0+b3V0X3NnLCBlbGVtLT5vdXRfbnVtLAo+
ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtLT5pbl9udW0gPiAwLCBmYWxz
ZSk7Cj4gPiA+ICAgICAgIHZob3N0X3ZyaW5nX3dyaXRlX2Rlc2NzKHN2cSwgZWxlbS0+aW5fc2cs
IGVsZW0tPmluX251bSwgZmFsc2UsIHRydWUpOwo+ID4gPiBAQCAtMTg3LDcgKzI1NSw3IEBAIHN0
YXRpYyB1bnNpZ25lZCB2aG9zdF9zdnFfYWRkX3NwbGl0KFZob3N0U2hhZG93VmlydHF1ZXVlICpz
dnEsCj4gPiA+Cj4gPiA+ICAgfQo+ID4gPgo+ID4gPiAtc3RhdGljIHZvaWQgdmhvc3Rfc3ZxX2Fk
ZChWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxLCBWaXJ0UXVldWVFbGVtZW50ICplbGVtKQo+ID4g
PiArc3RhdGljIHZvaWQgdmhvc3Rfc3ZxX2FkZChWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxLCBT
VlFFbGVtZW50ICplbGVtKQo+ID4gPiAgIHsKPiA+ID4gICAgICAgdW5zaWduZWQgcWVtdV9oZWFk
ID0gdmhvc3Rfc3ZxX2FkZF9zcGxpdChzdnEsIGVsZW0pOwo+ID4gPgo+ID4gPiBAQCAtMjIxLDcg
KzI4OSw3IEBAIHN0YXRpYyB2b2lkIHZob3N0X2hhbmRsZV9ndWVzdF9raWNrKEV2ZW50Tm90aWZp
ZXIgKm4pCj4gPiA+ICAgICAgICAgICB9Cj4gPiA+Cj4gPiA+ICAgICAgICAgICB3aGlsZSAodHJ1
ZSkgewo+ID4gPiAtICAgICAgICAgICAgVmlydFF1ZXVlRWxlbWVudCAqZWxlbSA9IHZpcnRxdWV1
ZV9wb3Aoc3ZxLT52cSwgc2l6ZW9mKCplbGVtKSk7Cj4gPiA+ICsgICAgICAgICAgICBTVlFFbGVt
ZW50ICplbGVtID0gdmlydHF1ZXVlX3BvcChzdnEtPnZxLCBzaXplb2YoKmVsZW0pKTsKPiA+ID4g
ICAgICAgICAgICAgICBpZiAoIWVsZW0pIHsKPiA+ID4gICAgICAgICAgICAgICAgICAgYnJlYWs7
Cj4gPiA+ICAgICAgICAgICAgICAgfQo+ID4gPiBAQCAtMjQ3LDcgKzMxNSw3IEBAIHN0YXRpYyBi
b29sIHZob3N0X3N2cV9tb3JlX3VzZWQoVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSkKPiA+ID4g
ICAgICAgcmV0dXJuIHN2cS0+dXNlZF9pZHggIT0gc3ZxLT5zaGFkb3dfdXNlZF9pZHg7Cj4gPiA+
ICAgfQo+ID4gPgo+ID4gPiAtc3RhdGljIFZpcnRRdWV1ZUVsZW1lbnQgKnZob3N0X3N2cV9nZXRf
YnVmKFZob3N0U2hhZG93VmlydHF1ZXVlICpzdnEpCj4gPiA+ICtzdGF0aWMgU1ZRRWxlbWVudCAq
dmhvc3Rfc3ZxX2dldF9idWYoVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSkKPiA+ID4gICB7Cj4g
PiA+ICAgICAgIHZyaW5nX2Rlc2NfdCAqZGVzY3MgPSBzdnEtPnZyaW5nLmRlc2M7Cj4gPiA+ICAg
ICAgIGNvbnN0IHZyaW5nX3VzZWRfdCAqdXNlZCA9IHN2cS0+dnJpbmcudXNlZDsKPiA+ID4gQEAg
LTI3OSw3ICszNDcsNyBAQCBzdGF0aWMgVmlydFF1ZXVlRWxlbWVudCAqdmhvc3Rfc3ZxX2dldF9i
dWYoVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSkKPiA+ID4gICAgICAgZGVzY3NbdXNlZF9lbGVt
LmlkXS5uZXh0ID0gc3ZxLT5mcmVlX2hlYWQ7Cj4gPiA+ICAgICAgIHN2cS0+ZnJlZV9oZWFkID0g
dXNlZF9lbGVtLmlkOwo+ID4gPgo+ID4gPiAtICAgIHN2cS0+cmluZ19pZF9tYXBzW3VzZWRfZWxl
bS5pZF0tPmxlbiA9IHVzZWRfZWxlbS5sZW47Cj4gPiA+ICsgICAgc3ZxLT5yaW5nX2lkX21hcHNb
dXNlZF9lbGVtLmlkXS0+ZWxlbS5sZW4gPSB1c2VkX2VsZW0ubGVuOwo+ID4gPiAgICAgICByZXR1
cm4gZ19zdGVhbF9wb2ludGVyKCZzdnEtPnJpbmdfaWRfbWFwc1t1c2VkX2VsZW0uaWRdKTsKPiA+
ID4gICB9Cj4gPiA+Cj4gPiA+IEBAIC0yOTYsMTIgKzM2NCwxOSBAQCBzdGF0aWMgdm9pZCB2aG9z
dF9zdnFfaGFuZGxlX2NhbGxfbm9fdGVzdChFdmVudE5vdGlmaWVyICpuKQo+ID4gPgo+ID4gPiAg
ICAgICAgICAgdmhvc3Rfc3ZxX3NldF9ub3RpZmljYXRpb24oc3ZxLCBmYWxzZSk7Cj4gPiA+ICAg
ICAgICAgICB3aGlsZSAodHJ1ZSkgewo+ID4gPiAtICAgICAgICAgICAgZ19hdXRvZnJlZSBWaXJ0
UXVldWVFbGVtZW50ICplbGVtID0gdmhvc3Rfc3ZxX2dldF9idWYoc3ZxKTsKPiA+ID4gLSAgICAg
ICAgICAgIGlmICghZWxlbSkgewo+ID4gPiArICAgICAgICAgICAgZ19hdXRvZnJlZSBTVlFFbGVt
ZW50ICpzdnFfZWxlbSA9IHZob3N0X3N2cV9nZXRfYnVmKHN2cSk7Cj4gPiA+ICsgICAgICAgICAg
ICBWaXJ0UXVldWVFbGVtZW50ICplbGVtOwo+ID4gPiArICAgICAgICAgICAgaWYgKCFzdnFfZWxl
bSkgewo+ID4gPiAgICAgICAgICAgICAgICAgICBicmVhazsKPiA+ID4gICAgICAgICAgICAgICB9
Cj4gPiA+Cj4gPiA+ICAgICAgICAgICAgICAgYXNzZXJ0KGkgPCBzdnEtPnZyaW5nLm51bSk7Cj4g
PiA+ICsgICAgICAgICAgICBlbGVtID0gJnN2cV9lbGVtLT5lbGVtOwo+ID4gPiArCj4gPiA+ICsg
ICAgICAgICAgICB2aG9zdF9zdnFfdW5zdGFzaF9hZGRyKHN2cV9lbGVtLT5pbl9zZ19zdGFzaCwg
ZWxlbS0+aW5fc2csCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVs
ZW0tPmluX251bSk7Cj4gPiA+ICsgICAgICAgICAgICB2aG9zdF9zdnFfdW5zdGFzaF9hZGRyKHN2
cV9lbGVtLT5vdXRfc2dfc3Rhc2gsIGVsZW0tPm91dF9zZywKPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZWxlbS0+b3V0X251bSk7Cj4gPiA+ICAgICAgICAgICAgICAg
dmlydHF1ZXVlX2ZpbGwodnEsIGVsZW0sIGVsZW0tPmxlbiwgaSsrKTsKPiA+ID4gICAgICAgICAg
IH0KPiA+ID4KPiA+ID4gQEAgLTQ1MSwxNCArNTI2LDI0IEBAIHZvaWQgdmhvc3Rfc3ZxX3N0b3Ao
c3RydWN0IHZob3N0X2RldiAqZGV2LCB1bnNpZ25lZCBpZHgsCj4gPiA+ICAgICAgIGV2ZW50X25v
dGlmaWVyX3NldF9oYW5kbGVyKCZzdnEtPmhvc3Rfbm90aWZpZXIsIE5VTEwpOwo+ID4gPgo+ID4g
PiAgICAgICBmb3IgKGkgPSAwOyBpIDwgc3ZxLT52cmluZy5udW07ICsraSkgewo+ID4gPiAtICAg
ICAgICBnX2F1dG9mcmVlIFZpcnRRdWV1ZUVsZW1lbnQgKmVsZW0gPSBzdnEtPnJpbmdfaWRfbWFw
c1tpXTsKPiA+ID4gKyAgICAgICAgZ19hdXRvZnJlZSBTVlFFbGVtZW50ICpzdnFfZWxlbSA9IHN2
cS0+cmluZ19pZF9tYXBzW2ldOwo+ID4gPiArICAgICAgICBWaXJ0UXVldWVFbGVtZW50ICplbGVt
Owo+ID4gPiArCj4gPiA+ICsgICAgICAgIGlmICghc3ZxX2VsZW0pIHsKPiA+ID4gKyAgICAgICAg
ICAgIGNvbnRpbnVlOwo+ID4gPiArICAgICAgICB9Cj4gPiA+ICsKPiA+ID4gKyAgICAgICAgZWxl
bSA9ICZzdnFfZWxlbS0+ZWxlbTsKPiA+ID4gKyAgICAgICAgdmhvc3Rfc3ZxX3Vuc3Rhc2hfYWRk
cihzdnFfZWxlbS0+aW5fc2dfc3Rhc2gsIGVsZW0tPmluX3NnLAo+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGVsZW0tPmluX251bSk7Cj4gPiA+ICsgICAgICAgIHZob3N0X3N2
cV91bnN0YXNoX2FkZHIoc3ZxX2VsZW0tPm91dF9zZ19zdGFzaCwgZWxlbS0+b3V0X3NnLAo+ID4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW0tPm91dF9udW0pOwo+ID4gPiAr
Cj4gPiA+ICAgICAgICAgICAvKgo+ID4gPiAgICAgICAgICAgICogQWx0aG91Z2ggdGhlIGRvYyBz
YXlzIHdlIG11c3QgdW5wb3AgaW4gb3JkZXIsIGl0J3Mgb2sgdG8gdW5wb3AKPiA+ID4gICAgICAg
ICAgICAqIGV2ZXJ5dGhpbmcuCj4gPiA+ICAgICAgICAgICAgKi8KPiA+ID4gLSAgICAgICAgaWYg
KGVsZW0pIHsKPiA+ID4gLSAgICAgICAgICAgIHZpcnRxdWV1ZV91bnBvcChzdnEtPnZxLCBlbGVt
LCBlbGVtLT5sZW4pOwo+ID4gPiAtICAgICAgICB9Cj4gPiA+ICsgICAgICAgIHZpcnRxdWV1ZV91
bnBvcChzdnEtPnZxLCBlbGVtLCBlbGVtLT5sZW4pOwo+ID4gPiAgICAgICB9Cj4gPiA+ICAgfQo+
ID4gPgo+ID4gPiBAQCAtNDY2LDcgKzU1MSw4IEBAIHZvaWQgdmhvc3Rfc3ZxX3N0b3Aoc3RydWN0
IHZob3N0X2RldiAqZGV2LCB1bnNpZ25lZCBpZHgsCj4gPiA+ICAgICogQ3JlYXRlcyB2aG9zdCBz
aGFkb3cgdmlydHF1ZXVlLCBhbmQgaW5zdHJ1Y3Qgdmhvc3QgZGV2aWNlIHRvIHVzZSB0aGUgc2hh
ZG93Cj4gPiA+ICAgICogbWV0aG9kcyBhbmQgZmlsZSBkZXNjcmlwdG9ycy4KPiA+ID4gICAgKi8K
PiA+ID4gLVZob3N0U2hhZG93VmlydHF1ZXVlICp2aG9zdF9zdnFfbmV3KHN0cnVjdCB2aG9zdF9k
ZXYgKmRldiwgaW50IGlkeCkKPiA+ID4gK1Zob3N0U2hhZG93VmlydHF1ZXVlICp2aG9zdF9zdnFf
bmV3KHN0cnVjdCB2aG9zdF9kZXYgKmRldiwgaW50IGlkeCwKPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFZob3N0SU9WQVRyZWUgKmlvdmFfbWFwKQo+ID4gPiAgIHsK
PiA+ID4gICAgICAgaW50IHZxX2lkeCA9IGRldi0+dnFfaW5kZXggKyBpZHg7Cj4gPiA+ICAgICAg
IHVuc2lnbmVkIG51bSA9IHZpcnRpb19xdWV1ZV9nZXRfbnVtKGRldi0+dmRldiwgdnFfaWR4KTsK
PiA+ID4gQEAgLTUwMCwxMSArNTg2LDEzIEBAIFZob3N0U2hhZG93VmlydHF1ZXVlICp2aG9zdF9z
dnFfbmV3KHN0cnVjdCB2aG9zdF9kZXYgKmRldiwgaW50IGlkeCkKPiA+ID4gICAgICAgbWVtc2V0
KHN2cS0+dnJpbmcuZGVzYywgMCwgZHJpdmVyX3NpemUpOwo+ID4gPiAgICAgICBzdnEtPnZyaW5n
LnVzZWQgPSBxZW11X21lbWFsaWduKHFlbXVfcmVhbF9ob3N0X3BhZ2Vfc2l6ZSwgZGV2aWNlX3Np
emUpOwo+ID4gPiAgICAgICBtZW1zZXQoc3ZxLT52cmluZy51c2VkLCAwLCBkZXZpY2Vfc2l6ZSk7
Cj4gPiA+ICsgICAgc3ZxLT5pb3ZhX21hcCA9IGlvdmFfbWFwOwo+ID4gPiArCj4gPiA+ICAgICAg
IGZvciAoaSA9IDA7IGkgPCBudW0gLSAxOyBpKyspIHsKPiA+ID4gICAgICAgICAgIHN2cS0+dnJp
bmcuZGVzY1tpXS5uZXh0ID0gY3B1X3RvX2xlMTYoaSArIDEpOwo+ID4gPiAgICAgICB9Cj4gPiA+
Cj4gPiA+IC0gICAgc3ZxLT5yaW5nX2lkX21hcHMgPSBnX25ldzAoVmlydFF1ZXVlRWxlbWVudCAq
LCBudW0pOwo+ID4gPiArICAgIHN2cS0+cmluZ19pZF9tYXBzID0gZ19uZXcwKFNWUUVsZW1lbnQg
KiwgbnVtKTsKPiA+ID4gICAgICAgZXZlbnRfbm90aWZpZXJfc2V0X2hhbmRsZXIoJnN2cS0+Y2Fs
bF9ub3RpZmllciwKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmhvc3Rf
c3ZxX2hhbmRsZV9jYWxsKTsKPiA+ID4gICAgICAgcmV0dXJuIGdfc3RlYWxfcG9pbnRlcigmc3Zx
KTsKPiA+ID4gZGlmZiAtLWdpdCBhL2h3L3ZpcnRpby92aG9zdC12ZHBhLmMgYi9ody92aXJ0aW8v
dmhvc3QtdmRwYS5jCj4gPiA+IGluZGV4IGE5YzY4MGI0ODcuLmY1YTEyZmVlOWQgMTAwNjQ0Cj4g
PiA+IC0tLSBhL2h3L3ZpcnRpby92aG9zdC12ZHBhLmMKPiA+ID4gKysrIGIvaHcvdmlydGlvL3Zo
b3N0LXZkcGEuYwo+ID4gPiBAQCAtMTc2LDYgKzE3NiwxOCBAQCBzdGF0aWMgdm9pZCB2aG9zdF92
ZHBhX2xpc3RlbmVyX3JlZ2lvbl9hZGQoTWVtb3J5TGlzdGVuZXIgKmxpc3RlbmVyLAo+ID4gPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFkZHIsIHNlY3Rpb24t
PnJlYWRvbmx5KTsKPiA+ID4KPiA+ID4gICAgICAgbGxzaXplID0gaW50MTI4X3N1YihsbGVuZCwg
aW50MTI4X21ha2U2NChpb3ZhKSk7Cj4gPiA+ICsgICAgaWYgKHYtPnNoYWRvd192cXNfZW5hYmxl
ZCkgewo+ID4gPiArICAgICAgICBWaG9zdERNQU1hcCBtZW1fcmVnaW9uID0gewo+ID4gPiArICAg
ICAgICAgICAgLnRyYW5zbGF0ZWRfYWRkciA9IHZhZGRyLAo+ID4gPiArICAgICAgICAgICAgLnNp
emUgPSBpbnQxMjhfZ2V0NjQobGxzaXplKSAtIDEsCj4gPiA+ICsgICAgICAgICAgICAucGVybSA9
IElPTU1VX0FDQ0VTU19GTEFHKHRydWUsIHNlY3Rpb24tPnJlYWRvbmx5KSwKPiA+ID4gKyAgICAg
ICAgfTsKPiA+ID4gKwo+ID4gPiArICAgICAgICBpbnQgciA9IHZob3N0X2lvdmFfdHJlZV9hbGxv
Yyh2LT5pb3ZhX21hcCwgJm1lbV9yZWdpb24pOwo+ID4gPiArICAgICAgICBhc3NlcnQociA9PSBW
SE9TVF9ETUFfTUFQX09LKTsKPiA+ID4gKwo+ID4gPiArICAgICAgICBpb3ZhID0gbWVtX3JlZ2lv
bi5pb3ZhOwo+ID4gPiArICAgIH0KPiA+ID4KPiA+ID4gICAgICAgcmV0ID0gdmhvc3RfdmRwYV9k
bWFfbWFwKHYsIGlvdmEsIGludDEyOF9nZXQ2NChsbHNpemUpLAo+ID4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdmFkZHIsIHNlY3Rpb24tPnJlYWRvbmx5KTsKPiA+ID4gQEAgLTc1
NCw2ICs3NjYsMjMgQEAgc3RhdGljIGJvb2wgIHZob3N0X3ZkcGFfZm9yY2VfaW9tbXUoc3RydWN0
IHZob3N0X2RldiAqZGV2KQo+ID4gPiAgICAgICByZXR1cm4gdHJ1ZTsKPiA+ID4gICB9Cj4gPiA+
Cj4gPiA+ICtzdGF0aWMgaW50IHZob3N0X3ZkcGFfZ2V0X2lvdmFfcmFuZ2Uoc3RydWN0IHZob3N0
X2RldiAqZGV2LAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh3
YWRkciAqZmlyc3QsIGh3YWRkciAqbGFzdCkKPiA+ID4gK3sKPiA+ID4gKyAgICBpbnQgcmV0Owo+
ID4gPiArICAgIHN0cnVjdCB2aG9zdF92ZHBhX2lvdmFfcmFuZ2UgcmFuZ2U7Cj4gPiA+ICsKPiA+
ID4gKyAgICByZXQgPSB2aG9zdF92ZHBhX2NhbGwoZGV2LCBWSE9TVF9WRFBBX0dFVF9JT1ZBX1JB
TkdFLCAmcmFuZ2UpOwo+ID4gPiArICAgIGlmIChyZXQgIT0gMCkgewo+ID4gPiArICAgICAgICBy
ZXR1cm4gcmV0Owo+ID4gPiArICAgIH0KPiA+ID4gKwo+ID4gPiArICAgICpmaXJzdCA9IHJhbmdl
LmZpcnN0Owo+ID4gPiArICAgICpsYXN0ID0gcmFuZ2UubGFzdDsKPiA+ID4gKyAgICB0cmFjZV92
aG9zdF92ZHBhX2dldF9pb3ZhX3JhbmdlKGRldiwgKmZpcnN0LCAqbGFzdCk7Cj4gPiA+ICsgICAg
cmV0dXJuIHJldDsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiAgIC8qKgo+ID4gPiAgICAqIE1hcHMg
UUVNVSB2YWRkciBtZW1vcnkgdG8gZGV2aWNlIGluIGEgc3VpdGFibGUgd2F5IGZvciBzaGFkb3cg
dmlydHF1ZXVlOgo+ID4gPiAgICAqIC0gSXQgYWx3YXlzIHJlZmVyZW5jZSBxZW11IG1lbW9yeSBh
ZGRyZXNzLCBub3QgZ3Vlc3QncyBtZW1vcnkuCj4gPiA+IEBAIC04ODEsNiArOTEwLDcgQEAgc3Rh
dGljIGJvb2wgdmhvc3RfdmRwYV9zdnFfc3RhcnRfdnEoc3RydWN0IHZob3N0X2RldiAqZGV2LCB1
bnNpZ25lZCBpZHgpCj4gPiA+ICAgc3RhdGljIHVuc2lnbmVkIHZob3N0X3ZkcGFfZW5hYmxlX3N2
cShzdHJ1Y3Qgdmhvc3RfdmRwYSAqdiwgYm9vbCBlbmFibGUpCj4gPiA+ICAgewo+ID4gPiAgICAg
ICBzdHJ1Y3Qgdmhvc3RfZGV2ICpoZGV2ID0gdi0+ZGV2Owo+ID4gPiArICAgIGh3YWRkciBpb3Zh
X2ZpcnN0LCBpb3ZhX2xhc3Q7Cj4gPiA+ICAgICAgIHVuc2lnbmVkIG47Cj4gPiA+ICAgICAgIGlu
dCByOwo+ID4gPgo+ID4gPiBAQCAtODk0LDcgKzkyNCw3IEBAIHN0YXRpYyB1bnNpZ25lZCB2aG9z
dF92ZHBhX2VuYWJsZV9zdnEoc3RydWN0IHZob3N0X3ZkcGEgKnYsIGJvb2wgZW5hYmxlKQo+ID4g
PiAgICAgICAgICAgLyogQWxsb2NhdGUgcmVzb3VyY2VzICovCj4gPiA+ICAgICAgICAgICBhc3Nl
cnQodi0+c2hhZG93X3Zxcy0+bGVuID09IDApOwo+ID4gPiAgICAgICAgICAgZm9yIChuID0gMDsg
biA8IGhkZXYtPm52cXM7ICsrbikgewo+ID4gPiAtICAgICAgICAgICAgVmhvc3RTaGFkb3dWaXJ0
cXVldWUgKnN2cSA9IHZob3N0X3N2cV9uZXcoaGRldiwgbik7Cj4gPiA+ICsgICAgICAgICAgICBW
aG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxID0gdmhvc3Rfc3ZxX25ldyhoZGV2LCBuLCB2LT5pb3Zh
X21hcCk7Cj4gPiA+ICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFzdnEpKSB7Cj4gPiA+ICAg
ICAgICAgICAgICAgICAgIGdfcHRyX2FycmF5X3NldF9zaXplKHYtPnNoYWRvd192cXMsIDApOwo+
ID4gPiAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsKPiA+ID4gQEAgLTkwMyw2ICs5MzMsOCBA
QCBzdGF0aWMgdW5zaWduZWQgdmhvc3RfdmRwYV9lbmFibGVfc3ZxKHN0cnVjdCB2aG9zdF92ZHBh
ICp2LCBib29sIGVuYWJsZSkKPiA+ID4gICAgICAgICAgIH0KPiA+ID4gICAgICAgfQo+ID4gPgo+
ID4gPiArICAgIHIgPSB2aG9zdF92ZHBhX2dldF9pb3ZhX3JhbmdlKGhkZXYsICZpb3ZhX2ZpcnN0
LCAmaW92YV9sYXN0KTsKPiA+ID4gKyAgICBhc3NlcnQociA9PSAwKTsKPiA+ID4gICAgICAgciA9
IHZob3N0X3ZkcGFfdnJpbmdfcGF1c2UoaGRldik7Cj4gPiA+ICAgICAgIGFzc2VydChyID09IDAp
Owo+ID4gPgo+ID4gPiBAQCAtOTEzLDYgKzk0NSwxMiBAQCBzdGF0aWMgdW5zaWduZWQgdmhvc3Rf
dmRwYV9lbmFibGVfc3ZxKHN0cnVjdCB2aG9zdF92ZHBhICp2LCBib29sIGVuYWJsZSkKPiA+ID4g
ICAgICAgICAgIH0KPiA+ID4gICAgICAgfQo+ID4gPgo+ID4gPiArICAgIG1lbW9yeV9saXN0ZW5l
cl91bnJlZ2lzdGVyKCZ2LT5saXN0ZW5lcik7Cj4gPiA+ICsgICAgaWYgKHZob3N0X3ZkcGFfZG1h
X3VubWFwKHYsIGlvdmFfZmlyc3QsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IChpb3ZhX2xhc3QgLSBpb3ZhX2ZpcnN0KSAmIFRBUkdFVF9QQUdFX01BU0spKSB7Cj4gPiA+ICsg
ICAgICAgIGVycm9yX3JlcG9ydCgiRmFpbCB0byBpbnZhbGlkYXRlIGRldmljZSBpb3RsYiIpOwo+
ID4gPiArICAgIH0KPiA+ID4gKwo+ID4gPiAgICAgICAvKiBSZXNldCBkZXZpY2Ugc28gaXQgY2Fu
IGJlIGNvbmZpZ3VyZWQgKi8KPiA+ID4gICAgICAgciA9IHZob3N0X3ZkcGFfZGV2X3N0YXJ0KGhk
ZXYsIGZhbHNlKTsKPiA+ID4gICAgICAgYXNzZXJ0KHIgPT0gMCk7Cj4gPiA+IGRpZmYgLS1naXQg
YS9ody92aXJ0aW8vdHJhY2UtZXZlbnRzIGIvaHcvdmlydGlvL3RyYWNlLWV2ZW50cwo+ID4gPiBp
bmRleCA4ZWQxOWU5ZDBjLi42NTBlNTIxZTM1IDEwMDY0NAo+ID4gPiAtLS0gYS9ody92aXJ0aW8v
dHJhY2UtZXZlbnRzCj4gPiA+ICsrKyBiL2h3L3ZpcnRpby90cmFjZS1ldmVudHMKPiA+ID4gQEAg
LTUyLDYgKzUyLDcgQEAgdmhvc3RfdmRwYV9zZXRfdnJpbmdfY2FsbCh2b2lkICpkZXYsIHVuc2ln
bmVkIGludCBpbmRleCwgaW50IGZkKSAiZGV2OiAlcCBpbmRleDoKPiA+ID4gICB2aG9zdF92ZHBh
X2dldF9mZWF0dXJlcyh2b2lkICpkZXYsIHVpbnQ2NF90IGZlYXR1cmVzKSAiZGV2OiAlcCBmZWF0
dXJlczogMHglIlBSSXg2NAo+ID4gPiAgIHZob3N0X3ZkcGFfc2V0X293bmVyKHZvaWQgKmRldikg
ImRldjogJXAiCj4gPiA+ICAgdmhvc3RfdmRwYV92cV9nZXRfYWRkcih2b2lkICpkZXYsIHZvaWQg
KnZxLCB1aW50NjRfdCBkZXNjX3VzZXJfYWRkciwgdWludDY0X3QgYXZhaWxfdXNlcl9hZGRyLCB1
aW50NjRfdCB1c2VkX3VzZXJfYWRkcikgImRldjogJXAgdnE6ICVwIGRlc2NfdXNlcl9hZGRyOiAw
eCUiUFJJeDY0IiBhdmFpbF91c2VyX2FkZHI6IDB4JSJQUkl4NjQiIHVzZWRfdXNlcl9hZGRyOiAw
eCUiUFJJeDY0Cj4gPiA+ICt2aG9zdF92ZHBhX2dldF9pb3ZhX3JhbmdlKHZvaWQgKmRldiwgdWlu
dDY0X3QgZmlyc3QsIHVpbnQ2NF90IGxhc3QpICJkZXY6ICVwIGZpcnN0OiAweCUiUFJJeDY0IiBs
YXN0OiAweCUiUFJJeDY0Cj4gPiA+Cj4gPiA+ICAgIyB2aXJ0aW8uYwo+ID4gPiAgIHZpcnRxdWV1
ZV9hbGxvY19lbGVtZW50KHZvaWQgKmVsZW0sIHNpemVfdCBzeiwgdW5zaWduZWQgaW5fbnVtLCB1
bnNpZ25lZCBvdXRfbnVtKSAiZWxlbSAlcCBzaXplICV6ZCBpbl9udW0gJXUgb3V0X251bSAldSIK
PiA+Cj4KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClZp
cnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0cy5saW51eC1mb3Vu
ZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcvbWFpbG1hbi9saXN0
aW5mby92aXJ0dWFsaXphdGlvbg==
