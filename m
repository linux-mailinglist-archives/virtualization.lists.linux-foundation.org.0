Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp4.osuosl.org (smtp4.osuosl.org [IPv6:2605:bc80:3010::137])
	by mail.lfdr.de (Postfix) with ESMTPS id BC6024C078B
	for <lists.virtualization@lfdr.de>; Wed, 23 Feb 2022 03:04:16 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by smtp4.osuosl.org (Postfix) with ESMTP id 323B240352;
	Wed, 23 Feb 2022 02:04:15 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
	by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 0W8U_yj3eq-9; Wed, 23 Feb 2022 02:04:13 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by smtp4.osuosl.org (Postfix) with ESMTPS id 1195A40350;
	Wed, 23 Feb 2022 02:04:12 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 5C970C0073;
	Wed, 23 Feb 2022 02:04:12 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp4.osuosl.org (smtp4.osuosl.org [IPv6:2605:bc80:3010::137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 843EEC0011
 for <virtualization@lists.linux-foundation.org>;
 Wed, 23 Feb 2022 02:04:10 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp4.osuosl.org (Postfix) with ESMTP id 69BBC40347
 for <virtualization@lists.linux-foundation.org>;
 Wed, 23 Feb 2022 02:04:10 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
 by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 0kpqIylXB3hh
 for <virtualization@lists.linux-foundation.org>;
 Wed, 23 Feb 2022 02:04:08 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.133.124])
 by smtp4.osuosl.org (Postfix) with ESMTPS id 6BDF140339
 for <virtualization@lists.linux-foundation.org>;
 Wed, 23 Feb 2022 02:04:08 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1645581847;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=qKehpGX8N3Zv2mECHng3CbLXmSkX7YEgc+QoYwmB+x0=;
 b=ORfT34AleDkLcnQuX4Ugl1/9ByPaeV57X+if6MszboPWCnkiboupO8KIYx7GF0kBqNrzwA
 bcAU+NPphxm8M20FMdOxC8SB6DBmgQRe5qvSCD2izA4ee0wfae+TDvxHr+QIMlY/oySn0r
 sWJ5c8iSFUm1HKrXBE2sl8uX5rytntc=
Received: from mail-lj1-f200.google.com (mail-lj1-f200.google.com
 [209.85.208.200]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 us-mta-372-ZgfiuCazOFGW1ajO_g2kkg-1; Tue, 22 Feb 2022 21:04:04 -0500
X-MC-Unique: ZgfiuCazOFGW1ajO_g2kkg-1
Received: by mail-lj1-f200.google.com with SMTP id
 b16-20020a05651c0b1000b0024647a956a2so2777066ljr.5
 for <virtualization@lists.linux-foundation.org>;
 Tue, 22 Feb 2022 18:04:04 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20210112;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=qKehpGX8N3Zv2mECHng3CbLXmSkX7YEgc+QoYwmB+x0=;
 b=6hjefuERd+FVkl20plD9DPtpCr6uO9B5FrapoFTsT+0woJRthbaDNF20R30zzKGvhP
 qRvx02QnOlzRu34tXwfAar8w0EWDEIFy5AuD3MOLb2R2DPC1KF5OAn7N09jFL2wPtHWP
 K9ROWzTVgNeZo/TuL/n7Sgdzx8icHNor+/Va25UrZAgkSF2V9Qdn5uptjGMdaucNlgaf
 FFta3j+qO88sIb+l5amvqgE8S+JniyV2psUOWo6kpBYCroGxEhVePRxtO1i1bpFrhBh7
 olmi5YV9gDprgbati4u4xS28SQxKRwDazOzK/LWqotPB7XWOXsOrV5PGRjhS/L+BQQJ0
 t7/g==
X-Gm-Message-State: AOAM530+juIOBpS2PZv8GEkLcrYBWvT2Fc6liiClP9Hdj7a77+E8rU5K
 YiMQ5HIiCD2SjRp05nuTevPcWZmQ7bei10X3cRgVttaTpUzrXZvSryH0K7PT+QmqO5xw4CeatJM
 MQOvYHVafhoPDRzUOMuqtyRr4za+h5cVanFKbyz/twD5bfboEYjLHnxWxuw==
X-Received: by 2002:a05:651c:982:b0:244:c35d:b1ef with SMTP id
 b2-20020a05651c098200b00244c35db1efmr19548014ljq.243.1645581842830; 
 Tue, 22 Feb 2022 18:04:02 -0800 (PST)
X-Google-Smtp-Source: ABdhPJxbc0Hi1KK6AAjiWX4JAIIKqQVmpzwKozIPTs/mQQS1xZEoI5AqJfUM9Tlf6lTc/TpxuE6Ym9mtKLfWE19dXXA=
X-Received: by 2002:a05:651c:982:b0:244:c35d:b1ef with SMTP id
 b2-20020a05651c098200b00244c35db1efmr19547989ljq.243.1645581842379; Tue, 22
 Feb 2022 18:04:02 -0800 (PST)
MIME-Version: 1.0
References: <20220121202733.404989-1-eperezma@redhat.com>
 <20220121202733.404989-19-eperezma@redhat.com>
 <6c98f4e8-8695-ab83-ae37-2d6293a1fafa@redhat.com>
 <CAJaqyWdDax2+e3ZUEYyYNe5xAL=Oocu+72n89ygayrzYrQz2Yw@mail.gmail.com>
 <75e2fd97-1e34-2b1a-cca4-ceb1aa440479@redhat.com>
 <CAJaqyWfRWexq7jrCkJrPzLB4g_fK42pE8BarMhZwKNYtNXi7XA@mail.gmail.com>
In-Reply-To: <CAJaqyWfRWexq7jrCkJrPzLB4g_fK42pE8BarMhZwKNYtNXi7XA@mail.gmail.com>
From: Jason Wang <jasowang@redhat.com>
Date: Wed, 23 Feb 2022 10:03:51 +0800
Message-ID: <CACGkMEu02W72VEMCGp9CO=4binjZ6QAoxLf83k_CZWDYi+sc6w@mail.gmail.com>
Subject: Re: [PATCH 18/31] vhost: Shadow virtqueue buffers forwarding
To: Eugenio Perez Martin <eperezma@redhat.com>
Authentication-Results: relay.mimecast.com;
 auth=pass smtp.auth=CUSA124A263 smtp.mailfrom=jasowang@redhat.com
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Cc: Laurent Vivier <lvivier@redhat.com>, Parav Pandit <parav@mellanox.com>,
 Cindy Lu <lulu@redhat.com>, "Michael S. Tsirkin" <mst@redhat.com>,
 Richard Henderson <richard.henderson@linaro.org>,
 qemu-level <qemu-devel@nongnu.org>, Gautam Dawar <gdawar@xilinx.com>,
 Markus Armbruster <armbru@redhat.com>, Eduardo Habkost <ehabkost@redhat.com>,
 Harpreet Singh Anand <hanand@xilinx.com>, Xiao W Wang <xiao.w.wang@intel.com>,
 Stefan Hajnoczi <stefanha@redhat.com>, Eli Cohen <eli@mellanox.com>,
 Paolo Bonzini <pbonzini@redhat.com>, Zhu Lingshan <lingshan.zhu@intel.com>,
 virtualization <virtualization@lists.linux-foundation.org>,
 Eric Blake <eblake@redhat.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gV2VkLCBGZWIgMjMsIDIwMjIgYXQgMzowMSBBTSBFdWdlbmlvIFBlcmV6IE1hcnRpbgo8ZXBl
cmV6bWFAcmVkaGF0LmNvbT4gd3JvdGU6Cj4KPiBPbiBUdWUsIEZlYiA4LCAyMDIyIGF0IDk6MTEg
QU0gSmFzb24gV2FuZyA8amFzb3dhbmdAcmVkaGF0LmNvbT4gd3JvdGU6Cj4gPgo+ID4KPiA+IOWc
qCAyMDIyLzIvMiDkuIrljYgxOjA4LCBFdWdlbmlvIFBlcmV6IE1hcnRpbiDlhpnpgZM6Cj4gPiA+
IE9uIFN1biwgSmFuIDMwLCAyMDIyIGF0IDU6NDMgQU0gSmFzb24gV2FuZyA8amFzb3dhbmdAcmVk
aGF0LmNvbT4gd3JvdGU6Cj4gPiA+Pgo+ID4gPj4g5ZyoIDIwMjIvMS8yMiDkuIrljYg0OjI3LCBF
dWdlbmlvIFDDqXJleiDlhpnpgZM6Cj4gPiA+Pj4gSW5pdGlhbCB2ZXJzaW9uIG9mIHNoYWRvdyB2
aXJ0cXVldWUgdGhhdCBhY3R1YWxseSBmb3J3YXJkIGJ1ZmZlcnMuIFRoZXJlCj4gPiA+Pj4gaXMg
bm8gaW9tbXUgc3VwcG9ydCBhdCB0aGUgbW9tZW50LCBhbmQgdGhhdCB3aWxsIGJlIGFkZHJlc3Nl
ZCBpbiBmdXR1cmUKPiA+ID4+PiBwYXRjaGVzIG9mIHRoaXMgc2VyaWVzLiBTaW5jZSBhbGwgdmhv
c3QtdmRwYSBkZXZpY2VzIHVzZSBmb3JjZWQgSU9NTVUsCj4gPiA+Pj4gdGhpcyBtZWFucyB0aGF0
IFNWUSBpcyBub3QgdXNhYmxlIGF0IHRoaXMgcG9pbnQgb2YgdGhlIHNlcmllcyBvbiBhbnkKPiA+
ID4+PiBkZXZpY2UuCj4gPiA+Pj4KPiA+ID4+PiBGb3Igc2ltcGxpY2l0eSBpdCBvbmx5IHN1cHBv
cnRzIG1vZGVybiBkZXZpY2VzLCB0aGF0IGV4cGVjdHMgdnJpbmcKPiA+ID4+PiBpbiBsaXR0bGUg
ZW5kaWFuLCB3aXRoIHNwbGl0IHJpbmcgYW5kIG5vIGV2ZW50IGlkeCBvciBpbmRpcmVjdAo+ID4g
Pj4+IGRlc2NyaXB0b3JzLiBTdXBwb3J0IGZvciB0aGVtIHdpbGwgbm90IGJlIGFkZGVkIGluIHRo
aXMgc2VyaWVzLgo+ID4gPj4+Cj4gPiA+Pj4gSXQgcmV1c2VzIHRoZSBWaXJ0UXVldWUgY29kZSBm
b3IgdGhlIGRldmljZSBwYXJ0LiBUaGUgZHJpdmVyIHBhcnQgaXMKPiA+ID4+PiBiYXNlZCBvbiBM
aW51eCdzIHZpcnRpb19yaW5nIGRyaXZlciwgYnV0IHdpdGggc3RyaXBwZWQgZnVuY3Rpb25hbGl0
eQo+ID4gPj4+IGFuZCBvcHRpbWl6YXRpb25zIHNvIGl0J3MgZWFzaWVyIHRvIHJldmlldy4KPiA+
ID4+Pgo+ID4gPj4+IEhvd2V2ZXIsIGZvcndhcmRpbmcgYnVmZmVycyBoYXZlIHNvbWUgcGFydGlj
dWxhciBwaWVjZXM6IE9uZSBvZiB0aGUgbW9zdAo+ID4gPj4+IHVuZXhwZWN0ZWQgb25lcyBpcyB0
aGF0IGEgZ3Vlc3QncyBidWZmZXIgY2FuIGV4cGFuZCB0aHJvdWdoIG1vcmUgdGhhbgo+ID4gPj4+
IG9uZSBkZXNjcmlwdG9yIGluIFNWUS4gV2hpbGUgdGhpcyBpcyBoYW5kbGVkIGdyYWNlZnVsbHkg
YnkgcWVtdSdzCj4gPiA+Pj4gZW11bGF0ZWQgdmlydGlvIGRldmljZXMsIGl0IG1heSBjYXVzZSB1
bmV4cGVjdGVkIFNWUSBxdWV1ZSBmdWxsLiBUaGlzCj4gPiA+Pj4gcGF0Y2ggYWxzbyBzb2x2ZXMg
aXQgYnkgY2hlY2tpbmcgZm9yIHRoaXMgY29uZGl0aW9uIGF0IGJvdGggZ3Vlc3Qncwo+ID4gPj4+
IGtpY2tzIGFuZCBkZXZpY2UncyBjYWxscy4gVGhlIGNvZGUgbWF5IGJlIG1vcmUgZWxlZ2FudCBp
biB0aGUgZnV0dXJlIGlmCj4gPiA+Pj4gU1ZRIGNvZGUgcnVucyBpbiBpdHMgb3duIGlvY29udGV4
dC4KPiA+ID4+Pgo+ID4gPj4+IFNpZ25lZC1vZmYtYnk6IEV1Z2VuaW8gUMOpcmV6IDxlcGVyZXpt
YUByZWRoYXQuY29tPgo+ID4gPj4+IC0tLQo+ID4gPj4+ICAgIGh3L3ZpcnRpby92aG9zdC1zaGFk
b3ctdmlydHF1ZXVlLmggfCAgIDIgKwo+ID4gPj4+ICAgIGh3L3ZpcnRpby92aG9zdC1zaGFkb3ct
dmlydHF1ZXVlLmMgfCAzNjUgKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0KPiA+ID4+PiAg
ICBody92aXJ0aW8vdmhvc3QtdmRwYS5jICAgICAgICAgICAgIHwgMTExICsrKysrKysrLQo+ID4g
Pj4+ICAgIDMgZmlsZXMgY2hhbmdlZCwgNDYyIGluc2VydGlvbnMoKyksIDE2IGRlbGV0aW9ucygt
KQo+ID4gPj4+Cj4gPiA+Pj4gZGlmZiAtLWdpdCBhL2h3L3ZpcnRpby92aG9zdC1zaGFkb3ctdmly
dHF1ZXVlLmggYi9ody92aXJ0aW8vdmhvc3Qtc2hhZG93LXZpcnRxdWV1ZS5oCj4gPiA+Pj4gaW5k
ZXggMzlhZWY1ZmZkZi4uMTljOTM0YWY0OSAxMDA2NDQKPiA+ID4+PiAtLS0gYS9ody92aXJ0aW8v
dmhvc3Qtc2hhZG93LXZpcnRxdWV1ZS5oCj4gPiA+Pj4gKysrIGIvaHcvdmlydGlvL3Zob3N0LXNo
YWRvdy12aXJ0cXVldWUuaAo+ID4gPj4+IEBAIC0zMyw2ICszMyw4IEBAIHVpbnQxNl90IHZob3N0
X3N2cV9nZXRfbnVtKGNvbnN0IFZob3N0U2hhZG93VmlydHF1ZXVlICpzdnEpOwo+ID4gPj4+ICAg
IHNpemVfdCB2aG9zdF9zdnFfZHJpdmVyX2FyZWFfc2l6ZShjb25zdCBWaG9zdFNoYWRvd1ZpcnRx
dWV1ZSAqc3ZxKTsKPiA+ID4+PiAgICBzaXplX3Qgdmhvc3Rfc3ZxX2RldmljZV9hcmVhX3NpemUo
Y29uc3QgVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSk7Cj4gPiA+Pj4KPiA+ID4+PiArdm9pZCB2
aG9zdF9zdnFfc3RhcnQoVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSwgVmlydElPRGV2aWNlICp2
ZGV2LAo+ID4gPj4+ICsgICAgICAgICAgICAgICAgICAgICBWaXJ0UXVldWUgKnZxKTsKPiA+ID4+
PiAgICB2b2lkIHZob3N0X3N2cV9zdG9wKFZob3N0U2hhZG93VmlydHF1ZXVlICpzdnEpOwo+ID4g
Pj4+Cj4gPiA+Pj4gICAgVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnZob3N0X3N2cV9uZXcodWludDE2
X3QgcXNpemUpOwo+ID4gPj4+IGRpZmYgLS1naXQgYS9ody92aXJ0aW8vdmhvc3Qtc2hhZG93LXZp
cnRxdWV1ZS5jIGIvaHcvdmlydGlvL3Zob3N0LXNoYWRvdy12aXJ0cXVldWUuYwo+ID4gPj4+IGlu
ZGV4IDdjMTY4MDc1ZDcuLmExYTQwNGY2OGYgMTAwNjQ0Cj4gPiA+Pj4gLS0tIGEvaHcvdmlydGlv
L3Zob3N0LXNoYWRvdy12aXJ0cXVldWUuYwo+ID4gPj4+ICsrKyBiL2h3L3ZpcnRpby92aG9zdC1z
aGFkb3ctdmlydHF1ZXVlLmMKPiA+ID4+PiBAQCAtOSw2ICs5LDggQEAKPiA+ID4+Pgo+ID4gPj4+
ICAgICNpbmNsdWRlICJxZW11L29zZGVwLmgiCj4gPiA+Pj4gICAgI2luY2x1ZGUgImh3L3ZpcnRp
by92aG9zdC1zaGFkb3ctdmlydHF1ZXVlLmgiCj4gPiA+Pj4gKyNpbmNsdWRlICJody92aXJ0aW8v
dmhvc3QuaCIKPiA+ID4+PiArI2luY2x1ZGUgImh3L3ZpcnRpby92aXJ0aW8tYWNjZXNzLmgiCj4g
PiA+Pj4gICAgI2luY2x1ZGUgInN0YW5kYXJkLWhlYWRlcnMvbGludXgvdmhvc3RfdHlwZXMuaCIK
PiA+ID4+Pgo+ID4gPj4+ICAgICNpbmNsdWRlICJxZW11L2Vycm9yLXJlcG9ydC5oIgo+ID4gPj4+
IEBAIC0zNiw2ICszOCwzMyBAQCB0eXBlZGVmIHN0cnVjdCBWaG9zdFNoYWRvd1ZpcnRxdWV1ZSB7
Cj4gPiA+Pj4KPiA+ID4+PiAgICAgICAgLyogR3Vlc3QncyBjYWxsIG5vdGlmaWVyLCB3aGVyZSBT
VlEgY2FsbHMgZ3Vlc3QuICovCj4gPiA+Pj4gICAgICAgIEV2ZW50Tm90aWZpZXIgc3ZxX2NhbGw7
Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgLyogVmlydGlvIHF1ZXVlIHNoYWRvd2luZyAqLwo+ID4g
Pj4+ICsgICAgVmlydFF1ZXVlICp2cTsKPiA+ID4+PiArCj4gPiA+Pj4gKyAgICAvKiBWaXJ0aW8g
ZGV2aWNlICovCj4gPiA+Pj4gKyAgICBWaXJ0SU9EZXZpY2UgKnZkZXY7Cj4gPiA+Pj4gKwo+ID4g
Pj4+ICsgICAgLyogTWFwIGZvciByZXR1cm5pbmcgZ3Vlc3QncyBkZXNjcmlwdG9ycyAqLwo+ID4g
Pj4+ICsgICAgVmlydFF1ZXVlRWxlbWVudCAqKnJpbmdfaWRfbWFwczsKPiA+ID4+PiArCj4gPiA+
Pj4gKyAgICAvKiBOZXh0IFZpcnRRdWV1ZSBlbGVtZW50IHRoYXQgZ3Vlc3QgbWFkZSBhdmFpbGFi
bGUgKi8KPiA+ID4+PiArICAgIFZpcnRRdWV1ZUVsZW1lbnQgKm5leHRfZ3Vlc3RfYXZhaWxfZWxl
bTsKPiA+ID4+PiArCj4gPiA+Pj4gKyAgICAvKiBOZXh0IGhlYWQgdG8gZXhwb3NlIHRvIGRldmlj
ZSAqLwo+ID4gPj4+ICsgICAgdWludDE2X3QgYXZhaWxfaWR4X3NoYWRvdzsKPiA+ID4+PiArCj4g
PiA+Pj4gKyAgICAvKiBOZXh0IGZyZWUgZGVzY3JpcHRvciAqLwo+ID4gPj4+ICsgICAgdWludDE2
X3QgZnJlZV9oZWFkOwo+ID4gPj4+ICsKPiA+ID4+PiArICAgIC8qIExhc3Qgc2VlbiB1c2VkIGlk
eCAqLwo+ID4gPj4+ICsgICAgdWludDE2X3Qgc2hhZG93X3VzZWRfaWR4Owo+ID4gPj4+ICsKPiA+
ID4+PiArICAgIC8qIE5leHQgaGVhZCB0byBjb25zdW1lIGZyb20gZGV2aWNlICovCj4gPiA+Pj4g
KyAgICB1aW50MTZfdCBsYXN0X3VzZWRfaWR4Owo+ID4gPj4+ICsKPiA+ID4+PiArICAgIC8qIENh
Y2hlIGZvciB0aGUgZXhwb3NlZCBub3RpZmljYXRpb24gZmxhZyAqLwo+ID4gPj4+ICsgICAgYm9v
bCBub3RpZmljYXRpb247Cj4gPiA+Pj4gICAgfSBWaG9zdFNoYWRvd1ZpcnRxdWV1ZTsKPiA+ID4+
Pgo+ID4gPj4+ICAgICNkZWZpbmUgSU5WQUxJRF9TVlFfS0lDS19GRCAtMQo+ID4gPj4+IEBAIC0x
NDgsMzAgKzE3NywyOTQgQEAgYm9vbCB2aG9zdF9zdnFfYWNrX2d1ZXN0X2ZlYXR1cmVzKHVpbnQ2
NF90IGRldl9mZWF0dXJlcywKPiA+ID4+PiAgICAgICAgcmV0dXJuIHRydWU7Cj4gPiA+Pj4gICAg
fQo+ID4gPj4+Cj4gPiA+Pj4gLS8qIEZvcndhcmQgZ3Vlc3Qgbm90aWZpY2F0aW9ucyAqLwo+ID4g
Pj4+IC1zdGF0aWMgdm9pZCB2aG9zdF9oYW5kbGVfZ3Vlc3Rfa2ljayhFdmVudE5vdGlmaWVyICpu
KQo+ID4gPj4+ICsvKioKPiA+ID4+PiArICogTnVtYmVyIG9mIGRlc2NyaXB0b3JzIHRoYXQgU1ZR
IGNhbiBtYWtlIGF2YWlsYWJsZSBmcm9tIHRoZSBndWVzdC4KPiA+ID4+PiArICoKPiA+ID4+PiAr
ICogQHN2cSAgIFRoZSBzdnEKPiA+ID4+PiArICovCj4gPiA+Pj4gK3N0YXRpYyB1aW50MTZfdCB2
aG9zdF9zdnFfYXZhaWxhYmxlX3Nsb3RzKGNvbnN0IFZob3N0U2hhZG93VmlydHF1ZXVlICpzdnEp
Cj4gPiA+Pj4gICAgewo+ID4gPj4+IC0gICAgVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSA9IGNv
bnRhaW5lcl9vZihuLCBWaG9zdFNoYWRvd1ZpcnRxdWV1ZSwKPiA+ID4+PiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ZxX2tpY2spOwo+ID4gPj4+ICsgICAg
cmV0dXJuIHN2cS0+dnJpbmcubnVtIC0gKHN2cS0+YXZhaWxfaWR4X3NoYWRvdyAtIHN2cS0+c2hh
ZG93X3VzZWRfaWR4KTsKPiA+ID4+PiArfQo+ID4gPj4+ICsKPiA+ID4+PiArc3RhdGljIHZvaWQg
dmhvc3Rfc3ZxX3NldF9ub3RpZmljYXRpb24oVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSwgYm9v
bCBlbmFibGUpCj4gPiA+Pj4gK3sKPiA+ID4+PiArICAgIHVpbnQxNl90IG5vdGlmaWNhdGlvbl9m
bGFnOwo+ID4gPj4+Cj4gPiA+Pj4gLSAgICBpZiAodW5saWtlbHkoIWV2ZW50X25vdGlmaWVyX3Rl
c3RfYW5kX2NsZWFyKG4pKSkgewo+ID4gPj4+ICsgICAgaWYgKHN2cS0+bm90aWZpY2F0aW9uID09
IGVuYWJsZSkgewo+ID4gPj4+ICsgICAgICAgIHJldHVybjsKPiA+ID4+PiArICAgIH0KPiA+ID4+
PiArCj4gPiA+Pj4gKyAgICBub3RpZmljYXRpb25fZmxhZyA9IGNwdV90b19sZTE2KFZSSU5HX0FW
QUlMX0ZfTk9fSU5URVJSVVBUKTsKPiA+ID4+PiArCj4gPiA+Pj4gKyAgICBzdnEtPm5vdGlmaWNh
dGlvbiA9IGVuYWJsZTsKPiA+ID4+PiArICAgIGlmIChlbmFibGUpIHsKPiA+ID4+PiArICAgICAg
ICBzdnEtPnZyaW5nLmF2YWlsLT5mbGFncyAmPSB+bm90aWZpY2F0aW9uX2ZsYWc7Cj4gPiA+Pj4g
KyAgICB9IGVsc2Ugewo+ID4gPj4+ICsgICAgICAgIHN2cS0+dnJpbmcuYXZhaWwtPmZsYWdzIHw9
IG5vdGlmaWNhdGlvbl9mbGFnOwo+ID4gPj4+ICsgICAgfQo+ID4gPj4+ICt9Cj4gPiA+Pj4gKwo+
ID4gPj4+ICtzdGF0aWMgdm9pZCB2aG9zdF92cmluZ193cml0ZV9kZXNjcyhWaG9zdFNoYWRvd1Zp
cnRxdWV1ZSAqc3ZxLAo+ID4gPj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjb25zdCBzdHJ1Y3QgaW92ZWMgKmlvdmVjLAo+ID4gPj4+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzaXplX3QgbnVtLCBib29sIG1vcmVfZGVzY3MsIGJvb2wgd3JpdGUp
Cj4gPiA+Pj4gK3sKPiA+ID4+PiArICAgIHVpbnQxNl90IGkgPSBzdnEtPmZyZWVfaGVhZCwgbGFz
dCA9IHN2cS0+ZnJlZV9oZWFkOwo+ID4gPj4+ICsgICAgdW5zaWduZWQgbjsKPiA+ID4+PiArICAg
IHVpbnQxNl90IGZsYWdzID0gd3JpdGUgPyBjcHVfdG9fbGUxNihWUklOR19ERVNDX0ZfV1JJVEUp
IDogMDsKPiA+ID4+PiArICAgIHZyaW5nX2Rlc2NfdCAqZGVzY3MgPSBzdnEtPnZyaW5nLmRlc2M7
Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgaWYgKG51bSA9PSAwKSB7Cj4gPiA+Pj4gKyAgICAgICAg
cmV0dXJuOwo+ID4gPj4+ICsgICAgfQo+ID4gPj4+ICsKPiA+ID4+PiArICAgIGZvciAobiA9IDA7
IG4gPCBudW07IG4rKykgewo+ID4gPj4+ICsgICAgICAgIGlmIChtb3JlX2Rlc2NzIHx8IChuICsg
MSA8IG51bSkpIHsKPiA+ID4+PiArICAgICAgICAgICAgZGVzY3NbaV0uZmxhZ3MgPSBmbGFncyB8
IGNwdV90b19sZTE2KFZSSU5HX0RFU0NfRl9ORVhUKTsKPiA+ID4+PiArICAgICAgICB9IGVsc2Ug
ewo+ID4gPj4+ICsgICAgICAgICAgICBkZXNjc1tpXS5mbGFncyA9IGZsYWdzOwo+ID4gPj4+ICsg
ICAgICAgIH0KPiA+ID4+PiArICAgICAgICBkZXNjc1tpXS5hZGRyID0gY3B1X3RvX2xlNjQoKGh3
YWRkcilpb3ZlY1tuXS5pb3ZfYmFzZSk7Cj4gPiA+Pj4gKyAgICAgICAgZGVzY3NbaV0ubGVuID0g
Y3B1X3RvX2xlMzIoaW92ZWNbbl0uaW92X2xlbik7Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgICAg
IGxhc3QgPSBpOwo+ID4gPj4+ICsgICAgICAgIGkgPSBjcHVfdG9fbGUxNihkZXNjc1tpXS5uZXh0
KTsKPiA+ID4+PiArICAgIH0KPiA+ID4+PiArCj4gPiA+Pj4gKyAgICBzdnEtPmZyZWVfaGVhZCA9
IGxlMTZfdG9fY3B1KGRlc2NzW2xhc3RdLm5leHQpOwo+ID4gPj4+ICt9Cj4gPiA+Pj4gKwo+ID4g
Pj4+ICtzdGF0aWMgdW5zaWduZWQgdmhvc3Rfc3ZxX2FkZF9zcGxpdChWaG9zdFNoYWRvd1ZpcnRx
dWV1ZSAqc3ZxLAo+ID4gPj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBW
aXJ0UXVldWVFbGVtZW50ICplbGVtKQo+ID4gPj4+ICt7Cj4gPiA+Pj4gKyAgICBpbnQgaGVhZDsK
PiA+ID4+PiArICAgIHVuc2lnbmVkIGF2YWlsX2lkeDsKPiA+ID4+PiArICAgIHZyaW5nX2F2YWls
X3QgKmF2YWlsID0gc3ZxLT52cmluZy5hdmFpbDsKPiA+ID4+PiArCj4gPiA+Pj4gKyAgICBoZWFk
ID0gc3ZxLT5mcmVlX2hlYWQ7Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgLyogV2UgbmVlZCBzb21l
IGRlc2NyaXB0b3JzIGhlcmUgKi8KPiA+ID4+PiArICAgIGFzc2VydChlbGVtLT5vdXRfbnVtIHx8
IGVsZW0tPmluX251bSk7Cj4gPiA+Pgo+ID4gPj4gTG9va3MgbGlrZSB0aGlzIGNvdWxkIGJlIHRy
aWdnZXJlZCBieSBndWVzdCwgd2UgbmVlZCBmYWlsIGluc3RlYWQgYXNzZXJ0Cj4gPiA+PiBoZXJl
Lgo+ID4gPj4KPiA+ID4gTXkgdW5kZXJzdGFuZGluZyB3YXMgdGhhdCB2aXJ0cXVldWVfcG9wIGFs
cmVhZHkgc2FuaXRpemVkIHRoYXQgY2FzZSwKPiA+ID4gYnV0IEknbSBub3QgYWJsZSB0byBmaW5k
IHdoZXJlIG5vdy4gSSB3aWxsIHJlY2hlY2sgYW5kLCBpbiBjYXNlIGl0J3MKPiA+ID4gbm90LCBJ
IHdpbGwgbW92ZSB0byBhIGZhaWx1cmUuCj4gPiA+Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgdmhv
c3RfdnJpbmdfd3JpdGVfZGVzY3Moc3ZxLCBlbGVtLT5vdXRfc2csIGVsZW0tPm91dF9udW0sCj4g
PiA+Pj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtLT5pbl9udW0gPiAwLCBmYWxz
ZSk7Cj4gPiA+Pj4gKyAgICB2aG9zdF92cmluZ193cml0ZV9kZXNjcyhzdnEsIGVsZW0tPmluX3Nn
LCBlbGVtLT5pbl9udW0sIGZhbHNlLCB0cnVlKTsKPiA+ID4+PiArCj4gPiA+Pj4gKyAgICAvKgo+
ID4gPj4+ICsgICAgICogUHV0IGVudHJ5IGluIGF2YWlsYWJsZSBhcnJheSAoYnV0IGRvbid0IHVw
ZGF0ZSBhdmFpbC0+aWR4IHVudGlsIHRoZXkKPiA+ID4+PiArICAgICAqIGRvIHN5bmMpLgo+ID4g
Pj4+ICsgICAgICovCj4gPiA+Pj4gKyAgICBhdmFpbF9pZHggPSBzdnEtPmF2YWlsX2lkeF9zaGFk
b3cgJiAoc3ZxLT52cmluZy5udW0gLSAxKTsKPiA+ID4+PiArICAgIGF2YWlsLT5yaW5nW2F2YWls
X2lkeF0gPSBjcHVfdG9fbGUxNihoZWFkKTsKPiA+ID4+PiArICAgIHN2cS0+YXZhaWxfaWR4X3No
YWRvdysrOwo+ID4gPj4+ICsKPiA+ID4+PiArICAgIC8qIFVwZGF0ZSBhdmFpbCBpbmRleCBhZnRl
ciB0aGUgZGVzY3JpcHRvciBpcyB3cm90ZSAqLwo+ID4gPj4+ICsgICAgc21wX3dtYigpOwo+ID4g
Pj4+ICsgICAgYXZhaWwtPmlkeCA9IGNwdV90b19sZTE2KHN2cS0+YXZhaWxfaWR4X3NoYWRvdyk7
Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgcmV0dXJuIGhlYWQ7Cj4gPiA+Pj4gK30KPiA+ID4+PiAr
Cj4gPiA+Pj4gK3N0YXRpYyB2b2lkIHZob3N0X3N2cV9hZGQoVmhvc3RTaGFkb3dWaXJ0cXVldWUg
KnN2cSwgVmlydFF1ZXVlRWxlbWVudCAqZWxlbSkKPiA+ID4+PiArewo+ID4gPj4+ICsgICAgdW5z
aWduZWQgcWVtdV9oZWFkID0gdmhvc3Rfc3ZxX2FkZF9zcGxpdChzdnEsIGVsZW0pOwo+ID4gPj4+
ICsKPiA+ID4+PiArICAgIHN2cS0+cmluZ19pZF9tYXBzW3FlbXVfaGVhZF0gPSBlbGVtOwo+ID4g
Pj4+ICt9Cj4gPiA+Pj4gKwo+ID4gPj4+ICtzdGF0aWMgdm9pZCB2aG9zdF9zdnFfa2ljayhWaG9z
dFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxKQo+ID4gPj4+ICt7Cj4gPiA+Pj4gKyAgICAvKiBXZSBuZWVk
IHRvIGV4cG9zZSBhdmFpbGFibGUgYXJyYXkgZW50cmllcyBiZWZvcmUgY2hlY2tpbmcgdXNlZCBm
bGFncyAqLwo+ID4gPj4+ICsgICAgc21wX21iKCk7Cj4gPiA+Pj4gKyAgICBpZiAoc3ZxLT52cmlu
Zy51c2VkLT5mbGFncyAmIFZSSU5HX1VTRURfRl9OT19OT1RJRlkpIHsKPiA+ID4+PiAgICAgICAg
ICAgIHJldHVybjsKPiA+ID4+PiAgICAgICAgfQo+ID4gPj4+Cj4gPiA+Pj4gICAgICAgIGV2ZW50
X25vdGlmaWVyX3NldCgmc3ZxLT5oZGV2X2tpY2spOwo+ID4gPj4+ICAgIH0KPiA+ID4+Pgo+ID4g
Pj4+IC0vKiBGb3J3YXJkIHZob3N0IG5vdGlmaWNhdGlvbnMgKi8KPiA+ID4+PiArLyoqCj4gPiA+
Pj4gKyAqIEZvcndhcmQgYXZhaWxhYmxlIGJ1ZmZlcnMuCj4gPiA+Pj4gKyAqCj4gPiA+Pj4gKyAq
IEBzdnEgU2hhZG93IFZpcnRRdWV1ZQo+ID4gPj4+ICsgKgo+ID4gPj4+ICsgKiBOb3RlIHRoYXQg
dGhpcyBmdW5jdGlvbiBkb2VzIG5vdCBndWFyYW50ZWUgdGhhdCBhbGwgZ3Vlc3QncyBhdmFpbGFi
bGUKPiA+ID4+PiArICogYnVmZmVycyBhcmUgYXZhaWxhYmxlIHRvIHRoZSBkZXZpY2UgaW4gU1ZR
IGF2YWlsIHJpbmcuIFRoZSBndWVzdCBtYXkgaGF2ZQo+ID4gPj4+ICsgKiBleHBvc2VkIGEgR1BB
IC8gR0lPVkEgY29uZ2l1b3VzIGJ1ZmZlciwgYnV0IGl0IG1heSBub3QgYmUgY29udGlndW91cyBp
biBxZW11Cj4gPiA+Pj4gKyAqIHZhZGRyLgo+ID4gPj4+ICsgKgo+ID4gPj4+ICsgKiBJZiB0aGF0
IGhhcHBlbnMsIGd1ZXN0J3Mga2ljayBub3RpZmljYXRpb25zIHdpbGwgYmUgZGlzYWJsZWQgdW50
aWwgZGV2aWNlCj4gPiA+Pj4gKyAqIG1ha2VzIHNvbWUgYnVmZmVycyB1c2VkLgo+ID4gPj4+ICsg
Ki8KPiA+ID4+PiArc3RhdGljIHZvaWQgdmhvc3RfaGFuZGxlX2d1ZXN0X2tpY2soVmhvc3RTaGFk
b3dWaXJ0cXVldWUgKnN2cSkKPiA+ID4+PiArewo+ID4gPj4+ICsgICAgLyogQ2xlYXIgZXZlbnQg
bm90aWZpZXIgKi8KPiA+ID4+PiArICAgIGV2ZW50X25vdGlmaWVyX3Rlc3RfYW5kX2NsZWFyKCZz
dnEtPnN2cV9raWNrKTsKPiA+ID4+PiArCj4gPiA+Pj4gKyAgICAvKiBNYWtlIGF2YWlsYWJsZSBh
cyBtYW55IGJ1ZmZlcnMgYXMgcG9zc2libGUgKi8KPiA+ID4+PiArICAgIGRvIHsKPiA+ID4+PiAr
ICAgICAgICBpZiAodmlydGlvX3F1ZXVlX2dldF9ub3RpZmljYXRpb24oc3ZxLT52cSkpIHsKPiA+
ID4+PiArICAgICAgICAgICAgdmlydGlvX3F1ZXVlX3NldF9ub3RpZmljYXRpb24oc3ZxLT52cSwg
ZmFsc2UpOwo+ID4gPj4KPiA+ID4+IFRoaXMgbG9va3MgbGlrZSBhbiBvcHRpbWl6YXRpb24gdGhl
IHNob3VsZCBiZWxvbmcgdG8KPiA+ID4+IHZpcnRpb19xdWV1ZV9zZXRfbm90aWZpY2F0aW9uKCkg
aXRzZWxmLgo+ID4gPj4KPiA+ID4gU3VyZSB3ZSBjYW4gbW92ZS4KPiA+ID4KPiA+ID4+PiArICAg
ICAgICB9Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgICAgIHdoaWxlICh0cnVlKSB7Cj4gPiA+Pj4g
KyAgICAgICAgICAgIFZpcnRRdWV1ZUVsZW1lbnQgKmVsZW07Cj4gPiA+Pj4gKwo+ID4gPj4+ICsg
ICAgICAgICAgICBpZiAoc3ZxLT5uZXh0X2d1ZXN0X2F2YWlsX2VsZW0pIHsKPiA+ID4+PiArICAg
ICAgICAgICAgICAgIGVsZW0gPSBnX3N0ZWFsX3BvaW50ZXIoJnN2cS0+bmV4dF9ndWVzdF9hdmFp
bF9lbGVtKTsKPiA+ID4+PiArICAgICAgICAgICAgfSBlbHNlIHsKPiA+ID4+PiArICAgICAgICAg
ICAgICAgIGVsZW0gPSB2aXJ0cXVldWVfcG9wKHN2cS0+dnEsIHNpemVvZigqZWxlbSkpOwo+ID4g
Pj4+ICsgICAgICAgICAgICB9Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgICAgICAgICBpZiAoIWVs
ZW0pIHsKPiA+ID4+PiArICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gPj4+ICsgICAgICAgICAg
ICB9Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgICAgICAgICBpZiAoZWxlbS0+b3V0X251bSArIGVs
ZW0tPmluX251bSA+Cj4gPiA+Pj4gKyAgICAgICAgICAgICAgICB2aG9zdF9zdnFfYXZhaWxhYmxl
X3Nsb3RzKHN2cSkpIHsKPiA+ID4+PiArICAgICAgICAgICAgICAgIC8qCj4gPiA+Pj4gKyAgICAg
ICAgICAgICAgICAgKiBUaGlzIGNvbmRpdGlvbiBpcyBwb3NzaWJsZSBzaW5jZSBhIGNvbnRpZ3Vv
dXMgYnVmZmVyIGluIEdQQQo+ID4gPj4+ICsgICAgICAgICAgICAgICAgICogZG9lcyBub3QgaW1w
bHkgYSBjb250aWd1b3VzIGJ1ZmZlciBpbiBxZW11J3MgVkEKPiA+ID4+PiArICAgICAgICAgICAg
ICAgICAqIHNjYXR0ZXItZ2F0aGVyIHNlZ21lbnRzLiBJZiB0aGF0IGhhcHBlbiwgdGhlIGJ1ZmZl
ciBleHBvc2VkCj4gPiA+Pj4gKyAgICAgICAgICAgICAgICAgKiB0byB0aGUgZGV2aWNlIG5lZWRz
IHRvIGJlIGEgY2hhaW4gb2YgZGVzY3JpcHRvcnMgYXQgdGhpcwo+ID4gPj4+ICsgICAgICAgICAg
ICAgICAgICogbW9tZW50Lgo+ID4gPj4+ICsgICAgICAgICAgICAgICAgICoKPiA+ID4+PiArICAg
ICAgICAgICAgICAgICAqIFNWUSBjYW5ub3QgaG9sZCBtb3JlIGF2YWlsYWJsZSBidWZmZXJzIGlm
IHdlIGFyZSBoZXJlOgo+ID4gPj4+ICsgICAgICAgICAgICAgICAgICogcXVldWUgdGhlIGN1cnJl
bnQgZ3Vlc3QgZGVzY3JpcHRvciBhbmQgaWdub3JlIGZ1cnRoZXIga2lja3MKPiA+ID4+PiArICAg
ICAgICAgICAgICAgICAqIHVudGlsIHNvbWUgZWxlbWVudHMgYXJlIHVzZWQuCj4gPiA+Pj4gKyAg
ICAgICAgICAgICAgICAgKi8KPiA+ID4+PiArICAgICAgICAgICAgICAgIHN2cS0+bmV4dF9ndWVz
dF9hdmFpbF9lbGVtID0gZWxlbTsKPiA+ID4+PiArICAgICAgICAgICAgICAgIHJldHVybjsKPiA+
ID4+PiArICAgICAgICAgICAgfQo+ID4gPj4+ICsKPiA+ID4+PiArICAgICAgICAgICAgdmhvc3Rf
c3ZxX2FkZChzdnEsIGVsZW0pOwo+ID4gPj4+ICsgICAgICAgICAgICB2aG9zdF9zdnFfa2ljayhz
dnEpOwo+ID4gPj4+ICsgICAgICAgIH0KPiA+ID4+PiArCj4gPiA+Pj4gKyAgICAgICAgdmlydGlv
X3F1ZXVlX3NldF9ub3RpZmljYXRpb24oc3ZxLT52cSwgdHJ1ZSk7Cj4gPiA+Pj4gKyAgICB9IHdo
aWxlICghdmlydGlvX3F1ZXVlX2VtcHR5KHN2cS0+dnEpKTsKPiA+ID4+PiArfQo+ID4gPj4+ICsK
PiA+ID4+PiArLyoqCj4gPiA+Pj4gKyAqIEhhbmRsZSBndWVzdCdzIGtpY2suCj4gPiA+Pj4gKyAq
Cj4gPiA+Pj4gKyAqIEBuIGd1ZXN0IGtpY2sgZXZlbnQgbm90aWZpZXIsIHRoZSBvbmUgdGhhdCBn
dWVzdCBzZXQgdG8gbm90aWZ5IHN2cS4KPiA+ID4+PiArICovCj4gPiA+Pj4gK3N0YXRpYyB2b2lk
IHZob3N0X2hhbmRsZV9ndWVzdF9raWNrX25vdGlmaWVyKEV2ZW50Tm90aWZpZXIgKm4pCj4gPiA+
Pj4gK3sKPiA+ID4+PiArICAgIFZob3N0U2hhZG93VmlydHF1ZXVlICpzdnEgPSBjb250YWluZXJf
b2YobiwgVmhvc3RTaGFkb3dWaXJ0cXVldWUsCj4gPiA+Pj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN2cV9raWNrKTsKPiA+ID4+PiArICAgIHZob3N0X2hh
bmRsZV9ndWVzdF9raWNrKHN2cSk7Cj4gPiA+Pj4gK30KPiA+ID4+PiArCj4gPiA+Pj4gK3N0YXRp
YyBib29sIHZob3N0X3N2cV9tb3JlX3VzZWQoVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSkKPiA+
ID4+PiArewo+ID4gPj4+ICsgICAgaWYgKHN2cS0+bGFzdF91c2VkX2lkeCAhPSBzdnEtPnNoYWRv
d191c2VkX2lkeCkgewo+ID4gPj4+ICsgICAgICAgIHJldHVybiB0cnVlOwo+ID4gPj4+ICsgICAg
fQo+ID4gPj4+ICsKPiA+ID4+PiArICAgIHN2cS0+c2hhZG93X3VzZWRfaWR4ID0gY3B1X3RvX2xl
MTYoc3ZxLT52cmluZy51c2VkLT5pZHgpOwo+ID4gPj4+ICsKPiA+ID4+PiArICAgIHJldHVybiBz
dnEtPmxhc3RfdXNlZF9pZHggIT0gc3ZxLT5zaGFkb3dfdXNlZF9pZHg7Cj4gPiA+Pj4gK30KPiA+
ID4+PiArCj4gPiA+Pj4gK3N0YXRpYyBWaXJ0UXVldWVFbGVtZW50ICp2aG9zdF9zdnFfZ2V0X2J1
ZihWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxKQo+ID4gPj4+ICt7Cj4gPiA+Pj4gKyAgICB2cmlu
Z19kZXNjX3QgKmRlc2NzID0gc3ZxLT52cmluZy5kZXNjOwo+ID4gPj4+ICsgICAgY29uc3QgdnJp
bmdfdXNlZF90ICp1c2VkID0gc3ZxLT52cmluZy51c2VkOwo+ID4gPj4+ICsgICAgdnJpbmdfdXNl
ZF9lbGVtX3QgdXNlZF9lbGVtOwo+ID4gPj4+ICsgICAgdWludDE2X3QgbGFzdF91c2VkOwo+ID4g
Pj4+ICsKPiA+ID4+PiArICAgIGlmICghdmhvc3Rfc3ZxX21vcmVfdXNlZChzdnEpKSB7Cj4gPiA+
Pj4gKyAgICAgICAgcmV0dXJuIE5VTEw7Cj4gPiA+Pj4gKyAgICB9Cj4gPiA+Pj4gKwo+ID4gPj4+
ICsgICAgLyogT25seSBnZXQgdXNlZCBhcnJheSBlbnRyaWVzIGFmdGVyIHRoZXkgaGF2ZSBiZWVu
IGV4cG9zZWQgYnkgZGV2ICovCj4gPiA+Pj4gKyAgICBzbXBfcm1iKCk7Cj4gPiA+Pj4gKyAgICBs
YXN0X3VzZWQgPSBzdnEtPmxhc3RfdXNlZF9pZHggJiAoc3ZxLT52cmluZy5udW0gLSAxKTsKPiA+
ID4+PiArICAgIHVzZWRfZWxlbS5pZCA9IGxlMzJfdG9fY3B1KHVzZWQtPnJpbmdbbGFzdF91c2Vk
XS5pZCk7Cj4gPiA+Pj4gKyAgICB1c2VkX2VsZW0ubGVuID0gbGUzMl90b19jcHUodXNlZC0+cmlu
Z1tsYXN0X3VzZWRdLmxlbik7Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgc3ZxLT5sYXN0X3VzZWRf
aWR4Kys7Cj4gPiA+Pj4gKyAgICBpZiAodW5saWtlbHkodXNlZF9lbGVtLmlkID49IHN2cS0+dnJp
bmcubnVtKSkgewo+ID4gPj4+ICsgICAgICAgIGVycm9yX3JlcG9ydCgiRGV2aWNlICVzIHNheXMg
aW5kZXggJXUgaXMgdXNlZCIsIHN2cS0+dmRldi0+bmFtZSwKPiA+ID4+PiArICAgICAgICAgICAg
ICAgICAgICAgdXNlZF9lbGVtLmlkKTsKPiA+ID4+PiArICAgICAgICByZXR1cm4gTlVMTDsKPiA+
ID4+PiArICAgIH0KPiA+ID4+PiArCj4gPiA+Pj4gKyAgICBpZiAodW5saWtlbHkoIXN2cS0+cmlu
Z19pZF9tYXBzW3VzZWRfZWxlbS5pZF0pKSB7Cj4gPiA+Pj4gKyAgICAgICAgZXJyb3JfcmVwb3J0
KAo+ID4gPj4+ICsgICAgICAgICAgICAiRGV2aWNlICVzIHNheXMgaW5kZXggJXUgaXMgdXNlZCwg
YnV0IGl0IHdhcyBub3QgYXZhaWxhYmxlIiwKPiA+ID4+PiArICAgICAgICAgICAgc3ZxLT52ZGV2
LT5uYW1lLCB1c2VkX2VsZW0uaWQpOwo+ID4gPj4+ICsgICAgICAgIHJldHVybiBOVUxMOwo+ID4g
Pj4+ICsgICAgfQo+ID4gPj4+ICsKPiA+ID4+PiArICAgIGRlc2NzW3VzZWRfZWxlbS5pZF0ubmV4
dCA9IHN2cS0+ZnJlZV9oZWFkOwo+ID4gPj4+ICsgICAgc3ZxLT5mcmVlX2hlYWQgPSB1c2VkX2Vs
ZW0uaWQ7Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgc3ZxLT5yaW5nX2lkX21hcHNbdXNlZF9lbGVt
LmlkXS0+bGVuID0gdXNlZF9lbGVtLmxlbjsKPiA+ID4+PiArICAgIHJldHVybiBnX3N0ZWFsX3Bv
aW50ZXIoJnN2cS0+cmluZ19pZF9tYXBzW3VzZWRfZWxlbS5pZF0pOwo+ID4gPj4+ICt9Cj4gPiA+
Pj4gKwo+ID4gPj4+ICtzdGF0aWMgdm9pZCB2aG9zdF9zdnFfZmx1c2goVmhvc3RTaGFkb3dWaXJ0
cXVldWUgKnN2cSwKPiA+ID4+PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgY2hl
Y2tfZm9yX2F2YWlsX3F1ZXVlKQo+ID4gPj4+ICt7Cj4gPiA+Pj4gKyAgICBWaXJ0UXVldWUgKnZx
ID0gc3ZxLT52cTsKPiA+ID4+PiArCj4gPiA+Pj4gKyAgICAvKiBNYWtlIGFzIG1hbnkgYnVmZmVy
cyBhcyBwb3NzaWJsZSB1c2VkLiAqLwo+ID4gPj4+ICsgICAgZG8gewo+ID4gPj4+ICsgICAgICAg
IHVuc2lnbmVkIGkgPSAwOwo+ID4gPj4+ICsKPiA+ID4+PiArICAgICAgICB2aG9zdF9zdnFfc2V0
X25vdGlmaWNhdGlvbihzdnEsIGZhbHNlKTsKPiA+ID4+PiArICAgICAgICB3aGlsZSAodHJ1ZSkg
ewo+ID4gPj4+ICsgICAgICAgICAgICBnX2F1dG9mcmVlIFZpcnRRdWV1ZUVsZW1lbnQgKmVsZW0g
PSB2aG9zdF9zdnFfZ2V0X2J1ZihzdnEpOwo+ID4gPj4+ICsgICAgICAgICAgICBpZiAoIWVsZW0p
IHsKPiA+ID4+PiArICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gPj4+ICsgICAgICAgICAgICB9
Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgICAgICAgICBpZiAodW5saWtlbHkoaSA+PSBzdnEtPnZy
aW5nLm51bSkpIHsKPiA+ID4+PiArICAgICAgICAgICAgICAgIHZpcnRpb19lcnJvcihzdnEtPnZk
ZXYsCj4gPiA+Pj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAiTW9yZSB0aGFuICV1IHVzZWQg
YnVmZmVycyBvYnRhaW5lZCBpbiBhICV1IHNpemUgU1ZRIiwKPiA+ID4+PiArICAgICAgICAgICAg
ICAgICAgICAgICAgIGksIHN2cS0+dnJpbmcubnVtKTsKPiA+ID4+PiArICAgICAgICAgICAgICAg
IHZpcnRxdWV1ZV9maWxsKHZxLCBlbGVtLCBlbGVtLT5sZW4sIGkpOwo+ID4gPj4+ICsgICAgICAg
ICAgICAgICAgdmlydHF1ZXVlX2ZsdXNoKHZxLCBpKTsKPiA+ID4+Cj4gPiA+PiBMZXQncyBzaW1w
bHkgdXNlIHZpcnRxdWV1ZV9wdXNoKCkgaGVyZT8KPiA+ID4+Cj4gPiA+IHZpcnRxdWV1ZV9wdXNo
IHN1cHBvcnQgdG8gZmlsbCBhbmQgZmx1c2ggb25seSBvbmUgZWxlbWVudCwgaW5zdGVhZCBvZgo+
ID4gPiBiYXRjaC4gSSdtIGZpbmUgd2l0aCBlaXRoZXIgYnV0IEkgdGhpbmsgdGhlIGxlc3MgdXBk
YXRlcyB0byB0aGUgdXNlZAo+ID4gPiBpZHgsIHRoZSBiZXR0ZXIuCj4gPgo+ID4KPiA+IEZpbmUu
Cj4gPgo+ID4KPiA+ID4KPiA+ID4+PiArICAgICAgICAgICAgICAgIGkgPSAwOwo+ID4gPj4KPiA+
ID4+IERvIHdlIG5lZWQgdG8gYmFpbCBvdXQgaGVyZT8KPiA+ID4+Cj4gPiA+IFllcyBJIGd1ZXNz
IHdlIGNhbiBzaW1wbHkgcmV0dXJuLgo+ID4gPgo+ID4gPj4+ICsgICAgICAgICAgICB9Cj4gPiA+
Pj4gKyAgICAgICAgICAgIHZpcnRxdWV1ZV9maWxsKHZxLCBlbGVtLCBlbGVtLT5sZW4sIGkrKyk7
Cj4gPiA+Pj4gKyAgICAgICAgfQo+ID4gPj4+ICsKPiA+ID4+PiArICAgICAgICB2aXJ0cXVldWVf
Zmx1c2godnEsIGkpOwo+ID4gPj4+ICsgICAgICAgIGV2ZW50X25vdGlmaWVyX3NldCgmc3ZxLT5z
dnFfY2FsbCk7Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgICAgIGlmIChjaGVja19mb3JfYXZhaWxf
cXVldWUgJiYgc3ZxLT5uZXh0X2d1ZXN0X2F2YWlsX2VsZW0pIHsKPiA+ID4+PiArICAgICAgICAg
ICAgLyoKPiA+ID4+PiArICAgICAgICAgICAgICogQXZhaWwgcmluZyB3YXMgZnVsbCB3aGVuIHZo
b3N0X3N2cV9mbHVzaCB3YXMgY2FsbGVkLCBzbyBpdCdzIGEKPiA+ID4+PiArICAgICAgICAgICAg
ICogZ29vZCBtb21lbnQgdG8gbWFrZSBtb3JlIGRlc2NyaXB0b3JzIGF2YWlsYWJsZSBpZiBwb3Nz
aWJsZQo+ID4gPj4+ICsgICAgICAgICAgICAgKi8KPiA+ID4+PiArICAgICAgICAgICAgdmhvc3Rf
aGFuZGxlX2d1ZXN0X2tpY2soc3ZxKTsKPiA+ID4+Cj4gPiA+PiBJcyB0aGVyZSBiZXR0ZXIgdG8g
aGF2ZSBhIHNpbWlsYXIgY2hlY2sgYXMgdmhvc3RfaGFuZGxlX2d1ZXN0X2tpY2soKSBkaWQ/Cj4g
PiA+Pgo+ID4gPj4gICAgICAgICAgICAgICBpZiAoZWxlbS0+b3V0X251bSArIGVsZW0tPmluX251
bSA+Cj4gPiA+PiAgICAgICAgICAgICAgICAgICB2aG9zdF9zdnFfYXZhaWxhYmxlX3Nsb3RzKHN2
cSkpIHsKPiA+ID4+Cj4gPiA+IEl0IHdpbGwgYmUgZHVwbGljYXRlZCB3aGVuIHdlIGNhbGwgdmhv
c3RfaGFuZGxlX2d1ZXN0X2tpY2ssIHdvbid0IGl0Pwo+ID4KPiA+Cj4gPiBSaWdodCwgSSBtaXMt
cmVhZCB0aGUgY29kZS4KPiA+Cj4gPgo+ID4gPgo+ID4gPj4+ICsgICAgICAgIH0KPiA+ID4+PiAr
Cj4gPiA+Pj4gKyAgICAgICAgdmhvc3Rfc3ZxX3NldF9ub3RpZmljYXRpb24oc3ZxLCB0cnVlKTsK
PiA+ID4+Cj4gPiA+PiBBIG1iKCkgaXMgbmVlZGVkIGhlcmU/IE90aGVyd2lzZSB3ZSBtYXkgbG9z
dCBhIGNhbGwgaGVyZSAod2hlcmUKPiA+ID4+IHZob3N0X3N2cV9tb3JlX3VzZWQoKSBpcyBydW4g
YmVmb3JlIHZob3N0X3N2cV9zZXRfbm90aWZpY2F0aW9uKCkpLgo+ID4gPj4KPiA+ID4gSSdtIGNv
bmZ1c2VkIGhlcmUgdGhlbiwgSSB0aG91Z2h0IHlvdSBzYWlkIHRoaXMgaXMganVzdCBhIGhpbnQg
c28KPiA+ID4gdGhlcmUgd2FzIG5vIG5lZWQ/IFsxXS4gSSB0aGluayB0aGUgbWVtb3J5IGJhcnJp
ZXIgaXMgbmVlZGVkIHRvby4KPiA+Cj4gPgo+ID4gWWVzLCBpdCdzIGEgaGludCBidXQ6Cj4gPgo+
ID4gMSkgV2hlbiB3ZSBkaXNhYmxlIHRoZSBub3RpZmljYXRpb24sIGNvbnNpZGVyIHRoZSBub3Rp
ZmljYXRpb24gZGlzYWJsZQo+ID4gaXMganVzdCBhIGhpbnQsIGRldmljZSBjYW4gc3RpbGwgcmFp
c2UgYW4gaW50ZXJydXB0LCBzbyB0aGUgb3JkZXJpbmcgaXMKPiA+IG1lYW5pbmdsZXNzIGFuZCBh
IG1lbW9yeSBiYXJyaWVyIGlzIG5vdCBuZWNlc3NhcnkgKHRoZQo+ID4gdmhvc3Rfc3ZxX3NldF9u
b3RpZmljYXRpb24oc3ZxLCBmYWxzZSkpCj4gPgo+ID4gMikgV2hlbiB3ZSBlbmFibGUgdGhlIG5v
dGlmaWNhdGlvbiwgdGhvdWdoIGl0J3MgYSBoaW50LCB0aGUgZGV2aWNlIGNhbgo+ID4gY2hvb3Nl
IHRvIGltcGxlbWVudCBpdCBieSBlbmFibGluZyB0aGUgaW50ZXJydXB0LCBpbiB0aGlzIGNhc2Us
IHRoZQo+ID4gbm90aWZpY2F0aW9uIGVuYWJsZSBzaG91bGQgYmUgZG9uZSBiZWZvcmUgY2hlY2tp
bmcgdGhlIHVzZWQuIE90aGVyd2lzZSwKPiA+IHRoZSBjaGVja2luZyBvZiBtb3JlIHVzZWQgbWln
aHQgYmUgZG9uZSBiZWZvcmUgZW5hYmxlIHRoZSBub3RpZmljYXRpb246Cj4gPgo+ID4gMSkgZHJp
dmVyIGNoZWNrIG1vcmUgdXNlZAo+ID4gMikgZGV2aWNlIGFkZCBtb3JlIHVzZWQgYnV0IG5vIG5v
dGlmaWNhdGlvbgo+ID4gMykgZHJpdmVyIGVuYWJsZSB0aGUgbm90aWZpY2F0aW9uIHRoZW4gd2Ug
bG9zdCBhIG5vdGlmaWNhdGlvbiBoZXJlCj4gPgo+Cj4gVGhhdCB3YXMgbXkgdW5kZXJzdGFuZGlu
ZyB0b28uIFNvIHRoZSByaWdodCB3YXkgaXMgdG8gb25seSBhZGQgdGhlCj4gbWVtb3J5IGJhcnJp
ZXIgaW4gY2FzZSAyKSwgd2hlbiBzZXR0aW5nIHRoZSBmbGFnLCByaWdodD8KClllcy4KCj4KPiA+
Cj4gPiA+Pj4gKyAgICB9IHdoaWxlICh2aG9zdF9zdnFfbW9yZV91c2VkKHN2cSkpOwo+ID4gPj4+
ICt9Cj4gPiA+Pj4gKwo+ID4gPj4+ICsvKioKPiA+ID4+PiArICogRm9yd2FyZCB1c2VkIGJ1ZmZl
cnMuCj4gPiA+Pj4gKyAqCj4gPiA+Pj4gKyAqIEBuIGhkZXYgY2FsbCBldmVudCBub3RpZmllciwg
dGhlIG9uZSB0aGF0IGRldmljZSBzZXQgdG8gbm90aWZ5IHN2cS4KPiA+ID4+PiArICoKPiA+ID4+
PiArICogTm90ZSB0aGF0IHdlIGFyZSBub3QgbWFraW5nIGFueSBidWZmZXJzIGF2YWlsYWJsZSBp
biB0aGUgbG9vcCwgdGhlcmUgaXMgbm8KPiA+ID4+PiArICogd2F5IHRoYXQgaXQgcnVucyBtb3Jl
IHRoYW4gdmlydHF1ZXVlIHNpemUgdGltZXMuCj4gPiA+Pj4gKyAqLwo+ID4gPj4+ICAgIHN0YXRp
YyB2b2lkIHZob3N0X3N2cV9oYW5kbGVfY2FsbChFdmVudE5vdGlmaWVyICpuKQo+ID4gPj4+ICAg
IHsKPiA+ID4+PiAgICAgICAgVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSA9IGNvbnRhaW5lcl9v
ZihuLCBWaG9zdFNoYWRvd1ZpcnRxdWV1ZSwKPiA+ID4+PiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBoZGV2X2NhbGwpOwo+ID4gPj4+Cj4gPiA+Pj4gLSAg
ICBpZiAodW5saWtlbHkoIWV2ZW50X25vdGlmaWVyX3Rlc3RfYW5kX2NsZWFyKG4pKSkgewo+ID4g
Pj4+IC0gICAgICAgIHJldHVybjsKPiA+ID4+PiAtICAgIH0KPiA+ID4+PiArICAgIC8qIENsZWFy
IGV2ZW50IG5vdGlmaWVyICovCj4gPiA+Pj4gKyAgICBldmVudF9ub3RpZmllcl90ZXN0X2FuZF9j
bGVhcihuKTsKPiA+ID4+Cj4gPiA+PiBBbnkgcmVhc29uIHRoYXQgd2UgcmVtb3ZlIHRoZSBhYm92
ZSBjaGVjaz8KPiA+ID4+Cj4gPiA+IFRoaXMgY29tZXMgZnJvbSB0aGUgcHJldmlvdXMgdmVyc2lv
bnMsIHdoZXJlIHRoaXMgbWFkZSBzdXJlIHdlIG1pc3NlZAo+ID4gPiBubyB1c2VkIGJ1ZmZlcnMg
aW4gdGhlIHByb2Nlc3Mgb2Ygc3dpdGNoaW5nIHRvIFNWUSBtb2RlLgo+ID4KPiA+Cj4gPiBJJ20g
bm90IHN1cmUgSSBnZXQgaGVyZS4gRXZlbiBpZiBmb3IgdGhlIHN3aXRjaGluZywgaXQgc2hvdWxk
IGJlIG1vcmUKPiA+IHNhZmUgdGhlIGhhbmRsZSB0aGUgZmx1c2ggdW5jb25kaXRpb25hbGx5Pwo+
ID4KPgo+IFllcywgSSBhbHNvIHRoaW5rIGl0J3MgYmV0dGVyIHRvIGZvcndhcmQgYW5kIGtpY2sv
Y2FsbCB1bmNvbmRpdGlvbmFsbHkuCj4KPiBUaGFua3MhCgpPay4KClRoYW5rcwoKPgo+ID4gVGhh
bmtzCj4gPgo+ID4KPiA+ID4KPiA+ID4gSWYgd2UgZW5hYmxlIFNWUSBmcm9tIHRoZSBiZWdpbm5p
bmcgSSB0aGluayB3ZSBjYW4gcmVseSBvbiBnZXR0aW5nIGFsbAo+ID4gPiB0aGUgZGV2aWNlJ3Mg
dXNlZCBidWZmZXIgbm90aWZpY2F0aW9ucywgc28gbGV0IG1lIHRoaW5rIGEgbGl0dGxlIGJpdAo+
ID4gPiBhbmQgSSBjYW4gbW92ZSB0byBjaGVjayB0aGUgZXZlbnRmZC4KPiA+ID4KPiA+ID4+PiAt
ICAgIGV2ZW50X25vdGlmaWVyX3NldCgmc3ZxLT5zdnFfY2FsbCk7Cj4gPiA+Pj4gKyAgICB2aG9z
dF9zdnFfZmx1c2goc3ZxLCB0cnVlKTsKPiA+ID4+PiAgICB9Cj4gPiA+Pj4KPiA+ID4+PiAgICAv
KioKPiA+ID4+PiBAQCAtMjU4LDEzICs1NTEsMzggQEAgdm9pZCB2aG9zdF9zdnFfc2V0X3N2cV9r
aWNrX2ZkKFZob3N0U2hhZG93VmlydHF1ZXVlICpzdnEsIGludCBzdnFfa2lja19mZCkKPiA+ID4+
PiAgICAgICAgICogbmVlZCB0byBleHBsaWNpdGVseSBjaGVjayBmb3IgdGhlbS4KPiA+ID4+PiAg
ICAgICAgICovCj4gPiA+Pj4gICAgICAgIGV2ZW50X25vdGlmaWVyX2luaXRfZmQoJnN2cS0+c3Zx
X2tpY2ssIHN2cV9raWNrX2ZkKTsKPiA+ID4+PiAtICAgIGV2ZW50X25vdGlmaWVyX3NldF9oYW5k
bGVyKCZzdnEtPnN2cV9raWNrLCB2aG9zdF9oYW5kbGVfZ3Vlc3Rfa2ljayk7Cj4gPiA+Pj4gKyAg
ICBldmVudF9ub3RpZmllcl9zZXRfaGFuZGxlcigmc3ZxLT5zdnFfa2ljaywKPiA+ID4+PiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZob3N0X2hhbmRsZV9ndWVzdF9raWNrX25vdGlm
aWVyKTsKPiA+ID4+Pgo+ID4gPj4+ICAgICAgICBpZiAoIWNoZWNrX29sZCB8fCBldmVudF9ub3Rp
Zmllcl90ZXN0X2FuZF9jbGVhcigmdG1wKSkgewo+ID4gPj4+ICAgICAgICAgICAgZXZlbnRfbm90
aWZpZXJfc2V0KCZzdnEtPmhkZXZfa2ljayk7Cj4gPiA+Pj4gICAgICAgIH0KPiA+ID4+PiAgICB9
Cj4gPiA+Pj4KPiA+ID4+PiArLyoqCj4gPiA+Pj4gKyAqIFN0YXJ0IHNoYWRvdyB2aXJ0cXVldWUg
b3BlcmF0aW9uLgo+ID4gPj4+ICsgKgo+ID4gPj4+ICsgKiBAc3ZxIFNoYWRvdyBWaXJ0cXVldWUK
PiA+ID4+PiArICogQHZkZXYgICAgICAgIFZpcnRJTyBkZXZpY2UKPiA+ID4+PiArICogQHZxICAg
ICAgICAgIFZpcnRxdWV1ZSB0byBzaGFkb3cKPiA+ID4+PiArICovCj4gPiA+Pj4gK3ZvaWQgdmhv
c3Rfc3ZxX3N0YXJ0KFZob3N0U2hhZG93VmlydHF1ZXVlICpzdnEsIFZpcnRJT0RldmljZSAqdmRl
diwKPiA+ID4+PiArICAgICAgICAgICAgICAgICAgICAgVmlydFF1ZXVlICp2cSkKPiA+ID4+PiAr
ewo+ID4gPj4+ICsgICAgc3ZxLT5uZXh0X2d1ZXN0X2F2YWlsX2VsZW0gPSBOVUxMOwo+ID4gPj4+
ICsgICAgc3ZxLT5hdmFpbF9pZHhfc2hhZG93ID0gMDsKPiA+ID4+PiArICAgIHN2cS0+c2hhZG93
X3VzZWRfaWR4ID0gMDsKPiA+ID4+PiArICAgIHN2cS0+bGFzdF91c2VkX2lkeCA9IDA7Cj4gPiA+
Pj4gKyAgICBzdnEtPnZkZXYgPSB2ZGV2Owo+ID4gPj4+ICsgICAgc3ZxLT52cSA9IHZxOwo+ID4g
Pj4+ICsKPiA+ID4+PiArICAgIG1lbXNldChzdnEtPnZyaW5nLmF2YWlsLCAwLCBzaXplb2YoKnN2
cS0+dnJpbmcuYXZhaWwpKTsKPiA+ID4+PiArICAgIG1lbXNldChzdnEtPnZyaW5nLnVzZWQsIDAs
IHNpemVvZigqc3ZxLT52cmluZy5hdmFpbCkpOwo+ID4gPj4+ICsgICAgZm9yICh1bnNpZ25lZCBp
ID0gMDsgaSA8IHN2cS0+dnJpbmcubnVtIC0gMTsgaSsrKSB7Cj4gPiA+Pj4gKyAgICAgICAgc3Zx
LT52cmluZy5kZXNjW2ldLm5leHQgPSBjcHVfdG9fbGUxNihpICsgMSk7Cj4gPiA+Pj4gKyAgICB9
Cj4gPiA+Pj4gK30KPiA+ID4+PiArCj4gPiA+Pj4gICAgLyoqCj4gPiA+Pj4gICAgICogU3RvcCBz
aGFkb3cgdmlydHF1ZXVlIG9wZXJhdGlvbi4KPiA+ID4+PiAgICAgKiBAc3ZxIFNoYWRvdyBWaXJ0
cXVldWUKPiA+ID4+PiBAQCAtMjcyLDYgKzU5MCwyOCBAQCB2b2lkIHZob3N0X3N2cV9zZXRfc3Zx
X2tpY2tfZmQoVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSwgaW50IHN2cV9raWNrX2ZkKQo+ID4g
Pj4+ICAgIHZvaWQgdmhvc3Rfc3ZxX3N0b3AoVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSkKPiA+
ID4+PiAgICB7Cj4gPiA+Pj4gICAgICAgIGV2ZW50X25vdGlmaWVyX3NldF9oYW5kbGVyKCZzdnEt
PnN2cV9raWNrLCBOVUxMKTsKPiA+ID4+PiArICAgIGdfYXV0b2ZyZWUgVmlydFF1ZXVlRWxlbWVu
dCAqbmV4dF9hdmFpbF9lbGVtID0gTlVMTDsKPiA+ID4+PiArCj4gPiA+Pj4gKyAgICBpZiAoIXN2
cS0+dnEpIHsKPiA+ID4+PiArICAgICAgICByZXR1cm47Cj4gPiA+Pj4gKyAgICB9Cj4gPiA+Pj4g
Kwo+ID4gPj4+ICsgICAgLyogU2VuZCBhbGwgcGVuZGluZyB1c2VkIGRlc2NyaXB0b3JzIHRvIGd1
ZXN0ICovCj4gPiA+Pj4gKyAgICB2aG9zdF9zdnFfZmx1c2goc3ZxLCBmYWxzZSk7Cj4gPiA+Pj4g
Kwo+ID4gPj4+ICsgICAgZm9yICh1bnNpZ25lZCBpID0gMDsgaSA8IHN2cS0+dnJpbmcubnVtOyAr
K2kpIHsKPiA+ID4+PiArICAgICAgICBnX2F1dG9mcmVlIFZpcnRRdWV1ZUVsZW1lbnQgKmVsZW0g
PSBOVUxMOwo+ID4gPj4+ICsgICAgICAgIGVsZW0gPSBnX3N0ZWFsX3BvaW50ZXIoJnN2cS0+cmlu
Z19pZF9tYXBzW2ldKTsKPiA+ID4+PiArICAgICAgICBpZiAoZWxlbSkgewo+ID4gPj4+ICsgICAg
ICAgICAgICB2aXJ0cXVldWVfZGV0YWNoX2VsZW1lbnQoc3ZxLT52cSwgZWxlbSwgZWxlbS0+bGVu
KTsKPiA+ID4+PiArICAgICAgICB9Cj4gPiA+Pj4gKyAgICB9Cj4gPiA+Pj4gKwo+ID4gPj4+ICsg
ICAgbmV4dF9hdmFpbF9lbGVtID0gZ19zdGVhbF9wb2ludGVyKCZzdnEtPm5leHRfZ3Vlc3RfYXZh
aWxfZWxlbSk7Cj4gPiA+Pj4gKyAgICBpZiAobmV4dF9hdmFpbF9lbGVtKSB7Cj4gPiA+Pj4gKyAg
ICAgICAgdmlydHF1ZXVlX2RldGFjaF9lbGVtZW50KHN2cS0+dnEsIG5leHRfYXZhaWxfZWxlbSwK
PiA+ID4+PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dF9hdmFpbF9lbGVt
LT5sZW4pOwo+ID4gPj4+ICsgICAgfQo+ID4gPj4+ICAgIH0KPiA+ID4+Pgo+ID4gPj4+ICAgIC8q
Kgo+ID4gPj4+IEBAIC0zMTYsNyArNjU2LDcgQEAgVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnZob3N0
X3N2cV9uZXcodWludDE2X3QgcXNpemUpCj4gPiA+Pj4gICAgICAgIG1lbXNldChzdnEtPnZyaW5n
LmRlc2MsIDAsIGRyaXZlcl9zaXplKTsKPiA+ID4+PiAgICAgICAgc3ZxLT52cmluZy51c2VkID0g
cWVtdV9tZW1hbGlnbihxZW11X3JlYWxfaG9zdF9wYWdlX3NpemUsIGRldmljZV9zaXplKTsKPiA+
ID4+PiAgICAgICAgbWVtc2V0KHN2cS0+dnJpbmcudXNlZCwgMCwgZGV2aWNlX3NpemUpOwo+ID4g
Pj4+IC0KPiA+ID4+PiArICAgIHN2cS0+cmluZ19pZF9tYXBzID0gZ19uZXcwKFZpcnRRdWV1ZUVs
ZW1lbnQgKiwgcXNpemUpOwo+ID4gPj4+ICAgICAgICBldmVudF9ub3RpZmllcl9zZXRfaGFuZGxl
cigmc3ZxLT5oZGV2X2NhbGwsIHZob3N0X3N2cV9oYW5kbGVfY2FsbCk7Cj4gPiA+Pj4gICAgICAg
IHJldHVybiBnX3N0ZWFsX3BvaW50ZXIoJnN2cSk7Cj4gPiA+Pj4KPiA+ID4+PiBAQCAtMzM1LDYg
KzY3NSw3IEBAIHZvaWQgdmhvc3Rfc3ZxX2ZyZWUoVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnZxKQo+
ID4gPj4+ICAgICAgICBldmVudF9ub3RpZmllcl9jbGVhbnVwKCZ2cS0+aGRldl9raWNrKTsKPiA+
ID4+PiAgICAgICAgZXZlbnRfbm90aWZpZXJfc2V0X2hhbmRsZXIoJnZxLT5oZGV2X2NhbGwsIE5V
TEwpOwo+ID4gPj4+ICAgICAgICBldmVudF9ub3RpZmllcl9jbGVhbnVwKCZ2cS0+aGRldl9jYWxs
KTsKPiA+ID4+PiArICAgIGdfZnJlZSh2cS0+cmluZ19pZF9tYXBzKTsKPiA+ID4+PiAgICAgICAg
cWVtdV92ZnJlZSh2cS0+dnJpbmcuZGVzYyk7Cj4gPiA+Pj4gICAgICAgIHFlbXVfdmZyZWUodnEt
PnZyaW5nLnVzZWQpOwo+ID4gPj4+ICAgICAgICBnX2ZyZWUodnEpOwo+ID4gPj4+IGRpZmYgLS1n
aXQgYS9ody92aXJ0aW8vdmhvc3QtdmRwYS5jIGIvaHcvdmlydGlvL3Zob3N0LXZkcGEuYwo+ID4g
Pj4+IGluZGV4IDUzZTE0YmFmYTAuLjBlNWMwMGVkN2UgMTAwNjQ0Cj4gPiA+Pj4gLS0tIGEvaHcv
dmlydGlvL3Zob3N0LXZkcGEuYwo+ID4gPj4+ICsrKyBiL2h3L3ZpcnRpby92aG9zdC12ZHBhLmMK
PiA+ID4+PiBAQCAtNzUyLDkgKzc1Miw5IEBAIHN0YXRpYyBpbnQgdmhvc3RfdmRwYV9zZXRfdnJp
bmdfY2FsbChzdHJ1Y3Qgdmhvc3RfZGV2ICpkZXYsCj4gPiA+Pj4gICAgICogTm90ZSB0aGF0IHRo
aXMgZnVuY3Rpb24gZG9lcyBub3QgcmV3aW5kIGtpY2sgZmlsZSBkZXNjcmlwdG9yIGlmIGNhbm5v
dCBzZXQKPiA+ID4+PiAgICAgKiBjYWxsIG9uZS4KPiA+ID4+PiAgICAgKi8KPiA+ID4+PiAtc3Rh
dGljIGJvb2wgdmhvc3RfdmRwYV9zdnFfc2V0dXAoc3RydWN0IHZob3N0X2RldiAqZGV2LAo+ID4g
Pj4+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZob3N0U2hhZG93VmlydHF1ZXVl
ICpzdnEsCj4gPiA+Pj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQg
aWR4KQo+ID4gPj4+ICtzdGF0aWMgaW50IHZob3N0X3ZkcGFfc3ZxX3NldF9mZHMoc3RydWN0IHZo
b3N0X2RldiAqZGV2LAo+ID4gPj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Vmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSwKPiA+ID4+PiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVuc2lnbmVkIGlkeCkKPiA+ID4+PiAgICB7Cj4gPiA+Pj4gICAgICAgIHN0
cnVjdCB2aG9zdF92cmluZ19maWxlIGZpbGUgPSB7Cj4gPiA+Pj4gICAgICAgICAgICAuaW5kZXgg
PSBkZXYtPnZxX2luZGV4ICsgaWR4LAo+ID4gPj4+IEBAIC03NjcsNyArNzY3LDcgQEAgc3RhdGlj
IGJvb2wgdmhvc3RfdmRwYV9zdnFfc2V0dXAoc3RydWN0IHZob3N0X2RldiAqZGV2LAo+ID4gPj4+
ICAgICAgICByID0gdmhvc3RfdmRwYV9zZXRfdnJpbmdfZGV2X2tpY2soZGV2LCAmZmlsZSk7Cj4g
PiA+Pj4gICAgICAgIGlmICh1bmxpa2VseShyICE9IDApKSB7Cj4gPiA+Pj4gICAgICAgICAgICBl
cnJvcl9yZXBvcnQoIkNhbid0IHNldCBkZXZpY2Uga2ljayBmZCAoJWQpIiwgLXIpOwo+ID4gPj4+
IC0gICAgICAgIHJldHVybiBmYWxzZTsKPiA+ID4+PiArICAgICAgICByZXR1cm4gcjsKPiA+ID4+
PiAgICAgICAgfQo+ID4gPj4+Cj4gPiA+Pj4gICAgICAgIGV2ZW50X25vdGlmaWVyID0gdmhvc3Rf
c3ZxX2dldF9zdnFfY2FsbF9ub3RpZmllcihzdnEpOwo+ID4gPj4+IEBAIC03NzcsNiArNzc3LDk5
IEBAIHN0YXRpYyBib29sIHZob3N0X3ZkcGFfc3ZxX3NldHVwKHN0cnVjdCB2aG9zdF9kZXYgKmRl
diwKPiA+ID4+PiAgICAgICAgICAgIGVycm9yX3JlcG9ydCgiQ2FuJ3Qgc2V0IGRldmljZSBjYWxs
IGZkICglZCkiLCAtcik7Cj4gPiA+Pj4gICAgICAgIH0KPiA+ID4+Pgo+ID4gPj4+ICsgICAgcmV0
dXJuIHI7Cj4gPiA+Pj4gK30KPiA+ID4+PiArCj4gPiA+Pj4gKy8qKgo+ID4gPj4+ICsgKiBVbm1h
cCBTVlEgYXJlYSBpbiB0aGUgZGV2aWNlCj4gPiA+Pj4gKyAqLwo+ID4gPj4+ICtzdGF0aWMgYm9v
bCB2aG9zdF92ZHBhX3N2cV91bm1hcF9yaW5nKHN0cnVjdCB2aG9zdF92ZHBhICp2LCBod2FkZHIg
aW92YSwKPiA+ID4+PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBod2Fk
ZHIgc2l6ZSkKPiA+ID4+PiArewo+ID4gPj4+ICsgICAgaW50IHI7Cj4gPiA+Pj4gKwo+ID4gPj4+
ICsgICAgc2l6ZSA9IFJPVU5EX1VQKHNpemUsIHFlbXVfcmVhbF9ob3N0X3BhZ2Vfc2l6ZSk7Cj4g
PiA+Pj4gKyAgICByID0gdmhvc3RfdmRwYV9kbWFfdW5tYXAodiwgaW92YSwgc2l6ZSk7Cj4gPiA+
Pj4gKyAgICByZXR1cm4gciA9PSAwOwo+ID4gPj4+ICt9Cj4gPiA+Pj4gKwo+ID4gPj4+ICtzdGF0
aWMgYm9vbCB2aG9zdF92ZHBhX3N2cV91bm1hcF9yaW5ncyhzdHJ1Y3Qgdmhvc3RfZGV2ICpkZXYs
Cj4gPiA+Pj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFZo
b3N0U2hhZG93VmlydHF1ZXVlICpzdnEpCj4gPiA+Pj4gK3sKPiA+ID4+PiArICAgIHN0cnVjdCB2
aG9zdF92ZHBhICp2ID0gZGV2LT5vcGFxdWU7Cj4gPiA+Pj4gKyAgICBzdHJ1Y3Qgdmhvc3RfdnJp
bmdfYWRkciBzdnFfYWRkcjsKPiA+ID4+PiArICAgIHNpemVfdCBkZXZpY2Vfc2l6ZSA9IHZob3N0
X3N2cV9kZXZpY2VfYXJlYV9zaXplKHN2cSk7Cj4gPiA+Pj4gKyAgICBzaXplX3QgZHJpdmVyX3Np
emUgPSB2aG9zdF9zdnFfZHJpdmVyX2FyZWFfc2l6ZShzdnEpOwo+ID4gPj4+ICsgICAgYm9vbCBv
azsKPiA+ID4+PiArCj4gPiA+Pj4gKyAgICB2aG9zdF9zdnFfZ2V0X3ZyaW5nX2FkZHIoc3ZxLCAm
c3ZxX2FkZHIpOwo+ID4gPj4+ICsKPiA+ID4+PiArICAgIG9rID0gdmhvc3RfdmRwYV9zdnFfdW5t
YXBfcmluZyh2LCBzdnFfYWRkci5kZXNjX3VzZXJfYWRkciwgZHJpdmVyX3NpemUpOwo+ID4gPj4+
ICsgICAgaWYgKHVubGlrZWx5KCFvaykpIHsKPiA+ID4+PiArICAgICAgICByZXR1cm4gZmFsc2U7
Cj4gPiA+Pj4gKyAgICB9Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgcmV0dXJuIHZob3N0X3ZkcGFf
c3ZxX3VubWFwX3Jpbmcodiwgc3ZxX2FkZHIudXNlZF91c2VyX2FkZHIsIGRldmljZV9zaXplKTsK
PiA+ID4+PiArfQo+ID4gPj4+ICsKPiA+ID4+PiArLyoqCj4gPiA+Pj4gKyAqIE1hcCBzaGFkb3cg
dmlydHF1ZXVlIHJpbmdzIGluIGRldmljZQo+ID4gPj4+ICsgKgo+ID4gPj4+ICsgKiBAZGV2ICAg
VGhlIHZob3N0IGRldmljZQo+ID4gPj4+ICsgKiBAc3ZxICAgVGhlIHNoYWRvdyB2aXJ0cXVldWUK
PiA+ID4+PiArICovCj4gPiA+Pj4gK3N0YXRpYyBib29sIHZob3N0X3ZkcGFfc3ZxX21hcF9yaW5n
cyhzdHJ1Y3Qgdmhvc3RfZGV2ICpkZXYsCj4gPiA+Pj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjb25zdCBWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxKQo+ID4gPj4+ICt7
Cj4gPiA+Pj4gKyAgICBzdHJ1Y3Qgdmhvc3RfdmRwYSAqdiA9IGRldi0+b3BhcXVlOwo+ID4gPj4+
ICsgICAgc3RydWN0IHZob3N0X3ZyaW5nX2FkZHIgc3ZxX2FkZHI7Cj4gPiA+Pj4gKyAgICBzaXpl
X3QgZGV2aWNlX3NpemUgPSB2aG9zdF9zdnFfZGV2aWNlX2FyZWFfc2l6ZShzdnEpOwo+ID4gPj4+
ICsgICAgc2l6ZV90IGRyaXZlcl9zaXplID0gdmhvc3Rfc3ZxX2RyaXZlcl9hcmVhX3NpemUoc3Zx
KTsKPiA+ID4+PiArICAgIGludCByOwo+ID4gPj4+ICsKPiA+ID4+PiArICAgIHZob3N0X3N2cV9n
ZXRfdnJpbmdfYWRkcihzdnEsICZzdnFfYWRkcik7Cj4gPiA+Pj4gKwo+ID4gPj4+ICsgICAgciA9
IHZob3N0X3ZkcGFfZG1hX21hcCh2LCBzdnFfYWRkci5kZXNjX3VzZXJfYWRkciwgZHJpdmVyX3Np
emUsCj4gPiA+Pj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICh2b2lkICopc3ZxX2FkZHIu
ZGVzY191c2VyX2FkZHIsIHRydWUpOwo+ID4gPj4+ICsgICAgaWYgKHVubGlrZWx5KHIgIT0gMCkp
IHsKPiA+ID4+PiArICAgICAgICByZXR1cm4gZmFsc2U7Cj4gPiA+Pj4gKyAgICB9Cj4gPiA+Pj4g
Kwo+ID4gPj4+ICsgICAgciA9IHZob3N0X3ZkcGFfZG1hX21hcCh2LCBzdnFfYWRkci51c2VkX3Vz
ZXJfYWRkciwgZGV2aWNlX3NpemUsCj4gPiA+Pj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICh2b2lkICopc3ZxX2FkZHIudXNlZF91c2VyX2FkZHIsIGZhbHNlKTsKPiA+ID4+Cj4gPiA+PiBE
byB3ZSBuZWVkIHVubWFwIHRoZSBkcml2ZXIgYXJlYSBpZiB3ZSBmYWlsIGhlcmU/Cj4gPiA+Pgo+
ID4gPiBZZXMsIHRoaXMgdXNlZCB0byB0cnVzdCBpbiB1bm1hcCB0aGVtIGF0IHRoZSBkaXNhYmxp
bmcgb2YgU1ZRLiBOb3cgSQo+ID4gPiB0aGluayB3ZSBuZWVkIHRvIHVubWFwIGFzIHlvdSBzYXku
Cj4gPiA+Cj4gPiA+IFRoYW5rcyEKPiA+ID4KPiA+ID4gWzFdIGh0dHBzOi8vbGlzdHMubGludXhm
b3VuZGF0aW9uLm9yZy9waXBlcm1haWwvdmlydHVhbGl6YXRpb24vMjAyMS1NYXJjaC8wNTMzMjIu
aHRtbAo+ID4gPgo+ID4gPj4gVGhhbmtzCj4gPiA+Pgo+ID4gPj4KPiA+ID4+PiArICAgIHJldHVy
biByID09IDA7Cj4gPiA+Pj4gK30KPiA+ID4+PiArCj4gPiA+Pj4gK3N0YXRpYyBib29sIHZob3N0
X3ZkcGFfc3ZxX3NldHVwKHN0cnVjdCB2aG9zdF9kZXYgKmRldiwKPiA+ID4+PiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxLAo+ID4gPj4+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGlkeCkKPiA+ID4+PiAr
ewo+ID4gPj4+ICsgICAgdWludDE2X3QgdnFfaW5kZXggPSBkZXYtPnZxX2luZGV4ICsgaWR4Owo+
ID4gPj4+ICsgICAgc3RydWN0IHZob3N0X3ZyaW5nX3N0YXRlIHMgPSB7Cj4gPiA+Pj4gKyAgICAg
ICAgLmluZGV4ID0gdnFfaW5kZXgsCj4gPiA+Pj4gKyAgICB9Owo+ID4gPj4+ICsgICAgaW50IHI7
Cj4gPiA+Pj4gKyAgICBib29sIG9rOwo+ID4gPj4+ICsKPiA+ID4+PiArICAgIHIgPSB2aG9zdF92
ZHBhX3NldF9kZXZfdnJpbmdfYmFzZShkZXYsICZzKTsKPiA+ID4+PiArICAgIGlmICh1bmxpa2Vs
eShyKSkgewo+ID4gPj4+ICsgICAgICAgIGVycm9yX3JlcG9ydCgiQ2FuJ3Qgc2V0IHZyaW5nIGJh
c2UgKCVkKSIsIHIpOwo+ID4gPj4+ICsgICAgICAgIHJldHVybiBmYWxzZTsKPiA+ID4+PiArICAg
IH0KPiA+ID4+PiArCj4gPiA+Pj4gKyAgICBzLm51bSA9IHZob3N0X3N2cV9nZXRfbnVtKHN2cSk7
Cj4gPiA+Pj4gKyAgICByID0gdmhvc3RfdmRwYV9zZXRfZGV2X3ZyaW5nX251bShkZXYsICZzKTsK
PiA+ID4+PiArICAgIGlmICh1bmxpa2VseShyKSkgewo+ID4gPj4+ICsgICAgICAgIGVycm9yX3Jl
cG9ydCgiQ2FuJ3Qgc2V0IHZyaW5nIG51bSAoJWQpIiwgcik7Cj4gPiA+Pj4gKyAgICAgICAgcmV0
dXJuIGZhbHNlOwo+ID4gPj4+ICsgICAgfQo+ID4gPj4+ICsKPiA+ID4+PiArICAgIG9rID0gdmhv
c3RfdmRwYV9zdnFfbWFwX3JpbmdzKGRldiwgc3ZxKTsKPiA+ID4+PiArICAgIGlmICh1bmxpa2Vs
eSghb2spKSB7Cj4gPiA+Pj4gKyAgICAgICAgcmV0dXJuIGZhbHNlOwo+ID4gPj4+ICsgICAgfQo+
ID4gPj4+ICsKPiA+ID4+PiArICAgIHIgPSB2aG9zdF92ZHBhX3N2cV9zZXRfZmRzKGRldiwgc3Zx
LCBpZHgpOwo+ID4gPj4+ICAgICAgICByZXR1cm4gciA9PSAwOwo+ID4gPj4+ICAgIH0KPiA+ID4+
Pgo+ID4gPj4+IEBAIC03ODgsMTQgKzg4MSwyNCBAQCBzdGF0aWMgaW50IHZob3N0X3ZkcGFfZGV2
X3N0YXJ0KHN0cnVjdCB2aG9zdF9kZXYgKmRldiwgYm9vbCBzdGFydGVkKQo+ID4gPj4+ICAgICAg
ICBpZiAoc3RhcnRlZCkgewo+ID4gPj4+ICAgICAgICAgICAgdmhvc3RfdmRwYV9ob3N0X25vdGlm
aWVyc19pbml0KGRldik7Cj4gPiA+Pj4gICAgICAgICAgICBmb3IgKHVuc2lnbmVkIGkgPSAwOyBp
IDwgdi0+c2hhZG93X3Zxcy0+bGVuOyArK2kpIHsKPiA+ID4+PiArICAgICAgICAgICAgVmlydFF1
ZXVlICp2cSA9IHZpcnRpb19nZXRfcXVldWUoZGV2LT52ZGV2LCBkZXYtPnZxX2luZGV4ICsgaSk7
Cj4gPiA+Pj4gICAgICAgICAgICAgICAgVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSA9IGdfcHRy
X2FycmF5X2luZGV4KHYtPnNoYWRvd192cXMsIGkpOwo+ID4gPj4+ICAgICAgICAgICAgICAgIGJv
b2wgb2sgPSB2aG9zdF92ZHBhX3N2cV9zZXR1cChkZXYsIHN2cSwgaSk7Cj4gPiA+Pj4gICAgICAg
ICAgICAgICAgaWYgKHVubGlrZWx5KCFvaykpIHsKPiA+ID4+PiAgICAgICAgICAgICAgICAgICAg
cmV0dXJuIC0xOwo+ID4gPj4+ICAgICAgICAgICAgICAgIH0KPiA+ID4+PiArICAgICAgICAgICAg
dmhvc3Rfc3ZxX3N0YXJ0KHN2cSwgZGV2LT52ZGV2LCB2cSk7Cj4gPiA+Pj4gICAgICAgICAgICB9
Cj4gPiA+Pj4gICAgICAgICAgICB2aG9zdF92ZHBhX3NldF92cmluZ19yZWFkeShkZXYpOwo+ID4g
Pj4+ICAgICAgICB9IGVsc2Ugewo+ID4gPj4+ICsgICAgICAgIGZvciAodW5zaWduZWQgaSA9IDA7
IGkgPCB2LT5zaGFkb3dfdnFzLT5sZW47ICsraSkgewo+ID4gPj4+ICsgICAgICAgICAgICBWaG9z
dFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxID0gZ19wdHJfYXJyYXlfaW5kZXgodi0+c2hhZG93X3ZxcywK
PiA+ID4+PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGkpOwo+ID4gPj4+ICsgICAgICAgICAgICBib29sIG9rID0gdmhvc3RfdmRwYV9z
dnFfdW5tYXBfcmluZ3MoZGV2LCBzdnEpOwo+ID4gPj4+ICsgICAgICAgICAgICBpZiAodW5saWtl
bHkoIW9rKSkgewo+ID4gPj4+ICsgICAgICAgICAgICAgICAgcmV0dXJuIC0xOwo+ID4gPj4+ICsg
ICAgICAgICAgICB9Cj4gPiA+Pj4gKyAgICAgICAgfQo+ID4gPj4+ICAgICAgICAgICAgdmhvc3Rf
dmRwYV9ob3N0X25vdGlmaWVyc191bmluaXQoZGV2LCBkZXYtPm52cXMpOwo+ID4gPj4+ICAgICAg
ICB9Cj4gPiA+Pj4KPiA+Cj4KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0
cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcv
bWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==

