Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
	by mail.lfdr.de (Postfix) with ESMTPS id F22C1155E30
	for <lists.virtualization@lfdr.de>; Fri,  7 Feb 2020 19:36:07 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by silver.osuosl.org (Postfix) with ESMTP id 65B532274A;
	Fri,  7 Feb 2020 18:36:06 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id DdDP8sR6X47M; Fri,  7 Feb 2020 18:36:01 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by silver.osuosl.org (Postfix) with ESMTP id 467F820111;
	Fri,  7 Feb 2020 18:35:58 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 13EA1C1D85;
	Fri,  7 Feb 2020 18:35:58 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id B17ADC1D87
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:53 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by fraxinus.osuosl.org (Postfix) with ESMTP id A17B884483
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:53 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id o191R3uhsAu5
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:52 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by fraxinus.osuosl.org (Postfix) with ESMTPS id CD2A4858FC
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:51 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 9D0EC305D35F; Fri,  7 Feb 2020 20:16:41 +0200 (EET)
Received: from host.bbu.bitdefender.biz (unknown [195.210.4.22])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 91A553052066;
 Fri,  7 Feb 2020 20:16:41 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [RFC PATCH v7 65/78] KVM: introspection: add KVMI_VCPU_GET_XSAVE
Date: Fri,  7 Feb 2020 20:16:23 +0200
Message-Id: <20200207181636.1065-66-alazar@bitdefender.com>
In-Reply-To: <20200207181636.1065-1-alazar@bitdefender.com>
References: <20200207181636.1065-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 Sean Christopherson <sean.j.christopherson@intel.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyB2Q1BVIGNv
bW1hbmQgaXMgdXNlZCB0byBnZXQgdGhlIFhTQVZFIGFyZWEuCgpTaWduZWQtb2ZmLWJ5OiBNaWhh
aSBEb27Im3UgPG1kb250dUBiaXRkZWZlbmRlci5jb20+CkNvLWRldmVsb3BlZC1ieTogQWRhbGJl
cnQgTGF6xINyIDxhbGF6YXJAYml0ZGVmZW5kZXIuY29tPgpTaWduZWQtb2ZmLWJ5OiBBZGFsYmVy
dCBMYXrEg3IgPGFsYXphckBiaXRkZWZlbmRlci5jb20+Ci0tLQogRG9jdW1lbnRhdGlvbi92aXJ0
L2t2bS9rdm1pLnJzdCAgICAgICAgICAgICAgIHwgMzEgKysrKysrKysrKysrKysrKysrKwogYXJj
aC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmggICAgICAgICAgICAgIHwgIDQgKysrCiBhcmNo
L3g4Ni9rdm0va3ZtaS5jICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAyMSArKysrKysrKysr
KysrCiBpbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oICAgICAgICAgICAgICAgICAgICAgfCAgMiAr
KwogLi4uL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMgIHwgMjEgKysr
KysrKysrKysrKwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oICAgICAgICAgICAg
IHwgIDQgKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgICAgICAgICAgICAg
fCAxNyArKysrKysrKysrCiA3IGZpbGVzIGNoYW5nZWQsIDEwMCBpbnNlcnRpb25zKCspCgpkaWZm
IC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdCBiL0RvY3VtZW50YXRpb24v
dmlydC9rdm0va3ZtaS5yc3QKaW5kZXggOGI0M2UwZjgwZjc3Li41ZDJiODI4ZjIxNTkgMTAwNjQ0
Ci0tLSBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKKysrIGIvRG9jdW1lbnRhdGlv
bi92aXJ0L2t2bS9rdm1pLnJzdApAQCAtNzU2LDYgKzc1NiwzNyBAQCBtZW1vcnkgc2xvdHMgYWxs
b2NhdGVkIGJ5IEtWTSwgY29uc2lkZXJpbmcgYWxsIGFkZHJlc3Mgc3BhY2VzIGluZGljYXRlZAog
YnkgS1ZNX0FERFJFU1NfU1BBQ0VfTlVNLiBTdHJpY2x5IHNwZWFraW5nLCB0aGUgcmV0dXJuZWQg
dmFsdWUgcmVmZXJzCiB0byB0aGUgZmlyc3QgaW5hY2Nlc3NpYmxlIEdGTiwgbmV4dCB0byB0aGUg
bWF4aW11bSBhY2Nlc3NpYmxlIEdGTi4KIAorMTcuIEtWTUlfVkNQVV9HRVRfWFNBVkUKKy0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tCisKKzpBcmNoaXRlY3R1cmU6IHg4NgorOlZlcnNpb25zOiA+PSAx
Cis6UGFyYW1ldGVyczoKKworOjoKKworCXN0cnVjdCBrdm1pX3ZjcHVfaGRyOworCis6UmV0dXJu
czoKKworOjoKKworCXN0cnVjdCBrdm1pX2Vycm9yX2NvZGU7CisJc3RydWN0IGt2bWlfdmNwdV9n
ZXRfeHNhdmVfcmVwbHkgeworCQlfX3UzMiByZWdpb25bMF07CisJfTsKKworUmV0dXJucyBhIGJ1
ZmZlciBjb250YWluaW5nIHRoZSBYU0FWRSBhcmVhLiBDdXJyZW50bHksIHRoZSBzaXplIG9mCitg
YGt2bV94c2F2ZWBgIGlzIHVzZWQsIGJ1dCBpdCBjb3VsZCBjaGFuZ2UuIFRoZSB1c2Vyc3BhY2Ug
c2hvdWxkIGdldAordGhlIGJ1ZmZlciBzaXplIGZyb20gdGhlIG1lc3NhZ2Ugc2l6ZS4KKworOkVy
cm9yczoKKworKiAtS1ZNX0VJTlZBTCAtIHRoZSBzZWxlY3RlZCB2Q1BVIGlzIGludmFsaWQKKyog
LUtWTV9FSU5WQUwgLSBwYWRkaW5nIGlzIG5vdCB6ZXJvCisqIC1LVk1fRUFHQUlOIC0gdGhlIHNl
bGVjdGVkIHZDUFUgY2FuJ3QgYmUgaW50cm9zcGVjdGVkIHlldAorKiAtS1ZNX0VOT01FTSAtIG5v
dCBlbm91Z2ggbWVtb3J5IHRvIGFsbG9jYXRlIHRoZSByZXBseQorCiBFdmVudHMKID09PT09PQog
CmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaCBiL2FyY2gveDg2
L2luY2x1ZGUvdWFwaS9hc20va3ZtaS5oCmluZGV4IDA2ZjY5Y2ZhM2Q3OS4uNjhhZDNkNzM3ZDdl
IDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaAorKysgYi9hcmNo
L3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaApAQCAtOTcsNCArOTcsOCBAQCBzdHJ1Y3Qga3Zt
aV92Y3B1X2luamVjdF9leGNlcHRpb24gewogCV9fdTY0IGFkZHJlc3M7CiB9OwogCitzdHJ1Y3Qg
a3ZtaV92Y3B1X2dldF94c2F2ZV9yZXBseSB7CisJX191MzIgcmVnaW9uWzBdOworfTsKKwogI2Vu
ZGlmIC8qIF9VQVBJX0FTTV9YODZfS1ZNSV9IICovCmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9rdm0v
a3ZtaS5jIGIvYXJjaC94ODYva3ZtL2t2bWkuYwppbmRleCBhYzQ5M2ZjZWJiNWIuLmY4ZmQ4Y2Ux
NDBjNSAxMDA2NDQKLS0tIGEvYXJjaC94ODYva3ZtL2t2bWkuYworKysgYi9hcmNoL3g4Ni9rdm0v
a3ZtaS5jCkBAIC02MTYsMyArNjE2LDI0IEBAIHZvaWQga3ZtaV9hcmNoX2luamVjdF9wZW5kaW5n
X2V4Y2VwdGlvbihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCiAKIAlrdm1pX3NhdmVfaW5qZWN0ZWRf
ZXZlbnQodmNwdSk7CiB9CisKK2ludCBrdm1pX2FyY2hfY21kX3ZjcHVfZ2V0X3hzYXZlKHN0cnVj
dCBrdm1fdmNwdSAqdmNwdSwKKwkJCQkgc3RydWN0IGt2bWlfdmNwdV9nZXRfeHNhdmVfcmVwbHkg
KipkZXN0LAorCQkJCSBzaXplX3QgKmRlc3Rfc2l6ZSkKK3sKKwlzdHJ1Y3Qga3ZtaV92Y3B1X2dl
dF94c2F2ZV9yZXBseSAqcnBsID0gTlVMTDsKKwlzaXplX3QgcnBsX3NpemUgPSBzaXplb2YoKnJw
bCkgKyBzaXplb2Yoc3RydWN0IGt2bV94c2F2ZSk7CisJc3RydWN0IGt2bV94c2F2ZSAqYXJlYTsK
KworCXJwbCA9IGt2bWlfbXNnX2FsbG9jX2NoZWNrKHJwbF9zaXplKTsKKwlpZiAoIXJwbCkKKwkJ
cmV0dXJuIC1LVk1fRU5PTUVNOworCisJYXJlYSA9IChzdHJ1Y3Qga3ZtX3hzYXZlICopICZycGwt
PnJlZ2lvblswXTsKKwlrdm1fdmNwdV9pb2N0bF94ODZfZ2V0X3hzYXZlKHZjcHUsIGFyZWEpOwor
CisJKmRlc3QgPSBycGw7CisJKmRlc3Rfc2l6ZSA9IHJwbF9zaXplOworCisJcmV0dXJuIDA7Cit9
CmRpZmYgLS1naXQgYS9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oIGIvaW5jbHVkZS91YXBpL2xp
bnV4L2t2bWkuaAppbmRleCAzZWE0ODgyYWM0NjkuLmJjNjNjMDRhNTQzZCAxMDA2NDQKLS0tIGEv
aW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaAorKysgYi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5o
CkBAIC0zNyw2ICszNyw4IEBAIGVudW0gewogCiAJS1ZNSV9WTV9HRVRfTUFYX0dGTiA9IDE3LAog
CisJS1ZNSV9WQ1BVX0dFVF9YU0FWRSA9IDE4LAorCiAJS1ZNSV9OVU1fTUVTU0FHRVMKIH07CiAK
ZGlmZiAtLWdpdCBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0
LmMgYi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCmluZGV4
IDI5OWY0ZDI5ZDBkNi4uNjM4NDkxZjMzMTM4IDEwMDY0NAotLS0gYS90b29scy90ZXN0aW5nL3Nl
bGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCisrKyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRl
c3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKQEAgLTEzMjIsNiArMTMyMiwyNiBAQCBzdGF0aWMg
dm9pZCB0ZXN0X2V2ZW50X3hzZXRidihzdHJ1Y3Qga3ZtX3ZtICp2bSkKIAlkaXNhYmxlX3ZjcHVf
ZXZlbnQodm0sIGV2ZW50X2lkKTsKIH0KIAorc3RhdGljIHZvaWQgdGVzdF9jbWRfdmNwdV9nZXRf
eHNhdmUoc3RydWN0IGt2bV92bSAqdm0pCit7CisJc3RydWN0IGt2bV9jcHVpZF9lbnRyeTIgKmVu
dHJ5OworCXN0cnVjdCB7CisJCXN0cnVjdCBrdm1pX21zZ19oZHIgaGRyOworCQlzdHJ1Y3Qga3Zt
aV92Y3B1X2hkciB2Y3B1X2hkcjsKKwl9IHJlcSA9IHt9OworCXN0cnVjdCBrdm1feHNhdmUgcnBs
OworCisJZW50cnkgPSBrdm1fZ2V0X3N1cHBvcnRlZF9jcHVpZF9lbnRyeSgxKTsKKwlpZiAoIShl
bnRyeS0+ZWN4ICYgWDg2X0ZFQVRVUkVfWFNBVkUpKSB7CisJCURFQlVHKCJYU0FWRSBpcyBub3Qg
c3VwcG9ydGVkLCBlY3ggMHgleCwgc2tpcHBpbmcgeHNhdmUgdGVzdFxuIiwKKwkJCWVudHJ5LT5l
Y3gpOworCQlyZXR1cm47CisJfQorCisJdGVzdF92Y3B1MF9jb21tYW5kKHZtLCBLVk1JX1ZDUFVf
R0VUX1hTQVZFLCAmcmVxLmhkciwgc2l6ZW9mKHJlcSksCisJCQkgICAmcnBsLCBzaXplb2YocnBs
KSk7Cit9CisKIHN0YXRpYyB2b2lkIHRlc3RfaW50cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2
bSkKIHsKIAlzZXR1cF9zb2NrZXQoKTsKQEAgLTEzNDcsNiArMTM2Nyw3IEBAIHN0YXRpYyB2b2lk
IHRlc3RfaW50cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkKIAl0ZXN0X2NtZF92Y3B1X2lu
amVjdF9leGNlcHRpb24odm0pOwogCXRlc3RfY21kX3ZtX2dldF9tYXhfZ2ZuKCk7CiAJdGVzdF9l
dmVudF94c2V0YnYodm0pOworCXRlc3RfY21kX3ZjcHVfZ2V0X3hzYXZlKHZtKTsKIAogCXVuaG9v
a19pbnRyb3NwZWN0aW9uKHZtKTsKIH0KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rp
b24va3ZtaV9pbnQuaCBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaAppbmRleCA1
YTAwZTM4Yzg4Y2MuLjVlMTIzMWYwOTQ0MCAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVj
dGlvbi9rdm1pX2ludC5oCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaApA
QCAtNDcsNiArNDcsNyBAQAogCQkJfCBCSVQoS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTKSBcCiAJ
CQl8IEJJVChLVk1JX1ZDUFVfR0VUX0NQVUlEKSBcCiAJCQl8IEJJVChLVk1JX1ZDUFVfR0VUX1JF
R0lTVEVSUykgXAorCQkJfCBCSVQoS1ZNSV9WQ1BVX0dFVF9YU0FWRSkgXAogCQkJfCBCSVQoS1ZN
SV9WQ1BVX0lOSkVDVF9FWENFUFRJT04pIFwKIAkJCXwgQklUKEtWTUlfVkNQVV9TRVRfUkVHSVNU
RVJTKSBcCiAJCSkKQEAgLTEzNSw1ICsxMzYsOCBAQCBpbnQga3ZtaV9hcmNoX2NtZF92Y3B1X2lu
amVjdF9leGNlcHRpb24oc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1OCB2ZWN0b3IsCiAJCQkJCXUz
MiBlcnJvcl9jb2RlLCB1NjQgYWRkcmVzcyk7CiB2b2lkIGt2bWlfYXJjaF90cmFwX2V2ZW50KHN0
cnVjdCBrdm1fdmNwdSAqdmNwdSk7CiB2b2lkIGt2bWlfYXJjaF9pbmplY3RfcGVuZGluZ19leGNl
cHRpb24oc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKK2ludCBrdm1pX2FyY2hfY21kX3ZjcHVfZ2V0
X3hzYXZlKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKKwkJCQkgc3RydWN0IGt2bWlfdmNwdV9nZXRf
eHNhdmVfcmVwbHkgKipkZXN0LAorCQkJCSBzaXplX3QgKmRlc3Rfc2l6ZSk7CiAKICNlbmRpZgpk
aWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jIGIvdmlydC9rdm0v
aW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCmluZGV4IGJhMmQ3YzZhY2IyMi4uMTYzOWY1ZWFiNjhi
IDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKKysrIGIvdmly
dC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCkBAIC0zMSw2ICszMSw3IEBAIHN0YXRpYyBj
b25zdCBjaGFyICpjb25zdCBtc2dfSURzW10gPSB7CiAJW0tWTUlfVkNQVV9HRVRfQ1BVSURdICAg
ICAgICA9ICJLVk1JX1ZDUFVfR0VUX0NQVUlEIiwKIAlbS1ZNSV9WQ1BVX0dFVF9JTkZPXSAgICAg
ICAgID0gIktWTUlfVkNQVV9HRVRfSU5GTyIsCiAJW0tWTUlfVkNQVV9HRVRfUkVHSVNURVJTXSAg
ICA9ICJLVk1JX1ZDUFVfR0VUX1JFR0lTVEVSUyIsCisJW0tWTUlfVkNQVV9HRVRfWFNBVkVdICAg
ICAgICA9ICJLVk1JX1ZDUFVfR0VUX1hTQVZFIiwKIAlbS1ZNSV9WQ1BVX0lOSkVDVF9FWENFUFRJ
T05dID0gIktWTUlfVkNQVV9JTkpFQ1RfRVhDRVBUSU9OIiwKIAlbS1ZNSV9WQ1BVX1BBVVNFXSAg
ICAgICAgICAgID0gIktWTUlfVkNQVV9QQVVTRSIsCiAJW0tWTUlfVkNQVV9TRVRfUkVHSVNURVJT
XSAgICA9ICJLVk1JX1ZDUFVfU0VUX1JFR0lTVEVSUyIsCkBAIC01MjYsNiArNTI3LDIxIEBAIHN0
YXRpYyBpbnQgaGFuZGxlX3ZjcHVfaW5qZWN0X2V4Y2VwdGlvbihjb25zdCBzdHJ1Y3Qga3ZtaV92
Y3B1X2NtZF9qb2IgKmpvYiwKIAlyZXR1cm4ga3ZtaV9tc2dfdmNwdV9yZXBseShqb2IsIG1zZywg
ZWMsIE5VTEwsIDApOwogfQogCitzdGF0aWMgaW50IGhhbmRsZV92Y3B1X2dldF94c2F2ZShjb25z
dCBzdHJ1Y3Qga3ZtaV92Y3B1X2NtZF9qb2IgKmpvYiwKKwkJCQkgY29uc3Qgc3RydWN0IGt2bWlf
bXNnX2hkciAqbXNnLAorCQkJCSBjb25zdCB2b2lkICpyZXEpCit7CisJc3RydWN0IGt2bWlfdmNw
dV9nZXRfeHNhdmVfcmVwbHkgKnJwbCA9IE5VTEw7CisJc2l6ZV90IHJwbF9zaXplID0gMDsKKwlp
bnQgZXJyLCBlYzsKKworCWVjID0ga3ZtaV9hcmNoX2NtZF92Y3B1X2dldF94c2F2ZShqb2ItPnZj
cHUsICZycGwsICZycGxfc2l6ZSk7CisKKwllcnIgPSBrdm1pX21zZ192Y3B1X3JlcGx5KGpvYiwg
bXNnLCBlYywgcnBsLCBycGxfc2l6ZSk7CisJa3ZtaV9tc2dfZnJlZShycGwpOworCXJldHVybiBl
cnI7Cit9CisKIC8qCiAgKiBUaGVzZSBjb21tYW5kcyBhcmUgZXhlY3V0ZWQgb24gdGhlIHZDUFUg
dGhyZWFkLiBUaGUgcmVjZWl2aW5nIHRocmVhZAogICogcGFzc2VzIHRoZSBtZXNzYWdlcyB1c2lu
ZyBhIG5ld2x5IGFsbG9jYXRlZCAnc3RydWN0IGt2bWlfdmNwdV9jbWRfam9iJwpAQCAtNTQwLDYg
KzU1Niw3IEBAIHN0YXRpYyBpbnQoKmNvbnN0IG1zZ192Y3B1W10pKGNvbnN0IHN0cnVjdCBrdm1p
X3ZjcHVfY21kX2pvYiAqLAogCVtLVk1JX1ZDUFVfR0VUX0NQVUlEXSAgICAgICAgPSBoYW5kbGVf
Z2V0X2NwdWlkLAogCVtLVk1JX1ZDUFVfR0VUX0lORk9dICAgICAgICAgPSBoYW5kbGVfZ2V0X3Zj
cHVfaW5mbywKIAlbS1ZNSV9WQ1BVX0dFVF9SRUdJU1RFUlNdICAgID0gaGFuZGxlX2dldF9yZWdp
c3RlcnMsCisJW0tWTUlfVkNQVV9HRVRfWFNBVkVdICAgICAgICA9IGhhbmRsZV92Y3B1X2dldF94
c2F2ZSwKIAlbS1ZNSV9WQ1BVX0lOSkVDVF9FWENFUFRJT05dID0gaGFuZGxlX3ZjcHVfaW5qZWN0
X2V4Y2VwdGlvbiwKIAlbS1ZNSV9WQ1BVX1NFVF9SRUdJU1RFUlNdICAgID0gaGFuZGxlX3NldF9y
ZWdpc3RlcnMsCiB9OwpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmlydHVhbGl6YXRpb25AbGlzdHMubGlu
dXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51eGZvdW5kYXRpb24ub3JnL21haWxt
YW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
