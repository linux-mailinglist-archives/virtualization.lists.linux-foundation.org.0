Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id CE3B51978CC
	for <lists.virtualization@lfdr.de>; Mon, 30 Mar 2020 12:20:05 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 79F6986A84;
	Mon, 30 Mar 2020 10:20:04 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id Fs3wZUwcz0FW; Mon, 30 Mar 2020 10:19:59 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id D6DA186A8C;
	Mon, 30 Mar 2020 10:19:55 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id C5D27C1D87;
	Mon, 30 Mar 2020 10:19:55 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 124FDC07FF
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:52 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by whitealder.osuosl.org (Postfix) with ESMTP id 025258757F
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:52 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id YbQ-ZKfIAmAl
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:50 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by whitealder.osuosl.org (Postfix) with ESMTPS id 34CFC8793F
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:50 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 0E0F4304C0C4; Mon, 30 Mar 2020 13:13:00 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id D99EC305B7A1;
 Mon, 30 Mar 2020 13:12:59 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v8 67/81] KVM: introspection: add KVMI_EVENT_XSETBV
Date: Mon, 30 Mar 2020 13:12:54 +0300
Message-Id: <20200330101308.21702-68-alazar@bitdefender.com>
In-Reply-To: <20200330101308.21702-1-alazar@bitdefender.com>
References: <20200330101308.21702-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <ncitu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBldmVudCBp
cyBzZW50IHdoZW4gdGhlIGV4dGVuZGVkIGNvbnRyb2wgcmVnaXN0ZXIgWENSMCBpcyBnb2luZyB0
bwpiZSBjaGFuZ2VkLgoKU2lnbmVkLW9mZi1ieTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVm
ZW5kZXIuY29tPgpDby1kZXZlbG9wZWQtYnk6IE5pY3XImW9yIEPDrsibdSA8bmNpdHVAYml0ZGVm
ZW5kZXIuY29tPgpTaWduZWQtb2ZmLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5jaXR1QGJpdGRlZmVu
ZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogQWRhbGJlcnQgTGF6xINyIDxhbGF6YXJAYml0ZGVmZW5k
ZXIuY29tPgotLS0KIERvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QgICAgICAgICAgICAg
ICB8IDI1ICsrKysrKwogYXJjaC94ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmggICAgICAgICAg
ICAgIHwgIDIgKwogYXJjaC94ODYva3ZtL2t2bWkuYyAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwgMzkgKysrKysrKysrCiBhcmNoL3g4Ni9rdm0veDg2LmMgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfCAgNiArKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCAgICAgICAgICAgICAgICAg
ICAgIHwgIDEgKwogLi4uL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMg
IHwgODMgKysrKysrKysrKysrKysrKysrKwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMg
ICAgICAgICAgICAgICAgIHwgIDEgKwogNyBmaWxlcyBjaGFuZ2VkLCAxNTcgaW5zZXJ0aW9ucygr
KQoKZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QgYi9Eb2N1bWVu
dGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CmluZGV4IDFjNWUyNTY5NzVmZS4uMDZlZDA1ZjQ3OTFi
IDEwMDY0NAotLS0gYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CisrKyBiL0RvY3Vt
ZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKQEAgLTU0OSw2ICs1NDksNyBAQCB0aGUgZm9sbG93
aW5nIGV2ZW50czo6CiAJS1ZNSV9FVkVOVF9CUkVBS1BPSU5UCiAJS1ZNSV9FVkVOVF9DUgogCUtW
TUlfRVZFTlRfSFlQRVJDQUxMCisJS1ZNSV9FVkVOVF9YU0VUQlYKIAogV2hlbiBhbiBldmVudCBp
cyBlbmFibGVkLCB0aGUgaW50cm9zcGVjdGlvbiB0b29sIGlzIG5vdGlmaWVkIGFuZAogbXVzdCBy
ZXBseSB3aXRoOiBjb250aW51ZSwgcmV0cnksIGNyYXNoLCBldGMuIChzZWUgKipFdmVudHMqKiBi
ZWxvdykuCkBAIC0xMDE5LDMgKzEwMjAsMjcgQEAgb3RoZXIgdkNQVSBpbnRyb3NwZWN0aW9uIGV2
ZW50LgogKGBgZXJyb3JfY29kZWBgKSBhbmQgQ1IyIGFyZSBzZW50IHRvIHRoZSBpbnRyb3NwZWN0
aW9uIHRvb2wsCiB3aGljaCBzaG91bGQgY2hlY2sgaWYgaXRzIGV4Y2VwdGlvbiBoYXMgYmVlbiBp
bmplY3RlZCBvciBvdmVycmlkZGVuLgogCis3LiBLVk1JX0VWRU5UX1hTRVRCVgorLS0tLS0tLS0t
LS0tLS0tLS0tLS0KKworOkFyY2hpdGVjdHVyZXM6IHg4NgorOlZlcnNpb25zOiA+PSAxCis6QWN0
aW9uczogQ09OVElOVUUsIENSQVNICis6UGFyYW1ldGVyczoKKworOjoKKworCXN0cnVjdCBrdm1p
X2V2ZW50OworCis6UmV0dXJuczoKKworOjoKKworCXN0cnVjdCBrdm1pX3ZjcHVfaGRyOworCXN0
cnVjdCBrdm1pX2V2ZW50X3JlcGx5OworCitUaGlzIGV2ZW50IGlzIHNlbnQgd2hlbiB0aGUgZXh0
ZW5kZWQgY29udHJvbCByZWdpc3RlciBYQ1IwIGlzIGdvaW5nCit0byBiZSBjaGFuZ2VkIGFuZCB0
aGUgaW50cm9zcGVjdGlvbiBoYXMgYmVlbiBlbmFibGVkIGZvciB0aGlzIGV2ZW50Cisoc2VlICpL
Vk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMqKS4KKworYGBrdm1pX2V2ZW50YGAgaXMgc2VudCB0byB0
aGUgaW50cm9zcGVjdGlvbiB0b29sLgpkaWZmIC0tZ2l0IGEvYXJjaC94ODYvaW5jbHVkZS9hc20v
a3ZtaV9ob3N0LmggYi9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1pX2hvc3QuaAppbmRleCAyNGYz
ZjhmZGVlNjIuLmIzZmE5NTAzNjJkYiAxMDA2NDQKLS0tIGEvYXJjaC94ODYvaW5jbHVkZS9hc20v
a3ZtaV9ob3N0LmgKKysrIGIvYXJjaC94ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmgKQEAgLTMw
LDYgKzMwLDcgQEAgYm9vbCBrdm1pX2NyX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdW5z
aWduZWQgaW50IGNyLAogCQkgICB1bnNpZ25lZCBsb25nIG9sZF92YWx1ZSwgdW5zaWduZWQgbG9u
ZyAqbmV3X3ZhbHVlKTsKIGJvb2wga3ZtaV9jcjNfaW50ZXJjZXB0ZWQoc3RydWN0IGt2bV92Y3B1
ICp2Y3B1KTsKIGJvb2wga3ZtaV9tb25pdG9yX2NyM3dfaW50ZXJjZXB0KHN0cnVjdCBrdm1fdmNw
dSAqdmNwdSwgYm9vbCBlbmFibGUpOwordm9pZCBrdm1pX3hzZXRidl9ldmVudChzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUpOwogCiAjZWxzZSAvKiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04gKi8KIApA
QCAtNDEsNiArNDIsNyBAQCBzdGF0aWMgaW5saW5lIGJvb2wga3ZtaV9jcl9ldmVudChzdHJ1Y3Qg
a3ZtX3ZjcHUgKnZjcHUsIHVuc2lnbmVkIGludCBjciwKIHN0YXRpYyBpbmxpbmUgYm9vbCBrdm1p
X2NyM19pbnRlcmNlcHRlZChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpIHsgcmV0dXJuIGZhbHNlOyB9
CiBzdGF0aWMgaW5saW5lIGJvb2wga3ZtaV9tb25pdG9yX2NyM3dfaW50ZXJjZXB0KHN0cnVjdCBr
dm1fdmNwdSAqdmNwdSwKIAkJCQkJCWJvb2wgZW5hYmxlKSB7IHJldHVybiBmYWxzZTsgfQorc3Rh
dGljIGlubGluZSB2b2lkIGt2bWlfeHNldGJ2X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkg
eyB9CiAKICNlbmRpZiAvKiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04gKi8KIApkaWZmIC0tZ2l0
IGEvYXJjaC94ODYva3ZtL2t2bWkuYyBiL2FyY2gveDg2L2t2bS9rdm1pLmMKaW5kZXggOWY4ZWY4
YTFhMzA2Li5mOTQ3ZjE4ZTlkNzIgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS9rdm1pLmMKKysr
IGIvYXJjaC94ODYva3ZtL2t2bWkuYwpAQCAtNjYyLDMgKzY2Miw0MiBAQCB2b2lkIGt2bWlfYXJj
aF90cmFwX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKIAkJa3ZtaV9oYW5kbGVfY29tbW9u
X2V2ZW50X2FjdGlvbnModmNwdS0+a3ZtLCBhY3Rpb24sICJUUkFQIik7CiAJfQogfQorCitzdGF0
aWMgdTMyIGt2bWlfc2VuZF94c2V0YnYoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQoreworCWludCBl
cnIsIGFjdGlvbjsKKworCWVyciA9IGt2bWlfc2VuZF9ldmVudCh2Y3B1LCBLVk1JX0VWRU5UX1hT
RVRCViwgTlVMTCwgMCwKKwkJCSAgICAgIE5VTEwsIDAsICZhY3Rpb24pOworCWlmIChlcnIpCisJ
CXJldHVybiBLVk1JX0VWRU5UX0FDVElPTl9DT05USU5VRTsKKworCXJldHVybiBhY3Rpb247Cit9
CisKK3N0YXRpYyB2b2lkIF9fa3ZtaV94c2V0YnZfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
KQoreworCXUzMiBhY3Rpb247CisKKwlhY3Rpb24gPSBrdm1pX3NlbmRfeHNldGJ2KHZjcHUpOwor
CXN3aXRjaCAoYWN0aW9uKSB7CisJY2FzZSBLVk1JX0VWRU5UX0FDVElPTl9DT05USU5VRToKKwkJ
YnJlYWs7CisJZGVmYXVsdDoKKwkJa3ZtaV9oYW5kbGVfY29tbW9uX2V2ZW50X2FjdGlvbnModmNw
dS0+a3ZtLCBhY3Rpb24sICJYU0VUQlYiKTsKKwl9Cit9CisKK3ZvaWQga3ZtaV94c2V0YnZfZXZl
bnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAq
a3ZtaTsKKworCWt2bWkgPSBrdm1pX2dldCh2Y3B1LT5rdm0pOworCWlmICgha3ZtaSkKKwkJcmV0
dXJuOworCisJaWYgKGlzX2V2ZW50X2VuYWJsZWQodmNwdSwgS1ZNSV9FVkVOVF9YU0VUQlYpKQor
CQlfX2t2bWlfeHNldGJ2X2V2ZW50KHZjcHUpOworCisJa3ZtaV9wdXQodmNwdS0+a3ZtKTsKK30K
ZGlmZiAtLWdpdCBhL2FyY2gveDg2L2t2bS94ODYuYyBiL2FyY2gveDg2L2t2bS94ODYuYwppbmRl
eCAwZTM3MDRiZWQ2YzQuLmFiMGFkM2I2ZWJjMiAxMDA2NDQKLS0tIGEvYXJjaC94ODYva3ZtL3g4
Ni5jCisrKyBiL2FyY2gveDg2L2t2bS94ODYuYwpAQCAtODY1LDYgKzg2NSwxMiBAQCBzdGF0aWMg
aW50IF9fa3ZtX3NldF94Y3Ioc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1MzIgaW5kZXgsIHU2NCB4
Y3IpCiAJfQogCXZjcHUtPmFyY2gueGNyMCA9IHhjcjA7CiAKKyNpZmRlZiBDT05GSUdfS1ZNX0lO
VFJPU1BFQ1RJT04KKwlpZiAoaW5kZXggPT0gMCAmJiB4Y3IwICE9IG9sZF94Y3IwKQorCQlrdm1p
X3hzZXRidl9ldmVudCh2Y3B1KTsKKyNlbmRpZiAvKiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04g
Ki8KKworCiAJaWYgKCh4Y3IwIF4gb2xkX3hjcjApICYgWEZFQVRVUkVfTUFTS19FWFRFTkQpCiAJ
CWt2bV91cGRhdGVfY3B1aWQodmNwdSk7CiAJcmV0dXJuIDA7CmRpZmYgLS1naXQgYS9pbmNsdWRl
L3VhcGkvbGludXgva3ZtaS5oIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaAppbmRleCBkMzNl
OGRhZTAwODQuLmVjZjE0MGJhM2NhYiAxMDA2NDQKLS0tIGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2
bWkuaAorKysgYi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oCkBAIC00Niw2ICs0Niw3IEBAIGVu
dW0gewogCUtWTUlfRVZFTlRfQlJFQUtQT0lOVCA9IDMsCiAJS1ZNSV9FVkVOVF9DUiAgICAgICAg
ID0gNCwKIAlLVk1JX0VWRU5UX1RSQVAgICAgICAgPSA1LAorCUtWTUlfRVZFTlRfWFNFVEJWICAg
ICA9IDYsCiAKIAlLVk1JX05VTV9FVkVOVFMKIH07CmRpZmYgLS1naXQgYS90b29scy90ZXN0aW5n
L3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jIGIvdG9vbHMvdGVzdGluZy9zZWxmdGVz
dHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYwppbmRleCA2Njc2NmQxMTIwMDYuLjNhNDU4MzRlOTIz
NSAxMDA2NDQKLS0tIGEvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rl
c3QuYworKysgYi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5j
CkBAIC0yMiw2ICsyMiw4IEBACiAKICNkZWZpbmUgVkNQVV9JRCAgICAgICAgIDUKIAorI2RlZmlu
ZSBYODZfRkVBVFVSRV9YU0FWRQkoMTw8MjYpCisKIHN0YXRpYyBpbnQgc29ja2V0X3BhaXJbMl07
CiAjZGVmaW5lIEt2bV9zb2NrZXQgICAgICAgc29ja2V0X3BhaXJbMF0KICNkZWZpbmUgVXNlcnNw
YWNlX3NvY2tldCBzb2NrZXRfcGFpclsxXQpAQCAtNTQsNiArNTYsNyBAQCBlbnVtIHsKIAlHVUVT
VF9URVNUX0JQLAogCUdVRVNUX1RFU1RfQ1IsCiAJR1VFU1RfVEVTVF9IWVBFUkNBTEwsCisJR1VF
U1RfVEVTVF9YU0VUQlYsCiB9OwogCiAjZGVmaW5lIEdVRVNUX1JFUVVFU1RfVEVTVCgpICAgICBH
VUVTVF9TWU5DKDApCkBAIC04NSw2ICs4OCw0NSBAQCBzdGF0aWMgdm9pZCBndWVzdF9oeXBlcmNh
bGxfdGVzdCh2b2lkKQogCWFzbSB2b2xhdGlsZSgiLmJ5dGUgMHgwZiwweDAxLDB4YzEiKTsKIH0K
IAorLyogZnJvbSBmcHUvaW50ZXJuYWwuaCAqLworc3RhdGljIHU2NCB4Z2V0YnYodTMyIGluZGV4
KQoreworCXUzMiBlYXgsIGVkeDsKKworCWFzbSB2b2xhdGlsZSgiLmJ5dGUgMHgwZiwweDAxLDB4
ZDAiIC8qIHhnZXRidiAqLworCQkgICAgIDogIj1hIiAoZWF4KSwgIj1kIiAoZWR4KQorCQkgICAg
IDogImMiIChpbmRleCkpOworCXJldHVybiBlYXggKyAoKHU2NCllZHggPDwgMzIpOworfQorCisv
KiBmcm9tIGZwdS9pbnRlcm5hbC5oICovCitzdGF0aWMgdm9pZCB4c2V0YnYodTMyIGluZGV4LCB1
NjQgdmFsdWUpCit7CisJdTMyIGVheCA9IHZhbHVlOworCXUzMiBlZHggPSB2YWx1ZSA+PiAzMjsK
KworCWFzbSB2b2xhdGlsZSgiLmJ5dGUgMHgwZiwweDAxLDB4ZDEiIC8qIHhzZXRidiAqLworCQkg
ICAgIDogOiAiYSIgKGVheCksICJkIiAoZWR4KSwgImMiIChpbmRleCkpOworfQorCitzdGF0aWMg
dm9pZCBndWVzdF94c2V0YnZfdGVzdCh2b2lkKQoreworCWNvbnN0IGludCBTU0VfQklUID0gMSA8
PCAxOworCWNvbnN0IGludCBBVlhfQklUID0gMSA8PCAyOworCXU2NCB4Y3IwOworCisJLyogYXZv
aWQgI1VEICovCisJc2V0X2NyNChnZXRfY3I0KCkgfCBYODZfQ1I0X09TWFNBVkUpOworCisJeGNy
MCA9IHhnZXRidigwKTsKKwlpZiAoeGNyMCAmIEFWWF9CSVQpCisJCXhjcjAgJj0gfkFWWF9CSVQ7
CisJZWxzZQorCQl4Y3IwIHw9IChBVlhfQklUIHwgU1NFX0JJVCk7CisKKwl4c2V0YnYoMCwgeGNy
MCk7Cit9CisKIHN0YXRpYyB2b2lkIGd1ZXN0X2NvZGUodm9pZCkKIHsKIAl3aGlsZSAodHJ1ZSkg
ewpAQCAtMTAwLDYgKzE0Miw5IEBAIHN0YXRpYyB2b2lkIGd1ZXN0X2NvZGUodm9pZCkKIAkJY2Fz
ZSBHVUVTVF9URVNUX0hZUEVSQ0FMTDoKIAkJCWd1ZXN0X2h5cGVyY2FsbF90ZXN0KCk7CiAJCQli
cmVhazsKKwkJY2FzZSBHVUVTVF9URVNUX1hTRVRCVjoKKwkJCWd1ZXN0X3hzZXRidl90ZXN0KCk7
CisJCQlicmVhazsKIAkJfQogCQlHVUVTVF9TSUdOQUxfVEVTVF9ET05FKCk7CiAJfQpAQCAtMTI0
Myw2ICsxMjg4LDQzIEBAIHN0YXRpYyB2b2lkIHRlc3RfY21kX3ZtX2dldF9tYXhfZ2ZuKHZvaWQp
CiAJREVCVUcoIm1heF9nZm46IDB4JWxseFxuIiwgcnBsLmdmbik7CiB9CiAKK3N0YXRpYyB2b2lk
IHRlc3RfZXZlbnRfeHNldGJ2KHN0cnVjdCBrdm1fdm0gKnZtKQoreworCXN0cnVjdCB2Y3B1X3dv
cmtlcl9kYXRhIGRhdGEgPSB7CisJCS52bSA9IHZtLAorCQkudmNwdV9pZCA9IFZDUFVfSUQsCisJ
CS50ZXN0X2lkID0gR1VFU1RfVEVTVF9YU0VUQlYsCisJfTsKKwlfX3UxNiBldmVudF9pZCA9IEtW
TUlfRVZFTlRfWFNFVEJWOworCXN0cnVjdCBrdm1fY3B1aWRfZW50cnkyICplbnRyeTsKKwlzdHJ1
Y3QgdmNwdV9yZXBseSBycGwgPSB7fTsKKwlzdHJ1Y3Qga3ZtaV9tc2dfaGRyIGhkcjsKKwlwdGhy
ZWFkX3QgdmNwdV90aHJlYWQ7CisJc3RydWN0IGt2bWlfZXZlbnQgZXY7CisKKwllbnRyeSA9IGt2
bV9nZXRfc3VwcG9ydGVkX2NwdWlkX2VudHJ5KDEpOworCWlmICghKGVudHJ5LT5lY3ggJiBYODZf
RkVBVFVSRV9YU0FWRSkpIHsKKwkJREVCVUcoIlhTQVZFIGlzIG5vdCBzdXBwb3J0ZWQsIGVjeCAw
eCV4LCBza2lwcGluZyB4c2V0YnYgdGVzdFxuIiwKKwkJCWVudHJ5LT5lY3gpOworCQlyZXR1cm47
CisJfQorCisJZW5hYmxlX3ZjcHVfZXZlbnQodm0sIGV2ZW50X2lkKTsKKworCXZjcHVfdGhyZWFk
ID0gc3RhcnRfdmNwdV93b3JrZXIoJmRhdGEpOworCisJcmVjZWl2ZV9ldmVudCgmaGRyLCAmZXYs
IHNpemVvZihldiksIGV2ZW50X2lkKTsKKworCURFQlVHKCJYU0VUQlYgZXZlbnQsIHJpcCAweCVs
bHhcbiIsIGV2LmFyY2gucmVncy5yaXApOworCisJcmVwbHlfdG9fZXZlbnQoJmhkciwgJmV2LCBL
Vk1JX0VWRU5UX0FDVElPTl9DT05USU5VRSwKKwkJCSZycGwsIHNpemVvZihycGwpKTsKKworCXN0
b3BfdmNwdV93b3JrZXIodmNwdV90aHJlYWQsICZkYXRhKTsKKworCWRpc2FibGVfdmNwdV9ldmVu
dCh2bSwgZXZlbnRfaWQpOworfQorCiBzdGF0aWMgdm9pZCB0ZXN0X2ludHJvc3BlY3Rpb24oc3Ry
dWN0IGt2bV92bSAqdm0pCiB7CiAJc3JhbmRvbSh0aW1lKDApKTsKQEAgLTEyNjgsNiArMTM1MCw3
IEBAIHN0YXRpYyB2b2lkIHRlc3RfaW50cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkKIAl0
ZXN0X2NtZF92Y3B1X2NvbnRyb2xfY3Iodm0pOwogCXRlc3RfY21kX3ZjcHVfaW5qZWN0X2V4Y2Vw
dGlvbih2bSk7CiAJdGVzdF9jbWRfdm1fZ2V0X21heF9nZm4oKTsKKwl0ZXN0X2V2ZW50X3hzZXRi
dih2bSk7CiAKIAl1bmhvb2tfaW50cm9zcGVjdGlvbih2bSk7CiB9CmRpZmYgLS1naXQgYS92aXJ0
L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5j
CmluZGV4IDBmMmNlYzdlOWM5MC4uZDM1ODY4NmZjZTc2IDEwMDY0NAotLS0gYS92aXJ0L2t2bS9p
bnRyb3NwZWN0aW9uL2t2bWkuYworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwpA
QCAtODMsNiArODMsNyBAQCBzdGF0aWMgdm9pZCBzZXR1cF9rbm93bl9ldmVudHModm9pZCkKIAlz
ZXRfYml0KEtWTUlfRVZFTlRfSFlQRVJDQUxMLCBLdm1pX2tub3duX3ZjcHVfZXZlbnRzKTsKIAlz
ZXRfYml0KEtWTUlfRVZFTlRfUEFVU0VfVkNQVSwgS3ZtaV9rbm93bl92Y3B1X2V2ZW50cyk7CiAJ
c2V0X2JpdChLVk1JX0VWRU5UX1RSQVAsIEt2bWlfa25vd25fdmNwdV9ldmVudHMpOworCXNldF9i
aXQoS1ZNSV9FVkVOVF9YU0VUQlYsIEt2bWlfa25vd25fdmNwdV9ldmVudHMpOwogCiAJYml0bWFw
X29yKEt2bWlfa25vd25fZXZlbnRzLCBLdm1pX2tub3duX3ZtX2V2ZW50cywKIAkJICBLdm1pX2tu
b3duX3ZjcHVfZXZlbnRzLCBLVk1JX05VTV9FVkVOVFMpOwpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmly
dHVhbGl6YXRpb25AbGlzdHMubGludXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51
eGZvdW5kYXRpb24ub3JnL21haWxtYW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
