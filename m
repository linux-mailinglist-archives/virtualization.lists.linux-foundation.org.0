Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id B5417228A93
	for <lists.virtualization@lfdr.de>; Tue, 21 Jul 2020 23:16:13 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 64B0486B87;
	Tue, 21 Jul 2020 21:16:12 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 6U1oi0F7AeoT; Tue, 21 Jul 2020 21:16:07 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 65F1786BA1;
	Tue, 21 Jul 2020 21:16:03 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 4B71FC016F;
	Tue, 21 Jul 2020 21:16:03 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 4CBC2C016F
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:15:59 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by hemlock.osuosl.org (Postfix) with ESMTP id 36917886A7
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:15:59 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id bH8QoRN2ZGZj
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:15:55 +0000 (UTC)
X-Greylist: from auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by hemlock.osuosl.org (Postfix) with ESMTPS id 2541A886E5
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:15:55 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 09743305D503; Wed, 22 Jul 2020 00:09:31 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.27])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id D0B94304FA14;
 Wed, 22 Jul 2020 00:09:30 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v9 75/84] KVM: introspection: add KVMI_VCPU_CONTROL_MSR and
 KVMI_EVENT_MSR
Date: Wed, 22 Jul 2020 00:09:13 +0300
Message-Id: <20200721210922.7646-76-alazar@bitdefender.com>
In-Reply-To: <20200721210922.7646-1-alazar@bitdefender.com>
References: <20200721210922.7646-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <ncitu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBjb21tYW5k
IGlzIHVzZWQgdG8gZW5hYmxlL2Rpc2FibGUgaW50cm9zcGVjdGlvbiBmb3IgYSBzcGVjaWZpYwpN
U1IuIFRoZSBLVk1JX0VWRU5UX01TUiBldmVudCBpcyBzZW50IHdoZW4gdGhlIHRyYWNrZWQgTVNS
IGlzIGdvaW5nIHRvCmJlIGNoYW5nZWQuIFRoZSBpbnRyb3NwZWN0aW9uIHRvb2wgY2FuIHJlc3Bv
bmQgYnkgYWxsb3dpbmcgdGhlIGd1ZXN0IHRvCmNvbnRpbnVlIHdpdGggbm9ybWFsIGV4ZWN1dGlv
biBvciBieSBkaXNjYXJkaW5nIHRoZSBjaGFuZ2UuCgpUaGlzIGlzIG1lYW50IHRvIHByZXZlbnQg
bWFsaWNpb3VzIGNoYW5nZXMgdG8gTVNScwpzdWNoIGFzIE1TUl9JQTMyX1NZU0VOVEVSX0VJUC4K
ClNpZ25lZC1vZmYtYnk6IE1paGFpIERvbsibdSA8bWRvbnR1QGJpdGRlZmVuZGVyLmNvbT4KQ28t
ZGV2ZWxvcGVkLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5jaXR1QGJpdGRlZmVuZGVyLmNvbT4KU2ln
bmVkLW9mZi1ieTogTmljdciZb3IgQ8OuyJt1IDxuY2l0dUBiaXRkZWZlbmRlci5jb20+CkNvLWRl
dmVsb3BlZC1ieTogQWRhbGJlcnQgTGF6xINyIDxhbGF6YXJAYml0ZGVmZW5kZXIuY29tPgpTaWdu
ZWQtb2ZmLWJ5OiBBZGFsYmVydCBMYXrEg3IgPGFsYXphckBiaXRkZWZlbmRlci5jb20+Ci0tLQog
RG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdCAgICAgICAgICAgICAgIHwgIDc1ICsrKysr
KysrKwogYXJjaC94ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmggICAgICAgICAgICAgIHwgIDEy
ICsrCiBhcmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaCAgICAgICAgICAgICAgfCAgMTgg
KysKIGFyY2gveDg2L2t2bS9rdm1pLmMgICAgICAgICAgICAgICAgICAgICAgICAgICB8IDE1OSAr
KysrKysrKysrKysrKysrKysKIGFyY2gveDg2L2t2bS94ODYuYyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB8ICAgMyArCiBpbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oICAgICAgICAgICAgICAg
ICAgICAgfCAgIDIgKwogLi4uL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0
LmMgIHwgMTE5ICsrKysrKysrKysrKysKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jICAg
ICAgICAgICAgICAgICB8ICAgMSArCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50Lmgg
ICAgICAgICAgICAgfCAgIDIgKwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jICAg
ICAgICAgICAgIHwgIDEyICsrCiAxMCBmaWxlcyBjaGFuZ2VkLCA0MDMgaW5zZXJ0aW9ucygrKQoK
ZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QgYi9Eb2N1bWVudGF0
aW9uL3ZpcnQva3ZtL2t2bWkucnN0CmluZGV4IDAyOTRjMTQxZWIwYS4uNTM2ZDZlY2VjMDI2IDEw
MDY0NAotLS0gYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CisrKyBiL0RvY3VtZW50
YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKQEAgLTU1Myw2ICs1NTMsNyBAQCB0aGUgZm9sbG93aW5n
IGV2ZW50czo6CiAJS1ZNSV9FVkVOVF9DUgogCUtWTUlfRVZFTlRfREVTQ1JJUFRPUgogCUtWTUlf
RVZFTlRfSFlQRVJDQUxMCisJS1ZNSV9FVkVOVF9NU1IKIAlLVk1JX0VWRU5UX1hTRVRCVgogCiBX
aGVuIGFuIGV2ZW50IGlzIGVuYWJsZWQsIHRoZSBpbnRyb3NwZWN0aW9uIHRvb2wgaXMgbm90aWZp
ZWQgYW5kCkBAIC05MzcsNiArOTM4LDQ1IEBAIFJldHVybnMgdGhlIGd1ZXN0IG1lbW9yeSB0eXBl
IGZvciBhIHNwZWNpZmljIHBoeXNpY2FsIGFkZHJlc3MuCiAqIC1LVk1fRUlOVkFMIC0gdGhlIHBh
ZGRpbmcgaXMgbm90IHplcm8KICogLUtWTV9FQUdBSU4gLSB0aGUgc2VsZWN0ZWQgdkNQVSBjYW4n
dCBiZSBpbnRyb3NwZWN0ZWQgeWV0CiAKKzIyLiBLVk1JX1ZDUFVfQ09OVFJPTF9NU1IKKy0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0KKworOkFyY2hpdGVjdHVyZXM6IHg4NgorOlZlcnNpb25zOiA+
PSAxCis6UGFyYW1ldGVyczoKKworOjoKKworCXN0cnVjdCBrdm1pX3ZjcHVfaGRyOworCXN0cnVj
dCBrdm1pX3ZjcHVfY29udHJvbF9tc3IgeworCQlfX3U4IGVuYWJsZTsKKwkJX191OCBwYWRkaW5n
MTsKKwkJX191MTYgcGFkZGluZzI7CisJCV9fdTMyIG1zcjsKKwl9OworCis6UmV0dXJuczoKKwor
OjoKKworCXN0cnVjdCBrdm1pX2Vycm9yX2NvZGUKKworRW5hYmxlcy9kaXNhYmxlcyBpbnRyb3Nw
ZWN0aW9uIGZvciBhIHNwZWNpZmljIE1TUiBhbmQgbXVzdCBiZSB1c2VkCitpbiBhZGRpdGlvbiB0
byAqS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTKiB3aXRoIHRoZSAqS1ZNSV9FVkVOVF9NU1IqIElE
IHNldC4KKworQ3VycmVudGx5LCBvbmx5IE1TUnMgd2l0aGluIHRoZSBmb2xsb3dpbmcgdHdvIHJh
bmdlcyBhcmUgc3VwcG9ydGVkLiBUcnlpbmcKK3RvIGNvbnRyb2wgZXZlbnRzIGZvciBhbnkgb3Ro
ZXIgcmVnaXN0ZXIgd2lsbCBmYWlsIHdpdGggLUtWTV9FSU5WQUw6OgorCisJMCAgICAgICAgICAu
Li4gMHgwMDAwMWZmZgorCTB4YzAwMDAwMDAgLi4uIDB4YzAwMDFmZmYKKworOkVycm9yczoKKwor
KiAtS1ZNX0VJTlZBTCAtIHRoZSBzZWxlY3RlZCB2Q1BVIGlzIGludmFsaWQKKyogLUtWTV9FSU5W
QUwgLSB0aGUgc3BlY2lmaWVkIE1TUiBpcyBpbnZhbGlkCisqIC1LVk1fRUlOVkFMIC0gdGhlIHBh
ZGRpbmcgaXMgbm90IHplcm8KKyogLUtWTV9FQUdBSU4gLSB0aGUgc2VsZWN0ZWQgdkNQVSBjYW4n
dCBiZSBpbnRyb3NwZWN0ZWQgeWV0CisKIEV2ZW50cwogPT09PT09CiAKQEAgLTEyNTIsMyArMTI5
MiwzOCBAQCBpbnRyb3NwZWN0aW9uIGhhcyBiZWVuIGVuYWJsZWQgZm9yIHRoaXMgZXZlbnQgKHNl
ZSAqKktWTUlfVkNQVV9DT05UUk9MX0VWRU5UUyoqKQogCUtWTUlfREVTQ19UUgogCiBgYHdyaXRl
YGAgaXMgMSBpZiB0aGUgZGVzY3JpcHRvciB3YXMgd3JpdHRlbiwgMCBvdGhlcndpc2UuCisKKzku
IEtWTUlfRVZFTlRfTVNSCistLS0tLS0tLS0tLS0tLS0tLQorCis6QXJjaGl0ZWN0dXJlczogeDg2
Cis6VmVyc2lvbnM6ID49IDEKKzpBY3Rpb25zOiBDT05USU5VRSwgQ1JBU0gKKzpQYXJhbWV0ZXJz
OgorCis6OgorCisJc3RydWN0IGt2bWlfZXZlbnQ7CisJc3RydWN0IGt2bWlfZXZlbnRfbXNyIHsK
KwkJX191MzIgbXNyOworCQlfX3UzMiBwYWRkaW5nOworCQlfX3U2NCBvbGRfdmFsdWU7CisJCV9f
dTY0IG5ld192YWx1ZTsKKwl9OworCis6UmV0dXJuczoKKworOjoKKworCXN0cnVjdCBrdm1pX3Zj
cHVfaGRyOworCXN0cnVjdCBrdm1pX2V2ZW50X3JlcGx5OworCXN0cnVjdCBrdm1pX2V2ZW50X21z
cl9yZXBseSB7CisJCV9fdTY0IG5ld192YWw7CisJfTsKKworVGhpcyBldmVudCBpcyBzZW50IHdo
ZW4gYSBtb2RlbCBzcGVjaWZpYyByZWdpc3RlciBpcyBnb2luZyB0byBiZSBjaGFuZ2VkCithbmQg
dGhlIGludHJvc3BlY3Rpb24gaGFzIGJlZW4gZW5hYmxlZCBmb3IgdGhpcyBldmVudCBhbmQgZm9y
IHRoaXMgc3BlY2lmaWMKK3JlZ2lzdGVyIChzZWUgKipLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMq
KikuCisKK2Bga3ZtaV9ldmVudGBgLCB0aGUgTVNSIG51bWJlciwgdGhlIG9sZCB2YWx1ZSBhbmQg
dGhlIG5ldyB2YWx1ZSBhcmUKK3NlbnQgdG8gdGhlIGludHJvc3BlY3Rpb24gdG9vbC4gVGhlICpD
T05USU5VRSogYWN0aW9uIHdpbGwgc2V0IHRoZSBgYG5ld192YWxgYC4KZGlmZiAtLWdpdCBhL2Fy
Y2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5oIGIvYXJjaC94ODYvaW5jbHVkZS9hc20va3Zt
aV9ob3N0LmgKaW5kZXggMGVkMTg3OWZkMjUwLi41ZjI5NjdkODZiNzIgMTAwNjQ0Ci0tLSBhL2Fy
Y2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5oCisrKyBiL2FyY2gveDg2L2luY2x1ZGUvYXNt
L2t2bWlfaG9zdC5oCkBAIC00LDcgKzQsMTAgQEAKIAogI2luY2x1ZGUgPGFzbS9rdm1pLmg+CiAK
K3N0cnVjdCBtc3JfZGF0YTsKKwogI2RlZmluZSBLVk1JX05VTV9DUiA1CisjZGVmaW5lIEtWTUlf
TlVNX01TUiAweDIwMDAKIAogc3RydWN0IGt2bWlfbW9uaXRvcl9pbnRlcmNlcHRpb24gewogCWJv
b2wga3ZtaV9pbnRlcmNlcHRlZDsKQEAgLTE4LDYgKzIxLDEyIEBAIHN0cnVjdCBrdm1pX2ludGVy
Y2VwdGlvbiB7CiAJc3RydWN0IGt2bWlfbW9uaXRvcl9pbnRlcmNlcHRpb24gYnJlYWtwb2ludDsK
IAlzdHJ1Y3Qga3ZtaV9tb25pdG9yX2ludGVyY2VwdGlvbiBjcjN3OwogCXN0cnVjdCBrdm1pX21v
bml0b3JfaW50ZXJjZXB0aW9uIGRlc2NyaXB0b3I7CisJc3RydWN0IHsKKwkJc3RydWN0IHsKKwkJ
CURFQ0xBUkVfQklUTUFQKGxvdywgS1ZNSV9OVU1fTVNSKTsKKwkJCURFQ0xBUkVfQklUTUFQKGhp
Z2gsIEtWTUlfTlVNX01TUik7CisJCX0ga3ZtaV9tYXNrOworCX0gbXNydzsKIH07CiAKIHN0cnVj
dCBrdm1fdmNwdV9hcmNoX2ludHJvc3BlY3Rpb24gewpAQCAtMzgsNiArNDcsNyBAQCB2b2lkIGt2
bWlfeHNldGJ2X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTggeGNyLAogCQkgICAgICAg
dTY0IG9sZF92YWx1ZSwgdTY0IG5ld192YWx1ZSk7CiBib29sIGt2bWlfbW9uaXRvcl9kZXNjX2lu
dGVyY2VwdChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIGJvb2wgZW5hYmxlKTsKIGJvb2wga3ZtaV9k
ZXNjcmlwdG9yX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTggZGVzY3JpcHRvciwgYm9v
bCB3cml0ZSk7Citib29sIGt2bWlfbXNyX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgc3Ry
dWN0IG1zcl9kYXRhICptc3IpOwogCiAjZWxzZSAvKiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04g
Ki8KIApAQCAtNTYsNiArNjYsOCBAQCBzdGF0aWMgaW5saW5lIGJvb2wga3ZtaV9tb25pdG9yX2Rl
c2NfaW50ZXJjZXB0KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKIAkJCQkJICAgICAgIGJvb2wgZW5h
YmxlKSB7IHJldHVybiBmYWxzZTsgfQogc3RhdGljIGlubGluZSBib29sIGt2bWlfZGVzY3JpcHRv
cl9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU4IGRlc2NyaXB0b3IsCiAJCQkJCSBib29s
IHdyaXRlKSB7IHJldHVybiB0cnVlOyB9CitzdGF0aWMgaW5saW5lIGJvb2wga3ZtaV9tc3JfZXZl
bnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBzdHJ1Y3QgbXNyX2RhdGEgKm1zcikKKwkJCQl7IHJl
dHVybiB0cnVlOyB9CiAKICNlbmRpZiAvKiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04gKi8KIApk
aWZmIC0tZ2l0IGEvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmggYi9hcmNoL3g4Ni9p
bmNsdWRlL3VhcGkvYXNtL2t2bWkuaAppbmRleCBiNmZmMzliYTBhYjMuLjFiYjEzZGE2MWRiZiAx
MDA2NDQKLS0tIGEvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmgKKysrIGIvYXJjaC94
ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmgKQEAgLTEyNyw0ICsxMjcsMjIgQEAgc3RydWN0IGt2
bWlfZXZlbnRfZGVzY3JpcHRvciB7CiAJX191OCBwYWRkaW5nWzZdOwogfTsKIAorc3RydWN0IGt2
bWlfdmNwdV9jb250cm9sX21zciB7CisJX191OCBlbmFibGU7CisJX191OCBwYWRkaW5nMTsKKwlf
X3UxNiBwYWRkaW5nMjsKKwlfX3UzMiBtc3I7Cit9OworCitzdHJ1Y3Qga3ZtaV9ldmVudF9tc3Ig
eworCV9fdTMyIG1zcjsKKwlfX3UzMiBwYWRkaW5nOworCV9fdTY0IG9sZF92YWx1ZTsKKwlfX3U2
NCBuZXdfdmFsdWU7Cit9OworCitzdHJ1Y3Qga3ZtaV9ldmVudF9tc3JfcmVwbHkgeworCV9fdTY0
IG5ld192YWw7Cit9OworCiAjZW5kaWYgLyogX1VBUElfQVNNX1g4Nl9LVk1JX0ggKi8KZGlmZiAt
LWdpdCBhL2FyY2gveDg2L2t2bS9rdm1pLmMgYi9hcmNoL3g4Ni9rdm0va3ZtaS5jCmluZGV4IGRm
ZTFiODg3YjRmMy4uYTQ4ZTcyZjUyMGRhIDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9rdm0va3ZtaS5j
CisrKyBiL2FyY2gveDg2L2t2bS9rdm1pLmMKQEAgLTQxOSw2ICs0MTksNzYgQEAgc3RhdGljIHZv
aWQga3ZtaV9hcmNoX2Rpc2FibGVfZGVzY19pbnRlcmNlcHQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
KQogCXZjcHUtPmFyY2gua3ZtaS0+ZGVzY3JpcHRvci5rdm1faW50ZXJjZXB0ZWQgPSBmYWxzZTsK
IH0KIAorc3RhdGljIGJvb2wga3ZtaV9tc3JfdmFsaWQodW5zaWduZWQgaW50IG1zcikKK3sKKwly
ZXR1cm4gbXNyIDw9IDB4MWZmZiB8fCAobXNyID49IDB4YzAwMDAwMDAgJiYgbXNyIDw9IDB4YzAw
MDFmZmYpOworfQorCitzdGF0aWMgdW5zaWduZWQgbG9uZyAqbXNyX21hc2soc3RydWN0IGt2bV92
Y3B1ICp2Y3B1LCB1bnNpZ25lZCBpbnQgKm1zcikKK3sKKwlzd2l0Y2ggKCptc3IpIHsKKwljYXNl
IDAgLi4uIDB4MWZmZjoKKwkJcmV0dXJuIHZjcHUtPmFyY2gua3ZtaS0+bXNydy5rdm1pX21hc2su
bG93OworCWNhc2UgMHhjMDAwMDAwMCAuLi4gMHhjMDAwMWZmZjoKKwkJKm1zciAmPSAweDFmZmY7
CisJCXJldHVybiB2Y3B1LT5hcmNoLmt2bWktPm1zcncua3ZtaV9tYXNrLmhpZ2g7CisJfQorCisJ
cmV0dXJuIE5VTEw7Cit9CisKK3N0YXRpYyBib29sIHRlc3RfbXNyX21hc2soc3RydWN0IGt2bV92
Y3B1ICp2Y3B1LCB1bnNpZ25lZCBpbnQgbXNyKQoreworCXVuc2lnbmVkIGxvbmcgKm1hc2sgPSBt
c3JfbWFzayh2Y3B1LCAmbXNyKTsKKworCWlmICghbWFzaykKKwkJcmV0dXJuIGZhbHNlOworCisJ
cmV0dXJuICEhdGVzdF9iaXQobXNyLCBtYXNrKTsKK30KKworc3RhdGljIGJvb2wgbXNyX2NvbnRy
b2woc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1bnNpZ25lZCBpbnQgbXNyLCBib29sIGVuYWJsZSkK
K3sKKwl1bnNpZ25lZCBsb25nICptYXNrID0gbXNyX21hc2sodmNwdSwgJm1zcik7CisKKwlpZiAo
IW1hc2spCisJCXJldHVybiBmYWxzZTsKKworCWlmIChlbmFibGUpCisJCXNldF9iaXQobXNyLCBt
YXNrKTsKKwllbHNlCisJCWNsZWFyX2JpdChtc3IsIG1hc2spOworCisJcmV0dXJuIHRydWU7Cit9
CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgbXNyX21hc2tfdG9fYmFzZShzdHJ1Y3Qga3ZtX3ZjcHUg
KnZjcHUsIHVuc2lnbmVkIGxvbmcgKm1hc2spCit7CisJaWYgKG1hc2sgPT0gdmNwdS0+YXJjaC5r
dm1pLT5tc3J3Lmt2bWlfbWFzay5oaWdoKQorCQlyZXR1cm4gMHhjMDAwMDAwMDsKKworCXJldHVy
biAwOworfQorCitzdGF0aWMgdm9pZCBrdm1pX2FyY2hfZGlzYWJsZV9tc3JfaW50ZXJjZXB0KHN0
cnVjdCBrdm1fdmNwdSAqdmNwdSwKKwkJCQkJICAgIHVuc2lnbmVkIGxvbmcgKm1hc2spCit7CisJ
dW5zaWduZWQgaW50IG1zcl9iYXNlID0gbXNyX21hc2tfdG9fYmFzZSh2Y3B1LCBtYXNrKTsKKwlp
bnQgb2Zmc2V0ID0gLTE7CisKKwlmb3IgKDs7KSB7CisJCW9mZnNldCA9IGZpbmRfbmV4dF9iaXQo
bWFzaywgS1ZNSV9OVU1fTVNSLCBvZmZzZXQgKyAxKTsKKworCQlpZiAob2Zmc2V0ID49IEtWTUlf
TlVNX01TUikKKwkJCWJyZWFrOworCisJCWt2bV94ODZfb3BzLmNvbnRyb2xfbXNyX2ludGVyY2Vw
dCh2Y3B1LCBtc3JfYmFzZSArIG9mZnNldCwKKwkJCQkJCSAgIE1TUl9UWVBFX1csIGZhbHNlKTsK
Kwl9CisKKwliaXRtYXBfemVybyhtYXNrLCBLVk1JX05VTV9NU1IpOworfQorCiBpbnQga3ZtaV9h
cmNoX2NtZF9jb250cm9sX2ludGVyY2VwdChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCiAJCQkJICAg
IHVuc2lnbmVkIGludCBldmVudF9pZCwgYm9vbCBlbmFibGUpCiB7CkBAIC00NjAsOSArNTMwLDEz
IEBAIHZvaWQga3ZtaV9hcmNoX2JyZWFrcG9pbnRfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
LCB1NjQgZ3ZhLCB1OCBpbnNuX2xlbikKIAogc3RhdGljIHZvaWQga3ZtaV9hcmNoX3Jlc3RvcmVf
aW50ZXJjZXB0aW9uKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKIHsKKwlzdHJ1Y3Qga3ZtaV9pbnRl
cmNlcHRpb24gKmFyY2hfdmNwdWkgPSB2Y3B1LT5hcmNoLmt2bWk7CisKIAlrdm1pX2FyY2hfZGlz
YWJsZV9icF9pbnRlcmNlcHQodmNwdSk7CiAJa3ZtaV9hcmNoX2Rpc2FibGVfY3Izd19pbnRlcmNl
cHQodmNwdSk7CiAJa3ZtaV9hcmNoX2Rpc2FibGVfZGVzY19pbnRlcmNlcHQodmNwdSk7CisJa3Zt
aV9hcmNoX2Rpc2FibGVfbXNyX2ludGVyY2VwdCh2Y3B1LCBhcmNoX3ZjcHVpLT5tc3J3Lmt2bWlf
bWFzay5sb3cpOworCWt2bWlfYXJjaF9kaXNhYmxlX21zcl9pbnRlcmNlcHQodmNwdSwgYXJjaF92
Y3B1aS0+bXNydy5rdm1pX21hc2suaGlnaCk7CiB9CiAKIGJvb2wga3ZtaV9hcmNoX2NsZWFuX3Vw
X2ludGVyY2VwdGlvbihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCkBAIC05MTEsMyArOTg1LDg4IEBA
IGJvb2wga3ZtaV9kZXNjcmlwdG9yX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTggZGVz
Y3JpcHRvciwgYm9vbCB3cml0ZSkKIAlyZXR1cm4gcmV0OwogfQogRVhQT1JUX1NZTUJPTChrdm1p
X2Rlc2NyaXB0b3JfZXZlbnQpOworCitpbnQga3ZtaV9hcmNoX2NtZF92Y3B1X2NvbnRyb2xfbXNy
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKKwkJCQkgICBjb25zdCBzdHJ1Y3Qga3ZtaV92Y3B1X2Nv
bnRyb2xfbXNyICpyZXEpCit7CisJaWYgKHJlcS0+cGFkZGluZzEgfHwgcmVxLT5wYWRkaW5nMiB8
fCByZXEtPmVuYWJsZSA+IDEpCisJCXJldHVybiAtS1ZNX0VJTlZBTDsKKworCWlmICgha3ZtaV9t
c3JfdmFsaWQocmVxLT5tc3IpKQorCQlyZXR1cm4gLUtWTV9FSU5WQUw7CisKKwlrdm1feDg2X29w
cy5jb250cm9sX21zcl9pbnRlcmNlcHQodmNwdSwgcmVxLT5tc3IsIE1TUl9UWVBFX1csCisJCQkJ
CSAgcmVxLT5lbmFibGUgPT0gMSk7CisJbXNyX2NvbnRyb2wodmNwdSwgcmVxLT5tc3IsIHJlcS0+
ZW5hYmxlKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdTMyIGt2bWlfc2VuZF9tc3Ioc3Ry
dWN0IGt2bV92Y3B1ICp2Y3B1LCB1MzIgbXNyLCB1NjQgb2xkX3ZhbHVlLAorCQkJIHU2NCBuZXdf
dmFsdWUsIHU2NCAqcmV0X3ZhbHVlKQoreworCXN0cnVjdCBrdm1pX2V2ZW50X21zciBlOworCXN0
cnVjdCBrdm1pX2V2ZW50X21zcl9yZXBseSByOworCWludCBlcnIsIGFjdGlvbjsKKworCW1lbXNl
dCgmZSwgMCwgc2l6ZW9mKGUpKTsKKwllLm1zciA9IG1zcjsKKwllLm9sZF92YWx1ZSA9IG9sZF92
YWx1ZTsKKwllLm5ld192YWx1ZSA9IG5ld192YWx1ZTsKKworCWVyciA9IGt2bWlfc2VuZF9ldmVu
dCh2Y3B1LCBLVk1JX0VWRU5UX01TUiwgJmUsIHNpemVvZihlKSwKKwkJCSAgICAgICZyLCBzaXpl
b2YociksICZhY3Rpb24pOworCWlmIChlcnIpCisJCXJldHVybiBLVk1JX0VWRU5UX0FDVElPTl9D
T05USU5VRTsKKworCSpyZXRfdmFsdWUgPSByLm5ld192YWw7CisJcmV0dXJuIGFjdGlvbjsKK30K
Kworc3RhdGljIGJvb2wgX19rdm1pX21zcl9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHN0
cnVjdCBtc3JfZGF0YSAqbXNyKQoreworCXN0cnVjdCBtc3JfZGF0YSBvbGRfbXNyID0geworCQku
aG9zdF9pbml0aWF0ZWQgPSB0cnVlLAorCQkuaW5kZXggPSBtc3ItPmluZGV4LAorCX07CisJYm9v
bCByZXQgPSBmYWxzZTsKKwl1NjQgcmV0X3ZhbHVlID0gbXNyLT5kYXRhOworCXUzMiBhY3Rpb247
CisKKwlpZiAoIXRlc3RfbXNyX21hc2sodmNwdSwgbXNyLT5pbmRleCkpCisJCXJldHVybiB0cnVl
OworCWlmIChrdm1feDg2X29wcy5nZXRfbXNyKHZjcHUsICZvbGRfbXNyKSkKKwkJcmV0dXJuIHRy
dWU7CisJaWYgKG9sZF9tc3IuZGF0YSA9PSBtc3ItPmRhdGEpCisJCXJldHVybiB0cnVlOworCisJ
YWN0aW9uID0ga3ZtaV9zZW5kX21zcih2Y3B1LCBtc3ItPmluZGV4LCBvbGRfbXNyLmRhdGEsIG1z
ci0+ZGF0YSwKKwkJCSAgICAgICAmcmV0X3ZhbHVlKTsKKwlzd2l0Y2ggKGFjdGlvbikgeworCWNh
c2UgS1ZNSV9FVkVOVF9BQ1RJT05fQ09OVElOVUU6CisJCW1zci0+ZGF0YSA9IHJldF92YWx1ZTsK
KwkJcmV0ID0gdHJ1ZTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJa3ZtaV9oYW5kbGVfY29tbW9u
X2V2ZW50X2FjdGlvbnModmNwdS0+a3ZtLCBhY3Rpb24pOworCX0KKworCXJldHVybiByZXQ7Cit9
CisKK2Jvb2wga3ZtaV9tc3JfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBzdHJ1Y3QgbXNy
X2RhdGEgKm1zcikKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWk7CisJYm9vbCBy
ZXQgPSB0cnVlOworCisJa3ZtaSA9IGt2bWlfZ2V0KHZjcHUtPmt2bSk7CisJaWYgKCFrdm1pKQor
CQlyZXR1cm4gdHJ1ZTsKKworCWlmIChpc19ldmVudF9lbmFibGVkKHZjcHUsIEtWTUlfRVZFTlRf
TVNSKSkKKwkJcmV0ID0gX19rdm1pX21zcl9ldmVudCh2Y3B1LCBtc3IpOworCisJa3ZtaV9wdXQo
dmNwdS0+a3ZtKTsKKworCXJldHVybiByZXQ7Cit9CmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9rdm0v
eDg2LmMgYi9hcmNoL3g4Ni9rdm0veDg2LmMKaW5kZXggYzM1NTdhMTE4MTdmLi4wYWRkMGIwYjhm
MmQgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS94ODYuYworKysgYi9hcmNoL3g4Ni9rdm0veDg2
LmMKQEAgLTE1MzAsNiArMTUzMCw5IEBAIHN0YXRpYyBpbnQgX19rdm1fc2V0X21zcihzdHJ1Y3Qg
a3ZtX3ZjcHUgKnZjcHUsIHUzMiBpbmRleCwgdTY0IGRhdGEsCiAJbXNyLmluZGV4ID0gaW5kZXg7
CiAJbXNyLmhvc3RfaW5pdGlhdGVkID0gaG9zdF9pbml0aWF0ZWQ7CiAKKwlpZiAoIWhvc3RfaW5p
dGlhdGVkICYmICFrdm1pX21zcl9ldmVudCh2Y3B1LCAmbXNyKSkKKwkJcmV0dXJuIDE7CisKIAly
ZXR1cm4ga3ZtX3g4Nl9vcHMuc2V0X21zcih2Y3B1LCAmbXNyKTsKIH0KIApkaWZmIC0tZ2l0IGEv
aW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKaW5k
ZXggZjJlODAyZDJiNzEyLi4yODcyZjkwZmYwOTIgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9s
aW51eC9rdm1pLmgKKysrIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaApAQCAtNDMsNiArNDMs
NyBAQCBlbnVtIHsKIAlLVk1JX1ZDUFVfR0VUX1hTQVZFICAgICA9IDE5LAogCUtWTUlfVkNQVV9T
RVRfWFNBVkUgICAgID0gMjAsCiAJS1ZNSV9WQ1BVX0dFVF9NVFJSX1RZUEUgPSAyMSwKKwlLVk1J
X1ZDUFVfQ09OVFJPTF9NU1IgICA9IDIyLAogCiAJS1ZNSV9OVU1fTUVTU0FHRVMKIH07CkBAIC01
Niw2ICs1Nyw3IEBAIGVudW0gewogCUtWTUlfRVZFTlRfVFJBUCAgICAgICA9IDUsCiAJS1ZNSV9F
VkVOVF9YU0VUQlYgICAgID0gNiwKIAlLVk1JX0VWRU5UX0RFU0NSSVBUT1IgPSA3LAorCUtWTUlf
RVZFTlRfTVNSICAgICAgICA9IDgsCiAKIAlLVk1JX05VTV9FVkVOVFMKIH07CmRpZmYgLS1naXQg
YS90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jIGIvdG9vbHMv
dGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYwppbmRleCAwMDg3YjkxNTc0
ZjAuLjBkZGMwMDI5ZTNlNSAxMDA2NDQKLS0tIGEvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3Zt
L3g4Nl82NC9rdm1pX3Rlc3QuYworKysgYi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2
XzY0L2t2bWlfdGVzdC5jCkBAIC01Nyw2ICs1Nyw3IEBAIGVudW0gewogCUdVRVNUX1RFU1RfQ1Is
CiAJR1VFU1RfVEVTVF9ERVNDUklQVE9SLAogCUdVRVNUX1RFU1RfSFlQRVJDQUxMLAorCUdVRVNU
X1RFU1RfTVNSLAogCUdVRVNUX1RFU1RfWFNFVEJWLAogfTsKIApAQCAtMTAxLDYgKzEwMiwxNSBA
QCBzdGF0aWMgdm9pZCBndWVzdF9oeXBlcmNhbGxfdGVzdCh2b2lkKQogCWFzbSB2b2xhdGlsZSgi
LmJ5dGUgMHgwZiwweDAxLDB4YzEiKTsKIH0KIAorc3RhdGljIHZvaWQgZ3Vlc3RfbXNyX3Rlc3Qo
dm9pZCkKK3sKKwl1aW50NjRfdCBtc3I7CisKKwltc3IgPSByZG1zcihNU1JfTUlTQ19GRUFUVVJF
U19FTkFCTEVTKTsKKwltc3IgfD0gMTsgLyogTVNSX01JU0NfRkVBVFVSRVNfRU5BQkxFU19DUFVJ
RF9GQVVMVCAqLworCXdybXNyKE1TUl9NSVNDX0ZFQVRVUkVTX0VOQUJMRVMsIG1zcik7Cit9CisK
IC8qIGZyb20gZnB1L2ludGVybmFsLmggKi8KIHN0YXRpYyB1NjQgeGdldGJ2KHUzMiBpbmRleCkK
IHsKQEAgLTE1OCw2ICsxNjgsOSBAQCBzdGF0aWMgdm9pZCBndWVzdF9jb2RlKHZvaWQpCiAJCWNh
c2UgR1VFU1RfVEVTVF9IWVBFUkNBTEw6CiAJCQlndWVzdF9oeXBlcmNhbGxfdGVzdCgpOwogCQkJ
YnJlYWs7CisJCWNhc2UgR1VFU1RfVEVTVF9NU1I6CisJCQlndWVzdF9tc3JfdGVzdCgpOworCQkJ
YnJlYWs7CiAJCWNhc2UgR1VFU1RfVEVTVF9YU0VUQlY6CiAJCQlndWVzdF94c2V0YnZfdGVzdCgp
OwogCQkJYnJlYWs7CkBAIC0xNjkxLDYgKzE3MDQsMTExIEBAIHN0YXRpYyB2b2lkIHRlc3RfZXZl
bnRfZGVzY3JpcHRvcihzdHJ1Y3Qga3ZtX3ZtICp2bSkKIAlkaXNhYmxlX3ZjcHVfZXZlbnQodm0s
IGV2ZW50X2lkKTsKIH0KIAorc3RhdGljIHZvaWQgY21kX2NvbnRyb2xfbXNyKHN0cnVjdCBrdm1f
dm0gKnZtLCBfX3UzMiBtc3IsIF9fdTggZW5hYmxlLAorCQkJICAgIF9fdTggcGFkZGluZywgaW50
IGV4cGVjdGVkX2VycikKK3sKKwlzdHJ1Y3QgeworCQlzdHJ1Y3Qga3ZtaV9tc2dfaGRyIGhkcjsK
KwkJc3RydWN0IGt2bWlfdmNwdV9oZHIgdmNwdV9oZHI7CisJCXN0cnVjdCBrdm1pX3ZjcHVfY29u
dHJvbF9tc3IgY21kOworCX0gcmVxID0ge307CisJaW50IHI7CisKKwlyZXEuY21kLm1zciA9IG1z
cjsKKwlyZXEuY21kLmVuYWJsZSA9IGVuYWJsZTsKKwlyZXEuY21kLnBhZGRpbmcxID0gcGFkZGlu
ZzsKKwlyZXEuY21kLnBhZGRpbmcyID0gcGFkZGluZzsKKworCXIgPSBkb192Y3B1MF9jb21tYW5k
KHZtLCBLVk1JX1ZDUFVfQ09OVFJPTF9NU1IsICZyZXEuaGRyLCBzaXplb2YocmVxKSwKKwkJCSAg
ICAgTlVMTCwgMCk7CisJVEVTVF9BU1NFUlQociA9PSBleHBlY3RlZF9lcnIsCisJCSJLVk1JX1ZD
UFVfQ09OVFJPTF9NU1IgZmFpbGVkLCBlcnJvciAlZCglcyksIGV4cGVjdGVkIGVycm9yICVkXG4i
LAorCQktciwga3ZtX3N0cmVycm9yKC1yKSwgZXhwZWN0ZWRfZXJyKTsKK30KKworc3RhdGljIHZv
aWQgZW5hYmxlX21zcl9ldmVudHMoc3RydWN0IGt2bV92bSAqdm0sIF9fdTMyIG1zcikKK3sKKwll
bmFibGVfdmNwdV9ldmVudCh2bSwgS1ZNSV9FVkVOVF9NU1IpOworCWNtZF9jb250cm9sX21zcih2
bSwgbXNyLCAxLCAwLCAwKTsKK30KKworc3RhdGljIHZvaWQgZGlzYWJsZV9tc3JfZXZlbnRzKHN0
cnVjdCBrdm1fdm0gKnZtLCBfX3UzMiBtc3IpCit7CisJY21kX2NvbnRyb2xfbXNyKHZtLCBtc3Is
IDAsIDAsIDApOworCWRpc2FibGVfdmNwdV9ldmVudCh2bSwgS1ZNSV9FVkVOVF9NU1IpOworfQor
CitzdGF0aWMgdm9pZCBoYW5kbGVfbXNyX2V2ZW50KHN0cnVjdCBrdm1fdm0gKnZtLCBfX3UxNiBl
dmVudF9pZCwgX191MzIgbXNyLAorCQkJICAgICBfX3U2NCAqb2xkX3ZhbHVlKQoreworCXN0cnVj
dCBrdm1pX21zZ19oZHIgaGRyOworCXN0cnVjdCB7CisJCXN0cnVjdCBrdm1pX2V2ZW50IGNvbW1v
bjsKKwkJc3RydWN0IGt2bWlfZXZlbnRfbXNyIG1zcjsKKwl9IGV2OworCXN0cnVjdCB7CisJCXN0
cnVjdCB2Y3B1X3JlcGx5IGNvbW1vbjsKKwkJc3RydWN0IGt2bWlfZXZlbnRfbXNyX3JlcGx5IG1z
cjsKKwl9IHJwbCA9IHt9OworCisJcmVjZWl2ZV9ldmVudCgmaGRyLCAmZXYuY29tbW9uLCBzaXpl
b2YoZXYpLCBldmVudF9pZCk7CisKKwlwcl9pbmZvKCJNU1IgMHgleCwgb2xkIDB4JWxseCwgbmV3
IDB4JWxseFxuIiwKKwkJZXYubXNyLm1zciwgZXYubXNyLm9sZF92YWx1ZSwgZXYubXNyLm5ld192
YWx1ZSk7CisKKwlURVNUX0FTU0VSVChldi5tc3IubXNyID09IG1zciwKKwkJIlVuZXhwZWN0ZWQg
TVNSIGV2ZW50LCByZWNlaXZlZCBNU1IgMHgleCwgZXhwZWN0ZWQgTVNSIDB4JXgiLAorCQlldi5t
c3IubXNyLCBtc3IpOworCisJKm9sZF92YWx1ZSA9IHJwbC5tc3IubmV3X3ZhbCA9IGV2Lm1zci5v
bGRfdmFsdWU7CisKKwlyZXBseV90b19ldmVudCgmaGRyLCAmZXYuY29tbW9uLCBLVk1JX0VWRU5U
X0FDVElPTl9DT05USU5VRSwKKwkJCSZycGwuY29tbW9uLCBzaXplb2YocnBsKSk7Cit9CisKK3N0
YXRpYyB2b2lkIHRlc3RfaW52YWxpZF9jb250cm9sX21zcihzdHJ1Y3Qga3ZtX3ZtICp2bSwgX191
MzIgbXNyKQoreworCV9fdTggZW5hYmxlID0gMSwgZW5hYmxlX2ludmFsID0gMjsKKwlfX3U4IG5v
X3BhZGRpbmcgPSAwLCBwYWRkaW5nID0gMTsKKwlpbnQgZXhwZWN0ZWRfZXJyID0gLUtWTV9FSU5W
QUw7CisJX191MzIgbXNyX2ludmFsID0gLTE7CisKKwljbWRfY29udHJvbF9tc3Iodm0sIG1zciwg
ZW5hYmxlX2ludmFsLCBub19wYWRkaW5nLCBleHBlY3RlZF9lcnIpOworCWNtZF9jb250cm9sX21z
cih2bSwgbXNyLCBlbmFibGUsIHBhZGRpbmcsIGV4cGVjdGVkX2Vycik7CisJY21kX2NvbnRyb2xf
bXNyKHZtLCBtc3JfaW52YWwsIGVuYWJsZSwgbm9fcGFkZGluZywgZXhwZWN0ZWRfZXJyKTsKK30K
Kworc3RhdGljIHZvaWQgdGVzdF9jbWRfdmNwdV9jb250cm9sX21zcihzdHJ1Y3Qga3ZtX3ZtICp2
bSkKK3sKKwlzdHJ1Y3QgdmNwdV93b3JrZXJfZGF0YSBkYXRhID0geworCQkudm0gPSB2bSwKKwkJ
LnZjcHVfaWQgPSBWQ1BVX0lELAorCQkudGVzdF9pZCA9IEdVRVNUX1RFU1RfTVNSLAorCX07CisJ
X191MTYgZXZlbnRfaWQgPSBLVk1JX0VWRU5UX01TUjsKKwlfX3UzMiBtc3IgPSBNU1JfTUlTQ19G
RUFUVVJFU19FTkFCTEVTOworCXB0aHJlYWRfdCB2Y3B1X3RocmVhZDsKKwl1aW50NjRfdCBtc3Jf
ZGF0YTsKKwlfX3U2NCBvbGRfdmFsdWU7CisKKwllbmFibGVfbXNyX2V2ZW50cyh2bSwgbXNyKTsK
KworCXZjcHVfdGhyZWFkID0gc3RhcnRfdmNwdV93b3JrZXIoJmRhdGEpOworCisJaGFuZGxlX21z
cl9ldmVudCh2bSwgZXZlbnRfaWQsIG1zciwgJm9sZF92YWx1ZSk7CisKKwlzdG9wX3ZjcHVfd29y
a2VyKHZjcHVfdGhyZWFkLCAmZGF0YSk7CisKKwlkaXNhYmxlX21zcl9ldmVudHModm0sIG1zcik7
CisKKwltc3JfZGF0YSA9IHZjcHVfZ2V0X21zcih2bSwgVkNQVV9JRCwgbXNyKTsKKwlURVNUX0FT
U0VSVChtc3JfZGF0YSA9PSBvbGRfdmFsdWUsCisJCSJGYWlsZWQgdG8gYmxvY2sgTVNSIDB4JXgg
dXBkYXRlLCB2YWx1ZSAweCVseCwgZXhwZWN0ZWQgMHglbGx4IiwKKwkJbXNyLCBtc3JfZGF0YSwg
b2xkX3ZhbHVlKTsKKworCXRlc3RfaW52YWxpZF9jb250cm9sX21zcih2bSwgbXNyKTsKK30KKwog
c3RhdGljIHZvaWQgdGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQogewogCXNy
YW5kb20odGltZSgwKSk7CkBAIC0xNzIyLDYgKzE4NDAsNyBAQCBzdGF0aWMgdm9pZCB0ZXN0X2lu
dHJvc3BlY3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCiAJdGVzdF9jbWRfdmNwdV94c2F2ZSh2bSk7
CiAJdGVzdF9jbWRfdmNwdV9nZXRfbXRycl90eXBlKHZtKTsKIAl0ZXN0X2V2ZW50X2Rlc2NyaXB0
b3Iodm0pOworCXRlc3RfY21kX3ZjcHVfY29udHJvbF9tc3Iodm0pOwogCiAJdW5ob29rX2ludHJv
c3BlY3Rpb24odm0pOwogfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1p
LmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwppbmRleCBhMWJjOTU3MGFjMWMuLmFh
OGEwNzA4Y2MxYyAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKKysr
IGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKQEAgLTEwMSw2ICsxMDEsNyBAQCBzdGF0
aWMgdm9pZCBzZXR1cF9rbm93bl9ldmVudHModm9pZCkKIAlzZXRfYml0KEtWTUlfRVZFTlRfQ1Is
IEt2bWlfa25vd25fdmNwdV9ldmVudHMpOwogCXNldF9iaXQoS1ZNSV9FVkVOVF9ERVNDUklQVE9S
LCBLdm1pX2tub3duX3ZjcHVfZXZlbnRzKTsKIAlzZXRfYml0KEtWTUlfRVZFTlRfSFlQRVJDQUxM
LCBLdm1pX2tub3duX3ZjcHVfZXZlbnRzKTsKKwlzZXRfYml0KEtWTUlfRVZFTlRfTVNSLCBLdm1p
X2tub3duX3ZjcHVfZXZlbnRzKTsKIAlzZXRfYml0KEtWTUlfRVZFTlRfUEFVU0VfVkNQVSwgS3Zt
aV9rbm93bl92Y3B1X2V2ZW50cyk7CiAJc2V0X2JpdChLVk1JX0VWRU5UX1RSQVAsIEt2bWlfa25v
d25fdmNwdV9ldmVudHMpOwogCXNldF9iaXQoS1ZNSV9FVkVOVF9YU0VUQlYsIEt2bWlfa25vd25f
dmNwdV9ldmVudHMpOwpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2lu
dC5oIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCmluZGV4IGE5NjY0ZDI1NWQ2
ZC4uOGY4NTU3YmQ4YWIwIDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlf
aW50LmgKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCkBAIC0xMTUsNSAr
MTE1LDcgQEAgaW50IGt2bWlfYXJjaF9jbWRfdmNwdV9zZXRfeHNhdmUoc3RydWN0IGt2bV92Y3B1
ICp2Y3B1LAogCQkJCSBjb25zdCBzdHJ1Y3Qga3ZtaV92Y3B1X3NldF94c2F2ZSAqcmVxLAogCQkJ
CSBzaXplX3QgcmVxX3NpemUpOwogaW50IGt2bWlfYXJjaF9jbWRfdmNwdV9nZXRfbXRycl90eXBl
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTY0IGdwYSwgdTggKnR5cGUpOworaW50IGt2bWlfYXJj
aF9jbWRfdmNwdV9jb250cm9sX21zcihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCisJCQkJICAgY29u
c3Qgc3RydWN0IGt2bWlfdmNwdV9jb250cm9sX21zciAqcmVxKTsKIAogI2VuZGlmCmRpZmYgLS1n
aXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgYi92aXJ0L2t2bS9pbnRyb3Nw
ZWN0aW9uL2t2bWlfbXNnLmMKaW5kZXggMzY4MTliNTRiM2EwLi5kOWNiYmVmYjk5OTMgMTAwNjQ0
Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYworKysgYi92aXJ0L2t2bS9p
bnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKQEAgLTU4NCw2ICs1ODQsMTcgQEAgc3RhdGljIGludCBo
YW5kbGVfdmNwdV9nZXRfbXRycl90eXBlKGNvbnN0IHN0cnVjdCBrdm1pX3ZjcHVfbXNnX2pvYiAq
am9iLAogCXJldHVybiBrdm1pX21zZ192Y3B1X3JlcGx5KGpvYiwgbXNnLCBlYywgJnJwbCwgc2l6
ZW9mKHJwbCkpOwogfQogCitzdGF0aWMgaW50IGhhbmRsZV92Y3B1X2NvbnRyb2xfbXNyKGNvbnN0
IHN0cnVjdCBrdm1pX3ZjcHVfbXNnX2pvYiAqam9iLAorCQkJCSAgIGNvbnN0IHN0cnVjdCBrdm1p
X21zZ19oZHIgKm1zZywKKwkJCQkgICBjb25zdCB2b2lkICpyZXEpCit7CisJaW50IGVjOworCisJ
ZWMgPSBrdm1pX2FyY2hfY21kX3ZjcHVfY29udHJvbF9tc3Ioam9iLT52Y3B1LCByZXEpOworCisJ
cmV0dXJuIGt2bWlfbXNnX3ZjcHVfcmVwbHkoam9iLCBtc2csIGVjLCBOVUxMLCAwKTsKK30KKwog
LyoKICAqIFRoZXNlIGZ1bmN0aW9ucyBhcmUgZXhlY3V0ZWQgZnJvbSB0aGUgdkNQVSB0aHJlYWQu
IFRoZSByZWNlaXZpbmcgdGhyZWFkCiAgKiBwYXNzZXMgdGhlIG1lc3NhZ2VzIHVzaW5nIGEgbmV3
bHkgYWxsb2NhdGVkICdzdHJ1Y3Qga3ZtaV92Y3B1X21zZ19qb2InCkBAIC01OTUsNiArNjA2LDcg
QEAgc3RhdGljIGludCgqY29uc3QgbXNnX3ZjcHVbXSkoY29uc3Qgc3RydWN0IGt2bWlfdmNwdV9t
c2dfam9iICosCiAJW0tWTUlfRVZFTlRdICAgICAgICAgICAgICAgICA9IGhhbmRsZV92Y3B1X2V2
ZW50X3JlcGx5LAogCVtLVk1JX1ZDUFVfQ09OVFJPTF9DUl0gICAgICAgPSBoYW5kbGVfdmNwdV9j
b250cm9sX2NyLAogCVtLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFNdICAgPSBoYW5kbGVfdmNwdV9j
b250cm9sX2V2ZW50cywKKwlbS1ZNSV9WQ1BVX0NPTlRST0xfTVNSXSAgICAgID0gaGFuZGxlX3Zj
cHVfY29udHJvbF9tc3IsCiAJW0tWTUlfVkNQVV9HRVRfQ1BVSURdICAgICAgICA9IGhhbmRsZV92
Y3B1X2dldF9jcHVpZCwKIAlbS1ZNSV9WQ1BVX0dFVF9JTkZPXSAgICAgICAgID0gaGFuZGxlX3Zj
cHVfZ2V0X2luZm8sCiAJW0tWTUlfVkNQVV9HRVRfTVRSUl9UWVBFXSAgICA9IGhhbmRsZV92Y3B1
X2dldF9tdHJyX3R5cGUsCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0cy5s
aW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcvbWFp
bG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
