Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 9C247228A82
	for <lists.virtualization@lfdr.de>; Tue, 21 Jul 2020 23:16:04 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 1A8B986B91;
	Tue, 21 Jul 2020 21:16:03 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id CI-uZEmC9mQJ; Tue, 21 Jul 2020 21:16:00 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 0721286B43;
	Tue, 21 Jul 2020 21:16:00 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id D119DC088E;
	Tue, 21 Jul 2020 21:15:59 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 248CAC016F
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:15:56 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by fraxinus.osuosl.org (Postfix) with ESMTP id 134B885161
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:15:56 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id CQ-3Au4faKwi
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:15:53 +0000 (UTC)
X-Greylist: from auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by fraxinus.osuosl.org (Postfix) with ESMTPS id E43C58511C
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:15:52 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 E2DEA305D4FC; Wed, 22 Jul 2020 00:09:29 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.27])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id C2118304FA14;
 Wed, 22 Jul 2020 00:09:29 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v9 68/84] KVM: introspection: add KVMI_EVENT_XSETBV
Date: Wed, 22 Jul 2020 00:09:06 +0300
Message-Id: <20200721210922.7646-69-alazar@bitdefender.com>
In-Reply-To: <20200721210922.7646-1-alazar@bitdefender.com>
References: <20200721210922.7646-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <ncitu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBldmVudCBp
cyBzZW50IHdoZW4gYW4gZXh0ZW5kZWQgY29udHJvbCByZWdpc3RlciBYQ1IgaXMgZ29pbmcgdG8K
YmUgY2hhbmdlZC4KClNpZ25lZC1vZmYtYnk6IE1paGFpIERvbsibdSA8bWRvbnR1QGJpdGRlZmVu
ZGVyLmNvbT4KQ28tZGV2ZWxvcGVkLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5jaXR1QGJpdGRlZmVu
ZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogTmljdciZb3IgQ8OuyJt1IDxuY2l0dUBiaXRkZWZlbmRl
ci5jb20+ClNpZ25lZC1vZmYtYnk6IEFkYWxiZXJ0IExhesSDciA8YWxhemFyQGJpdGRlZmVuZGVy
LmNvbT4KLS0tCiBEb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0ICAgICAgICAgICAgICAg
fCAzMyArKysrKysrKwogYXJjaC94ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmggICAgICAgICAg
ICAgIHwgIDQgKwogYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmggICAgICAgICAgICAg
IHwgIDcgKysKIGFyY2gveDg2L2t2bS9rdm1pLmMgICAgICAgICAgICAgICAgICAgICAgICAgICB8
IDQ4ICsrKysrKysrKysrCiBhcmNoL3g4Ni9rdm0veDg2LmMgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfCAgNiArKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCAgICAgICAgICAgICAgICAg
ICAgIHwgIDEgKwogLi4uL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMg
IHwgODQgKysrKysrKysrKysrKysrKysrKwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMg
ICAgICAgICAgICAgICAgIHwgIDEgKwogOCBmaWxlcyBjaGFuZ2VkLCAxODQgaW5zZXJ0aW9ucygr
KQoKZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QgYi9Eb2N1bWVu
dGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CmluZGV4IDdkYThlZmQxOGI4OS4uMjgzZTlhMmRmZGEx
IDEwMDY0NAotLS0gYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CisrKyBiL0RvY3Vt
ZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKQEAgLTU1Miw2ICs1NTIsNyBAQCB0aGUgZm9sbG93
aW5nIGV2ZW50czo6CiAJS1ZNSV9FVkVOVF9CUkVBS1BPSU5UCiAJS1ZNSV9FVkVOVF9DUgogCUtW
TUlfRVZFTlRfSFlQRVJDQUxMCisJS1ZNSV9FVkVOVF9YU0VUQlYKIAogV2hlbiBhbiBldmVudCBp
cyBlbmFibGVkLCB0aGUgaW50cm9zcGVjdGlvbiB0b29sIGlzIG5vdGlmaWVkIGFuZAogbXVzdCBy
ZXBseSB3aXRoOiBjb250aW51ZSwgcmV0cnksIGNyYXNoLCBldGMuIChzZWUgKipFdmVudHMqKiBi
ZWxvdykuCkBAIC0xMDUzLDMgKzEwNTQsMzUgQEAgb3RoZXIgdkNQVSBpbnRyb3NwZWN0aW9uIGV2
ZW50LgogYGBrdm1pX2V2ZW50YGAsIGV4Y2VwdGlvbi9pbnRlcnJ1cHQgbnVtYmVyLCBleGNlcHRp
b24gY29kZQogKGBgZXJyb3JfY29kZWBgKSBhbmQgYWRkcmVzcyBhcmUgc2VudCB0byB0aGUgaW50
cm9zcGVjdGlvbiB0b29sLAogd2hpY2ggc2hvdWxkIGNoZWNrIGlmIGl0cyBleGNlcHRpb24gaGFz
IGJlZW4gaW5qZWN0ZWQgb3Igb3ZlcnJpZGRlbi4KKworNy4gS1ZNSV9FVkVOVF9YU0VUQlYKKy0t
LS0tLS0tLS0tLS0tLS0tLS0tCisKKzpBcmNoaXRlY3R1cmVzOiB4ODYKKzpWZXJzaW9uczogPj0g
MQorOkFjdGlvbnM6IENPTlRJTlVFLCBDUkFTSAorOlBhcmFtZXRlcnM6CisKKzo6CisKKwlzdHJ1
Y3Qga3ZtaV9ldmVudDsKKwlzdHJ1Y3Qga3ZtaV9ldmVudF94c2V0YnYgeworCQlfX3U4IHhjcjsK
KwkJX191OCBwYWRkaW5nWzddOworCQlfX3U2NCBvbGRfdmFsdWU7CisJCV9fdTY0IG5ld192YWx1
ZTsKKwl9OworCis6UmV0dXJuczoKKworOjoKKworCXN0cnVjdCBrdm1pX3ZjcHVfaGRyOworCXN0
cnVjdCBrdm1pX2V2ZW50X3JlcGx5OworCitUaGlzIGV2ZW50IGlzIHNlbnQgd2hlbiB0aGUgZXh0
ZW5kZWQgY29udHJvbCByZWdpc3RlciBYQ1IgaXMgZ29pbmcKK3RvIGJlIGNoYW5nZWQgYW5kIHRo
ZSBpbnRyb3NwZWN0aW9uIGhhcyBiZWVuIGVuYWJsZWQgZm9yIHRoaXMgZXZlbnQKKyhzZWUgKktW
TUlfVkNQVV9DT05UUk9MX0VWRU5UUyopLgorCitgYGt2bWlfZXZlbnRgYCwgdGhlIGV4dGVuZGVk
IGNvbnRyb2wgcmVnaXN0ZXIgbnVtYmVyLCB0aGUgb2xkIHZhbHVlIGFuZAordGhlIG5ldyB2YWx1
ZSBhcmUgc2VudCB0byB0aGUgaW50cm9zcGVjdGlvbiB0b29sLgpkaWZmIC0tZ2l0IGEvYXJjaC94
ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmggYi9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1pX2hv
c3QuaAppbmRleCA0NDU4MGY3N2UzNGUuLmFlZDhhNGI4OGE2OCAxMDA2NDQKLS0tIGEvYXJjaC94
ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmgKKysrIGIvYXJjaC94ODYvaW5jbHVkZS9hc20va3Zt
aV9ob3N0LmgKQEAgLTMzLDYgKzMzLDggQEAgYm9vbCBrdm1pX2NyX2V2ZW50KHN0cnVjdCBrdm1f
dmNwdSAqdmNwdSwgdW5zaWduZWQgaW50IGNyLAogCQkgICB1bnNpZ25lZCBsb25nIG9sZF92YWx1
ZSwgdW5zaWduZWQgbG9uZyAqbmV3X3ZhbHVlKTsKIGJvb2wga3ZtaV9jcjNfaW50ZXJjZXB0ZWQo
c3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIGJvb2wga3ZtaV9tb25pdG9yX2NyM3dfaW50ZXJjZXB0
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgYm9vbCBlbmFibGUpOwordm9pZCBrdm1pX3hzZXRidl9l
dmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU4IHhjciwKKwkJICAgICAgIHU2NCBvbGRfdmFs
dWUsIHU2NCBuZXdfdmFsdWUpOwogCiAjZWxzZSAvKiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04g
Ki8KIApAQCAtNDUsNiArNDcsOCBAQCBzdGF0aWMgaW5saW5lIGJvb2wga3ZtaV9jcl9ldmVudChz
dHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHVuc2lnbmVkIGludCBjciwKIHN0YXRpYyBpbmxpbmUgYm9v
bCBrdm1pX2NyM19pbnRlcmNlcHRlZChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpIHsgcmV0dXJuIGZh
bHNlOyB9CiBzdGF0aWMgaW5saW5lIGJvb2wga3ZtaV9tb25pdG9yX2NyM3dfaW50ZXJjZXB0KHN0
cnVjdCBrdm1fdmNwdSAqdmNwdSwKIAkJCQkJCWJvb2wgZW5hYmxlKSB7IHJldHVybiBmYWxzZTsg
fQorc3RhdGljIGlubGluZSB2b2lkIGt2bWlfeHNldGJ2X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSwgdTggeGNyLAorCQkJCQl1NjQgb2xkX3ZhbHVlLCB1NjQgbmV3X3ZhbHVlKSB7IH0KIAog
I2VuZGlmIC8qIENPTkZJR19LVk1fSU5UUk9TUEVDVElPTiAqLwogCmRpZmYgLS1naXQgYS9hcmNo
L3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaCBiL2FyY2gveDg2L2luY2x1ZGUvdWFwaS9hc20v
a3ZtaS5oCmluZGV4IDRjNTljOWZlNmIwMC4uMmY2OWE0ZjVkMmUwIDEwMDY0NAotLS0gYS9hcmNo
L3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaAorKysgYi9hcmNoL3g4Ni9pbmNsdWRlL3VhcGkv
YXNtL2t2bWkuaApAQCAtODMsNCArODMsMTEgQEAgc3RydWN0IGt2bWlfZXZlbnRfY3JfcmVwbHkg
ewogCV9fdTY0IG5ld192YWw7CiB9OwogCitzdHJ1Y3Qga3ZtaV9ldmVudF94c2V0YnYgeworCV9f
dTggeGNyOworCV9fdTggcGFkZGluZ1s3XTsKKwlfX3U2NCBvbGRfdmFsdWU7CisJX191NjQgbmV3
X3ZhbHVlOworfTsKKwogI2VuZGlmIC8qIF9VQVBJX0FTTV9YODZfS1ZNSV9IICovCmRpZmYgLS1n
aXQgYS9hcmNoL3g4Ni9rdm0va3ZtaS5jIGIvYXJjaC94ODYva3ZtL2t2bWkuYwppbmRleCAwYzZh
YjEzNjA4NGYuLjU1YzVlMjkwNzMwYyAxMDA2NDQKLS0tIGEvYXJjaC94ODYva3ZtL2t2bWkuYwor
KysgYi9hcmNoL3g4Ni9rdm0va3ZtaS5jCkBAIC02NzIsMyArNjcyLDUxIEBAIHZvaWQga3ZtaV9h
cmNoX3NlbmRfdHJhcF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCiAJCWt2bWlfaGFuZGxl
X2NvbW1vbl9ldmVudF9hY3Rpb25zKHZjcHUtPmt2bSwgYWN0aW9uKTsKIAl9CiB9CisKK3N0YXRp
YyB1MzIga3ZtaV9zZW5kX3hzZXRidihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU4IHhjciwgdTY0
IG9sZF92YWx1ZSwKKwkJCSAgICB1NjQgbmV3X3ZhbHVlKQoreworCXN0cnVjdCBrdm1pX2V2ZW50
X3hzZXRidiBlOworCWludCBlcnIsIGFjdGlvbjsKKworCW1lbXNldCgmZSwgMCwgc2l6ZW9mKGUp
KTsKKwllLnhjciA9IHhjcjsKKwllLm9sZF92YWx1ZSA9IG9sZF92YWx1ZTsKKwllLm5ld192YWx1
ZSA9IG5ld192YWx1ZTsKKworCWVyciA9IGt2bWlfc2VuZF9ldmVudCh2Y3B1LCBLVk1JX0VWRU5U
X1hTRVRCViwgJmUsIHNpemVvZihlKSwKKwkJCSAgICAgIE5VTEwsIDAsICZhY3Rpb24pOworCWlm
IChlcnIpCisJCXJldHVybiBLVk1JX0VWRU5UX0FDVElPTl9DT05USU5VRTsKKworCXJldHVybiBh
Y3Rpb247Cit9CisKK3N0YXRpYyB2b2lkIF9fa3ZtaV94c2V0YnZfZXZlbnQoc3RydWN0IGt2bV92
Y3B1ICp2Y3B1LCB1OCB4Y3IsCisJCQkJdTY0IG9sZF92YWx1ZSwgdTY0IG5ld192YWx1ZSkKK3sK
Kwl1MzIgYWN0aW9uOworCisJYWN0aW9uID0ga3ZtaV9zZW5kX3hzZXRidih2Y3B1LCB4Y3IsIG9s
ZF92YWx1ZSwgbmV3X3ZhbHVlKTsKKwlzd2l0Y2ggKGFjdGlvbikgeworCWNhc2UgS1ZNSV9FVkVO
VF9BQ1RJT05fQ09OVElOVUU6CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCWt2bWlfaGFuZGxlX2Nv
bW1vbl9ldmVudF9hY3Rpb25zKHZjcHUtPmt2bSwgYWN0aW9uKTsKKwl9Cit9CisKK3ZvaWQga3Zt
aV94c2V0YnZfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1OCB4Y3IsCisJCSAgICAgICB1
NjQgb2xkX3ZhbHVlLCB1NjQgbmV3X3ZhbHVlKQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlv
biAqa3ZtaTsKKworCWt2bWkgPSBrdm1pX2dldCh2Y3B1LT5rdm0pOworCWlmICgha3ZtaSkKKwkJ
cmV0dXJuOworCisJaWYgKGlzX2V2ZW50X2VuYWJsZWQodmNwdSwgS1ZNSV9FVkVOVF9YU0VUQlYp
KQorCQlfX2t2bWlfeHNldGJ2X2V2ZW50KHZjcHUsIHhjciwgb2xkX3ZhbHVlLCBuZXdfdmFsdWUp
OworCisJa3ZtaV9wdXQodmNwdS0+a3ZtKTsKK30KZGlmZiAtLWdpdCBhL2FyY2gveDg2L2t2bS94
ODYuYyBiL2FyY2gveDg2L2t2bS94ODYuYwppbmRleCBhZjk4N2FkMWExNzQuLmMzNTU3YTExODE3
ZiAxMDA2NDQKLS0tIGEvYXJjaC94ODYva3ZtL3g4Ni5jCisrKyBiL2FyY2gveDg2L2t2bS94ODYu
YwpAQCAtOTE5LDYgKzkxOSwxMiBAQCBzdGF0aWMgaW50IF9fa3ZtX3NldF94Y3Ioc3RydWN0IGt2
bV92Y3B1ICp2Y3B1LCB1MzIgaW5kZXgsIHU2NCB4Y3IpCiAJfQogCXZjcHUtPmFyY2gueGNyMCA9
IHhjcjA7CiAKKyNpZmRlZiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04KKwlpZiAoaW5kZXggPT0g
MCAmJiB4Y3IwICE9IG9sZF94Y3IwKQorCQlrdm1pX3hzZXRidl9ldmVudCh2Y3B1LCAwLCBvbGRf
eGNyMCwgeGNyMCk7CisjZW5kaWYgLyogQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OICovCisKKwog
CWlmICgoeGNyMCBeIG9sZF94Y3IwKSAmIFhGRUFUVVJFX01BU0tfRVhURU5EKQogCQlrdm1fdXBk
YXRlX2NwdWlkKHZjcHUpOwogCXJldHVybiAwOwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xp
bnV4L2t2bWkuaCBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKaW5kZXggMmE0Y2M4YzQxNDY1
Li4zNDhhOWE1NTEwOTEgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKKysr
IGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaApAQCAtNDksNiArNDksNyBAQCBlbnVtIHsKIAlL
Vk1JX0VWRU5UX0JSRUFLUE9JTlQgPSAzLAogCUtWTUlfRVZFTlRfQ1IgICAgICAgICA9IDQsCiAJ
S1ZNSV9FVkVOVF9UUkFQICAgICAgID0gNSwKKwlLVk1JX0VWRU5UX1hTRVRCViAgICAgPSA2LAog
CiAJS1ZNSV9OVU1fRVZFTlRTCiB9OwpkaWZmIC0tZ2l0IGEvdG9vbHMvdGVzdGluZy9zZWxmdGVz
dHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94
ODZfNjQva3ZtaV90ZXN0LmMKaW5kZXggMTA1YWRmNzVhNjhkLi4wNTY5MTg1YTcwNjQgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKKysr
IGIvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYwpAQCAtMjIs
NiArMjIsOCBAQAogCiAjZGVmaW5lIFZDUFVfSUQgICAgICAgICA1CiAKKyNkZWZpbmUgWDg2X0ZF
QVRVUkVfWFNBVkUJKDE8PDI2KQorCiBzdGF0aWMgaW50IHNvY2tldF9wYWlyWzJdOwogI2RlZmlu
ZSBLdm1fc29ja2V0ICAgICAgIHNvY2tldF9wYWlyWzBdCiAjZGVmaW5lIFVzZXJzcGFjZV9zb2Nr
ZXQgc29ja2V0X3BhaXJbMV0KQEAgLTU0LDYgKzU2LDcgQEAgZW51bSB7CiAJR1VFU1RfVEVTVF9C
UCwKIAlHVUVTVF9URVNUX0NSLAogCUdVRVNUX1RFU1RfSFlQRVJDQUxMLAorCUdVRVNUX1RFU1Rf
WFNFVEJWLAogfTsKIAogI2RlZmluZSBHVUVTVF9SRVFVRVNUX1RFU1QoKSAgICAgR1VFU1RfU1lO
QygwKQpAQCAtODksNiArOTIsNDUgQEAgc3RhdGljIHZvaWQgZ3Vlc3RfaHlwZXJjYWxsX3Rlc3Qo
dm9pZCkKIAlhc20gdm9sYXRpbGUoIi5ieXRlIDB4MGYsMHgwMSwweGMxIik7CiB9CiAKKy8qIGZy
b20gZnB1L2ludGVybmFsLmggKi8KK3N0YXRpYyB1NjQgeGdldGJ2KHUzMiBpbmRleCkKK3sKKwl1
MzIgZWF4LCBlZHg7CisKKwlhc20gdm9sYXRpbGUoIi5ieXRlIDB4MGYsMHgwMSwweGQwIiAvKiB4
Z2V0YnYgKi8KKwkJICAgICA6ICI9YSIgKGVheCksICI9ZCIgKGVkeCkKKwkJICAgICA6ICJjIiAo
aW5kZXgpKTsKKwlyZXR1cm4gZWF4ICsgKCh1NjQpZWR4IDw8IDMyKTsKK30KKworLyogZnJvbSBm
cHUvaW50ZXJuYWwuaCAqLworc3RhdGljIHZvaWQgeHNldGJ2KHUzMiBpbmRleCwgdTY0IHZhbHVl
KQoreworCXUzMiBlYXggPSB2YWx1ZTsKKwl1MzIgZWR4ID0gdmFsdWUgPj4gMzI7CisKKwlhc20g
dm9sYXRpbGUoIi5ieXRlIDB4MGYsMHgwMSwweGQxIiAvKiB4c2V0YnYgKi8KKwkJICAgICA6IDog
ImEiIChlYXgpLCAiZCIgKGVkeCksICJjIiAoaW5kZXgpKTsKK30KKworc3RhdGljIHZvaWQgZ3Vl
c3RfeHNldGJ2X3Rlc3Qodm9pZCkKK3sKKwljb25zdCBpbnQgU1NFX0JJVCA9IDEgPDwgMTsKKwlj
b25zdCBpbnQgQVZYX0JJVCA9IDEgPDwgMjsKKwl1NjQgeGNyMDsKKworCS8qIGF2b2lkICNVRCAq
LworCXNldF9jcjQoZ2V0X2NyNCgpIHwgWDg2X0NSNF9PU1hTQVZFKTsKKworCXhjcjAgPSB4Z2V0
YnYoMCk7CisJaWYgKHhjcjAgJiBBVlhfQklUKQorCQl4Y3IwICY9IH5BVlhfQklUOworCWVsc2UK
KwkJeGNyMCB8PSAoQVZYX0JJVCB8IFNTRV9CSVQpOworCisJeHNldGJ2KDAsIHhjcjApOworfQor
CiBzdGF0aWMgdm9pZCBndWVzdF9jb2RlKHZvaWQpCiB7CiAJd2hpbGUgKHRydWUpIHsKQEAgLTEw
NCw2ICsxNDYsOSBAQCBzdGF0aWMgdm9pZCBndWVzdF9jb2RlKHZvaWQpCiAJCWNhc2UgR1VFU1Rf
VEVTVF9IWVBFUkNBTEw6CiAJCQlndWVzdF9oeXBlcmNhbGxfdGVzdCgpOwogCQkJYnJlYWs7CisJ
CWNhc2UgR1VFU1RfVEVTVF9YU0VUQlY6CisJCQlndWVzdF94c2V0YnZfdGVzdCgpOworCQkJYnJl
YWs7CiAJCX0KIAkJR1VFU1RfU0lHTkFMX1RFU1RfRE9ORSgpOwogCX0KQEAgLTE0MzEsNiArMTQ3
Niw0NCBAQCBzdGF0aWMgdm9pZCB0ZXN0X2NtZF92bV9nZXRfbWF4X2dmbih2b2lkKQogCXByX2lu
Zm8oIm1heF9nZm46IDB4JWxseFxuIiwgcnBsLmdmbik7CiB9CiAKK3N0YXRpYyB2b2lkIHRlc3Rf
ZXZlbnRfeHNldGJ2KHN0cnVjdCBrdm1fdm0gKnZtKQoreworCXN0cnVjdCB2Y3B1X3dvcmtlcl9k
YXRhIGRhdGEgPSB7CisJCS52bSA9IHZtLAorCQkudmNwdV9pZCA9IFZDUFVfSUQsCisJCS50ZXN0
X2lkID0gR1VFU1RfVEVTVF9YU0VUQlYsCisJfTsKKwlfX3UxNiBldmVudF9pZCA9IEtWTUlfRVZF
TlRfWFNFVEJWOworCXN0cnVjdCBrdm1fY3B1aWRfZW50cnkyICplbnRyeTsKKwlzdHJ1Y3QgdmNw
dV9yZXBseSBycGwgPSB7fTsKKwlzdHJ1Y3Qga3ZtaV9tc2dfaGRyIGhkcjsKKwlwdGhyZWFkX3Qg
dmNwdV90aHJlYWQ7CisJc3RydWN0IHsKKwkJc3RydWN0IGt2bWlfZXZlbnQgY29tbW9uOworCQlz
dHJ1Y3Qga3ZtaV9ldmVudF94c2V0YnYgeHNldGJ2OworCX0gZXY7CisKKwllbnRyeSA9IGt2bV9n
ZXRfc3VwcG9ydGVkX2NwdWlkX2VudHJ5KDEpOworCWlmICghKGVudHJ5LT5lY3ggJiBYODZfRkVB
VFVSRV9YU0FWRSkpIHsKKwkJcHJpbnRfc2tpcCgiWFNBVkUgbm90IHN1cHBvcnRlZCwgZWN4IDB4
JXgiLCBlbnRyeS0+ZWN4KTsKKwkJcmV0dXJuOworCX0KKworCWVuYWJsZV92Y3B1X2V2ZW50KHZt
LCBldmVudF9pZCk7CisJdmNwdV90aHJlYWQgPSBzdGFydF92Y3B1X3dvcmtlcigmZGF0YSk7CisK
KwlyZWNlaXZlX2V2ZW50KCZoZHIsICZldi5jb21tb24sIHNpemVvZihldiksIGV2ZW50X2lkKTsK
KworCXByX2RlYnVnKCJYU0VUQlYgZXZlbnQsIFhDUiV1LCBvbGQgMHglbGx4LCBuZXcgMHglbGx4
XG4iLAorCQkgZXYueHNldGJ2LnhjciwgZXYueHNldGJ2Lm9sZF92YWx1ZSwgZXYueHNldGJ2Lm5l
d192YWx1ZSk7CisKKwlyZXBseV90b19ldmVudCgmaGRyLCAmZXYuY29tbW9uLCBLVk1JX0VWRU5U
X0FDVElPTl9DT05USU5VRSwKKwkJCSZycGwsIHNpemVvZihycGwpKTsKKworCXN0b3BfdmNwdV93
b3JrZXIodmNwdV90aHJlYWQsICZkYXRhKTsKKwlkaXNhYmxlX3ZjcHVfZXZlbnQodm0sIGV2ZW50
X2lkKTsKK30KKwogc3RhdGljIHZvaWQgdGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0g
KnZtKQogewogCXNyYW5kb20odGltZSgwKSk7CkBAIC0xNDU3LDYgKzE1NDAsNyBAQCBzdGF0aWMg
dm9pZCB0ZXN0X2ludHJvc3BlY3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCiAJdGVzdF9jbWRfdmNw
dV9jb250cm9sX2NyKHZtKTsKIAl0ZXN0X2NtZF92Y3B1X2luamVjdF9leGNlcHRpb24odm0pOwog
CXRlc3RfY21kX3ZtX2dldF9tYXhfZ2ZuKCk7CisJdGVzdF9ldmVudF94c2V0YnYodm0pOwogCiAJ
dW5ob29rX2ludHJvc3BlY3Rpb24odm0pOwogfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9z
cGVjdGlvbi9rdm1pLmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwppbmRleCBkNGIz
OWQwODAwZWUuLjc2MWQzZmNjZGRjZSAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlv
bi9rdm1pLmMKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKQEAgLTEwMiw2ICsx
MDIsNyBAQCBzdGF0aWMgdm9pZCBzZXR1cF9rbm93bl9ldmVudHModm9pZCkKIAlzZXRfYml0KEtW
TUlfRVZFTlRfSFlQRVJDQUxMLCBLdm1pX2tub3duX3ZjcHVfZXZlbnRzKTsKIAlzZXRfYml0KEtW
TUlfRVZFTlRfUEFVU0VfVkNQVSwgS3ZtaV9rbm93bl92Y3B1X2V2ZW50cyk7CiAJc2V0X2JpdChL
Vk1JX0VWRU5UX1RSQVAsIEt2bWlfa25vd25fdmNwdV9ldmVudHMpOworCXNldF9iaXQoS1ZNSV9F
VkVOVF9YU0VUQlYsIEt2bWlfa25vd25fdmNwdV9ldmVudHMpOwogCiAJYml0bWFwX29yKEt2bWlf
a25vd25fZXZlbnRzLCBLdm1pX2tub3duX3ZtX2V2ZW50cywKIAkJICBLdm1pX2tub3duX3ZjcHVf
ZXZlbnRzLCBLVk1JX05VTV9FVkVOVFMpOwpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmlydHVhbGl6YXRp
b25AbGlzdHMubGludXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51eGZvdW5kYXRp
b24ub3JnL21haWxtYW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
