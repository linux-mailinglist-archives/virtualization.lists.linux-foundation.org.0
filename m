Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
	by mail.lfdr.de (Postfix) with ESMTPS id 5130F155DEB
	for <lists.virtualization@lfdr.de>; Fri,  7 Feb 2020 19:26:00 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by silver.osuosl.org (Postfix) with ESMTP id DE23220487;
	Fri,  7 Feb 2020 18:25:58 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id RGc37ZR66k3b; Fri,  7 Feb 2020 18:25:54 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by silver.osuosl.org (Postfix) with ESMTP id 2BD0722618;
	Fri,  7 Feb 2020 18:25:54 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 1972FC013E;
	Fri,  7 Feb 2020 18:25:54 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 27671C013E
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:52 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by hemlock.osuosl.org (Postfix) with ESMTP id 1193F87ED0
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:52 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id e2FGWMoqOSEM
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:51 +0000 (UTC)
X-Greylist: delayed 00:09:10 by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by hemlock.osuosl.org (Postfix) with ESMTPS id 7F68087EC4
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:51 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 E977F305D368; Fri,  7 Feb 2020 20:16:41 +0200 (EET)
Received: from host.bbu.bitdefender.biz (unknown [195.210.4.22])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id DCEC93052077;
 Fri,  7 Feb 2020 20:16:41 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [RFC PATCH v7 74/78] KVM: introspection: add
 KVMI_VCPU_CONTROL_SINGLESTEP
Date: Fri,  7 Feb 2020 20:16:32 +0200
Message-Id: <20200207181636.1065-75-alazar@bitdefender.com>
In-Reply-To: <20200207181636.1065-1-alazar@bitdefender.com>
References: <20200207181636.1065-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <ncitu@bitdefender.com>,
 Sean Christopherson <sean.j.christopherson@intel.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTmljdciZb3IgQ8OuyJt1IDxuY2l0dUBiaXRkZWZlbmRlci5jb20+CgpUaGlzIGNvbW1h
bmQgaXMgZXh0cmVtZWx5IHVzZWZ1bCBmb3IgZGVidWdnZXJzLgoKU2lnbmVkLW9mZi1ieTogTmlj
dciZb3IgQ8OuyJt1IDxuY2l0dUBiaXRkZWZlbmRlci5jb20+CkNvLWRldmVsb3BlZC1ieTogQWRh
bGJlcnQgTGF6xINyIDxhbGF6YXJAYml0ZGVmZW5kZXIuY29tPgpTaWduZWQtb2ZmLWJ5OiBBZGFs
YmVydCBMYXrEg3IgPGFsYXphckBiaXRkZWZlbmRlci5jb20+Ci0tLQogRG9jdW1lbnRhdGlvbi92
aXJ0L2t2bS9rdm1pLnJzdCAgICAgICAgICAgICAgIHwgMzEgKysrKysrCiBhcmNoL3g4Ni9rdm0v
a3ZtaS5jICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAxOCArKysrCiBhcmNoL3g4Ni9rdm0v
eDg2LmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgNyArKwogaW5jbHVkZS9saW51eC9r
dm1pX2hvc3QuaCAgICAgICAgICAgICAgICAgICAgIHwgIDcgKysKIGluY2x1ZGUvdWFwaS9saW51
eC9rdm1pLmggICAgICAgICAgICAgICAgICAgICB8ICA3ICsrCiAuLi4vdGVzdGluZy9zZWxmdGVz
dHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyAgfCAyMSArKysrKwogdmlydC9rdm0vaW50cm9zcGVj
dGlvbi9rdm1pLmMgICAgICAgICAgICAgICAgIHwgMjMgKysrKysKIHZpcnQva3ZtL2ludHJvc3Bl
Y3Rpb24va3ZtaV9pbnQuaCAgICAgICAgICAgICB8ICAzICsKIHZpcnQva3ZtL2ludHJvc3BlY3Rp
b24va3ZtaV9tc2cuYyAgICAgICAgICAgICB8IDk0ICsrKysrKysrKysrKy0tLS0tLS0KIDkgZmls
ZXMgY2hhbmdlZCwgMTc5IGluc2VydGlvbnMoKyksIDMyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdp
dCBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QgYi9Eb2N1bWVudGF0aW9uL3ZpcnQv
a3ZtL2t2bWkucnN0CmluZGV4IDQ1NGQ3YWU3NWFlNi4uZmZhMTgzNzQ1NzIyIDEwMDY0NAotLS0g
YS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CisrKyBiL0RvY3VtZW50YXRpb24vdmly
dC9rdm0va3ZtaS5yc3QKQEAgLTkzMCw2ICs5MzAsMzcgQEAgSW4gb3JkZXIgdG8gJ2ZvcmdldCcg
YW4gYWRkcmVzcywgYWxsIHRoZSBhY2Nlc3MgYml0cyAoJ3J3eCcpIG11c3QgYmUgc2V0LgogKiAt
S1ZNX0VJTlZBTCAtIHRoZSBtZXNzYWdlIHNpemUgaXMgaW52YWxpZAogKiAtS1ZNX0VOT01FTSAt
IG5vdCBlbm91Z2ggbWVtb3J5IHRvIGFkZCB0aGUgcGFnZSB0cmFja2luZyBzdHJ1Y3R1cmVzCiAK
KzIwLiBLVk1JX1ZDUFVfQ09OVFJPTF9TSU5HTEVTVEVQCistLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLQorCis6QXJjaGl0ZWN0dXJlczogeDg2ICh2bXgpCis6VmVyc2lvbnM6ID49IDEK
KzpQYXJhbWV0ZXJzOgorCis6OgorCisJc3RydWN0IGt2bWlfdmNwdV9jb250cm9sX3NpbmdsZXN0
ZXAgeworCQlfX3U4IGVuYWJsZTsKKwkJX191OCBwYWRkaW5nWzddOworCX07CisKKzpSZXR1cm5z
OgorCis6OgorCisJc3RydWN0IGt2bWlfZXJyb3JfY29kZQorCitFbmFibGVzL2Rpc2FibGVzIHNp
bmdsZXN0ZXAuCisKK1RoZSBpbnRyb3NwZWN0aW9uIHRvb2wgY2FuIHVzZSAqS1ZNSV9HRVRfVkVS
U0lPTiosIHRvIGNoZWNrCitpZiB0aGUgaGFyZHdhcmUgc3VwcG9ydHMgc2luZ2xlc3RlcCAoc2Vl
ICoqS1ZNSV9HRVRfVkVSU0lPTioqKS4KKworOkVycm9yczoKKworKiAtS1ZNX0VPUE5PVFNVUFAg
LSB0aGUgaGFyZHdhcmUgZG9lc24ndCBzdXBwb3J0IGl0CisqIC1LVk1fRUlOVkFMIC0gcGFkZGlu
ZyBpcyBub3QgemVybworKiAtS1ZNX0VBR0FJTiAtIHRoZSBzZWxlY3RlZCB2Q1BVIGNhbid0IGJl
IGludHJvc3BlY3RlZCB5ZXQKKwogRXZlbnRzCiA9PT09PT0KIApkaWZmIC0tZ2l0IGEvYXJjaC94
ODYva3ZtL2t2bWkuYyBiL2FyY2gveDg2L2t2bS9rdm1pLmMKaW5kZXggNWNmMjY2ZDEzMzc1Li5m
ZWViYjAzMjdlMjcgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS9rdm1pLmMKKysrIGIvYXJjaC94
ODYva3ZtL2t2bWkuYwpAQCAtMTExMSwzICsxMTExLDIxIEBAIGJvb2wga3ZtaV9hcmNoX3BmX29m
X2ludGVyZXN0KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKIAkgICAgICAha3ZtX3g4Nl9vcHMtPmdw
dF90cmFuc2xhdGlvbl9mYXVsdCh2Y3B1KTsKIH0KIAorYm9vbCBrdm1pX2FyY2hfc3RhcnRfc2lu
Z2xlc3RlcChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCit7CisJaWYgKCFrdm1feDg2X29wcy0+Y29u
dHJvbF9zaW5nbGVzdGVwKQorCQlyZXR1cm4gZmFsc2U7CisKKwlrdm1feDg2X29wcy0+Y29udHJv
bF9zaW5nbGVzdGVwKHZjcHUsIHRydWUpOworCXJldHVybiB0cnVlOworfQorCitib29sIGt2bWlf
YXJjaF9zdG9wX3NpbmdsZXN0ZXAoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQoreworCWlmICgha3Zt
X3g4Nl9vcHMtPmNvbnRyb2xfc2luZ2xlc3RlcCkKKwkJcmV0dXJuIGZhbHNlOworCisJa3ZtX3g4
Nl9vcHMtPmNvbnRyb2xfc2luZ2xlc3RlcCh2Y3B1LCBmYWxzZSk7CisJcmV0dXJuIHRydWU7Cit9
CisKZGlmZiAtLWdpdCBhL2FyY2gveDg2L2t2bS94ODYuYyBiL2FyY2gveDg2L2t2bS94ODYuYwpp
bmRleCA1ZDZhYzZjOTkyNDYuLmI4N2ZmMzFjZTQ4NiAxMDA2NDQKLS0tIGEvYXJjaC94ODYva3Zt
L3g4Ni5jCisrKyBiL2FyY2gveDg2L2t2bS94ODYuYwpAQCAtNzYyNSw2ICs3NjI1LDEzIEBAIHN0
YXRpYyBpbnQgaW5qZWN0X3BlbmRpbmdfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBib29s
IHJlcV9pbnRfd2luKQogewogCWludCByOwogCisJaWYgKGt2bWlfdmNwdV9ydW5uaW5nX3Npbmds
ZXN0ZXAodmNwdSkpCisJCS8qCisJCSAqIFdlIGNhbm5vdCBpbmplY3QgZXZlbnRzIGR1cmluZyBz
aW5nbGUtc3RlcHBpbmcuCisJCSAqIFRyeSBhZ2FpbiBsYXRlci4KKwkJICovCisJCXJldHVybiAt
MTsKKwogCS8qIHRyeSB0byByZWluamVjdCBwcmV2aW91cyBldmVudHMgaWYgYW55ICovCiAKIAlp
ZiAodmNwdS0+YXJjaC5leGNlcHRpb24uaW5qZWN0ZWQpCmRpZmYgLS1naXQgYS9pbmNsdWRlL2xp
bnV4L2t2bWlfaG9zdC5oIGIvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaAppbmRleCBhOWY1NzJk
ZjE4MDkuLjdjODRjYTY4MTQxMSAxMDA2NDQKLS0tIGEvaW5jbHVkZS9saW51eC9rdm1pX2hvc3Qu
aAorKysgYi9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oCkBAIC01MCw2ICs1MCwxMCBAQCBzdHJ1
Y3Qga3ZtX3ZjcHVfaW50cm9zcGVjdGlvbiB7CiAJCWJvb2wgcGVuZGluZzsKIAkJYm9vbCBzZW5k
X2V2ZW50OwogCX0gZXhjZXB0aW9uOworCisJc3RydWN0IHsKKwkJYm9vbCBsb29wOworCX0gc2lu
Z2xlc3RlcDsKIH07CiAKIHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiB7CkBAIC05MCw2ICs5NCw3
IEBAIHZvaWQga3ZtaV9oYW5kbGVfcmVxdWVzdHMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIGJv
b2wga3ZtaV9oeXBlcmNhbGxfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIGJvb2wga3Zt
aV9icmVha3BvaW50X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTY0IGd2YSwgdTggaW5z
bl9sZW4pOwogYm9vbCBrdm1pX2VudGVyX2d1ZXN0KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7Citi
b29sIGt2bWlfdmNwdV9ydW5uaW5nX3NpbmdsZXN0ZXAoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsK
IAogI2Vsc2UKIApAQCAtMTA2LDYgKzExMSw4IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBrdm1pX2Jy
ZWFrcG9pbnRfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1NjQgZ3ZhLAogCQkJeyByZXR1
cm4gdHJ1ZTsgfQogc3RhdGljIGlubGluZSBib29sIGt2bWlfZW50ZXJfZ3Vlc3Qoc3RydWN0IGt2
bV92Y3B1ICp2Y3B1KQogCQkJeyByZXR1cm4gdHJ1ZTsgfQorc3RhdGljIGlubGluZSBib29sIGt2
bWlfdmNwdV9ydW5uaW5nX3NpbmdsZXN0ZXAoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQorCQkJeyBy
ZXR1cm4gZmFsc2U7IH0KIAogI2VuZGlmIC8qIENPTkZJR19LVk1fSU5UUk9TUEVDVElPTiAqLwog
CmRpZmYgLS1naXQgYS9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oIGIvaW5jbHVkZS91YXBpL2xp
bnV4L2t2bWkuaAppbmRleCA3Y2Q0MWE4MTU5NjcuLmM2YzUwMTljY2Y4NSAxMDA2NDQKLS0tIGEv
aW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaAorKysgYi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5o
CkBAIC00Myw2ICs0Myw4IEBAIGVudW0gewogCiAJS1ZNSV9WTV9TRVRfUEFHRV9BQ0NFU1MgPSAy
MSwKIAorCUtWTUlfVkNQVV9DT05UUk9MX1NJTkdMRVNURVAgPSAyMiwKKwogCUtWTUlfTlVNX01F
U1NBR0VTCiB9OwogCkBAIC0xNjgsNiArMTcwLDExIEBAIHN0cnVjdCBrdm1pX3ZtX3NldF9wYWdl
X2FjY2VzcyB7CiAJc3RydWN0IGt2bWlfcGFnZV9hY2Nlc3NfZW50cnkgZW50cmllc1swXTsKIH07
CiAKK3N0cnVjdCBrdm1pX3ZjcHVfY29udHJvbF9zaW5nbGVzdGVwIHsKKwlfX3U4IGVuYWJsZTsK
KwlfX3U4IHBhZGRpbmdbN107Cit9OworCiBzdHJ1Y3Qga3ZtaV9ldmVudCB7CiAJX191MTYgc2l6
ZTsKIAlfX3UxNiB2Y3B1OwpkaWZmIC0tZ2l0IGEvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3Zt
L3g4Nl82NC9rdm1pX3Rlc3QuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQv
a3ZtaV90ZXN0LmMKaW5kZXggYTI3NTg4YzI3ZWI4Li4wOTBjYjdhY2QyZWQgMTAwNjQ0Ci0tLSBh
L3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKKysrIGIvdG9v
bHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYwpAQCAtMTY4MSw2ICsx
NjgxLDI2IEBAIHN0YXRpYyB2b2lkIHRlc3RfZXZlbnRfcGYoc3RydWN0IGt2bV92bSAqdm0pCiAJ
dGVzdF9wZih2bSwgY2JrX3Rlc3RfZXZlbnRfcGYpOwogfQogCitzdGF0aWMgdm9pZCB0ZXN0X2Nt
ZF92Y3B1X2NvbnRyb2xfc2luZ2xlc3RlcChzdHJ1Y3Qga3ZtX3ZtICp2bSkKK3sKKwlzdHJ1Y3Qg
eworCQlzdHJ1Y3Qga3ZtaV9tc2dfaGRyIGhkcjsKKwkJc3RydWN0IGt2bWlfdmNwdV9oZHIgdmNw
dV9oZHI7CisJCXN0cnVjdCBrdm1pX3ZjcHVfY29udHJvbF9zaW5nbGVzdGVwIGNtZDsKKwl9IHJl
cSA9IHt9OworCisJaWYgKCFmZWF0dXJlcy5zaW5nbGVzdGVwKQorCQlyZXR1cm47CisKKwlyZXEu
Y21kLmVuYWJsZSA9IHRydWU7CisJdGVzdF92Y3B1MF9jb21tYW5kKHZtLCBLVk1JX1ZDUFVfQ09O
VFJPTF9TSU5HTEVTVEVQLAorCQkJICAgJnJlcS5oZHIsIHNpemVvZihyZXEpLCBOVUxMLCAwKTsK
KworCXJlcS5jbWQuZW5hYmxlID0gZmFsc2U7CisJdGVzdF92Y3B1MF9jb21tYW5kKHZtLCBLVk1J
X1ZDUFVfQ09OVFJPTF9TSU5HTEVTVEVQLAorCQkJICAgJnJlcS5oZHIsIHNpemVvZihyZXEpLCBO
VUxMLCAwKTsKK30KKwogc3RhdGljIHZvaWQgdGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1f
dm0gKnZtKQogewogCXNldHVwX3NvY2tldCgpOwpAQCAtMTcxMiw2ICsxNzMyLDcgQEAgc3RhdGlj
IHZvaWQgdGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQogCXRlc3RfY21kX3Zj
cHVfY29udHJvbF9tc3Iodm0pOwogCXRlc3RfY21kX3ZtX3NldF9wYWdlX2FjY2Vzcyh2bSk7CiAJ
dGVzdF9ldmVudF9wZih2bSk7CisJdGVzdF9jbWRfdmNwdV9jb250cm9sX3NpbmdsZXN0ZXAodm0p
OwogCiAJdW5ob29rX2ludHJvc3BlY3Rpb24odm0pOwogfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0v
aW50cm9zcGVjdGlvbi9rdm1pLmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwppbmRl
eCAxMGQ1OTA2MWZhODIuLmI3OThlZWFiNjYxOCAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9z
cGVjdGlvbi9rdm1pLmMKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKQEAgLTM2
MSw2ICszNjEsOSBAQCBzdGF0aWMgdm9pZCBrdm1pX2pvYl9yZWxlYXNlX3ZjcHUoc3RydWN0IGt2
bV92Y3B1ICp2Y3B1LCB2b2lkICpjdHgpCiAKIAlhdG9taWNfc2V0KCZ2Y3B1aS0+cGF1c2VfcmVx
dWVzdHMsIDApOwogCXZjcHVpLT53YWl0aW5nX2Zvcl9yZXBseSA9IGZhbHNlOworCisJaWYgKHZj
cHVpLT5zaW5nbGVzdGVwLmxvb3ApCisJCWt2bWlfYXJjaF9zdG9wX3NpbmdsZXN0ZXAodmNwdSk7
CiB9CiAKIHN0YXRpYyB2b2lkIGt2bWlfcmVsZWFzZV92Y3B1cyhzdHJ1Y3Qga3ZtICprdm0pCkBA
IC0xMDAzLDYgKzEwMDYsOSBAQCBib29sIGt2bWlfZW50ZXJfZ3Vlc3Qoc3RydWN0IGt2bV92Y3B1
ICp2Y3B1KQogCWlmICgha3ZtaSkKIAkJcmV0dXJuIHRydWU7CiAKKwlpZiAoVkNQVUkodmNwdSkt
PnNpbmdsZXN0ZXAubG9vcCkKKwkJa3ZtaV9hcmNoX3N0YXJ0X3NpbmdsZXN0ZXAodmNwdSk7CisK
IAlpZiAoa3ZtaV9pbmplY3RfcGVuZGluZ19leGNlcHRpb24odmNwdSkpCiAJCXIgPSBmYWxzZTsK
IApAQCAtMTI5NiwzICsxMzAyLDIwIEBAIHN0YXRpYyB2b2lkIGt2bWlfdHJhY2tfZmx1c2hfc2xv
dChzdHJ1Y3Qga3ZtICprdm0sIHN0cnVjdCBrdm1fbWVtb3J5X3Nsb3QgKnNsb3QsCiAKIAlrdm1p
X3B1dChrdm0pOwogfQorCitib29sIGt2bWlfdmNwdV9ydW5uaW5nX3NpbmdsZXN0ZXAoc3RydWN0
IGt2bV92Y3B1ICp2Y3B1KQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaTsKKwli
b29sIHJldDsKKworCWt2bWkgPSBrdm1pX2dldCh2Y3B1LT5rdm0pOworCWlmICgha3ZtaSkKKwkJ
cmV0dXJuIGZhbHNlOworCisJcmV0ID0gVkNQVUkodmNwdSktPnNpbmdsZXN0ZXAubG9vcDsKKwor
CWt2bWlfcHV0KHZjcHUtPmt2bSk7CisKKwlyZXR1cm4gcmV0OworfQorRVhQT1JUX1NZTUJPTChr
dm1pX3ZjcHVfcnVubmluZ19zaW5nbGVzdGVwKTsKZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJv
c3BlY3Rpb24va3ZtaV9pbnQuaCBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaApp
bmRleCAwNmI5MjQyNzdmMzcuLjY0NDI1ZmYxNmM3ZCAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50
cm9zcGVjdGlvbi9rdm1pX2ludC5oCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9p
bnQuaApAQCAtNTAsNiArNTAsNyBAQAogCQkJfCBCSVQoS1ZNSV9WQ1BVX0NPTlRST0xfQ1IpIFwK
IAkJCXwgQklUKEtWTUlfVkNQVV9DT05UUk9MX0VWRU5UUykgXAogCQkJfCBCSVQoS1ZNSV9WQ1BV
X0NPTlRST0xfTVNSKSBcCisJCQl8IEJJVChLVk1JX1ZDUFVfQ09OVFJPTF9TSU5HTEVTVEVQKSBc
CiAJCQl8IEJJVChLVk1JX1ZDUFVfR0VUX0NQVUlEKSBcCiAJCQl8IEJJVChLVk1JX1ZDUFVfR0VU
X01UUlJfVFlQRSkgXAogCQkJfCBCSVQoS1ZNSV9WQ1BVX0dFVF9SRUdJU1RFUlMpIFwKQEAgLTE2
OCw1ICsxNjksNyBAQCBib29sIGt2bWlfYXJjaF9wZl9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZj
cHUsIGdwYV90IGdwYSwgZ3ZhX3QgZ3ZhLAogCQkJdTggYWNjZXNzKTsKIGJvb2wga3ZtaV9hcmNo
X3BmX29mX2ludGVyZXN0KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7CiB2b2lkIGt2bWlfYXJjaF9m
ZWF0dXJlcyhzdHJ1Y3Qga3ZtaV9mZWF0dXJlcyAqZmVhdCk7Citib29sIGt2bWlfYXJjaF9zdGFy
dF9zaW5nbGVzdGVwKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7Citib29sIGt2bWlfYXJjaF9zdG9w
X3NpbmdsZXN0ZXAoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIAogI2VuZGlmCmRpZmYgLS1naXQg
YS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0
aW9uL2t2bWlfbXNnLmMKaW5kZXggOGM3Y2RiZDk2ZmFhLi40YzQ5MDMzYTY0MDcgMTAwNjQ0Ci0t
LSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYworKysgYi92aXJ0L2t2bS9pbnRy
b3NwZWN0aW9uL2t2bWlfbXNnLmMKQEAgLTE3LDI3ICsxNywyOCBAQCBzdHJ1Y3Qga3ZtaV92Y3B1
X2NtZF9qb2IgewogfTsKIAogc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IG1zZ19JRHNbXSA9IHsK
LQlbS1ZNSV9FVkVOVF9SRVBMWV0gICAgICAgICAgID0gIktWTUlfRVZFTlRfUkVQTFkiLAotCVtL
Vk1JX0dFVF9WRVJTSU9OXSAgICAgICAgICAgPSAiS1ZNSV9HRVRfVkVSU0lPTiIsCi0JW0tWTUlf
Vk1fQ0hFQ0tfQ09NTUFORF0gICAgICA9ICJLVk1JX1ZNX0NIRUNLX0NPTU1BTkQiLAotCVtLVk1J
X1ZNX0NIRUNLX0VWRU5UXSAgICAgICAgPSAiS1ZNSV9WTV9DSEVDS19FVkVOVCIsCi0JW0tWTUlf
Vk1fQ09OVFJPTF9FVkVOVFNdICAgICA9ICJLVk1JX1ZNX0NPTlRST0xfRVZFTlRTIiwKLQlbS1ZN
SV9WTV9HRVRfSU5GT10gICAgICAgICAgID0gIktWTUlfVk1fR0VUX0lORk8iLAotCVtLVk1JX1ZN
X0dFVF9NQVhfR0ZOXSAgICAgICAgPSAiS1ZNSV9WTV9HRVRfTUFYX0dGTiIsCi0JW0tWTUlfVk1f
UkVBRF9QSFlTSUNBTF0gICAgICA9ICJLVk1JX1ZNX1JFQURfUEhZU0lDQUwiLAotCVtLVk1JX1ZN
X1NFVF9QQUdFX0FDQ0VTU10gICAgPSAiS1ZNSV9WTV9TRVRfUEFHRV9BQ0NFU1MiLAotCVtLVk1J
X1ZNX1dSSVRFX1BIWVNJQ0FMXSAgICAgPSAiS1ZNSV9WTV9XUklURV9QSFlTSUNBTCIsCi0JW0tW
TUlfVkNQVV9DT05UUk9MX0NSXSAgICAgICA9ICJLVk1JX1ZDUFVfQ09OVFJPTF9DUiIsCi0JW0tW
TUlfVkNQVV9DT05UUk9MX0VWRU5UU10gICA9ICJLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMiLAot
CVtLVk1JX1ZDUFVfQ09OVFJPTF9NU1JdICAgICAgPSAiS1ZNSV9WQ1BVX0NPTlRST0xfTVNSIiwK
LQlbS1ZNSV9WQ1BVX0dFVF9DUFVJRF0gICAgICAgID0gIktWTUlfVkNQVV9HRVRfQ1BVSUQiLAot
CVtLVk1JX1ZDUFVfR0VUX0lORk9dICAgICAgICAgPSAiS1ZNSV9WQ1BVX0dFVF9JTkZPIiwKLQlb
S1ZNSV9WQ1BVX0dFVF9NVFJSX1RZUEVdICAgID0gIktWTUlfVkNQVV9HRVRfTVRSUl9UWVBFIiwK
LQlbS1ZNSV9WQ1BVX0dFVF9SRUdJU1RFUlNdICAgID0gIktWTUlfVkNQVV9HRVRfUkVHSVNURVJT
IiwKLQlbS1ZNSV9WQ1BVX0dFVF9YU0FWRV0gICAgICAgID0gIktWTUlfVkNQVV9HRVRfWFNBVkUi
LAotCVtLVk1JX1ZDUFVfSU5KRUNUX0VYQ0VQVElPTl0gPSAiS1ZNSV9WQ1BVX0lOSkVDVF9FWENF
UFRJT04iLAotCVtLVk1JX1ZDUFVfUEFVU0VdICAgICAgICAgICAgPSAiS1ZNSV9WQ1BVX1BBVVNF
IiwKLQlbS1ZNSV9WQ1BVX1NFVF9SRUdJU1RFUlNdICAgID0gIktWTUlfVkNQVV9TRVRfUkVHSVNU
RVJTIiwKKwlbS1ZNSV9FVkVOVF9SRVBMWV0gICAgICAgICAgICAgPSAiS1ZNSV9FVkVOVF9SRVBM
WSIsCisJW0tWTUlfR0VUX1ZFUlNJT05dICAgICAgICAgICAgID0gIktWTUlfR0VUX1ZFUlNJT04i
LAorCVtLVk1JX1ZNX0NIRUNLX0NPTU1BTkRdICAgICAgICA9ICJLVk1JX1ZNX0NIRUNLX0NPTU1B
TkQiLAorCVtLVk1JX1ZNX0NIRUNLX0VWRU5UXSAgICAgICAgICA9ICJLVk1JX1ZNX0NIRUNLX0VW
RU5UIiwKKwlbS1ZNSV9WTV9DT05UUk9MX0VWRU5UU10gICAgICAgPSAiS1ZNSV9WTV9DT05UUk9M
X0VWRU5UUyIsCisJW0tWTUlfVk1fR0VUX0lORk9dICAgICAgICAgICAgID0gIktWTUlfVk1fR0VU
X0lORk8iLAorCVtLVk1JX1ZNX0dFVF9NQVhfR0ZOXSAgICAgICAgICA9ICJLVk1JX1ZNX0dFVF9N
QVhfR0ZOIiwKKwlbS1ZNSV9WTV9SRUFEX1BIWVNJQ0FMXSAgICAgICAgPSAiS1ZNSV9WTV9SRUFE
X1BIWVNJQ0FMIiwKKwlbS1ZNSV9WTV9TRVRfUEFHRV9BQ0NFU1NdICAgICAgPSAiS1ZNSV9WTV9T
RVRfUEFHRV9BQ0NFU1MiLAorCVtLVk1JX1ZNX1dSSVRFX1BIWVNJQ0FMXSAgICAgICA9ICJLVk1J
X1ZNX1dSSVRFX1BIWVNJQ0FMIiwKKwlbS1ZNSV9WQ1BVX0NPTlRST0xfQ1JdICAgICAgICAgPSAi
S1ZNSV9WQ1BVX0NPTlRST0xfQ1IiLAorCVtLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFNdICAgICA9
ICJLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMiLAorCVtLVk1JX1ZDUFVfQ09OVFJPTF9NU1JdICAg
ICAgICA9ICJLVk1JX1ZDUFVfQ09OVFJPTF9NU1IiLAorCVtLVk1JX1ZDUFVfQ09OVFJPTF9TSU5H
TEVTVEVQXSA9ICJLVk1JX1ZDUFVfQ09OVFJPTF9TSU5HTEVTVEVQIiwKKwlbS1ZNSV9WQ1BVX0dF
VF9DUFVJRF0gICAgICAgICAgPSAiS1ZNSV9WQ1BVX0dFVF9DUFVJRCIsCisJW0tWTUlfVkNQVV9H
RVRfSU5GT10gICAgICAgICAgID0gIktWTUlfVkNQVV9HRVRfSU5GTyIsCisJW0tWTUlfVkNQVV9H
RVRfTVRSUl9UWVBFXSAgICAgID0gIktWTUlfVkNQVV9HRVRfTVRSUl9UWVBFIiwKKwlbS1ZNSV9W
Q1BVX0dFVF9SRUdJU1RFUlNdICAgICAgPSAiS1ZNSV9WQ1BVX0dFVF9SRUdJU1RFUlMiLAorCVtL
Vk1JX1ZDUFVfR0VUX1hTQVZFXSAgICAgICAgICA9ICJLVk1JX1ZDUFVfR0VUX1hTQVZFIiwKKwlb
S1ZNSV9WQ1BVX0lOSkVDVF9FWENFUFRJT05dICAgPSAiS1ZNSV9WQ1BVX0lOSkVDVF9FWENFUFRJ
T04iLAorCVtLVk1JX1ZDUFVfUEFVU0VdICAgICAgICAgICAgICA9ICJLVk1JX1ZDUFVfUEFVU0Ui
LAorCVtLVk1JX1ZDUFVfU0VUX1JFR0lTVEVSU10gICAgICA9ICJLVk1JX1ZDUFVfU0VUX1JFR0lT
VEVSUyIsCiB9OwogCiBzdGF0aWMgYm9vbCBpc19rbm93bl9tZXNzYWdlKHUxNiBpZCkKQEAgLTU4
NSw2ICs1ODYsMzQgQEAgc3RhdGljIGludCBoYW5kbGVfdmNwdV9jb250cm9sX21zcihjb25zdCBz
dHJ1Y3Qga3ZtaV92Y3B1X2NtZF9qb2IgKmpvYiwKIAlyZXR1cm4ga3ZtaV9tc2dfdmNwdV9yZXBs
eShqb2IsIG1zZywgZWMsIE5VTEwsIDApOwogfQogCitzdGF0aWMgaW50IGhhbmRsZV92Y3B1X2Nv
bnRyb2xfc2luZ2xlc3RlcChjb25zdCBzdHJ1Y3Qga3ZtaV92Y3B1X2NtZF9qb2IgKmpvYiwKKwkJ
CQkJICBjb25zdCBzdHJ1Y3Qga3ZtaV9tc2dfaGRyICptc2csCisJCQkJCSAgY29uc3Qgdm9pZCAq
X3JlcSkKK3sKKwljb25zdCBzdHJ1Y3Qga3ZtaV92Y3B1X2NvbnRyb2xfc2luZ2xlc3RlcCAqcmVx
ID0gX3JlcTsKKwlzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUgPSBqb2ItPnZjcHU7CisJaW50IGVjID0g
LUtWTV9FSU5WQUw7CisJYm9vbCBkb25lOworCWludCBpOworCisJZm9yIChpID0gMDsgaSA8IHNp
emVvZihyZXEtPnBhZGRpbmcpOyBpKyspCisJCWlmIChyZXEtPnBhZGRpbmdbaV0pCisJCQlnb3Rv
IHJlcGx5OworCisJaWYgKHJlcS0+ZW5hYmxlKQorCQlkb25lID0ga3ZtaV9hcmNoX3N0YXJ0X3Np
bmdsZXN0ZXAodmNwdSk7CisJZWxzZQorCQlkb25lID0ga3ZtaV9hcmNoX3N0b3Bfc2luZ2xlc3Rl
cCh2Y3B1KTsKKworCWlmIChkb25lKSB7CisJCWVjID0gMDsKKwkJVkNQVUkodmNwdSktPnNpbmds
ZXN0ZXAubG9vcCA9ICEhcmVxLT5lbmFibGU7CisJfQorCityZXBseToKKwlyZXR1cm4ga3ZtaV9t
c2dfdmNwdV9yZXBseShqb2IsIG1zZywgZWMsIE5VTEwsIDApOworfQorCiAvKgogICogVGhlc2Ug
Y29tbWFuZHMgYXJlIGV4ZWN1dGVkIG9uIHRoZSB2Q1BVIHRocmVhZC4gVGhlIHJlY2VpdmluZyB0
aHJlYWQKICAqIHBhc3NlcyB0aGUgbWVzc2FnZXMgdXNpbmcgYSBuZXdseSBhbGxvY2F0ZWQgJ3N0
cnVjdCBrdm1pX3ZjcHVfY21kX2pvYicKQEAgLTU5MywxNyArNjIyLDE4IEBAIHN0YXRpYyBpbnQg
aGFuZGxlX3ZjcHVfY29udHJvbF9tc3IoY29uc3Qgc3RydWN0IGt2bWlfdmNwdV9jbWRfam9iICpq
b2IsCiAgKi8KIHN0YXRpYyBpbnQoKmNvbnN0IG1zZ192Y3B1W10pKGNvbnN0IHN0cnVjdCBrdm1p
X3ZjcHVfY21kX2pvYiAqLAogCQkJICAgICAgY29uc3Qgc3RydWN0IGt2bWlfbXNnX2hkciAqLCBj
b25zdCB2b2lkICopID0gewotCVtLVk1JX0VWRU5UX1JFUExZXSAgICAgICAgICAgPSBoYW5kbGVf
ZXZlbnRfcmVwbHksCi0JW0tWTUlfVkNQVV9DT05UUk9MX0NSXSAgICAgICA9IGhhbmRsZV92Y3B1
X2NvbnRyb2xfY3IsCi0JW0tWTUlfVkNQVV9DT05UUk9MX0VWRU5UU10gICA9IGhhbmRsZV92Y3B1
X2NvbnRyb2xfZXZlbnRzLAotCVtLVk1JX1ZDUFVfQ09OVFJPTF9NU1JdICAgICAgPSBoYW5kbGVf
dmNwdV9jb250cm9sX21zciwKLQlbS1ZNSV9WQ1BVX0dFVF9DUFVJRF0gICAgICAgID0gaGFuZGxl
X2dldF9jcHVpZCwKLQlbS1ZNSV9WQ1BVX0dFVF9JTkZPXSAgICAgICAgID0gaGFuZGxlX2dldF92
Y3B1X2luZm8sCi0JW0tWTUlfVkNQVV9HRVRfTVRSUl9UWVBFXSAgICA9IGhhbmRsZV92Y3B1X2dl
dF9tdHJyX3R5cGUsCi0JW0tWTUlfVkNQVV9HRVRfUkVHSVNURVJTXSAgICA9IGhhbmRsZV9nZXRf
cmVnaXN0ZXJzLAotCVtLVk1JX1ZDUFVfR0VUX1hTQVZFXSAgICAgICAgPSBoYW5kbGVfdmNwdV9n
ZXRfeHNhdmUsCi0JW0tWTUlfVkNQVV9JTkpFQ1RfRVhDRVBUSU9OXSA9IGhhbmRsZV92Y3B1X2lu
amVjdF9leGNlcHRpb24sCi0JW0tWTUlfVkNQVV9TRVRfUkVHSVNURVJTXSAgICA9IGhhbmRsZV9z
ZXRfcmVnaXN0ZXJzLAorCVtLVk1JX0VWRU5UX1JFUExZXSAgICAgICAgICAgICA9IGhhbmRsZV9l
dmVudF9yZXBseSwKKwlbS1ZNSV9WQ1BVX0NPTlRST0xfQ1JdICAgICAgICAgPSBoYW5kbGVfdmNw
dV9jb250cm9sX2NyLAorCVtLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFNdICAgICA9IGhhbmRsZV92
Y3B1X2NvbnRyb2xfZXZlbnRzLAorCVtLVk1JX1ZDUFVfQ09OVFJPTF9NU1JdICAgICAgICA9IGhh
bmRsZV92Y3B1X2NvbnRyb2xfbXNyLAorCVtLVk1JX1ZDUFVfQ09OVFJPTF9TSU5HTEVTVEVQXSA9
IGhhbmRsZV92Y3B1X2NvbnRyb2xfc2luZ2xlc3RlcCwKKwlbS1ZNSV9WQ1BVX0dFVF9DUFVJRF0g
ICAgICAgICAgPSBoYW5kbGVfZ2V0X2NwdWlkLAorCVtLVk1JX1ZDUFVfR0VUX0lORk9dICAgICAg
ICAgICA9IGhhbmRsZV9nZXRfdmNwdV9pbmZvLAorCVtLVk1JX1ZDUFVfR0VUX01UUlJfVFlQRV0g
ICAgICA9IGhhbmRsZV92Y3B1X2dldF9tdHJyX3R5cGUsCisJW0tWTUlfVkNQVV9HRVRfUkVHSVNU
RVJTXSAgICAgID0gaGFuZGxlX2dldF9yZWdpc3RlcnMsCisJW0tWTUlfVkNQVV9HRVRfWFNBVkVd
ICAgICAgICAgID0gaGFuZGxlX3ZjcHVfZ2V0X3hzYXZlLAorCVtLVk1JX1ZDUFVfSU5KRUNUX0VY
Q0VQVElPTl0gICA9IGhhbmRsZV92Y3B1X2luamVjdF9leGNlcHRpb24sCisJW0tWTUlfVkNQVV9T
RVRfUkVHSVNURVJTXSAgICAgID0gaGFuZGxlX3NldF9yZWdpc3RlcnMsCiB9OwogCiBzdGF0aWMg
dm9pZCBrdm1pX2pvYl92Y3B1X2NtZChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHZvaWQgKmN0eCkK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6
YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24u
b3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3Zp
cnR1YWxpemF0aW9u
