Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp4.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 1DB9B75309A
	for <lists.virtualization@lfdr.de>; Fri, 14 Jul 2023 06:37:22 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp4.osuosl.org (Postfix) with ESMTP id 73F0542139;
	Fri, 14 Jul 2023 04:37:20 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 73F0542139
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
	by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 8H5FEpR3442i; Fri, 14 Jul 2023 04:37:18 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp4.osuosl.org (Postfix) with ESMTPS id 509FA41F8E;
	Fri, 14 Jul 2023 04:37:18 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 509FA41F8E
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 7F441C0DD4;
	Fri, 14 Jul 2023 04:37:17 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp1.osuosl.org (smtp1.osuosl.org [140.211.166.138])
 by lists.linuxfoundation.org (Postfix) with ESMTP id CD0F6C0032
 for <virtualization@lists.linux-foundation.org>;
 Fri, 14 Jul 2023 04:37:14 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp1.osuosl.org (Postfix) with ESMTP id A827E83EB4
 for <virtualization@lists.linux-foundation.org>;
 Fri, 14 Jul 2023 04:37:14 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org A827E83EB4
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp1.osuosl.org ([127.0.0.1])
 by localhost (smtp1.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id lwK5wyqoTCg5
 for <virtualization@lists.linux-foundation.org>;
 Fri, 14 Jul 2023 04:37:13 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org 4A6A983EAF
Received: from out30-113.freemail.mail.aliyun.com
 (out30-113.freemail.mail.aliyun.com [115.124.30.113])
 by smtp1.osuosl.org (Postfix) with ESMTPS id 4A6A983EAF
 for <virtualization@lists.linux-foundation.org>;
 Fri, 14 Jul 2023 04:37:11 +0000 (UTC)
X-Alimail-AntiSpam: AC=PASS; BC=-1|-1; BR=01201311R841e4; CH=green; DM=||false|;
 DS=||; FP=0|-1|-1|-1|0|-1|-1|-1; HT=ay29a033018046049;
 MF=xuanzhuo@linux.alibaba.com; NM=1; PH=DS; RN=14; SR=0;
 TI=SMTPD_---0VnKHQIi_1689309424; 
Received: from localhost(mailfrom:xuanzhuo@linux.alibaba.com
 fp:SMTPD_---0VnKHQIi_1689309424) by smtp.aliyun-inc.com;
 Fri, 14 Jul 2023 12:37:04 +0800
Message-ID: <1689307105.301344-1-xuanzhuo@linux.alibaba.com>
Subject: Re: [PATCH vhost v11 10/10] virtio_net: merge dma operation for one
 page
Date: Fri, 14 Jul 2023 11:58:25 +0800
From: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
To: Jason Wang <jasowang@redhat.com>
References: <20230710034237.12391-1-xuanzhuo@linux.alibaba.com>
 <20230710034237.12391-11-xuanzhuo@linux.alibaba.com>
 <CACGkMEtoiHXese1sNJELeidmFc6nFR8rE1aA8MooaEKKUSw_eg@mail.gmail.com>
 <1689231604.0892205-3-xuanzhuo@linux.alibaba.com>
 <CACGkMEsGY=1wpT_AjyuEbE-4HDJkH5_5wmaP5H30O0B16o3a5Q@mail.gmail.com>
In-Reply-To: <CACGkMEsGY=1wpT_AjyuEbE-4HDJkH5_5wmaP5H30O0B16o3a5Q@mail.gmail.com>
Cc: Jesper Dangaard Brouer <hawk@kernel.org>,
 Daniel Borkmann <daniel@iogearbox.net>, "Michael S. Tsirkin" <mst@redhat.com>,
 netdev@vger.kernel.org, John Fastabend <john.fastabend@gmail.com>,
 Alexei Starovoitov <ast@kernel.org>, virtualization@lists.linux-foundation.org,
 Christoph Hellwig <hch@infradead.org>, Eric Dumazet <edumazet@google.com>,
 Jakub Kicinski <kuba@kernel.org>, bpf@vger.kernel.org,
 Paolo Abeni <pabeni@redhat.com>, "David S. Miller" <davem@davemloft.net>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gRnJpLCAxNCBKdWwgMjAyMyAxMTo1NzowNSArMDgwMCwgSmFzb24gV2FuZyA8amFzb3dhbmdA
cmVkaGF0LmNvbT4gd3JvdGU6Cj4gT24gVGh1LCBKdWwgMTMsIDIwMjMgYXQgMzowMuKAr1BNIFh1
YW4gWmh1byA8eHVhbnpodW9AbGludXguYWxpYmFiYS5jb20+IHdyb3RlOgo+ID4KPiA+IE9uIFRo
dSwgMTMgSnVsIDIwMjMgMTI6MjA6MDEgKzA4MDAsIEphc29uIFdhbmcgPGphc293YW5nQHJlZGhh
dC5jb20+IHdyb3RlOgo+ID4gPiBPbiBNb24sIEp1bCAxMCwgMjAyMyBhdCAxMTo0M+KAr0FNIFh1
YW4gWmh1byA8eHVhbnpodW9AbGludXguYWxpYmFiYS5jb20+IHdyb3RlOgo+ID4gPiA+Cj4gPiA+
Cj4gPiA+IEknZCBzdWdnZXN0IHRvIHR3ZWFrIHRoZSB0aXRsZSBsaWtlOgo+ID4gPgo+ID4gPiAi
bWVyZ2UgZG1hIG9wZXJhdGlvbnMgd2hlbiByZWZpbGxpbmcgbWVyZ2VhYmxlIGJ1ZmZlcnMiCj4g
PiA+Cj4gPiA+ID4gQ3VycmVudGx5LCB0aGUgdmlydGlvIGNvcmUgd2lsbCBwZXJmb3JtIGEgZG1h
IG9wZXJhdGlvbiBmb3IgZWFjaAo+ID4gPiA+IG9wZXJhdGlvbi4KPiA+ID4KPiA+ID4gImZvciBl
YWNoIGJ1ZmZlciI/Cj4gPiA+Cj4gPiA+ID4gQWx0aG91Z2gsIHRoZSBzYW1lIHBhZ2UgbWF5IGJl
IG9wZXJhdGVkIG11bHRpcGxlIHRpbWVzLgo+ID4gPiA+Cj4gPiA+ID4gVGhlIGRyaXZlciBkb2Vz
IHRoZSBkbWEgb3BlcmF0aW9uIGFuZCBtYW5hZ2VzIHRoZSBkbWEgYWRkcmVzcyBiYXNlZCB0aGUK
PiA+ID4gPiBmZWF0dXJlIHByZW1hcHBlZCBvZiB2aXJ0aW8gY29yZS4KPiA+ID4gPgo+ID4gPiA+
IFRoaXMgd2F5LCB3ZSBjYW4gcGVyZm9ybSBvbmx5IG9uZSBkbWEgb3BlcmF0aW9uIGZvciB0aGUg
c2FtZSBwYWdlLiBJbgo+ID4gPiA+IHRoZSBjYXNlIG9mIG10dSAxNTAwLCB0aGlzIGNhbiByZWR1
Y2UgYSBsb3Qgb2YgZG1hIG9wZXJhdGlvbnMuCj4gPiA+ID4KPiA+ID4gPiBUZXN0ZWQgb24gQWxp
eXVuIGc3LjRsYXJnZSBtYWNoaW5lLCBpbiB0aGUgY2FzZSBvZiBhIGNwdSAxMDAlLCBwcHMKPiA+
ID4gPiBpbmNyZWFzZWQgZnJvbSAxODkzNzY2IHRvIDE5MDExMDUuIEFuIGluY3JlYXNlIG9mIDAu
NCUuCj4gPiA+Cj4gPiA+IEJ0dywgaXQgbG9va3MgdG8gbWUgdGhlIGNvZGUgdG8gZGVhbCB3aXRo
IFhEUF9UWC9SRURJUkVDVCBmb3IKPiA+ID4gbGluZWFyaXplZCBwYWdlcyB3YXMgbWlzc2VkLgo+
ID4gPgo+ID4gPiA+Cj4gPiA+ID4gU2lnbmVkLW9mZi1ieTogWHVhbiBaaHVvIDx4dWFuemh1b0Bs
aW51eC5hbGliYWJhLmNvbT4KPiA+ID4gPiAtLS0KPiA+ID4gPiAgZHJpdmVycy9uZXQvdmlydGlv
X25ldC5jIHwgMjgzICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLQo+ID4g
PiA+ICAxIGZpbGUgY2hhbmdlZCwgMjY3IGluc2VydGlvbnMoKyksIDE2IGRlbGV0aW9ucygtKQo+
ID4gPiA+Cj4gPiA+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L3ZpcnRpb19uZXQuYyBiL2Ry
aXZlcnMvbmV0L3ZpcnRpb19uZXQuYwo+ID4gPiA+IGluZGV4IDQ4NmI1ODQ5MDMzZC4uNGRlODQ1
ZDM1YmVkIDEwMDY0NAo+ID4gPiA+IC0tLSBhL2RyaXZlcnMvbmV0L3ZpcnRpb19uZXQuYwo+ID4g
PiA+ICsrKyBiL2RyaXZlcnMvbmV0L3ZpcnRpb19uZXQuYwo+ID4gPiA+IEBAIC0xMjYsNiArMTI2
LDI3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdmlydG5ldF9zdGF0X2Rlc2MgdmlydG5ldF9ycV9z
dGF0c19kZXNjW10gPSB7Cj4gPiA+ID4gICNkZWZpbmUgVklSVE5FVF9TUV9TVEFUU19MRU4gICBB
UlJBWV9TSVpFKHZpcnRuZXRfc3Ffc3RhdHNfZGVzYykKPiA+ID4gPiAgI2RlZmluZSBWSVJUTkVU
X1JRX1NUQVRTX0xFTiAgIEFSUkFZX1NJWkUodmlydG5ldF9ycV9zdGF0c19kZXNjKQo+ID4gPiA+
Cj4gPiA+ID4gKy8qIFRoZSBidWZzIG9uIHRoZSBzYW1lIHBhZ2UgbWF5IHNoYXJlIHRoaXMgc3Ry
dWN0LiAqLwo+ID4gPiA+ICtzdHJ1Y3QgdmlydG5ldF9ycV9kbWEgewo+ID4gPiA+ICsgICAgICAg
c3RydWN0IHZpcnRuZXRfcnFfZG1hICpuZXh0Owo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAgIGRt
YV9hZGRyX3QgYWRkcjsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICAgICB2b2lkICpidWY7Cj4gPiA+
ID4gKyAgICAgICB1MzIgbGVuOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAgIHUzMiByZWY7Cj4g
PiA+ID4gK307Cj4gPiA+ID4gKwo+ID4gPiA+ICsvKiBSZWNvcmQgdGhlIGRtYSBhbmQgYnVmLiAq
Lwo+ID4gPiA+ICtzdHJ1Y3QgdmlydG5ldF9ycV9kYXRhIHsKPiA+ID4gPiArICAgICAgIHN0cnVj
dCB2aXJ0bmV0X3JxX2RhdGEgKm5leHQ7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAgdm9pZCAq
YnVmOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAgIHN0cnVjdCB2aXJ0bmV0X3JxX2RtYSAqZG1h
Owo+ID4gPiA+ICt9Owo+ID4gPiA+ICsKPiA+ID4gPiAgLyogSW50ZXJuYWwgcmVwcmVzZW50YXRp
b24gb2YgYSBzZW5kIHZpcnRxdWV1ZSAqLwo+ID4gPiA+ICBzdHJ1Y3Qgc2VuZF9xdWV1ZSB7Cj4g
PiA+ID4gICAgICAgICAvKiBWaXJ0cXVldWUgYXNzb2NpYXRlZCB3aXRoIHRoaXMgc2VuZCBfcXVl
dWUgKi8KPiA+ID4gPiBAQCAtMTc1LDYgKzE5NiwxMyBAQCBzdHJ1Y3QgcmVjZWl2ZV9xdWV1ZSB7
Cj4gPiA+ID4gICAgICAgICBjaGFyIG5hbWVbMTZdOwo+ID4gPiA+Cj4gPiA+ID4gICAgICAgICBz
dHJ1Y3QgeGRwX3J4cV9pbmZvIHhkcF9yeHE7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAgc3Ry
dWN0IHZpcnRuZXRfcnFfZGF0YSAqZGF0YV9hcnJheTsKPiA+ID4gPiArICAgICAgIHN0cnVjdCB2
aXJ0bmV0X3JxX2RhdGEgKmRhdGFfZnJlZTsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICAgICBzdHJ1
Y3QgdmlydG5ldF9ycV9kbWEgKmRtYV9hcnJheTsKPiA+ID4gPiArICAgICAgIHN0cnVjdCB2aXJ0
bmV0X3JxX2RtYSAqZG1hX2ZyZWU7Cj4gPiA+ID4gKyAgICAgICBzdHJ1Y3QgdmlydG5ldF9ycV9k
bWEgKmxhc3RfZG1hOwo+ID4gPiA+ICB9Owo+ID4gPiA+Cj4gPiA+ID4gIC8qIFRoaXMgc3RydWN0
dXJlIGNhbiBjb250YWluIHJzcyBtZXNzYWdlIHdpdGggbWF4aW11bSBzZXR0aW5ncyBmb3IgaW5k
aXJlY3Rpb24gdGFibGUgYW5kIGtleXNpemUKPiA+ID4gPiBAQCAtNTQ5LDYgKzU3NywxNzYgQEAg
c3RhdGljIHN0cnVjdCBza19idWZmICpwYWdlX3RvX3NrYihzdHJ1Y3QgdmlydG5ldF9pbmZvICp2
aSwKPiA+ID4gPiAgICAgICAgIHJldHVybiBza2I7Cj4gPiA+ID4gIH0KPiA+ID4gPgo+ID4gPiA+
ICtzdGF0aWMgdm9pZCB2aXJ0bmV0X3JxX3VubWFwKHN0cnVjdCByZWNlaXZlX3F1ZXVlICpycSwg
c3RydWN0IHZpcnRuZXRfcnFfZG1hICpkbWEpCj4gPiA+ID4gK3sKPiA+ID4gPiArICAgICAgIHN0
cnVjdCBkZXZpY2UgKmRldjsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICAgICAtLWRtYS0+cmVmOwo+
ID4gPiA+ICsKPiA+ID4gPiArICAgICAgIGlmIChkbWEtPnJlZikKPiA+ID4gPiArICAgICAgICAg
ICAgICAgcmV0dXJuOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAgIGRldiA9IHZpcnRxdWV1ZV9k
bWFfZGV2KHJxLT52cSk7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAgZG1hX3VubWFwX3BhZ2Uo
ZGV2LCBkbWEtPmFkZHIsIGRtYS0+bGVuLCBETUFfRlJPTV9ERVZJQ0UpOwo+ID4gPiA+ICsKPiA+
ID4gPiArICAgICAgIGRtYS0+bmV4dCA9IHJxLT5kbWFfZnJlZTsKPiA+ID4gPiArICAgICAgIHJx
LT5kbWFfZnJlZSA9IGRtYTsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArc3RhdGljIHZv
aWQgKnZpcnRuZXRfcnFfcmVjeWNsZV9kYXRhKHN0cnVjdCByZWNlaXZlX3F1ZXVlICpycSwKPiA+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHZpcnRuZXRf
cnFfZGF0YSAqZGF0YSkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgICAgdm9pZCAqYnVmOwo+ID4g
PiA+ICsKPiA+ID4gPiArICAgICAgIGJ1ZiA9IGRhdGEtPmJ1ZjsKPiA+ID4gPiArCj4gPiA+ID4g
KyAgICAgICBkYXRhLT5uZXh0ID0gcnEtPmRhdGFfZnJlZTsKPiA+ID4gPiArICAgICAgIHJxLT5k
YXRhX2ZyZWUgPSBkYXRhOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAgIHJldHVybiBidWY7Cj4g
PiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK3N0YXRpYyBzdHJ1Y3QgdmlydG5ldF9ycV9kYXRh
ICp2aXJ0bmV0X3JxX2dldF9kYXRhKHN0cnVjdCByZWNlaXZlX3F1ZXVlICpycSwKPiA+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpi
dWYsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IHZpcnRuZXRfcnFfZG1hICpkbWEpCj4gPiA+ID4gK3sKPiA+ID4gPiArICAg
ICAgIHN0cnVjdCB2aXJ0bmV0X3JxX2RhdGEgKmRhdGE7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAg
ICAgZGF0YSA9IHJxLT5kYXRhX2ZyZWU7Cj4gPiA+ID4gKyAgICAgICBycS0+ZGF0YV9mcmVlID0g
ZGF0YS0+bmV4dDsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICAgICBkYXRhLT5idWYgPSBidWY7Cj4g
PiA+ID4gKyAgICAgICBkYXRhLT5kbWEgPSBkbWE7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAg
cmV0dXJuIGRhdGE7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK3N0YXRpYyB2b2lkICp2
aXJ0bmV0X3JxX2dldF9idWYoc3RydWN0IHJlY2VpdmVfcXVldWUgKnJxLCB1MzIgKmxlbiwgdm9p
ZCAqKmN0eCkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgICAgc3RydWN0IHZpcnRuZXRfcnFfZGF0
YSAqZGF0YTsKPiA+ID4gPiArICAgICAgIHZvaWQgKmJ1ZjsKPiA+ID4gPiArCj4gPiA+ID4gKyAg
ICAgICBidWYgPSB2aXJ0cXVldWVfZ2V0X2J1Zl9jdHgocnEtPnZxLCBsZW4sIGN0eCk7Cj4gPiA+
ID4gKyAgICAgICBpZiAoIWJ1ZiB8fCAhcnEtPmRhdGFfYXJyYXkpCj4gPiA+ID4gKyAgICAgICAg
ICAgICAgIHJldHVybiBidWY7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAgZGF0YSA9IGJ1ZjsK
PiA+ID4gPiArCj4gPiA+ID4gKyAgICAgICB2aXJ0bmV0X3JxX3VubWFwKHJxLCBkYXRhLT5kbWEp
Owo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAgIHJldHVybiB2aXJ0bmV0X3JxX3JlY3ljbGVfZGF0
YShycSwgZGF0YSk7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK3N0YXRpYyB2b2lkICp2
aXJ0bmV0X3JxX2RldGFjaF91bnVzZWRfYnVmKHN0cnVjdCByZWNlaXZlX3F1ZXVlICpycSkKPiA+
ID4gPiArewo+ID4gPiA+ICsgICAgICAgc3RydWN0IHZpcnRuZXRfcnFfZGF0YSAqZGF0YTsKPiA+
ID4gPiArICAgICAgIHZvaWQgKmJ1ZjsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICAgICBidWYgPSB2
aXJ0cXVldWVfZGV0YWNoX3VudXNlZF9idWYocnEtPnZxKTsKPiA+ID4gPiArICAgICAgIGlmICgh
YnVmIHx8ICFycS0+ZGF0YV9hcnJheSkKPiA+ID4gPiArICAgICAgICAgICAgICAgcmV0dXJuIGJ1
ZjsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICAgICBkYXRhID0gYnVmOwo+ID4gPiA+ICsKPiA+ID4g
PiArICAgICAgIHZpcnRuZXRfcnFfdW5tYXAocnEsIGRhdGEtPmRtYSk7Cj4gPiA+ID4gKwo+ID4g
PiA+ICsgICAgICAgcmV0dXJuIHZpcnRuZXRfcnFfcmVjeWNsZV9kYXRhKHJxLCBkYXRhKTsKPiA+
ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArc3RhdGljIGludCB2aXJ0bmV0X3JxX21hcF9zZyhz
dHJ1Y3QgcmVjZWl2ZV9xdWV1ZSAqcnEsIHZvaWQgKmJ1ZiwgdTMyIGxlbikKPiA+ID4gPiArewo+
ID4gPiA+ICsgICAgICAgc3RydWN0IHZpcnRuZXRfcnFfZG1hICpkbWEgPSBycS0+bGFzdF9kbWE7
Cj4gPiA+ID4gKyAgICAgICBzdHJ1Y3QgZGV2aWNlICpkZXY7Cj4gPiA+ID4gKyAgICAgICB1MzIg
b2ZmLCBtYXBfbGVuOwo+ID4gPiA+ICsgICAgICAgZG1hX2FkZHJfdCBhZGRyOwo+ID4gPiA+ICsg
ICAgICAgdm9pZCAqZW5kOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAgIGlmIChsaWtlbHkoZG1h
KSAmJiBidWYgPj0gZG1hLT5idWYgJiYgKGJ1ZiArIGxlbiA8PSBkbWEtPmJ1ZiArIGRtYS0+bGVu
KSkgewo+ID4gPiA+ICsgICAgICAgICAgICAgICArK2RtYS0+cmVmOwo+ID4gPiA+ICsgICAgICAg
ICAgICAgICBhZGRyID0gZG1hLT5hZGRyICsgKGJ1ZiAtIGRtYS0+YnVmKTsKPiA+ID4gPiArICAg
ICAgICAgICAgICAgZ290byBvazsKPiA+ID4gPiArICAgICAgIH0KPiA+ID4gPiArCj4gPiA+ID4g
KyAgICAgICBlbmQgPSBidWYgKyBsZW4gLSAxOwo+ID4gPiA+ICsgICAgICAgb2ZmID0gb2Zmc2V0
X2luX3BhZ2UoZW5kKTsKPiA+ID4gPiArICAgICAgIG1hcF9sZW4gPSBsZW4gKyBQQUdFX1NJWkUg
LSBvZmY7Cj4gPiA+Cj4gPiA+IFRoaXMgYXNzdW1lcyBhIFBBR0VfU0laRSB3aGljaCBzZWVtcyBz
dWItb3B0aW1hbCBhcyBwYWdlIGZyYWcgY291bGQgYmUKPiA+ID4gbGFyZ2VyIHRoYW4gdGhpcy4K
PiA+ID4KPiA+ID4gPiArCj4gPiA+ID4gKyAgICAgICBkZXYgPSB2aXJ0cXVldWVfZG1hX2Rldihy
cS0+dnEpOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAgIGFkZHIgPSBkbWFfbWFwX3BhZ2VfYXR0
cnMoZGV2LCB2aXJ0X3RvX3BhZ2UoYnVmKSwgb2Zmc2V0X2luX3BhZ2UoYnVmKSwKPiA+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwX2xlbiwgRE1BX0ZST01fREVWSUNF
LCAwKTsKPiA+ID4gPiArICAgICAgIGlmIChhZGRyID09IERNQV9NQVBQSU5HX0VSUk9SKQo+ID4g
PiA+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiA+ID4gPiArCj4gPiA+ID4gKyAg
ICAgICBkbWEgPSBycS0+ZG1hX2ZyZWU7Cj4gPiA+ID4gKyAgICAgICBycS0+ZG1hX2ZyZWUgPSBk
bWEtPm5leHQ7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAgZG1hLT5yZWYgPSAxOwo+ID4gPiA+
ICsgICAgICAgZG1hLT5idWYgPSBidWY7Cj4gPiA+ID4gKyAgICAgICBkbWEtPmFkZHIgPSBhZGRy
Owo+ID4gPiA+ICsgICAgICAgZG1hLT5sZW4gPSBtYXBfbGVuOwo+ID4gPiA+ICsKPiA+ID4gPiAr
ICAgICAgIHJxLT5sYXN0X2RtYSA9IGRtYTsKPiA+ID4gPiArCj4gPiA+ID4gK29rOgo+ID4gPiA+
ICsgICAgICAgc2dfaW5pdF90YWJsZShycS0+c2csIDEpOwo+ID4gPiA+ICsgICAgICAgcnEtPnNn
WzBdLmRtYV9hZGRyZXNzID0gYWRkcjsKPiA+ID4gPiArICAgICAgIHJxLT5zZ1swXS5sZW5ndGgg
PSBsZW47Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAgcmV0dXJuIDA7Cj4gPiA+ID4gK30KPiA+
ID4gPiArCj4gPiA+ID4gK3N0YXRpYyBpbnQgdmlydG5ldF9ycV9tZXJnZV9tYXBfaW5pdChzdHJ1
Y3QgdmlydG5ldF9pbmZvICp2aSkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgICAgc3RydWN0IHJl
Y2VpdmVfcXVldWUgKnJxOwo+ID4gPiA+ICsgICAgICAgaW50IGksIGVyciwgaiwgbnVtOwo+ID4g
PiA+ICsKPiA+ID4gPiArICAgICAgIC8qIGRpc2FibGUgZm9yIGJpZyBtb2RlICovCj4gPiA+ID4g
KyAgICAgICBpZiAoIXZpLT5tZXJnZWFibGVfcnhfYnVmcyAmJiB2aS0+YmlnX3BhY2tldHMpCj4g
PiA+ID4gKyAgICAgICAgICAgICAgIHJldHVybiAwOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAg
IGZvciAoaSA9IDA7IGkgPCB2aS0+bWF4X3F1ZXVlX3BhaXJzOyBpKyspIHsKPiA+ID4gPiArICAg
ICAgICAgICAgICAgZXJyID0gdmlydHF1ZXVlX3NldF9wcmVtYXBwZWQodmktPnJxW2ldLnZxKTsK
PiA+ID4gPiArICAgICAgICAgICAgICAgaWYgKGVycikKPiA+ID4gPiArICAgICAgICAgICAgICAg
ICAgICAgICBjb250aW51ZTsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICAgICAgICAgICAgIHJxID0g
JnZpLT5ycVtpXTsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICAgICAgICAgICAgIG51bSA9IHZpcnRx
dWV1ZV9nZXRfdnJpbmdfc2l6ZShycS0+dnEpOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAgICAg
ICAgICAgcnEtPmRhdGFfYXJyYXkgPSBrbWFsbG9jX2FycmF5KG51bSwgc2l6ZW9mKCpycS0+ZGF0
YV9hcnJheSksIEdGUF9LRVJORUwpOwo+ID4gPiA+ICsgICAgICAgICAgICAgICBpZiAoIXJxLT5k
YXRhX2FycmF5KQo+ID4gPgo+ID4gPiBDYW4gd2UgYXZvaWQgdGhvc2UgYWxsb2NhdGlvbnMgd2hl
biB3ZSBkb24ndCB1c2UgdGhlIERNQSBBUEk/Cj4gPiA+Cj4gPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgZ290byBlcnI7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAgICAgICAgICBycS0+
ZG1hX2FycmF5ID0ga21hbGxvY19hcnJheShudW0sIHNpemVvZigqcnEtPmRtYV9hcnJheSksIEdG
UF9LRVJORUwpOwo+ID4gPiA+ICsgICAgICAgICAgICAgICBpZiAoIXJxLT5kbWFfYXJyYXkpCj4g
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZ290byBlcnI7Cj4gPiA+ID4gKwo+ID4gPiA+
ICsgICAgICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgbnVtOyArK2opIHsKPiA+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICBycS0+ZGF0YV9hcnJheVtqXS5uZXh0ID0gcnEtPmRhdGFfZnJl
ZTsKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBycS0+ZGF0YV9mcmVlID0gJnJxLT5k
YXRhX2FycmF5W2pdOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBy
cS0+ZG1hX2FycmF5W2pdLm5leHQgPSBycS0+ZG1hX2ZyZWU7Cj4gPiA+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgcnEtPmRtYV9mcmVlID0gJnJxLT5kbWFfYXJyYXlbal07Cj4gPiA+ID4gKyAg
ICAgICAgICAgICAgIH0KPiA+ID4gPiArICAgICAgIH0KPiA+ID4gPiArCj4gPiA+ID4gKyAgICAg
ICByZXR1cm4gMDsKPiA+ID4gPiArCj4gPiA+ID4gK2VycjoKPiA+ID4gPiArICAgICAgIGZvciAo
aSA9IDA7IGkgPCB2aS0+bWF4X3F1ZXVlX3BhaXJzOyBpKyspIHsKPiA+ID4gPiArICAgICAgICAg
ICAgICAgc3RydWN0IHJlY2VpdmVfcXVldWUgKnJxOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAg
ICAgICAgICAgcnEgPSAmdmktPnJxW2ldOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAgICAgICAg
ICAga2ZyZWUocnEtPmRtYV9hcnJheSk7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgIGtmcmVlKHJx
LT5kYXRhX2FycmF5KTsKPiA+ID4gPiArICAgICAgIH0KPiA+ID4gPiArCj4gPiA+ID4gKyAgICAg
ICByZXR1cm4gLUVOT01FTTsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiAgc3RhdGljIHZv
aWQgZnJlZV9vbGRfeG1pdF9za2JzKHN0cnVjdCBzZW5kX3F1ZXVlICpzcSwgYm9vbCBpbl9uYXBp
KQo+ID4gPiA+ICB7Cj4gPiA+ID4gICAgICAgICB1bnNpZ25lZCBpbnQgbGVuOwo+ID4gPiA+IEBA
IC04MzUsNyArMTAzMyw3IEBAIHN0YXRpYyBzdHJ1Y3QgcGFnZSAqeGRwX2xpbmVhcml6ZV9wYWdl
KHN0cnVjdCByZWNlaXZlX3F1ZXVlICpycSwKPiA+ID4gPiAgICAgICAgICAgICAgICAgdm9pZCAq
YnVmOwo+ID4gPiA+ICAgICAgICAgICAgICAgICBpbnQgb2ZmOwo+ID4gPiA+Cj4gPiA+ID4gLSAg
ICAgICAgICAgICAgIGJ1ZiA9IHZpcnRxdWV1ZV9nZXRfYnVmKHJxLT52cSwgJmJ1Zmxlbik7Cj4g
PiA+ID4gKyAgICAgICAgICAgICAgIGJ1ZiA9IHZpcnRuZXRfcnFfZ2V0X2J1ZihycSwgJmJ1Zmxl
biwgTlVMTCk7Cj4gPiA+ID4gICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghYnVmKSkKPiA+
ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl9idWY7Cj4gPiA+ID4KPiA+ID4g
PiBAQCAtMTEyNiw3ICsxMzI0LDcgQEAgc3RhdGljIGludCB2aXJ0bmV0X2J1aWxkX3hkcF9idWZm
X21yZyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ID4gPiA+ICAgICAgICAgICAgICAgICByZXR1
cm4gLUVJTlZBTDsKPiA+ID4gPgo+ID4gPiA+ICAgICAgICAgd2hpbGUgKC0tKm51bV9idWYgPiAw
KSB7Cj4gPiA+ID4gLSAgICAgICAgICAgICAgIGJ1ZiA9IHZpcnRxdWV1ZV9nZXRfYnVmX2N0eChy
cS0+dnEsICZsZW4sICZjdHgpOwo+ID4gPiA+ICsgICAgICAgICAgICAgICBidWYgPSB2aXJ0bmV0
X3JxX2dldF9idWYocnEsICZsZW4sICZjdHgpOwo+ID4gPiA+ICAgICAgICAgICAgICAgICBpZiAo
dW5saWtlbHkoIWJ1ZikpIHsKPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBwcl9kZWJ1
ZygiJXM6IHJ4IGVycm9yOiAlZCBidWZmZXJzIG91dCBvZiAlZCBtaXNzaW5nXG4iLAo+ID4gPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldi0+bmFtZSwgKm51bV9idWYsCj4g
PiA+ID4gQEAgLTEzNTEsNyArMTU0OSw3IEBAIHN0YXRpYyBzdHJ1Y3Qgc2tfYnVmZiAqcmVjZWl2
ZV9tZXJnZWFibGUoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gPiAgICAgICAgIHdoaWxl
ICgtLW51bV9idWYpIHsKPiA+ID4gPiAgICAgICAgICAgICAgICAgaW50IG51bV9za2JfZnJhZ3M7
Cj4gPiA+ID4KPiA+ID4gPiAtICAgICAgICAgICAgICAgYnVmID0gdmlydHF1ZXVlX2dldF9idWZf
Y3R4KHJxLT52cSwgJmxlbiwgJmN0eCk7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgIGJ1ZiA9IHZp
cnRuZXRfcnFfZ2V0X2J1ZihycSwgJmxlbiwgJmN0eCk7Cj4gPiA+ID4gICAgICAgICAgICAgICAg
IGlmICh1bmxpa2VseSghYnVmKSkgewo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIHBy
X2RlYnVnKCIlczogcnggZXJyb3I6ICVkIGJ1ZmZlcnMgb3V0IG9mICVkIG1pc3NpbmdcbiIsCj4g
PiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV2LT5uYW1lLCBudW1fYnVm
LAo+ID4gPiA+IEBAIC0xNDE0LDcgKzE2MTIsNyBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKnJl
Y2VpdmVfbWVyZ2VhYmxlKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gPiA+ID4gIGVycl9za2I6
Cj4gPiA+ID4gICAgICAgICBwdXRfcGFnZShwYWdlKTsKPiA+ID4gPiAgICAgICAgIHdoaWxlIChu
dW1fYnVmLS0gPiAxKSB7Cj4gPiA+ID4gLSAgICAgICAgICAgICAgIGJ1ZiA9IHZpcnRxdWV1ZV9n
ZXRfYnVmKHJxLT52cSwgJmxlbik7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgIGJ1ZiA9IHZpcnRu
ZXRfcnFfZ2V0X2J1ZihycSwgJmxlbiwgTlVMTCk7Cj4gPiA+ID4gICAgICAgICAgICAgICAgIGlm
ICh1bmxpa2VseSghYnVmKSkgewo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIHByX2Rl
YnVnKCIlczogcnggZXJyb3I6ICVkIGJ1ZmZlcnMgbWlzc2luZ1xuIiwKPiA+ID4gPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBkZXYtPm5hbWUsIG51bV9idWYpOwo+ID4gPiA+IEBA
IC0xNTI5LDYgKzE3MjcsNyBAQCBzdGF0aWMgaW50IGFkZF9yZWN2YnVmX3NtYWxsKHN0cnVjdCB2
aXJ0bmV0X2luZm8gKnZpLCBzdHJ1Y3QgcmVjZWl2ZV9xdWV1ZSAqcnEsCj4gPiA+ID4gICAgICAg
ICB1bnNpZ25lZCBpbnQgeGRwX2hlYWRyb29tID0gdmlydG5ldF9nZXRfaGVhZHJvb20odmkpOwo+
ID4gPiA+ICAgICAgICAgdm9pZCAqY3R4ID0gKHZvaWQgKikodW5zaWduZWQgbG9uZyl4ZHBfaGVh
ZHJvb207Cj4gPiA+ID4gICAgICAgICBpbnQgbGVuID0gdmktPmhkcl9sZW4gKyBWSVJUTkVUX1JY
X1BBRCArIEdPT0RfUEFDS0VUX0xFTiArIHhkcF9oZWFkcm9vbTsKPiA+ID4gPiArICAgICAgIHN0
cnVjdCB2aXJ0bmV0X3JxX2RhdGEgKmRhdGE7Cj4gPiA+ID4gICAgICAgICBpbnQgZXJyOwo+ID4g
PiA+Cj4gPiA+ID4gICAgICAgICBsZW4gPSBTS0JfREFUQV9BTElHTihsZW4pICsKPiA+ID4gPiBA
QCAtMTUzOSwxMSArMTczOCwzNCBAQCBzdGF0aWMgaW50IGFkZF9yZWN2YnVmX3NtYWxsKHN0cnVj
dCB2aXJ0bmV0X2luZm8gKnZpLCBzdHJ1Y3QgcmVjZWl2ZV9xdWV1ZSAqcnEsCj4gPiA+ID4gICAg
ICAgICBidWYgPSAoY2hhciAqKXBhZ2VfYWRkcmVzcyhhbGxvY19mcmFnLT5wYWdlKSArIGFsbG9j
X2ZyYWctPm9mZnNldDsKPiA+ID4gPiAgICAgICAgIGdldF9wYWdlKGFsbG9jX2ZyYWctPnBhZ2Up
Owo+ID4gPiA+ICAgICAgICAgYWxsb2NfZnJhZy0+b2Zmc2V0ICs9IGxlbjsKPiA+ID4gPiAtICAg
ICAgIHNnX2luaXRfb25lKHJxLT5zZywgYnVmICsgVklSVE5FVF9SWF9QQUQgKyB4ZHBfaGVhZHJv
b20sCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICB2aS0+aGRyX2xlbiArIEdPT0RfUEFDS0VU
X0xFTik7Cj4gPiA+ID4gLSAgICAgICBlcnIgPSB2aXJ0cXVldWVfYWRkX2luYnVmX2N0eChycS0+
dnEsIHJxLT5zZywgMSwgYnVmLCBjdHgsIGdmcCk7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAg
aWYgKHJxLT5kYXRhX2FycmF5KSB7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgIGVyciA9IHZpcnRu
ZXRfcnFfbWFwX3NnKHJxLCBidWYgKyBWSVJUTkVUX1JYX1BBRCArIHhkcF9oZWFkcm9vbSwKPiA+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmktPmhkcl9sZW4g
KyBHT09EX1BBQ0tFVF9MRU4pOwo+ID4gPgo+ID4gPiBUaGFua3MgdG8gdGhlIGNvbXBvdW5kIHBh
Z2UuIEkgd29uZGVyIGlmIGV2ZXJ5dGhpbmcgY291bGQgYmUKPiA+ID4gc2ltcGxpZmllZCBpZiB3
ZSBqdXN0IHJldXNlIHBhZ2UtPnByaXZhdGUgZm9yIHN0b3JpbmcgbWV0YWRhdGEgbGlrZQo+ID4g
PiBkbWEgYWRkcmVzcyBhbmQgcmVmY250LiBUaGVuIHdlIGRvbid0IG5lZWQgZXh0cmEgc3R1ZmYg
Zm9yIHRyYWNraW5nCj4gPiA+IGFueSBvdGhlciB0aGluZz8KPiA+Cj4gPiBNYXliZSB3ZSBjYW4g
dHJ5IGFsbG9jIG9uZSBzbWFsbCBidWZmZXIgZnJvbSB0aGUgcGFnZV9mcmFnIHRvIHN0b3JlIHRo
ZSBkbWEgaW5mbwo+ID4gd2hlbiBwYWdlX2ZyYWcub2Zmc2V0ID09IDAuCj4KPiBBbmQgc3RvcmUg
aXQgaW4gdGhlIGN0eD8gSSB0aGluayBpdCBzaG91bGQgd29yay4KCgpTaW5jZSB0aGUgZG1hIGlu
Zm9ybWF0aW9uIGlzIGxvY2F0ZWQgb24gdGhlIGZpcnN0IHBhZ2Ugb2YgdGhlIGNvbXBvc2l0ZSBw
YWdlLCB3ZQpjYW4gZ2V0IHRoZSBkbWEgaW5mb3JtYXRpb24gdGhyb3VnaCBidWYuCgpObyBuZWVk
IHRvIG1vZGlmeSBjdHguCgpUaGFua3MuCgoKPgo+IFRoYW5rcwo+Cj4gPgo+ID4gVGhhbmtzLgo+
ID4KPiA+Cj4gPiA+Cj4gPiA+IFRoYW5rcwo+ID4gPgo+ID4gPgo+ID4gPgo+ID4gPiA+ICsgICAg
ICAgICAgICAgICBpZiAoZXJyKQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGdvdG8g
bWFwX2VycjsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICAgICAgICAgICAgIGRhdGEgPSB2aXJ0bmV0
X3JxX2dldF9kYXRhKHJxLCBidWYsIHJxLT5sYXN0X2RtYSk7Cj4gPiA+ID4gKyAgICAgICB9IGVs
c2Ugewo+ID4gPiA+ICsgICAgICAgICAgICAgICBzZ19pbml0X29uZShycS0+c2csIGJ1ZiArIFZJ
UlRORVRfUlhfUEFEICsgeGRwX2hlYWRyb29tLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICB2aS0+aGRyX2xlbiArIEdPT0RfUEFDS0VUX0xFTik7Cj4gPiA+ID4gKyAgICAgICAg
ICAgICAgIGRhdGEgPSAodm9pZCAqKWJ1ZjsKPiA+ID4gPiArICAgICAgIH0KPiA+ID4gPiArCj4g
PiA+ID4gKyAgICAgICBlcnIgPSB2aXJ0cXVldWVfYWRkX2luYnVmX2N0eChycS0+dnEsIHJxLT5z
ZywgMSwgZGF0YSwgY3R4LCBnZnApOwo+ID4gPiA+ICAgICAgICAgaWYgKGVyciA8IDApCj4gPiA+
ID4gLSAgICAgICAgICAgICAgIHB1dF9wYWdlKHZpcnRfdG9faGVhZF9wYWdlKGJ1ZikpOwo+ID4g
PiA+ICsgICAgICAgICAgICAgICBnb3RvIGFkZF9lcnI7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAg
ICAgcmV0dXJuIGVycjsKPiA+ID4gPiArCj4gPiA+ID4gK2FkZF9lcnI6Cj4gPiA+ID4gKyAgICAg
ICBpZiAocnEtPmRhdGFfYXJyYXkpIHsKPiA+ID4gPiArICAgICAgICAgICAgICAgdmlydG5ldF9y
cV91bm1hcChycSwgZGF0YS0+ZG1hKTsKPiA+ID4gPiArICAgICAgICAgICAgICAgdmlydG5ldF9y
cV9yZWN5Y2xlX2RhdGEocnEsIGRhdGEpOwo+ID4gPiA+ICsgICAgICAgfQo+ID4gPiA+ICsKPiA+
ID4gPiArbWFwX2VycjoKPiA+ID4gPiArICAgICAgIHB1dF9wYWdlKHZpcnRfdG9faGVhZF9wYWdl
KGJ1ZikpOwo+ID4gPiA+ICAgICAgICAgcmV0dXJuIGVycjsKPiA+ID4gPiAgfQo+ID4gPiA+Cj4g
PiA+ID4gQEAgLTE2MjAsNiArMTg0Miw3IEBAIHN0YXRpYyBpbnQgYWRkX3JlY3ZidWZfbWVyZ2Vh
YmxlKHN0cnVjdCB2aXJ0bmV0X2luZm8gKnZpLAo+ID4gPiA+ICAgICAgICAgdW5zaWduZWQgaW50
IGhlYWRyb29tID0gdmlydG5ldF9nZXRfaGVhZHJvb20odmkpOwo+ID4gPiA+ICAgICAgICAgdW5z
aWduZWQgaW50IHRhaWxyb29tID0gaGVhZHJvb20gPyBzaXplb2Yoc3RydWN0IHNrYl9zaGFyZWRf
aW5mbykgOiAwOwo+ID4gPiA+ICAgICAgICAgdW5zaWduZWQgaW50IHJvb20gPSBTS0JfREFUQV9B
TElHTihoZWFkcm9vbSArIHRhaWxyb29tKTsKPiA+ID4gPiArICAgICAgIHN0cnVjdCB2aXJ0bmV0
X3JxX2RhdGEgKmRhdGE7Cj4gPiA+ID4gICAgICAgICBjaGFyICpidWY7Cj4gPiA+ID4gICAgICAg
ICB2b2lkICpjdHg7Cj4gPiA+ID4gICAgICAgICBpbnQgZXJyOwo+ID4gPiA+IEBAIC0xNjUwLDEy
ICsxODczLDMyIEBAIHN0YXRpYyBpbnQgYWRkX3JlY3ZidWZfbWVyZ2VhYmxlKHN0cnVjdCB2aXJ0
bmV0X2luZm8gKnZpLAo+ID4gPiA+ICAgICAgICAgICAgICAgICBhbGxvY19mcmFnLT5vZmZzZXQg
Kz0gaG9sZTsKPiA+ID4gPiAgICAgICAgIH0KPiA+ID4gPgo+ID4gPiA+IC0gICAgICAgc2dfaW5p
dF9vbmUocnEtPnNnLCBidWYsIGxlbik7Cj4gPiA+ID4gKyAgICAgICBpZiAocnEtPmRhdGFfYXJy
YXkpIHsKPiA+ID4gPiArICAgICAgICAgICAgICAgZXJyID0gdmlydG5ldF9ycV9tYXBfc2cocnEs
IGJ1ZiwgbGVuKTsKPiA+ID4gPiArICAgICAgICAgICAgICAgaWYgKGVycikKPiA+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICBnb3RvIG1hcF9lcnI7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAg
ICAgICAgICAgICBkYXRhID0gdmlydG5ldF9ycV9nZXRfZGF0YShycSwgYnVmLCBycS0+bGFzdF9k
bWEpOwo+ID4gPiA+ICsgICAgICAgfSBlbHNlIHsKPiA+ID4gPiArICAgICAgICAgICAgICAgc2df
aW5pdF9vbmUocnEtPnNnLCBidWYsIGxlbik7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgIGRhdGEg
PSAodm9pZCAqKWJ1ZjsKPiA+ID4gPiArICAgICAgIH0KPiA+ID4gPiArCj4gPiA+ID4gICAgICAg
ICBjdHggPSBtZXJnZWFibGVfbGVuX3RvX2N0eChsZW4gKyByb29tLCBoZWFkcm9vbSk7Cj4gPiA+
ID4gLSAgICAgICBlcnIgPSB2aXJ0cXVldWVfYWRkX2luYnVmX2N0eChycS0+dnEsIHJxLT5zZywg
MSwgYnVmLCBjdHgsIGdmcCk7Cj4gPiA+ID4gKyAgICAgICBlcnIgPSB2aXJ0cXVldWVfYWRkX2lu
YnVmX2N0eChycS0+dnEsIHJxLT5zZywgMSwgZGF0YSwgY3R4LCBnZnApOwo+ID4gPiA+ICAgICAg
ICAgaWYgKGVyciA8IDApCj4gPiA+ID4gLSAgICAgICAgICAgICAgIHB1dF9wYWdlKHZpcnRfdG9f
aGVhZF9wYWdlKGJ1ZikpOwo+ID4gPiA+ICsgICAgICAgICAgICAgICBnb3RvIGFkZF9lcnI7Cj4g
PiA+ID4gKwo+ID4gPiA+ICsgICAgICAgcmV0dXJuIDA7Cj4gPiA+ID4gKwo+ID4gPiA+ICthZGRf
ZXJyOgo+ID4gPiA+ICsgICAgICAgaWYgKHJxLT5kYXRhX2FycmF5KSB7Cj4gPiA+ID4gKyAgICAg
ICAgICAgICAgIHZpcnRuZXRfcnFfdW5tYXAocnEsIGRhdGEtPmRtYSk7Cj4gPiA+ID4gKyAgICAg
ICAgICAgICAgIHZpcnRuZXRfcnFfcmVjeWNsZV9kYXRhKHJxLCBkYXRhKTsKPiA+ID4gPiArICAg
ICAgIH0KPiA+ID4gPgo+ID4gPiA+ICttYXBfZXJyOgo+ID4gPiA+ICsgICAgICAgcHV0X3BhZ2Uo
dmlydF90b19oZWFkX3BhZ2UoYnVmKSk7Cj4gPiA+ID4gICAgICAgICByZXR1cm4gZXJyOwo+ID4g
PiA+ICB9Cj4gPiA+ID4KPiA+ID4gPiBAQCAtMTc3NSwxMyArMjAxOCwxMyBAQCBzdGF0aWMgaW50
IHZpcnRuZXRfcmVjZWl2ZShzdHJ1Y3QgcmVjZWl2ZV9xdWV1ZSAqcnEsIGludCBidWRnZXQsCj4g
PiA+ID4gICAgICAgICAgICAgICAgIHZvaWQgKmN0eDsKPiA+ID4gPgo+ID4gPiA+ICAgICAgICAg
ICAgICAgICB3aGlsZSAoc3RhdHMucGFja2V0cyA8IGJ1ZGdldCAmJgo+ID4gPiA+IC0gICAgICAg
ICAgICAgICAgICAgICAgKGJ1ZiA9IHZpcnRxdWV1ZV9nZXRfYnVmX2N0eChycS0+dnEsICZsZW4s
ICZjdHgpKSkgewo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgKGJ1ZiA9IHZpcnRuZXRf
cnFfZ2V0X2J1ZihycSwgJmxlbiwgJmN0eCkpKSB7Cj4gPiA+ID4gICAgICAgICAgICAgICAgICAg
ICAgICAgcmVjZWl2ZV9idWYodmksIHJxLCBidWYsIGxlbiwgY3R4LCB4ZHBfeG1pdCwgJnN0YXRz
KTsKPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0cy5wYWNrZXRzKys7Cj4gPiA+
ID4gICAgICAgICAgICAgICAgIH0KPiA+ID4gPiAgICAgICAgIH0gZWxzZSB7Cj4gPiA+ID4gICAg
ICAgICAgICAgICAgIHdoaWxlIChzdGF0cy5wYWNrZXRzIDwgYnVkZ2V0ICYmCj4gPiA+ID4gLSAg
ICAgICAgICAgICAgICAgICAgICAoYnVmID0gdmlydHF1ZXVlX2dldF9idWYocnEtPnZxLCAmbGVu
KSkgIT0gTlVMTCkgewo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgKGJ1ZiA9IHZpcnRu
ZXRfcnFfZ2V0X2J1ZihycSwgJmxlbiwgTlVMTCkpICE9IE5VTEwpIHsKPiA+ID4gPiAgICAgICAg
ICAgICAgICAgICAgICAgICByZWNlaXZlX2J1Zih2aSwgcnEsIGJ1ZiwgbGVuLCBOVUxMLCB4ZHBf
eG1pdCwgJnN0YXRzKTsKPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0cy5wYWNr
ZXRzKys7Cj4gPiA+ID4gICAgICAgICAgICAgICAgIH0KPiA+ID4gPiBAQCAtMzUxNCw2ICszNzU3
LDkgQEAgc3RhdGljIHZvaWQgdmlydG5ldF9mcmVlX3F1ZXVlcyhzdHJ1Y3QgdmlydG5ldF9pbmZv
ICp2aSkKPiA+ID4gPiAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB2aS0+bWF4X3F1ZXVlX3BhaXJz
OyBpKyspIHsKPiA+ID4gPiAgICAgICAgICAgICAgICAgX19uZXRpZl9uYXBpX2RlbCgmdmktPnJx
W2ldLm5hcGkpOwo+ID4gPiA+ICAgICAgICAgICAgICAgICBfX25ldGlmX25hcGlfZGVsKCZ2aS0+
c3FbaV0ubmFwaSk7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAgICAgICAgICBrZnJlZSh2aS0+
cnFbaV0uZGF0YV9hcnJheSk7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgIGtmcmVlKHZpLT5ycVtp
XS5kbWFfYXJyYXkpOwo+ID4gPiA+ICAgICAgICAgfQo+ID4gPiA+Cj4gPiA+ID4gICAgICAgICAv
KiBXZSBjYWxsZWQgX19uZXRpZl9uYXBpX2RlbCgpLAo+ID4gPiA+IEBAIC0zNTkxLDkgKzM4Mzcs
MTAgQEAgc3RhdGljIHZvaWQgZnJlZV91bnVzZWRfYnVmcyhzdHJ1Y3QgdmlydG5ldF9pbmZvICp2
aSkKPiA+ID4gPiAgICAgICAgIH0KPiA+ID4gPgo+ID4gPiA+ICAgICAgICAgZm9yIChpID0gMDsg
aSA8IHZpLT5tYXhfcXVldWVfcGFpcnM7IGkrKykgewo+ID4gPiA+IC0gICAgICAgICAgICAgICBz
dHJ1Y3QgdmlydHF1ZXVlICp2cSA9IHZpLT5ycVtpXS52cTsKPiA+ID4gPiAtICAgICAgICAgICAg
ICAgd2hpbGUgKChidWYgPSB2aXJ0cXVldWVfZGV0YWNoX3VudXNlZF9idWYodnEpKSAhPSBOVUxM
KQo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIHZpcnRuZXRfcnFfZnJlZV91bnVzZWRf
YnVmKHZxLCBidWYpOwo+ID4gPiA+ICsgICAgICAgICAgICAgICBzdHJ1Y3QgcmVjZWl2ZV9xdWV1
ZSAqcnEgPSAmdmktPnJxW2ldOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgICAgICAgICAgICAgd2hp
bGUgKChidWYgPSB2aXJ0bmV0X3JxX2RldGFjaF91bnVzZWRfYnVmKHJxKSkgIT0gTlVMTCkKPiA+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgICB2aXJ0bmV0X3JxX2ZyZWVfdW51c2VkX2J1Zihy
cS0+dnEsIGJ1Zik7Cj4gPiA+ID4gICAgICAgICAgICAgICAgIGNvbmRfcmVzY2hlZCgpOwo+ID4g
PiA+ICAgICAgICAgfQo+ID4gPiA+ICB9Cj4gPiA+ID4gQEAgLTM3NjcsNiArNDAxNCwxMCBAQCBz
dGF0aWMgaW50IGluaXRfdnFzKHN0cnVjdCB2aXJ0bmV0X2luZm8gKnZpKQo+ID4gPiA+ICAgICAg
ICAgaWYgKHJldCkKPiA+ID4gPiAgICAgICAgICAgICAgICAgZ290byBlcnJfZnJlZTsKPiA+ID4g
Pgo+ID4gPiA+ICsgICAgICAgcmV0ID0gdmlydG5ldF9ycV9tZXJnZV9tYXBfaW5pdCh2aSk7Cj4g
PiA+ID4gKyAgICAgICBpZiAocmV0KQo+ID4gPiA+ICsgICAgICAgICAgICAgICBnb3RvIGVycl9m
cmVlOwo+ID4gPiA+ICsKPiA+ID4gPiAgICAgICAgIGNwdXNfcmVhZF9sb2NrKCk7Cj4gPiA+ID4g
ICAgICAgICB2aXJ0bmV0X3NldF9hZmZpbml0eSh2aSk7Cj4gPiA+ID4gICAgICAgICBjcHVzX3Jl
YWRfdW5sb2NrKCk7Cj4gPiA+ID4gLS0KPiA+ID4gPiAyLjMyLjAuMy5nMDExOTVjZjlmCj4gPiA+
ID4KPiA+ID4KPiA+Cj4KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0aW9uQGxpc3RzLmxp
bnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0aW9uLm9yZy9tYWls
bWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
