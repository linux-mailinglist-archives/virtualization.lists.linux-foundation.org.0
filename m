Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
	by mail.lfdr.de (Postfix) with ESMTPS id 34660197902
	for <lists.virtualization@lfdr.de>; Mon, 30 Mar 2020 12:20:54 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by whitealder.osuosl.org (Postfix) with ESMTP id D12DB87B61;
	Mon, 30 Mar 2020 10:20:52 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 82c2-RiMlIh0; Mon, 30 Mar 2020 10:20:43 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by whitealder.osuosl.org (Postfix) with ESMTP id 1745087C5F;
	Mon, 30 Mar 2020 10:20:21 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id E4440C07FF;
	Mon, 30 Mar 2020 10:20:20 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 03639C07FF
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:20:17 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by silver.osuosl.org (Postfix) with ESMTP id E568223109
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:20:16 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id HiLMSjErvqra
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:58 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by silver.osuosl.org (Postfix) with ESMTPS id 7E99F231AB
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:54 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 DAED4305D48E; Mon, 30 Mar 2020 13:12:58 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id A88B2305B7A2;
 Mon, 30 Mar 2020 13:12:58 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v8 63/81] KVM: introspection: add KVMI_VCPU_CONTROL_CR and
 KVMI_EVENT_CR
Date: Mon, 30 Mar 2020 13:12:50 +0300
Message-Id: <20200330101308.21702-64-alazar@bitdefender.com>
In-Reply-To: <20200330101308.21702-1-alazar@bitdefender.com>
References: <20200330101308.21702-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVXNpbmcgdGhlIEtW
TUlfVkNQVV9DT05UUk9MX0NSIGNvbW1hbmQsIHRoZSBpbnRyb3NwZWN0aW9uIHRvb2wgc3Vic2Ny
aWJlcwp0byBLVk1JX0VWRU5UX0NSIGV2ZW50cyB0aGF0IHdpbGwgYmUgc2VudCB3aGVuIENSezAs
Myw0fSBpcyBnb2luZyB0bwpiZSBjaGFuZ2VkLgoKU2lnbmVkLW9mZi1ieTogTWloYWkgRG9uyJt1
IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgpDby1kZXZlbG9wZWQtYnk6IEFkYWxiZXJ0IExhesSD
ciA8YWxhemFyQGJpdGRlZmVuZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogQWRhbGJlcnQgTGF6xINy
IDxhbGF6YXJAYml0ZGVmZW5kZXIuY29tPgotLS0KIERvY3VtZW50YXRpb24vdmlydC9rdm0va3Zt
aS5yc3QgICAgICAgICAgICAgICB8ICA3MCArKysrKysrKysrKwogYXJjaC94ODYvaW5jbHVkZS9h
c20va3ZtaV9ob3N0LmggICAgICAgICAgICAgIHwgIDEwICsrCiBhcmNoL3g4Ni9pbmNsdWRlL3Vh
cGkvYXNtL2t2bWkuaCAgICAgICAgICAgICAgfCAgMTggKysrCiBhcmNoL3g4Ni9rdm0va3ZtaS5j
ICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAxMTEgKysrKysrKysrKysrKysrKysrCiBhcmNo
L3g4Ni9rdm0vdm14L3ZteC5jICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDYgKy0KIGFyY2gv
eDg2L2t2bS94ODYuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAxMiArLQogaW5jbHVk
ZS91YXBpL2xpbnV4L2t2bWkuaCAgICAgICAgICAgICAgICAgICAgIHwgICAyICsKIC4uLi90ZXN0
aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jICB8ICA5OCArKysrKysrKysrKysr
KysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyAgICAgICAgICAgICAgICAgfCAgIDEg
KwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oICAgICAgICAgICAgIHwgICA3ICsr
CiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgICAgICAgICAgICAgfCAgMTkgKyst
CiAxMSBmaWxlcyBjaGFuZ2VkLCAzNDggaW5zZXJ0aW9ucygrKSwgNiBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0IGIvRG9jdW1lbnRhdGlv
bi92aXJ0L2t2bS9rdm1pLnJzdAppbmRleCBiNjJjZmRkNjFmODkuLmM2MjRhYjU5YmQwZSAxMDA2
NDQKLS0tIGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdAorKysgYi9Eb2N1bWVudGF0
aW9uL3ZpcnQva3ZtL2t2bWkucnN0CkBAIC01NDcsNiArNTQ3LDcgQEAgRW5hYmxlcy9kaXNhYmxl
cyB2Q1BVIGludHJvc3BlY3Rpb24gZXZlbnRzLiBUaGlzIGNvbW1hbmQgY2FuIGJlIHVzZWQgd2l0
aAogdGhlIGZvbGxvd2luZyBldmVudHM6OgogCiAJS1ZNSV9FVkVOVF9CUkVBS1BPSU5UCisJS1ZN
SV9FVkVOVF9DUgogCUtWTUlfRVZFTlRfSFlQRVJDQUxMCiAKIFdoZW4gYW4gZXZlbnQgaXMgZW5h
YmxlZCwgdGhlIGludHJvc3BlY3Rpb24gdG9vbCBpcyBub3RpZmllZCBhbmQKQEAgLTY4MCw2ICs2
ODEsNDAgQEAgUmV0dXJucyBhIENQVUlEIGxlYWYgKGFzIHNlZW4gYnkgdGhlIGd1ZXN0IE9TKS4K
ICogLUtWTV9FQUdBSU4gLSB0aGUgc2VsZWN0ZWQgdkNQVSBjYW4ndCBiZSBpbnRyb3NwZWN0ZWQg
eWV0CiAqIC1LVk1fRU5PRU5UIC0gdGhlIHNlbGVjdGVkIGxlYWYgaXMgbm90IHByZXNlbnQgb3Ig
aXMgaW52YWxpZAogCisxNC4gS1ZNSV9WQ1BVX0NPTlRST0xfQ1IKKy0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQorCis6QXJjaGl0ZWN0dXJlczogeDg2Cis6VmVyc2lvbnM6ID49IDEKKzpQYXJhbWV0
ZXJzOgorCis6OgorCisJc3RydWN0IGt2bWlfdmNwdV9oZHI7CisJc3RydWN0IGt2bWlfdmNwdV9j
b250cm9sX2NyIHsKKwkJX191MTYgY3I7CisJCV9fdTggZW5hYmxlOworCQlfX3U4IHBhZGRpbmcx
OworCQlfX3UzMiBwYWRkaW5nMjsKKwl9OworCis6UmV0dXJuczoKKworOjoKKworCXN0cnVjdCBr
dm1pX2Vycm9yX2NvZGUKKworRW5hYmxlcy9kaXNhYmxlcyBpbnRyb3NwZWN0aW9uIGZvciBhIHNw
ZWNpZmljIGNvbnRyb2wgcmVnaXN0ZXIgYW5kIG11c3QKK2JlIHVzZWQgaW4gYWRkaXRpb24gdG8g
KktWTUlfVkNQVV9DT05UUk9MX0VWRU5UUyogd2l0aCB0aGUgKktWTUlfRVZFTlRfQ1IqCitJRCBz
ZXQuCisKKzpFcnJvcnM6CisKKyogLUtWTV9FSU5WQUwgLSB0aGUgc2VsZWN0ZWQgdkNQVSBpcyBp
bnZhbGlkCisqIC1LVk1fRUlOVkFMIC0gdGhlIHNwZWNpZmllZCBjb250cm9sIHJlZ2lzdGVyIGlz
IG5vdCBDUjAsIENSMyBvciBDUjQKKyogLUtWTV9FSU5WQUwgLSB0aGUgcGFkZGluZyBpcyBub3Qg
emVybworKiAtS1ZNX0VBR0FJTiAtIHRoZSBzZWxlY3RlZCB2Q1BVIGNhbid0IGJlIGludHJvc3Bl
Y3RlZCB5ZXQKKwogRXZlbnRzCiA9PT09PT0KIApAQCAtODU1LDMgKzg5MCwzOCBAQCB0cnlpbmcg
dG8gcGVyZm9ybSBhIGNlcnRhaW4gb3BlcmF0aW9uIChsaWtlIGNyZWF0aW5nIGEgcHJvY2Vzcyku
CiBgYGt2bWlfZXZlbnRgYCBhbmQgdGhlIGd1ZXN0IHBoeXNpY2FsIGFkZHJlc3MgYXJlIHNlbnQg
dG8gdGhlIGludHJvc3BlY3Rpb24gdG9vbC4KIAogVGhlICpSRVRSWSogYWN0aW9uIGlzIHVzZWQg
YnkgdGhlIGludHJvc3BlY3Rpb24gdG9vbCBmb3IgaXRzIG93biBicmVha3BvaW50cy4KKworNS4g
S1ZNSV9FVkVOVF9DUgorLS0tLS0tLS0tLS0tLS0tLQorCis6QXJjaGl0ZWN0dXJlczogeDg2Cis6
VmVyc2lvbnM6ID49IDEKKzpBY3Rpb25zOiBDT05USU5VRSwgQ1JBU0gKKzpQYXJhbWV0ZXJzOgor
Cis6OgorCisJc3RydWN0IGt2bWlfZXZlbnQ7CisJc3RydWN0IGt2bWlfZXZlbnRfY3IgeworCQlf
X3UxNiBjcjsKKwkJX191MTYgcGFkZGluZ1szXTsKKwkJX191NjQgb2xkX3ZhbHVlOworCQlfX3U2
NCBuZXdfdmFsdWU7CisJfTsKKworOlJldHVybnM6CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV92Y3B1
X2hkcjsKKwlzdHJ1Y3Qga3ZtaV9ldmVudF9yZXBseTsKKwlzdHJ1Y3Qga3ZtaV9ldmVudF9jcl9y
ZXBseSB7CisJCV9fdTY0IG5ld192YWw7CisJfTsKKworVGhpcyBldmVudCBpcyBzZW50IHdoZW4g
YSBjb250cm9sIHJlZ2lzdGVyIGlzIGdvaW5nIHRvIGJlIGNoYW5nZWQgYW5kIHRoZQoraW50cm9z
cGVjdGlvbiBoYXMgYmVlbiBlbmFibGVkIGZvciB0aGlzIGV2ZW50IGFuZCBmb3IgdGhpcyBzcGVj
aWZpYworcmVnaXN0ZXIgKHNlZSAqKktWTUlfVkNQVV9DT05UUk9MX0VWRU5UUyoqKS4KKworYGBr
dm1pX2V2ZW50YGAsIHRoZSBjb250cm9sIHJlZ2lzdGVyIG51bWJlciwgdGhlIG9sZCB2YWx1ZSBh
bmQgdGhlIG5ldyB2YWx1ZQorYXJlIHNlbnQgdG8gdGhlIGludHJvc3BlY3Rpb24gdG9vbC4gVGhl
ICpDT05USU5VRSogYWN0aW9uIHdpbGwgc2V0IHRoZSBgYG5ld192YWxgYC4KZGlmZiAtLWdpdCBh
L2FyY2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5oIGIvYXJjaC94ODYvaW5jbHVkZS9hc20v
a3ZtaV9ob3N0LmgKaW5kZXggYzhiNzkzOTE1Yjg0Li40YWMyMDljYjRlYmYgMTAwNjQ0Ci0tLSBh
L2FyY2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5oCisrKyBiL2FyY2gveDg2L2luY2x1ZGUv
YXNtL2t2bWlfaG9zdC5oCkBAIC0yLDYgKzIsOCBAQAogI2lmbmRlZiBfQVNNX1g4Nl9LVk1JX0hP
U1RfSAogI2RlZmluZSBfQVNNX1g4Nl9LVk1JX0hPU1RfSAogCisjZGVmaW5lIEtWTUlfTlVNX0NS
IDUKKwogc3RydWN0IGt2bWlfbW9uaXRvcl9pbnRlcmNlcHRpb24gewogCWJvb2wga3ZtaV9pbnRl
cmNlcHRlZDsKIAlib29sIGt2bV9pbnRlcmNlcHRlZDsKQEAgLTE0LDYgKzE2LDcgQEAgc3RydWN0
IGt2bWlfaW50ZXJjZXB0aW9uIHsKIH07CiAKIHN0cnVjdCBrdm1fdmNwdV9hcmNoX2ludHJvc3Bl
Y3Rpb24geworCURFQ0xBUkVfQklUTUFQKGNyX21hc2ssIEtWTUlfTlVNX0NSKTsKIH07CiAKIHN0
cnVjdCBrdm1fYXJjaF9pbnRyb3NwZWN0aW9uIHsKQEAgLTIyLDExICsyNSwxOCBAQCBzdHJ1Y3Qg
a3ZtX2FyY2hfaW50cm9zcGVjdGlvbiB7CiAjaWZkZWYgQ09ORklHX0tWTV9JTlRST1NQRUNUSU9O
CiAKIGJvb2wga3ZtaV9tb25pdG9yX2JwX2ludGVyY2VwdChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUs
IHUzMiBkYmcpOworYm9vbCBrdm1pX2NyX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdW5z
aWduZWQgaW50IGNyLAorCQkgICB1bnNpZ25lZCBsb25nIG9sZF92YWx1ZSwgdW5zaWduZWQgbG9u
ZyAqbmV3X3ZhbHVlKTsKK2Jvb2wga3ZtaV9jcjNfaW50ZXJjZXB0ZWQoc3RydWN0IGt2bV92Y3B1
ICp2Y3B1KTsKIAogI2Vsc2UgLyogQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OICovCiAKIHN0YXRp
YyBpbmxpbmUgYm9vbCBrdm1pX21vbml0b3JfYnBfaW50ZXJjZXB0KHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSwgdTMyIGRiZykKIAl7IHJldHVybiBmYWxzZTsgfQorc3RhdGljIGlubGluZSBib29sIGt2
bWlfY3JfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1bnNpZ25lZCBpbnQgY3IsCisJCQkJ
IHVuc2lnbmVkIGxvbmcgb2xkX3ZhbHVlLAorCQkJCSB1bnNpZ25lZCBsb25nICpuZXdfdmFsdWUp
IHsgcmV0dXJuIHRydWU7IH0KK3N0YXRpYyBpbmxpbmUgYm9vbCBrdm1pX2NyM19pbnRlcmNlcHRl
ZChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpIHsgcmV0dXJuIGZhbHNlOyB9CiAKICNlbmRpZiAvKiBD
T05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04gKi8KIApkaWZmIC0tZ2l0IGEvYXJjaC94ODYvaW5jbHVk
ZS91YXBpL2FzbS9rdm1pLmggYi9hcmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaAppbmRl
eCAxNjA1Nzc3MjU2YTMuLmEzZDI5NTU3Y2MxNSAxMDA2NDQKLS0tIGEvYXJjaC94ODYvaW5jbHVk
ZS91YXBpL2FzbS9rdm1pLmgKKysrIGIvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmgK
QEAgLTY1LDQgKzY1LDIyIEBAIHN0cnVjdCBrdm1pX2V2ZW50X2JyZWFrcG9pbnQgewogCV9fdTgg
cGFkZGluZ1s3XTsKIH07CiAKK3N0cnVjdCBrdm1pX3ZjcHVfY29udHJvbF9jciB7CisJX191MTYg
Y3I7CisJX191OCBlbmFibGU7CisJX191OCBwYWRkaW5nMTsKKwlfX3UzMiBwYWRkaW5nMjsKK307
CisKK3N0cnVjdCBrdm1pX2V2ZW50X2NyIHsKKwlfX3UxNiBjcjsKKwlfX3UxNiBwYWRkaW5nWzNd
OworCV9fdTY0IG9sZF92YWx1ZTsKKwlfX3U2NCBuZXdfdmFsdWU7Cit9OworCitzdHJ1Y3Qga3Zt
aV9ldmVudF9jcl9yZXBseSB7CisJX191NjQgbmV3X3ZhbDsKK307CisKICNlbmRpZiAvKiBfVUFQ
SV9BU01fWDg2X0tWTUlfSCAqLwpkaWZmIC0tZ2l0IGEvYXJjaC94ODYva3ZtL2t2bWkuYyBiL2Fy
Y2gveDg2L2t2bS9rdm1pLmMKaW5kZXggNzRmY2E1NjZhNDRhLi4yZTAwZjBjNTMwZjIgMTAwNjQ0
Ci0tLSBhL2FyY2gveDg2L2t2bS9rdm1pLmMKKysrIGIvYXJjaC94ODYva3ZtL2t2bWkuYwpAQCAt
MzkwLDMgKzM5MCwxMTQgQEAgdm9pZCBrdm1pX2FyY2hfcmVxdWVzdF9yZXN0b3JlX2ludGVyY2Vw
dGlvbihzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCiAJaWYgKGFyY2hfdmNwdWkpCiAJCWFyY2hfdmNw
dWktPnJlc3RvcmVfaW50ZXJjZXB0aW9uID0gdHJ1ZTsKIH0KKworaW50IGt2bWlfYXJjaF9jbWRf
dmNwdV9jb250cm9sX2NyKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKKwkJCQkgIGNvbnN0IHN0cnVj
dCBrdm1pX3ZjcHVfY29udHJvbF9jciAqcmVxKQoreworCXUzMiBjciA9IHJlcS0+Y3I7CisKKwlp
ZiAocmVxLT5wYWRkaW5nMSB8fCByZXEtPnBhZGRpbmcyIHx8IHJlcS0+ZW5hYmxlID4gMSkKKwkJ
cmV0dXJuIC1LVk1fRUlOVkFMOworCisJc3dpdGNoIChjcikgeworCWNhc2UgMDoKKwkJYnJlYWs7
CisJY2FzZSAzOgorCQlrdm1feDg2X29wcy0+Y29udHJvbF9jcjNfaW50ZXJjZXB0KHZjcHUsIENS
X1RZUEVfVywKKwkJCQkJCSAgIHJlcS0+ZW5hYmxlID09IDEpOworCQlicmVhazsKKwljYXNlIDQ6
CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCXJldHVybiAtS1ZNX0VJTlZBTDsKKwl9CisKKwlpZiAo
cmVxLT5lbmFibGUpCisJCXNldF9iaXQoY3IsIFZDUFVJKHZjcHUpLT5hcmNoLmNyX21hc2spOwor
CWVsc2UKKwkJY2xlYXJfYml0KGNyLCBWQ1BVSSh2Y3B1KS0+YXJjaC5jcl9tYXNrKTsKKworCXJl
dHVybiAwOworfQorCitzdGF0aWMgdTMyIGt2bWlfc2VuZF9jcihzdHJ1Y3Qga3ZtX3ZjcHUgKnZj
cHUsIHUzMiBjciwgdTY0IG9sZF92YWx1ZSwKKwkJCXU2NCBuZXdfdmFsdWUsIHU2NCAqcmV0X3Zh
bHVlKQoreworCXN0cnVjdCBrdm1pX2V2ZW50X2NyIGU7CisJc3RydWN0IGt2bWlfZXZlbnRfY3Jf
cmVwbHkgcjsKKwlpbnQgZXJyLCBhY3Rpb247CisKKwltZW1zZXQoJmUsIDAsIHNpemVvZihlKSk7
CisJZS5jciA9IGNyOworCWUub2xkX3ZhbHVlID0gb2xkX3ZhbHVlOworCWUubmV3X3ZhbHVlID0g
bmV3X3ZhbHVlOworCisJZXJyID0ga3ZtaV9zZW5kX2V2ZW50KHZjcHUsIEtWTUlfRVZFTlRfQ1Is
ICZlLCBzaXplb2YoZSksCisJCQkgICAgICAmciwgc2l6ZW9mKHIpLCAmYWN0aW9uKTsKKwlpZiAo
ZXJyKQorCQlyZXR1cm4gS1ZNSV9FVkVOVF9BQ1RJT05fQ09OVElOVUU7CisKKwkqcmV0X3ZhbHVl
ID0gci5uZXdfdmFsOworCXJldHVybiBhY3Rpb247Cit9CisKK3N0YXRpYyBib29sIF9fa3ZtaV9j
cl9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHVuc2lnbmVkIGludCBjciwKKwkJCSAgICB1
bnNpZ25lZCBsb25nIG9sZF92YWx1ZSwgdW5zaWduZWQgbG9uZyAqbmV3X3ZhbHVlKQoreworCXU2
NCByZXRfdmFsdWUgPSAqbmV3X3ZhbHVlOworCWJvb2wgcmV0ID0gZmFsc2U7CisJdTMyIGFjdGlv
bjsKKworCWlmICghdGVzdF9iaXQoY3IsIFZDUFVJKHZjcHUpLT5hcmNoLmNyX21hc2spKQorCQly
ZXR1cm4gdHJ1ZTsKKworCWFjdGlvbiA9IGt2bWlfc2VuZF9jcih2Y3B1LCBjciwgb2xkX3ZhbHVl
LCAqbmV3X3ZhbHVlLCAmcmV0X3ZhbHVlKTsKKwlzd2l0Y2ggKGFjdGlvbikgeworCWNhc2UgS1ZN
SV9FVkVOVF9BQ1RJT05fQ09OVElOVUU6CisJCSpuZXdfdmFsdWUgPSByZXRfdmFsdWU7CisJCXJl
dCA9IHRydWU7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCWt2bWlfaGFuZGxlX2NvbW1vbl9ldmVu
dF9hY3Rpb25zKHZjcHUtPmt2bSwgYWN0aW9uLCAiQ1IiKTsKKwl9CisKKwlyZXR1cm4gcmV0Owor
fQorCitib29sIGt2bWlfY3JfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1bnNpZ25lZCBp
bnQgY3IsCisJCSAgIHVuc2lnbmVkIGxvbmcgb2xkX3ZhbHVlLCB1bnNpZ25lZCBsb25nICpuZXdf
dmFsdWUpCit7CisJc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pOworCWJvb2wgcmV0ID0g
dHJ1ZTsKKworCWlmIChvbGRfdmFsdWUgPT0gKm5ld192YWx1ZSkKKwkJcmV0dXJuIHRydWU7CisK
Kwlrdm1pID0ga3ZtaV9nZXQodmNwdS0+a3ZtKTsKKwlpZiAoIWt2bWkpCisJCXJldHVybiB0cnVl
OworCisJaWYgKGlzX2V2ZW50X2VuYWJsZWQodmNwdSwgS1ZNSV9FVkVOVF9DUikpCisJCXJldCA9
IF9fa3ZtaV9jcl9ldmVudCh2Y3B1LCBjciwgb2xkX3ZhbHVlLCBuZXdfdmFsdWUpOworCisJa3Zt
aV9wdXQodmNwdS0+a3ZtKTsKKworCXJldHVybiByZXQ7Cit9CisKK2Jvb2wga3ZtaV9jcjNfaW50
ZXJjZXB0ZWQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQoreworCXN0cnVjdCBrdm1faW50cm9zcGVj
dGlvbiAqa3ZtaTsKKwlib29sIHJldDsKKworCWt2bWkgPSBrdm1pX2dldCh2Y3B1LT5rdm0pOwor
CWlmICgha3ZtaSkKKwkJcmV0dXJuIGZhbHNlOworCisJcmV0ID0gdGVzdF9iaXQoMywgVkNQVUko
dmNwdSktPmFyY2guY3JfbWFzayk7CisKKwlrdm1pX3B1dCh2Y3B1LT5rdm0pOworCisJcmV0dXJu
IHJldDsKK30KK0VYUE9SVF9TWU1CT0woa3ZtaV9jcjNfaW50ZXJjZXB0ZWQpOwpkaWZmIC0tZ2l0
IGEvYXJjaC94ODYva3ZtL3ZteC92bXguYyBiL2FyY2gveDg2L2t2bS92bXgvdm14LmMKaW5kZXgg
NGI3MDQ0MTkzOTE3Li5mZjcwNWI0ZWVlMTkgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS92bXgv
dm14LmMKKysrIGIvYXJjaC94ODYva3ZtL3ZteC92bXguYwpAQCAtNDg4NSw3ICs0ODg1LDggQEAg
c3RhdGljIGludCBoYW5kbGVfY3Ioc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQogCQkJZXJyID0gaGFu
ZGxlX3NldF9jcjAodmNwdSwgdmFsKTsKIAkJCXJldHVybiBrdm1fY29tcGxldGVfaW5zbl9ncCh2
Y3B1LCBlcnIpOwogCQljYXNlIDM6Ci0JCQlXQVJOX09OX09OQ0UoZW5hYmxlX3VucmVzdHJpY3Rl
ZF9ndWVzdCk7CisJCQlXQVJOX09OX09OQ0UoZW5hYmxlX3VucmVzdHJpY3RlZF9ndWVzdCAmJgor
CQkJCSAgICAgIWt2bWlfY3IzX2ludGVyY2VwdGVkKHZjcHUpKTsKIAkJCWVyciA9IGt2bV9zZXRf
Y3IzKHZjcHUsIHZhbCk7CiAJCQlyZXR1cm4ga3ZtX2NvbXBsZXRlX2luc25fZ3AodmNwdSwgZXJy
KTsKIAkJY2FzZSA0OgpAQCAtNDkxOCw3ICs0OTE5LDggQEAgc3RhdGljIGludCBoYW5kbGVfY3Io
c3RydWN0IGt2bV92Y3B1ICp2Y3B1KQogCWNhc2UgMTogLyptb3YgZnJvbSBjciovCiAJCXN3aXRj
aCAoY3IpIHsKIAkJY2FzZSAzOgotCQkJV0FSTl9PTl9PTkNFKGVuYWJsZV91bnJlc3RyaWN0ZWRf
Z3Vlc3QpOworCQkJV0FSTl9PTl9PTkNFKGVuYWJsZV91bnJlc3RyaWN0ZWRfZ3Vlc3QgJiYKKwkJ
CQkgICAgICFrdm1pX2NyM19pbnRlcmNlcHRlZCh2Y3B1KSk7CiAJCQl2YWwgPSBrdm1fcmVhZF9j
cjModmNwdSk7CiAJCQlrdm1fcmVnaXN0ZXJfd3JpdGUodmNwdSwgcmVnLCB2YWwpOwogCQkJdHJh
Y2Vfa3ZtX2NyX3JlYWQoY3IsIHZhbCk7CmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9rdm0veDg2LmMg
Yi9hcmNoL3g4Ni9rdm0veDg2LmMKaW5kZXggMzEyNzNjNGM3ZjhkLi41Yjg4NTQwMzg0YjQgMTAw
NjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS94ODYuYworKysgYi9hcmNoL3g4Ni9rdm0veDg2LmMKQEAg
LTc3Myw2ICs3NzMsOSBAQCBpbnQga3ZtX3NldF9jcjAoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1
bnNpZ25lZCBsb25nIGNyMCkKIAlpZiAoIShjcjAgJiBYODZfQ1IwX1BHKSAmJiBrdm1fcmVhZF9j
cjRfYml0cyh2Y3B1LCBYODZfQ1I0X1BDSURFKSkKIAkJcmV0dXJuIDE7CiAKKwlpZiAoIWt2bWlf
Y3JfZXZlbnQodmNwdSwgMCwgb2xkX2NyMCwgJmNyMCkpCisJCXJldHVybiAxOworCiAJa3ZtX3g4
Nl9vcHMtPnNldF9jcjAodmNwdSwgY3IwKTsKIAogCWlmICgoY3IwIF4gb2xkX2NyMCkgJiBYODZf
Q1IwX1BHKSB7CkBAIC05NTAsNiArOTUzLDkgQEAgaW50IGt2bV9zZXRfY3I0KHN0cnVjdCBrdm1f
dmNwdSAqdmNwdSwgdW5zaWduZWQgbG9uZyBjcjQpCiAJCQlyZXR1cm4gMTsKIAl9CiAKKwlpZiAo
IWt2bWlfY3JfZXZlbnQodmNwdSwgNCwgb2xkX2NyNCwgJmNyNCkpCisJCXJldHVybiAxOworCiAJ
aWYgKGt2bV94ODZfb3BzLT5zZXRfY3I0KHZjcHUsIGNyNCkpCiAJCXJldHVybiAxOwogCkBAIC05
NjYsNiArOTcyLDcgQEAgRVhQT1JUX1NZTUJPTF9HUEwoa3ZtX3NldF9jcjQpOwogCiBpbnQga3Zt
X3NldF9jcjMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1bnNpZ25lZCBsb25nIGNyMykKIHsKKwl1
bnNpZ25lZCBsb25nIG9sZF9jcjMgPSBrdm1fcmVhZF9jcjModmNwdSk7CiAJYm9vbCBza2lwX3Rs
Yl9mbHVzaCA9IGZhbHNlOwogI2lmZGVmIENPTkZJR19YODZfNjQKIAlib29sIHBjaWRfZW5hYmxl
ZCA9IGt2bV9yZWFkX2NyNF9iaXRzKHZjcHUsIFg4Nl9DUjRfUENJREUpOwpAQCAtOTc2LDcgKzk4
Myw3IEBAIGludCBrdm1fc2V0X2NyMyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHVuc2lnbmVkIGxv
bmcgY3IzKQogCX0KICNlbmRpZgogCi0JaWYgKGNyMyA9PSBrdm1fcmVhZF9jcjModmNwdSkgJiYg
IXBkcHRyc19jaGFuZ2VkKHZjcHUpKSB7CisJaWYgKGNyMyA9PSBvbGRfY3IzICYmICFwZHB0cnNf
Y2hhbmdlZCh2Y3B1KSkgewogCQlpZiAoIXNraXBfdGxiX2ZsdXNoKSB7CiAJCQlrdm1fbW11X3N5
bmNfcm9vdHModmNwdSk7CiAJCQlrdm1fbWFrZV9yZXF1ZXN0KEtWTV9SRVFfVExCX0ZMVVNILCB2
Y3B1KTsKQEAgLTk5MSw2ICs5OTgsOSBAQCBpbnQga3ZtX3NldF9jcjMoc3RydWN0IGt2bV92Y3B1
ICp2Y3B1LCB1bnNpZ25lZCBsb25nIGNyMykKIAkJICFsb2FkX3BkcHRycyh2Y3B1LCB2Y3B1LT5h
cmNoLndhbGtfbW11LCBjcjMpKQogCQlyZXR1cm4gMTsKIAorCWlmICgha3ZtaV9jcl9ldmVudCh2
Y3B1LCAzLCBvbGRfY3IzLCAmY3IzKSkKKwkJcmV0dXJuIDE7CisKIAlrdm1fbW11X25ld19jcjMo
dmNwdSwgY3IzLCBza2lwX3RsYl9mbHVzaCk7CiAJdmNwdS0+YXJjaC5jcjMgPSBjcjM7CiAJa3Zt
X3JlZ2lzdGVyX21hcmtfYXZhaWxhYmxlKHZjcHUsIFZDUFVfRVhSRUdfQ1IzKTsKZGlmZiAtLWdp
dCBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmggYi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5o
CmluZGV4IGY2NzkyZDQxYjAyZi4uMjgyNmFjMGY3NGU1IDEwMDY0NAotLS0gYS9pbmNsdWRlL3Vh
cGkvbGludXgva3ZtaS5oCisrKyBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKQEAgLTMxLDYg
KzMxLDcgQEAgZW51bSB7CiAJS1ZNSV9WQ1BVX0dFVF9SRUdJU1RFUlMgID0gMTIsCiAJS1ZNSV9W
Q1BVX1NFVF9SRUdJU1RFUlMgID0gMTMsCiAJS1ZNSV9WQ1BVX0dFVF9DUFVJRCAgICAgID0gMTQs
CisJS1ZNSV9WQ1BVX0NPTlRST0xfQ1IgICAgID0gMTUsCiAKIAlLVk1JX05VTV9NRVNTQUdFUwog
fTsKQEAgLTQwLDYgKzQxLDcgQEAgZW51bSB7CiAJS1ZNSV9FVkVOVF9QQVVTRV9WQ1BVID0gMSwK
IAlLVk1JX0VWRU5UX0hZUEVSQ0FMTCAgPSAyLAogCUtWTUlfRVZFTlRfQlJFQUtQT0lOVCA9IDMs
CisJS1ZNSV9FVkVOVF9DUiAgICAgICAgID0gNCwKIAogCUtWTUlfTlVNX0VWRU5UUwogfTsKZGlm
ZiAtLWdpdCBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMg
Yi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCmluZGV4IGRh
YjAxNTU1NWY4OS4uOTU5NWU4NmNkNzllIDEwMDY0NAotLS0gYS90b29scy90ZXN0aW5nL3NlbGZ0
ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCisrKyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3Rz
L2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKQEAgLTUwLDYgKzUwLDcgQEAgc3RydWN0IHZjcHVfd29y
a2VyX2RhdGEgewogZW51bSB7CiAJR1VFU1RfVEVTVF9OT09QID0gMCwKIAlHVUVTVF9URVNUX0JQ
LAorCUdVRVNUX1RFU1RfQ1IsCiAJR1VFU1RfVEVTVF9IWVBFUkNBTEwsCiB9OwogCkBAIC02OSw2
ICs3MCwxMSBAQCBzdGF0aWMgdm9pZCBndWVzdF9icF90ZXN0KHZvaWQpCiAJYXNtIHZvbGF0aWxl
KCJpbnQzIik7CiB9CiAKK3N0YXRpYyB2b2lkIGd1ZXN0X2NyX3Rlc3Qodm9pZCkKK3sKKwlzZXRf
Y3I0KGdldF9jcjQoKSB8IFg4Nl9DUjRfT1NYU0FWRSk7Cit9CisKIHN0YXRpYyB2b2lkIGd1ZXN0
X2h5cGVyY2FsbF90ZXN0KHZvaWQpCiB7CiAJYXNtIHZvbGF0aWxlKCJtb3YgJDM0LCAlcmF4Iik7
CkBAIC04Niw2ICs5Miw5IEBAIHN0YXRpYyB2b2lkIGd1ZXN0X2NvZGUodm9pZCkKIAkJY2FzZSBH
VUVTVF9URVNUX0JQOgogCQkJZ3Vlc3RfYnBfdGVzdCgpOwogCQkJYnJlYWs7CisJCWNhc2UgR1VF
U1RfVEVTVF9DUjoKKwkJCWd1ZXN0X2NyX3Rlc3QoKTsKKwkJCWJyZWFrOwogCQljYXNlIEdVRVNU
X1RFU1RfSFlQRVJDQUxMOgogCQkJZ3Vlc3RfaHlwZXJjYWxsX3Rlc3QoKTsKIAkJCWJyZWFrOwpA
QCAtMTAyOSw2ICsxMDM4LDk0IEBAIHN0YXRpYyB2b2lkIHRlc3RfZXZlbnRfYnJlYWtwb2ludChz
dHJ1Y3Qga3ZtX3ZtICp2bSkKIAlkaXNhYmxlX3ZjcHVfZXZlbnQodm0sIGV2ZW50X2lkKTsKIH0K
IAorc3RhdGljIGludCBjbWRfY29udHJvbF9jcihzdHJ1Y3Qga3ZtX3ZtICp2bSwgX191MzIgY3Is
IGJvb2wgZW5hYmxlKQoreworCXN0cnVjdCB7CisJCXN0cnVjdCBrdm1pX21zZ19oZHIgaGRyOwor
CQlzdHJ1Y3Qga3ZtaV92Y3B1X2hkciB2Y3B1X2hkcjsKKwkJc3RydWN0IGt2bWlfdmNwdV9jb250
cm9sX2NyIGNtZDsKKwl9IHJlcSA9IHt9OworCisJcmVxLmNtZC5jciA9IGNyOworCXJlcS5jbWQu
ZW5hYmxlID0gZW5hYmxlID8gMSA6IDA7CisKKwlyZXR1cm4gZG9fdmNwdTBfY29tbWFuZCh2bSwg
S1ZNSV9WQ1BVX0NPTlRST0xfQ1IsICZyZXEuaGRyLCBzaXplb2YocmVxKSwKKwkJCQlOVUxMLCAw
KTsKK30KKworc3RhdGljIHZvaWQgZW5hYmxlX2NyX2V2ZW50cyhzdHJ1Y3Qga3ZtX3ZtICp2bSwg
X191MzIgY3IpCit7CisJaW50IHI7CisKKwllbmFibGVfdmNwdV9ldmVudCh2bSwgS1ZNSV9FVkVO
VF9DUik7CisKKwlyID0gY21kX2NvbnRyb2xfY3Iodm0sIGNyLCB0cnVlKTsKKwlURVNUX0FTU0VS
VChyID09IDAsCisJCSJLVk1JX1ZDUFVfQ09OVFJPTF9DUiBmYWlsZWQsIGVycm9yICVkKCVzKVxu
IiwKKwkJLXIsIGt2bV9zdHJlcnJvcigtcikpOworfQorCitzdGF0aWMgdm9pZCBkaXNhYmxlX2Ny
X2V2ZW50cyhzdHJ1Y3Qga3ZtX3ZtICp2bSwgX191MzIgY3IpCit7CisJaW50IHI7CisKKwlyID0g
Y21kX2NvbnRyb2xfY3Iodm0sIGNyLCBmYWxzZSk7CisJVEVTVF9BU1NFUlQociA9PSAwLAorCQki
S1ZNSV9WQ1BVX0NPTlRST0xfQ1IgZmFpbGVkLCBlcnJvciAlZCglcylcbiIsCisJCS1yLCBrdm1f
c3RyZXJyb3IoLXIpKTsKKworCWRpc2FibGVfdmNwdV9ldmVudCh2bSwgS1ZNSV9FVkVOVF9DUik7
Cit9CisKK3N0YXRpYyB2b2lkIHRlc3RfY21kX3ZjcHVfY29udHJvbF9jcihzdHJ1Y3Qga3ZtX3Zt
ICp2bSkKK3sKKwlzdHJ1Y3QgdmNwdV93b3JrZXJfZGF0YSBkYXRhID0geworCQkudm0gPSB2bSwK
KwkJLnZjcHVfaWQgPSBWQ1BVX0lELAorCQkudGVzdF9pZCA9IEdVRVNUX1RFU1RfQ1IsCisJfTsK
KwlzdHJ1Y3Qga3ZtaV9tc2dfaGRyIGhkcjsKKwlzdHJ1Y3QgeworCQlzdHJ1Y3Qga3ZtaV9ldmVu
dCBjb21tb247CisJCXN0cnVjdCBrdm1pX2V2ZW50X2NyIGNyOworCX0gZXY7CisJc3RydWN0IHsK
KwkJc3RydWN0IHZjcHVfcmVwbHkgY29tbW9uOworCQlzdHJ1Y3Qga3ZtaV9ldmVudF9jcl9yZXBs
eSBjcjsKKwl9IHJwbCA9IHt9OworCV9fdTE2IGV2ZW50X2lkID0gS1ZNSV9FVkVOVF9DUjsKKwlf
X3UzMiBjcl9ubyA9IDQ7CisJc3RydWN0IGt2bV9zcmVncyBzcmVnczsKKwlwdGhyZWFkX3QgdmNw
dV90aHJlYWQ7CisKKwllbmFibGVfY3JfZXZlbnRzKHZtLCBjcl9ubyk7CisKKwl2Y3B1X3RocmVh
ZCA9IHN0YXJ0X3ZjcHVfd29ya2VyKCZkYXRhKTsKKworCXJlY2VpdmVfZXZlbnQoJmhkciwgJmV2
LmNvbW1vbiwgc2l6ZW9mKGV2KSwgZXZlbnRfaWQpOworCisJREVCVUcoIkNSJXUsIG9sZCAweCVs
bHgsIG5ldyAweCVsbHhcbiIsCisJCWV2LmNyLmNyLCBldi5jci5vbGRfdmFsdWUsIGV2LmNyLm5l
d192YWx1ZSk7CisKKwlURVNUX0FTU0VSVChldi5jci5jciA9PSBjcl9ubywKKwkJIlVuZXhwZWN0
ZWQgQ1IgZXZlbnQsIHJlY2VpdmVkIENSJXUsIGV4cGVjdGVkIENSJXUiLAorCQlldi5jci5jciwg
Y3Jfbm8pOworCisJcnBsLmNyLm5ld192YWwgPSBldi5jci5vbGRfdmFsdWU7CisKKwlyZXBseV90
b19ldmVudCgmaGRyLCAmZXYuY29tbW9uLCBLVk1JX0VWRU5UX0FDVElPTl9DT05USU5VRSwKKwkJ
CSZycGwuY29tbW9uLCBzaXplb2YocnBsKSk7CisKKwlzdG9wX3ZjcHVfd29ya2VyKHZjcHVfdGhy
ZWFkLCAmZGF0YSk7CisKKwlkaXNhYmxlX2NyX2V2ZW50cyh2bSwgY3Jfbm8pOworCisJdmNwdV9z
cmVnc19nZXQodm0sIFZDUFVfSUQsICZzcmVncyk7CisJVEVTVF9BU1NFUlQoc3JlZ3MuY3I0ID09
IGV2LmNyLm9sZF92YWx1ZSwKKwkJIkZhaWxlZCB0byBibG9jayBDUjQgdXBkYXRlLCBDUjQgMHgl
eCwgZXhwZWN0ZWQgMHgleCIsCisJCXNyZWdzLmNyNCwgZXYuY3Iub2xkX3ZhbHVlKTsKK30KKwog
c3RhdGljIHZvaWQgdGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQogewogCXNy
YW5kb20odGltZSgwKSk7CkBAIC0xMDUxLDYgKzExNDgsNyBAQCBzdGF0aWMgdm9pZCB0ZXN0X2lu
dHJvc3BlY3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCiAJdGVzdF9jbWRfdmNwdV9nZXRfY3B1aWQo
dm0pOwogCXRlc3RfZXZlbnRfaHlwZXJjYWxsKHZtKTsKIAl0ZXN0X2V2ZW50X2JyZWFrcG9pbnQo
dm0pOworCXRlc3RfY21kX3ZjcHVfY29udHJvbF9jcih2bSk7CiAKIAl1bmhvb2tfaW50cm9zcGVj
dGlvbih2bSk7CiB9CmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyBi
L3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCmluZGV4IDdlYTA1MTJiYzU4MC4uNmQ0MjFj
ZjIxM2Q3IDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYworKysgYi92
aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwpAQCAtNzksNiArNzksNyBAQCBzdGF0aWMgdm9p
ZCBzZXR1cF9rbm93bl9ldmVudHModm9pZCkKIAogCWJpdG1hcF96ZXJvKEt2bWlfa25vd25fdmNw
dV9ldmVudHMsIEtWTUlfTlVNX0VWRU5UUyk7CiAJc2V0X2JpdChLVk1JX0VWRU5UX0JSRUFLUE9J
TlQsIEt2bWlfa25vd25fdmNwdV9ldmVudHMpOworCXNldF9iaXQoS1ZNSV9FVkVOVF9DUiwgS3Zt
aV9rbm93bl92Y3B1X2V2ZW50cyk7CiAJc2V0X2JpdChLVk1JX0VWRU5UX0hZUEVSQ0FMTCwgS3Zt
aV9rbm93bl92Y3B1X2V2ZW50cyk7CiAJc2V0X2JpdChLVk1JX0VWRU5UX1BBVVNFX1ZDUFUsIEt2
bWlfa25vd25fdmNwdV9ldmVudHMpOwogCmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0
aW9uL2t2bWlfaW50LmggYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmgKaW5kZXgg
NzAyNGJmYTNkZjYxLi41ODhhMzg2YTNmMzcgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3Bl
Y3Rpb24va3ZtaV9pbnQuaAorKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmgK
QEAgLTMzLDYgKzMzLDkgQEAgYm9vbCBrdm1pX3NvY2tfZ2V0KHN0cnVjdCBrdm1faW50cm9zcGVj
dGlvbiAqa3ZtaSwgaW50IGZkKTsKIHZvaWQga3ZtaV9zb2NrX3NodXRkb3duKHN0cnVjdCBrdm1f
aW50cm9zcGVjdGlvbiAqa3ZtaSk7CiB2b2lkIGt2bWlfc29ja19wdXQoc3RydWN0IGt2bV9pbnRy
b3NwZWN0aW9uICprdm1pKTsKIGJvb2wga3ZtaV9tc2dfcHJvY2VzcyhzdHJ1Y3Qga3ZtX2ludHJv
c3BlY3Rpb24gKmt2bWkpOworaW50IGt2bWlfc2VuZF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZj
cHUsIHUzMiBldl9pZCwKKwkJICAgIHZvaWQgKmV2LCBzaXplX3QgZXZfc2l6ZSwKKwkJICAgIHZv
aWQgKnJwbCwgc2l6ZV90IHJwbF9zaXplLCBpbnQgKmFjdGlvbik7CiBpbnQga3ZtaV9tc2dfc2Vu
ZF91bmhvb2soc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pKTsKIHUzMiBrdm1pX21zZ19z
ZW5kX3ZjcHVfcGF1c2Uoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIHUzMiBrdm1pX21zZ19zZW5k
X2h5cGVyY2FsbChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwpAQCAtNDksNiArNTIsOCBAQCB2b2lk
IGt2bWlfcnVuX2pvYnMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIHZvaWQga3ZtaV9wb3N0X3Jl
cGx5KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7CiB2b2lkIGt2bWlfaGFuZGxlX2NvbW1vbl9ldmVu
dF9hY3Rpb25zKHN0cnVjdCBrdm0gKmt2bSwKIAkJCQkgICAgICB1MzIgYWN0aW9uLCBjb25zdCBj
aGFyICpzdHIpOworc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICogX19tdXN0X2NoZWNrIGt2bWlf
Z2V0KHN0cnVjdCBrdm0gKmt2bSk7Cit2b2lkIGt2bWlfcHV0KHN0cnVjdCBrdm0gKmt2bSk7CiBp
bnQga3ZtaV9jbWRfdm1fY29udHJvbF9ldmVudHMoc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICpr
dm1pLAogCQkJCXVuc2lnbmVkIGludCBldmVudF9pZCwgYm9vbCBlbmFibGUpOwogaW50IGt2bWlf
Y21kX3ZjcHVfY29udHJvbF9ldmVudHMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LApAQCAtODgsNSAr
OTMsNyBAQCB2b2lkIGt2bWlfYXJjaF9oeXBlcmNhbGxfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2
Y3B1KTsKIHZvaWQga3ZtaV9hcmNoX2JyZWFrcG9pbnRfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2
Y3B1LCB1NjQgZ3ZhLCB1OCBpbnNuX2xlbik7CiBpbnQga3ZtaV9hcmNoX2NtZF9jb250cm9sX2lu
dGVyY2VwdChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCiAJCQkJICAgIHVuc2lnbmVkIGludCBldmVu
dF9pZCwgYm9vbCBlbmFibGUpOworaW50IGt2bWlfYXJjaF9jbWRfdmNwdV9jb250cm9sX2NyKHN0
cnVjdCBrdm1fdmNwdSAqdmNwdSwKKwkJCQkgIGNvbnN0IHN0cnVjdCBrdm1pX3ZjcHVfY29udHJv
bF9jciAqcmVxKTsKIAogI2VuZGlmCmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9u
L2t2bWlfbXNnLmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKaW5kZXggOGU0
NTFhZDUzNGU0Li43ODlhYTlmMTkxMmYgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rp
b24va3ZtaV9tc2cuYworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKQEAg
LTI4LDYgKzI4LDcgQEAgc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IG1zZ19JRHNbXSA9IHsKIAlb
S1ZNSV9WTV9HRVRfSU5GT10gICAgICAgICA9ICJLVk1JX1ZNX0dFVF9JTkZPIiwKIAlbS1ZNSV9W
TV9SRUFEX1BIWVNJQ0FMXSAgICA9ICJLVk1JX1ZNX1JFQURfUEhZU0lDQUwiLAogCVtLVk1JX1ZN
X1dSSVRFX1BIWVNJQ0FMXSAgID0gIktWTUlfVk1fV1JJVEVfUEhZU0lDQUwiLAorCVtLVk1JX1ZD
UFVfQ09OVFJPTF9DUl0gICAgID0gIktWTUlfVkNQVV9DT05UUk9MX0NSIiwKIAlbS1ZNSV9WQ1BV
X0NPTlRST0xfRVZFTlRTXSA9ICJLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMiLAogCVtLVk1JX1ZD
UFVfR0VUX0NQVUlEXSAgICAgID0gIktWTUlfVkNQVV9HRVRfQ1BVSUQiLAogCVtLVk1JX1ZDUFVf
R0VUX0lORk9dICAgICAgID0gIktWTUlfVkNQVV9HRVRfSU5GTyIsCkBAIC01MTQsNiArNTE1LDE3
IEBAIHN0YXRpYyBpbnQgaGFuZGxlX2dldF9jcHVpZChjb25zdCBzdHJ1Y3Qga3ZtaV92Y3B1X2Nt
ZF9qb2IgKmpvYiwKIAlyZXR1cm4ga3ZtaV9tc2dfdmNwdV9yZXBseShqb2IsIG1zZywgZWMsICZy
cGwsIHNpemVvZihycGwpKTsKIH0KIAorc3RhdGljIGludCBoYW5kbGVfdmNwdV9jb250cm9sX2Ny
KGNvbnN0IHN0cnVjdCBrdm1pX3ZjcHVfY21kX2pvYiAqam9iLAorCQkJCSAgY29uc3Qgc3RydWN0
IGt2bWlfbXNnX2hkciAqbXNnLAorCQkJCSAgY29uc3Qgdm9pZCAqcmVxKQoreworCWludCBlYzsK
KworCWVjID0ga3ZtaV9hcmNoX2NtZF92Y3B1X2NvbnRyb2xfY3Ioam9iLT52Y3B1LCByZXEpOwor
CisJcmV0dXJuIGt2bWlfbXNnX3ZjcHVfcmVwbHkoam9iLCBtc2csIGVjLCBOVUxMLCAwKTsKK30K
KwogLyoKICAqIFRoZXNlIGNvbW1hbmRzIGFyZSBleGVjdXRlZCBmcm9tIHRoZSB2Q1BVIHRocmVh
ZC4gVGhlIHJlY2VpdmluZyB0aHJlYWQKICAqIHBhc3NlcyB0aGUgbWVzc2FnZXMgdXNpbmcgYSBu
ZXdseSBhbGxvY2F0ZWQgJ3N0cnVjdCBrdm1pX3ZjcHVfY21kX2pvYicKQEAgLTUyMyw2ICs1MzUs
NyBAQCBzdGF0aWMgaW50IGhhbmRsZV9nZXRfY3B1aWQoY29uc3Qgc3RydWN0IGt2bWlfdmNwdV9j
bWRfam9iICpqb2IsCiBzdGF0aWMgaW50KCpjb25zdCBtc2dfdmNwdVtdKShjb25zdCBzdHJ1Y3Qg
a3ZtaV92Y3B1X2NtZF9qb2IgKiwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBrdm1pX21zZ19oZHIg
KiwgY29uc3Qgdm9pZCAqKSA9IHsKIAlbS1ZNSV9FVkVOVF0gICAgICAgICAgICAgICA9IGhhbmRs
ZV9ldmVudF9yZXBseSwKKwlbS1ZNSV9WQ1BVX0NPTlRST0xfQ1JdICAgICA9IGhhbmRsZV92Y3B1
X2NvbnRyb2xfY3IsCiAJW0tWTUlfVkNQVV9DT05UUk9MX0VWRU5UU10gPSBoYW5kbGVfdmNwdV9j
b250cm9sX2V2ZW50cywKIAlbS1ZNSV9WQ1BVX0dFVF9DUFVJRF0gICAgICA9IGhhbmRsZV9nZXRf
Y3B1aWQsCiAJW0tWTUlfVkNQVV9HRVRfSU5GT10gICAgICAgPSBoYW5kbGVfZ2V0X3ZjcHVfaW5m
bywKQEAgLTc4NCw5ICs3OTcsOSBAQCBzdGF0aWMgdm9pZCBrdm1pX3NldHVwX3ZjcHVfcmVwbHko
c3RydWN0IGt2bV92Y3B1X2ludHJvc3BlY3Rpb24gKnZjcHVpLAogCXZjcHVpLT53YWl0aW5nX2Zv
cl9yZXBseSA9IHRydWU7CiB9CiAKLXN0YXRpYyBpbnQga3ZtaV9zZW5kX2V2ZW50KHN0cnVjdCBr
dm1fdmNwdSAqdmNwdSwgdTMyIGV2X2lkLAotCQkJICAgdm9pZCAqZXYsIHNpemVfdCBldl9zaXpl
LAotCQkJICAgdm9pZCAqcnBsLCBzaXplX3QgcnBsX3NpemUsIGludCAqYWN0aW9uKQoraW50IGt2
bWlfc2VuZF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHUzMiBldl9pZCwKKwkJICAgIHZv
aWQgKmV2LCBzaXplX3QgZXZfc2l6ZSwKKwkJICAgIHZvaWQgKnJwbCwgc2l6ZV90IHJwbF9zaXpl
LCBpbnQgKmFjdGlvbikKIHsKIAlzdHJ1Y3Qga3ZtaV9tc2dfaGRyIGhkcjsKIAlzdHJ1Y3Qga3Zt
aV9ldmVudCBjb21tb247Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0cy5s
aW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcvbWFp
bG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
