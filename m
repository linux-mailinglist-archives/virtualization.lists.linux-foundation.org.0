Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp4.osuosl.org (smtp4.osuosl.org [IPv6:2605:bc80:3010::137])
	by mail.lfdr.de (Postfix) with ESMTPS id 8B76168D4BF
	for <lists.virtualization@lfdr.de>; Tue,  7 Feb 2023 11:48:20 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by smtp4.osuosl.org (Postfix) with ESMTP id 157D04173F;
	Tue,  7 Feb 2023 10:48:19 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 157D04173F
Authentication-Results: smtp4.osuosl.org;
	dkim=fail reason="signature verification failed" (2048-bit key) header.d=igel-co-jp.20210112.gappssmtp.com header.i=@igel-co-jp.20210112.gappssmtp.com header.a=rsa-sha256 header.s=20210112 header.b=vvI4aOQ0
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
	by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id Yk2Gevo1WR4A; Tue,  7 Feb 2023 10:48:16 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp4.osuosl.org (Postfix) with ESMTPS id 2918C41721;
	Tue,  7 Feb 2023 10:48:16 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 2918C41721
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 628C1C007C;
	Tue,  7 Feb 2023 10:48:15 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp3.osuosl.org (smtp3.osuosl.org [IPv6:2605:bc80:3010::136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 3F658C002B
 for <virtualization@lists.linux-foundation.org>;
 Tue,  7 Feb 2023 10:48:14 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp3.osuosl.org (Postfix) with ESMTP id 1904960E4B
 for <virtualization@lists.linux-foundation.org>;
 Tue,  7 Feb 2023 10:48:14 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp3.osuosl.org 1904960E4B
Authentication-Results: smtp3.osuosl.org;
 dkim=pass (2048-bit key) header.d=igel-co-jp.20210112.gappssmtp.com
 header.i=@igel-co-jp.20210112.gappssmtp.com header.a=rsa-sha256
 header.s=20210112 header.b=vvI4aOQ0
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp3.osuosl.org ([127.0.0.1])
 by localhost (smtp3.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id O6n3mtyUVjWS
 for <virtualization@lists.linux-foundation.org>;
 Tue,  7 Feb 2023 10:48:11 +0000 (UTC)
X-Greylist: whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp3.osuosl.org 8AAF160B8E
Received: from mail-vs1-xe29.google.com (mail-vs1-xe29.google.com
 [IPv6:2607:f8b0:4864:20::e29])
 by smtp3.osuosl.org (Postfix) with ESMTPS id 8AAF160B8E
 for <virtualization@lists.linux-foundation.org>;
 Tue,  7 Feb 2023 10:48:11 +0000 (UTC)
Received: by mail-vs1-xe29.google.com with SMTP id k4so15798460vsc.4
 for <virtualization@lists.linux-foundation.org>;
 Tue, 07 Feb 2023 02:48:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=igel-co-jp.20210112.gappssmtp.com; s=20210112;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:from:to:cc:subject:date
 :message-id:reply-to;
 bh=7ru0W1u7S0jk2HX+hhCvFQCrMqxoVwfc1t+bHXy90Hs=;
 b=vvI4aOQ0hrLh273+yBCr6nNkZLJeeKE+hvIJX4ZkAL14HlspmMlWVJURN9t+gKLGUK
 zTdst6aYeMhJ5IQLeFUk0n6DIyQVSRIQa7o9YB115lJe5WosT4rw3L20pxfBWGsL0BaV
 OmD5qnoX2PNG2vSGqc1CInX6Cxy+Ndkzjkj7zM98//B3H176tnOS4g3A2n0ue5u9GNZJ
 UmFP0BPAdTuq5IajxxjHSt5e/W+Y127Wrjgs5xvJNBoVJezWifO/W11AXWHga9zSedCL
 SrhpmkHyoTpzxs2SWNSSYdl5WwywFrOGSYPpJp15hGFXcPHSqiWbJb4acF3/Abq5PSU/
 MUxA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20210112;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
 :subject:date:message-id:reply-to;
 bh=7ru0W1u7S0jk2HX+hhCvFQCrMqxoVwfc1t+bHXy90Hs=;
 b=T4wE4zwDgdVreH3cim/ZZn2Hw3VsLCuZPTjlH7SDyzXCW7o63IdveB+x3PMZqR2aVP
 fVHpoPIpw46WWxSd78cl7q8lt4QFZA6VOVM4rMW2rlp921uIRkX79yaj4HY2s87baN6q
 IBGbsitkVfcabJOmLot5ju+l25G17aCnA+Izg9lKlustdsVu+3qSQQtgMtMT2EZKSxYz
 /nQXAqgBgbGRJqAQmWfo6lt01J+EwZx3uoR+oIQ+fZ+0Y7SqPoxESwgEb1/ad/MRjY9R
 pZULK/mXrG5hEv0petF8a/PnnNDnZFogKc6I83Dx/TB9h45Niwp31udAANthwThiRMwh
 64ng==
X-Gm-Message-State: AO0yUKVeu9yilsBiIvgwCbztCTUqYfyFjry/iW+Eg6mgwUTIUSHlvUUa
 IQLMSEqxbukk+Q5fN0viB9orEJyz09381jvq3vcb3w==
X-Google-Smtp-Source: AK7set+hnJ9SoCPi4cgH1rFEEe5KH703fs+bcaKw5RXgjwoNHjCF+9yMoz9rjazPPItR1ksMcjS5Eg4uXtxXnSI7jxA=
X-Received: by 2002:a67:f44e:0:b0:40e:14c9:1fa4 with SMTP id
 r14-20020a67f44e000000b0040e14c91fa4mr578970vsn.84.1675766890125; Tue, 07 Feb
 2023 02:48:10 -0800 (PST)
MIME-Version: 1.0
References: <20230203100418.2981144-1-mie@igel.co.jp>
 <20230203100418.2981144-5-mie@igel.co.jp>
 <20230203052114-mutt-send-email-mst@kernel.org>
In-Reply-To: <20230203052114-mutt-send-email-mst@kernel.org>
From: Shunsuke Mie <mie@igel.co.jp>
Date: Tue, 7 Feb 2023 19:47:59 +0900
Message-ID: <CANXvt5rqNVzFYDNR313jzn1dAjCPUuNtD=e8wFUzTvkwTkw7ew@mail.gmail.com>
Subject: Re: [RFC PATCH 4/4] PCI: endpoint: function: Add EP function driver
 to provide virtio net device
To: "Michael S. Tsirkin" <mst@redhat.com>
Cc: Kishon Vijay Abraham I <kishon@kernel.org>,
 =?UTF-8?Q?Krzysztof_Wilczy=C5=84ski?= <kw@linux.com>,
 Takanari Hayama <taki@igel.co.jp>, Manivannan Sadhasivam <mani@kernel.org>,
 linux-pci@vger.kernel.org, Lorenzo Pieralisi <lpieralisi@kernel.org>,
 Frank Li <Frank.Li@nxp.com>, linux-kernel@vger.kernel.org,
 virtualization@lists.linux-foundation.org, Ren Zhijie <renzhijie2@huawei.com>,
 Jon Mason <jdmason@kudzu.us>, Bjorn Helgaas <bhelgaas@google.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

MjAyM+W5tDLmnIgz5pelKOmHkSkgMTk6MjIgTWljaGFlbCBTLiBUc2lya2luIDxtc3RAcmVkaGF0
LmNvbT46Cj4KPiBPbiBGcmksIEZlYiAwMywgMjAyMyBhdCAwNzowNDoxOFBNICswOTAwLCBTaHVu
c3VrZSBNaWUgd3JvdGU6Cj4gPiBBZGQgYSBuZXcgZW5kcG9pbnQoRVApIGZ1bmN0aW9uIGRyaXZl
ciB0byBwcm92aWRlIHZpcnRpby1uZXQgZGV2aWNlLiBUaGlzCj4gPiBmdW5jdGlvbiBub3Qgb25s
eSBzaG93cyB2aXJ0aW8tbmV0IGRldmljZSBmb3IgUENJZSBob3N0IHN5c3RlbSwgYnV0IGFsc28K
PiA+IHByb3ZpZGVzIHZpcnRpby1uZXQgZGV2aWNlIHRvIEVQIHNpZGUobG9jYWwpIHN5c3RlbS4g
VmlydHVhbHkgdGhvc2UgbmV0d29yawo+ID4gZGV2aWNlcyBhcmUgY29ubmVjdGVkLCBzbyB3ZSBj
YW4gdXNlIHRvIGNvbW11bmljYXRlIG92ZXIgSVAgbGlrZSBhIHNpbXBsZQo+ID4gTklDLgo+ID4K
PiA+IEFyY2hpdGVjdHVyZSBvdmVydmlldyBpcyBmb2xsb3dpbmc6Cj4gPgo+ID4gdG8gSG9zdCAg
ICAgICB8ICAgICAgICAgICAgICAgICAgICAgICB0byBFbmRwb2ludAo+ID4gbmV0d29yayBzdGFj
ayB8ICAgICAgICAgICAgICAgICBuZXR3b3JrIHN0YWNrCj4gPiAgICAgICB8ICAgICAgIHwgICAg
ICAgICAgICAgICAgICAgICAgIHwKPiA+ICstLS0tLS0tLS0tLSsgfCAgICAgICArLS0tLS0tLS0t
LS0rICAgKy0tLS0tLS0tLS0tKwo+ID4gfHZpcnRpby1uZXQgfCB8ICAgICAgIHx2aXJ0aW8tbmV0
IHwgICB8dmlydGlvLW5ldCB8Cj4gPiB8ZHJpdmVyICAgICB8IHwgICAgICAgfEVQIGZ1bmN0aW9u
fC0tLXxkcml2ZXIgICAgIHwKPiA+ICstLS0tLS0tLS0tLSsgfCAgICAgICArLS0tLS0tLS0tLS0r
ICAgKy0tLS0tLS0tLS0tKwo+ID4gICAgICAgfCAgICAgICB8ICAgICAgICAgICAgIHwKPiA+ICst
LS0tLS0tLS0tLSsgfCArLS0tLS0tLS0tLS0rCj4gPiB8UENJZUMgICAgICB8IHwgfFBDSWVDICAg
ICAgfAo+ID4gfFJvb3Rjb21wbGV4fC18LXxFbmRwb2ludCAgIHwKPiA+ICstLS0tLS0tLS0tLSsg
fCArLS0tLS0tLS0tLS0rCj4gPiAgIEhvc3Qgc2lkZSAgIHwgICAgICAgICAgRW5kcG9pbnQgc2lk
ZQo+ID4KPiA+IFRoaXMgZHJpdmVyIHVzZXMgUENJZSBFUCBmcmFtZXdvcmsgdG8gc2hvdyB2aXJ0
aW8tbmV0IChwY2kpIGRldmljZSBIb3N0Cj4gPiBzaWRlLCBhbmQgZ2VuZXJhdGUgdmlydHVhbCB2
aXJ0aW8tbmV0IGRldmljZSBhbmQgcmVnaXN0ZXIgdG8gRVAgc2lkZS4KPiA+IEEgY29tbXVuaWNh
dGlvbiBkYXRlCj4KPiBkYXRhPwo+Cj4gPiBpcyBkaXJhY3RseQo+Cj4gZGlyZWN0bHk/ClNvcnJ5
LCBJIGhhdmUgdG8gcmV2aXNlIHRoaXMgY29tbWVudC4KPiA+IHRyYW5zcG9ydGVkIGJldHdlZW4g
dmlydHF1ZXVlIGxldmVsCj4gPiB3aXRoIGVhY2ggb3RoZXIgdXNpbmcgUENJZSBlbWJlZGRlZCBE
TUEgY29udHJvbGxlci4KPiA+Cj4gPiBieSBhIGxpbWl0YXRpb24gb2YgdGhlIGhhcmR3YXJlIGFu
ZCBMaW51eCBFUCBmcmFtZXdvcmssIHRoaXMgZnVuY3Rpb24KPiA+IGZvbGxvd3MgYSB2aXJ0aW8g
bGVnYWN5IHNwZWNpZmljYXRpb24uCj4KPiB3aGF0IGV4YWN0bHkgaXMgdGhlIGxpbWl0YXRpb24g
YW5kIHdoeSBkb2VzIGl0IGZvcmNlIGxlZ2FjeT8KTW9kZXJuIHZpcnRpbyBwY2kgZGV2aWNlIGhh
dmUgdG8gcHJvdmlkZSBhIHZpcnRpbyBwY2kgY2FwYWJpbGl0eSwKRGVzaWdud2FyZSdzIFBDSWUg
Y29udHJvbGxlciBpcyBlcXVpcHBlZCB0byBzZXZlcmFsIGJvYXJkcy4gVGhlcmUgaXMKbm8gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25hbGl0eSBpbiB0aGUK
Y29udHJvbGxlciB0byBpbXBsZW1lbnQgY3VzdG9tIHBjaSBjYXBhYmlsaXR5IGF0CmxlYXN0LiBB
bmQgdGhlIFBDSSBFUCBmcmFtZXdvcmsgaXMgbm90IHN1cHBvcnRlZCBlaXRoZXIuCgpUaG9zZSBl
eHBsYW5hdGlvbnMgaGF2ZSB0byBiZSBsb2NhdGVkIG9uIHRoZSBjb3ZlciBsZXR0ZXIuIEknbGwg
YWRkIHRoZXNlLgo+ID4gVGhpcyBmdW5jdGlvbiBkcml2ZXIgaGFzIGJlZWQgdGVzdGVkIG9uIFM0
IFJjYXIgKHI4YTc3OWZhLXNwaWRlcikgYm9hcmQgYnV0Cj4gPiBqdXN0IHVzZSB0aGUgUENJZSBF
UCBmcmFtZXdvcmsgYW5kIGRlcGVuZHMgb24gdGhlIFBDSWUgRURNQS4KPiA+Cj4gPiBTaWduZWQt
b2ZmLWJ5OiBTaHVuc3VrZSBNaWUgPG1pZUBpZ2VsLmNvLmpwPgo+ID4gU2lnbmVkLW9mZi1ieTog
VGFrYW5hcmkgSGF5YW1hIDx0YWtpQGlnZWwuY28uanA+Cj4gPiAtLS0KPiA+ICBkcml2ZXJzL3Bj
aS9lbmRwb2ludC9mdW5jdGlvbnMvS2NvbmZpZyAgICAgICAgfCAgMTIgKwo+ID4gIGRyaXZlcnMv
cGNpL2VuZHBvaW50L2Z1bmN0aW9ucy9NYWtlZmlsZSAgICAgICB8ICAgMSArCj4gPiAgLi4uL3Bj
aS9lbmRwb2ludC9mdW5jdGlvbnMvcGNpLWVwZi12bmV0LWVwLmMgIHwgMzQzICsrKysrKysrKysK
PiA+ICAuLi4vcGNpL2VuZHBvaW50L2Z1bmN0aW9ucy9wY2ktZXBmLXZuZXQtcmMuYyAgfCA2MzUg
KysrKysrKysrKysrKysrKysrCj4gPiAgZHJpdmVycy9wY2kvZW5kcG9pbnQvZnVuY3Rpb25zL3Bj
aS1lcGYtdm5ldC5jIHwgMzg3ICsrKysrKysrKysrCj4gPiAgZHJpdmVycy9wY2kvZW5kcG9pbnQv
ZnVuY3Rpb25zL3BjaS1lcGYtdm5ldC5oIHwgIDYyICsrCj4gPiAgNiBmaWxlcyBjaGFuZ2VkLCAx
NDQwIGluc2VydGlvbnMoKykKPiA+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9wY2kvZW5k
cG9pbnQvZnVuY3Rpb25zL3BjaS1lcGYtdm5ldC1lcC5jCj4gPiAgY3JlYXRlIG1vZGUgMTAwNjQ0
IGRyaXZlcnMvcGNpL2VuZHBvaW50L2Z1bmN0aW9ucy9wY2ktZXBmLXZuZXQtcmMuYwo+ID4gIGNy
ZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3BjaS9lbmRwb2ludC9mdW5jdGlvbnMvcGNpLWVwZi12
bmV0LmMKPiA+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9wY2kvZW5kcG9pbnQvZnVuY3Rp
b25zL3BjaS1lcGYtdm5ldC5oCj4gPgo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvcGNpL2VuZHBv
aW50L2Z1bmN0aW9ucy9LY29uZmlnIGIvZHJpdmVycy9wY2kvZW5kcG9pbnQvZnVuY3Rpb25zL0tj
b25maWcKPiA+IGluZGV4IDlmZDU2MDg4Njg3MS4uZjg4ZDhiYWFmNjg5IDEwMDY0NAo+ID4gLS0t
IGEvZHJpdmVycy9wY2kvZW5kcG9pbnQvZnVuY3Rpb25zL0tjb25maWcKPiA+ICsrKyBiL2RyaXZl
cnMvcGNpL2VuZHBvaW50L2Z1bmN0aW9ucy9LY29uZmlnCj4gPiBAQCAtMzcsMyArMzcsMTUgQEAg
Y29uZmlnIFBDSV9FUEZfVk5UQgo+ID4gICAgICAgICBiZXR3ZWVuIFBDSSBSb290IFBvcnQgYW5k
IFBDSWUgRW5kcG9pbnQuCj4gPgo+ID4gICAgICAgICBJZiBpbiBkb3VidCwgc2F5ICJOIiB0byBk
aXNhYmxlIEVuZHBvaW50IE5UQiBkcml2ZXIuCj4gPiArCj4gPiArY29uZmlnIFBDSV9FUEZfVk5F
VAo+ID4gKyAgICAgdHJpc3RhdGUgIlBDSSBFbmRwb2ludCB2aXJ0aW8tbmV0IGRyaXZlciIKPiA+
ICsgICAgIGRlcGVuZHMgb24gUENJX0VORFBPSU5UCj4gPiArICAgICBzZWxlY3QgUENJX0VORFBP
SU5UX1ZJUlRJTwo+ID4gKyAgICAgc2VsZWN0IFZIT1NUX1JJTkcKPiA+ICsgICAgIHNlbGVjdCBW
SE9TVF9JT01FTQo+ID4gKyAgICAgaGVscAo+ID4gKyAgICAgICBQQ0llIEVuZHBvaW50IHZpcnRp
by1uZXQgZnVuY3Rpb24gaW1wbGVtZW50YXRpb24uIFRoaXMgbW9kdWxlIGVuYWJsZXMgdG8KPiA+
ICsgICAgICAgc2hvdyB0aGUgdmlydGlvLW5ldCBhcyBwY2kgZGV2aWNlIHRvIFBDSWUgSG9zdCBz
aWRlLCBhbmQsIGFub3RoZXIKPiA+ICsgICAgICAgdmlydGlvLW5ldCBkZXZpY2Ugc2hvdyB0byBs
b2NhbCBtYWNoaW5lLiBUaG9zZSBkZXZpY2VzIGNhbiBjb21tdW5pY2F0ZQo+ID4gKyAgICAgICBl
YWNoIG90aGVyLgo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvcGNpL2VuZHBvaW50L2Z1bmN0aW9u
cy9NYWtlZmlsZSBiL2RyaXZlcnMvcGNpL2VuZHBvaW50L2Z1bmN0aW9ucy9NYWtlZmlsZQo+ID4g
aW5kZXggNWMxMzAwMWRlYWJhLi43NGNjNGMzMzBjNjIgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJz
L3BjaS9lbmRwb2ludC9mdW5jdGlvbnMvTWFrZWZpbGUKPiA+ICsrKyBiL2RyaXZlcnMvcGNpL2Vu
ZHBvaW50L2Z1bmN0aW9ucy9NYWtlZmlsZQo+ID4gQEAgLTYsMyArNiw0IEBACj4gPiAgb2JqLSQo
Q09ORklHX1BDSV9FUEZfVEVTVCkgICAgICAgICAgICs9IHBjaS1lcGYtdGVzdC5vCj4gPiAgb2Jq
LSQoQ09ORklHX1BDSV9FUEZfTlRCKSAgICAgICAgICAgICs9IHBjaS1lcGYtbnRiLm8KPiA+ICBv
YmotJChDT05GSUdfUENJX0VQRl9WTlRCKSAgICAgICAgICAgKz0gcGNpLWVwZi12bnRiLm8KPiA+
ICtvYmotJChDT05GSUdfUENJX0VQRl9WTkVUKSAgICAgICAgICAgKz0gcGNpLWVwZi12bmV0Lm8g
cGNpLWVwZi12bmV0LXJjLm8gcGNpLWVwZi12bmV0LWVwLm8KPiA+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL3BjaS9lbmRwb2ludC9mdW5jdGlvbnMvcGNpLWVwZi12bmV0LWVwLmMgYi9kcml2ZXJzL3Bj
aS9lbmRwb2ludC9mdW5jdGlvbnMvcGNpLWVwZi12bmV0LWVwLmMKPiA+IG5ldyBmaWxlIG1vZGUg
MTAwNjQ0Cj4gPiBpbmRleCAwMDAwMDAwMDAwMDAuLjkzYjdlMDBlOGQwNgo+ID4gLS0tIC9kZXYv
bnVsbAo+ID4gKysrIGIvZHJpdmVycy9wY2kvZW5kcG9pbnQvZnVuY3Rpb25zL3BjaS1lcGYtdm5l
dC1lcC5jCj4gPiBAQCAtMCwwICsxLDM0MyBAQAo+ID4gKy8vIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wCj4gPiArLyoKPiA+ICsgKiBGdW5jdGlvbnMgd29yayBmb3IgRW5kcG9pbnQg
c2lkZShsb2NhbCkgdXNpbmcgRVBGIGZyYW1ld29yawo+ID4gKyAqLwo+ID4gKyNpbmNsdWRlIDxs
aW51eC9wY2ktZXBjLmg+Cj4gPiArI2luY2x1ZGUgPGxpbnV4L3ZpcnRpb19wY2kuaD4KPiA+ICsj
aW5jbHVkZSA8bGludXgvdmlydGlvX25ldC5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC92aXJ0aW9f
cmluZy5oPgo+ID4gKwo+ID4gKyNpbmNsdWRlICJwY2ktZXBmLXZuZXQuaCIKPiA+ICsKPiA+ICtz
dGF0aWMgaW5saW5lIHN0cnVjdCBlcGZfdm5ldCAqdmRldl90b192bmV0KHN0cnVjdCB2aXJ0aW9f
ZGV2aWNlICp2ZGV2KQo+ID4gK3sKPiA+ICsgICAgIHJldHVybiBjb250YWluZXJfb2YodmRldiwg
c3RydWN0IGVwZl92bmV0LCBlcC52ZGV2KTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQg
ZXBmX3ZuZXRfZXBfc2V0X3N0YXR1cyhzdHJ1Y3QgZXBmX3ZuZXQgKnZuZXQsIHUxNiBzdGF0dXMp
Cj4gPiArewo+ID4gKyAgICAgdm5ldC0+ZXAubmV0X2NvbmZpZ19zdGF0dXMgfD0gc3RhdHVzOwo+
ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBlcGZfdm5ldF9lcF9jbGVhcl9zdGF0dXMoc3Ry
dWN0IGVwZl92bmV0ICp2bmV0LCB1MTYgc3RhdHVzKQo+ID4gK3sKPiA+ICsgICAgIHZuZXQtPmVw
Lm5ldF9jb25maWdfc3RhdHVzICY9IH5zdGF0dXM7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2
b2lkIGVwZl92bmV0X2VwX3JhaXNlX2NvbmZpZ19pcnEoc3RydWN0IGVwZl92bmV0ICp2bmV0KQo+
ID4gK3sKPiA+ICsgICAgIHZpcnRpb19jb25maWdfY2hhbmdlZCgmdm5ldC0+ZXAudmRldik7Cj4g
PiArfQo+ID4gKwo+ID4gK3ZvaWQgZXBmX3ZuZXRfZXBfYW5ub3VuY2VfbGlua3VwKHN0cnVjdCBl
cGZfdm5ldCAqdm5ldCkKPiA+ICt7Cj4gPiArICAgICBlcGZfdm5ldF9lcF9zZXRfc3RhdHVzKHZu
ZXQsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZJUlRJT19ORVRfU19MSU5LX1VQ
IHwgVklSVElPX05FVF9TX0FOTk9VTkNFKTsKPiA+ICsgICAgIGVwZl92bmV0X2VwX3JhaXNlX2Nv
bmZpZ19pcnEodm5ldCk7Cj4gPiArfQo+ID4gKwo+ID4gK3ZvaWQgZXBmX3ZuZXRfZXBfbm90aWZ5
KHN0cnVjdCBlcGZfdm5ldCAqdm5ldCwgc3RydWN0IHZpcnRxdWV1ZSAqdnEpCj4gPiArewo+ID4g
KyAgICAgdnJpbmdfaW50ZXJydXB0KDAsIHZxKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGlu
dCBlcGZfdm5ldF9lcF9wcm9jZXNzX2N0cmxxX2VudHJ5KHN0cnVjdCBlcGZfdm5ldCAqdm5ldCkK
PiA+ICt7Cj4gPiArICAgICBzdHJ1Y3QgdnJpbmdoICp2cmggPSAmdm5ldC0+ZXAuY3RsdnJoOwo+
ID4gKyAgICAgc3RydWN0IHZyaW5naF9raW92ICp3aW92ID0gJnZuZXQtPmVwLmN0bF9yaW92Owo+
ID4gKyAgICAgc3RydWN0IHZyaW5naF9raW92ICpyaW92ID0gJnZuZXQtPmVwLmN0bF93aW92Owo+
ID4gKyAgICAgc3RydWN0IHZpcnRpb19uZXRfY3RybF9oZHIgKmhkcjsKPiA+ICsgICAgIHZpcnRp
b19uZXRfY3RybF9hY2sgKmFjazsKPiA+ICsgICAgIGludCBlcnI7Cj4gPiArICAgICB1MTYgaGVh
ZDsKPiA+ICsgICAgIHNpemVfdCBsZW47Cj4gPiArCj4gPiArICAgICBlcnIgPSB2cmluZ2hfZ2V0
ZGVzYyh2cmgsIHJpb3YsIHdpb3YsICZoZWFkKTsKPiA+ICsgICAgIGlmIChlcnIgPD0gMCkKPiA+
ICsgICAgICAgICAgICAgZ290byBkb25lOwo+ID4gKwo+ID4gKyAgICAgbGVuID0gdnJpbmdoX2tp
b3ZfbGVuZ3RoKHJpb3YpOwo+ID4gKyAgICAgaWYgKGxlbiA8IHNpemVvZigqaGRyKSkgewo+ID4g
KyAgICAgICAgICAgICBwcl9kZWJ1ZygiQ29tbWFuZCBpcyB0b28gc2hvcnQ6ICVsZFxuIiwgbGVu
KTsKPiA+ICsgICAgICAgICAgICAgZXJyID0gLUVJTzsKPiA+ICsgICAgICAgICAgICAgZ290byBk
b25lOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgaWYgKHZyaW5naF9raW92X2xlbmd0aCh3
aW92KSA8IHNpemVvZigqYWNrKSkgewo+ID4gKyAgICAgICAgICAgICBwcl9kZWJ1ZygiU3BhY2Ug
Zm9yIGFjayBpcyBub3QgZW5vdWdoXG4iKTsKPiA+ICsgICAgICAgICAgICAgZXJyID0gLUVJTzsK
PiA+ICsgICAgICAgICAgICAgZ290byBkb25lOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAg
aGRyID0gcGh5c190b192aXJ0KCh1bnNpZ25lZCBsb25nKXJpb3YtPmlvdltyaW92LT5pXS5pb3Zf
YmFzZSk7Cj4gPiArICAgICBhY2sgPSBwaHlzX3RvX3ZpcnQoKHVuc2lnbmVkIGxvbmcpd2lvdi0+
aW92W3dpb3YtPmldLmlvdl9iYXNlKTsKPiA+ICsKPiA+ICsgICAgIHN3aXRjaCAoaGRyLT5jbGFz
cykgewo+ID4gKyAgICAgY2FzZSBWSVJUSU9fTkVUX0NUUkxfQU5OT1VOQ0U6Cj4gPiArICAgICAg
ICAgICAgIGlmIChoZHItPmNtZCAhPSBWSVJUSU9fTkVUX0NUUkxfQU5OT1VOQ0VfQUNLKSB7Cj4g
PiArICAgICAgICAgICAgICAgICAgICAgcHJfZGVidWcoIkludmFsaWQgY29tbWFuZDogYW5ub3Vu
Y2U6ICVkXG4iLCBoZHItPmNtZCk7Cj4gPiArICAgICAgICAgICAgICAgICAgICAgZ290byBkb25l
Owo+ID4gKyAgICAgICAgICAgICB9Cj4gPiArCj4gPiArICAgICAgICAgICAgIGVwZl92bmV0X2Vw
X2NsZWFyX3N0YXR1cyh2bmV0LCBWSVJUSU9fTkVUX1NfQU5OT1VOQ0UpOwo+ID4gKyAgICAgICAg
ICAgICAqYWNrID0gVklSVElPX05FVF9PSzsKPiA+ICsgICAgICAgICAgICAgYnJlYWs7Cj4gPiAr
ICAgICBkZWZhdWx0Ogo+ID4gKyAgICAgICAgICAgICBwcl9kZWJ1ZygiRm91bmQgbm90IHN1cHBv
cnRlZCBjbGFzczogJWRcbiIsIGhkci0+Y2xhc3MpOwo+ID4gKyAgICAgICAgICAgICBlcnIgPSAt
RUlPOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gK2RvbmU6Cj4gPiArICAgICB2cmluZ2hfY29tcGxl
dGUodnJoLCBoZWFkLCBsZW4pOwo+ID4gKyAgICAgcmV0dXJuIGVycjsKPiA+ICt9Cj4gPiArCj4g
PiArc3RhdGljIHU2NCBlcGZfdm5ldF9lcF92ZGV2X2dldF9mZWF0dXJlcyhzdHJ1Y3QgdmlydGlv
X2RldmljZSAqdmRldikKPiA+ICt7Cj4gPiArICAgICBzdHJ1Y3QgZXBmX3ZuZXQgKnZuZXQgPSB2
ZGV2X3RvX3ZuZXQodmRldik7Cj4gPiArCj4gPiArICAgICByZXR1cm4gdm5ldC0+dmlydGlvX2Zl
YXR1cmVzOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGVwZl92bmV0X2VwX3ZkZXZfZmlu
YWxpemVfZmVhdHVyZXMoc3RydWN0IHZpcnRpb19kZXZpY2UgKnZkZXYpCj4gPiArewo+ID4gKyAg
ICAgc3RydWN0IGVwZl92bmV0ICp2bmV0ID0gdmRldl90b192bmV0KHZkZXYpOwo+ID4gKwo+ID4g
KyAgICAgaWYgKHZkZXYtPmZlYXR1cmVzICE9IHZuZXQtPnZpcnRpb19mZWF0dXJlcykKPiA+ICsg
ICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gPiArCj4gPiArICAgICByZXR1cm4gMDsKPiA+
ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgZXBmX3ZuZXRfZXBfdmRldl9nZXRfY29uZmlnKHN0
cnVjdCB2aXJ0aW9fZGV2aWNlICp2ZGV2LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1bnNpZ25lZCBpbnQgb2Zmc2V0LCB2b2lkICpidWYsCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBsZW4pCj4gPiArewo+ID4g
KyAgICAgc3RydWN0IGVwZl92bmV0ICp2bmV0ID0gdmRldl90b192bmV0KHZkZXYpOwo+ID4gKyAg
ICAgY29uc3QgdW5zaWduZWQgaW50IG1hY19sZW4gPSBzaXplb2Yodm5ldC0+dm5ldF9jZmcubWFj
KTsKPiA+ICsgICAgIGNvbnN0IHVuc2lnbmVkIGludCBzdGF0dXNfbGVuID0gc2l6ZW9mKHZuZXQt
PnZuZXRfY2ZnLnN0YXR1cyk7Cj4gPiArICAgICB1bnNpZ25lZCBpbnQgY29weV9sZW47Cj4gPiAr
Cj4gPiArICAgICBzd2l0Y2ggKG9mZnNldCkgewo+ID4gKyAgICAgY2FzZSBvZmZzZXRvZihzdHJ1
Y3QgdmlydGlvX25ldF9jb25maWcsIG1hYyk6Cj4gPiArICAgICAgICAgICAgIC8qIFRoaXMgUENJ
ZSBFUCBmdW5jdGlvbiBkb2Vzbid0IHByb3ZpZGUgYSBWSVJUSU9fTkVUX0ZfTUFDIGZlYXR1cmUs
IHNvIGp1c3QKPiA+ICsgICAgICAgICAgICAgICogY2xlYXIgdGhlIGJ1ZmZlci4KPiA+ICsgICAg
ICAgICAgICAgICovCj4gPiArICAgICAgICAgICAgIGNvcHlfbGVuID0gbGVuID49IG1hY19sZW4g
PyBtYWNfbGVuIDogbGVuOwo+ID4gKyAgICAgICAgICAgICBtZW1zZXQoYnVmLCAweDAwLCBjb3B5
X2xlbik7Cj4gPiArICAgICAgICAgICAgIGxlbiAtPSBjb3B5X2xlbjsKPiA+ICsgICAgICAgICAg
ICAgYnVmICs9IGNvcHlfbGVuOwo+ID4gKyAgICAgICAgICAgICBmYWxsdGhyb3VnaDsKPiA+ICsg
ICAgIGNhc2Ugb2Zmc2V0b2Yoc3RydWN0IHZpcnRpb19uZXRfY29uZmlnLCBzdGF0dXMpOgo+ID4g
KyAgICAgICAgICAgICBjb3B5X2xlbiA9IGxlbiA+PSBzdGF0dXNfbGVuID8gc3RhdHVzX2xlbiA6
IGxlbjsKPiA+ICsgICAgICAgICAgICAgbWVtY3B5KGJ1ZiwgJnZuZXQtPmVwLm5ldF9jb25maWdf
c3RhdHVzLCBjb3B5X2xlbik7Cj4gPiArICAgICAgICAgICAgIGxlbiAtPSBjb3B5X2xlbjsKPiA+
ICsgICAgICAgICAgICAgYnVmICs9IGNvcHlfbGVuOwo+ID4gKyAgICAgICAgICAgICBmYWxsdGhy
b3VnaDsKPiA+ICsgICAgIGRlZmF1bHQ6Cj4gPiArICAgICAgICAgICAgIGlmIChvZmZzZXQgPiBz
aXplb2Yodm5ldC0+dm5ldF9jZmcpKSB7Cj4gPiArICAgICAgICAgICAgICAgICAgICAgbWVtc2V0
KGJ1ZiwgMHgwMCwgbGVuKTsKPiA+ICsgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiA+ICsg
ICAgICAgICAgICAgfQo+ID4gKyAgICAgICAgICAgICBtZW1jcHkoYnVmLCAodm9pZCAqKSZ2bmV0
LT52bmV0X2NmZyArIG9mZnNldCwgbGVuKTsKPiA+ICsgICAgIH0KPiA+ICt9Cj4gPiArCj4gPiAr
c3RhdGljIHZvaWQgZXBmX3ZuZXRfZXBfdmRldl9zZXRfY29uZmlnKHN0cnVjdCB2aXJ0aW9fZGV2
aWNlICp2ZGV2LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNp
Z25lZCBpbnQgb2Zmc2V0LCBjb25zdCB2b2lkICpidWYsCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBsZW4pCj4gPiArewo+ID4gKyAgICAgLyog
RG8gbm90aGluZywgYmVjYXVzZSBhbGwgb2YgdmlydGlvIG5ldCBjb25maWcgc3BhY2UgaXMgcmVh
ZG9ubHkuICovCj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB1OCBlcGZfdm5ldF9lcF92ZGV2X2dl
dF9zdGF0dXMoc3RydWN0IHZpcnRpb19kZXZpY2UgKnZkZXYpCj4gPiArewo+ID4gKyAgICAgcmV0
dXJuIDA7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGVwZl92bmV0X2VwX3ZkZXZfc2V0
X3N0YXR1cyhzdHJ1Y3QgdmlydGlvX2RldmljZSAqdmRldiwgdTggc3RhdHVzKQo+ID4gK3sKPiA+
ICsgICAgIHN0cnVjdCBlcGZfdm5ldCAqdm5ldCA9IHZkZXZfdG9fdm5ldCh2ZGV2KTsKPiA+ICsK
PiA+ICsgICAgIGlmIChzdGF0dXMgJiBWSVJUSU9fQ09ORklHX1NfRFJJVkVSX09LKQo+ID4gKyAg
ICAgICAgICAgICBlcGZfdm5ldF9pbml0X2NvbXBsZXRlKHZuZXQsIEVQRl9WTkVUX0lOSVRfQ09N
UExFVEVfRVApOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBlcGZfdm5ldF9lcF92ZGV2
X3Jlc2V0KHN0cnVjdCB2aXJ0aW9fZGV2aWNlICp2ZGV2KQo+ID4gK3sKPiA+ICsgICAgIHByX2Rl
YnVnKCJkb2Vzbid0IHN1cHBvcnQgeWV0Iik7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBib29s
IGVwZl92bmV0X2VwX3ZkZXZfdnFfbm90aWZ5KHN0cnVjdCB2aXJ0cXVldWUgKnZxKQo+ID4gK3sK
PiA+ICsgICAgIHN0cnVjdCBlcGZfdm5ldCAqdm5ldCA9IHZkZXZfdG9fdm5ldCh2cS0+dmRldik7
Cj4gPiArICAgICBzdHJ1Y3QgdnJpbmdoICp0eF92cmggPSAmdm5ldC0+ZXAudHh2cmg7Cj4gPiAr
ICAgICBzdHJ1Y3QgdnJpbmdoICpyeF92cmggPSAmdm5ldC0+cmMucnh2cmgtPnZyaDsKPiA+ICsg
ICAgIHN0cnVjdCB2cmluZ2hfa2lvdiAqdHhfaW92ID0gJnZuZXQtPmVwLnR4X2lvdjsKPiA+ICsg
ICAgIHN0cnVjdCB2cmluZ2hfa2lvdiAqcnhfaW92ID0gJnZuZXQtPnJjLnJ4X2lvdjsKPiA+ICsg
ICAgIGludCBlcnI7Cj4gPiArCj4gPiArICAgICAvKiBTdXBwb3J0IG9ubHkgb25lIHF1ZXVlIHBh
aXIgKi8KPiA+ICsgICAgIHN3aXRjaCAodnEtPmluZGV4KSB7Cj4gPiArICAgICBjYXNlIDA6IC8v
IHJ4IHF1ZXVlCj4gPiArICAgICAgICAgICAgIGJyZWFrOwo+ID4gKyAgICAgY2FzZSAxOiAvLyB0
eCBxdWV1ZQo+ID4gKyAgICAgICAgICAgICB3aGlsZSAoKGVyciA9IGVwZl92bmV0X3RyYW5zZmVy
KHZuZXQsIHR4X3ZyaCwgcnhfdnJoLCB0eF9pb3YsCj4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcnhfaW92LCBETUFfTUVNX1RPX0RFVikpID4gMCkKPiA+
ICsgICAgICAgICAgICAgICAgICAgICA7Cj4gPiArICAgICAgICAgICAgIGlmIChlcnIgPCAwKQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIHByX2RlYnVnKCJGYWlsZWQgdG8gdHJhbnNtaXQ6IEVQ
IC0+IEhvc3Q6ICVkXG4iLCBlcnIpOwo+ID4gKyAgICAgICAgICAgICBicmVhazsKPiA+ICsgICAg
IGNhc2UgMjogLy8gY29udHJvbCBxdWV1ZQo+ID4gKyAgICAgICAgICAgICBlcGZfdm5ldF9lcF9w
cm9jZXNzX2N0cmxxX2VudHJ5KHZuZXQpOwo+ID4gKyAgICAgICAgICAgICBicmVhazsKPiA+ICsg
ICAgIGRlZmF1bHQ6Cj4gPiArICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKPiA+ICsgICAgIH0K
PiA+ICsKPiA+ICsgICAgIHJldHVybiB0cnVlOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50
IGVwZl92bmV0X2VwX3ZkZXZfZmluZF92cXMoc3RydWN0IHZpcnRpb19kZXZpY2UgKnZkZXYsCj4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBudnFzLCBz
dHJ1Y3QgdmlydHF1ZXVlICp2cXNbXSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdnFfY2FsbGJhY2tfdCAqY2FsbGJhY2tbXSwKPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY29uc3QgY2hhciAqY29uc3QgbmFtZXNbXSwgY29uc3QgYm9vbCAqY3R4
LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgaXJxX2FmZmlu
aXR5ICpkZXNjKQo+ID4gK3sKPiA+ICsgICAgIHN0cnVjdCBlcGZfdm5ldCAqdm5ldCA9IHZkZXZf
dG9fdm5ldCh2ZGV2KTsKPiA+ICsgICAgIGNvbnN0IHNpemVfdCB2cV9zaXplID0gZXBmX3ZuZXRf
Z2V0X3ZxX3NpemUoKTsKPiA+ICsgICAgIGludCBpOwo+ID4gKyAgICAgaW50IGVycjsKPiA+ICsg
ICAgIGludCBxaWR4Owo+ID4gKwo+ID4gKyAgICAgZm9yIChxaWR4ID0gMCwgaSA9IDA7IGkgPCBu
dnFzOyBpKyspIHsKPiA+ICsgICAgICAgICAgICAgc3RydWN0IHZpcnRxdWV1ZSAqdnE7Cj4gPiAr
ICAgICAgICAgICAgIHN0cnVjdCB2cmluZyAqdnJpbmc7Cj4gPiArICAgICAgICAgICAgIHN0cnVj
dCB2cmluZ2ggKnZyaDsKPiA+ICsKPiA+ICsgICAgICAgICAgICAgaWYgKCFuYW1lc1tpXSkgewo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIHZxc1tpXSA9IE5VTEw7Cj4gPiArICAgICAgICAgICAg
ICAgICAgICAgY29udGludWU7Cj4gPiArICAgICAgICAgICAgIH0KPiA+ICsKPiA+ICsgICAgICAg
ICAgICAgdnEgPSB2cmluZ19jcmVhdGVfdmlydHF1ZXVlKHFpZHgrKywgdnFfc2l6ZSwKPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZJUlRJT19QQ0lfVlJJTkdf
QUxJR04sIHZkZXYsIHRydWUsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBmYWxzZSwgY3R4ID8gY3R4W2ldIDogZmFsc2UsCj4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBlcGZfdm5ldF9lcF92ZGV2X3ZxX25vdGlmeSwKPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrW2ldLCBu
YW1lc1tpXSk7Cj4gPiArICAgICAgICAgICAgIGlmICghdnEpIHsKPiA+ICsgICAgICAgICAgICAg
ICAgICAgICBlcnIgPSAtRU5PTUVNOwo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJy
X2RlbF92cXM7Cj4gPiArICAgICAgICAgICAgIH0KPiA+ICsKPiA+ICsgICAgICAgICAgICAgdnFz
W2ldID0gdnE7Cj4gPiArICAgICAgICAgICAgIHZyaW5nID0gdmlydHF1ZXVlX2dldF92cmluZyh2
cSk7Cj4gPiArCj4gPiArICAgICAgICAgICAgIHN3aXRjaCAoaSkgewo+ID4gKyAgICAgICAgICAg
ICBjYXNlIDA6IC8vIHJ4Cj4gPiArICAgICAgICAgICAgICAgICAgICAgdnJoID0gJnZuZXQtPmVw
LnJ4dnJoOwo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHZuZXQtPmVwLnJ4dnEgPSB2cTsKPiA+
ICsgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiA+ICsgICAgICAgICAgICAgY2FzZSAxOiAv
LyB0eAo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHZyaCA9ICZ2bmV0LT5lcC50eHZyaDsKPiA+
ICsgICAgICAgICAgICAgICAgICAgICB2bmV0LT5lcC50eHZxID0gdnE7Cj4gPiArICAgICAgICAg
ICAgICAgICAgICAgYnJlYWs7Cj4gPiArICAgICAgICAgICAgIGNhc2UgMjogLy8gY29udHJvbAo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIHZyaCA9ICZ2bmV0LT5lcC5jdGx2cmg7Cj4gPiArICAg
ICAgICAgICAgICAgICAgICAgdm5ldC0+ZXAuY3RsdnEgPSB2cTsKPiA+ICsgICAgICAgICAgICAg
ICAgICAgICBicmVhazsKPiA+ICsgICAgICAgICAgICAgZGVmYXVsdDoKPiA+ICsgICAgICAgICAg
ICAgICAgICAgICBlcnIgPSAtRUlPOwo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJy
X2RlbF92cXM7Cj4gPiArICAgICAgICAgICAgIH0KPiA+ICsKPiA+ICsgICAgICAgICAgICAgZXJy
ID0gdnJpbmdoX2luaXRfa2Vybih2cmgsIHZuZXQtPnZpcnRpb19mZWF0dXJlcywgdnFfc2l6ZSwK
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVlLCBHRlBfS0VSTkVM
LCB2cmluZy0+ZGVzYywKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2
cmluZy0+YXZhaWwsIHZyaW5nLT51c2VkKTsKPiA+ICsgICAgICAgICAgICAgaWYgKGVycikgewo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIHByX2VycigiZmFpbGVkIHRvIGluaXQgdnJpbmdoIGZv
ciB2cmluZyAlZFxuIiwgaSk7Cj4gPiArICAgICAgICAgICAgICAgICAgICAgZ290byBlcnJfZGVs
X3ZxczsKPiA+ICsgICAgICAgICAgICAgfQo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgZXJy
ID0gZXBmX3ZuZXRfaW5pdF9raW92KCZ2bmV0LT5lcC50eF9pb3YsIHZxX3NpemUpOwo+ID4gKyAg
ICAgaWYgKGVycikKPiA+ICsgICAgICAgICAgICAgZ290byBlcnJfZnJlZV9raW92Owo+ID4gKyAg
ICAgZXJyID0gZXBmX3ZuZXRfaW5pdF9raW92KCZ2bmV0LT5lcC5yeF9pb3YsIHZxX3NpemUpOwo+
ID4gKyAgICAgaWYgKGVycikKPiA+ICsgICAgICAgICAgICAgZ290byBlcnJfZnJlZV9raW92Owo+
ID4gKyAgICAgZXJyID0gZXBmX3ZuZXRfaW5pdF9raW92KCZ2bmV0LT5lcC5jdGxfcmlvdiwgdnFf
c2l6ZSk7Cj4gPiArICAgICBpZiAoZXJyKQo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl9mcmVl
X2tpb3Y7Cj4gPiArICAgICBlcnIgPSBlcGZfdm5ldF9pbml0X2tpb3YoJnZuZXQtPmVwLmN0bF93
aW92LCB2cV9zaXplKTsKPiA+ICsgICAgIGlmIChlcnIpCj4gPiArICAgICAgICAgICAgIGdvdG8g
ZXJyX2ZyZWVfa2lvdjsKPiA+ICsKPiA+ICsgICAgIHJldHVybiAwOwo+ID4gKwo+ID4gK2Vycl9m
cmVlX2tpb3Y6Cj4gPiArICAgICBlcGZfdm5ldF9kZWluaXRfa2lvdigmdm5ldC0+ZXAudHhfaW92
KTsKPiA+ICsgICAgIGVwZl92bmV0X2RlaW5pdF9raW92KCZ2bmV0LT5lcC5yeF9pb3YpOwo+ID4g
KyAgICAgZXBmX3ZuZXRfZGVpbml0X2tpb3YoJnZuZXQtPmVwLmN0bF9yaW92KTsKPiA+ICsgICAg
IGVwZl92bmV0X2RlaW5pdF9raW92KCZ2bmV0LT5lcC5jdGxfd2lvdik7Cj4gPiArCj4gPiArZXJy
X2RlbF92cXM6Cj4gPiArICAgICBmb3IgKDsgaSA+PSAwOyBpLS0pIHsKPiA+ICsgICAgICAgICAg
ICAgaWYgKCFuYW1lc1tpXSkKPiA+ICsgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKPiA+
ICsKPiA+ICsgICAgICAgICAgICAgaWYgKCF2cXNbaV0pCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgY29udGludWU7Cj4gPiArCj4gPiArICAgICAgICAgICAgIHZyaW5nX2RlbF92aXJ0cXVldWUo
dnFzW2ldKTsKPiA+ICsgICAgIH0KPiA+ICsgICAgIHJldHVybiBlcnI7Cj4gPiArfQo+ID4gKwo+
ID4gK3N0YXRpYyB2b2lkIGVwZl92bmV0X2VwX3ZkZXZfZGVsX3ZxcyhzdHJ1Y3QgdmlydGlvX2Rl
dmljZSAqdmRldikKPiA+ICt7Cj4gPiArICAgICBzdHJ1Y3QgdmlydHF1ZXVlICp2cSwgKm47Cj4g
PiArICAgICBzdHJ1Y3QgZXBmX3ZuZXQgKnZuZXQgPSB2ZGV2X3RvX3ZuZXQodmRldik7Cj4gPiAr
Cj4gPiArICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUodnEsIG4sICZ2ZGV2LT52cXMsIGxp
c3QpCj4gPiArICAgICAgICAgICAgIHZyaW5nX2RlbF92aXJ0cXVldWUodnEpOwo+ID4gKwo+ID4g
KyAgICAgZXBmX3ZuZXRfZGVpbml0X2tpb3YoJnZuZXQtPmVwLnR4X2lvdik7Cj4gPiArICAgICBl
cGZfdm5ldF9kZWluaXRfa2lvdigmdm5ldC0+ZXAucnhfaW92KTsKPiA+ICsgICAgIGVwZl92bmV0
X2RlaW5pdF9raW92KCZ2bmV0LT5lcC5jdGxfcmlvdik7Cj4gPiArICAgICBlcGZfdm5ldF9kZWlu
aXRfa2lvdigmdm5ldC0+ZXAuY3RsX3dpb3YpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgY29u
c3Qgc3RydWN0IHZpcnRpb19jb25maWdfb3BzIGVwZl92bmV0X2VwX3ZkZXZfY29uZmlnX29wcyA9
IHsKPiA+ICsgICAgIC5nZXRfZmVhdHVyZXMgPSBlcGZfdm5ldF9lcF92ZGV2X2dldF9mZWF0dXJl
cywKPiA+ICsgICAgIC5maW5hbGl6ZV9mZWF0dXJlcyA9IGVwZl92bmV0X2VwX3ZkZXZfZmluYWxp
emVfZmVhdHVyZXMsCj4gPiArICAgICAuZ2V0ID0gZXBmX3ZuZXRfZXBfdmRldl9nZXRfY29uZmln
LAo+ID4gKyAgICAgLnNldCA9IGVwZl92bmV0X2VwX3ZkZXZfc2V0X2NvbmZpZywKPiA+ICsgICAg
IC5nZXRfc3RhdHVzID0gZXBmX3ZuZXRfZXBfdmRldl9nZXRfc3RhdHVzLAo+ID4gKyAgICAgLnNl
dF9zdGF0dXMgPSBlcGZfdm5ldF9lcF92ZGV2X3NldF9zdGF0dXMsCj4gPiArICAgICAucmVzZXQg
PSBlcGZfdm5ldF9lcF92ZGV2X3Jlc2V0LAo+ID4gKyAgICAgLmZpbmRfdnFzID0gZXBmX3ZuZXRf
ZXBfdmRldl9maW5kX3ZxcywKPiA+ICsgICAgIC5kZWxfdnFzID0gZXBmX3ZuZXRfZXBfdmRldl9k
ZWxfdnFzLAo+ID4gK307Cj4gPiArCj4gPiArdm9pZCBlcGZfdm5ldF9lcF9jbGVhbnVwKHN0cnVj
dCBlcGZfdm5ldCAqdm5ldCkKPiA+ICt7Cj4gPiArICAgICB1bnJlZ2lzdGVyX3ZpcnRpb19kZXZp
Y2UoJnZuZXQtPmVwLnZkZXYpOwo+ID4gK30KPiA+ICsKPiA+ICtpbnQgZXBmX3ZuZXRfZXBfc2V0
dXAoc3RydWN0IGVwZl92bmV0ICp2bmV0KQo+ID4gK3sKPiA+ICsgICAgIGludCBlcnI7Cj4gPiAr
ICAgICBzdHJ1Y3QgdmlydGlvX2RldmljZSAqdmRldiA9ICZ2bmV0LT5lcC52ZGV2Owo+ID4gKwo+
ID4gKyAgICAgdmRldi0+ZGV2LnBhcmVudCA9IHZuZXQtPmVwZi0+ZXBjLT5kZXYucGFyZW50Owo+
ID4gKyAgICAgdmRldi0+Y29uZmlnID0gJmVwZl92bmV0X2VwX3ZkZXZfY29uZmlnX29wczsKPiA+
ICsgICAgIHZkZXYtPmlkLnZlbmRvciA9IFBDSV9WRU5ET1JfSURfUkVESEFUX1FVTVJBTkVUOwo+
ID4gKyAgICAgdmRldi0+aWQuZGV2aWNlID0gVklSVElPX0lEX05FVDsKPiA+ICsKPiA+ICsgICAg
IGVyciA9IHJlZ2lzdGVyX3ZpcnRpb19kZXZpY2UodmRldik7Cj4gPiArICAgICBpZiAoZXJyKQo+
ID4gKyAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ID4gKwo+ID4gKyAgICAgcmV0dXJuIDA7Cj4g
PiArfQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvcGNpL2VuZHBvaW50L2Z1bmN0aW9ucy9wY2kt
ZXBmLXZuZXQtcmMuYyBiL2RyaXZlcnMvcGNpL2VuZHBvaW50L2Z1bmN0aW9ucy9wY2ktZXBmLXZu
ZXQtcmMuYwo+ID4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiA+IGluZGV4IDAwMDAwMDAwMDAwMC4u
MmNhMDI0NWE5MTM0Cj4gPiAtLS0gL2Rldi9udWxsCj4gPiArKysgYi9kcml2ZXJzL3BjaS9lbmRw
b2ludC9mdW5jdGlvbnMvcGNpLWVwZi12bmV0LXJjLmMKPiA+IEBAIC0wLDAgKzEsNjM1IEBACj4g
PiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKPiA+ICsvKgo+ID4gKyAqIEZ1
bmN0aW9ucyB3b3JrIGZvciBQQ2llIEhvc3Qgc2lkZShyZW1vdGUpIHVzaW5nIEVQRiBmcmFtZXdv
cmsuCj4gPiArICovCj4gPiArI2luY2x1ZGUgPGxpbnV4L3BjaS1lcGYuaD4KPiA+ICsjaW5jbHVk
ZSA8bGludXgvcGNpLWVwYy5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC9wY2lfaWRzLmg+Cj4gPiAr
I2luY2x1ZGUgPGxpbnV4L3NjaGVkLmg+Cj4gPiArI2luY2x1ZGUgPGxpbnV4L3ZpcnRpb19wY2ku
aD4KPiA+ICsKPiA+ICsjaW5jbHVkZSAicGNpLWVwZi12bmV0LmgiCj4gPiArCj4gPiArI2RlZmlu
ZSBWSVJUSU9fTkVUX0xFR0FDWV9DRkdfQkFSIEJBUl8wCj4gPiArCj4gPiArLyogUmV0dXJucyBh
biBvdXQgc2lkZSBvZiB0aGUgdmFsaWQgcXVldWUgaW5kZXguICovCj4gPiArc3RhdGljIGlubGlu
ZSB1MTYgZXBmX3ZuZXRfcmNfZ2V0X251bWJlcl9vZl9xdWV1ZXMoc3RydWN0IGVwZl92bmV0ICp2
bmV0KQo+ID4gKwo+ID4gK3sKPiA+ICsgICAgIC8qIG51bWJlciBvZiBxdWV1ZSBwYWlycyBhbmQg
Y29udHJvbCBxdWV1ZSAqLwo+ID4gKyAgICAgcmV0dXJuIHZuZXQtPnZuZXRfY2ZnLm1heF92aXJ0
cXVldWVfcGFpcnMgKiAyICsgMTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgZXBmX3Zu
ZXRfcmNfbWVtY3B5X2NvbmZpZyhzdHJ1Y3QgZXBmX3ZuZXQgKnZuZXQsIHNpemVfdCBvZmZzZXQs
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpidWYsIHNpemVf
dCBsZW4pCj4gPiArewo+ID4gKyAgICAgdm9pZCBfX2lvbWVtICpiYXNlID0gdm5ldC0+cmMuY2Zn
X2Jhc2UgKyBvZmZzZXQ7Cj4gPiArCj4gPiArICAgICBtZW1jcHlfdG9pbyhiYXNlLCBidWYsIGxl
bik7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGVwZl92bmV0X3JjX3NldF9jb25maWc4
KHN0cnVjdCBlcGZfdm5ldCAqdm5ldCwgc2l6ZV90IG9mZnNldCwKPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1OCBjb25maWcpCj4gPiArewo+ID4gKyAgICAgdm9pZCBfX2lv
bWVtICpiYXNlID0gdm5ldC0+cmMuY2ZnX2Jhc2UgKyBvZmZzZXQ7Cj4gPiArCj4gPiArICAgICBp
b3dyaXRlOChpb3JlYWQ4KGJhc2UpIHwgY29uZmlnLCBiYXNlKTsKPiA+ICt9Cj4gPiArCj4gPiAr
c3RhdGljIHZvaWQgZXBmX3ZuZXRfcmNfc2V0X2NvbmZpZzE2KHN0cnVjdCBlcGZfdm5ldCAqdm5l
dCwgc2l6ZV90IG9mZnNldCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dTE2IGNvbmZpZykKPiA+ICt7Cj4gPiArICAgICB2b2lkIF9faW9tZW0gKmJhc2UgPSB2bmV0LT5y
Yy5jZmdfYmFzZSArIG9mZnNldDsKPiA+ICsKPiA+ICsgICAgIGlvd3JpdGUxNihpb3JlYWQxNihi
YXNlKSB8IGNvbmZpZywgYmFzZSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGVwZl92
bmV0X3JjX2NsZWFyX2NvbmZpZzE2KHN0cnVjdCBlcGZfdm5ldCAqdm5ldCwgc2l6ZV90IG9mZnNl
dCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MTYgY29uZmlnKQo+
ID4gK3sKPiA+ICsgICAgIHZvaWQgX19pb21lbSAqYmFzZSA9IHZuZXQtPnJjLmNmZ19iYXNlICsg
b2Zmc2V0Owo+ID4gKwo+ID4gKyAgICAgaW93cml0ZTE2KGlvcmVhZDE2KGJhc2UpICYgfmNvbmZp
ZywgYmFzZSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGVwZl92bmV0X3JjX3NldF9j
b25maWczMihzdHJ1Y3QgZXBmX3ZuZXQgKnZuZXQsIHNpemVfdCBvZmZzZXQsCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUzMiBjb25maWcpCj4gPiArewo+ID4gKyAgICAg
dm9pZCBfX2lvbWVtICpiYXNlID0gdm5ldC0+cmMuY2ZnX2Jhc2UgKyBvZmZzZXQ7Cj4gPiArCj4g
PiArICAgICBpb3dyaXRlMzIoaW9yZWFkMzIoYmFzZSkgfCBjb25maWcsIGJhc2UpOwo+ID4gK30K
PiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBlcGZfdm5ldF9yY19yYWlzZV9jb25maWdfaXJxKHN0cnVj
dCBlcGZfdm5ldCAqdm5ldCkKPiA+ICt7Cj4gPiArICAgICBlcGZfdm5ldF9yY19zZXRfY29uZmln
MTYodm5ldCwgVklSVElPX1BDSV9JU1IsIFZJUlRJT19QQ0lfSVNSX0NPTkZJRyk7Cj4gPiArICAg
ICBxdWV1ZV93b3JrKHZuZXQtPnJjLmlycV93cSwgJnZuZXQtPnJjLnJhaXNlX2lycV93b3JrKTsK
PiA+ICt9Cj4gPiArCj4gPiArdm9pZCBlcGZfdm5ldF9yY19hbm5vdW5jZV9saW5rdXAoc3RydWN0
IGVwZl92bmV0ICp2bmV0KQo+ID4gK3sKPiA+ICsgICAgIGVwZl92bmV0X3JjX3NldF9jb25maWcx
Nih2bmV0LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZJUlRJT19QQ0lfQ09O
RklHX09GRihmYWxzZSkgKwo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgb2Zmc2V0b2Yoc3RydWN0IHZpcnRpb19uZXRfY29uZmlnLAo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzKSwKPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBWSVJUSU9fTkVUX1NfTElOS19VUCB8IFZJUlRJT19ORVRfU19B
Tk5PVU5DRSk7Cj4gPiArICAgICBlcGZfdm5ldF9yY19yYWlzZV9jb25maWdfaXJxKHZuZXQpOwo+
ID4gK30KPiA+ICsKPiA+ICsvKgo+ID4gKyAqIEZvciB0aGUgUENJZSBob3N0LCB0aGlzIGRyaXZl
ciBzaG93cyBsZWdhY3kgdmlydGlvLW5ldCBkZXZpY2UuIEJlY2F1c2UsCj4gPiArICogdmlydGlv
IHN0cnVjdHVyZSBwY2kgY2FwYWJpbGl0aWVzIGlzIG1hbmRhdG9yeSBmb3IgbW9kZXJuIHZpcnRp
byBkZXZpY2UsCj4gPiArICogYnV0IHRoZXJlIGlzIG5vIFBDSWUgRVAgaGFyZHdhcmUgdGhhdCBj
YW4gYmUgY29uZmlndXJlZCB3aXRoIGFueSBwY2kKPiA+ICsgKiBjYXBhYmlsaXRpZXMgYW5kIExp
bnV4IFBDSWUgRVAgZnJhbWV3b3JrIGRvZXNuJ3Qgc3VwcG9ydCBpdC4KPiA+ICsgKi8KPiA+ICtz
dGF0aWMgc3RydWN0IHBjaV9lcGZfaGVhZGVyIGVwZl92bmV0X3BjaV9oZWFkZXIgPSB7Cj4gPiAr
ICAgICAudmVuZG9yaWQgPSBQQ0lfVkVORE9SX0lEX1JFREhBVF9RVU1SQU5FVCwKPiA+ICsgICAg
IC5kZXZpY2VpZCA9IFZJUlRJT19UUkFOU19JRF9ORVQsCj4gPiArICAgICAuc3Vic3lzX3ZlbmRv
cl9pZCA9IFBDSV9WRU5ET1JfSURfUkVESEFUX1FVTVJBTkVULAo+ID4gKyAgICAgLnN1YnN5c19p
ZCA9IFZJUlRJT19JRF9ORVQsCj4gPiArICAgICAucmV2aWQgPSAwLAo+ID4gKyAgICAgLmJhc2Vj
bGFzc19jb2RlID0gUENJX0JBU0VfQ0xBU1NfTkVUV09SSywKPiA+ICsgICAgIC5pbnRlcnJ1cHRf
cGluID0gUENJX0lOVEVSUlVQVF9QSU4sCj4gPiArfTsKPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBl
cGZfdm5ldF9yY19zZXR1cF9jb25maWdzKHN0cnVjdCBlcGZfdm5ldCAqdm5ldCwKPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgX19pb21lbSAqY2ZnX2Jhc2UpCj4g
PiArewo+ID4gKyAgICAgdTE2IGRlZmF1bHRfcWluZGV4ID0gZXBmX3ZuZXRfcmNfZ2V0X251bWJl
cl9vZl9xdWV1ZXModm5ldCk7Cj4gPiArCj4gPiArICAgICBlcGZfdm5ldF9yY19zZXRfY29uZmln
MzIodm5ldCwgVklSVElPX1BDSV9IT1NUX0ZFQVRVUkVTLAo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHZuZXQtPnZpcnRpb19mZWF0dXJlcyk7Cj4gPiArCj4gPiArICAgICBlcGZf
dm5ldF9yY19zZXRfY29uZmlnMTYodm5ldCwgVklSVElPX1BDSV9JU1IsIFZJUlRJT19QQ0lfSVNS
X1FVRVVFKTsKPiA+ICsgICAgIC8qCj4gPiArICAgICAgKiBJbml0aWFsaXplIHRoZSBxdWV1ZSBu
b3RpZnkgYW5kIHNlbGVjdG9yIHRvIG91dHNpZGUgb2YgdGhlIGFwcHJvcHJpYXRlCj4gPiArICAg
ICAgKiB2aXJ0cXVldWUgaW5kZXguIEl0IGlzIHVzZWQgdG8gZGV0ZWN0IGNoYW5nZSB3aXRoIHBv
bGxpbmcuIFRoZXJlIGlzIG5vCj4gPiArICAgICAgKiBvdGhlciB3YXlzIHRvIGRldGVjdCBob3N0
IHNpZGUgZHJpdmVyIHVwZGF0ZWluZyB0aG9zZSB2YWx1ZXMKPiA+ICsgICAgICAqLwo+ID4gKyAg
ICAgZXBmX3ZuZXRfcmNfc2V0X2NvbmZpZzE2KHZuZXQsIFZJUlRJT19QQ0lfUVVFVUVfTk9USUZZ
LCBkZWZhdWx0X3FpbmRleCk7Cj4gPiArICAgICBlcGZfdm5ldF9yY19zZXRfY29uZmlnMTYodm5l
dCwgVklSVElPX1BDSV9RVUVVRV9TRUwsIGRlZmF1bHRfcWluZGV4KTsKPiA+ICsgICAgIC8qIFRo
aXMgcGZuIGlzIGFsc28gc2V0IHRvIDAgZm9yIHRoZSBwb2xsaW5nIGFzIHdlbGwgKi8KPiA+ICsg
ICAgIGVwZl92bmV0X3JjX3NldF9jb25maWcxNih2bmV0LCBWSVJUSU9fUENJX1FVRVVFX1BGTiwg
MCk7Cj4gPiArCj4gPiArICAgICBlcGZfdm5ldF9yY19zZXRfY29uZmlnMTYodm5ldCwgVklSVElP
X1BDSV9RVUVVRV9OVU0sCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXBmX3Zu
ZXRfZ2V0X3ZxX3NpemUoKSk7Cj4gPiArICAgICBlcGZfdm5ldF9yY19zZXRfY29uZmlnOCh2bmV0
LCBWSVJUSU9fUENJX1NUQVRVUywgMCk7Cj4gPiArICAgICBlcGZfdm5ldF9yY19tZW1jcHlfY29u
ZmlnKHZuZXQsIFZJUlRJT19QQ0lfQ09ORklHX09GRihmYWxzZSksCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICZ2bmV0LT52bmV0X2NmZywgc2l6ZW9mKHZuZXQtPnZuZXRfY2Zn
KSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGVwZl92bmV0X2NsZWFudXBfYmFyKHN0
cnVjdCBlcGZfdm5ldCAqdm5ldCkKPiA+ICt7Cj4gPiArICAgICBzdHJ1Y3QgcGNpX2VwZiAqZXBm
ID0gdm5ldC0+ZXBmOwo+ID4gKwo+ID4gKyAgICAgcGNpX2VwY19jbGVhcl9iYXIoZXBmLT5lcGMs
IGVwZi0+ZnVuY19ubywgZXBmLT52ZnVuY19ubywKPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICZlcGYtPmJhcltWSVJUSU9fTkVUX0xFR0FDWV9DRkdfQkFSXSk7Cj4gPiArICAgICBwY2lfZXBm
X2ZyZWVfc3BhY2UoZXBmLCB2bmV0LT5yYy5jZmdfYmFzZSwgVklSVElPX05FVF9MRUdBQ1lfQ0ZH
X0JBUiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZX0lOVEVSRkFDRSk7Cj4g
PiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgZXBmX3ZuZXRfc2V0dXBfYmFyKHN0cnVjdCBlcGZf
dm5ldCAqdm5ldCkKPiA+ICt7Cj4gPiArICAgICBpbnQgZXJyOwo+ID4gKyAgICAgc2l6ZV90IGNm
Z19iYXJfc2l6ZSA9Cj4gPiArICAgICAgICAgICAgIFZJUlRJT19QQ0lfQ09ORklHX09GRihmYWxz
ZSkgKyBzaXplb2Yoc3RydWN0IHZpcnRpb19uZXRfY29uZmlnKTsKPiA+ICsgICAgIHN0cnVjdCBw
Y2lfZXBmICplcGYgPSB2bmV0LT5lcGY7Cj4gPiArICAgICBjb25zdCBzdHJ1Y3QgcGNpX2VwY19m
ZWF0dXJlcyAqZmVhdHVyZXM7Cj4gPiArICAgICBzdHJ1Y3QgcGNpX2VwZl9iYXIgKmNvbmZpZ19i
YXIgPSAmZXBmLT5iYXJbVklSVElPX05FVF9MRUdBQ1lfQ0ZHX0JBUl07Cj4gPiArCj4gPiArICAg
ICBmZWF0dXJlcyA9IHBjaV9lcGNfZ2V0X2ZlYXR1cmVzKGVwZi0+ZXBjLCBlcGYtPmZ1bmNfbm8s
IGVwZi0+dmZ1bmNfbm8pOwo+ID4gKyAgICAgaWYgKCFmZWF0dXJlcykgewo+ID4gKyAgICAgICAg
ICAgICBwcl9kZWJ1ZygiRmFpbGVkIHRvIGdldCBQQ0kgRVBDIGZlYXR1cmVzXG4iKTsKPiA+ICsg
ICAgICAgICAgICAgcmV0dXJuIC1FT1BOT1RTVVBQOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAg
ICAgaWYgKGZlYXR1cmVzLT5yZXNlcnZlZF9iYXIgJiBCSVQoVklSVElPX05FVF9MRUdBQ1lfQ0ZH
X0JBUikpIHsKPiA+ICsgICAgICAgICAgICAgcHJfZGVidWcoIkNhbm5vdCB1c2UgdGhlIFBDSSBC
QVIgZm9yIGxlZ2FjeSB2aXJ0aW8gcGNpXG4iKTsKPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1F
T1BOT1RTVVBQOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgaWYgKGZlYXR1cmVzLT5iYXJf
Zml4ZWRfc2l6ZVtWSVJUSU9fTkVUX0xFR0FDWV9DRkdfQkFSXSkgewo+ID4gKyAgICAgICAgICAg
ICBpZiAoY2ZnX2Jhcl9zaXplID4KPiA+ICsgICAgICAgICAgICAgICAgIGZlYXR1cmVzLT5iYXJf
Zml4ZWRfc2l6ZVtWSVJUSU9fTkVUX0xFR0FDWV9DRkdfQkFSXSkgewo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgIHByX2RlYnVnKCJQQ0kgQkFSIHNpemUgaXMgbm90IGVub3VnaFxuIik7Cj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gPiArICAgICAgICAgICAgIH0K
PiA+ICsgICAgIH0KPiA+ICsKPiA+ICsgICAgIGNvbmZpZ19iYXItPmZsYWdzIHw9IFBDSV9CQVNF
X0FERFJFU1NfTUVNX1RZUEVfNjQ7Cj4gPiArCj4gPiArICAgICB2bmV0LT5yYy5jZmdfYmFzZSA9
IHBjaV9lcGZfYWxsb2Nfc3BhY2UoZXBmLCBjZmdfYmFyX3NpemUsCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVklSVElPX05FVF9MRUdBQ1lfQ0ZHX0JB
UiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmZWF0
dXJlcy0+YWxpZ24sCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgUFJJTUFSWV9JTlRFUkZBQ0UpOwo+ID4gKyAgICAgaWYgKCF2bmV0LT5yYy5jZmdfYmFz
ZSkgewo+ID4gKyAgICAgICAgICAgICBwcl9kZWJ1ZygiRmFpbGVkIHRvIGFsbG9jYXRlIHZpcnRp
by1uZXQgY29uZmlnIG1lbW9yeVxuIik7Cj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU5PTUVN
Owo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgZXBmX3ZuZXRfcmNfc2V0dXBfY29uZmlncyh2
bmV0LCB2bmV0LT5yYy5jZmdfYmFzZSk7Cj4gPiArCj4gPiArICAgICBlcnIgPSBwY2lfZXBjX3Nl
dF9iYXIoZXBmLT5lcGMsIGVwZi0+ZnVuY19ubywgZXBmLT52ZnVuY19ubywKPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjb25maWdfYmFyKTsKPiA+ICsgICAgIGlmIChlcnIpIHsKPiA+
ICsgICAgICAgICAgICAgcHJfZGVidWcoIkZhaWxlZCB0byBzZXQgUENJIEJBUiIpOwo+ID4gKyAg
ICAgICAgICAgICBnb3RvIGVycl9mcmVlX3NwYWNlOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAg
ICAgcmV0dXJuIDA7Cj4gPiArCj4gPiArZXJyX2ZyZWVfc3BhY2U6Cj4gPiArICAgICBwY2lfZXBm
X2ZyZWVfc3BhY2UoZXBmLCB2bmV0LT5yYy5jZmdfYmFzZSwgVklSVElPX05FVF9MRUdBQ1lfQ0ZH
X0JBUiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZX0lOVEVSRkFDRSk7Cj4g
PiArICAgICByZXR1cm4gZXJyOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGVwZl92bmV0
X3JjX25lZ290aWF0ZV9jb25maWdzKHN0cnVjdCBlcGZfdm5ldCAqdm5ldCwgdTMyICp0eHBmbiwK
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUzMiAqcnhwZm4sIHUz
MiAqY3RscGZuKQo+ID4gK3sKPiA+ICsgICAgIGNvbnN0IHUxNiBucXVldWVzID0gZXBmX3ZuZXRf
cmNfZ2V0X251bWJlcl9vZl9xdWV1ZXModm5ldCk7Cj4gPiArICAgICBjb25zdCB1MTYgZGVmYXVs
dF9zZWwgPSBucXVldWVzOwo+ID4gKyAgICAgdTMyIF9faW9tZW0gKnF1ZXVlX3BmbiA9IHZuZXQt
PnJjLmNmZ19iYXNlICsgVklSVElPX1BDSV9RVUVVRV9QRk47Cj4gPiArICAgICB1MTYgX19pb21l
bSAqcXVldWVfc2VsID0gdm5ldC0+cmMuY2ZnX2Jhc2UgKyBWSVJUSU9fUENJX1FVRVVFX1NFTDsK
PiA+ICsgICAgIHU4IF9faW9tZW0gKnBjaV9zdGF0dXMgPSB2bmV0LT5yYy5jZmdfYmFzZSArIFZJ
UlRJT19QQ0lfU1RBVFVTOwo+ID4gKyAgICAgdTMyIHBmbjsKPiA+ICsgICAgIHUxNiBzZWw7Cj4g
PiArICAgICBzdHJ1Y3Qgewo+ID4gKyAgICAgICAgICAgICB1MzIgcGZuOwo+ID4gKyAgICAgICAg
ICAgICB1MTYgc2VsOwo+ID4gKyAgICAgfSB0bXBbM10gPSB7fTsKPiA+ICsgICAgIGludCB0bXBf
aW5kZXggPSAwOwo+ID4gKwo+ID4gKyAgICAgKnJ4cGZuID0gKnR4cGZuID0gKmN0bHBmbiA9IDA7
Cj4gPiArCj4gPiArICAgICAvKiBUbyBhdm9pZCB0byBtaXNzIGEgZ2V0dGluZyB0aGUgcGZuIGFu
ZCBzZWxlY3RvciBmb3IgdmlydHF1ZXVlIHdyb3RlIGJ5Cj4gPiArICAgICAgKiBob3N0IGRyaXZl
ciwgd2UgbmVlZCB0byBpbXBsZW1lbnQgZmFzdCBwb2xsaW5nIHdpdGggc2F2aW5nLgo+ID4gKyAg
ICAgICoKPiA+ICsgICAgICAqIFRoaXMgaW1wbGVtZW50YXRpb24gc3VzcGVjdHMgdGhhdCB0aGUg
aG9zdCBkcml2ZXIgd3JpdGVzIHBmbiBvbmx5IG9uY2UKPiA+ICsgICAgICAqIGZvciBlYWNoIHF1
ZXVlcwo+ID4gKyAgICAgICovCj4gPiArICAgICB3aGlsZSAodG1wX2luZGV4IDwgbnF1ZXVlcykg
ewo+ID4gKyAgICAgICAgICAgICBwZm4gPSBpb3JlYWQzMihxdWV1ZV9wZm4pOwo+ID4gKyAgICAg
ICAgICAgICBpZiAocGZuID09IDApCj4gPiArICAgICAgICAgICAgICAgICAgICAgY29udGludWU7
Cj4gPiArCj4gPiArICAgICAgICAgICAgIGlvd3JpdGUzMigwLCBxdWV1ZV9wZm4pOwo+ID4gKwo+
ID4gKyAgICAgICAgICAgICBzZWwgPSBpb3JlYWQxNihxdWV1ZV9zZWwpOwo+ID4gKyAgICAgICAg
ICAgICBpZiAoc2VsID09IGRlZmF1bHRfc2VsKQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGNv
bnRpbnVlOwo+ID4gKwo+ID4gKyAgICAgICAgICAgICB0bXBbdG1wX2luZGV4XS5wZm4gPSBwZm47
Cj4gPiArICAgICAgICAgICAgIHRtcFt0bXBfaW5kZXhdLnNlbCA9IHNlbDsKPiA+ICsgICAgICAg
ICAgICAgdG1wX2luZGV4Kys7Cj4gPiArICAgICB9Cj4gPiArCj4gPiArICAgICB3aGlsZSAoISgo
aW9yZWFkOChwY2lfc3RhdHVzKSAmIFZJUlRJT19DT05GSUdfU19EUklWRVJfT0spKSkKPiA+ICsg
ICAgICAgICAgICAgOwo+ID4gKwo+ID4gKyAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBucXVldWVz
OyArK2kpIHsKPiA+ICsgICAgICAgICAgICAgc3dpdGNoICh0bXBbaV0uc2VsKSB7Cj4gPiArICAg
ICAgICAgICAgIGNhc2UgMDoKPiA+ICsgICAgICAgICAgICAgICAgICAgICAqcnhwZm4gPSB0bXBb
aV0ucGZuOwo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gKyAgICAgICAgICAg
ICBjYXNlIDE6Cj4gPiArICAgICAgICAgICAgICAgICAgICAgKnR4cGZuID0gdG1wW2ldLnBmbjsK
PiA+ICsgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiA+ICsgICAgICAgICAgICAgY2FzZSAy
Ogo+ID4gKyAgICAgICAgICAgICAgICAgICAgICpjdGxwZm4gPSB0bXBbaV0ucGZuOwo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gKyAgICAgICAgICAgICB9Cj4gPiArICAgICB9
Cj4gPiArCj4gPiArICAgICBpZiAoISpyeHBmbiB8fCAhKnR4cGZuIHx8ICEqY3RscGZuKQo+ID4g
KyAgICAgICAgICAgICByZXR1cm4gLUVJTzsKPiA+ICsKPiA+ICsgICAgIHJldHVybiAwOwo+ID4g
K30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGVwZl92bmV0X3JjX21vbml0b3Jfbm90aWZ5KHZvaWQg
KmRhdGEpCj4gPiArewo+ID4gKyAgICAgc3RydWN0IGVwZl92bmV0ICp2bmV0ID0gZGF0YTsKPiA+
ICsgICAgIHUxNiBfX2lvbWVtICpxdWV1ZV9ub3RpZnkgPSB2bmV0LT5yYy5jZmdfYmFzZSArIFZJ
UlRJT19QQ0lfUVVFVUVfTk9USUZZOwo+ID4gKyAgICAgY29uc3QgdTE2IG5vdGlmeV9kZWZhdWx0
ID0gZXBmX3ZuZXRfcmNfZ2V0X251bWJlcl9vZl9xdWV1ZXModm5ldCk7Cj4gPiArCj4gPiArICAg
ICBlcGZfdm5ldF9pbml0X2NvbXBsZXRlKHZuZXQsIEVQRl9WTkVUX0lOSVRfQ09NUExFVEVfUkMp
Owo+ID4gKwo+ID4gKyAgICAgLyogUG9sbCB0byBkZXRlY3QgYSBjaGFuZ2Ugb2YgdGhlIHF1ZXVl
X25vdGlmeSByZWdpc3Rlci4gU29tZXRpbWVzIHRoaXMKPiA+ICsgICAgICAqIHBvbGxpbmcgbWlz
c2VzIHRoZSBjaGFuZ2UsIHNvIHRyeSB0byBjaGVjayBlYWNoIHZpcnRxdWV1ZXMKPiA+ICsgICAg
ICAqIGV2ZXJ5dGltZS4KPiA+ICsgICAgICAqLwo+ID4gKyAgICAgd2hpbGUgKHRydWUpIHsKPiA+
ICsgICAgICAgICAgICAgd2hpbGUgKGlvcmVhZDE2KHF1ZXVlX25vdGlmeSkgPT0gbm90aWZ5X2Rl
ZmF1bHQpCj4gPiArICAgICAgICAgICAgICAgICAgICAgOwo+ID4gKyAgICAgICAgICAgICBpb3dy
aXRlMTYobm90aWZ5X2RlZmF1bHQsIHF1ZXVlX25vdGlmeSk7Cj4gPiArCj4gPiArICAgICAgICAg
ICAgIHF1ZXVlX3dvcmsodm5ldC0+cmMudHhfd3EsICZ2bmV0LT5yYy50eF93b3JrKTsKPiA+ICsg
ICAgICAgICAgICAgcXVldWVfd29yayh2bmV0LT5yYy5jdGxfd3EsICZ2bmV0LT5yYy5jdGxfd29y
ayk7Cj4gPiArICAgICB9Cj4gPiArCj4gPiArICAgICByZXR1cm4gMDsKPiA+ICt9Cj4gPiArCj4g
PiArc3RhdGljIGludCBlcGZfdm5ldF9yY19zcGF3bl9ub3RpZnlfbW9uaXRvcihzdHJ1Y3QgZXBm
X3ZuZXQgKnZuZXQpCj4gPiArewo+ID4gKyAgICAgdm5ldC0+cmMubm90aWZ5X21vbml0b3JfdGFz
ayA9Cj4gPiArICAgICAgICAgICAgIGt0aHJlYWRfY3JlYXRlKGVwZl92bmV0X3JjX21vbml0b3Jf
bm90aWZ5LCB2bmV0LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAicGNpLWVwZi12
bmV0L2NmZ19uZWdvdGlhdG9yIik7Cj4gPiArICAgICBpZiAoSVNfRVJSKHZuZXQtPnJjLm5vdGlm
eV9tb25pdG9yX3Rhc2spKQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gUFRSX0VSUih2bmV0LT5y
Yy5ub3RpZnlfbW9uaXRvcl90YXNrKTsKPiA+ICsKPiA+ICsgICAgIC8qIENoYW5nZSB0aGUgdGhy
ZWFkIHByaW9yaXR5IHRvIGhpZ2ggZm9yIHBvbGxpbmcuICovCj4gPiArICAgICBzY2hlZF9zZXRf
Zmlmbyh2bmV0LT5yYy5ub3RpZnlfbW9uaXRvcl90YXNrKTsKPiA+ICsgICAgIHdha2VfdXBfcHJv
Y2Vzcyh2bmV0LT5yYy5ub3RpZnlfbW9uaXRvcl90YXNrKTsKPiA+ICsKPiA+ICsgICAgIHJldHVy
biAwOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGVwZl92bmV0X3JjX2RldmljZV9zZXR1
cCh2b2lkICpkYXRhKQo+ID4gK3sKPiA+ICsgICAgIHN0cnVjdCBlcGZfdm5ldCAqdm5ldCA9IGRh
dGE7Cj4gPiArICAgICBzdHJ1Y3QgcGNpX2VwZiAqZXBmID0gdm5ldC0+ZXBmOwo+ID4gKyAgICAg
dTMyIHR4cGZuLCByeHBmbiwgY3RscGZuOwo+ID4gKyAgICAgY29uc3Qgc2l6ZV90IHZxX3NpemUg
PSBlcGZfdm5ldF9nZXRfdnFfc2l6ZSgpOwo+ID4gKyAgICAgaW50IGVycjsKPiA+ICsKPiA+ICsg
ICAgIGVyciA9IGVwZl92bmV0X3JjX25lZ290aWF0ZV9jb25maWdzKHZuZXQsICZ0eHBmbiwgJnJ4
cGZuLCAmY3RscGZuKTsKPiA+ICsgICAgIGlmIChlcnIpIHsKPiA+ICsgICAgICAgICAgICAgcHJf
ZGVidWcoIkZhaWxlZCB0byBuZWdhdGlhdGUgY29uZmlncyB3aXRoIGRyaXZlclxuIik7Cj4gPiAr
ICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4gPiArICAgICB9Cj4gPiArCj4gPiArICAgICAvKiBQ
b2xsaW5nIHBoYXNlIGlzIGZpbmlzaGVkLiBUaGlzIHRocmVhZCBiYWNrcyB0byBub3JtYWwgcHJp
b3JpdHkuICovCj4gPiArICAgICBzY2hlZF9zZXRfbm9ybWFsKHZuZXQtPnJjLmRldmljZV9zZXR1
cF90YXNrLCAxOSk7Cj4gPiArCj4gPiArICAgICB2bmV0LT5yYy50eHZyaCA9IHBjaV9lcGZfdmly
dGlvX2FsbG9jX3ZyaW5naChlcGYsIHZuZXQtPnZpcnRpb19mZWF0dXJlcywKPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4cGZuLCB2cV9zaXpl
KTsKPiA+ICsgICAgIGlmIChJU19FUlIodm5ldC0+cmMudHh2cmgpKSB7Cj4gPiArICAgICAgICAg
ICAgIHByX2RlYnVnKCJGYWlsZWQgdG8gc2V0dXAgdmlydHF1ZXVlIGZvciB0eFxuIik7Cj4gPiAr
ICAgICAgICAgICAgIHJldHVybiBQVFJfRVJSKHZuZXQtPnJjLnR4dnJoKTsKPiA+ICsgICAgIH0K
PiA+ICsKPiA+ICsgICAgIGVyciA9IGVwZl92bmV0X2luaXRfa2lvdigmdm5ldC0+cmMudHhfaW92
LCB2cV9zaXplKTsKPiA+ICsgICAgIGlmIChlcnIpCj4gPiArICAgICAgICAgICAgIGdvdG8gZXJy
X2ZyZWVfZXBmX3R4X3ZyaW5naDsKPiA+ICsKPiA+ICsgICAgIHZuZXQtPnJjLnJ4dnJoID0gcGNp
X2VwZl92aXJ0aW9fYWxsb2NfdnJpbmdoKGVwZiwgdm5ldC0+dmlydGlvX2ZlYXR1cmVzLAo+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnhwZm4s
IHZxX3NpemUpOwo+ID4gKyAgICAgaWYgKElTX0VSUih2bmV0LT5yYy5yeHZyaCkpIHsKPiA+ICsg
ICAgICAgICAgICAgcHJfZGVidWcoIkZhaWxlZCB0byBzZXR1cCB2aXJ0cXVldWUgZm9yIHJ4XG4i
KTsKPiA+ICsgICAgICAgICAgICAgZXJyID0gUFRSX0VSUih2bmV0LT5yYy5yeHZyaCk7Cj4gPiAr
ICAgICAgICAgICAgIGdvdG8gZXJyX2RlaW5pdF90eF9raW92Owo+ID4gKyAgICAgfQo+ID4gKwo+
ID4gKyAgICAgZXJyID0gZXBmX3ZuZXRfaW5pdF9raW92KCZ2bmV0LT5yYy5yeF9pb3YsIHZxX3Np
emUpOwo+ID4gKyAgICAgaWYgKGVycikKPiA+ICsgICAgICAgICAgICAgZ290byBlcnJfZnJlZV9l
cGZfcnhfdnJpbmdoOwo+ID4gKwo+ID4gKyAgICAgdm5ldC0+cmMuY3RsdnJoID0gcGNpX2VwZl92
aXJ0aW9fYWxsb2NfdnJpbmdoKAo+ID4gKyAgICAgICAgICAgICBlcGYsIHZuZXQtPnZpcnRpb19m
ZWF0dXJlcywgY3RscGZuLCB2cV9zaXplKTsKPiA+ICsgICAgIGlmIChJU19FUlIodm5ldC0+cmMu
Y3RsdnJoKSkgewo+ID4gKyAgICAgICAgICAgICBwcl9lcnIoImZhaWxlZCB0byBzZXR1cCB2aXJ0
cXVldWVcbiIpOwo+ID4gKyAgICAgICAgICAgICBlcnIgPSBQVFJfRVJSKHZuZXQtPnJjLmN0bHZy
aCk7Cj4gPiArICAgICAgICAgICAgIGdvdG8gZXJyX2RlaW5pdF9yeF9raW92Owo+ID4gKyAgICAg
fQo+ID4gKwo+ID4gKyAgICAgZXJyID0gZXBmX3ZuZXRfaW5pdF9raW92KCZ2bmV0LT5yYy5jdGxf
cmlvdiwgdnFfc2l6ZSk7Cj4gPiArICAgICBpZiAoZXJyKQo+ID4gKyAgICAgICAgICAgICBnb3Rv
IGVycl9mcmVlX2VwZl9jdGxfdnJpbmdoOwo+ID4gKwo+ID4gKyAgICAgZXJyID0gZXBmX3ZuZXRf
aW5pdF9raW92KCZ2bmV0LT5yYy5jdGxfd2lvdiwgdnFfc2l6ZSk7Cj4gPiArICAgICBpZiAoZXJy
KQo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl9kZWluaXRfY3RsX3Jpb3Y7Cj4gPiArCj4gPiAr
ICAgICBlcnIgPSBlcGZfdm5ldF9yY19zcGF3bl9ub3RpZnlfbW9uaXRvcih2bmV0KTsKPiA+ICsg
ICAgIGlmIChlcnIpIHsKPiA+ICsgICAgICAgICAgICAgcHJfZGVidWcoIkZhaWxlZCB0byBjcmVh
dGUgbm90aWZ5IG1vbml0b3IgdGhyZWFkXG4iKTsKPiA+ICsgICAgICAgICAgICAgZ290byBlcnJf
ZGVpbml0X2N0bF93aW92Owo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgcmV0dXJuIDA7Cj4g
PiArCj4gPiArZXJyX2RlaW5pdF9jdGxfd2lvdjoKPiA+ICsgICAgIGVwZl92bmV0X2RlaW5pdF9r
aW92KCZ2bmV0LT5yYy5jdGxfd2lvdik7Cj4gPiArZXJyX2RlaW5pdF9jdGxfcmlvdjoKPiA+ICsg
ICAgIGVwZl92bmV0X2RlaW5pdF9raW92KCZ2bmV0LT5yYy5jdGxfcmlvdik7Cj4gPiArZXJyX2Zy
ZWVfZXBmX2N0bF92cmluZ2g6Cj4gPiArICAgICBwY2lfZXBmX3ZpcnRpb19mcmVlX3ZyaW5naChl
cGYsIHZuZXQtPnJjLmN0bHZyaCk7Cj4gPiArZXJyX2RlaW5pdF9yeF9raW92Ogo+ID4gKyAgICAg
ZXBmX3ZuZXRfZGVpbml0X2tpb3YoJnZuZXQtPnJjLnJ4X2lvdik7Cj4gPiArZXJyX2ZyZWVfZXBm
X3J4X3ZyaW5naDoKPiA+ICsgICAgIHBjaV9lcGZfdmlydGlvX2ZyZWVfdnJpbmdoKGVwZiwgdm5l
dC0+cmMucnh2cmgpOwo+ID4gK2Vycl9kZWluaXRfdHhfa2lvdjoKPiA+ICsgICAgIGVwZl92bmV0
X2RlaW5pdF9raW92KCZ2bmV0LT5yYy50eF9pb3YpOwo+ID4gK2Vycl9mcmVlX2VwZl90eF92cmlu
Z2g6Cj4gPiArICAgICBwY2lfZXBmX3ZpcnRpb19mcmVlX3ZyaW5naChlcGYsIHZuZXQtPnJjLnR4
dnJoKTsKPiA+ICsKPiA+ICsgICAgIHJldHVybiBlcnI7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRp
YyBpbnQgZXBmX3ZuZXRfcmNfc3Bhd25fZGV2aWNlX3NldHVwX3Rhc2soc3RydWN0IGVwZl92bmV0
ICp2bmV0KQo+ID4gK3sKPiA+ICsgICAgIHZuZXQtPnJjLmRldmljZV9zZXR1cF90YXNrID0ga3Ro
cmVhZF9jcmVhdGUoCj4gPiArICAgICAgICAgICAgIGVwZl92bmV0X3JjX2RldmljZV9zZXR1cCwg
dm5ldCwgInBjaS1lcGYtdm5ldC9jZmdfbmVnb3RpYXRvciIpOwo+ID4gKyAgICAgaWYgKElTX0VS
Uih2bmV0LT5yYy5kZXZpY2Vfc2V0dXBfdGFzaykpCj4gPiArICAgICAgICAgICAgIHJldHVybiBQ
VFJfRVJSKHZuZXQtPnJjLmRldmljZV9zZXR1cF90YXNrKTsKPiA+ICsKPiA+ICsgICAgIC8qIENo
YW5nZSB0aGUgdGhyZWFkIHByaW9yaXR5IHRvIGhpZ2ggZm9yIHRoZSBwb2xsaW5nLiAqLwo+ID4g
KyAgICAgc2NoZWRfc2V0X2ZpZm8odm5ldC0+cmMuZGV2aWNlX3NldHVwX3Rhc2spOwo+ID4gKyAg
ICAgd2FrZV91cF9wcm9jZXNzKHZuZXQtPnJjLmRldmljZV9zZXR1cF90YXNrKTsKPiA+ICsKPiA+
ICsgICAgIHJldHVybiAwOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBlcGZfdm5ldF9y
Y190eF9oYW5kbGVyKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICt7Cj4gPiArICAgICBz
dHJ1Y3QgZXBmX3ZuZXQgKnZuZXQgPSBjb250YWluZXJfb2Yod29yaywgc3RydWN0IGVwZl92bmV0
LCByYy50eF93b3JrKTsKPiA+ICsgICAgIHN0cnVjdCB2cmluZ2ggKnR4X3ZyaCA9ICZ2bmV0LT5y
Yy50eHZyaC0+dnJoOwo+ID4gKyAgICAgc3RydWN0IHZyaW5naCAqcnhfdnJoID0gJnZuZXQtPmVw
LnJ4dnJoOwo+ID4gKyAgICAgc3RydWN0IHZyaW5naF9raW92ICp0eF9pb3YgPSAmdm5ldC0+cmMu
dHhfaW92Owo+ID4gKyAgICAgc3RydWN0IHZyaW5naF9raW92ICpyeF9pb3YgPSAmdm5ldC0+ZXAu
cnhfaW92Owo+ID4gKwo+ID4gKyAgICAgd2hpbGUgKGVwZl92bmV0X3RyYW5zZmVyKHZuZXQsIHR4
X3ZyaCwgcnhfdnJoLCB0eF9pb3YsIHJ4X2lvdiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBETUFfREVWX1RPX01FTSkgPiAwKQo+ID4gKyAgICAgICAgICAgICA7Cj4gPiArfQo+
ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGVwZl92bmV0X3JjX3JhaXNlX2lycV9oYW5kbGVyKHN0cnVj
dCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICt7Cj4gPiArICAgICBzdHJ1Y3QgZXBmX3ZuZXQgKnZu
ZXQgPQo+ID4gKyAgICAgICAgICAgICBjb250YWluZXJfb2Yod29yaywgc3RydWN0IGVwZl92bmV0
LCByYy5yYWlzZV9pcnFfd29yayk7Cj4gPiArICAgICBzdHJ1Y3QgcGNpX2VwZiAqZXBmID0gdm5l
dC0+ZXBmOwo+ID4gKwo+ID4gKyAgICAgcGNpX2VwY19yYWlzZV9pcnEoZXBmLT5lcGMsIGVwZi0+
ZnVuY19ubywgZXBmLT52ZnVuY19ubywKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIFBDSV9F
UENfSVJRX0xFR0FDWSwgMCk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0cnVjdCBlcGZfdm5ldF9yY19t
ZW1pbmZvIHsKPiA+ICsgICAgIHZvaWQgX19pb21lbSAqYWRkciwgKnZpcnQ7Cj4gPiArICAgICBw
aHlzX2FkZHJfdCBwaHlzOwo+ID4gKyAgICAgc2l6ZV90IGxlbjsKPiA+ICt9Owo+ID4gKwo+ID4g
Ky8qIFV0aWwgZnVuY3Rpb24gdG8gYWNjZXNzIFBDSWUgaG9zdCBzaWRlIG1lbW9yeSBmcm9tIGxv
Y2FsIENQVS4gICovCj4gPiArc3RhdGljIHN0cnVjdCBlcGZfdm5ldF9yY19tZW1pbmZvICoKPiA+
ICtlcGZfdm5ldF9yY19lcGNfbW1hcChzdHJ1Y3QgcGNpX2VwZiAqZXBmLCBwaHlzX2FkZHJfdCBw
Y2lfYWRkciwgc2l6ZV90IGxlbikKPiA+ICt7Cj4gPiArICAgICBpbnQgZXJyOwo+ID4gKyAgICAg
cGh5c19hZGRyX3QgYWFkZHIsIHBoeXNfYWRkcjsKPiA+ICsgICAgIHNpemVfdCBhc2l6ZSwgb2Zm
c2V0Owo+ID4gKyAgICAgdm9pZCBfX2lvbWVtICp2aXJ0X2FkZHI7Cj4gPiArICAgICBzdHJ1Y3Qg
ZXBmX3ZuZXRfcmNfbWVtaW5mbyAqbWVtaW5mbzsKPiA+ICsKPiA+ICsgICAgIGVyciA9IHBjaV9l
cGNfbWVtX2FsaWduKGVwZi0+ZXBjLCBwY2lfYWRkciwgbGVuLCAmYWFkZHIsICZhc2l6ZSk7Cj4g
PiArICAgICBpZiAoZXJyKSB7Cj4gPiArICAgICAgICAgICAgIHByX2RlYnVnKCJGYWlsZWQgdG8g
Z2V0IEVQQyBhbGlnbjogJWRcbiIsIGVycik7Cj4gPiArICAgICAgICAgICAgIHJldHVybiBOVUxM
Owo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgb2Zmc2V0ID0gcGNpX2FkZHIgLSBhYWRkcjsK
PiA+ICsKPiA+ICsgICAgIHZpcnRfYWRkciA9IHBjaV9lcGNfbWVtX2FsbG9jX2FkZHIoZXBmLT5l
cGMsICZwaHlzX2FkZHIsIGFzaXplKTsKPiA+ICsgICAgIGlmICghdmlydF9hZGRyKSB7Cj4gPiAr
ICAgICAgICAgICAgIHByX2RlYnVnKCJGYWlsZWQgdG8gYWxsb2NhdGUgZXBjIG1lbW9yeVxuIik7
Cj4gPiArICAgICAgICAgICAgIHJldHVybiBOVUxMOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAg
ICAgZXJyID0gcGNpX2VwY19tYXBfYWRkcihlcGYtPmVwYywgZXBmLT5mdW5jX25vLCBlcGYtPnZm
dW5jX25vLCBwaHlzX2FkZHIsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFhZGRy
LCBhc2l6ZSk7Cj4gPiArICAgICBpZiAoZXJyKSB7Cj4gPiArICAgICAgICAgICAgIHByX2RlYnVn
KCJGYWlsZWQgdG8gbWFwIGVwYyBtZW1vcnlcbiIpOwo+ID4gKyAgICAgICAgICAgICBnb3RvIGVy
cl9lcGNfZnJlZV9hZGRyOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgbWVtaW5mbyA9IGtt
YWxsb2Moc2l6ZW9mKCptZW1pbmZvKSwgR0ZQX0tFUk5FTCk7Cj4gPiArICAgICBpZiAoIW1lbWlu
Zm8pCj4gPiArICAgICAgICAgICAgIGdvdG8gZXJyX2VwY191bm1hcF9hZGRyOwo+ID4gKwo+ID4g
KyAgICAgbWVtaW5mby0+dmlydCA9IHZpcnRfYWRkcjsKPiA+ICsgICAgIG1lbWluZm8tPnBoeXMg
PSBwaHlzX2FkZHI7Cj4gPiArICAgICBtZW1pbmZvLT5sZW4gPSBsZW47Cj4gPiArICAgICBtZW1p
bmZvLT5hZGRyID0gdmlydF9hZGRyICsgb2Zmc2V0Owo+ID4gKwo+ID4gKyAgICAgcmV0dXJuIG1l
bWluZm87Cj4gPiArCj4gPiArZXJyX2VwY191bm1hcF9hZGRyOgo+ID4gKyAgICAgcGNpX2VwY191
bm1hcF9hZGRyKGVwZi0+ZXBjLCBlcGYtPmZ1bmNfbm8sIGVwZi0+dmZ1bmNfbm8sCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgbWVtaW5mby0+cGh5cyk7Cj4gPiArZXJyX2VwY19mcmVlX2Fk
ZHI6Cj4gPiArICAgICBwY2lfZXBjX21lbV9mcmVlX2FkZHIoZXBmLT5lcGMsIG1lbWluZm8tPnBo
eXMsIG1lbWluZm8tPnZpcnQsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtaW5m
by0+bGVuKTsKPiA+ICsKPiA+ICsgICAgIHJldHVybiBOVUxMOwo+ID4gK30KPiA+ICsKPiA+ICtz
dGF0aWMgdm9pZCBlcGZfdm5ldF9yY19lcGNfbXVubWFwKHN0cnVjdCBwY2lfZXBmICplcGYsCj4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZXBmX3ZuZXRfcmNfbWVt
aW5mbyAqbWVtaW5mbykKPiA+ICt7Cj4gPiArICAgICBwY2lfZXBjX3VubWFwX2FkZHIoZXBmLT5l
cGMsIGVwZi0+ZnVuY19ubywgZXBmLT52ZnVuY19ubywKPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICBtZW1pbmZvLT5waHlzKTsKPiA+ICsgICAgIHBjaV9lcGNfbWVtX2ZyZWVfYWRkcihlcGYt
PmVwYywgbWVtaW5mby0+cGh5cywgbWVtaW5mby0+dmlydCwKPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICBtZW1pbmZvLT5sZW4pOwo+ID4gKyAgICAga2ZyZWUobWVtaW5mbyk7Cj4gPiAr
fQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgZXBmX3ZuZXRfcmNfcHJvY2Vzc19jdHJscV9lbnRyeShz
dHJ1Y3QgZXBmX3ZuZXQgKnZuZXQpCj4gPiArewo+ID4gKyAgICAgc3RydWN0IHZyaW5naF9raW92
ICpyaW92ID0gJnZuZXQtPnJjLmN0bF9yaW92Owo+ID4gKyAgICAgc3RydWN0IHZyaW5naF9raW92
ICp3aW92ID0gJnZuZXQtPnJjLmN0bF93aW92Owo+ID4gKyAgICAgc3RydWN0IHZyaW5naCAqdnJo
ID0gJnZuZXQtPnJjLmN0bHZyaC0+dnJoOwo+ID4gKyAgICAgc3RydWN0IHBjaV9lcGYgKmVwZiA9
IHZuZXQtPmVwZjsKPiA+ICsgICAgIHN0cnVjdCBlcGZfdm5ldF9yY19tZW1pbmZvICpybWVtLCAq
d21lbTsKPiA+ICsgICAgIHN0cnVjdCB2aXJ0aW9fbmV0X2N0cmxfaGRyICpoZHI7Cj4gPiArICAg
ICBpbnQgZXJyOwo+ID4gKyAgICAgdTE2IGhlYWQ7Cj4gPiArICAgICBzaXplX3QgdG90YWxfbGVu
Owo+ID4gKyAgICAgdTggY2xhc3MsIGNtZDsKPiA+ICsKPiA+ICsgICAgIGVyciA9IHZyaW5naF9n
ZXRkZXNjKHZyaCwgcmlvdiwgd2lvdiwgJmhlYWQpOwo+ID4gKyAgICAgaWYgKGVyciA8PSAwKQo+
ID4gKyAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ID4gKwo+ID4gKyAgICAgdG90YWxfbGVuID0g
dnJpbmdoX2tpb3ZfbGVuZ3RoKHJpb3YpOwo+ID4gKwo+ID4gKyAgICAgcm1lbSA9IGVwZl92bmV0
X3JjX2VwY19tbWFwKGVwZiwgKHU2NClyaW92LT5pb3Zbcmlvdi0+aV0uaW92X2Jhc2UsCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlvdi0+aW92W3Jpb3YtPmldLmlvdl9s
ZW4pOwo+ID4gKyAgICAgaWYgKCFybWVtKSB7Cj4gPiArICAgICAgICAgICAgIGVyciA9IC1FTk9N
RU07Cj4gPiArICAgICAgICAgICAgIGdvdG8gZXJyX2FiYW5kb25fZGVzY3M7Cj4gPiArICAgICB9
Cj4gPiArCj4gPiArICAgICB3bWVtID0gZXBmX3ZuZXRfcmNfZXBjX21tYXAoZXBmLCAodTY0KXdp
b3YtPmlvdlt3aW92LT5pXS5pb3ZfYmFzZSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB3aW92LT5pb3Zbd2lvdi0+aV0uaW92X2xlbik7Cj4gPiArICAgICBpZiAoIXdtZW0p
IHsKPiA+ICsgICAgICAgICAgICAgZXJyID0gLUVOT01FTTsKPiA+ICsgICAgICAgICAgICAgZ290
byBlcnJfZXBjX3VubWFwX3JtZW07Cj4gPiArICAgICB9Cj4gPiArCj4gPiArICAgICBoZHIgPSBy
bWVtLT5hZGRyOwo+ID4gKyAgICAgY2xhc3MgPSBpb3JlYWQ4KCZoZHItPmNsYXNzKTsKPiA+ICsg
ICAgIGNtZCA9IGlvcmVhZDgoJmhkci0+Y21kKTsKPiA+ICsgICAgIHN3aXRjaCAoaW9yZWFkOCgm
aGRyLT5jbGFzcykpIHsKPiA+ICsgICAgIGNhc2UgVklSVElPX05FVF9DVFJMX0FOTk9VTkNFOgo+
ID4gKyAgICAgICAgICAgICBpZiAoY21kICE9IFZJUlRJT19ORVRfQ1RSTF9BTk5PVU5DRV9BQ0sp
IHsKPiA+ICsgICAgICAgICAgICAgICAgICAgICBwcl9lcnIoIkZvdW5kIGludmFsaWQgY29tbWFu
ZDogYW5ub3VuY2U6ICVkXG4iLCBjbWQpOwo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGJyZWFr
Owo+ID4gKyAgICAgICAgICAgICB9Cj4gPiArICAgICAgICAgICAgIGVwZl92bmV0X3JjX2NsZWFy
X2NvbmZpZzE2KAo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHZuZXQsCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgVklSVElPX1BDSV9DT05GSUdfT0ZGKGZhbHNlKSArCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBvZmZzZXRvZihzdHJ1Y3QgdmlydGlvX25ldF9jb25maWcsIHN0
YXR1cyksCj4gPiArICAgICAgICAgICAgICAgICAgICAgVklSVElPX05FVF9TX0FOTk9VTkNFKTsK
PiA+ICsgICAgICAgICAgICAgZXBmX3ZuZXRfcmNfY2xlYXJfY29uZmlnMTYodm5ldCwgVklSVElP
X1BDSV9JU1IsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZJ
UlRJT19QQ0lfSVNSX0NPTkZJRyk7Cj4gPiArCj4gPiArICAgICAgICAgICAgIGlvd3JpdGU4KFZJ
UlRJT19ORVRfT0ssIHdtZW0tPmFkZHIpOwo+ID4gKyAgICAgICAgICAgICBicmVhazsKPiA+ICsg
ICAgIGRlZmF1bHQ6Cj4gPiArICAgICAgICAgICAgIHByX2VycigiRm91bmQgdW5zdXBwb3J0ZWQg
Y2xhc3MgaW4gY29udHJvbCBxdWV1ZTogJWRcbiIsIGNsYXNzKTsKPiA+ICsgICAgICAgICAgICAg
YnJlYWs7Cj4gPiArICAgICB9Cj4gPiArCj4gPiArICAgICBlcGZfdm5ldF9yY19lcGNfbXVubWFw
KGVwZiwgcm1lbSk7Cj4gPiArICAgICBlcGZfdm5ldF9yY19lcGNfbXVubWFwKGVwZiwgd21lbSk7
Cj4gPiArICAgICB2cmluZ2hfY29tcGxldGUodnJoLCBoZWFkLCB0b3RhbF9sZW4pOwo+ID4gKwo+
ID4gKyAgICAgcmV0dXJuIDE7Cj4gPiArCj4gPiArZXJyX2VwY191bm1hcF9ybWVtOgo+ID4gKyAg
ICAgZXBmX3ZuZXRfcmNfZXBjX211bm1hcChlcGYsIHJtZW0pOwo+ID4gK2Vycl9hYmFuZG9uX2Rl
c2NzOgo+ID4gKyAgICAgdnJpbmdoX2FiYW5kb24odnJoLCBoZWFkKTsKPiA+ICsKPiA+ICsgICAg
IHJldHVybiBlcnI7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGVwZl92bmV0X3JjX3By
b2Nlc3NfY3RybHFfZW50cmllcyhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gPiArewo+ID4g
KyAgICAgc3RydWN0IGVwZl92bmV0ICp2bmV0ID0KPiA+ICsgICAgICAgICAgICAgY29udGFpbmVy
X29mKHdvcmssIHN0cnVjdCBlcGZfdm5ldCwgcmMuY3RsX3dvcmspOwo+ID4gKwo+ID4gKyAgICAg
d2hpbGUgKGVwZl92bmV0X3JjX3Byb2Nlc3NfY3RybHFfZW50cnkodm5ldCkgPiAwKQo+ID4gKyAg
ICAgICAgICAgICA7Cj4gPiArfQo+ID4gKwo+ID4gK3ZvaWQgZXBmX3ZuZXRfcmNfbm90aWZ5KHN0
cnVjdCBlcGZfdm5ldCAqdm5ldCkKPiA+ICt7Cj4gPiArICAgICBxdWV1ZV93b3JrKHZuZXQtPnJj
LmlycV93cSwgJnZuZXQtPnJjLnJhaXNlX2lycV93b3JrKTsKPiA+ICt9Cj4gPiArCj4gPiArdm9p
ZCBlcGZfdm5ldF9yY19jbGVhbnVwKHN0cnVjdCBlcGZfdm5ldCAqdm5ldCkKPiA+ICt7Cj4gPiAr
ICAgICBlcGZfdm5ldF9jbGVhbnVwX2Jhcih2bmV0KTsKPiA+ICsgICAgIGRlc3Ryb3lfd29ya3F1
ZXVlKHZuZXQtPnJjLnR4X3dxKTsKPiA+ICsgICAgIGRlc3Ryb3lfd29ya3F1ZXVlKHZuZXQtPnJj
LmlycV93cSk7Cj4gPiArICAgICBkZXN0cm95X3dvcmtxdWV1ZSh2bmV0LT5yYy5jdGxfd3EpOwo+
ID4gKwo+ID4gKyAgICAga3RocmVhZF9zdG9wKHZuZXQtPnJjLmRldmljZV9zZXR1cF90YXNrKTsK
PiA+ICt9Cj4gPiArCj4gPiAraW50IGVwZl92bmV0X3JjX3NldHVwKHN0cnVjdCBlcGZfdm5ldCAq
dm5ldCkKPiA+ICt7Cj4gPiArICAgICBpbnQgZXJyOwo+ID4gKyAgICAgc3RydWN0IHBjaV9lcGYg
KmVwZiA9IHZuZXQtPmVwZjsKPiA+ICsKPiA+ICsgICAgIGVyciA9IHBjaV9lcGNfd3JpdGVfaGVh
ZGVyKGVwZi0+ZXBjLCBlcGYtPmZ1bmNfbm8sIGVwZi0+dmZ1bmNfbm8sCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAmZXBmX3ZuZXRfcGNpX2hlYWRlcik7Cj4gPiArICAgICBp
ZiAoZXJyKQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ID4gKwo+ID4gKyAgICAgZXJy
ID0gZXBmX3ZuZXRfc2V0dXBfYmFyKHZuZXQpOwo+ID4gKyAgICAgaWYgKGVycikKPiA+ICsgICAg
ICAgICAgICAgcmV0dXJuIGVycjsKPiA+ICsKPiA+ICsgICAgIHZuZXQtPnJjLnR4X3dxID0KPiA+
ICsgICAgICAgICAgICAgYWxsb2Nfd29ya3F1ZXVlKCJwY2ktZXBmLXZuZXQvdHgtd3EiLAo+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV1FfTUVNX1JFQ0xBSU0gfCBXUV9ISUdIUFJJ
IHwgV1FfVU5CT1VORCwgMCk7Cj4gPiArICAgICBpZiAoIXZuZXQtPnJjLnR4X3dxKSB7Cj4gPiAr
ICAgICAgICAgICAgIHByX2RlYnVnKAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICJGYWlsZWQg
dG8gYWxsb2NhdGUgd29ya3F1ZXVlIGZvciByYyAtPiBlcCB0cmFuc21pc3Npb25cbiIpOwo+ID4g
KyAgICAgICAgICAgICBlcnIgPSAtRU5PTUVNOwo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl9j
bGVhbnVwX2JhcjsKPiA+ICsgICAgIH0KPiA+ICsKPiA+ICsgICAgIElOSVRfV09SSygmdm5ldC0+
cmMudHhfd29yaywgZXBmX3ZuZXRfcmNfdHhfaGFuZGxlcik7Cj4gPiArCj4gPiArICAgICB2bmV0
LT5yYy5pcnFfd3EgPQo+ID4gKyAgICAgICAgICAgICBhbGxvY193b3JrcXVldWUoInBjaS1lcGYt
dm5ldC9pcnEtd3EiLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV1FfTUVNX1JF
Q0xBSU0gfCBXUV9ISUdIUFJJIHwgV1FfVU5CT1VORCwgMCk7Cj4gPiArICAgICBpZiAoIXZuZXQt
PnJjLmlycV93cSkgewo+ID4gKyAgICAgICAgICAgICBwcl9kZWJ1ZygiRmFpbGVkIHRvIGFsbG9j
YXRlIHdvcmtxdWV1ZSBmb3IgaXJxXG4iKTsKPiA+ICsgICAgICAgICAgICAgZXJyID0gLUVOT01F
TTsKPiA+ICsgICAgICAgICAgICAgZ290byBlcnJfZGVzdG9yeV90eF93cTsKPiA+ICsgICAgIH0K
PiA+ICsKPiA+ICsgICAgIElOSVRfV09SSygmdm5ldC0+cmMucmFpc2VfaXJxX3dvcmssIGVwZl92
bmV0X3JjX3JhaXNlX2lycV9oYW5kbGVyKTsKPiA+ICsKPiA+ICsgICAgIHZuZXQtPnJjLmN0bF93
cSA9Cj4gPiArICAgICAgICAgICAgIGFsbG9jX3dvcmtxdWV1ZSgicGNpLWVwZi12bmV0L2N0bC13
cSIsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBXUV9NRU1fUkVDTEFJTSB8IFdR
X0hJR0hQUkkgfCBXUV9VTkJPVU5ELCAwKTsKPiA+ICsgICAgIGlmICghdm5ldC0+cmMuY3RsX3dx
KSB7Cj4gPiArICAgICAgICAgICAgIHByX2VycigiRmFpbGVkIHRvIGFsbG9jYXRlIHdvcmsgcXVl
dWUgZm9yIGNvbnRyb2wgcXVldWUgcHJvY2Vzc2luZ1xuIik7Cj4gPiArICAgICAgICAgICAgIGVy
ciA9IC1FTk9NRU07Cj4gPiArICAgICAgICAgICAgIGdvdG8gZXJyX2Rlc3RvcnlfaXJxX3dxOwo+
ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgSU5JVF9XT1JLKCZ2bmV0LT5yYy5jdGxfd29yaywg
ZXBmX3ZuZXRfcmNfcHJvY2Vzc19jdHJscV9lbnRyaWVzKTsKPiA+ICsKPiA+ICsgICAgIGVyciA9
IGVwZl92bmV0X3JjX3NwYXduX2RldmljZV9zZXR1cF90YXNrKHZuZXQpOwo+ID4gKyAgICAgaWYg
KGVycikKPiA+ICsgICAgICAgICAgICAgZ290byBlcnJfZGVzdG9yeV9jdGxfd3E7Cj4gPiArCj4g
PiArICAgICByZXR1cm4gMDsKPiA+ICsKPiA+ICtlcnJfY2xlYW51cF9iYXI6Cj4gPiArICAgICBl
cGZfdm5ldF9jbGVhbnVwX2Jhcih2bmV0KTsKPiA+ICtlcnJfZGVzdG9yeV90eF93cToKPiA+ICsg
ICAgIGRlc3Ryb3lfd29ya3F1ZXVlKHZuZXQtPnJjLnR4X3dxKTsKPiA+ICtlcnJfZGVzdG9yeV9p
cnFfd3E6Cj4gPiArICAgICBkZXN0cm95X3dvcmtxdWV1ZSh2bmV0LT5yYy5pcnFfd3EpOwo+ID4g
K2Vycl9kZXN0b3J5X2N0bF93cToKPiA+ICsgICAgIGRlc3Ryb3lfd29ya3F1ZXVlKHZuZXQtPnJj
LmN0bF93cSk7Cj4gPiArCj4gPiArICAgICByZXR1cm4gZXJyOwo+ID4gK30KPiA+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL3BjaS9lbmRwb2ludC9mdW5jdGlvbnMvcGNpLWVwZi12bmV0LmMgYi9kcml2
ZXJzL3BjaS9lbmRwb2ludC9mdW5jdGlvbnMvcGNpLWVwZi12bmV0LmMKPiA+IG5ldyBmaWxlIG1v
ZGUgMTAwNjQ0Cj4gPiBpbmRleCAwMDAwMDAwMDAwMDAuLmU0OGFkODA2Nzc5Ngo+ID4gLS0tIC9k
ZXYvbnVsbAo+ID4gKysrIGIvZHJpdmVycy9wY2kvZW5kcG9pbnQvZnVuY3Rpb25zL3BjaS1lcGYt
dm5ldC5jCj4gPiBAQCAtMCwwICsxLDM4NyBAQAo+ID4gKy8vIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wCj4gPiArLyoKPiA+ICsgKiBQQ0kgRW5kcG9pbnQgZnVuY3Rpb24gZHJpdmVy
IHRvIGltcGxpbWVudCB2aXJ0aW8tbmV0IGRldmljZS4KPiA+ICsgKi8KPiA+ICsjaW5jbHVkZSA8
bGludXgvbW9kdWxlLmg+Cj4gPiArI2luY2x1ZGUgPGxpbnV4L3BjaS1lcGYuaD4KPiA+ICsjaW5j
bHVkZSA8bGludXgvcGNpLWVwYy5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC92cmluZ2guaD4KPiA+
ICsjaW5jbHVkZSA8bGludXgvZG1hZW5naW5lLmg+Cj4gPiArCj4gPiArI2luY2x1ZGUgInBjaS1l
cGYtdm5ldC5oIgo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgdmlydGlvX3F1ZXVlX3NpemUgPSAweDEw
MDsKPiA+ICttb2R1bGVfcGFyYW0odmlydGlvX3F1ZXVlX3NpemUsIGludCwgMDQ0NCk7Cj4gPiAr
TU9EVUxFX1BBUk1fREVTQyh2aXJ0aW9fcXVldWVfc2l6ZSwgIkEgbGVuZ3RoIG9mIHZpcnRxdWV1
ZSIpOwo+ID4gKwo+ID4gK2ludCBlcGZfdm5ldF9nZXRfdnFfc2l6ZSh2b2lkKQo+ID4gK3sKPiA+
ICsgICAgIHJldHVybiB2aXJ0aW9fcXVldWVfc2l6ZTsKPiA+ICt9Cj4gPiArCj4gPiAraW50IGVw
Zl92bmV0X2luaXRfa2lvdihzdHJ1Y3QgdnJpbmdoX2tpb3YgKmtpb3YsIGNvbnN0IHNpemVfdCB2
cV9zaXplKQo+ID4gK3sKPiA+ICsgICAgIHN0cnVjdCBrdmVjICprdmVjOwo+ID4gKwo+ID4gKyAg
ICAga3ZlYyA9IGttYWxsb2NfYXJyYXkodnFfc2l6ZSwgc2l6ZW9mKCprdmVjKSwgR0ZQX0tFUk5F
TCk7Cj4gPiArICAgICBpZiAoIWt2ZWMpCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU5PTUVN
Owo+ID4gKwo+ID4gKyAgICAgdnJpbmdoX2tpb3ZfaW5pdChraW92LCBrdmVjLCB2cV9zaXplKTsK
PiA+ICsKPiA+ICsgICAgIHJldHVybiAwOwo+ID4gK30KPiA+ICsKPiA+ICt2b2lkIGVwZl92bmV0
X2RlaW5pdF9raW92KHN0cnVjdCB2cmluZ2hfa2lvdiAqa2lvdikKPiA+ICt7Cj4gPiArICAgICBr
ZnJlZShraW92LT5pb3YpOwo+ID4gK30KPiA+ICsKPiA+ICt2b2lkIGVwZl92bmV0X2luaXRfY29t
cGxldGUoc3RydWN0IGVwZl92bmV0ICp2bmV0LCB1OCBmcm9tKQo+ID4gK3sKPiA+ICsgICAgIHZu
ZXQtPmluaXRfY29tcGxldGUgfD0gZnJvbTsKPiA+ICsKPiA+ICsgICAgIGlmICghKHZuZXQtPmlu
aXRfY29tcGxldGUgJiBFUEZfVk5FVF9JTklUX0NPTVBMRVRFX0VQKSkKPiA+ICsgICAgICAgICAg
ICAgcmV0dXJuOwo+ID4gKwo+ID4gKyAgICAgaWYgKCEodm5ldC0+aW5pdF9jb21wbGV0ZSAmIEVQ
Rl9WTkVUX0lOSVRfQ09NUExFVEVfUkMpKQo+ID4gKyAgICAgICAgICAgICByZXR1cm47Cj4gPiAr
Cj4gPiArICAgICBlcGZfdm5ldF9lcF9hbm5vdW5jZV9saW5rdXAodm5ldCk7Cj4gPiArICAgICBl
cGZfdm5ldF9yY19hbm5vdW5jZV9saW5rdXAodm5ldCk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0cnVj
dCBlcGZfZG1hX2ZpbHRlcl9wYXJhbSB7Cj4gPiArICAgICBzdHJ1Y3QgZGV2aWNlICpkZXY7Cj4g
PiArICAgICB1MzIgZG1hX21hc2s7Cj4gPiArfTsKPiA+ICsKPiA+ICtzdGF0aWMgYm9vbCBlcGZf
dmlydG5ldF9kbWFfZmlsdGVyKHN0cnVjdCBkbWFfY2hhbiAqY2hhbiwgdm9pZCAqcGFyYW0pCj4g
PiArewo+ID4gKyAgICAgc3RydWN0IGVwZl9kbWFfZmlsdGVyX3BhcmFtICpmcGFyYW0gPSBwYXJh
bTsKPiA+ICsgICAgIHN0cnVjdCBkbWFfc2xhdmVfY2FwcyBjYXBzOwo+ID4gKwo+ID4gKyAgICAg
bWVtc2V0KCZjYXBzLCAwLCBzaXplb2YoY2FwcykpOwo+ID4gKyAgICAgZG1hX2dldF9zbGF2ZV9j
YXBzKGNoYW4sICZjYXBzKTsKPiA+ICsKPiA+ICsgICAgIHJldHVybiBjaGFuLT5kZXZpY2UtPmRl
diA9PSBmcGFyYW0tPmRldiAmJgo+ID4gKyAgICAgICAgICAgIChmcGFyYW0tPmRtYV9tYXNrICYg
Y2Fwcy5kaXJlY3Rpb25zKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBlcGZfdm5ldF9p
bml0X2VkbWEoc3RydWN0IGVwZl92bmV0ICp2bmV0LCBzdHJ1Y3QgZGV2aWNlICpkbWFfZGV2KQo+
ID4gK3sKPiA+ICsgICAgIHN0cnVjdCBlcGZfZG1hX2ZpbHRlcl9wYXJhbSBwYXJhbTsKPiA+ICsg
ICAgIGRtYV9jYXBfbWFza190IG1hc2s7Cj4gPiArICAgICBpbnQgZXJyOwo+ID4gKwo+ID4gKyAg
ICAgZG1hX2NhcF96ZXJvKG1hc2spOwo+ID4gKyAgICAgZG1hX2NhcF9zZXQoRE1BX1NMQVZFLCBt
YXNrKTsKPiA+ICsKPiA+ICsgICAgIHBhcmFtLmRldiA9IGRtYV9kZXY7Cj4gPiArICAgICBwYXJh
bS5kbWFfbWFzayA9IEJJVChETUFfTUVNX1RPX0RFVik7Cj4gPiArICAgICB2bmV0LT5scl9kbWFf
Y2hhbiA9Cj4gPiArICAgICAgICAgICAgIGRtYV9yZXF1ZXN0X2NoYW5uZWwobWFzaywgZXBmX3Zp
cnRuZXRfZG1hX2ZpbHRlciwgJnBhcmFtKTsKPiA+ICsgICAgIGlmICghdm5ldC0+bHJfZG1hX2No
YW4pCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsKPiA+ICsKPiA+ICsgICAg
IHBhcmFtLmRtYV9tYXNrID0gQklUKERNQV9ERVZfVE9fTUVNKTsKPiA+ICsgICAgIHZuZXQtPnJs
X2RtYV9jaGFuID0KPiA+ICsgICAgICAgICAgICAgZG1hX3JlcXVlc3RfY2hhbm5lbChtYXNrLCBl
cGZfdmlydG5ldF9kbWFfZmlsdGVyLCAmcGFyYW0pOwo+ID4gKyAgICAgaWYgKCF2bmV0LT5ybF9k
bWFfY2hhbikgewo+ID4gKyAgICAgICAgICAgICBlcnIgPSAtRU9QTk9UU1VQUDsKPiA+ICsgICAg
ICAgICAgICAgZ290byBlcnJfcmVsZWFzZV9jaGFubmVsOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4g
KyAgICAgcmV0dXJuIDA7Cj4gPiArCj4gPiArZXJyX3JlbGVhc2VfY2hhbm5lbDoKPiA+ICsgICAg
IGRtYV9yZWxlYXNlX2NoYW5uZWwodm5ldC0+bHJfZG1hX2NoYW4pOwo+ID4gKwo+ID4gKyAgICAg
cmV0dXJuIGVycjsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgZXBmX3ZuZXRfZGVpbml0
X2VkbWEoc3RydWN0IGVwZl92bmV0ICp2bmV0KQo+ID4gK3sKPiA+ICsgICAgIGRtYV9yZWxlYXNl
X2NoYW5uZWwodm5ldC0+bHJfZG1hX2NoYW4pOwo+ID4gKyAgICAgZG1hX3JlbGVhc2VfY2hhbm5l
bCh2bmV0LT5ybF9kbWFfY2hhbik7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgZXBmX3Zu
ZXRfZG1hX3NpbmdsZShzdHJ1Y3QgZXBmX3ZuZXQgKnZuZXQsIHBoeXNfYWRkcl90IHBjaSwKPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG1hX2FkZHJfdCBkbWEsIHNpemVfdCBsZW4s
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKCpjYWxsYmFjaykodm9pZCAq
KSwgdm9pZCAqcGFyYW0sCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudW0gZG1h
X3RyYW5zZmVyX2RpcmVjdGlvbiBkaXIpCj4gPiArewo+ID4gKyAgICAgc3RydWN0IGRtYV9hc3lu
Y190eF9kZXNjcmlwdG9yICpkZXNjOwo+ID4gKyAgICAgaW50IGVycjsKPiA+ICsgICAgIHN0cnVj
dCBkbWFfY2hhbiAqY2hhbjsKPiA+ICsgICAgIHN0cnVjdCBkbWFfc2xhdmVfY29uZmlnIHNjb25m
Owo+ID4gKyAgICAgZG1hX2Nvb2tpZV90IGNvb2tpZTsKPiA+ICsgICAgIHVuc2lnbmVkIGxvbmcg
ZmxhZ3MgPSAwOwo+ID4gKwo+ID4gKyAgICAgaWYgKGRpciA9PSBETUFfTUVNX1RPX0RFVikgewo+
ID4gKyAgICAgICAgICAgICBzY29uZi5kc3RfYWRkciA9IHBjaTsKPiA+ICsgICAgICAgICAgICAg
Y2hhbiA9IHZuZXQtPmxyX2RtYV9jaGFuOwo+ID4gKyAgICAgfSBlbHNlIHsKPiA+ICsgICAgICAg
ICAgICAgc2NvbmYuc3JjX2FkZHIgPSBwY2k7Cj4gPiArICAgICAgICAgICAgIGNoYW4gPSB2bmV0
LT5ybF9kbWFfY2hhbjsKPiA+ICsgICAgIH0KPiA+ICsKPiA+ICsgICAgIGVyciA9IGRtYWVuZ2lu
ZV9zbGF2ZV9jb25maWcoY2hhbiwgJnNjb25mKTsKPiA+ICsgICAgIGlmICh1bmxpa2VseShlcnIp
KQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ID4gKwo+ID4gKyAgICAgaWYgKGNhbGxi
YWNrKQo+ID4gKyAgICAgICAgICAgICBmbGFncyA9IERNQV9QUkVQX0lOVEVSUlVQVCB8IERNQV9Q
UkVQX0ZFTkNFOwo+ID4gKwo+ID4gKyAgICAgZGVzYyA9IGRtYWVuZ2luZV9wcmVwX3NsYXZlX3Np
bmdsZShjaGFuLCBkbWEsIGxlbiwgZGlyLCBmbGFncyk7Cj4gPiArICAgICBpZiAodW5saWtlbHko
IWRlc2MpKQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVJTzsKPiA+ICsKPiA+ICsgICAgIGRl
c2MtPmNhbGxiYWNrID0gY2FsbGJhY2s7Cj4gPiArICAgICBkZXNjLT5jYWxsYmFja19wYXJhbSA9
IHBhcmFtOwo+ID4gKwo+ID4gKyAgICAgY29va2llID0gZG1hZW5naW5lX3N1Ym1pdChkZXNjKTsK
PiA+ICsgICAgIGVyciA9IGRtYV9zdWJtaXRfZXJyb3IoY29va2llKTsKPiA+ICsgICAgIGlmICh1
bmxpa2VseShlcnIpKQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ID4gKwo+ID4gKyAg
ICAgZG1hX2FzeW5jX2lzc3VlX3BlbmRpbmcoY2hhbik7Cj4gPiArCj4gPiArICAgICByZXR1cm4g
MDsKPiA+ICt9Cj4gPiArCj4gPiArc3RydWN0IGVwZl92bmV0X2RtYV9jYWxsYmFja19wYXJhbSB7
Cj4gPiArICAgICBzdHJ1Y3QgZXBmX3ZuZXQgKnZuZXQ7Cj4gPiArICAgICBzdHJ1Y3QgdnJpbmdo
ICp0eF92cmgsICpyeF92cmg7Cj4gPiArICAgICBzdHJ1Y3QgdmlydHF1ZXVlICp2cTsKPiA+ICsg
ICAgIHNpemVfdCB0b3RhbF9sZW47Cj4gPiArICAgICB1MTYgdHhfaGVhZCwgcnhfaGVhZDsKPiA+
ICt9Owo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGVwZl92bmV0X2RtYV9jYWxsYmFjayh2b2lkICpw
KQo+ID4gK3sKPiA+ICsgICAgIHN0cnVjdCBlcGZfdm5ldF9kbWFfY2FsbGJhY2tfcGFyYW0gKnBh
cmFtID0gcDsKPiA+ICsgICAgIHN0cnVjdCBlcGZfdm5ldCAqdm5ldCA9IHBhcmFtLT52bmV0Owo+
ID4gKwo+ID4gKyAgICAgdnJpbmdoX2NvbXBsZXRlKHBhcmFtLT50eF92cmgsIHBhcmFtLT50eF9o
ZWFkLCBwYXJhbS0+dG90YWxfbGVuKTsKPiA+ICsgICAgIHZyaW5naF9jb21wbGV0ZShwYXJhbS0+
cnhfdnJoLCBwYXJhbS0+cnhfaGVhZCwgcGFyYW0tPnRvdGFsX2xlbik7Cj4gPiArCj4gPiArICAg
ICBlcGZfdm5ldF9yY19ub3RpZnkodm5ldCk7Cj4gPiArICAgICBlcGZfdm5ldF9lcF9ub3RpZnko
dm5ldCwgcGFyYW0tPnZxKTsKPiA+ICsKPiA+ICsgICAgIGtmcmVlKHBhcmFtKTsKPiA+ICt9Cj4g
PiArCj4gPiArLyoqCj4gPiArICogZXBmX3ZuZXRfdHJhbnNmZXIoKSAtIHRyYW5zZmVyIGRhdGEg
YmV0d2VlbiB0eCB2cmluZyB0byByeCB2cmluZyB1c2luZyBlZG1hCj4gPiArICogQHZuZXQ6IGVw
ZiB2aXJ0aW8gbmV0IGRldmljZSB0byBkbyBkbWEKPiA+ICsgKiBAdHhfdnJoOiB2cmluZ2ggcmVs
YXRlZCB0byBzb3VyY2UgdHggdnJpbmcKPiA+ICsgKiBAcnhfdnJoOiB2cmluZ2ggcmVsYXRlZCB0
byB0YXJnZXQgcnggdnJpbmcKPiA+ICsgKiBAdHhfaW92OiBidWZmZXIgdG8gdXNlIHR4Cj4gPiAr
ICogQHJ4X2lvdjogYnVmZmVyIHRvIHVzZSByeAo+ID4gKyAqIEBkaXI6IGEgZGlyZWN0aW9uIG9m
IERNQS4gbG9jYWwgdG8gcmVtb3RlIG9yIGxvY2FsIGZyb20gcmVtb3RlCj4gPiArICoKPiA+ICsg
KiBUaGlzIGZ1bmN0aW9uIHJldHVybnMgMCwgMSBvciBlcnJvciBudW1iZXIuIFRoZSAwIGluZGlj
YXRlcyB0aGVyZSBpcyBub3QKPiA+ICsgKiBkYXRhIHRvIHNlbmQuIFRoZSAxIGluZGljYXRlcyBh
IHJlcXVlc3QgdG8gRE1BIGlzIHN1Y2NlZWRlZC4gT3RoZXIgZXJyb3IKPiA+ICsgKiBudW1iZXJz
IHNob3dzIGVycm9yLCBob3dldmVyLCBFTk9TUEMgbWVhbnMgdGhlcmUgaXMgbm8gYnVmZmVyIG9u
IHRhcmdldAo+ID4gKyAqIHZyaW5nLCBzbyBzaG91bGQgcmV0cnkgdG8gY2FsbCBsYXRlci4KPiA+
ICsgKi8KPiA+ICtpbnQgZXBmX3ZuZXRfdHJhbnNmZXIoc3RydWN0IGVwZl92bmV0ICp2bmV0LCBz
dHJ1Y3QgdnJpbmdoICp0eF92cmgsCj4gPiArICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2cmlu
Z2ggKnJ4X3ZyaCwgc3RydWN0IHZyaW5naF9raW92ICp0eF9pb3YsCj4gPiArICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCB2cmluZ2hfa2lvdiAqcnhfaW92LAo+ID4gKyAgICAgICAgICAgICAgICAg
ICBlbnVtIGRtYV90cmFuc2Zlcl9kaXJlY3Rpb24gZGlyKQo+ID4gK3sKPiA+ICsgICAgIGludCBl
cnI7Cj4gPiArICAgICB1MTYgdHhfaGVhZCwgcnhfaGVhZDsKPiA+ICsgICAgIHNpemVfdCB0b3Rh
bF90eF9sZW47Cj4gPiArICAgICBzdHJ1Y3QgZXBmX3ZuZXRfZG1hX2NhbGxiYWNrX3BhcmFtICpj
Yl9wYXJhbTsKPiA+ICsgICAgIHN0cnVjdCB2cmluZ2hfa2lvdiAqbGlvdiwgKnJpb3Y7Cj4gPiAr
Cj4gPiArICAgICBlcnIgPSB2cmluZ2hfZ2V0ZGVzYyh0eF92cmgsIHR4X2lvdiwgTlVMTCwgJnR4
X2hlYWQpOwo+ID4gKyAgICAgaWYgKGVyciA8PSAwKQo+ID4gKyAgICAgICAgICAgICByZXR1cm4g
ZXJyOwo+ID4gKwo+ID4gKyAgICAgdG90YWxfdHhfbGVuID0gdnJpbmdoX2tpb3ZfbGVuZ3RoKHR4
X2lvdik7Cj4gPiArCj4gPiArICAgICBlcnIgPSB2cmluZ2hfZ2V0ZGVzYyhyeF92cmgsIE5VTEws
IHJ4X2lvdiwgJnJ4X2hlYWQpOwo+ID4gKyAgICAgaWYgKGVyciA8IDApIHsKPiA+ICsgICAgICAg
ICAgICAgZ290byBlcnJfdHhfY29tcGxldGU7Cj4gPiArICAgICB9IGVsc2UgaWYgKCFlcnIpIHsK
PiA+ICsgICAgICAgICAgICAgLyogVGhlcmUgaXMgbm90IHNwYWNlIG9uIGEgdnJpbmcgb2YgZGVz
dGluYXRpb24gdG8gdHJhbnNtaXQgZGF0YSwgc28KPiA+ICsgICAgICAgICAgICAgICogcm9sbGJh
Y2sgdHggdnJpbmdoCj4gPiArICAgICAgICAgICAgICAqLwo+ID4gKyAgICAgICAgICAgICB2cmlu
Z2hfYWJhbmRvbih0eF92cmgsIHR4X2hlYWQpOwo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVO
T1NQQzsKPiA+ICsgICAgIH0KPiA+ICsKPiA+ICsgICAgIGNiX3BhcmFtID0ga21hbGxvYyhzaXpl
b2YoKmNiX3BhcmFtKSwgR0ZQX0tFUk5FTCk7Cj4gPiArICAgICBpZiAoIWNiX3BhcmFtKSB7Cj4g
PiArICAgICAgICAgICAgIGVyciA9IC1FTk9NRU07Cj4gPiArICAgICAgICAgICAgIGdvdG8gZXJy
X3J4X2NvbXBsZXRlOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgY2JfcGFyYW0tPnR4X3Zy
aCA9IHR4X3ZyaDsKPiA+ICsgICAgIGNiX3BhcmFtLT5yeF92cmggPSByeF92cmg7Cj4gPiArICAg
ICBjYl9wYXJhbS0+dHhfaGVhZCA9IHR4X2hlYWQ7Cj4gPiArICAgICBjYl9wYXJhbS0+cnhfaGVh
ZCA9IHJ4X2hlYWQ7Cj4gPiArICAgICBjYl9wYXJhbS0+dG90YWxfbGVuID0gdG90YWxfdHhfbGVu
Owo+ID4gKyAgICAgY2JfcGFyYW0tPnZuZXQgPSB2bmV0Owo+ID4gKwo+ID4gKyAgICAgc3dpdGNo
IChkaXIpIHsKPiA+ICsgICAgIGNhc2UgRE1BX01FTV9UT19ERVY6Cj4gPiArICAgICAgICAgICAg
IGxpb3YgPSB0eF9pb3Y7Cj4gPiArICAgICAgICAgICAgIHJpb3YgPSByeF9pb3Y7Cj4gPiArICAg
ICAgICAgICAgIGNiX3BhcmFtLT52cSA9IHZuZXQtPmVwLnR4dnE7Cj4gPiArICAgICAgICAgICAg
IGJyZWFrOwo+ID4gKyAgICAgY2FzZSBETUFfREVWX1RPX01FTToKPiA+ICsgICAgICAgICAgICAg
bGlvdiA9IHJ4X2lvdjsKPiA+ICsgICAgICAgICAgICAgcmlvdiA9IHR4X2lvdjsKPiA+ICsgICAg
ICAgICAgICAgY2JfcGFyYW0tPnZxID0gdm5ldC0+ZXAucnh2cTsKPiA+ICsgICAgICAgICAgICAg
YnJlYWs7Cj4gPiArICAgICBkZWZhdWx0Ogo+ID4gKyAgICAgICAgICAgICBlcnIgPSAtRUlOVkFM
Owo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl9mcmVlX3BhcmFtOwo+ID4gKyAgICAgfQo+ID4g
Kwo+ID4gKyAgICAgZm9yICg7IHR4X2lvdi0+aSA8IHR4X2lvdi0+dXNlZDsgdHhfaW92LT5pKyss
IHJ4X2lvdi0+aSsrKSB7Cj4gPiArICAgICAgICAgICAgIHNpemVfdCBsZW47Cj4gPiArICAgICAg
ICAgICAgIHU2NCBsYmFzZSwgcmJhc2U7Cj4gPiArICAgICAgICAgICAgIHZvaWQgKCpjYWxsYmFj
aykodm9pZCAqKSA9IE5VTEw7Cj4gPiArCj4gPiArICAgICAgICAgICAgIGxiYXNlID0gKHU2NCls
aW92LT5pb3ZbbGlvdi0+aV0uaW92X2Jhc2U7Cj4gPiArICAgICAgICAgICAgIHJiYXNlID0gKHU2
NClyaW92LT5pb3Zbcmlvdi0+aV0uaW92X2Jhc2U7Cj4gPiArICAgICAgICAgICAgIGxlbiA9IHR4
X2lvdi0+aW92W3R4X2lvdi0+aV0uaW92X2xlbjsKPiA+ICsKPiA+ICsgICAgICAgICAgICAgaWYg
KHR4X2lvdi0+aSArIDEgPT0gdHhfaW92LT51c2VkKQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
IGNhbGxiYWNrID0gZXBmX3ZuZXRfZG1hX2NhbGxiYWNrOwo+ID4gKwo+ID4gKyAgICAgICAgICAg
ICBlcnIgPSBlcGZfdm5ldF9kbWFfc2luZ2xlKHZuZXQsIHJiYXNlLCBsYmFzZSwgbGVuLCBjYWxs
YmFjaywKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYl9wYXJh
bSwgZGlyKTsKPiA+ICsgICAgICAgICAgICAgaWYgKGVycikKPiA+ICsgICAgICAgICAgICAgICAg
ICAgICBnb3RvIGVycl9mcmVlX3BhcmFtOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgcmV0
dXJuIDE7Cj4gPiArCj4gPiArZXJyX2ZyZWVfcGFyYW06Cj4gPiArICAgICBrZnJlZShjYl9wYXJh
bSk7Cj4gPiArZXJyX3J4X2NvbXBsZXRlOgo+ID4gKyAgICAgdnJpbmdoX2NvbXBsZXRlKHJ4X3Zy
aCwgcnhfaGVhZCwgdnJpbmdoX2tpb3ZfbGVuZ3RoKHJ4X2lvdikpOwo+ID4gK2Vycl90eF9jb21w
bGV0ZToKPiA+ICsgICAgIHZyaW5naF9jb21wbGV0ZSh0eF92cmgsIHR4X2hlYWQsIHRvdGFsX3R4
X2xlbik7Cj4gPiArCj4gPiArICAgICByZXR1cm4gZXJyOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0
aWMgaW50IGVwZl92bmV0X2JpbmQoc3RydWN0IHBjaV9lcGYgKmVwZikKPiA+ICt7Cj4gPiArICAg
ICBpbnQgZXJyOwo+ID4gKyAgICAgc3RydWN0IGVwZl92bmV0ICp2bmV0ID0gZXBmX2dldF9kcnZk
YXRhKGVwZik7Cj4gPiArCj4gPiArICAgICBlcnIgPSBlcGZfdm5ldF9pbml0X2VkbWEodm5ldCwg
ZXBmLT5lcGMtPmRldi5wYXJlbnQpOwo+ID4gKyAgICAgaWYgKGVycikKPiA+ICsgICAgICAgICAg
ICAgcmV0dXJuIGVycjsKPiA+ICsKPiA+ICsgICAgIGVyciA9IGVwZl92bmV0X3JjX3NldHVwKHZu
ZXQpOwo+ID4gKyAgICAgaWYgKGVycikKPiA+ICsgICAgICAgICAgICAgZ290byBlcnJfZnJlZV9l
ZG1hOwo+ID4gKwo+ID4gKyAgICAgZXJyID0gZXBmX3ZuZXRfZXBfc2V0dXAodm5ldCk7Cj4gPiAr
ICAgICBpZiAoZXJyKQo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl9jbGVhbnVwX3JjOwo+ID4g
Kwo+ID4gKyAgICAgcmV0dXJuIDA7Cj4gPiArCj4gPiArZXJyX2ZyZWVfZWRtYToKPiA+ICsgICAg
IGVwZl92bmV0X2RlaW5pdF9lZG1hKHZuZXQpOwo+ID4gK2Vycl9jbGVhbnVwX3JjOgo+ID4gKyAg
ICAgZXBmX3ZuZXRfcmNfY2xlYW51cCh2bmV0KTsKPiA+ICsKPiA+ICsgICAgIHJldHVybiBlcnI7
Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGVwZl92bmV0X3VuYmluZChzdHJ1Y3QgcGNp
X2VwZiAqZXBmKQo+ID4gK3sKPiA+ICsgICAgIHN0cnVjdCBlcGZfdm5ldCAqdm5ldCA9IGVwZl9n
ZXRfZHJ2ZGF0YShlcGYpOwo+ID4gKwo+ID4gKyAgICAgZXBmX3ZuZXRfZGVpbml0X2VkbWEodm5l
dCk7Cj4gPiArICAgICBlcGZfdm5ldF9yY19jbGVhbnVwKHZuZXQpOwo+ID4gKyAgICAgZXBmX3Zu
ZXRfZXBfY2xlYW51cCh2bmV0KTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHN0cnVjdCBwY2lf
ZXBmX29wcyBlcGZfdm5ldF9vcHMgPSB7Cj4gPiArICAgICAuYmluZCA9IGVwZl92bmV0X2JpbmQs
Cj4gPiArICAgICAudW5iaW5kID0gZXBmX3ZuZXRfdW5iaW5kLAo+ID4gK307Cj4gPiArCj4gPiAr
c3RhdGljIGNvbnN0IHN0cnVjdCBwY2lfZXBmX2RldmljZV9pZCBlcGZfdm5ldF9pZHNbXSA9IHsK
PiA+ICsgICAgIHsgLm5hbWUgPSAicGNpX2VwZl92bmV0IiB9LAo+ID4gKyAgICAge30KPiA+ICt9
Owo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGVwZl92bmV0X3ZpcnRpb19pbml0KHN0cnVjdCBlcGZf
dm5ldCAqdm5ldCkKPiA+ICt7Cj4gPiArICAgICB2bmV0LT52aXJ0aW9fZmVhdHVyZXMgPQo+ID4g
KyAgICAgICAgICAgICBCSVQoVklSVElPX05FVF9GX01UVSkgfCBCSVQoVklSVElPX05FVF9GX1NU
QVRVUykgfAo+ID4gKyAgICAgICAgICAgICAvKiBGb2xsb3dpbmcgZmVhdHVyZXMgYXJlIHRvIHNr
aXAgYW55IG9mIGNoZWNraW5nIGFuZCBvZmZsb2FkaW5nLCBMaWtlIGEKPiA+ICsgICAgICAgICAg
ICAgICogdHJhbnNtaXNzaW9uIGJldHdlZW4gdmlydHVhbCBtYWNoaW5lcyBvbiBzYW1lIHN5c3Rl
bS4gRGV0YWlscyBhcmUgb24KPiA+ICsgICAgICAgICAgICAgICogc2VjdGlvbiA1LjEuNSBpbiB2
aXJ0aW8gc3BlY2lmaWNhdGlvbi4KPiA+ICsgICAgICAgICAgICAgICovCj4gPiArICAgICAgICAg
ICAgIEJJVChWSVJUSU9fTkVUX0ZfR1VFU1RfQ1NVTSkgfCBCSVQoVklSVElPX05FVF9GX0dVRVNU
X1RTTzQpIHwKPiA+ICsgICAgICAgICAgICAgQklUKFZJUlRJT19ORVRfRl9HVUVTVF9UU082KSB8
IEJJVChWSVJUSU9fTkVUX0ZfR1VFU1RfRUNOKSB8Cj4gPiArICAgICAgICAgICAgIEJJVChWSVJU
SU9fTkVUX0ZfR1VFU1RfVUZPKSB8Cj4gPiArICAgICAgICAgICAgIC8vIFRoZSBjb250cm9sIHF1
ZXVlIGlzIGp1c3QgdXNlZCBmb3IgbGlua3VwIGFubm91bmNlbWVudC4KPiA+ICsgICAgICAgICAg
ICAgQklUKFZJUlRJT19ORVRfRl9DVFJMX1ZRKTsKPiA+ICsKPiA+ICsgICAgIHZuZXQtPnZuZXRf
Y2ZnLm1heF92aXJ0cXVldWVfcGFpcnMgPSAxOwo+ID4gKyAgICAgdm5ldC0+dm5ldF9jZmcuc3Rh
dHVzID0gMDsKPiA+ICsgICAgIHZuZXQtPnZuZXRfY2ZnLm10dSA9IFBBR0VfU0laRTsKPiA+ICt9
Cj4gPiArCj4gPiArc3RhdGljIGludCBlcGZfdm5ldF9wcm9iZShzdHJ1Y3QgcGNpX2VwZiAqZXBm
KQo+ID4gK3sKPiA+ICsgICAgIHN0cnVjdCBlcGZfdm5ldCAqdm5ldDsKPiA+ICsKPiA+ICsgICAg
IHZuZXQgPSBkZXZtX2t6YWxsb2MoJmVwZi0+ZGV2LCBzaXplb2YoKnZuZXQpLCBHRlBfS0VSTkVM
KTsKPiA+ICsgICAgIGlmICghdm5ldCkKPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07
Cj4gPiArCj4gPiArICAgICBlcGZfc2V0X2RydmRhdGEoZXBmLCB2bmV0KTsKPiA+ICsgICAgIHZu
ZXQtPmVwZiA9IGVwZjsKPiA+ICsKPiA+ICsgICAgIGVwZl92bmV0X3ZpcnRpb19pbml0KHZuZXQp
Owo+ID4gKwo+ID4gKyAgICAgcmV0dXJuIDA7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBzdHJ1
Y3QgcGNpX2VwZl9kcml2ZXIgZXBmX3ZuZXRfZHJ2ID0gewo+ID4gKyAgICAgLmRyaXZlci5uYW1l
ID0gInBjaV9lcGZfdm5ldCIsCj4gPiArICAgICAub3BzID0gJmVwZl92bmV0X29wcywKPiA+ICsg
ICAgIC5pZF90YWJsZSA9IGVwZl92bmV0X2lkcywKPiA+ICsgICAgIC5wcm9iZSA9IGVwZl92bmV0
X3Byb2JlLAo+ID4gKyAgICAgLm93bmVyID0gVEhJU19NT0RVTEUsCj4gPiArfTsKPiA+ICsKPiA+
ICtzdGF0aWMgaW50IF9faW5pdCBlcGZfdm5ldF9pbml0KHZvaWQpCj4gPiArewo+ID4gKyAgICAg
aW50IGVycjsKPiA+ICsKPiA+ICsgICAgIGVyciA9IHBjaV9lcGZfcmVnaXN0ZXJfZHJpdmVyKCZl
cGZfdm5ldF9kcnYpOwo+ID4gKyAgICAgaWYgKGVycikgewo+ID4gKyAgICAgICAgICAgICBwcl9l
cnIoIkZhaWxlZCB0byByZWdpc3RlciBlcGYgdm5ldCBkcml2ZXJcbiIpOwo+ID4gKyAgICAgICAg
ICAgICByZXR1cm4gZXJyOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgcmV0dXJuIDA7Cj4g
PiArfQo+ID4gK21vZHVsZV9pbml0KGVwZl92bmV0X2luaXQpOwo+ID4gKwo+ID4gK3N0YXRpYyB2
b2lkIGVwZl92bmV0X2V4aXQodm9pZCkKPiA+ICt7Cj4gPiArICAgICBwY2lfZXBmX3VucmVnaXN0
ZXJfZHJpdmVyKCZlcGZfdm5ldF9kcnYpOwo+ID4gK30KPiA+ICttb2R1bGVfZXhpdChlcGZfdm5l
dF9leGl0KTsKPiA+ICsKPiA+ICtNT0RVTEVfTElDRU5TRSgiR1BMIik7Cj4gPiArTU9EVUxFX0FV
VEhPUigiU2h1bnN1a2UgTWllIDxtaWVAaWdlbC5jby5qcD4iKTsKPiA+ICtNT0RVTEVfREVTQ1JJ
UFRJT04oIlBDSSBlbmRwb2ludCBmdW5jdGlvbiBhY3RzIGFzIHZpcnRpbyBuZXQgZGV2aWNlIik7
Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9wY2kvZW5kcG9pbnQvZnVuY3Rpb25zL3BjaS1lcGYt
dm5ldC5oIGIvZHJpdmVycy9wY2kvZW5kcG9pbnQvZnVuY3Rpb25zL3BjaS1lcGYtdm5ldC5oCj4g
PiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+ID4gaW5kZXggMDAwMDAwMDAwMDAwLi4xZTBmOTBjOTU1
NzgKPiA+IC0tLSAvZGV2L251bGwKPiA+ICsrKyBiL2RyaXZlcnMvcGNpL2VuZHBvaW50L2Z1bmN0
aW9ucy9wY2ktZXBmLXZuZXQuaAo+ID4gQEAgLTAsMCArMSw2MiBAQAo+ID4gKy8qIFNQRFgtTGlj
ZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCj4gPiArI2lmbmRlZiBfUENJX0VQRl9WTkVUX0gK
PiA+ICsjZGVmaW5lIF9QQ0lfRVBGX1ZORVRfSAo+ID4gKwo+ID4gKyNpbmNsdWRlIDxsaW51eC9w
Y2ktZXBmLmg+Cj4gPiArI2luY2x1ZGUgPGxpbnV4L3BjaS1lcGYtdmlydGlvLmg+Cj4gPiArI2lu
Y2x1ZGUgPGxpbnV4L3ZpcnRpb19uZXQuaD4KPiA+ICsjaW5jbHVkZSA8bGludXgvZG1hZW5naW5l
Lmg+Cj4gPiArI2luY2x1ZGUgPGxpbnV4L3ZpcnRpby5oPgo+ID4gKwo+ID4gK3N0cnVjdCBlcGZf
dm5ldCB7Cj4gPiArICAgICAvL1RPRE8gU2hvdWxkIHRoaXMgdmFyaWFibGUgYmUgcGxhY2VkIGhl
cmU/Cj4gPiArICAgICBzdHJ1Y3QgcGNpX2VwZiAqZXBmOwo+ID4gKyAgICAgc3RydWN0IHZpcnRp
b19uZXRfY29uZmlnIHZuZXRfY2ZnOwo+ID4gKyAgICAgdTY0IHZpcnRpb19mZWF0dXJlczsKPiA+
ICsKPiA+ICsgICAgIC8vIGRtYSBjaGFubmVscyBmb3IgbG9jYWwgdG8gcmVtb3RlKGxyKSBhbmQg
cmVtb3RlIHRvIGxvY2FsKHJsKQo+ID4gKyAgICAgc3RydWN0IGRtYV9jaGFuICpscl9kbWFfY2hh
biwgKnJsX2RtYV9jaGFuOwo+ID4gKwo+ID4gKyAgICAgc3RydWN0IHsKPiA+ICsgICAgICAgICAg
ICAgdm9pZCBfX2lvbWVtICpjZmdfYmFzZTsKPiA+ICsgICAgICAgICAgICAgc3RydWN0IHRhc2tf
c3RydWN0ICpkZXZpY2Vfc2V0dXBfdGFzazsKPiA+ICsgICAgICAgICAgICAgc3RydWN0IHRhc2tf
c3RydWN0ICpub3RpZnlfbW9uaXRvcl90YXNrOwo+ID4gKyAgICAgICAgICAgICBzdHJ1Y3Qgd29y
a3F1ZXVlX3N0cnVjdCAqdHhfd3EsICppcnFfd3EsICpjdGxfd3E7Cj4gPiArICAgICAgICAgICAg
IHN0cnVjdCB3b3JrX3N0cnVjdCB0eF93b3JrLCByYWlzZV9pcnFfd29yaywgY3RsX3dvcms7Cj4g
PiArICAgICAgICAgICAgIHN0cnVjdCBwY2lfZXBmX3ZyaW5naCAqdHh2cmgsICpyeHZyaCwgKmN0
bHZyaDsKPiA+ICsgICAgICAgICAgICAgc3RydWN0IHZyaW5naF9raW92IHR4X2lvdiwgcnhfaW92
LCBjdGxfcmlvdiwgY3RsX3dpb3Y7Cj4gPiArICAgICB9IHJjOwo+ID4gKwo+ID4gKyAgICAgc3Ry
dWN0IHsKPiA+ICsgICAgICAgICAgICAgc3RydWN0IHZpcnRxdWV1ZSAqcnh2cSwgKnR4dnEsICpj
dGx2cTsKPiA+ICsgICAgICAgICAgICAgc3RydWN0IHZyaW5naCB0eHZyaCwgcnh2cmgsIGN0bHZy
aDsKPiA+ICsgICAgICAgICAgICAgc3RydWN0IHZyaW5naF9raW92IHR4X2lvdiwgcnhfaW92LCBj
dGxfcmlvdiwgY3RsX3dpb3Y7Cj4gPiArICAgICAgICAgICAgIHN0cnVjdCB2aXJ0aW9fZGV2aWNl
IHZkZXY7Cj4gPiArICAgICAgICAgICAgIHUxNiBuZXRfY29uZmlnX3N0YXR1czsKPiA+ICsgICAg
IH0gZXA7Cj4gPiArCj4gPiArI2RlZmluZSBFUEZfVk5FVF9JTklUX0NPTVBMRVRFX0VQIEJJVCgw
KQo+ID4gKyNkZWZpbmUgRVBGX1ZORVRfSU5JVF9DT01QTEVURV9SQyBCSVQoMSkKPiA+ICsgICAg
IHU4IGluaXRfY29tcGxldGU7Cj4gPiArfTsKPiA+ICsKPiA+ICtpbnQgZXBmX3ZuZXRfcmNfc2V0
dXAoc3RydWN0IGVwZl92bmV0ICp2bmV0KTsKPiA+ICt2b2lkIGVwZl92bmV0X3JjX2NsZWFudXAo
c3RydWN0IGVwZl92bmV0ICp2bmV0KTsKPiA+ICtpbnQgZXBmX3ZuZXRfZXBfc2V0dXAoc3RydWN0
IGVwZl92bmV0ICp2bmV0KTsKPiA+ICt2b2lkIGVwZl92bmV0X2VwX2NsZWFudXAoc3RydWN0IGVw
Zl92bmV0ICp2bmV0KTsKPiA+ICsKPiA+ICtpbnQgZXBmX3ZuZXRfZ2V0X3ZxX3NpemUodm9pZCk7
Cj4gPiAraW50IGVwZl92bmV0X2luaXRfa2lvdihzdHJ1Y3QgdnJpbmdoX2tpb3YgKmtpb3YsIGNv
bnN0IHNpemVfdCB2cV9zaXplKTsKPiA+ICt2b2lkIGVwZl92bmV0X2RlaW5pdF9raW92KHN0cnVj
dCB2cmluZ2hfa2lvdiAqa2lvdik7Cj4gPiAraW50IGVwZl92bmV0X3RyYW5zZmVyKHN0cnVjdCBl
cGZfdm5ldCAqdm5ldCwgc3RydWN0IHZyaW5naCAqdHhfdnJoLAo+ID4gKyAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgdnJpbmdoICpyeF92cmgsIHN0cnVjdCB2cmluZ2hfa2lvdiAqdHhfaW92LAo+
ID4gKyAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdnJpbmdoX2tpb3YgKnJ4X2lvdiwKPiA+ICsg
ICAgICAgICAgICAgICAgICAgZW51bSBkbWFfdHJhbnNmZXJfZGlyZWN0aW9uIGRpcik7Cj4gPiAr
dm9pZCBlcGZfdm5ldF9yY19ub3RpZnkoc3RydWN0IGVwZl92bmV0ICp2bmV0KTsKPiA+ICt2b2lk
IGVwZl92bmV0X2VwX25vdGlmeShzdHJ1Y3QgZXBmX3ZuZXQgKnZuZXQsIHN0cnVjdCB2aXJ0cXVl
dWUgKnZxKTsKPiA+ICsKPiA+ICt2b2lkIGVwZl92bmV0X2luaXRfY29tcGxldGUoc3RydWN0IGVw
Zl92bmV0ICp2bmV0LCB1OCBmcm9tKTsKPiA+ICt2b2lkIGVwZl92bmV0X2VwX2Fubm91bmNlX2xp
bmt1cChzdHJ1Y3QgZXBmX3ZuZXQgKnZuZXQpOwo+ID4gK3ZvaWQgZXBmX3ZuZXRfcmNfYW5ub3Vu
Y2VfbGlua3VwKHN0cnVjdCBlcGZfdm5ldCAqdm5ldCk7Cj4gPiArCj4gPiArI2VuZGlmIC8vIF9Q
Q0lfRVBGX1ZORVRfSAo+ID4gLS0KPiA+IDIuMjUuMQo+CkJlc3QsClNodW5zdWtlCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClZpcnR1YWxpemF0aW9uIG1h
aWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRw
czovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcvbWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXph
dGlvbg==
