Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
	by mail.lfdr.de (Postfix) with ESMTPS id 1937E19794A
	for <lists.virtualization@lfdr.de>; Mon, 30 Mar 2020 12:29:55 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by whitealder.osuosl.org (Postfix) with ESMTP id B20AB87C7E;
	Mon, 30 Mar 2020 10:29:53 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id qOyFZILWBL6h; Mon, 30 Mar 2020 10:29:53 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by whitealder.osuosl.org (Postfix) with ESMTP id DC9CE87C5F;
	Mon, 30 Mar 2020 10:29:51 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id B8077C07FF;
	Mon, 30 Mar 2020 10:29:51 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 08D8FC1D7E
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:29:50 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by silver.osuosl.org (Postfix) with ESMTP id EC47722DDB
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:29:49 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id bVvU7b9ICir0
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:29:49 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by silver.osuosl.org (Postfix) with ESMTPS id 9B5C8227F7
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:29:48 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 D69333031EBF; Mon, 30 Mar 2020 13:12:59 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 8C138305B7A0;
 Mon, 30 Mar 2020 13:12:59 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v8 66/81] KVM: introspection: add KVMI_VM_GET_MAX_GFN
Date: Mon, 30 Mar 2020 13:12:53 +0300
Message-Id: <20200330101308.21702-67-alazar@bitdefender.com>
In-Reply-To: <20200330101308.21702-1-alazar@bitdefender.com>
References: <20200330101308.21702-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <ncitu@bitdefender.com>,
 =?UTF-8?q?=C8=98tefan=20=C8=98icleru?= <ssicleru@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogyJh0ZWZhbiDImGljbGVydSA8c3NpY2xlcnVAYml0ZGVmZW5kZXIuY29tPgoKVGhlIGlu
dHJvc3BlY3Rpb24gdG9vbCB3aWxsIHVzZSB0aGlzIGNvbW1hbmQgdG8gZ2V0IHRoZSBhZGRyZXNz
IHJhbmdlCmZvciB3aGljaCBpdCBjYW4gc2V0IGFjY2VzcyByZXN0cmljdGlvbnMuCgpTaWduZWQt
b2ZmLWJ5OiDImHRlZmFuIMiYaWNsZXJ1IDxzc2ljbGVydUBiaXRkZWZlbmRlci5jb20+CkNvLWRl
dmVsb3BlZC1ieTogTmljdciZb3IgQ8OuyJt1IDxuY2l0dUBiaXRkZWZlbmRlci5jb20+ClNpZ25l
ZC1vZmYtYnk6IE5pY3XImW9yIEPDrsibdSA8bmNpdHVAYml0ZGVmZW5kZXIuY29tPgpTaWduZWQt
b2ZmLWJ5OiBBZGFsYmVydCBMYXrEg3IgPGFsYXphckBiaXRkZWZlbmRlci5jb20+Ci0tLQogRG9j
dW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdCAgICAgICAgICAgICAgIHwgMjAgKysrKysrKysr
KysrKysrKysrKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCAgICAgICAgICAgICAgICAgICAg
IHwgIDYgKysrKysrCiAuLi4vdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3Qu
YyAgfCAxMiArKysrKysrKysrKwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jICAg
ICAgICAgICAgIHwgMTQgKysrKysrKysrKysrKwogNCBmaWxlcyBjaGFuZ2VkLCA1MiBpbnNlcnRp
b25zKCspCgpkaWZmIC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdCBiL0Rv
Y3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKaW5kZXggZDZhMDlmYWM0ZjUyLi4xYzVlMjU2
OTc1ZmUgMTAwNjQ0Ci0tLSBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKKysrIGIv
RG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdApAQCAtNzU2LDYgKzc1NiwyNiBAQCBUaGUg
KktWTUlfRVZFTlRfVFJBUCogZXZlbnQgd2lsbCBiZSBzZW50IHdpdGggdGhlIGVmZmVjdGl2ZSBp
bmplY3RlZCBleHBlY3Rpb24uCiAqIC1LVk1fRUJVU1kgLSBhbm90aGVyICpLVk1JX1ZDUFVfSU5K
RUNUX0VYQ0VQVElPTiotKktWTUlfRVZFTlRfVFJBUCogcGFpcgogICAgICAgICAgICAgICAgaXMg
aW4gcHJvZ3Jlc3MKIAorMTYuIEtWTUlfVk1fR0VUX01BWF9HRk4KKy0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCisKKzpBcmNoaXRlY3R1cmU6IGFsbAorOlZlcnNpb25zOiA+PSAxCis6UGFyYW1ldGVy
czogbm9uZQorOlJldHVybnM6CisKKzo6CisKKyAgICAgICAgc3RydWN0IGt2bWlfZXJyb3JfY29k
ZTsKKyAgICAgICAgc3RydWN0IGt2bWlfdm1fZ2V0X21heF9nZm5fcmVwbHkgeworICAgICAgICAg
ICAgICAgIF9fdTY0IGdmbjsKKyAgICAgICAgfTsKKworUHJvdmlkZXMgdGhlIG1heGltdW0gR0ZO
IGFsbG9jYXRlZCB0byB0aGUgVk0gYnkgd2Fsa2luZyB0aHJvdWdoIGFsbAorbWVtb3J5IHNsb3Rz
IGFsbG9jYXRlZCBieSBLVk0sIGNvbnNpZGVyaW5nIGFsbCBhZGRyZXNzIHNwYWNlcyBpbmRpY2F0
ZWQKK2J5IEtWTV9BRERSRVNTX1NQQUNFX05VTS4gU3RyaWNseSBzcGVha2luZywgdGhlIHJldHVy
bmVkIHZhbHVlIHJlZmVycwordG8gdGhlIGZpcnN0IGluYWNjZXNzaWJsZSBHRk4sIG5leHQgdG8g
dGhlIG1heGltdW0gYWNjZXNzaWJsZSBHRk4uCisKIEV2ZW50cwogPT09PT09CiAKZGlmZiAtLWdp
dCBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmggYi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5o
CmluZGV4IDI2MDNmYTcyMTU0Yi4uZDMzZThkYWUwMDg0IDEwMDY0NAotLS0gYS9pbmNsdWRlL3Vh
cGkvbGludXgva3ZtaS5oCisrKyBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKQEAgLTM0LDYg
KzM0LDggQEAgZW51bSB7CiAJS1ZNSV9WQ1BVX0NPTlRST0xfQ1IgICAgICAgPSAxNSwKIAlLVk1J
X1ZDUFVfSU5KRUNUX0VYQ0VQVElPTiA9IDE2LAogCisJS1ZNSV9WTV9HRVRfTUFYX0dGTiA9IDE3
LAorCiAJS1ZNSV9OVU1fTUVTU0FHRVMKIH07CiAKQEAgLTE0MCw2ICsxNDIsMTAgQEAgc3RydWN0
IGt2bWlfdmNwdV9jb250cm9sX2V2ZW50cyB7CiAJX191MzIgcGFkZGluZzI7CiB9OwogCitzdHJ1
Y3Qga3ZtaV92bV9nZXRfbWF4X2dmbl9yZXBseSB7CisJX191NjQgZ2ZuOworfTsKKwogc3RydWN0
IGt2bWlfZXZlbnQgewogCV9fdTE2IHNpemU7CiAJX191MTYgdmNwdTsKZGlmZiAtLWdpdCBhL3Rv
b2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMgYi90b29scy90ZXN0
aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCmluZGV4IDZhNmFkNzM2ZGIzNi4u
NjY3NjZkMTEyMDA2IDEwMDY0NAotLS0gYS90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2
XzY0L2t2bWlfdGVzdC5jCisrKyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQv
a3ZtaV90ZXN0LmMKQEAgLTEyMzIsNiArMTIzMiwxNyBAQCBzdGF0aWMgdm9pZCB0ZXN0X2NtZF92
Y3B1X2luamVjdF9leGNlcHRpb24oc3RydWN0IGt2bV92bSAqdm0pCiAJZGlzYWJsZV92Y3B1X2V2
ZW50KHZtLCBLVk1JX0VWRU5UX0JSRUFLUE9JTlQpOwogfQogCitzdGF0aWMgdm9pZCB0ZXN0X2Nt
ZF92bV9nZXRfbWF4X2dmbih2b2lkKQoreworCXN0cnVjdCBrdm1pX3ZtX2dldF9tYXhfZ2ZuX3Jl
cGx5IHJwbDsKKwlzdHJ1Y3Qga3ZtaV9tc2dfaGRyIHJlcTsKKworCXRlc3Rfdm1fY29tbWFuZChL
Vk1JX1ZNX0dFVF9NQVhfR0ZOLCAmcmVxLCBzaXplb2YocmVxKSwKKwkJCSZycGwsIHNpemVvZihy
cGwpKTsKKworCURFQlVHKCJtYXhfZ2ZuOiAweCVsbHhcbiIsIHJwbC5nZm4pOworfQorCiBzdGF0
aWMgdm9pZCB0ZXN0X2ludHJvc3BlY3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCiB7CiAJc3JhbmRv
bSh0aW1lKDApKTsKQEAgLTEyNTYsNiArMTI2Nyw3IEBAIHN0YXRpYyB2b2lkIHRlc3RfaW50cm9z
cGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkKIAl0ZXN0X2V2ZW50X2JyZWFrcG9pbnQodm0pOwog
CXRlc3RfY21kX3ZjcHVfY29udHJvbF9jcih2bSk7CiAJdGVzdF9jbWRfdmNwdV9pbmplY3RfZXhj
ZXB0aW9uKHZtKTsKKwl0ZXN0X2NtZF92bV9nZXRfbWF4X2dmbigpOwogCiAJdW5ob29rX2ludHJv
c3BlY3Rpb24odm0pOwogfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1p
X21zZy5jIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCmluZGV4IDgzMDQzMDc3
NzU1Ni4uOGFlNTdjODcyNTZmIDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2
bWlfbXNnLmMKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCkBAIC0yNiw2
ICsyNiw3IEBAIHN0YXRpYyBjb25zdCBjaGFyICpjb25zdCBtc2dfSURzW10gPSB7CiAJW0tWTUlf
Vk1fQ0hFQ0tfRVZFTlRdICAgICAgICA9ICJLVk1JX1ZNX0NIRUNLX0VWRU5UIiwKIAlbS1ZNSV9W
TV9DT05UUk9MX0VWRU5UU10gICAgID0gIktWTUlfVk1fQ09OVFJPTF9FVkVOVFMiLAogCVtLVk1J
X1ZNX0dFVF9JTkZPXSAgICAgICAgICAgPSAiS1ZNSV9WTV9HRVRfSU5GTyIsCisJW0tWTUlfVk1f
R0VUX01BWF9HRk5dICAgICAgICA9ICJLVk1JX1ZNX0dFVF9NQVhfR0ZOIiwKIAlbS1ZNSV9WTV9S
RUFEX1BIWVNJQ0FMXSAgICAgID0gIktWTUlfVk1fUkVBRF9QSFlTSUNBTCIsCiAJW0tWTUlfVk1f
V1JJVEVfUEhZU0lDQUxdICAgICA9ICJLVk1JX1ZNX1dSSVRFX1BIWVNJQ0FMIiwKIAlbS1ZNSV9W
Q1BVX0NPTlRST0xfQ1JdICAgICAgID0gIktWTUlfVkNQVV9DT05UUk9MX0NSIiwKQEAgLTM0OCw2
ICszNDksMTggQEAgc3RhdGljIGludCBoYW5kbGVfcGF1c2VfdmNwdShzdHJ1Y3Qga3ZtX2ludHJv
c3BlY3Rpb24gKmt2bWksCiAJcmV0dXJuIGt2bWlfbXNnX3ZtX3JlcGx5KGt2bWksIG1zZywgZXJy
LCBOVUxMLCAwKTsKIH0KIAorc3RhdGljIGludCBoYW5kbGVfdm1fZ2V0X21heF9nZm4oc3RydWN0
IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pLAorCQkJCSBjb25zdCBzdHJ1Y3Qga3ZtaV9tc2dfaGRy
ICptc2csCisJCQkJIGNvbnN0IHZvaWQgKnJlcSkKK3sKKwlzdHJ1Y3Qga3ZtaV92bV9nZXRfbWF4
X2dmbl9yZXBseSBycGw7CisKKwltZW1zZXQoJnJwbCwgMCwgc2l6ZW9mKHJwbCkpOworCXJwbC5n
Zm4gPSBrdm1fZ2V0X21heF9nZm4oa3ZtaS0+a3ZtKTsKKworCXJldHVybiBrdm1pX21zZ192bV9y
ZXBseShrdm1pLCBtc2csIDAsICZycGwsIHNpemVvZihycGwpKTsKK30KKwogLyoKICAqIFRoZXNl
IGNvbW1hbmRzIGFyZSBleGVjdXRlZCBieSB0aGUgcmVjZWl2aW5nIHRocmVhZC93b3JrZXIuCiAg
Ki8KQEAgLTM1OCw2ICszNzEsNyBAQCBzdGF0aWMgaW50KCpjb25zdCBtc2dfdm1bXSkoc3RydWN0
IGt2bV9pbnRyb3NwZWN0aW9uICosCiAJW0tWTUlfVk1fQ0hFQ0tfRVZFTlRdICAgID0gaGFuZGxl
X2NoZWNrX2V2ZW50LAogCVtLVk1JX1ZNX0NPTlRST0xfRVZFTlRTXSA9IGhhbmRsZV92bV9jb250
cm9sX2V2ZW50cywKIAlbS1ZNSV9WTV9HRVRfSU5GT10gICAgICAgPSBoYW5kbGVfZ2V0X2luZm8s
CisJW0tWTUlfVk1fR0VUX01BWF9HRk5dICAgID0gaGFuZGxlX3ZtX2dldF9tYXhfZ2ZuLAogCVtL
Vk1JX1ZNX1JFQURfUEhZU0lDQUxdICA9IGhhbmRsZV9yZWFkX3BoeXNpY2FsLAogCVtLVk1JX1ZN
X1dSSVRFX1BIWVNJQ0FMXSA9IGhhbmRsZV93cml0ZV9waHlzaWNhbCwKIAlbS1ZNSV9WQ1BVX1BB
VVNFXSAgICAgICAgPSBoYW5kbGVfcGF1c2VfdmNwdSwKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1
YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhm
b3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
