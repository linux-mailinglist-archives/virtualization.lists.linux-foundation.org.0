Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 1B678228B3C
	for <lists.virtualization@lfdr.de>; Tue, 21 Jul 2020 23:26:29 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id BF59186C20;
	Tue, 21 Jul 2020 21:26:27 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 1FJ5spl0buB1; Tue, 21 Jul 2020 21:26:25 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 7E44886C26;
	Tue, 21 Jul 2020 21:26:25 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 470C1C016F;
	Tue, 21 Jul 2020 21:26:25 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id CCBDAC08A2
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:26:20 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by silver.osuosl.org (Postfix) with ESMTP id A3DBA226DB
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:26:20 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id j2bjhBcfJ7EB
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:26:05 +0000 (UTC)
X-Greylist: from auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by silver.osuosl.org (Postfix) with ESMTPS id EC51D227A0
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:25:56 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 A8B9B305D4F4; Wed, 22 Jul 2020 00:09:28 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.27])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 7F5BD304FA12;
 Wed, 22 Jul 2020 00:09:28 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v9 60/84] KVM: introspection: add KVMI_EVENT_BREAKPOINT
Date: Wed, 22 Jul 2020 00:08:58 +0300
Message-Id: <20200721210922.7646-61-alazar@bitdefender.com>
In-Reply-To: <20200721210922.7646-1-alazar@bitdefender.com>
References: <20200721210922.7646-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <ncitu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBldmVudCBp
cyBzZW50IHdoZW4gYSBicmVha3BvaW50IHdhcyByZWFjaGVkLgoKVGhlIGludHJvc3BlY3Rpb24g
dG9vbCBjYW4gcGxhY2UgYnJlYWtwb2ludHMgYW5kIHVzZSB0aGVtIGFzIG5vdGlmaWNhdGlvbgpm
b3Igd2hlbiB0aGUgT1Mgb3IgYW4gYXBwbGljYXRpb24gaGFzIHJlYWNoZWQgYSBjZXJ0YWluIHN0
YXRlIG9yIGlzCnRyeWluZyB0byBwZXJmb3JtIGEgY2VydGFpbiBvcGVyYXRpb24gKGVnLiBjcmVh
dGUgYSBwcm9jZXNzKS4KClNpZ25lZC1vZmYtYnk6IE1paGFpIERvbsibdSA8bWRvbnR1QGJpdGRl
ZmVuZGVyLmNvbT4KQ28tZGV2ZWxvcGVkLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5jaXR1QGJpdGRl
ZmVuZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogTmljdciZb3IgQ8OuyJt1IDxuY2l0dUBiaXRkZWZl
bmRlci5jb20+CkNvLWRldmVsb3BlZC1ieTogQWRhbGJlcnQgTGF6xINyIDxhbGF6YXJAYml0ZGVm
ZW5kZXIuY29tPgpTaWduZWQtb2ZmLWJ5OiBBZGFsYmVydCBMYXrEg3IgPGFsYXphckBiaXRkZWZl
bmRlci5jb20+Ci0tLQogRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdCAgICAgICAgICAg
ICAgIHwgNDAgKysrKysrKysrKysrKysrKwogYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1p
LmggICAgICAgICAgICAgIHwgIDYgKysrCiBhcmNoL3g4Ni9rdm0va3ZtaS5jICAgICAgICAgICAg
ICAgICAgICAgICAgICAgfCA0OCArKysrKysrKysrKysrKysrKysrCiBhcmNoL3g4Ni9rdm0vc3Zt
L3N2bS5jICAgICAgICAgICAgICAgICAgICAgICAgfCAzNCArKysrKysrKysrKysrCiBhcmNoL3g4
Ni9rdm0vdm14L3ZteC5jICAgICAgICAgICAgICAgICAgICAgICAgfCAxNyArKysrKy0tCiBpbmNs
dWRlL2xpbnV4L2t2bWlfaG9zdC5oICAgICAgICAgICAgICAgICAgICAgfCAgNCArKwogaW5jbHVk
ZS91YXBpL2xpbnV4L2t2bWkuaCAgICAgICAgICAgICAgICAgICAgIHwgIDEgKwogLi4uL3Rlc3Rp
bmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMgIHwgNDYgKysrKysrKysrKysrKysr
KysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyAgICAgICAgICAgICAgICAgfCAyMyAr
KysrKysrKy0KIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCAgICAgICAgICAgICB8
ICA0ICsrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgICAgICAgICAgICAgfCAx
NyArKysrKysrCiAxMSBmaWxlcyBjaGFuZ2VkLCAyMzUgaW5zZXJ0aW9ucygrKSwgNSBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0IGIvRG9j
dW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdAppbmRleCBkMDYyZjJjY2YzNjUuLjExMGE2ZTdh
N2QyYSAxMDA2NDQKLS0tIGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdAorKysgYi9E
b2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CkBAIC01NDksNiArNTQ5LDcgQEAgY29tbWFu
ZCkgYmVmb3JlIHJldHVybmluZyB0byBndWVzdC4KIEVuYWJsZXMvZGlzYWJsZXMgdkNQVSBpbnRy
b3NwZWN0aW9uIGV2ZW50cy4gVGhpcyBjb21tYW5kIGNhbiBiZSB1c2VkIHdpdGgKIHRoZSBmb2xs
b3dpbmcgZXZlbnRzOjoKIAorCUtWTUlfRVZFTlRfQlJFQUtQT0lOVAogCUtWTUlfRVZFTlRfSFlQ
RVJDQUxMCiAKIFdoZW4gYW4gZXZlbnQgaXMgZW5hYmxlZCwgdGhlIGludHJvc3BlY3Rpb24gdG9v
bCBpcyBub3RpZmllZCBhbmQKQEAgLTU3MCw2ICs1NzEsOSBAQCB0aGUgKktWTUlfVk1fQ09OVFJP
TF9FVkVOVFMqIGNvbW1hbmQuCiAqIC1LVk1fRUlOVkFMIC0gdGhlIGV2ZW50IElEIGlzIHVua25v
d24gKHVzZSAqS1ZNSV9WTV9DSEVDS19FVkVOVCogZmlyc3QpCiAqIC1LVk1fRVBFUk0gLSB0aGUg
YWNjZXNzIGlzIGRpc2FsbG93ZWQgKHVzZSAqS1ZNSV9WTV9DSEVDS19FVkVOVCogZmlyc3QpCiAq
IC1LVk1fRUFHQUlOIC0gdGhlIHNlbGVjdGVkIHZDUFUgY2FuJ3QgYmUgaW50cm9zcGVjdGVkIHll
dAorKiAtS1ZNX0VCVVNZIC0gdGhlIGV2ZW50IGNhbid0IGJlIGludGVyY2VwdGVkIHJpZ2h0IG5v
dworICAgICAgICAgICAgICAgKGUuZy4gS1ZNSV9FVkVOVF9CUkVBS1BPSU5UIGlmIHRoZSAjQlAg
ZXZlbnQgaXMgYWxyZWFkeSBpbnRlcmNlcHRlZAorICAgICAgICAgICAgICAgIGJ5IHVzZXJzcGFj
ZSkKIAogMTEuIEtWTUlfVkNQVV9HRVRfUkVHSVNURVJTCiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0KQEAgLTgyMCwzICs4MjQsMzkgQEAgSXQgaXMgdXNlZCBieSB0aGUgY29kZSByZXNpZGlu
ZyBpbnNpZGUgdGhlIGludHJvc3BlY3RlZCBndWVzdCB0byBjYWxsIHRoZQogaW50cm9zcGVjdGlv
biB0b29sIGFuZCB0byByZXBvcnQgY2VydGFpbiBkZXRhaWxzIGFib3V0IGl0cyBvcGVyYXRpb24u
IEZvcgogZXhhbXBsZSwgYSBjbGFzc2ljIGFudGltYWx3YXJlIHJlbWVkaWF0aW9uIHRvb2wgY2Fu
IHJlcG9ydCB3aGF0IGl0IGhhcwogZm91bmQgZHVyaW5nIGEgc2Nhbi4KKworNC4gS1ZNSV9FVkVO
VF9CUkVBS1BPSU5UCistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKworOkFyY2hpdGVjdHVyZXM6
IHg4NgorOlZlcnNpb25zOiA+PSAxCis6QWN0aW9uczogQ09OVElOVUUsIENSQVNILCBSRVRSWQor
OlBhcmFtZXRlcnM6CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV9ldmVudDsKKwlzdHJ1Y3Qga3ZtaV9l
dmVudF9icmVha3BvaW50IHsKKwkJX191NjQgZ3BhOworCQlfX3U4IGluc25fbGVuOworCQlfX3U4
IHBhZGRpbmdbN107CisJfTsKKworOlJldHVybnM6CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV92Y3B1
X2hkcjsKKwlzdHJ1Y3Qga3ZtaV9ldmVudF9yZXBseTsKKworVGhpcyBldmVudCBpcyBzZW50IHdo
ZW4gYSBicmVha3BvaW50IHdhcyByZWFjaGVkIGFuZCB0aGUgaW50cm9zcGVjdGlvbiBoYXMKK2Jl
ZW4gZW5hYmxlZCBmb3IgdGhpcyBldmVudCAoc2VlICpLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMq
KS4KKworU29tZSBvZiB0aGVzZSBicmVha3BvaW50cyBjb3VsZCBoYXZlIGJlZW4gaW5qZWN0ZWQg
YnkgdGhlIGludHJvc3BlY3Rpb24gdG9vbCwKK3BsYWNlZCBpbiB0aGUgc2xhY2sgc3BhY2Ugb2Yg
dmFyaW91cyBmdW5jdGlvbnMgYW5kIHVzZWQgYXMgbm90aWZpY2F0aW9uCitmb3Igd2hlbiB0aGUg
T1Mgb3IgYW4gYXBwbGljYXRpb24gaGFzIHJlYWNoZWQgYSBjZXJ0YWluIHN0YXRlIG9yIGlzCit0
cnlpbmcgdG8gcGVyZm9ybSBhIGNlcnRhaW4gb3BlcmF0aW9uIChsaWtlIGNyZWF0aW5nIGEgcHJv
Y2VzcykuCisKK2Bga3ZtaV9ldmVudGBgIGFuZCB0aGUgZ3Vlc3QgcGh5c2ljYWwgYWRkcmVzcyBh
cmUgc2VudCB0byB0aGUgaW50cm9zcGVjdGlvbiB0b29sLgorCitUaGUgKlJFVFJZKiBhY3Rpb24g
aXMgdXNlZCBieSB0aGUgaW50cm9zcGVjdGlvbiB0b29sIGZvciBpdHMgb3duIGJyZWFrcG9pbnRz
LgpkaWZmIC0tZ2l0IGEvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmggYi9hcmNoL3g4
Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaAppbmRleCA5ODgyZTY4Y2FiNzUuLjE2MDU3NzcyNTZh
MyAxMDA2NDQKLS0tIGEvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmgKKysrIGIvYXJj
aC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmgKQEAgLTU5LDQgKzU5LDEwIEBAIHN0cnVjdCBr
dm1pX3ZjcHVfZ2V0X2NwdWlkX3JlcGx5IHsKIAlfX3UzMiBlZHg7CiB9OwogCitzdHJ1Y3Qga3Zt
aV9ldmVudF9icmVha3BvaW50IHsKKwlfX3U2NCBncGE7CisJX191OCBpbnNuX2xlbjsKKwlfX3U4
IHBhZGRpbmdbN107Cit9OworCiAjZW5kaWYgLyogX1VBUElfQVNNX1g4Nl9LVk1JX0ggKi8KZGlm
ZiAtLWdpdCBhL2FyY2gveDg2L2t2bS9rdm1pLmMgYi9hcmNoL3g4Ni9rdm0va3ZtaS5jCmluZGV4
IDQ1ZjFhNDVkNWMwZi4uZjEzMjcyMzUwYmM5IDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9rdm0va3Zt
aS5jCisrKyBiL2FyY2gveDg2L2t2bS9rdm1pLmMKQEAgLTI0MiwzICsyNDIsNTEgQEAgdm9pZCBr
dm1pX2FyY2hfaHlwZXJjYWxsX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKIAkJa3ZtaV9o
YW5kbGVfY29tbW9uX2V2ZW50X2FjdGlvbnModmNwdS0+a3ZtLCBhY3Rpb24pOwogCX0KIH0KKwor
c3RhdGljIGludCBrdm1pX2NvbnRyb2xfYnBfaW50ZXJjZXB0KHN0cnVjdCBrdm1fdmNwdSAqdmNw
dSwgYm9vbCBlbmFibGUpCit7CisJc3RydWN0IGt2bV9ndWVzdF9kZWJ1ZyBkYmcgPSB7fTsKKwlp
bnQgZXJyID0gMDsKKworCWlmIChlbmFibGUpCisJCWRiZy5jb250cm9sID0gS1ZNX0dVRVNUREJH
X0VOQUJMRSB8IEtWTV9HVUVTVERCR19VU0VfU1dfQlA7CisJZXJyID0ga3ZtX2FyY2hfdmNwdV9z
ZXRfZ3Vlc3RfZGVidWcodmNwdSwgJmRiZyk7CisKKwlyZXR1cm4gZXJyOworfQorCitpbnQga3Zt
aV9hcmNoX2NtZF9jb250cm9sX2ludGVyY2VwdChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCisJCQkJ
ICAgIHVuc2lnbmVkIGludCBldmVudF9pZCwgYm9vbCBlbmFibGUpCit7CisJaW50IGVyciA9IDA7
CisKKwlzd2l0Y2ggKGV2ZW50X2lkKSB7CisJY2FzZSBLVk1JX0VWRU5UX0JSRUFLUE9JTlQ6CisJ
CWVyciA9IGt2bWlfY29udHJvbF9icF9pbnRlcmNlcHQodmNwdSwgZW5hYmxlKTsKKwkJYnJlYWs7
CisJZGVmYXVsdDoKKwkJYnJlYWs7CisJfQorCisJcmV0dXJuIGVycjsKK30KKwordm9pZCBrdm1p
X2FyY2hfYnJlYWtwb2ludF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU2NCBndmEsIHU4
IGluc25fbGVuKQoreworCXUzMiBhY3Rpb247CisJdTY0IGdwYTsKKworCWdwYSA9IGt2bV9tbXVf
Z3ZhX3RvX2dwYV9zeXN0ZW0odmNwdSwgZ3ZhLCAwLCBOVUxMKTsKKworCWFjdGlvbiA9IGt2bWlf
bXNnX3NlbmRfYnAodmNwdSwgZ3BhLCBpbnNuX2xlbik7CisJc3dpdGNoIChhY3Rpb24pIHsKKwlj
YXNlIEtWTUlfRVZFTlRfQUNUSU9OX0NPTlRJTlVFOgorCQlrdm1fcXVldWVfZXhjZXB0aW9uKHZj
cHUsIEJQX1ZFQ1RPUik7CisJCWJyZWFrOworCWNhc2UgS1ZNSV9FVkVOVF9BQ1RJT05fUkVUUlk6
CisJCS8qIHJpcCB3YXMgbW9zdCBsaWtlbHkgYWRqdXN0ZWQgcGFzdCB0aGUgSU5UIDMgaW5zdHJ1
Y3Rpb24gKi8KKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJa3ZtaV9oYW5kbGVfY29tbW9uX2V2ZW50
X2FjdGlvbnModmNwdS0+a3ZtLCBhY3Rpb24pOworCX0KK30KZGlmZiAtLWdpdCBhL2FyY2gveDg2
L2t2bS9zdm0vc3ZtLmMgYi9hcmNoL3g4Ni9rdm0vc3ZtL3N2bS5jCmluZGV4IDU4MDk5NzcwMWIx
Yy4uNDdjNTBlMmYwZjg2IDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9rdm0vc3ZtL3N2bS5jCisrKyBi
L2FyY2gveDg2L2t2bS9zdm0vc3ZtLmMKQEAgLTI1LDYgKzI1LDcgQEAKICNpbmNsdWRlIDxsaW51
eC9wYWdlbWFwLmg+CiAjaW5jbHVkZSA8bGludXgvc3dhcC5oPgogI2luY2x1ZGUgPGxpbnV4L3J3
c2VtLmg+CisjaW5jbHVkZSA8bGludXgva3ZtaV9ob3N0Lmg+CiAKICNpbmNsdWRlIDxhc20vYXBp
Yy5oPgogI2luY2x1ZGUgPGFzbS9wZXJmX2V2ZW50Lmg+CkBAIC0xODQxLDEwICsxODQyLDQzIEBA
IHN0YXRpYyBpbnQgZGJfaW50ZXJjZXB0aW9uKHN0cnVjdCB2Y3B1X3N2bSAqc3ZtKQogCXJldHVy
biAxOwogfQogCitzdGF0aWMgdW5zaWduZWQgc3ZtX2dldF9pbnN0cnVjdGlvbl9sZW4oc3RydWN0
IGt2bV92Y3B1ICp2Y3B1KQoreworCXN0cnVjdCB2Y3B1X3N2bSAqc3ZtID0gdG9fc3ZtKHZjcHUp
OworCXVuc2lnbmVkIGxvbmcgcmlwID0ga3ZtX3JpcF9yZWFkKHZjcHUpOworCXVuc2lnbmVkIGxv
bmcgbmV4dF9yaXAgPSAwOworCXVuc2lnbmVkIGluc25fbGVuOworCisJaWYgKHN0YXRpY19jcHVf
aGFzKFg4Nl9GRUFUVVJFX05SSVBTKSkKKwkJbmV4dF9yaXAgPSBzdm0tPnZtY2ItPmNvbnRyb2wu
bmV4dF9yaXA7CisKKwlpZiAoIW5leHRfcmlwKSB7CisJCWlmICgha3ZtX2VtdWxhdGVfaW5zdHJ1
Y3Rpb24odmNwdSwgRU1VTFRZUEVfU0tJUCkpCisJCQlyZXR1cm4gMDsKKworCQluZXh0X3JpcCA9
IGt2bV9yaXBfcmVhZCh2Y3B1KTsKKwkJa3ZtX3JpcF93cml0ZSh2Y3B1LCByaXApOworCX0KKwor
CWluc25fbGVuID0gbmV4dF9yaXAgLSByaXA7CisJaWYgKGluc25fbGVuID4gTUFYX0lOU1RfU0la
RSkgeworCQlwcl9lcnIoIiVzOiBpcCAweCVseCBuZXh0IDB4JWx4XG4iLAorCQkgICAgICAgX19m
dW5jX18sIHJpcCwgbmV4dF9yaXApOworCQlyZXR1cm4gMDsKKwl9CisKKwlyZXR1cm4gaW5zbl9s
ZW47Cit9CisKIHN0YXRpYyBpbnQgYnBfaW50ZXJjZXB0aW9uKHN0cnVjdCB2Y3B1X3N2bSAqc3Zt
KQogewogCXN0cnVjdCBrdm1fcnVuICprdm1fcnVuID0gc3ZtLT52Y3B1LnJ1bjsKIAorCWlmICgh
a3ZtaV9icmVha3BvaW50X2V2ZW50KCZzdm0tPnZjcHUsIHN2bS0+dm1jYi0+c2F2ZS5jcy5iYXNl
ICsKKwkJCQkJICAgICAgIHN2bS0+dm1jYi0+c2F2ZS5yaXAsCisJCQkJICAgc3ZtX2dldF9pbnN0
cnVjdGlvbl9sZW4oJnN2bS0+dmNwdSkpKQorCQlyZXR1cm4gMTsKKwogCWt2bV9ydW4tPmV4aXRf
cmVhc29uID0gS1ZNX0VYSVRfREVCVUc7CiAJa3ZtX3J1bi0+ZGVidWcuYXJjaC5wYyA9IHN2bS0+
dm1jYi0+c2F2ZS5jcy5iYXNlICsgc3ZtLT52bWNiLT5zYXZlLnJpcDsKIAlrdm1fcnVuLT5kZWJ1
Zy5hcmNoLmV4Y2VwdGlvbiA9IEJQX1ZFQ1RPUjsKZGlmZiAtLWdpdCBhL2FyY2gveDg2L2t2bS92
bXgvdm14LmMgYi9hcmNoL3g4Ni9rdm0vdm14L3ZteC5jCmluZGV4IDRlZjRmM2MxYjc4YS4uOWUx
YmVhNzRiNzRjIDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9rdm0vdm14L3ZteC5jCisrKyBiL2FyY2gv
eDg2L2t2bS92bXgvdm14LmMKQEAgLTI3LDYgKzI3LDcgQEAKICNpbmNsdWRlIDxsaW51eC9zbGFi
Lmg+CiAjaW5jbHVkZSA8bGludXgvdGJvb3QuaD4KICNpbmNsdWRlIDxsaW51eC90cmFjZV9ldmVu
dHMuaD4KKyNpbmNsdWRlIDxsaW51eC9rdm1pX2hvc3QuaD4KIAogI2luY2x1ZGUgPGFzbS9hcGlj
Lmg+CiAjaW5jbHVkZSA8YXNtL2FzbS5oPgpAQCAtNDc5OCw3ICs0Nzk5LDcgQEAgc3RhdGljIGlu
dCBoYW5kbGVfZXhjZXB0aW9uX25taShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCiAJc3RydWN0IHZj
cHVfdm14ICp2bXggPSB0b192bXgodmNwdSk7CiAJc3RydWN0IGt2bV9ydW4gKmt2bV9ydW4gPSB2
Y3B1LT5ydW47CiAJdTMyIGludHJfaW5mbywgZXhfbm8sIGVycm9yX2NvZGU7Ci0JdW5zaWduZWQg
bG9uZyBjcjIsIHJpcCwgZHI2OworCXVuc2lnbmVkIGxvbmcgY3IyLCBkcjY7CiAJdTMyIHZlY3Rf
aW5mbzsKIAogCXZlY3RfaW5mbyA9IHZteC0+aWR0X3ZlY3RvcmluZ19pbmZvOwpAQCAtNDg3MSw3
ICs0ODcyLDEwIEBAIHN0YXRpYyBpbnQgaGFuZGxlX2V4Y2VwdGlvbl9ubWkoc3RydWN0IGt2bV92
Y3B1ICp2Y3B1KQogCQlrdm1fcnVuLT5kZWJ1Zy5hcmNoLmRyNiA9IGRyNiB8IERSNl9GSVhFRF8x
IHwgRFI2X1JUTTsKIAkJa3ZtX3J1bi0+ZGVidWcuYXJjaC5kcjcgPSB2bWNzX3JlYWRsKEdVRVNU
X0RSNyk7CiAJCS8qIGZhbGwgdGhyb3VnaCAqLwotCWNhc2UgQlBfVkVDVE9SOgorCWNhc2UgQlBf
VkVDVE9SOiB7CisJCXVuc2lnbmVkIGxvbmcgZ3ZhID0gdm1jc19yZWFkbChHVUVTVF9DU19CQVNF
KSArCisJCQlrdm1fcmlwX3JlYWQodmNwdSk7CisKIAkJLyoKIAkJICogVXBkYXRlIGluc3RydWN0
aW9uIGxlbmd0aCBhcyB3ZSBtYXkgcmVpbmplY3QgI0JQIGZyb20KIAkJICogdXNlciBzcGFjZSB3
aGlsZSBpbiBndWVzdCBkZWJ1Z2dpbmcgbW9kZS4gUmVhZGluZyBpdCBmb3IKQEAgLTQ4NzksMTEg
KzQ4ODMsMTYgQEAgc3RhdGljIGludCBoYW5kbGVfZXhjZXB0aW9uX25taShzdHJ1Y3Qga3ZtX3Zj
cHUgKnZjcHUpCiAJCSAqLwogCQl2bXgtPnZjcHUuYXJjaC5ldmVudF9leGl0X2luc3RfbGVuID0K
IAkJCXZtY3NfcmVhZDMyKFZNX0VYSVRfSU5TVFJVQ1RJT05fTEVOKTsKKworCQlpZiAoIWt2bWlf
YnJlYWtwb2ludF9ldmVudCh2Y3B1LCBndmEsCisJCQkJCSAgIHZteC0+dmNwdS5hcmNoLmV2ZW50
X2V4aXRfaW5zdF9sZW4pKQorCQkJcmV0dXJuIDE7CisKIAkJa3ZtX3J1bi0+ZXhpdF9yZWFzb24g
PSBLVk1fRVhJVF9ERUJVRzsKLQkJcmlwID0ga3ZtX3JpcF9yZWFkKHZjcHUpOwotCQlrdm1fcnVu
LT5kZWJ1Zy5hcmNoLnBjID0gdm1jc19yZWFkbChHVUVTVF9DU19CQVNFKSArIHJpcDsKKwkJa3Zt
X3J1bi0+ZGVidWcuYXJjaC5wYyA9IGd2YTsKIAkJa3ZtX3J1bi0+ZGVidWcuYXJjaC5leGNlcHRp
b24gPSBleF9ubzsKIAkJYnJlYWs7CisJfQogCWNhc2UgQUNfVkVDVE9SOgogCQlpZiAoZ3Vlc3Rf
aW5qZWN0X2FjKHZjcHUpKSB7CiAJCQlrdm1fcXVldWVfZXhjZXB0aW9uX2UodmNwdSwgQUNfVkVD
VE9SLCBlcnJvcl9jb2RlKTsKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0Lmgg
Yi9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oCmluZGV4IDVjNGI5YzE2MDAxOS4uYzRmYWM0MWJk
NWM3IDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oCisrKyBiL2luY2x1ZGUv
bGludXgva3ZtaV9ob3N0LmgKQEAgLTczLDYgKzczLDcgQEAgaW50IGt2bWlfaW9jdGxfcHJldW5o
b29rKHN0cnVjdCBrdm0gKmt2bSk7CiAKIHZvaWQga3ZtaV9oYW5kbGVfcmVxdWVzdHMoc3RydWN0
IGt2bV92Y3B1ICp2Y3B1KTsKIGJvb2wga3ZtaV9oeXBlcmNhbGxfZXZlbnQoc3RydWN0IGt2bV92
Y3B1ICp2Y3B1KTsKK2Jvb2wga3ZtaV9icmVha3BvaW50X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSwgdTY0IGd2YSwgdTggaW5zbl9sZW4pOwogCiAjZWxzZQogCkBAIC04NCw2ICs4NSw5IEBA
IHN0YXRpYyBpbmxpbmUgdm9pZCBrdm1pX3ZjcHVfdW5pbml0KHN0cnVjdCBrdm1fdmNwdSAqdmNw
dSkgeyB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZCBrdm1pX2hhbmRsZV9yZXF1ZXN0cyhzdHJ1Y3Qg
a3ZtX3ZjcHUgKnZjcHUpIHsgfQogc3RhdGljIGlubGluZSBib29sIGt2bWlfaHlwZXJjYWxsX2V2
ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkgeyByZXR1cm4gZmFsc2U7IH0KK3N0YXRpYyBpbmxp
bmUgYm9vbCBrdm1pX2JyZWFrcG9pbnRfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1NjQg
Z3ZhLAorCQkJCQkgdTggaW5zbl9sZW4pCisJCQl7IHJldHVybiB0cnVlOyB9CiAKICNlbmRpZiAv
KiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04gKi8KIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBp
L2xpbnV4L2t2bWkuaCBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKaW5kZXggN2QxZmViZDY3
MWQ3Li4wMjZhZTU5MTFiMWMgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgK
KysrIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaApAQCAtMzksNiArMzksNyBAQCBlbnVtIHsK
IAlLVk1JX0VWRU5UX1VOSE9PSyAgICAgPSAwLAogCUtWTUlfRVZFTlRfUEFVU0VfVkNQVSA9IDEs
CiAJS1ZNSV9FVkVOVF9IWVBFUkNBTEwgID0gMiwKKwlLVk1JX0VWRU5UX0JSRUFLUE9JTlQgPSAz
LAogCiAJS1ZNSV9OVU1fRVZFTlRTCiB9OwpkaWZmIC0tZ2l0IGEvdG9vbHMvdGVzdGluZy9zZWxm
dGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2
bS94ODZfNjQva3ZtaV90ZXN0LmMKaW5kZXggM2E3Njg0MmU0OGM2Li4zYjkyMWUzY2Y5NTggMTAw
NjQ0Ci0tLSBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMK
KysrIGIvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYwpAQCAt
NDksNiArNDksNyBAQCBzdHJ1Y3QgdmNwdV93b3JrZXJfZGF0YSB7CiAKIGVudW0gewogCUdVRVNU
X1RFU1RfTk9PUCA9IDAsCisJR1VFU1RfVEVTVF9CUCwKIAlHVUVTVF9URVNUX0hZUEVSQ0FMTCwK
IH07CiAKQEAgLTYzLDYgKzY0LDExIEBAIHN0YXRpYyBpbnQgZ3Vlc3RfdGVzdF9pZCh2b2lkKQog
CXJldHVybiBSRUFEX09OQ0UodGVzdF9pZCk7CiB9CiAKK3N0YXRpYyB2b2lkIGd1ZXN0X2JwX3Rl
c3Qodm9pZCkKK3sKKwlhc20gdm9sYXRpbGUoImludDMiKTsKK30KKwogc3RhdGljIHZvaWQgZ3Vl
c3RfaHlwZXJjYWxsX3Rlc3Qodm9pZCkKIHsKIAlhc20gdm9sYXRpbGUoIm1vdiAkMzQsICVyYXgi
KTsKQEAgLTc3LDYgKzgzLDkgQEAgc3RhdGljIHZvaWQgZ3Vlc3RfY29kZSh2b2lkKQogCQlzd2l0
Y2ggKGd1ZXN0X3Rlc3RfaWQoKSkgewogCQljYXNlIEdVRVNUX1RFU1RfTk9PUDoKIAkJCWJyZWFr
OworCQljYXNlIEdVRVNUX1RFU1RfQlA6CisJCQlndWVzdF9icF90ZXN0KCk7CisJCQlicmVhazsK
IAkJY2FzZSBHVUVTVF9URVNUX0hZUEVSQ0FMTDoKIAkJCWd1ZXN0X2h5cGVyY2FsbF90ZXN0KCk7
CiAJCQlicmVhazsKQEAgLTExMDcsNiArMTExNiw0MiBAQCBzdGF0aWMgdm9pZCB0ZXN0X2V2ZW50
X2h5cGVyY2FsbChzdHJ1Y3Qga3ZtX3ZtICp2bSkKIAlkaXNhYmxlX3ZjcHVfZXZlbnQodm0sIGV2
ZW50X2lkKTsKIH0KIAorc3RhdGljIHZvaWQgdGVzdF9ldmVudF9icmVha3BvaW50KHN0cnVjdCBr
dm1fdm0gKnZtKQoreworCXN0cnVjdCB2Y3B1X3dvcmtlcl9kYXRhIGRhdGEgPSB7CisJCS52bSA9
IHZtLAorCQkudmNwdV9pZCA9IFZDUFVfSUQsCisJCS50ZXN0X2lkID0gR1VFU1RfVEVTVF9CUCwK
Kwl9OworCXN0cnVjdCBrdm1pX21zZ19oZHIgaGRyOworCXN0cnVjdCB7CisJCXN0cnVjdCBrdm1p
X2V2ZW50IGNvbW1vbjsKKwkJc3RydWN0IGt2bWlfZXZlbnRfYnJlYWtwb2ludCBicDsKKwl9IGV2
OworCXN0cnVjdCB2Y3B1X3JlcGx5IHJwbCA9IHt9OworCV9fdTE2IGV2ZW50X2lkID0gS1ZNSV9F
VkVOVF9CUkVBS1BPSU5UOworCXB0aHJlYWRfdCB2Y3B1X3RocmVhZDsKKworCWVuYWJsZV92Y3B1
X2V2ZW50KHZtLCBldmVudF9pZCk7CisKKwl2Y3B1X3RocmVhZCA9IHN0YXJ0X3ZjcHVfd29ya2Vy
KCZkYXRhKTsKKworCXJlY2VpdmVfZXZlbnQoJmhkciwgJmV2LmNvbW1vbiwgc2l6ZW9mKGV2KSwg
ZXZlbnRfaWQpOworCisJcHJfaW5mbygiQnJlYWtwb2ludCBldmVudCwgcmlwIDB4JWxseCwgbGVu
ICV1XG4iLAorCQlldi5jb21tb24uYXJjaC5yZWdzLnJpcCwgZXYuYnAuaW5zbl9sZW4pOworCisJ
ZXYuY29tbW9uLmFyY2gucmVncy5yaXAgKz0gZXYuYnAuaW5zbl9sZW47CisJX19zZXRfcmVnaXN0
ZXJzKHZtLCAmZXYuY29tbW9uLmFyY2gucmVncyk7CisKKwlyZXBseV90b19ldmVudCgmaGRyLCAm
ZXYuY29tbW9uLCBLVk1JX0VWRU5UX0FDVElPTl9SRVRSWSwKKwkJCSZycGwsIHNpemVvZihycGwp
KTsKKworCXN0b3BfdmNwdV93b3JrZXIodmNwdV90aHJlYWQsICZkYXRhKTsKKworCWRpc2FibGVf
dmNwdV9ldmVudCh2bSwgZXZlbnRfaWQpOworfQorCiBzdGF0aWMgdm9pZCB0ZXN0X2ludHJvc3Bl
Y3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCiB7CiAJc3JhbmRvbSh0aW1lKDApKTsKQEAgLTExMjgs
NiArMTE3Myw3IEBAIHN0YXRpYyB2b2lkIHRlc3RfaW50cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3Zt
ICp2bSkKIAl0ZXN0X2NtZF92Y3B1X3NldF9yZWdpc3RlcnModm0pOwogCXRlc3RfY21kX3ZjcHVf
Z2V0X2NwdWlkKHZtKTsKIAl0ZXN0X2V2ZW50X2h5cGVyY2FsbCh2bSk7CisJdGVzdF9ldmVudF9i
cmVha3BvaW50KHZtKTsKIAogCXVuaG9va19pbnRyb3NwZWN0aW9uKHZtKTsKIH0KZGlmZiAtLWdp
dCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jIGIvdmlydC9rdm0vaW50cm9zcGVjdGlv
bi9rdm1pLmMKaW5kZXggNTcxYjc5YzUyMzUzLi5hNTI2NDY5NmM2MzAgMTAwNjQ0Ci0tLSBhL3Zp
cnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24v
a3ZtaS5jCkBAIC05Nyw2ICs5Nyw3IEBAIHN0YXRpYyB2b2lkIHNldHVwX2tub3duX2V2ZW50cyh2
b2lkKQogCXNldF9iaXQoS1ZNSV9FVkVOVF9VTkhPT0ssIEt2bWlfa25vd25fdm1fZXZlbnRzKTsK
IAogCWJpdG1hcF96ZXJvKEt2bWlfa25vd25fdmNwdV9ldmVudHMsIEtWTUlfTlVNX0VWRU5UUyk7
CisJc2V0X2JpdChLVk1JX0VWRU5UX0JSRUFLUE9JTlQsIEt2bWlfa25vd25fdmNwdV9ldmVudHMp
OwogCXNldF9iaXQoS1ZNSV9FVkVOVF9IWVBFUkNBTEwsIEt2bWlfa25vd25fdmNwdV9ldmVudHMp
OwogCXNldF9iaXQoS1ZNSV9FVkVOVF9QQVVTRV9WQ1BVLCBLdm1pX2tub3duX3ZjcHVfZXZlbnRz
KTsKIApAQCAtNjM3LDcgKzYzOCw3IEBAIGludCBrdm1pX2NtZF92Y3B1X2NvbnRyb2xfZXZlbnRz
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKIAllbHNlCiAJCWNsZWFyX2JpdChldmVudF9pZCwgdmNw
dWktPmV2X2VuYWJsZV9tYXNrKTsKIAotCXJldHVybiAwOworCXJldHVybiBrdm1pX2FyY2hfY21k
X2NvbnRyb2xfaW50ZXJjZXB0KHZjcHUsIGV2ZW50X2lkLCBlbmFibGUpOwogfQogCiBzdGF0aWMg
dW5zaWduZWQgbG9uZyBnZm5fdG9faHZhX3NhZmUoc3RydWN0IGt2bSAqa3ZtLCBnZm5fdCBnZm4p
CkBAIC05MDgsMyArOTA5LDIzIEBAIGJvb2wga3ZtaV9oeXBlcmNhbGxfZXZlbnQoc3RydWN0IGt2
bV92Y3B1ICp2Y3B1KQogCiAJcmV0dXJuIHJldDsKIH0KKworYm9vbCBrdm1pX2JyZWFrcG9pbnRf
ZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1NjQgZ3ZhLCB1OCBpbnNuX2xlbikKK3sKKwlz
dHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWk7CisJYm9vbCByZXQgPSBmYWxzZTsKKworCWt2
bWkgPSBrdm1pX2dldCh2Y3B1LT5rdm0pOworCWlmICgha3ZtaSkKKwkJcmV0dXJuIHRydWU7CisK
KwlpZiAoaXNfZXZlbnRfZW5hYmxlZCh2Y3B1LCBLVk1JX0VWRU5UX0JSRUFLUE9JTlQpKQorCQlr
dm1pX2FyY2hfYnJlYWtwb2ludF9ldmVudCh2Y3B1LCBndmEsIGluc25fbGVuKTsKKwllbHNlCisJ
CXJldCA9IHRydWU7CisKKwlrdm1pX3B1dCh2Y3B1LT5rdm0pOworCisJcmV0dXJuIHJldDsKK30K
K0VYUE9SVF9TWU1CT0woa3ZtaV9icmVha3BvaW50X2V2ZW50KTsKZGlmZiAtLWdpdCBhL3ZpcnQv
a3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3Zt
aV9pbnQuaAppbmRleCA4YzAyNTI4ZTMwNTYuLjgxMGRkZTkxM2FkNiAxMDA2NDQKLS0tIGEvdmly
dC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rp
b24va3ZtaV9pbnQuaApAQCAtMzQsNiArMzQsNyBAQCBib29sIGt2bWlfbXNnX3Byb2Nlc3Moc3Ry
dWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pKTsKIGludCBrdm1pX21zZ19zZW5kX3VuaG9vayhz
dHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkpOwogdTMyIGt2bWlfbXNnX3NlbmRfdmNwdV9w
YXVzZShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwogdTMyIGt2bWlfbXNnX3NlbmRfaHlwZXJjYWxs
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7Cit1MzIga3ZtaV9tc2dfc2VuZF9icChzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUsIHU2NCBncGEsIHU4IGluc25fbGVuKTsKIAogLyoga3ZtaS5jICovCiB2b2lk
ICprdm1pX21zZ19hbGxvYyh2b2lkKTsKQEAgLTc5LDUgKzgwLDggQEAgaW50IGt2bWlfYXJjaF9j
bWRfdmNwdV9nZXRfY3B1aWQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LAogCQkJCSBzdHJ1Y3Qga3Zt
aV92Y3B1X2dldF9jcHVpZF9yZXBseSAqcnBsKTsKIGJvb2wga3ZtaV9hcmNoX2lzX2FnZW50X2h5
cGVyY2FsbChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwogdm9pZCBrdm1pX2FyY2hfaHlwZXJjYWxs
X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7Cit2b2lkIGt2bWlfYXJjaF9icmVha3BvaW50
X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTY0IGd2YSwgdTggaW5zbl9sZW4pOworaW50
IGt2bWlfYXJjaF9jbWRfY29udHJvbF9pbnRlcmNlcHQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LAor
CQkJCSAgICB1bnNpZ25lZCBpbnQgZXZlbnRfaWQsIGJvb2wgZW5hYmxlKTsKIAogI2VuZGlmCmRp
ZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgYi92aXJ0L2t2bS9p
bnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKaW5kZXggODBhZGU2MDU1NzQ3Li40YTAzOTgwZTBiYmIg
MTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYworKysgYi92aXJ0
L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKQEAgLTgwNSwzICs4MDUsMjAgQEAgdTMyIGt2
bWlfbXNnX3NlbmRfaHlwZXJjYWxsKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKIAogCXJldHVybiBh
Y3Rpb247CiB9CisKK3UzMiBrdm1pX21zZ19zZW5kX2JwKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwg
dTY0IGdwYSwgdTggaW5zbl9sZW4pCit7CisJc3RydWN0IGt2bWlfZXZlbnRfYnJlYWtwb2ludCBl
OworCWludCBlcnIsIGFjdGlvbjsKKworCW1lbXNldCgmZSwgMCwgc2l6ZW9mKGUpKTsKKwllLmdw
YSA9IGdwYTsKKwllLmluc25fbGVuID0gaW5zbl9sZW47CisKKwllcnIgPSBrdm1pX3NlbmRfZXZl
bnQodmNwdSwgS1ZNSV9FVkVOVF9CUkVBS1BPSU5ULCAmZSwgc2l6ZW9mKGUpLAorCQkJICAgICAg
TlVMTCwgMCwgJmFjdGlvbik7CisJaWYgKGVycikKKwkJcmV0dXJuIEtWTUlfRVZFTlRfQUNUSU9O
X0NPTlRJTlVFOworCisJcmV0dXJuIGFjdGlvbjsKK30KX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1
YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhm
b3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
