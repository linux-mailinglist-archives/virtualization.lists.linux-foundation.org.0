Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp2.osuosl.org (smtp2.osuosl.org [IPv6:2605:bc80:3010::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 29942717A0B
	for <lists.virtualization@lfdr.de>; Wed, 31 May 2023 10:27:04 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp2.osuosl.org (Postfix) with ESMTP id 2387141CDC;
	Wed, 31 May 2023 08:27:01 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 2387141CDC
Authentication-Results: smtp2.osuosl.org;
	dkim=fail reason="signature verification failed" (1024-bit key) header.d=redhat.com header.i=@redhat.com header.a=rsa-sha256 header.s=mimecast20190719 header.b=Ek4ou5m9
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
	by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id XX3ZZzREpRKg; Wed, 31 May 2023 08:26:59 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp2.osuosl.org (Postfix) with ESMTPS id 12A3641D3A;
	Wed, 31 May 2023 08:26:59 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 12A3641D3A
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 4B3BFC008C;
	Wed, 31 May 2023 08:26:58 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp2.osuosl.org (smtp2.osuosl.org [IPv6:2605:bc80:3010::133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id E0C6EC0037
 for <virtualization@lists.linux-foundation.org>;
 Wed, 31 May 2023 08:26:56 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp2.osuosl.org (Postfix) with ESMTP id AE91E41D00
 for <virtualization@lists.linux-foundation.org>;
 Wed, 31 May 2023 08:26:56 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org AE91E41D00
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
 by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id RxfS19TMgLle
 for <virtualization@lists.linux-foundation.org>;
 Wed, 31 May 2023 08:26:55 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org CBDF141CDC
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.129.124])
 by smtp2.osuosl.org (Postfix) with ESMTPS id CBDF141CDC
 for <virtualization@lists.linux-foundation.org>;
 Wed, 31 May 2023 08:26:54 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1685521613;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=PE3oAdfpLYk70r/9OJaDmxbWgC1xOwGf+u3+5IAAHek=;
 b=Ek4ou5m9N0y3QILHJj6xWktJVumZoPG34D8A3Zt3Z0OpXUsAI/7dZS/aOQjQJSKzdu8Rz+
 j4ecJOXZtFvmwuSGXIpr3BnWYZ+Qhaw3W/SjmH9GbZMFeBqJFWvHyKsRmWeFNtSAIOSGOL
 pYjtilVT+c5nEyDzlutJxolXF/n9IUk=
Received: from mail-lj1-f199.google.com (mail-lj1-f199.google.com
 [209.85.208.199]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384) id
 us-mta-365-AhSJjwDsNR2lx23-PvezeA-1; Wed, 31 May 2023 04:26:52 -0400
X-MC-Unique: AhSJjwDsNR2lx23-PvezeA-1
Received: by mail-lj1-f199.google.com with SMTP id
 38308e7fff4ca-2af207a45bfso26897761fa.0
 for <virtualization@lists.linux-foundation.org>;
 Wed, 31 May 2023 01:26:51 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20221208; t=1685521610; x=1688113610;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
 :subject:date:message-id:reply-to;
 bh=PE3oAdfpLYk70r/9OJaDmxbWgC1xOwGf+u3+5IAAHek=;
 b=NQ3hZ1E5pNTxs2+a77ZddFfOqCEn4EWXhye3ldVmb3wr3RXTuRK2SH29QHnFootjVd
 eyKMaRag6Cx8NkZJ/zhibD7yJdcs0h4CW01nxCDZNPxo0qBYrjNy+gFXebfAkS7YbTHA
 nlcKVD7kY+rlVQZS7w0xS+cTpNHLj2hcRpXAJyFaeN4k9aktYU58fmBrRxNJHLywFiwM
 rMHkhOGPsmoV7T/zoBCYurrlN8UMCVUxxvLgxq+/lm6DSxOa0s5t2X7lfPexwFS8szfJ
 U/g1hq5urYSRgwwbzKQMUC3uZTNOEjeyKJPg1yR1S5kvpGw11dhglmt1tspaAjG+XG67
 SGsA==
X-Gm-Message-State: AC+VfDzS1B7qoHASarisBy9wQGqapGytjc9ZrbYhLIqdq2s3ntUojOwA
 OzAczSW/iIy42E5lmfs5CHR5fJdUoiCHi6ZT2j57G2gc/p4ZIR9Re7E62qEpsx+558Ituc+l5oo
 RfeFGT7q55KBejYBDEMgb6pPx6zT3w1l7f0G3MF53lJbtFhm1w2RL2PhW4Q==
X-Received: by 2002:a2e:9998:0:b0:2ad:d6cd:efe0 with SMTP id
 w24-20020a2e9998000000b002add6cdefe0mr2165473lji.37.1685521610508; 
 Wed, 31 May 2023 01:26:50 -0700 (PDT)
X-Google-Smtp-Source: ACHHUZ51yJV7vy7uRAkxYI6EA4Hl2d9N2mKXc11kpzv8saVYsqLUGg3E5bzYK7sCjrLetc+45jCL+cEk8gS3UtH/Y5o=
X-Received: by 2002:a2e:9998:0:b0:2ad:d6cd:efe0 with SMTP id
 w24-20020a2e9998000000b002add6cdefe0mr2165462lji.37.1685521610077; Wed, 31
 May 2023 01:26:50 -0700 (PDT)
MIME-Version: 1.0
References: <20230526063041.18359-1-jasowang@redhat.com>
 <20230528033037-mutt-send-email-mst@kernel.org>
 <CACGkMEs9Ztavn2JyuUAb47Sk1fYHiXLLkQQPQR5Czhb2yu_R3w@mail.gmail.com>
 <20230529055729-mutt-send-email-mst@kernel.org>
 <CACGkMEsW1+BFtMoLg4c_FyxYTZJcSVh4BoEdJ-Q9_WGg_DcReA@mail.gmail.com>
 <20230531014326-mutt-send-email-mst@kernel.org>
 <CACGkMEvok6HjBK_ZMR4EYzWxpJQVeh++EMErnHjJ6cu9m3R-1A@mail.gmail.com>
In-Reply-To: <CACGkMEvok6HjBK_ZMR4EYzWxpJQVeh++EMErnHjJ6cu9m3R-1A@mail.gmail.com>
From: Jason Wang <jasowang@redhat.com>
Date: Wed, 31 May 2023 16:26:38 +0800
Message-ID: <CACGkMEuDWL30J7D8v+xLCvvspRBoz8X7q23FymBVRm9bT1pVUQ@mail.gmail.com>
Subject: Re: [PATCH] virtio_ring: validate used buffer length
To: "Michael S. Tsirkin" <mst@redhat.com>
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Cc: xuanzhuo@linux.alibaba.com, linux-kernel@vger.kernel.org,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gV2VkLCBNYXkgMzEsIDIwMjMgYXQgMzozNuKAr1BNIEphc29uIFdhbmcgPGphc293YW5nQHJl
ZGhhdC5jb20+IHdyb3RlOgo+Cj4gT24gV2VkLCBNYXkgMzEsIDIwMjMgYXQgMTo1MOKAr1BNIE1p
Y2hhZWwgUy4gVHNpcmtpbiA8bXN0QHJlZGhhdC5jb20+IHdyb3RlOgo+ID4KPiA+IE9uIFdlZCwg
TWF5IDMxLCAyMDIzIGF0IDA5OjA1OjAwQU0gKzA4MDAsIEphc29uIFdhbmcgd3JvdGU6Cj4gPiA+
IE9uIE1vbiwgTWF5IDI5LCAyMDIzIGF0IDY6MDPigK9QTSBNaWNoYWVsIFMuIFRzaXJraW4gPG1z
dEByZWRoYXQuY29tPiB3cm90ZToKPiA+ID4gPgo+ID4gPiA+IE9uIE1vbiwgTWF5IDI5LCAyMDIz
IGF0IDA5OjE4OjEwQU0gKzA4MDAsIEphc29uIFdhbmcgd3JvdGU6Cj4gPiA+ID4gPiBPbiBTdW4s
IE1heSAyOCwgMjAyMyBhdCAzOjU34oCvUE0gTWljaGFlbCBTLiBUc2lya2luIDxtc3RAcmVkaGF0
LmNvbT4gd3JvdGU6Cj4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+IE9uIEZyaSwgTWF5IDI2LCAyMDIz
IGF0IDAyOjMwOjQxUE0gKzA4MDAsIEphc29uIFdhbmcgd3JvdGU6Cj4gPiA+ID4gPiA+ID4gVGhp
cyBwYXRjaCB2YWxpZGF0ZQo+ID4gPiA+ID4gPgo+ID4gPiA+ID4gPiB2YWxpZGF0ZXMKPiA+ID4g
PiA+ID4KPiA+ID4gPiA+ID4gPiB0aGUgdXNlZCBidWZmZXIgbGVuZ3RoIHByb3ZpZGVkIGJ5IHRo
ZSBkZXZpY2UKPiA+ID4gPiA+ID4gPiBiZWZvcmUgdHJ5aW5nIHRvIHVzZSBpdC4KPiA+ID4gPiA+
ID4KPiA+ID4gPiA+ID4gYmVmb3JlIHJldHVybmluZyBpdCB0byBjYWxsZXIKPiA+ID4gPiA+ID4K
PiA+ID4gPiA+ID4gPiBUaGlzIGlzIGRvbmUgYnkgcmVtZW1iZXJpbmcgdGhlIGluIGJ1ZmZlcgo+
ID4gPiA+ID4gPiA+IGxlbmd0aCBpbiBhIGRlZGljYXRlZCBhcnJheSBkdXJpbmcgdmlydHF1ZXVl
X2FkZCgpLCB0aGVuIHdlIGNhbiBmYWlsCj4gPiA+ID4gPiA+ID4gdGhlIHZpcnRxdWV1ZV9nZXRf
YnVmKCkgd2hlbiB3ZSBmaW5kIHRoZSBkZXZpY2UgaXMgdHJ5aW5nIHRvIGdpdmUgdXMgYQo+ID4g
PiA+ID4gPiA+IHVzZWQgYnVmZmVyIGxlbmd0aCB3aGljaCBpcyBncmVhdGVyIHRoYW4gd2Ugc3Rv
cmVkIGJlZm9yZS4KPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gdGhhbiB3aGF0IHdlIHN0b3JlZAo+
ID4gPiA+ID4gPgo+ID4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ID4gVGhpcyB2YWxpZGF0aW9uIGlz
IGRpc2FibGUKPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gZGlzYWJsZWQKPiA+ID4gPiA+ID4KPiA+
ID4gPiA+ID4gPiBieSBkZWZhdWx0IHZpYSBtb2R1bGUgcGFyYW1ldGVyIHRvIHVuYnJlYWsKPiA+
ID4gPiA+ID4gPiBzb21lIGV4aXN0aW5nIGRldmljZXMgc2luY2Ugc29tZSBsZWdhY3kgZGV2aWNl
cyBhcmUga25vd24gdG8gcmVwb3J0Cj4gPiA+ID4gPiA+ID4gYnVnZ3kgdXNlZCBsZW5ndGguCj4g
PiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gPiBTaWduZWQtb2ZmLWJ5OiBKYXNvbiBXYW5nIDxqYXNv
d2FuZ0ByZWRoYXQuY29tPgo+ID4gPiA+ID4gPgo+ID4gPiA+ID4gPiBGaXJzdCBJJ20gbm90IG1l
cmdpbmcgdGhpcyB3aXRob3V0IG1vcmUgZGF0YSBhYm91dAo+ID4gPiA+ID4gPiB3aGF0IGlzIGtu
b3duIHRvIGJlIGJyb2tlbiBhbmQgd2hhdCBpcyBrbm93biB0byB3b3JrIHdlbGwKPiA+ID4gPiA+
ID4gaW4gdGhlIGNvbW1pdCBsb2cuIEFuZCBob3cgZXhhY3RseSBkbyB0aGluZ3Mgd29yayBpZiB1
c2VkIGxlbmd0aAo+ID4gPiA+ID4gPiBpcyB3cm9uZz8KPiA+ID4gPiA+Cj4gPiA+ID4gPiBBc3N1
bWluZyB0aGUgZGV2aWNlIGlzIG1hbGljaW91cywgaXQgd291bGQgYmUgdmVyeSBoYXJkIHRvIGFu
c3dlci4KPiA+ID4gPiA+IEF1ZGl0aW5nIGFuZCBmdXp6aW5nIHdvbid0IGNvdmVyIGV2ZXJ5IGNh
c2UuIEluc3RlYWQgb2YgdHJ5aW5nIHRvIHNlZWsKPiA+ID4gPiA+IHRoZSBhbnN3ZXIsIHdlIGNh
biBzaW1wbHkgbWFrZSBzdXJlIHRoZSB1c2VkIGluIGJ1ZmZlciBsZW5ndGggaXMKPiA+ID4gPiA+
IHZhbGlkYXRlZCB0aGVuIHdlIGtub3cgd2UncmUgZmluZSBvciBub3QuCj4gPiA+ID4KPiA+ID4g
PiBUbyByZXN0YXRlIHRoZSBxdWVzdGlvbiwgeW91IHNhaWQgYWJvdmUgInNvbWUgbGVnYWN5IGRl
dmljZXMgYXJlIGtub3duCj4gPiA+ID4gdG8gcmVwb3J0IGJ1Z2d5IHVzZWQgbGVuZ3RoIi4gSWYg
dGhleSByZXBvcnQgYnVnZ3kgbGVuZ3RoIHRoZW4gaG93Cj4gPiA+ID4gY2FuIHRoaW5ncyB3b3Jr
Pwo+ID4gPgo+ID4gPiBUaGUgdmFsaWRhdGlvbiBpcyBkaXNhYmxlZCBmb3IgbGVnYWN5IGRldmlj
ZSAoYXMgc3RhdGVkIGluIHRoZSBjaGFuZ2Vsb2cpOgo+ID4gPgo+ID4gPiBzdGF0aWMgYm9vbCB2
cmluZ19uZWVkc191c2VkX3ZhbGlkYXRpb24oY29uc3Qgc3RydWN0IHZpcnRpb19kZXZpY2UgKnZk
ZXYpCj4gPiA+IHsKPiA+ID4gICAgICAgICAvKgo+ID4gPiAgICAgICAgICAqIFNldmVyYWwgbGVn
YWN5IGRldmljZXMgYXJlIGtub3duIHRvIHByb2R1Y2UgYnVnZ3kgdXNlZAo+ID4gPiAgICAgICAg
ICAqIGxlbmd0aC4gSW4gb3JkZXIgdG8gbGV0IGRyaXZlciB3b3JrLCB3ZSB3b24ndCB2YWxpZGF0
ZSB1c2VkCj4gPiA+ICAgICAgICAgICogYnVmZmVyIGxlbmd0aCBpbiB0aGlzIGNhc2UuCj4gPiA+
ICAgICAgICAgICovCj4gPiA+ICAgICAgICAgaWYgKCF2aXJ0aW9faGFzX2ZlYXR1cmUodmRldiwg
VklSVElPX0ZfVkVSU0lPTl8xKSkKPiA+ID4gICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsK
PiA+ID4gICAgICAgICBpZiAoZm9yY2VfdXNlZF92YWxpZGF0aW9uKQo+ID4gPiAgICAgICAgICAg
ICAgICAgcmV0dXJuIHRydWU7Cj4gPiA+ICAgICAgICAgcmV0dXJuIGZhbHNlOwo+ID4gPiB9Cj4g
PiA+Cj4gPiA+IFRoaXMgc2VlbXMgdG8gYmUgd2hhdCB3ZSd2ZSBhZ3JlZWQgaW4gbGFzdCB2ZXJz
aW9uOgo+ID4gPgo+ID4gPiBodHRwczovL2xvcmUua2VybmVsLm9yZy9hbGwvQ0FOTHNZa3hmaGFt
VVUwYmI0ajd5Nk40X0c5b2RLeExDalh4Z1hFeDRTSjZfS2YrTTJRQG1haWwuZ21haWwuY29tL1Qv
I20zMWYzYjA2ZjkwMzJiZWVjMTc1YzMxMmRmYTI1MzJjYjA4YjE1YzU2Cj4gPiA+Cj4gPiA+IFRo
YW5rcwo+ID4gPgo+ID4KPiA+IEkgZG9uJ3QgZ2V0IGl0LiBZb3Ugd3JvdGU6Cj4gPgo+ID4gICAg
ICAgICBUaGlzIHZhbGlkYXRpb24gaXMgZGlzYWJsZQo+ID4gICAgICAgICBieSBkZWZhdWx0IHZp
YSBtb2R1bGUgcGFyYW1ldGVyIHRvIHVuYnJlYWsKPiA+ICAgICAgICAgc29tZSBleGlzdGluZyBk
ZXZpY2VzIHNpbmNlIHNvbWUgbGVnYWN5IGRldmljZXMgYXJlIGtub3duIHRvIHJlcG9ydAo+ID4g
ICAgICAgICBidWdneSB1c2VkIGxlbmd0aC4KPiA+Cj4gPiB3aGljaCBkZXZpY2VzPwo+Cj4gbGVn
YWN5IHJwbXNnIGFuZCB2c29jayBkZXZpY2UgKGJlZm9yZSA0OWQ4YzVmZmFkMDcpIGF0IGxlYXN0
Lgo+Cj4gPiB3aHkgZG8geW91IG5lZWQgYSBtb2R1bGUgcGFyYW1ldGVyPwo+Cj4gSWYgd2UgZW5h
YmxlIGl0IHVuY29uZGl0aW9uYWxseSBmb3IgbW9kZXJuIGRldmljZXMsIGl0IG1heSBicmVhayBz
b21lCj4gYnVnZ3kgbW9kZW4gZGV2aWNlICh2c29jayB3aXRob3V0IGEgZml4IGFzIGFuIGV4YW1w
bGUpLgo+Cj4gPgo+ID4KPiA+ID4gPgo+ID4gPiA+ID4gPiBTZWNvbmQgd2hhdCdzIHdyb25nIHdp
dGggZG1hX2Rlc2NfZXh0cmEgdGhhdCB3ZSBhbHJlYWR5IG1haW50YWluPwo+ID4gPiA+ID4gPiBU
aGlyZCBtb3RpdmF0aW9uIC0gaXQncyBwYXJ0IGFuZCBwYXJjZWwgb2YgdGhlIGhhcmRlbmluZyBl
ZmZvcnQgeWVzPwo+ID4gPiA+ID4KPiA+ID4gPiA+IFRoZXkgYXJlIGRpZmZlcmVudC4gZG1hX2Rl
c2NfZXh0cmEgaXMgZm9yIGEgZGVzY3JpcHRvciByaW5nLCBidXQgdGhpcwo+ID4gPiA+ID4gaXMg
Zm9yIGEgdXNlZCByaW5nLiBUZWNobmljYWxseSB3ZSBjYW4gZ28gYmFjayB0byBpdGVyYXRlIG9u
IHRoZQo+ID4gPiA+ID4gZGVzY3JpcHRvciByaW5nIGZvciBhIGxlZ2FsIHVzZWQgaW4gYnVmZmVy
IGxlbmd0aC4gQnV0IGl0IHdpbGwgaGF2ZQo+ID4gPiA+ID4gd29yc2UgcGVyZm9ybWFuY2UuCj4g
PiA+ID4KPiA+ID4gPiBJIGRvbid0IHJlYWxseSB1bmRlcnN0YW5kLiBXZSBhbHJlYWR5IGl0ZXJh
dGUgd2hlbiB3ZSB1bm1hcCAtCj4gPiA+ID4gYWxsIHRoYXQgaXMgbmVjZXNzYXJ5IGlzIHRvIHN1
YnRyYWN0IGl0IGZyb20gdXNlZCBsZW5ndGgsIGlmIGF0Cj4gPiA+ID4gdGhlIGVuZCBvZiB0aGUg
cHJvY2VzcyBpdCBpcyA+MCB0aGVuIHdlIGtub3cgdXNlZCBsZW5ndGggaXMgdG9vCj4gPiA+ID4g
bGFyZ2UuCj4gPiA+Cj4gPiA+IFllcywgYnV0IGl0IGlzIHRoZSBqb2IgdGhhdCBpcyBkb25lIGlu
IHRoZSBkcml2ZXIgbGV2ZWwgbm90IHRoZSB2aXJ0aW8KPiA+ID4gY29yZS4KPiA+Cj4gPiBXaGF0
IGpvYj8KPgo+IEkgbWVhbnQgdGhlIGRyaXZlciBjYW4gZG8gdGhlIHZhbGlkYXRpb24gc2luY2Ug
aXQgaGFzIHRoZSBrbm93bGVkZ2Ugb2YKPiB0aGUgYnVmZmVyIGxlbmd0aCBpZiBpdCB3YW50cy4K
Pgo+ID4gdW5tYXAgaXMgZG9uZSBpbiBkZXRhY2hfYnVmX3NwbGl0IGFuZCBkZXRhY2hfYnVmX3Bh
Y2tlZCByZXNwZWN0aXZlbHkuCj4gPiB2cmluZ19kZXNjX2V4dHJhIGlzbid0IGV2ZW4gdmlzaWJs
ZSBvdXRzaWRlIGRyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5nLmMKPgo+IGRlc2NfZXh0cmEgZG9l
c24ndCBjb250YWluIGJ1ZmZlciBsZW5ndGggZm9yIHRoZSBjYXNlIG9mIGluZGlyZWN0Cj4gZGVz
Y3JpcHRvcnMuIFNvIHdlIG5lZWQgdG8gaXRlcmF0ZSBpbiB0aGUgZGVzY3JpcHRvcnMgd2hlbiBp
dCBsb29rcwo+IGV4cGVuc2l2ZSBpZiB3ZSBkb24ndCBuZWVkIHVubWFwLgo+Cj4gVGhhbmtzCj4K
PiA+Cj4gPiBGb3IgZHJpdmVycyB0aGF0IGRvIHVubWFwIGF0IGRyaXZlciBsZXZlbCAtIEkgZ3Vl
c3MgdGhleSBjYW4gZG8KPiA+IHZhbGlkYXRpb24gdGhlcmUgdG9vLgo+ID4KPiA+ID4gVmFsaWRh
dGlvbiBpbiB2aXJ0aW8gY29yZSBpcyBzdGlsbCBuZWNlc3Nhcnkgc2luY2UgdGhleSdyZQo+ID4g
PiB3b3JraW5nIGF0IGRpZmZlcmVudCBsZXZlbHMgYW5kIGl0J3MgaGFyZCB0byBmb3JjZSB0aGUg
dmFsaWRhdGlvbiBpbgo+ID4gPiBhbGwgZHJpdmVycyBieSBjb2Rlcy4gTGFzdCB2ZXJzaW9uIGlu
dHJvZHVjZXMgYQo+ID4gPiBzdXBwcmVzc19kcml2ZXJfdmFsaWRhdGlvbiB0byBhbGxvdyB0aGUg
ZHJpdmVyIHRvIHN1cHByZXNzIHRoZSBjb3JlCj4gPiA+IHZhbGlkYXRpb24gd2hpY2ggc2VlbXMg
bm90IGdvb2QsIHdlIG5lZWQgYSB3YXkgdG8gZm9yY2UgdGhlCj4gPiA+IHZpcnRpb19yaW5nIGNv
ZGUgdG8gZG8gdmFsaWRhdGlvbiBiZWZvcmUuCj4gPgo+ID4gV2h5IGRvIHdlPyBJZiBkcml2ZXIg
dmFsaWRhdGVzIGxlbmd0aCB2aXJ0aW9fcmluZyBkb2VzIG5vdCBuZWVkIHRvCj4gPiB2YWxpZGF0
ZS4KClRvIGJlIG1vcmUgc2FmZSwgdGhlcmUncyBubyBndWFyYW50ZWUgdGhhdCB0aGVyZSdzIG5v
IGJ1ZyBpbiB0aGUgZHJpdmVyLgoKPiAgSWYgZHJpdmVyIGRvZXMgbm90IHVzZSBsZW5ndGggdmly
dGlvX3JpbmcgZG9lcyBub3QgbmVlZCB0bwo+ID4gdmFsaWRhdGUuCgpUaGlzIGNvdWxkIGJlIGRv
bmUgb24gdG9wIGFzc3VtaW5nIHRoZSB2YWxpZGF0aW9uIGlzIGRpc2FibGVkIGJ5CmRlZmF1bHQu
IEJ1dCBpZiB0aGUgYWRtaW5pc3RyYXRvciB3YW50cyB0byBoYXZlIGJlbHQgYW5kIGJyYWNlcyB3
ZQpuZWVkIHRvIGxlYXZlIGFuIG9wdGlvbiBmb3IgdGhlbS4KClRoYW5rcwoKPiBjb3JlIGNhbiBw
cm92aWRlIHRoaXMgc2VydmljZSBmb3IgdGhlIGdhemlsbGlvbiBub24KPiA+IHBlcmZvcm1hbmNl
IGNyaXRpY2FsIGRyaXZlcnMgdGhhdCBqdXN0IHdhbnQgdG8ga2VlcCB0aGluZ3Mgc2ltcGxlLAo+
ID4gYnV0IHRoZSA0LTUgY3JpdGljYWwgb25lcyBjYW4gZG8gdGhlaXIgb3duIHZhbGlkYXRpb24g
aWYgdGhleSB3YW50IHRvLgo+ID4KPiA+ID4gT3Igc3VjaCBzdHVmZiBjb3VsZCBiZSBhZGRlZAo+
ID4gPiBvbiB0b3Agc2luY2UgdGhlIHZhbGlkYXRpb24gaXMgYnkgZGVmYXVsdCBhbnl3YXkuCj4g
PiA+Cj4gPiA+IFRoYW5rcwo+ID4KPiA+Cj4gPgo+ID4gPiA+Cj4gPiA+ID4KPiA+ID4gPiA+ID4g
SSdkIGxpa2UgdG8ga25vdyB0aGUgZmF0ZSBvZiBWSVJUSU9fSEFSREVOX05PVElGSUNBVElPTiBi
ZWZvcmUKPiA+ID4gPiA+ID4gd2UgZG8gbW9yZSBoYXJkZW5pbmcuIElmIGl0J3MgaXJyZXZvY2Fi
bHkgYnJva2VuIGxldCdzIHJpcCBpdCBvdXQ/Cj4gPiA+ID4gPgo+ID4gPiA+ID4gU28gdGhlIHBs
YW4gaXMKPiA+ID4gPiA+Cj4gPiA+ID4gPiAxKSBmaW5pc2ggdXNlZCByaW5nIHZhbGlkYXRpb24g
KHRoaXMgaGFkIGJlZW4gcHJvcG9zZWQsIG1lcmdlZCBhbmQKPiA+ID4gPiA+IHJldmVydGVkIGJl
Zm9yZSBub3RpZmljYXRpb24gaGFyZGVuaW5nKQo+ID4gPiA+ID4gMikgZG8gbm90aWZpY2F0aW9u
IGhhcmRlbmluZyBvbiB0b3AuCj4gPiA+ID4gPgo+ID4gPiA+ID4gU28gbGV0J3MgbGVhdmUgaXQg
YXMgaXMgYW5kIEkgd2lsbCBkbyBhIHJld29yayBhZnRlciB3ZSBmaW5hbGl6ZSB0aGUKPiA+ID4g
PiA+IHVzZWQgcmluZyB2YWxpZGF0aW9uLgo+ID4gPiA+ID4KPiA+ID4gPiA+IFRoYW5rcwo+ID4g
PiA+ID4KPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gPiAtLS0KPiA+ID4gPiA+
ID4gPiBDaGFuZ2VzIHNpbmNlIFY0Ogo+ID4gPiA+ID4gPiA+IC0gZHJvcCB0aGUgZmxhdCBmb3Ig
ZHJpdmVyIHRvIHN1cHByZXNzIHRoZSBjaGVjawo+ID4gPiA+ID4gPiA+IC0gdmFsaWRhdGlvbiBp
cyBkaXNhYmxlZCBieSBkZWZhdWx0Cj4gPiA+ID4gPiA+ID4gLSBkb24ndCBkbyB2YWxpZGF0aW9u
IGZvciBsZWdhY3kgZGV2aWNlCj4gPiA+ID4gPiA+ID4gLSByZWJhc2UgYW5kIHN1cHBvcnQgdmly
dHF1ZXVlIHJlc2l6ZQo+ID4gPiA+ID4gPiA+IC0tLQo+ID4gPiA+ID4gPiA+ICBkcml2ZXJzL3Zp
cnRpby92aXJ0aW9fcmluZy5jIHwgNzUgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrCj4gPiA+ID4gPiA+ID4gIDEgZmlsZSBjaGFuZ2VkLCA3NSBpbnNlcnRpb25zKCspCj4gPiA+
ID4gPiA+ID4KPiA+ID4gPiA+ID4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy92aXJ0aW8vdmlydGlv
X3JpbmcuYyBiL2RyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5nLmMKPiA+ID4gPiA+ID4gPiBpbmRl
eCAxNDNmMzgwYmFhMWMuLjViMTUxNjA1YWFmOCAxMDA2NDQKPiA+ID4gPiA+ID4gPiAtLS0gYS9k
cml2ZXJzL3ZpcnRpby92aXJ0aW9fcmluZy5jCj4gPiA+ID4gPiA+ID4gKysrIGIvZHJpdmVycy92
aXJ0aW8vdmlydGlvX3JpbmcuYwo+ID4gPiA+ID4gPiA+IEBAIC0xNSw2ICsxNSw5IEBACj4gPiA+
ID4gPiA+ID4gICNpbmNsdWRlIDxsaW51eC9zcGlubG9jay5oPgo+ID4gPiA+ID4gPiA+ICAjaW5j
bHVkZSA8eGVuL3hlbi5oPgo+ID4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ID4gK3N0YXRpYyBib29s
IGZvcmNlX3VzZWRfdmFsaWRhdGlvbiA9IGZhbHNlOwo+ID4gPiA+ID4gPiA+ICttb2R1bGVfcGFy
YW0oZm9yY2VfdXNlZF92YWxpZGF0aW9uLCBib29sLCAwNDQ0KTsKPiA+ID4gPiA+ID4gPiArCj4g
PiA+ID4gPiA+ID4gICNpZmRlZiBERUJVRwo+ID4gPiA+ID4gPiA+ICAvKiBGb3IgZGV2ZWxvcG1l
bnQsIHdlIHdhbnQgdG8gY3Jhc2ggd2hlbmV2ZXIgdGhlIHJpbmcgaXMgc2NyZXdlZC4gKi8KPiA+
ID4gPiA+ID4gPiAgI2RlZmluZSBCQURfUklORyhfdnEsIGZtdCwgYXJncy4uLikgICAgICAgICAg
ICAgICAgICAgICAgICAgIFwKPiA+ID4gPiA+ID4gPiBAQCAtMTA1LDYgKzEwOCw5IEBAIHN0cnVj
dCB2cmluZ192aXJ0cXVldWVfc3BsaXQgewo+ID4gPiA+ID4gPiA+ICAgICAgIHN0cnVjdCB2cmlu
Z19kZXNjX3N0YXRlX3NwbGl0ICpkZXNjX3N0YXRlOwo+ID4gPiA+ID4gPiA+ICAgICAgIHN0cnVj
dCB2cmluZ19kZXNjX2V4dHJhICpkZXNjX2V4dHJhOwo+ID4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+
ID4gKyAgICAgLyogTWF4aW11bSBpbiBidWZmZXIgbGVuZ3RoLCBOVUxMIG1lYW5zIG5vIHVzZWQg
dmFsaWRhdGlvbiAqLwo+ID4gPiA+ID4gPiA+ICsgICAgIHUzMiAqYnVmbGVuOwo+ID4gPiA+ID4g
PiA+ICsKPiA+ID4gPiA+ID4gPiAgICAgICAvKiBETUEgYWRkcmVzcyBhbmQgc2l6ZSBpbmZvcm1h
dGlvbiAqLwo+ID4gPiA+ID4gPiA+ICAgICAgIGRtYV9hZGRyX3QgcXVldWVfZG1hX2FkZHI7Cj4g
PiA+ID4gPiA+ID4gICAgICAgc2l6ZV90IHF1ZXVlX3NpemVfaW5fYnl0ZXM7Cj4gPiA+ID4gPiA+
ID4gQEAgLTE0NSw2ICsxNTEsOSBAQCBzdHJ1Y3QgdnJpbmdfdmlydHF1ZXVlX3BhY2tlZCB7Cj4g
PiA+ID4gPiA+ID4gICAgICAgc3RydWN0IHZyaW5nX2Rlc2Nfc3RhdGVfcGFja2VkICpkZXNjX3N0
YXRlOwo+ID4gPiA+ID4gPiA+ICAgICAgIHN0cnVjdCB2cmluZ19kZXNjX2V4dHJhICpkZXNjX2V4
dHJhOwo+ID4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ID4gKyAgICAgLyogTWF4aW11bSBpbiBidWZm
ZXIgbGVuZ3RoLCBOVUxMIG1lYW5zIG5vIHVzZWQgdmFsaWRhdGlvbiAqLwo+ID4gPiA+ID4gPiA+
ICsgICAgIHUzMiAqYnVmbGVuOwo+ID4gPiA+ID4gPiA+ICsKPiA+ID4gPiA+ID4gPiAgICAgICAv
KiBETUEgYWRkcmVzcyBhbmQgc2l6ZSBpbmZvcm1hdGlvbiAqLwo+ID4gPiA+ID4gPiA+ICAgICAg
IGRtYV9hZGRyX3QgcmluZ19kbWFfYWRkcjsKPiA+ID4gPiA+ID4gPiAgICAgICBkbWFfYWRkcl90
IGRyaXZlcl9ldmVudF9kbWFfYWRkcjsKPiA+ID4gPiA+ID4gPiBAQCAtNTUyLDYgKzU2MSw3IEBA
IHN0YXRpYyBpbmxpbmUgaW50IHZpcnRxdWV1ZV9hZGRfc3BsaXQoc3RydWN0IHZpcnRxdWV1ZSAq
X3ZxLAo+ID4gPiA+ID4gPiA+ICAgICAgIHVuc2lnbmVkIGludCBpLCBuLCBhdmFpbCwgZGVzY3Nf
dXNlZCwgcHJldiwgZXJyX2lkeDsKPiA+ID4gPiA+ID4gPiAgICAgICBpbnQgaGVhZDsKPiA+ID4g
PiA+ID4gPiAgICAgICBib29sIGluZGlyZWN0Owo+ID4gPiA+ID4gPiA+ICsgICAgIHUzMiBidWZs
ZW4gPSAwOwo+ID4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ID4gICAgICAgU1RBUlRfVVNFKHZxKTsK
PiA+ID4gPiA+ID4gPgo+ID4gPiA+ID4gPiA+IEBAIC02MzUsNiArNjQ1LDcgQEAgc3RhdGljIGlu
bGluZSBpbnQgdmlydHF1ZXVlX2FkZF9zcGxpdChzdHJ1Y3QgdmlydHF1ZXVlICpfdnEsCj4gPiA+
ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgVlJJTkdfREVTQ19GX05FWFQgfAo+ID4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZSSU5HX0RFU0NfRl9XUklURSwKPiA+ID4g
PiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBpbmRpcmVjdCk7Cj4gPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgIGJ1ZmxlbiAr
PSBzZy0+bGVuZ3RoOwo+ID4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgfQo+ID4gPiA+ID4gPiA+
ICAgICAgIH0KPiA+ID4gPiA+ID4gPiAgICAgICAvKiBMYXN0IG9uZSBkb2Vzbid0IGNvbnRpbnVl
LiAqLwo+ID4gPiA+ID4gPiA+IEBAIC02NzUsNiArNjg2LDEwIEBAIHN0YXRpYyBpbmxpbmUgaW50
IHZpcnRxdWV1ZV9hZGRfc3BsaXQoc3RydWN0IHZpcnRxdWV1ZSAqX3ZxLAo+ID4gPiA+ID4gPiA+
ICAgICAgIGVsc2UKPiA+ID4gPiA+ID4gPiAgICAgICAgICAgICAgIHZxLT5zcGxpdC5kZXNjX3N0
YXRlW2hlYWRdLmluZGlyX2Rlc2MgPSBjdHg7Cj4gPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gPiAr
ICAgICAvKiBTdG9yZSBpbiBidWZmZXIgbGVuZ3RoIGlmIG5lY2Vzc2FyeSAqLwo+ID4gPiA+ID4g
PiA+ICsgICAgIGlmICh2cS0+c3BsaXQuYnVmbGVuKQo+ID4gPiA+ID4gPiA+ICsgICAgICAgICAg
ICAgdnEtPnNwbGl0LmJ1ZmxlbltoZWFkXSA9IGJ1ZmxlbjsKPiA+ID4gPiA+ID4gPiArCj4gPiA+
ID4gPiA+ID4gICAgICAgLyogUHV0IGVudHJ5IGluIGF2YWlsYWJsZSBhcnJheSAoYnV0IGRvbid0
IHVwZGF0ZSBhdmFpbC0+aWR4IHVudGlsIHRoZXkKPiA+ID4gPiA+ID4gPiAgICAgICAgKiBkbyBz
eW5jKS4gKi8KPiA+ID4gPiA+ID4gPiAgICAgICBhdmFpbCA9IHZxLT5zcGxpdC5hdmFpbF9pZHhf
c2hhZG93ICYgKHZxLT5zcGxpdC52cmluZy5udW0gLSAxKTsKPiA+ID4gPiA+ID4gPiBAQCAtODYx
LDYgKzg3NiwxMSBAQCBzdGF0aWMgdm9pZCAqdmlydHF1ZXVlX2dldF9idWZfY3R4X3NwbGl0KHN0
cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ID4gPiA+ID4gPiAgICAgICAgICAgICAgIEJBRF9SSU5H
KHZxLCAiaWQgJXUgaXMgbm90IGEgaGVhZCFcbiIsIGkpOwo+ID4gPiA+ID4gPiA+ICAgICAgICAg
ICAgICAgcmV0dXJuIE5VTEw7Cj4gPiA+ID4gPiA+ID4gICAgICAgfQo+ID4gPiA+ID4gPiA+ICsg
ICAgIGlmICh2cS0+c3BsaXQuYnVmbGVuICYmIHVubGlrZWx5KCpsZW4gPiB2cS0+c3BsaXQuYnVm
bGVuW2ldKSkgewo+ID4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgQkFEX1JJTkcodnEsICJ1c2Vk
IGxlbiAlZCBpcyBsYXJnZXIgdGhhbiBtYXggaW4gYnVmZmVyIGxlbiAldVxuIiwKPiA+ID4gPiA+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgKmxlbiwgdnEtPnNwbGl0LmJ1ZmxlbltpXSk7Cj4g
PiA+ID4gPiA+ID4gKyAgICAgICAgICAgICByZXR1cm4gTlVMTDsKPiA+ID4gPiA+ID4gPiArICAg
ICB9Cj4gPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gPiAgICAgICAvKiBkZXRhY2hfYnVmX3NwbGl0
IGNsZWFycyBkYXRhLCBzbyBncmFiIGl0IG5vdy4gKi8KPiA+ID4gPiA+ID4gPiAgICAgICByZXQg
PSB2cS0+c3BsaXQuZGVzY19zdGF0ZVtpXS5kYXRhOwo+ID4gPiA+ID4gPiA+IEBAIC0xMDg1LDEw
ICsxMTA1LDI1IEBAIHN0YXRpYyB2b2lkIHZyaW5nX2ZyZWVfc3BsaXQoc3RydWN0IHZyaW5nX3Zp
cnRxdWV1ZV9zcGxpdCAqdnJpbmdfc3BsaXQsCj4gPiA+ID4gPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICB2cmluZ19zcGxpdC0+cXVldWVfZG1hX2FkZHIsCj4gPiA+ID4gPiA+ID4gICAgICAg
ICAgICAgICAgICAgICAgICBkbWFfZGV2KTsKPiA+ID4gPiA+ID4gPgo+ID4gPiA+ID4gPiA+ICsg
ICAgIGtmcmVlKHZyaW5nX3NwbGl0LT5idWZsZW4pOwo+ID4gPiA+ID4gPiA+ICAgICAgIGtmcmVl
KHZyaW5nX3NwbGl0LT5kZXNjX3N0YXRlKTsKPiA+ID4gPiA+ID4gPiAgICAgICBrZnJlZSh2cmlu
Z19zcGxpdC0+ZGVzY19leHRyYSk7Cj4gPiA+ID4gPiA+ID4gIH0KPiA+ID4gPiA+ID4gPgo+ID4g
PiA+ID4gPiA+ICtzdGF0aWMgYm9vbCB2cmluZ19uZWVkc191c2VkX3ZhbGlkYXRpb24oY29uc3Qg
c3RydWN0IHZpcnRpb19kZXZpY2UgKnZkZXYpCj4gPiA+ID4gPiA+ID4gK3sKPiA+ID4gPiA+ID4g
PiArICAgICAvKgo+ID4gPiA+ID4gPiA+ICsgICAgICAqIFNldmVyYWwgbGVnYWN5IGRldmljZXMg
YXJlIGtub3duIHRvIHByb2R1Y2UgYnVnZ3kgdXNlZAo+ID4gPiA+ID4gPiA+ICsgICAgICAqIGxl
bmd0aC4gSW4gb3JkZXIgdG8gbGV0IGRyaXZlciB3b3JrLCB3ZSB3b24ndCB2YWxpZGF0ZSB1c2Vk
Cj4gPiA+ID4gPiA+ID4gKyAgICAgICogYnVmZmVyIGxlbmd0aCBpbiB0aGlzIGNhc2UuCj4gPiA+
ID4gPiA+ID4gKyAgICAgICovCj4gPiA+ID4gPiA+ID4gKyAgICAgaWYgKCF2aXJ0aW9faGFzX2Zl
YXR1cmUodmRldiwgVklSVElPX0ZfVkVSU0lPTl8xKSkKPiA+ID4gPiA+ID4gPiArICAgICAgICAg
ICAgIHJldHVybiBmYWxzZTsKPiA+ID4gPiA+ID4gPiArICAgICBpZiAoZm9yY2VfdXNlZF92YWxp
ZGF0aW9uKQo+ID4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgcmV0dXJuIHRydWU7Cj4gPiA+ID4g
PiA+ID4gKyAgICAgcmV0dXJuIGZhbHNlOwo+ID4gPiA+ID4gPiA+ICt9Cj4gPiA+ID4gPiA+ID4g
Kwo+ID4gPiA+ID4gPiA+ICBzdGF0aWMgaW50IHZyaW5nX2FsbG9jX3F1ZXVlX3NwbGl0KHN0cnVj
dCB2cmluZ192aXJ0cXVldWVfc3BsaXQgKnZyaW5nX3NwbGl0LAo+ID4gPiA+ID4gPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2aXJ0aW9fZGV2aWNlICp2ZGV2LAo+
ID4gPiA+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUzMiBudW0sCj4g
PiA+ID4gPiA+ID4gQEAgLTExMzcsNyArMTE3MiwxOSBAQCBzdGF0aWMgaW50IHZyaW5nX2FsbG9j
X3F1ZXVlX3NwbGl0KHN0cnVjdCB2cmluZ192aXJ0cXVldWVfc3BsaXQgKnZyaW5nX3NwbGl0LAo+
ID4gPiA+ID4gPiA+ICAgICAgIHZyaW5nX3NwbGl0LT52cmluZ19hbGlnbiA9IHZyaW5nX2FsaWdu
Owo+ID4gPiA+ID4gPiA+ICAgICAgIHZyaW5nX3NwbGl0LT5tYXlfcmVkdWNlX251bSA9IG1heV9y
ZWR1Y2VfbnVtOwo+ID4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ID4gKyAgICAgaWYgKHZyaW5nX25l
ZWRzX3VzZWRfdmFsaWRhdGlvbih2ZGV2KSkgewo+ID4gPiA+ID4gPiA+ICsgICAgICAgICAgICAg
dnJpbmdfc3BsaXQtPmJ1ZmxlbiA9Cj4gPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAg
IGttYWxsb2NfYXJyYXkobnVtLCBzaXplb2YoKnZyaW5nX3NwbGl0LT5idWZsZW4pLAo+ID4gPiA+
ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdGUF9LRVJORUwpOwo+
ID4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgaWYgKCF2cmluZ19zcGxpdC0+YnVmbGVuKQo+ID4g
PiA+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl9idWZsZW47Cj4gPiA+ID4g
PiA+ID4gKyAgICAgfQo+ID4gPiA+ID4gPiA+ICsKPiA+ID4gPiA+ID4gPiAgICAgICByZXR1cm4g
MDsKPiA+ID4gPiA+ID4gPiArCj4gPiA+ID4gPiA+ID4gK2Vycl9idWZsZW46Cj4gPiA+ID4gPiA+
ID4gKyAgICAgdnJpbmdfZnJlZV9zcGxpdCh2cmluZ19zcGxpdCwgdmRldiwgZG1hX2Rldik7Cj4g
PiA+ID4gPiA+ID4gKyAgICAgcmV0dXJuIC1FTk9NRU07Cj4gPiA+ID4gPiA+ID4gIH0KPiA+ID4g
PiA+ID4gPgo+ID4gPiA+ID4gPiA+ICBzdGF0aWMgc3RydWN0IHZpcnRxdWV1ZSAqdnJpbmdfY3Jl
YXRlX3ZpcnRxdWV1ZV9zcGxpdCgKPiA+ID4gPiA+ID4gPiBAQCAtMTI5Nyw2ICsxMzQ0LDcgQEAg
c3RhdGljIGludCB2aXJ0cXVldWVfYWRkX2luZGlyZWN0X3BhY2tlZChzdHJ1Y3QgdnJpbmdfdmly
dHF1ZXVlICp2cSwKPiA+ID4gPiA+ID4gPiAgICAgICB1bnNpZ25lZCBpbnQgaSwgbiwgZXJyX2lk
eDsKPiA+ID4gPiA+ID4gPiAgICAgICB1MTYgaGVhZCwgaWQ7Cj4gPiA+ID4gPiA+ID4gICAgICAg
ZG1hX2FkZHJfdCBhZGRyOwo+ID4gPiA+ID4gPiA+ICsgICAgIHUzMiBidWZsZW4gPSAwOwo+ID4g
PiA+ID4gPiA+Cj4gPiA+ID4gPiA+ID4gICAgICAgaGVhZCA9IHZxLT5wYWNrZWQubmV4dF9hdmFp
bF9pZHg7Cj4gPiA+ID4gPiA+ID4gICAgICAgZGVzYyA9IGFsbG9jX2luZGlyZWN0X3BhY2tlZCh0
b3RhbF9zZywgZ2ZwKTsKPiA+ID4gPiA+ID4gPiBAQCAtMTMyNSw2ICsxMzczLDggQEAgc3RhdGlj
IGludCB2aXJ0cXVldWVfYWRkX2luZGlyZWN0X3BhY2tlZChzdHJ1Y3QgdnJpbmdfdmlydHF1ZXVl
ICp2cSwKPiA+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgZGVzY1tpXS5hZGRyID0g
Y3B1X3RvX2xlNjQoYWRkcik7Cj4gPiA+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgIGRl
c2NbaV0ubGVuID0gY3B1X3RvX2xlMzIoc2ctPmxlbmd0aCk7Cj4gPiA+ID4gPiA+ID4gICAgICAg
ICAgICAgICAgICAgICAgIGkrKzsKPiA+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
aWYgKG4gPj0gb3V0X3NncykKPiA+ID4gPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBidWZsZW4gKz0gc2ctPmxlbmd0aDsKPiA+ID4gPiA+ID4gPiAgICAgICAgICAgICAgIH0K
PiA+ID4gPiA+ID4gPiAgICAgICB9Cj4gPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gPiBAQCAtMTM3
OSw2ICsxNDI5LDEwIEBAIHN0YXRpYyBpbnQgdmlydHF1ZXVlX2FkZF9pbmRpcmVjdF9wYWNrZWQo
c3RydWN0IHZyaW5nX3ZpcnRxdWV1ZSAqdnEsCj4gPiA+ID4gPiA+ID4gICAgICAgdnEtPnBhY2tl
ZC5kZXNjX3N0YXRlW2lkXS5sYXN0ID0gaWQ7Cj4gPiA+ID4gPiA+ID4gICAgICAgdnEtPnBhY2tl
ZC5kZXNjX3N0YXRlW2lkXS5wcmVtYXBwZWQgPSBwcmVtYXBwZWQ7Cj4gPiA+ID4gPiA+ID4KPiA+
ID4gPiA+ID4gPiArICAgICAvKiBTdG9yZSBpbiBidWZmZXIgbGVuZ3RoIGlmIG5lY2Vzc2FyeSAq
Lwo+ID4gPiA+ID4gPiA+ICsgICAgIGlmICh2cS0+cGFja2VkLmJ1ZmxlbikKPiA+ID4gPiA+ID4g
PiArICAgICAgICAgICAgIHZxLT5wYWNrZWQuYnVmbGVuW2lkXSA9IGJ1ZmxlbjsKPiA+ID4gPiA+
ID4gPiArCj4gPiA+ID4gPiA+ID4gICAgICAgdnEtPm51bV9hZGRlZCArPSAxOwo+ID4gPiA+ID4g
PiA+Cj4gPiA+ID4gPiA+ID4gICAgICAgcHJfZGVidWcoIkFkZGVkIGJ1ZmZlciBoZWFkICVpIHRv
ICVwXG4iLCBoZWFkLCB2cSk7Cj4gPiA+ID4gPiA+ID4gQEAgLTE0MTYsNiArMTQ3MCw3IEBAIHN0
YXRpYyBpbmxpbmUgaW50IHZpcnRxdWV1ZV9hZGRfcGFja2VkKHN0cnVjdCB2aXJ0cXVldWUgKl92
cSwKPiA+ID4gPiA+ID4gPiAgICAgICBfX2xlMTYgaGVhZF9mbGFncywgZmxhZ3M7Cj4gPiA+ID4g
PiA+ID4gICAgICAgdTE2IGhlYWQsIGlkLCBwcmV2LCBjdXJyLCBhdmFpbF91c2VkX2ZsYWdzOwo+
ID4gPiA+ID4gPiA+ICAgICAgIGludCBlcnI7Cj4gPiA+ID4gPiA+ID4gKyAgICAgdTMyIGJ1Zmxl
biA9IDA7Cj4gPiA+ID4gPiA+ID4KPiA+ID4gPiA+ID4gPiAgICAgICBTVEFSVF9VU0UodnEpOwo+
ID4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ID4gQEAgLTE0OTgsNiArMTU1Myw4IEBAIHN0YXRpYyBp
bmxpbmUgaW50IHZpcnRxdWV1ZV9hZGRfcGFja2VkKHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+
ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEgPDwgVlJJ
TkdfUEFDS0VEX0RFU0NfRl9BVkFJTCB8Cj4gPiA+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAxIDw8IFZSSU5HX1BBQ0tFRF9ERVNDX0ZfVVNFRDsKPiA+ID4g
PiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgfQo+ID4gPiA+ID4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICBpZiAobiA+PSBvdXRfc2dzKQo+ID4gPiA+ID4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGJ1ZmxlbiArPSBzZy0+bGVuZ3RoOwo+ID4gPiA+ID4gPiA+ICAgICAg
ICAgICAgICAgfQo+ID4gPiA+ID4gPiA+ICAgICAgIH0KPiA+ID4gPiA+ID4gPgo+ID4gPiA+ID4g
PiA+IEBAIC0xNTE4LDYgKzE1NzUsMTAgQEAgc3RhdGljIGlubGluZSBpbnQgdmlydHF1ZXVlX2Fk
ZF9wYWNrZWQoc3RydWN0IHZpcnRxdWV1ZSAqX3ZxLAo+ID4gPiA+ID4gPiA+ICAgICAgIHZxLT5w
YWNrZWQuZGVzY19zdGF0ZVtpZF0ubGFzdCA9IHByZXY7Cj4gPiA+ID4gPiA+ID4gICAgICAgdnEt
PnBhY2tlZC5kZXNjX3N0YXRlW2lkXS5wcmVtYXBwZWQgPSBwcmVtYXBwZWQ7Cj4gPiA+ID4gPiA+
ID4KPiA+ID4gPiA+ID4gPiArICAgICAvKiBTdG9yZSBpbiBidWZmZXIgbGVuZ3RoIGlmIG5lY2Vz
c2FyeSAqLwo+ID4gPiA+ID4gPiA+ICsgICAgIGlmICh2cS0+cGFja2VkLmJ1ZmxlbikKPiA+ID4g
PiA+ID4gPiArICAgICAgICAgICAgIHZxLT5wYWNrZWQuYnVmbGVuW2lkXSA9IGJ1ZmxlbjsKPiA+
ID4gPiA+ID4gPiArCj4gPiA+ID4gPiA+ID4gICAgICAgLyoKPiA+ID4gPiA+ID4gPiAgICAgICAg
KiBBIGRyaXZlciBNVVNUIE5PVCBtYWtlIHRoZSBmaXJzdCBkZXNjcmlwdG9yIGluIHRoZSBsaXN0
Cj4gPiA+ID4gPiA+ID4gICAgICAgICogYXZhaWxhYmxlIGJlZm9yZSBhbGwgc3Vic2VxdWVudCBk
ZXNjcmlwdG9ycyBjb21wcmlzaW5nCj4gPiA+ID4gPiA+ID4gQEAgLTE3MTgsNiArMTc3OSwxMSBA
QCBzdGF0aWMgdm9pZCAqdmlydHF1ZXVlX2dldF9idWZfY3R4X3BhY2tlZChzdHJ1Y3QgdmlydHF1
ZXVlICpfdnEsCj4gPiA+ID4gPiA+ID4gICAgICAgICAgICAgICBCQURfUklORyh2cSwgImlkICV1
IGlzIG5vdCBhIGhlYWQhXG4iLCBpZCk7Cj4gPiA+ID4gPiA+ID4gICAgICAgICAgICAgICByZXR1
cm4gTlVMTDsKPiA+ID4gPiA+ID4gPiAgICAgICB9Cj4gPiA+ID4gPiA+ID4gKyAgICAgaWYgKHZx
LT5wYWNrZWQuYnVmbGVuICYmIHVubGlrZWx5KCpsZW4gPiB2cS0+cGFja2VkLmJ1ZmxlbltpZF0p
KSB7Cj4gPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICBCQURfUklORyh2cSwgInVzZWQgbGVuICVk
IGlzIGxhcmdlciB0aGFuIG1heCBpbiBidWZmZXIgbGVuICV1XG4iLAo+ID4gPiA+ID4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAqbGVuLCB2cS0+cGFja2VkLmJ1ZmxlbltpZF0pOwo+ID4gPiA+
ID4gPiA+ICsgICAgICAgICAgICAgcmV0dXJuIE5VTEw7Cj4gPiA+ID4gPiA+ID4gKyAgICAgfQo+
ID4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ID4gICAgICAgLyogZGV0YWNoX2J1Zl9wYWNrZWQgY2xl
YXJzIGRhdGEsIHNvIGdyYWIgaXQgbm93LiAqLwo+ID4gPiA+ID4gPiA+ICAgICAgIHJldCA9IHZx
LT5wYWNrZWQuZGVzY19zdGF0ZVtpZF0uZGF0YTsKPiA+ID4gPiA+ID4gPiBAQCAtMTkzNyw2ICsy
MDAzLDcgQEAgc3RhdGljIHZvaWQgdnJpbmdfZnJlZV9wYWNrZWQoc3RydWN0IHZyaW5nX3ZpcnRx
dWV1ZV9wYWNrZWQgKnZyaW5nX3BhY2tlZCwKPiA+ID4gPiA+ID4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdnJpbmdfcGFja2VkLT5kZXZpY2VfZXZlbnRfZG1hX2FkZHIsCj4gPiA+
ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRtYV9kZXYpOwo+ID4gPiA+
ID4gPiA+Cj4gPiA+ID4gPiA+ID4gKyAgICAga2ZyZWUodnJpbmdfcGFja2VkLT5idWZsZW4pOwo+
ID4gPiA+ID4gPiA+ICAgICAgIGtmcmVlKHZyaW5nX3BhY2tlZC0+ZGVzY19zdGF0ZSk7Cj4gPiA+
ID4gPiA+ID4gICAgICAga2ZyZWUodnJpbmdfcGFja2VkLT5kZXNjX2V4dHJhKTsKPiA+ID4gPiA+
ID4gPiAgfQo+ID4gPiA+ID4gPiA+IEBAIC0xOTg4LDYgKzIwNTUsMTQgQEAgc3RhdGljIGludCB2
cmluZ19hbGxvY19xdWV1ZV9wYWNrZWQoc3RydWN0IHZyaW5nX3ZpcnRxdWV1ZV9wYWNrZWQgKnZy
aW5nX3BhY2tlZCwKPiA+ID4gPiA+ID4gPgo+ID4gPiA+ID4gPiA+ICAgICAgIHZyaW5nX3BhY2tl
ZC0+dnJpbmcubnVtID0gbnVtOwo+ID4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ID4gKyAgICAgaWYg
KHZyaW5nX25lZWRzX3VzZWRfdmFsaWRhdGlvbih2ZGV2KSkgewo+ID4gPiA+ID4gPiA+ICsgICAg
ICAgICAgICAgdnJpbmdfcGFja2VkLT5idWZsZW4gPQo+ID4gPiA+ID4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICBrbWFsbG9jX2FycmF5KG51bSwgc2l6ZW9mKCp2cmluZ19wYWNrZWQtPmJ1Zmxl
biksCj4gPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR0ZQ
X0tFUk5FTCk7Cj4gPiA+ID4gPiA+ID4gKyAgICAgICAgICAgICBpZiAoIXZyaW5nX3BhY2tlZC0+
YnVmbGVuKQo+ID4gPiA+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycjsKPiA+
ID4gPiA+ID4gPiArICAgICB9Cj4gPiA+ID4gPiA+ID4gKwo+ID4gPiA+ID4gPiA+ICAgICAgIHJl
dHVybiAwOwo+ID4gPiA+ID4gPiA+Cj4gPiA+ID4gPiA+ID4gIGVycjoKPiA+ID4gPiA+ID4gPiAt
LQo+ID4gPiA+ID4gPiA+IDIuMjUuMQo+ID4gPiA+ID4gPgo+ID4gPiA+Cj4gPgoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFp
bGluZyBsaXN0ClZpcnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBz
Oi8vbGlzdHMubGludXhmb3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0
aW9u
