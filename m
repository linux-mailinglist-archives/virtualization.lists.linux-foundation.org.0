Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp2.osuosl.org (smtp2.osuosl.org [140.211.166.133])
	by mail.lfdr.de (Postfix) with ESMTPS id 56E116D3BDE
	for <lists.virtualization@lfdr.de>; Mon,  3 Apr 2023 04:43:25 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp2.osuosl.org (Postfix) with ESMTP id 1FAEC40441;
	Mon,  3 Apr 2023 02:43:23 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 1FAEC40441
Authentication-Results: smtp2.osuosl.org;
	dkim=fail reason="signature verification failed" (1024-bit key) header.d=redhat.com header.i=@redhat.com header.a=rsa-sha256 header.s=mimecast20190719 header.b=eKj3Lul7
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
	by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id mRt9SbU8TwBk; Mon,  3 Apr 2023 02:43:22 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp2.osuosl.org (Postfix) with ESMTPS id 89526403F8;
	Mon,  3 Apr 2023 02:43:21 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 89526403F8
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id A70C1C002F;
	Mon,  3 Apr 2023 02:43:20 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp1.osuosl.org (smtp1.osuosl.org [IPv6:2605:bc80:3010::138])
 by lists.linuxfoundation.org (Postfix) with ESMTP id B937AC002F
 for <virtualization@lists.linux-foundation.org>;
 Mon,  3 Apr 2023 02:43:18 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp1.osuosl.org (Postfix) with ESMTP id 9372C81E6D
 for <virtualization@lists.linux-foundation.org>;
 Mon,  3 Apr 2023 02:43:18 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org 9372C81E6D
Authentication-Results: smtp1.osuosl.org;
 dkim=pass (1024-bit key) header.d=redhat.com header.i=@redhat.com
 header.a=rsa-sha256 header.s=mimecast20190719 header.b=eKj3Lul7
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp1.osuosl.org ([127.0.0.1])
 by localhost (smtp1.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id G5OgUVmGmSrl
 for <virtualization@lists.linux-foundation.org>;
 Mon,  3 Apr 2023 02:43:17 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org 7D1DA81E6C
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.129.124])
 by smtp1.osuosl.org (Postfix) with ESMTPS id 7D1DA81E6C
 for <virtualization@lists.linux-foundation.org>;
 Mon,  3 Apr 2023 02:43:17 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1680489796;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=ObOA2IqLb9j+Mujo/CSxkURBSJ0JqojZZVbdbdnq1t0=;
 b=eKj3Lul7SMBY0ZKbGgFhPgomMDkdqpixXJM5Dve6TYY5xkWs39UDyiTfux5vLqq44kBth3
 EXD7XfICY/BxreTEA3SbxAnwt2GNqYrZKYzN5qL9cBHmf61YIW7jWDzw+EAOVOvvwCyLq3
 kxC3Q49TM8xP1T94zv/CCBnpWdsbTU4=
Received: from mail-oi1-f198.google.com (mail-oi1-f198.google.com
 [209.85.167.198]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384) id
 us-mta-145-myW0eJZaMR-uKQ6SGnsISw-1; Sun, 02 Apr 2023 22:43:15 -0400
X-MC-Unique: myW0eJZaMR-uKQ6SGnsISw-1
Received: by mail-oi1-f198.google.com with SMTP id
 f18-20020a05680814d200b003877ce3bfb4so6593561oiw.3
 for <virtualization@lists.linux-foundation.org>;
 Sun, 02 Apr 2023 19:43:14 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20210112; t=1680489794; x=1683081794;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
 :subject:date:message-id:reply-to;
 bh=ObOA2IqLb9j+Mujo/CSxkURBSJ0JqojZZVbdbdnq1t0=;
 b=1Z42CqHhDzOuQMXduUcp1E/XRP3uhsxjg7W2yRN45A7MCpCNyGKoahuDjEVeZvfAcV
 lD4aKyTP26BSbazFf2M53+wKqp5ih+d4tOOo0yn3dfa/EdiIQEXNcQOQIsA7qbeslTGE
 UM+HseZVnfiy+0eVlviFNGrvBDcg3NYIuc2cd11EZGmuM42UJFNZvF82dfRiEqCGJvvU
 mFQkk4idI9ZZ9/VMAUaSpc1Pnna+KJ1i/RTX9cUXEarFGdN1txtPd6g7c6UOgaIutqyt
 KjuxvOIPvH10WjiDR1AQBBIsGaB3aRJ+VmGRxLs7/lvG4LpJy2l1o0RnMkuU4mApfSdt
 JP7Q==
X-Gm-Message-State: AAQBX9erfoZ173E3MWKzG6ocplymb2/SvhYj5MFUYA9q3rWiYUIsywWj
 zIxGINHXdibdTf3tzmkcsmLUY9e3EFtda06gKlqG6jLuS8DXxoIN7BwcsuBPU0NROyP3+5YvPWN
 HkkVHnHZkEOE7J4v5xcoz+p+FbJBYgVSzx6z763stQngMlyDpvyb4ZSKGew==
X-Received: by 2002:a05:6871:4d03:b0:17d:1287:1b5c with SMTP id
 ug3-20020a0568714d0300b0017d12871b5cmr12083441oab.9.1680489794348; 
 Sun, 02 Apr 2023 19:43:14 -0700 (PDT)
X-Google-Smtp-Source: AKy350YyqOuhzFPNwcu77fb5PUarx9Z0Lg/BpGgyKARpuEIuxBuELKlbk7RcEo3HefxtfOQ5ruQYO+J8BvgF8pkQmKY=
X-Received: by 2002:a05:6871:4d03:b0:17d:1287:1b5c with SMTP id
 ug3-20020a0568714d0300b0017d12871b5cmr12083436oab.9.1680489794112; Sun, 02
 Apr 2023 19:43:14 -0700 (PDT)
MIME-Version: 1.0
References: <20230328120412.110114-1-xuanzhuo@linux.alibaba.com>
 <20230328120412.110114-4-xuanzhuo@linux.alibaba.com>
In-Reply-To: <20230328120412.110114-4-xuanzhuo@linux.alibaba.com>
From: Jason Wang <jasowang@redhat.com>
Date: Mon, 3 Apr 2023 10:43:03 +0800
Message-ID: <CACGkMEvZ=-G4QVTDnoSa1N0UspW8u_oz-7xosrXV0f1YcytVXw@mail.gmail.com>
Subject: Re: [PATCH net-next 3/8] virtio_net: introduce virtnet_xdp_handler()
 to seprate the logic of run xdp
To: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Cc: Jesper Dangaard Brouer <hawk@kernel.org>,
 Daniel Borkmann <daniel@iogearbox.net>, "Michael S. Tsirkin" <mst@redhat.com>,
 netdev@vger.kernel.org, John Fastabend <john.fastabend@gmail.com>,
 Alexei Starovoitov <ast@kernel.org>, virtualization@lists.linux-foundation.org,
 Eric Dumazet <edumazet@google.com>, Jakub Kicinski <kuba@kernel.org>,
 bpf@vger.kernel.org, Paolo Abeni <pabeni@redhat.com>,
 "David S. Miller" <davem@davemloft.net>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gVHVlLCBNYXIgMjgsIDIwMjMgYXQgODowNOKAr1BNIFh1YW4gWmh1byA8eHVhbnpodW9AbGlu
dXguYWxpYmFiYS5jb20+IHdyb3RlOgo+Cj4gQXQgcHJlc2VudCwgd2UgaGF2ZSB0d28gc2ltaWxh
ciBsb2dpYyB0byBwZXJmb3JtIHRoZSBYRFAgcHJvZy4KPgo+IFRoZXJlZm9yZSwgdGhpcyBQQVRD
SCBzZXBhcmF0ZXMgdGhlIGNvZGUgb2YgZXhlY3V0aW5nIFhEUCwgd2hpY2ggaXMKPiBjb25kdWNp
dmUgdG8gbGF0ZXIgbWFpbnRlbmFuY2UuCj4KPiBTaWduZWQtb2ZmLWJ5OiBYdWFuIFpodW8gPHh1
YW56aHVvQGxpbnV4LmFsaWJhYmEuY29tPgo+IC0tLQo+ICBkcml2ZXJzL25ldC92aXJ0aW9fbmV0
LmMgfCAxNDIgKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0tCj4gIDEgZmls
ZSBjaGFuZ2VkLCA3NSBpbnNlcnRpb25zKCspLCA2NyBkZWxldGlvbnMoLSkKPgo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL25ldC92aXJ0aW9fbmV0LmMgYi9kcml2ZXJzL25ldC92aXJ0aW9fbmV0LmMK
PiBpbmRleCBiYjQyNjk1OGNkZDQuLjcyYjlkNmVlNDAyNCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L25ldC92aXJ0aW9fbmV0LmMKPiArKysgYi9kcml2ZXJzL25ldC92aXJ0aW9fbmV0LmMKPiBAQCAt
MzAxLDYgKzMwMSwxNSBAQCBzdHJ1Y3QgcGFkZGVkX3ZuZXRfaGRyIHsKPiAgICAgICAgIGNoYXIg
cGFkZGluZ1sxMl07Cj4gIH07Cj4KPiArZW51bSB7Cj4gKyAgICAgICAvKiB4ZHAgcGFzcyAqLwo+
ICsgICAgICAgVklSVE5FVF9YRFBfUkVTX1BBU1MsCj4gKyAgICAgICAvKiBkcm9wIHBhY2tldC4g
dGhlIGNhbGxlciBuZWVkcyB0byByZWxlYXNlIHRoZSBwYWdlLiAqLwo+ICsgICAgICAgVklSVE5F
VF9YRFBfUkVTX0RST1AsCj4gKyAgICAgICAvKiBwYWNrZXQgaXMgY29uc3VtZWQgYnkgeGRwLiB0
aGUgY2FsbGVyIG5lZWRzIHRvIGRvIG5vdGhpbmcuICovCj4gKyAgICAgICBWSVJUTkVUX1hEUF9S
RVNfQ09OU1VNRUQsCj4gK307CgpJJ2QgcHJlZmVyIHRoaXMgdG8gYmUgZG9uZSBvbiB0b3AgdW5s
ZXNzIGl0IGlzIGEgbXVzdC4gQnV0IEkgZG9uJ3Qgc2VlCmFueSBhZHZhbnRhZ2Ugb2YgaW50cm9k
dWNpbmcgdGhpcywgaXQncyBwYXJ0aWFsIG1hcHBpbmcgb2YgWERQIGFjdGlvbgphbmQgaXQgbmVl
ZHMgdG8gYmUgZXh0ZW5kZWQgd2hlbiBYRFAgYWN0aW9uIGlzIGV4dGVuZGVkLiAoQW5kIHdlJ3Zl
CmFscmVhZHkgaGFkOiBWSVJUSU9fWERQX1JFRElSIGFuZCBWSVJUSU9fWERQX1RYIC4uLikKCj4g
Kwo+ICBzdGF0aWMgdm9pZCB2aXJ0bmV0X3JxX2ZyZWVfdW51c2VkX2J1ZihzdHJ1Y3QgdmlydHF1
ZXVlICp2cSwgdm9pZCAqYnVmKTsKPiAgc3RhdGljIHZvaWQgdmlydG5ldF9zcV9mcmVlX3VudXNl
ZF9idWYoc3RydWN0IHZpcnRxdWV1ZSAqdnEsIHZvaWQgKmJ1Zik7Cj4KPiBAQCAtNzg5LDYgKzc5
OCw1OSBAQCBzdGF0aWMgaW50IHZpcnRuZXRfeGRwX3htaXQoc3RydWN0IG5ldF9kZXZpY2UgKmRl
diwKPiAgICAgICAgIHJldHVybiByZXQ7Cj4gIH0KPgo+ICtzdGF0aWMgaW50IHZpcnRuZXRfeGRw
X2hhbmRsZXIoc3RydWN0IGJwZl9wcm9nICp4ZHBfcHJvZywgc3RydWN0IHhkcF9idWZmICp4ZHAs
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYs
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCAqeGRwX3htaXQs
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2aXJ0bmV0X3JxX3N0YXRz
ICpzdGF0cykKPiArewo+ICsgICAgICAgc3RydWN0IHhkcF9mcmFtZSAqeGRwZjsKPiArICAgICAg
IGludCBlcnI7Cj4gKyAgICAgICB1MzIgYWN0Owo+ICsKPiArICAgICAgIGFjdCA9IGJwZl9wcm9n
X3J1bl94ZHAoeGRwX3Byb2csIHhkcCk7Cj4gKyAgICAgICBzdGF0cy0+eGRwX3BhY2tldHMrKzsK
PiArCj4gKyAgICAgICBzd2l0Y2ggKGFjdCkgewo+ICsgICAgICAgY2FzZSBYRFBfUEFTUzoKPiAr
ICAgICAgICAgICAgICAgcmV0dXJuIFZJUlRORVRfWERQX1JFU19QQVNTOwo+ICsKPiArICAgICAg
IGNhc2UgWERQX1RYOgo+ICsgICAgICAgICAgICAgICBzdGF0cy0+eGRwX3R4Kys7Cj4gKyAgICAg
ICAgICAgICAgIHhkcGYgPSB4ZHBfY29udmVydF9idWZmX3RvX2ZyYW1lKHhkcCk7Cj4gKyAgICAg
ICAgICAgICAgIGlmICh1bmxpa2VseSgheGRwZikpCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
cmV0dXJuIFZJUlRORVRfWERQX1JFU19EUk9QOwo+ICsKPiArICAgICAgICAgICAgICAgZXJyID0g
dmlydG5ldF94ZHBfeG1pdChkZXYsIDEsICZ4ZHBmLCAwKTsKPiArICAgICAgICAgICAgICAgaWYg
KHVubGlrZWx5KCFlcnIpKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgeGRwX3JldHVybl9m
cmFtZV9yeF9uYXBpKHhkcGYpOwo+ICsgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5
KGVyciA8IDApKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgdHJhY2VfeGRwX2V4Y2VwdGlv
bihkZXYsIHhkcF9wcm9nLCBhY3QpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBW
SVJUTkVUX1hEUF9SRVNfRFJPUDsKPiArICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAg
ICAgICAgKnhkcF94bWl0IHw9IFZJUlRJT19YRFBfVFg7Cj4gKyAgICAgICAgICAgICAgIHJldHVy
biBWSVJUTkVUX1hEUF9SRVNfQ09OU1VNRUQ7Cj4gKwo+ICsgICAgICAgY2FzZSBYRFBfUkVESVJF
Q1Q6Cj4gKyAgICAgICAgICAgICAgIHN0YXRzLT54ZHBfcmVkaXJlY3RzKys7Cj4gKyAgICAgICAg
ICAgICAgIGVyciA9IHhkcF9kb19yZWRpcmVjdChkZXYsIHhkcCwgeGRwX3Byb2cpOwo+ICsgICAg
ICAgICAgICAgICBpZiAoZXJyKQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBWSVJU
TkVUX1hEUF9SRVNfRFJPUDsKPiArCj4gKyAgICAgICAgICAgICAgICp4ZHBfeG1pdCB8PSBWSVJU
SU9fWERQX1JFRElSOwo+ICsgICAgICAgICAgICAgICByZXR1cm4gVklSVE5FVF9YRFBfUkVTX0NP
TlNVTUVEOwo+ICsKPiArICAgICAgIGRlZmF1bHQ6Cj4gKyAgICAgICAgICAgICAgIGJwZl93YXJu
X2ludmFsaWRfeGRwX2FjdGlvbihkZXYsIHhkcF9wcm9nLCBhY3QpOwo+ICsgICAgICAgICAgICAg
ICBmYWxsdGhyb3VnaDsKPiArICAgICAgIGNhc2UgWERQX0FCT1JURUQ6Cj4gKyAgICAgICAgICAg
ICAgIHRyYWNlX3hkcF9leGNlcHRpb24oZGV2LCB4ZHBfcHJvZywgYWN0KTsKPiArICAgICAgICAg
ICAgICAgZmFsbHRocm91Z2g7Cj4gKyAgICAgICBjYXNlIFhEUF9EUk9QOgo+ICsgICAgICAgICAg
ICAgICByZXR1cm4gVklSVE5FVF9YRFBfUkVTX0RST1A7Cj4gKyAgICAgICB9Cj4gK30KPiArCj4g
IHN0YXRpYyB1bnNpZ25lZCBpbnQgdmlydG5ldF9nZXRfaGVhZHJvb20oc3RydWN0IHZpcnRuZXRf
aW5mbyAqdmkpCj4gIHsKPiAgICAgICAgIHJldHVybiB2aS0+eGRwX2VuYWJsZWQgPyBWSVJUSU9f
WERQX0hFQURST09NIDogMDsKPiBAQCAtODc2LDcgKzkzOCw2IEBAIHN0YXRpYyBzdHJ1Y3Qgc2tf
YnVmZiAqcmVjZWl2ZV9zbWFsbChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ICAgICAgICAgc3Ry
dWN0IHBhZ2UgKnBhZ2UgPSB2aXJ0X3RvX2hlYWRfcGFnZShidWYpOwo+ICAgICAgICAgdW5zaWdu
ZWQgaW50IGRlbHRhID0gMDsKPiAgICAgICAgIHN0cnVjdCBwYWdlICp4ZHBfcGFnZTsKPiAtICAg
ICAgIGludCBlcnI7Cj4gICAgICAgICB1bnNpZ25lZCBpbnQgbWV0YXNpemUgPSAwOwo+Cj4gICAg
ICAgICBsZW4gLT0gdmktPmhkcl9sZW47Cj4gQEAgLTg5OCw3ICs5NTksNiBAQCBzdGF0aWMgc3Ry
dWN0IHNrX2J1ZmYgKnJlY2VpdmVfc21hbGwoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiAgICAg
ICAgIHhkcF9wcm9nID0gcmN1X2RlcmVmZXJlbmNlKHJxLT54ZHBfcHJvZyk7Cj4gICAgICAgICBp
ZiAoeGRwX3Byb2cpIHsKPiAgICAgICAgICAgICAgICAgc3RydWN0IHZpcnRpb19uZXRfaGRyX21y
Z19yeGJ1ZiAqaGRyID0gYnVmICsgaGVhZGVyX29mZnNldDsKPiAtICAgICAgICAgICAgICAgc3Ry
dWN0IHhkcF9mcmFtZSAqeGRwZjsKPiAgICAgICAgICAgICAgICAgc3RydWN0IHhkcF9idWZmIHhk
cDsKPiAgICAgICAgICAgICAgICAgdm9pZCAqb3JpZ19kYXRhOwo+ICAgICAgICAgICAgICAgICB1
MzIgYWN0Owo+IEBAIC05MzEsNDYgKzk5MSwyMiBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKnJl
Y2VpdmVfc21hbGwoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiAgICAgICAgICAgICAgICAgeGRw
X3ByZXBhcmVfYnVmZigmeGRwLCBidWYgKyBWSVJUTkVUX1JYX1BBRCArIHZpLT5oZHJfbGVuLAo+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhkcF9oZWFkcm9vbSwgbGVuLCB0cnVl
KTsKPiAgICAgICAgICAgICAgICAgb3JpZ19kYXRhID0geGRwLmRhdGE7Cj4gLSAgICAgICAgICAg
ICAgIGFjdCA9IGJwZl9wcm9nX3J1bl94ZHAoeGRwX3Byb2csICZ4ZHApOwo+IC0gICAgICAgICAg
ICAgICBzdGF0cy0+eGRwX3BhY2tldHMrKzsKPiArCj4gKyAgICAgICAgICAgICAgIGFjdCA9IHZp
cnRuZXRfeGRwX2hhbmRsZXIoeGRwX3Byb2csICZ4ZHAsIGRldiwgeGRwX3htaXQsIHN0YXRzKTsK
Pgo+ICAgICAgICAgICAgICAgICBzd2l0Y2ggKGFjdCkgewo+IC0gICAgICAgICAgICAgICBjYXNl
IFhEUF9QQVNTOgo+ICsgICAgICAgICAgICAgICBjYXNlIFZJUlRORVRfWERQX1JFU19QQVNTOgo+
ICAgICAgICAgICAgICAgICAgICAgICAgIC8qIFJlY2FsY3VsYXRlIGxlbmd0aCBpbiBjYXNlIGJw
ZiBwcm9ncmFtIGNoYW5nZWQgaXQgKi8KPiAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YSA9
IG9yaWdfZGF0YSAtIHhkcC5kYXRhOwo+ICAgICAgICAgICAgICAgICAgICAgICAgIGxlbiA9IHhk
cC5kYXRhX2VuZCAtIHhkcC5kYXRhOwo+ICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFzaXpl
ID0geGRwLmRhdGEgLSB4ZHAuZGF0YV9tZXRhOwo+ICAgICAgICAgICAgICAgICAgICAgICAgIGJy
ZWFrOwo+IC0gICAgICAgICAgICAgICBjYXNlIFhEUF9UWDoKPiAtICAgICAgICAgICAgICAgICAg
ICAgICBzdGF0cy0+eGRwX3R4Kys7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgeGRwZiA9IHhk
cF9jb252ZXJ0X2J1ZmZfdG9fZnJhbWUoJnhkcCk7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAg
aWYgKHVubGlrZWx5KCF4ZHBmKSkKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdv
dG8gZXJyX3hkcDsKPiAtICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSB2aXJ0bmV0X3hkcF94
bWl0KGRldiwgMSwgJnhkcGYsIDApOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmICh1bmxp
a2VseSghZXJyKSkgewo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeGRwX3JldHVy
bl9mcmFtZV9yeF9uYXBpKHhkcGYpOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBp
ZiAodW5saWtlbHkoZXJyIDwgMCkpIHsKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHRyYWNlX3hkcF9leGNlcHRpb24odmktPmRldiwgeGRwX3Byb2csIGFjdCk7Cj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl94ZHA7Cj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgfQo+IC0gICAgICAgICAgICAgICAgICAgICAgICp4ZHBfeG1pdCB8PSBWSVJUSU9fWERQ
X1RYOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIHJjdV9yZWFkX3VubG9jaygpOwo+IC0gICAg
ICAgICAgICAgICAgICAgICAgIGdvdG8geGRwX3htaXQ7Cj4gLSAgICAgICAgICAgICAgIGNhc2Ug
WERQX1JFRElSRUNUOgo+IC0gICAgICAgICAgICAgICAgICAgICAgIHN0YXRzLT54ZHBfcmVkaXJl
Y3RzKys7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgZXJyID0geGRwX2RvX3JlZGlyZWN0KGRl
diwgJnhkcCwgeGRwX3Byb2cpOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpCj4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl94ZHA7Cj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgKnhkcF94bWl0IHw9IFZJUlRJT19YRFBfUkVESVI7Cj4gKwo+ICsgICAg
ICAgICAgICAgICBjYXNlIFZJUlRORVRfWERQX1JFU19DT05TVU1FRDoKPiAgICAgICAgICAgICAg
ICAgICAgICAgICByY3VfcmVhZF91bmxvY2soKTsKPiAgICAgICAgICAgICAgICAgICAgICAgICBn
b3RvIHhkcF94bWl0Owo+IC0gICAgICAgICAgICAgICBkZWZhdWx0Ogo+IC0gICAgICAgICAgICAg
ICAgICAgICAgIGJwZl93YXJuX2ludmFsaWRfeGRwX2FjdGlvbih2aS0+ZGV2LCB4ZHBfcHJvZywg
YWN0KTsKPiAtICAgICAgICAgICAgICAgICAgICAgICBmYWxsdGhyb3VnaDsKPiAtICAgICAgICAg
ICAgICAgY2FzZSBYRFBfQUJPUlRFRDoKPiAtICAgICAgICAgICAgICAgICAgICAgICB0cmFjZV94
ZHBfZXhjZXB0aW9uKHZpLT5kZXYsIHhkcF9wcm9nLCBhY3QpOwo+IC0gICAgICAgICAgICAgICAg
ICAgICAgIGdvdG8gZXJyX3hkcDsKPiAtICAgICAgICAgICAgICAgY2FzZSBYRFBfRFJPUDoKPiAr
Cj4gKyAgICAgICAgICAgICAgIGNhc2UgVklSVE5FVF9YRFBfUkVTX0RST1A6Cj4gICAgICAgICAg
ICAgICAgICAgICAgICAgZ290byBlcnJfeGRwOwo+ICAgICAgICAgICAgICAgICB9Cj4gICAgICAg
ICB9Cj4gQEAgLTEyNzcsNyArMTMxMyw2IEBAIHN0YXRpYyBzdHJ1Y3Qgc2tfYnVmZiAqcmVjZWl2
ZV9tZXJnZWFibGUoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiAgICAgICAgIGlmICh4ZHBfcHJv
Zykgewo+ICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgeGRwX2ZyYWdzX3RydWVzeiA9IDA7
Cj4gICAgICAgICAgICAgICAgIHN0cnVjdCBza2Jfc2hhcmVkX2luZm8gKnNoaW5mbzsKPiAtICAg
ICAgICAgICAgICAgc3RydWN0IHhkcF9mcmFtZSAqeGRwZjsKPiAgICAgICAgICAgICAgICAgc3Ry
dWN0IHBhZ2UgKnhkcF9wYWdlOwo+ICAgICAgICAgICAgICAgICBzdHJ1Y3QgeGRwX2J1ZmYgeGRw
Owo+ICAgICAgICAgICAgICAgICB2b2lkICpkYXRhOwo+IEBAIC0xMjk0LDQ5ICsxMzI5LDIyIEBA
IHN0YXRpYyBzdHJ1Y3Qgc2tfYnVmZiAqcmVjZWl2ZV9tZXJnZWFibGUoc3RydWN0IG5ldF9kZXZp
Y2UgKmRldiwKPiAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KGVycikpCj4gICAgICAgICAg
ICAgICAgICAgICAgICAgZ290byBlcnJfeGRwX2ZyYWdzOwo+Cj4gLSAgICAgICAgICAgICAgIGFj
dCA9IGJwZl9wcm9nX3J1bl94ZHAoeGRwX3Byb2csICZ4ZHApOwo+IC0gICAgICAgICAgICAgICBz
dGF0cy0+eGRwX3BhY2tldHMrKzsKPiArICAgICAgICAgICAgICAgYWN0ID0gdmlydG5ldF94ZHBf
aGFuZGxlcih4ZHBfcHJvZywgJnhkcCwgZGV2LCB4ZHBfeG1pdCwgc3RhdHMpOwo+Cj4gICAgICAg
ICAgICAgICAgIHN3aXRjaCAoYWN0KSB7Cj4gLSAgICAgICAgICAgICAgIGNhc2UgWERQX1BBU1M6
Cj4gKyAgICAgICAgICAgICAgIGNhc2UgVklSVE5FVF9YRFBfUkVTX1BBU1M6Cj4gICAgICAgICAg
ICAgICAgICAgICAgICAgaGVhZF9za2IgPSBidWlsZF9za2JfZnJvbV94ZHBfYnVmZihkZXYsIHZp
LCAmeGRwLCB4ZHBfZnJhZ3NfdHJ1ZXN6KTsKPiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAo
dW5saWtlbHkoIWhlYWRfc2tiKSkKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdv
dG8gZXJyX3hkcF9mcmFnczsKPgo+ICAgICAgICAgICAgICAgICAgICAgICAgIHJjdV9yZWFkX3Vu
bG9jaygpOwo+ICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBoZWFkX3NrYjsKPiAtICAg
ICAgICAgICAgICAgY2FzZSBYRFBfVFg6Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgc3RhdHMt
PnhkcF90eCsrOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIHhkcGYgPSB4ZHBfY29udmVydF9i
dWZmX3RvX2ZyYW1lKCZ4ZHApOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2Vs
eSgheGRwZikpIHsKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9kYmco
ZGV2LCAiY29udmVydCBidWZmIHRvIGZyYW1lIGZhaWxlZCBmb3IgeGRwXG4iKTsKCk5pdDogVGhp
cyBkZWJ1ZyBpcyBsb3N0IGFmdGVyIHRoZSBjb252ZXJzaW9uLgoKVGhhbmtzCgo+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgZ290byBlcnJfeGRwX2ZyYWdzOwo+IC0gICAgICAgICAg
ICAgICAgICAgICAgIH0KPiAtICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSB2aXJ0bmV0X3hk
cF94bWl0KGRldiwgMSwgJnhkcGYsIDApOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmICh1
bmxpa2VseSghZXJyKSkgewo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeGRwX3Jl
dHVybl9mcmFtZV9yeF9uYXBpKHhkcGYpOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIH0gZWxz
ZSBpZiAodW5saWtlbHkoZXJyIDwgMCkpIHsKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHRyYWNlX3hkcF9leGNlcHRpb24odmktPmRldiwgeGRwX3Byb2csIGFjdCk7Cj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl94ZHBfZnJhZ3M7Cj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgfQo+IC0gICAgICAgICAgICAgICAgICAgICAgICp4ZHBfeG1pdCB8PSBW
SVJUSU9fWERQX1RYOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIHJjdV9yZWFkX3VubG9jaygp
Owo+IC0gICAgICAgICAgICAgICAgICAgICAgIGdvdG8geGRwX3htaXQ7Cj4gLSAgICAgICAgICAg
ICAgIGNhc2UgWERQX1JFRElSRUNUOgo+IC0gICAgICAgICAgICAgICAgICAgICAgIHN0YXRzLT54
ZHBfcmVkaXJlY3RzKys7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgZXJyID0geGRwX2RvX3Jl
ZGlyZWN0KGRldiwgJnhkcCwgeGRwX3Byb2cpOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIGlm
IChlcnIpCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl94ZHBfZnJh
Z3M7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgKnhkcF94bWl0IHw9IFZJUlRJT19YRFBfUkVE
SVI7Cj4gKwo+ICsgICAgICAgICAgICAgICBjYXNlIFZJUlRORVRfWERQX1JFU19DT05TVU1FRDoK
PiAgICAgICAgICAgICAgICAgICAgICAgICByY3VfcmVhZF91bmxvY2soKTsKPiAgICAgICAgICAg
ICAgICAgICAgICAgICBnb3RvIHhkcF94bWl0Owo+IC0gICAgICAgICAgICAgICBkZWZhdWx0Ogo+
IC0gICAgICAgICAgICAgICAgICAgICAgIGJwZl93YXJuX2ludmFsaWRfeGRwX2FjdGlvbih2aS0+
ZGV2LCB4ZHBfcHJvZywgYWN0KTsKPiAtICAgICAgICAgICAgICAgICAgICAgICBmYWxsdGhyb3Vn
aDsKPiAtICAgICAgICAgICAgICAgY2FzZSBYRFBfQUJPUlRFRDoKPiAtICAgICAgICAgICAgICAg
ICAgICAgICB0cmFjZV94ZHBfZXhjZXB0aW9uKHZpLT5kZXYsIHhkcF9wcm9nLCBhY3QpOwo+IC0g
ICAgICAgICAgICAgICAgICAgICAgIGZhbGx0aHJvdWdoOwo+IC0gICAgICAgICAgICAgICBjYXNl
IFhEUF9EUk9QOgo+ICsKPiArICAgICAgICAgICAgICAgY2FzZSBWSVJUTkVUX1hEUF9SRVNfRFJP
UDoKPiAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl94ZHBfZnJhZ3M7Cj4gICAgICAg
ICAgICAgICAgIH0KPiAgZXJyX3hkcF9mcmFnczoKPiAtLQo+IDIuMzIuMC4zLmcwMTE5NWNmOWYK
PgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KVmlydHVh
bGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRp
b24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L3ZpcnR1YWxpemF0aW9u
