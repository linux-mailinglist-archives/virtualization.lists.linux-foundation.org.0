Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp4.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 3C476395569
	for <lists.virtualization@lfdr.de>; Mon, 31 May 2021 08:24:25 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp4.osuosl.org (Postfix) with ESMTP id B3E794036E;
	Mon, 31 May 2021 06:24:23 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
	by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id Ia6_Q3yO28BS; Mon, 31 May 2021 06:24:22 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp4.osuosl.org (Postfix) with ESMTP id 7849A40364;
	Mon, 31 May 2021 06:24:21 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id E522BC0001;
	Mon, 31 May 2021 06:24:20 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp1.osuosl.org (smtp1.osuosl.org [IPv6:2605:bc80:3010::138])
 by lists.linuxfoundation.org (Postfix) with ESMTP id DC363C0001
 for <virtualization@lists.linux-foundation.org>;
 Mon, 31 May 2021 06:24:19 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp1.osuosl.org (Postfix) with ESMTP id BD16783B65
 for <virtualization@lists.linux-foundation.org>;
 Mon, 31 May 2021 06:24:19 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Authentication-Results: smtp1.osuosl.org (amavisd-new);
 dkim=pass (1024-bit key) header.d=redhat.com
Received: from smtp1.osuosl.org ([127.0.0.1])
 by localhost (smtp1.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id kEKzeKRKt3LQ
 for <virtualization@lists.linux-foundation.org>;
 Mon, 31 May 2021 06:24:18 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.133.124])
 by smtp1.osuosl.org (Postfix) with ESMTPS id 53F9E83A93
 for <virtualization@lists.linux-foundation.org>;
 Mon, 31 May 2021 06:24:18 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1622442256;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=W+8j1b1z6wltE6CiAVVhAaaRW8HDkHYVl9SyEnddbzQ=;
 b=SPiTKKWhQUxbznVxVCpr/QHaMdsgIrTHAaDy9DC+Y6tyPhpl/jj7DWJoexXbcwrI95b3/s
 IXmYn2Ju5Ouem4OIAZfeFiDK5t28mXN6j3zXZ9e3jUfru7t9btWrgcnKd3Gn/xN2yvEKaM
 8ij7q/EsWpwnwFl+Rnfyu3B7RBH/pEs=
Received: from mail-pf1-f198.google.com (mail-pf1-f198.google.com
 [209.85.210.198]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-174-48vsNir6NAamddF-yTLkbw-1; Mon, 31 May 2021 02:24:13 -0400
X-MC-Unique: 48vsNir6NAamddF-yTLkbw-1
Received: by mail-pf1-f198.google.com with SMTP id
 v22-20020aa785160000b02902ddbe7f56bdso5414238pfn.12
 for <virtualization@lists.linux-foundation.org>;
 Sun, 30 May 2021 23:24:12 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:subject:to:cc:references:from:message-id:date
 :user-agent:mime-version:in-reply-to:content-transfer-encoding
 :content-language;
 bh=W+8j1b1z6wltE6CiAVVhAaaRW8HDkHYVl9SyEnddbzQ=;
 b=P3Co7B235SiagxIjL9nlErwfGH9L09mGkjUUzXmPRecWcZF/nshKG1AyScGFqeTilU
 jSMrUd6uNTAgf19PLiWorQjXsVyxA25ou5xk60bCAJjdLG/Zm0GVL+cmPLlowOQJvsmV
 Fc64th0B2tyKHgqM44EpOmgKqvfI2X/IyBOUDhIqaxqTK0HXXfFWNCm2N9+Xd0peNBKD
 wFupjyXm9elRSr/hr5R/XIFe8kCDWeA03Cxkj9oaFHIvwY2XmDeVd6clQDylLIlOfznA
 tR5z7vdyY5MEg7oYDffl7XKeL2PEXPXOayVlNZPLc7I8whScCIpJhDoW6vh8bVcmV/6y
 apEw==
X-Gm-Message-State: AOAM531bYK2ZJ3TNBjoJAh66djJafqw9bTC75DSpvjw4TqqVHIpePPRe
 mGQBkOg4Ly2Q7p/RrEcGF+n1J/wHcTcBgbjyALhhbidmLO0/75LGdWOen4fsHJ0pL1m+EzXc1Zt
 CVvWRV6RsygrZWORWYfwefWDRh2kpwdNEnFD+By25hw==
X-Received: by 2002:a63:5b4f:: with SMTP id l15mr3630106pgm.159.1622442251817; 
 Sun, 30 May 2021 23:24:11 -0700 (PDT)
X-Google-Smtp-Source: ABdhPJywcY1f0MI8aMzVw8gIP2OB7ZSk4vo+0lUL9EzZzdoWZ8//8ViWjXUZpA7acm9CrCWnEztNVg==
X-Received: by 2002:a63:5b4f:: with SMTP id l15mr3630072pgm.159.1622442251450; 
 Sun, 30 May 2021 23:24:11 -0700 (PDT)
Received: from wangxiaodeMacBook-Air.local ([209.132.188.80])
 by smtp.gmail.com with ESMTPSA id o17sm9680718pjp.33.2021.05.30.23.24.05
 (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
 Sun, 30 May 2021 23:24:10 -0700 (PDT)
Subject: Re: [PATCH net-next] virtio-net: Refactor the code related to
 page_to_skb()
To: Xuan Zhuo <xuanzhuo@linux.alibaba.com>, netdev@vger.kernel.org
References: <20210519090019.1489-1-xuanzhuo@linux.alibaba.com>
From: Jason Wang <jasowang@redhat.com>
Message-ID: <8097883a-5775-a270-8ea6-7f2708908515@redhat.com>
Date: Mon, 31 May 2021 14:24:00 +0800
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:78.0)
 Gecko/20100101 Thunderbird/78.10.2
MIME-Version: 1.0
In-Reply-To: <20210519090019.1489-1-xuanzhuo@linux.alibaba.com>
Authentication-Results: relay.mimecast.com;
 auth=pass smtp.auth=CUSA124A263 smtp.mailfrom=jasowang@redhat.com
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Content-Language: en-US
Cc: Song Liu <songliubraving@fb.com>, Martin KaFai Lau <kafai@fb.com>,
 Jesper Dangaard Brouer <hawk@kernel.org>,
 Daniel Borkmann <daniel@iogearbox.net>, "Michael S. Tsirkin" <mst@redhat.com>,
 John Fastabend <john.fastabend@gmail.com>, Alexei Starovoitov <ast@kernel.org>,
 Andrii Nakryiko <andrii@kernel.org>, Yonghong Song <yhs@fb.com>,
 KP Singh <kpsingh@kernel.org>, Jakub Kicinski <kuba@kernel.org>,
 bpf@vger.kernel.org, virtualization@lists.linux-foundation.org,
 "David S. Miller" <davem@davemloft.net>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="gbk"; Format="flowed"
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

CtTaIDIwMjEvNS8xOSDPws7nNTowMCwgWHVhbiBaaHVvINC0tcA6Cj4gRHVlIHRvIGxvbmctdGVy
bSBkZXZlbG9wbWVudCwgdGhlIGN1cnJlbnQgY29kZSBzdHJ1Y3R1cmUgb2YKPiBwYWdlX3RvX3Nr
YigpIGFuZCB0aGUgc2VtYW50aWMgZXhwcmVzc2lvbiBvZiB2YXJpYWJsZXMgYXJlIHJhdGhlcgo+
IGNoYW90aWMsIHNvIGl0IGlzIG5lY2Vzc2FyeSB0byByZWNvbnN0cnVjdCB0aGlzIHBpZWNlIG9m
IGxvZ2ljLgo+Cj4gVGhlIGNvZGUgaGFzIGJlZW4gdGVzdGVkIHdpdGggdGhlIGZvbGxvd2luZyB0
ZXN0IGNvZGUuCj4gQ2FsbCB0ZXN0X21lcmdlIGFuZCB0ZXN0X2JpZyB0byB0ZXN0ICJtZXJnZSIg
YW5kICJiaWciIG1vZGVzCj4gcmVzcGVjdGl2ZWx5Lgo+Cj4gPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09IHRlc3Quc2ggPT09PT09PT09PT09PT09PT09PT09PT09Cj4gZnVuY3Rpb24g
dGVzdCgpCj4gewo+ICAgICAgZmxhZz0kMQo+ICAgICAgbWF4PSQyCj4gICAgICBpbmM9JDMKPiAg
ICAgIGlmIFsgIngkbWF4IiA9PSAieCIgXQo+ICAgICAgdGhlbgo+ICAgICAgICAgIG1heD00MDk2
Cj4gICAgICBmaQo+ICAgICAgZWNobyAkbWF4Cj4KPiAgICAgIGZvciBzIGluICQoc2VxIDY0ICRp
bmMgJG1heCkKPiAgICAgIGRvCj4gICAgICAgICAgZWNobyA+PiBsb2cKPiAgICAgICAgICBlY2hv
ICRmbGFnIDpVRFBfU1RSRUFNICRzID4+IGxvZwo+ICAgICAgICAgIG5ldHBlcmYgLUggMTkyLjE2
OC4xMjIuMjAyIC1sIDUgLXQgVURQX1NUUkVBTSAtLSAtbSAkcyA+PiBsb2cKPiAgICAgICAgICBl
Y2hvICRmbGFnIDpVRFBfU1RSRUFNICRzICQ/Cj4gICAgICBkb25lCj4KPiAgICAgIGZvciBzIGlu
ICQoc2VxIDY0ICRpbmMgJG1heCkKPiAgICAgIGRvCj4gICAgICAgICAgZWNobyA+PiBsb2cKPiAg
ICAgICAgICBlY2hvICRmbGFnIDpUQ1BfU1RSRUFNICRzID4+IGxvZwo+ICAgICAgICAgIG5ldHBl
cmYgLUggMTkyLjE2OC4xMjIuMjAyIC1sIDUgLXQgVENQX1NUUkVBTSAtLSAtbSAkcyA+PiBsb2cK
PiAgICAgICAgICBlY2hvICRmbGFnIDpUQ1BfU1RSRUFNICRzICQ/Cj4gICAgICBkb25lCj4gfQo+
Cj4gZnVuY3Rpb24gdGVzdF9tZXJnZSgpCj4gewo+ICAgICAgWERQPSduby14ZHAnCj4KPiAgICAg
IHNzaCByb290QDE5Mi4xNjguMTIyLjIwMiBpcCBsaW5rIHNldCBkZXYgZXRoMCB4ZHAgb2ZmCj4g
ICAgICB0ZXN0ICRYRFAKPgo+ICAgICAgWERQPSd4ZHAtcGFzcycKPgo+ICAgICAgc3NoIHJvb3RA
MTkyLjE2OC4xMjIuMjAyIGlwIGxpbmsgc2V0IGRldiBldGgwIHhkcCBvZmYKPiAgICAgIHNzaCBy
b290QDE5Mi4xNjguMTIyLjIwMiBpcCBsaW5rIHNldCBkZXYgZXRoMCB4ZHAgb2JqZWN0IHhkcC5v
IHNlYyB4ZHAKPiAgICAgIHRlc3QgJFhEUAo+Cj4gICAgICBYRFA9J3hkcC1tZXRhJwo+Cj4gICAg
ICBzc2ggcm9vdEAxOTIuMTY4LjEyMi4yMDIgaXAgbGluayBzZXQgZGV2IGV0aDAgeGRwIG9mZgo+
ICAgICAgc3NoIHJvb3RAMTkyLjE2OC4xMjIuMjAyIGlwIGxpbmsgc2V0IGRldiBldGgwIHhkcCBv
YmplY3QgeGRwX21ldGEubyBzZWMgeGRwX21hcmsKPiAgICAgIHRlc3QgJFhEUAo+IH0KPgo+IGZ1
bmN0aW9uIHRlc3RfYmlnKCkKPiB7Cj4gICAgICAjIHNldCBob3N0IG5ldCBkZXYgbXR1IHRvIDYw
MDAwCj4gICAgICB0ZXN0ICJiaWciIDUwMDAKPiAgICAgIHRlc3QgImJpZyIgNjAwMDAgMTAKPiB9
Cj4KPiBzc2ggcm9vdEAxOTIuMTY4LjEyMi4yMDIgLi9uZXRzZXJ2ZXIKPiBlY2hvICcnID4gbG9n
Cj4KPiB0ZXN0X21lcmdlICMgb3IgdGVzdF9iaWcKPiA9PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09IHhkcC5jID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQo+Cj4gU0VD
KCJ4ZHAiKQo+IGludCBfeGRwKHN0cnVjdCB4ZHBfbWQgKnhkcCkKPiB7Cj4gICAgICAgICAgcmV0
dXJuIFhEUF9QQVNTOwo+IH0KPgo+IGNoYXIgX2xpY2Vuc2VbXSBTRUMoImxpY2Vuc2UiKSA9ICJH
UEwiOwo+Cj4gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSB4ZHBfbWV0YS5jID09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQo+Cj4gc3RhdGljIGxvbmcgKCpicGZfeGRw
X2FkanVzdF9tZXRhKShzdHJ1Y3QgeGRwX21kICp4ZHBfbWQsIGludCBkZWx0YSkgPSAodm9pZCAq
KSA1NDsKPgo+IHN0cnVjdCBtZXRhX2luZm8gewo+ICAgICAgICAgIF9fdTMyIG1hcms7Cj4gfSBf
X2F0dHJpYnV0ZV9fKChhbGlnbmVkKDQpKSk7Cj4KPiBTRUMoInhkcF9tYXJrIikKPiBpbnQgX3hk
cF9tYXJrKHN0cnVjdCB4ZHBfbWQgKmN0eCkKPiB7Cj4gICAgICAgICAgc3RydWN0IG1ldGFfaW5m
byAqbWV0YTsKPiAgICAgICAgICB2b2lkICpkYXRhLCAqZGF0YV9lbmQ7Cj4gICAgICAgICAgaW50
IHJldDsKPgo+ICAgICAgICAgIHJldCA9IGJwZl94ZHBfYWRqdXN0X21ldGEoY3R4LCAtKGludClz
aXplb2YoKm1ldGEpKTsKPiAgICAgICAgICBpZiAocmV0IDwgMCkKPiAgICAgICAgICAgICAgICAg
IHJldHVybiBYRFBfQUJPUlRFRDsKPgo+ICAgICAgICAgIGRhdGEgPSAodm9pZCAqKSh1bnNpZ25l
ZCBsb25nKWN0eC0+ZGF0YTsKPgo+ICAgICAgICAgIC8qIENoZWNrIGRhdGFfbWV0YSBoYXZlIHJv
b20gZm9yIG1ldGFfaW5mbyBzdHJ1Y3QgKi8KPiAgICAgICAgICBtZXRhID0gKHZvaWQgKikodW5z
aWduZWQgbG9uZyljdHgtPmRhdGFfbWV0YTsKPiAgICAgICAgICBpZiAoKHZvaWQgKikobWV0YSAr
IDEpID4gZGF0YSkKPiAgICAgICAgICAgICAgICAgIHJldHVybiBYRFBfQUJPUlRFRDsKPgo+ICAg
ICAgICAgIG1ldGEtPm1hcmsgPSA0MjsKPgo+ICAgICAgICAgIHJldHVybiBYRFBfUEFTUzsKPiB9
Cj4KPiBjaGFyIF9saWNlbnNlW10gU0VDKCJsaWNlbnNlIikgPSAiR1BMIjsKPiA9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
CgoKSSdtIG5vdCBzdXJlIHZpcnRpby1uZXQgbmVlZHMgc3VjaCBhIGh1Z2UgcmVmYWN0b3Jpbmcg
dGhhdCBqdXN0IGRvIHRoZSAKc2ltcGxpZmljYXRpb24gb2YgcGFyYW1ldGVycyBwYXNzaW5nIGZv
ciBwYWdlX3RvX3NrYigpLiBUaGlzIHdpbGwgCmNvbXBsaWNhdGUgc3RhYmxlIGJhY2twb3J0cyBp
biB0aGUgZnV0dXJlLgoKSSBzdXNwZWN0IGl0IG1heSBoYXZlIHBlcmZvcm1hbmNlIHJlZ3Jlc3Np
b24uCgpEbyB5b3UgaGF2ZSBhbnkgcGVyZiBudW1iZXJzPyBFLmcgcHBzLgoKVGhhbmtzCgoKPgo+
IFNpZ25lZC1vZmYtYnk6IFh1YW4gWmh1byA8eHVhbnpodW9AbGludXguYWxpYmFiYS5jb20+Cj4g
LS0tCj4gICBkcml2ZXJzL25ldC92aXJ0aW9fbmV0LmMgfCAzMDkgKysrKysrKysrKysrKysrKysr
KysrKystLS0tLS0tLS0tLS0tLS0tCj4gICAxIGZpbGUgY2hhbmdlZCwgMTg1IGluc2VydGlvbnMo
KyksIDEyNCBkZWxldGlvbnMoLSkKPgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC92aXJ0aW9f
bmV0LmMgYi9kcml2ZXJzL25ldC92aXJ0aW9fbmV0LmMKPiBpbmRleCA3ZmRhMmFlNGM0MGYuLmEx
MTdiMzQ5NjY1MyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL25ldC92aXJ0aW9fbmV0LmMKPiArKysg
Yi9kcml2ZXJzL25ldC92aXJ0aW9fbmV0LmMKPiBAQCAtMjQ5LDYgKzI0OSwzNSBAQCBzdHJ1Y3Qg
cGFkZGVkX3ZuZXRfaGRyIHsKPiAgIAljaGFyIHBhZGRpbmdbNF07Cj4gICB9Owo+ICAgCj4gK3N0
cnVjdCB2aXJ0bmV0X3BhZ2VfaW5mbyB7Cj4gKwlzdHJ1Y3QgdmlydG5ldF9pbmZvICp2aTsKPiAr
CXN0cnVjdCByZWNlaXZlX3F1ZXVlICpycTsKPiArCj4gKwkvKiB0aGlzIG1heSBiZSB0aGUgaGVh
ZF9wYWdlLCBidWYgbm90IHN0YXJ0cyB3aXRoIHRoaXMgcGFnZSAqLwo+ICsJc3RydWN0IHBhZ2Ug
KnBhZ2U7Cj4gKwo+ICsJLyogdGhlIGFsbGNhdGVkIGJ1Zi4gdGhpcyBtYXkgcG9pbnQgdG8gdGhl
IGhlYWRyb29tICovCj4gKwljaGFyICpidWY7Cj4gKwo+ICsJLyogdGhlIHNpemUgb2YgdGhlIGJ1
ZiAqLwo+ICsJdW5zaWduZWQgaW50IGJ1Zl9zaXplOwo+ICsKPiArCS8qIE9VVC4gdGhlIG9mZnNl
dCBvZiB0aGUgcmVtYWluaW5nIGRhdGEgaW4gdGhlIHBhZ2UgKi8KPiArCXVuc2lnbmVkIGludCBv
ZmZzZXQ7Cj4gKwo+ICsJY2hhciAqdmlydG5ldF9oZHI7Cj4gKwo+ICsJLyogcGFja2V0IGRhdGEu
IGdlbmVyYWxseSBwb2ludCB0byBldGggaGVhZGVyICovCj4gKwljaGFyICpwYWNrZXQ7Cj4gKwo+
ICsJLyogSU4uIHBhY2tldCBsZW4gd2l0aG91dCB2aXJ0bmV0IGhkcgo+ICsJICogT1VULiB0aGUg
c2l6ZSBvZiB0aGUgcmVtYWluaW5nIGRhdGEKPiArCSAqLwo+ICsJdW5zaWduZWQgaW50IGxlbjsK
PiArCj4gKwl1bnNpZ25lZCBpbnQgbWV0YXNpemU7Cj4gK307Cj4gKwo+ICAgc3RhdGljIGJvb2wg
aXNfeGRwX2ZyYW1lKHZvaWQgKnB0cikKPiAgIHsKPiAgIAlyZXR1cm4gKHVuc2lnbmVkIGxvbmcp
cHRyICYgVklSVElPX1hEUF9GTEFHOwo+IEBAIC0zNTcsNiArMzg2LDg5IEBAIHN0YXRpYyB2b2lk
IHNrYl94bWl0X2RvbmUoc3RydWN0IHZpcnRxdWV1ZSAqdnEpCj4gICAJCW5ldGlmX3dha2Vfc3Vi
cXVldWUodmktPmRldiwgdnEydHhxKHZxKSk7Cj4gICB9Cj4gICAKPiArc3RhdGljIHN0cnVjdCBz
a19idWZmICp2aXJ0bmV0X3BhZ2VfdG9fc2tiKHN0cnVjdCB2aXJ0bmV0X3BhZ2VfaW5mbyAqcGlu
Zm8pCj4gK3sKPiArCWludCBzaGluZm9fc2l6ZSA9IFNLQl9EQVRBX0FMSUdOKHNpemVvZihzdHJ1
Y3Qgc2tiX3NoYXJlZF9pbmZvKSk7Cj4gKwlzdHJ1Y3QgdmlydGlvX25ldF9oZHJfbXJnX3J4YnVm
ICpoZHI7Cj4gKwlzdHJ1Y3Qgc2tfYnVmZiAqc2tiOwo+ICsJaW50IHRhaWxyb29tLCBjb3B5Owo+
ICsKPiArCS8qIEluIHRoZSBjYXNlIG9mICJiaWciLCB0YWlscm9vbSBtYXkgYmUgbmVnYXRpdmUs
IGJlY2F1c2UgbGVuIGNhbiBiZQo+ICsJICogZ3JlYXRlciB0aGFuIFBBR0VfU0laRS4KPiArCSAq
Lwo+ICsJdGFpbHJvb20gPSBwaW5mby0+YnVmICsgcGluZm8tPmJ1Zl9zaXplIC0gKHBpbmZvLT5w
YWNrZXQgKyBwaW5mby0+bGVuKTsKPiArCj4gKwlpZiAoIU5FVF9JUF9BTElHTiAmJiB0YWlscm9v
bSA+PSBzaGluZm9fc2l6ZSkgewo+ICsJCXNrYiA9IGJ1aWxkX3NrYihwaW5mby0+YnVmLCBwaW5m
by0+YnVmX3NpemUpOwo+ICsJCWlmICh1bmxpa2VseSghc2tiKSkKPiArCQkJcmV0dXJuIE5VTEw7
Cj4gKwo+ICsJCXNrYl9yZXNlcnZlKHNrYiwgcGluZm8tPnBhY2tldCAtIHBpbmZvLT5idWYpOwo+
ICsJCXNrYl9wdXQoc2tiLCBwaW5mby0+bGVuKTsKPiArCj4gKwkJLyogbWFyay4gcGFnZSBoYXMg
YmVlbiB1c2VkLiAqLwo+ICsJCXBpbmZvLT5wYWdlID0gTlVMTDsKPiArCX0gZWxzZSB7Cj4gKwkJ
LyogY29weSBzbWFsbCBkYXRhIHNvIHdlIGNhbiByZXVzZSB0aGVzZSBwYWdlcyBmb3Igc21hbGwg
ZGF0YQo+ICsJCSAqCj4gKwkJICogR09PRF9DT1BZX0xFTiBpcyB1c2VkIHRvIHNhdmUgbmV0d29y
ayBoZWFkZXJzLCBzdWNoIGFzIGV0aAo+ICsJCSAqIGhlYWRlciwgaXAgaGVhZGVyLCB0Y3AgaGVh
ZGVyLiBJZiB5b3Ugd2FudCB0byBzYXZlIG1ldGFkYXRhCj4gKwkJICogaW5mb3JtYXRpb24sIHdl
IHNob3VsZCBhcHBseSBmb3IgYSBsYXJnZXIgc3BhY2UuIFByZXZlbnQgdGhlCj4gKwkJICogbmV0
d29yayBoZWFkZXIgY2Fubm90IGZpdCBpbiB0aGUgbGluZWFyIHNwYWNlLgo+ICsJCSAqLwo+ICsJ
CXNrYiA9IG5hcGlfYWxsb2Nfc2tiKCZwaW5mby0+cnEtPm5hcGksCj4gKwkJCQkgICAgIHBpbmZv
LT5tZXRhc2l6ZSArIEdPT0RfQ09QWV9MRU4pOwo+ICsJCWlmICh1bmxpa2VseSghc2tiKSkKPiAr
CQkJcmV0dXJuIE5VTEw7Cj4gKwo+ICsJCS8qIENvcHkgYWxsIGZyYW1lIGlmIGl0IGZpdHMgc2ti
LT5oZWFkLCBvdGhlcndpc2UKPiArCQkgKiB3ZSBsZXQgdmlydGlvX25ldF9oZHJfdG9fc2tiKCkg
YW5kIEdSTyBwdWxsIGhlYWRlcnMgYXMgbmVlZGVkLgo+ICsJCSAqLwo+ICsJCWlmIChwaW5mby0+
bGVuIDw9IEdPT0RfQ09QWV9MRU4pCj4gKwkJCWNvcHkgPSBwaW5mby0+bGVuOwo+ICsJCWVsc2UK
PiArCQkJY29weSA9IEVUSF9ITEVOOwo+ICsKPiArCQlza2JfcHV0X2RhdGEoc2tiLCBwaW5mby0+
cGFja2V0IC0gcGluZm8tPm1ldGFzaXplLAo+ICsJCQkgICAgIGNvcHkgKyBwaW5mby0+bWV0YXNp
emUpOwo+ICsJCV9fc2tiX3B1bGwoc2tiLCBwaW5mby0+bWV0YXNpemUpOwo+ICsJCXBpbmZvLT5s
ZW4gLT0gY29weTsKPiArCQlwaW5mby0+b2Zmc2V0ID0gcGluZm8tPnBhY2tldCArIGNvcHkgLQo+
ICsJCQkJKGNoYXIgKilwYWdlX2FkZHJlc3MocGluZm8tPnBhZ2UpOwo+ICsJfQo+ICsKPiArCWlm
IChwaW5mby0+bWV0YXNpemUpCj4gKwkJc2tiX21ldGFkYXRhX3NldChza2IsIHBpbmZvLT5tZXRh
c2l6ZSk7Cj4gKwo+ICsJaWYgKHBpbmZvLT52aXJ0bmV0X2hkcikgewo+ICsJCWhkciA9IHNrYl92
bmV0X2hkcihza2IpOwo+ICsJCW1lbWNweShoZHIsIHBpbmZvLT52aXJ0bmV0X2hkciwgcGluZm8t
PnZpLT5oZHJfbGVuKTsKPiArCX0KPiArCj4gKwlyZXR1cm4gc2tiOwo+ICt9Cj4gKwo+ICtzdGF0
aWMgc3RydWN0IHNrX2J1ZmYgKnZpcnRuZXRfbWVyZ2VfcGFnZV90b19za2Ioc3RydWN0IHZpcnRu
ZXRfcGFnZV9pbmZvICpwaW5mbykKPiArewo+ICsJc3RydWN0IHNrX2J1ZmYgKnNrYjsKPiArCj4g
Kwlza2IgPSB2aXJ0bmV0X3BhZ2VfdG9fc2tiKHBpbmZvKTsKPiArCWlmICh1bmxpa2VseSghc2ti
KSkKPiArCQlyZXR1cm4gTlVMTDsKPiArCj4gKwkvKiBwYWdlIGhhcyBiZWVuIHVzZWQgYnkgYnVp
bGRfc2tiKCkgKi8KPiArCWlmICghcGluZm8tPnBhZ2UpCj4gKwkJcmV0dXJuIHNrYjsKPiArCj4g
KwlpZiAocGluZm8tPmxlbikKPiArCQlza2JfYWRkX3J4X2ZyYWcoc2tiLCAwLCBwaW5mby0+cGFn
ZSwgcGluZm8tPm9mZnNldCwgcGluZm8tPmxlbiwKPiArCQkJCXBpbmZvLT5idWZfc2l6ZSk7Cj4g
KwllbHNlCj4gKwkJcHV0X3BhZ2UocGluZm8tPnBhZ2UpOwo+ICsKPiArCXJldHVybiBza2I7Cj4g
K30KPiArCj4gICAjZGVmaW5lIE1SR19DVFhfSEVBREVSX1NISUZUIDIyCj4gICBzdGF0aWMgdm9p
ZCAqbWVyZ2VhYmxlX2xlbl90b19jdHgodW5zaWduZWQgaW50IHRydWVzaXplLAo+ICAgCQkJCSAg
dW5zaWduZWQgaW50IGhlYWRyb29tKQo+IEBAIC0zNzUsODYgKzQ4NywzMCBAQCBzdGF0aWMgdW5z
aWduZWQgaW50IG1lcmdlYWJsZV9jdHhfdG9fdHJ1ZXNpemUodm9pZCAqbXJnX2N0eCkKPiAgIH0K
PiAgIAo+ICAgLyogQ2FsbGVkIGZyb20gYm90dG9tIGhhbGYgY29udGV4dCAqLwo+IC1zdGF0aWMg
c3RydWN0IHNrX2J1ZmYgKnBhZ2VfdG9fc2tiKHN0cnVjdCB2aXJ0bmV0X2luZm8gKnZpLAo+IC0J
CQkJICAgc3RydWN0IHJlY2VpdmVfcXVldWUgKnJxLAo+IC0JCQkJICAgc3RydWN0IHBhZ2UgKnBh
Z2UsIHVuc2lnbmVkIGludCBvZmZzZXQsCj4gLQkJCQkgICB1bnNpZ25lZCBpbnQgbGVuLCB1bnNp
Z25lZCBpbnQgdHJ1ZXNpemUsCj4gLQkJCQkgICBib29sIGhkcl92YWxpZCwgdW5zaWduZWQgaW50
IG1ldGFzaXplLAo+IC0JCQkJICAgdW5zaWduZWQgaW50IGhlYWRyb29tKQo+ICtzdGF0aWMgc3Ry
dWN0IHNrX2J1ZmYgKnZpcnRuZXRfYmlnX3BhZ2VfdG9fc2tiKHN0cnVjdCB2aXJ0bmV0X3BhZ2Vf
aW5mbyAqcGluZm8pCj4gICB7Cj4gKwl1bnNpZ25lZCBpbnQgbGVuLCBvZmZzZXQsIHRydWVzaXpl
Owo+ICsJc3RydWN0IHJlY2VpdmVfcXVldWUgKnJxOwo+ICAgCXN0cnVjdCBza19idWZmICpza2I7
Cj4gLQlzdHJ1Y3QgdmlydGlvX25ldF9oZHJfbXJnX3J4YnVmICpoZHI7Cj4gLQl1bnNpZ25lZCBp
bnQgY29weSwgaGRyX2xlbiwgaGRyX3BhZGRlZF9sZW47Cj4gLQlzdHJ1Y3QgcGFnZSAqcGFnZV90
b19mcmVlID0gTlVMTDsKPiAtCWludCB0YWlscm9vbSwgc2hpbmZvX3NpemU7Cj4gLQljaGFyICpw
LCAqaGRyX3AsICpidWY7Cj4gKwlzdHJ1Y3QgcGFnZSAqcGFnZTsKPiAgIAo+IC0JcCA9IHBhZ2Vf
YWRkcmVzcyhwYWdlKSArIG9mZnNldDsKPiAtCWhkcl9wID0gcDsKPiArCS8qIHNhdmUgbmV4dCBw
YWdlICovCj4gKwlwYWdlID0gKHN0cnVjdCBwYWdlICopcGluZm8tPnBhZ2UtPnByaXZhdGU7Cj4g
ICAKPiAtCWhkcl9sZW4gPSB2aS0+aGRyX2xlbjsKPiAtCWlmICh2aS0+bWVyZ2VhYmxlX3J4X2J1
ZnMpCj4gLQkJaGRyX3BhZGRlZF9sZW4gPSBzaXplb2YoKmhkcik7Cj4gLQllbHNlCj4gLQkJaGRy
X3BhZGRlZF9sZW4gPSBzaXplb2Yoc3RydWN0IHBhZGRlZF92bmV0X2hkcik7Cj4gLQo+IC0JLyog
SWYgaGVhZHJvb20gaXMgbm90IDAsIHRoZXJlIGlzIGFuIG9mZnNldCBiZXR3ZWVuIHRoZSBiZWdp
bm5pbmcgb2YgdGhlCj4gLQkgKiBkYXRhIGFuZCB0aGUgYWxsb2NhdGVkIHNwYWNlLCBvdGhlcndp
c2UgdGhlIGRhdGEgYW5kIHRoZSBhbGxvY2F0ZWQKPiAtCSAqIHNwYWNlIGFyZSBhbGlnbmVkLgo+
IC0JICovCj4gLQlpZiAoaGVhZHJvb20pIHsKPiAtCQkvKiBCdWZmZXJzIHdpdGggaGVhZHJvb20g
dXNlIFBBR0VfU0laRSBhcyBhbGxvYyBzaXplLAo+IC0JCSAqIHNlZSBhZGRfcmVjdmJ1Zl9tZXJn
ZWFibGUoKSArIGdldF9tZXJnZWFibGVfYnVmX2xlbigpCj4gLQkJICovCj4gLQkJdHJ1ZXNpemUg
PSBQQUdFX1NJWkU7Cj4gLQkJdGFpbHJvb20gPSB0cnVlc2l6ZSAtIGxlbiAtIG9mZnNldDsKPiAt
CQlidWYgPSBwYWdlX2FkZHJlc3MocGFnZSk7Cj4gLQl9IGVsc2Ugewo+IC0JCXRhaWxyb29tID0g
dHJ1ZXNpemUgLSBsZW47Cj4gLQkJYnVmID0gcDsKPiAtCX0KPiAtCj4gLQlsZW4gLT0gaGRyX2xl
bjsKPiAtCW9mZnNldCArPSBoZHJfcGFkZGVkX2xlbjsKPiAtCXAgKz0gaGRyX3BhZGRlZF9sZW47
Cj4gLQo+IC0Jc2hpbmZvX3NpemUgPSBTS0JfREFUQV9BTElHTihzaXplb2Yoc3RydWN0IHNrYl9z
aGFyZWRfaW5mbykpOwo+IC0KPiAtCS8qIGNvcHkgc21hbGwgcGFja2V0IHNvIHdlIGNhbiByZXVz
ZSB0aGVzZSBwYWdlcyAqLwo+IC0JaWYgKCFORVRfSVBfQUxJR04gJiYgbGVuID4gR09PRF9DT1BZ
X0xFTiAmJiB0YWlscm9vbSA+PSBzaGluZm9fc2l6ZSkgewo+IC0JCXNrYiA9IGJ1aWxkX3NrYihi
dWYsIHRydWVzaXplKTsKPiAtCQlpZiAodW5saWtlbHkoIXNrYikpCj4gLQkJCXJldHVybiBOVUxM
Owo+IC0KPiAtCQlza2JfcmVzZXJ2ZShza2IsIHAgLSBidWYpOwo+IC0JCXNrYl9wdXQoc2tiLCBs
ZW4pOwo+IC0JCWdvdG8gb2s7Cj4gLQl9Cj4gLQo+IC0JLyogY29weSBzbWFsbCBwYWNrZXQgc28g
d2UgY2FuIHJldXNlIHRoZXNlIHBhZ2VzIGZvciBzbWFsbCBkYXRhICovCj4gLQlza2IgPSBuYXBp
X2FsbG9jX3NrYigmcnEtPm5hcGksIEdPT0RfQ09QWV9MRU4pOwo+ICsJc2tiID0gdmlydG5ldF9w
YWdlX3RvX3NrYihwaW5mbyk7Cj4gICAJaWYgKHVubGlrZWx5KCFza2IpKQo+ICAgCQlyZXR1cm4g
TlVMTDsKPiAgIAo+IC0JLyogQ29weSBhbGwgZnJhbWUgaWYgaXQgZml0cyBza2ItPmhlYWQsIG90
aGVyd2lzZQo+IC0JICogd2UgbGV0IHZpcnRpb19uZXRfaGRyX3RvX3NrYigpIGFuZCBHUk8gcHVs
bCBoZWFkZXJzIGFzIG5lZWRlZC4KPiAtCSAqLwo+IC0JaWYgKGxlbiA8PSBza2JfdGFpbHJvb20o
c2tiKSkKPiAtCQljb3B5ID0gbGVuOwo+IC0JZWxzZQo+IC0JCWNvcHkgPSBFVEhfSExFTiArIG1l
dGFzaXplOwo+IC0Jc2tiX3B1dF9kYXRhKHNrYiwgcCwgY29weSk7Cj4gKwlycSA9IHBpbmZvLT5y
cTsKPiAgIAo+IC0JbGVuIC09IGNvcHk7Cj4gLQlvZmZzZXQgKz0gY29weTsKPiArCS8qIHBhZ2Ug
aGFzIGJlZW4gdXNlZCBieSBidWlsZF9za2IoKSAqLwo+ICsJaWYgKCFwaW5mby0+cGFnZSkKPiAr
CQlnb3RvIGVuZDsKPiAgIAo+IC0JaWYgKHZpLT5tZXJnZWFibGVfcnhfYnVmcykgewo+IC0JCWlm
IChsZW4pCj4gLQkJCXNrYl9hZGRfcnhfZnJhZyhza2IsIDAsIHBhZ2UsIG9mZnNldCwgbGVuLCB0
cnVlc2l6ZSk7Cj4gLQkJZWxzZQo+IC0JCQlwYWdlX3RvX2ZyZWUgPSBwYWdlOwo+IC0JCWdvdG8g
b2s7Cj4gLQl9Cj4gKwlwYWdlICAgICA9IHBpbmZvLT5wYWdlOwo+ICsJbGVuICAgICAgPSBwaW5m
by0+bGVuOwo+ICsJb2Zmc2V0ICAgPSBwaW5mby0+b2Zmc2V0Owo+ICsJdHJ1ZXNpemUgPSBwaW5m
by0+YnVmX3NpemU7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIFZlcmlmeSB0aGF0IHdlIGNhbiBpbmRl
ZWQgcHV0IHRoaXMgZGF0YSBpbnRvIGEgc2tiLgo+IEBAIC00NzcsMjMgKzUzMywxMCBAQCBzdGF0
aWMgc3RydWN0IHNrX2J1ZmYgKnBhZ2VfdG9fc2tiKHN0cnVjdCB2aXJ0bmV0X2luZm8gKnZpLAo+
ICAgCQlvZmZzZXQgPSAwOwo+ICAgCX0KPiAgIAo+ICtlbmQ6Cj4gICAJaWYgKHBhZ2UpCj4gICAJ
CWdpdmVfcGFnZXMocnEsIHBhZ2UpOwo+ICAgCj4gLW9rOgo+IC0JLyogaGRyX3ZhbGlkIG1lYW5z
IG5vIFhEUCwgc28gd2UgY2FuIGNvcHkgdGhlIHZuZXQgaGVhZGVyICovCj4gLQlpZiAoaGRyX3Zh
bGlkKSB7Cj4gLQkJaGRyID0gc2tiX3ZuZXRfaGRyKHNrYik7Cj4gLQkJbWVtY3B5KGhkciwgaGRy
X3AsIGhkcl9sZW4pOwo+IC0JfQo+IC0JaWYgKHBhZ2VfdG9fZnJlZSkKPiAtCQlwdXRfcGFnZShw
YWdlX3RvX2ZyZWUpOwo+IC0KPiAtCWlmIChtZXRhc2l6ZSkgewo+IC0JCV9fc2tiX3B1bGwoc2ti
LCBtZXRhc2l6ZSk7Cj4gLQkJc2tiX21ldGFkYXRhX3NldChza2IsIG1ldGFzaXplKTsKPiAtCX0K
PiAtCj4gICAJcmV0dXJuIHNrYjsKPiAgIH0KPiAgIAo+IEBAIC02NTQsMTcgKzY5NywxNyBAQCBz
dGF0aWMgdW5zaWduZWQgaW50IHZpcnRuZXRfZ2V0X2hlYWRyb29tKHN0cnVjdCB2aXJ0bmV0X2lu
Zm8gKnZpKQo+ICAgICovCj4gICBzdGF0aWMgc3RydWN0IHBhZ2UgKnhkcF9saW5lYXJpemVfcGFn
ZShzdHJ1Y3QgcmVjZWl2ZV9xdWV1ZSAqcnEsCj4gICAJCQkJICAgICAgIHUxNiAqbnVtX2J1ZiwK
PiAtCQkJCSAgICAgICBzdHJ1Y3QgcGFnZSAqcCwKPiAtCQkJCSAgICAgICBpbnQgb2Zmc2V0LAo+
ICsJCQkJICAgICAgIHZvaWQgKmJ1ZiwKPiAgIAkJCQkgICAgICAgaW50IHBhZ2Vfb2ZmLAo+ICAg
CQkJCSAgICAgICB1bnNpZ25lZCBpbnQgKmxlbikKPiAgIHsKPiAgIAlzdHJ1Y3QgcGFnZSAqcGFn
ZSA9IGFsbG9jX3BhZ2UoR0ZQX0FUT01JQyk7Cj4gKwlzdHJ1Y3QgcGFnZSAqcDsKPiAgIAo+ICAg
CWlmICghcGFnZSkKPiAgIAkJcmV0dXJuIE5VTEw7Cj4gICAKPiAtCW1lbWNweShwYWdlX2FkZHJl
c3MocGFnZSkgKyBwYWdlX29mZiwgcGFnZV9hZGRyZXNzKHApICsgb2Zmc2V0LCAqbGVuKTsKPiAr
CW1lbWNweShwYWdlX2FkZHJlc3MocGFnZSkgKyBwYWdlX29mZiwgYnVmLCAqbGVuKTsKPiAgIAlw
YWdlX29mZiArPSAqbGVuOwo+ICAgCj4gICAJd2hpbGUgKC0tKm51bV9idWYpIHsKPiBAQCAtNzM5
LDE4ICs3ODIsMTggQEAgc3RhdGljIHN0cnVjdCBza19idWZmICpyZWNlaXZlX3NtYWxsKHN0cnVj
dCBuZXRfZGV2aWNlICpkZXYsCj4gICAJCQlnb3RvIGVycl94ZHA7Cj4gICAKPiAgIAkJaWYgKHVu
bGlrZWx5KHhkcF9oZWFkcm9vbSA8IHZpcnRuZXRfZ2V0X2hlYWRyb29tKHZpKSkpIHsKPiAtCQkJ
aW50IG9mZnNldCA9IGJ1ZiAtIHBhZ2VfYWRkcmVzcyhwYWdlKSArIGhlYWRlcl9vZmZzZXQ7Cj4g
ICAJCQl1bnNpZ25lZCBpbnQgdGxlbiA9IGxlbiArIHZpLT5oZHJfbGVuOwo+ICAgCQkJdTE2IG51
bV9idWYgPSAxOwo+ICAgCj4gKwkJCWJ1ZiArPSBoZWFkZXJfb2Zmc2V0Owo+ICsKPiAgIAkJCXhk
cF9oZWFkcm9vbSA9IHZpcnRuZXRfZ2V0X2hlYWRyb29tKHZpKTsKPiAgIAkJCWhlYWRlcl9vZmZz
ZXQgPSBWSVJUTkVUX1JYX1BBRCArIHhkcF9oZWFkcm9vbTsKPiAgIAkJCWhlYWRyb29tID0gdmkt
Pmhkcl9sZW4gKyBoZWFkZXJfb2Zmc2V0Owo+ICAgCQkJYnVmbGVuID0gU0tCX0RBVEFfQUxJR04o
R09PRF9QQUNLRVRfTEVOICsgaGVhZHJvb20pICsKPiAgIAkJCQkgU0tCX0RBVEFfQUxJR04oc2l6
ZW9mKHN0cnVjdCBza2Jfc2hhcmVkX2luZm8pKTsKPiAtCQkJeGRwX3BhZ2UgPSB4ZHBfbGluZWFy
aXplX3BhZ2UocnEsICZudW1fYnVmLCBwYWdlLAo+IC0JCQkJCQkgICAgICBvZmZzZXQsIGhlYWRl
cl9vZmZzZXQsCj4gLQkJCQkJCSAgICAgICZ0bGVuKTsKPiArCQkJeGRwX3BhZ2UgPSB4ZHBfbGlu
ZWFyaXplX3BhZ2UocnEsICZudW1fYnVmLCBidWYsCj4gKwkJCQkJCSAgICAgIGhlYWRlcl9vZmZz
ZXQsICZ0bGVuKTsKPiAgIAkJCWlmICgheGRwX3BhZ2UpCj4gICAJCQkJZ290byBlcnJfeGRwOwo+
ICAgCj4gQEAgLTg0Miw5ICs4ODUsMjEgQEAgc3RhdGljIHN0cnVjdCBza19idWZmICpyZWNlaXZl
X2JpZyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ICAgCQkJCSAgIHVuc2lnbmVkIGludCBsZW4s
Cj4gICAJCQkJICAgc3RydWN0IHZpcnRuZXRfcnFfc3RhdHMgKnN0YXRzKQo+ICAgewo+ICsJc3Ry
dWN0IHZpcnRuZXRfcGFnZV9pbmZvIHBpbmZvOwo+ICAgCXN0cnVjdCBwYWdlICpwYWdlID0gYnVm
Owo+IC0Jc3RydWN0IHNrX2J1ZmYgKnNrYiA9Cj4gLQkJcGFnZV90b19za2IodmksIHJxLCBwYWdl
LCAwLCBsZW4sIFBBR0VfU0laRSwgdHJ1ZSwgMCwgMCk7Cj4gKwlzdHJ1Y3Qgc2tfYnVmZiAqc2ti
Owo+ICsKPiArCXBpbmZvLnJxICAgICAgICAgID0gcnE7Cj4gKwlwaW5mby52aSAgICAgICAgICA9
IHZpOwo+ICsJcGluZm8ucGFnZSAgICAgICAgPSBwYWdlOwo+ICsJcGluZm8uYnVmICAgICAgICAg
PSBwYWdlX2FkZHJlc3MocGFnZSk7Cj4gKwlwaW5mby5idWZfc2l6ZSAgICA9IFBBR0VfU0laRTsK
PiArCXBpbmZvLnZpcnRuZXRfaGRyID0gcGluZm8uYnVmOwo+ICsJcGluZm8ucGFja2V0ICAgICAg
PSBwaW5mby52aXJ0bmV0X2hkciArIHNpemVvZihzdHJ1Y3QgcGFkZGVkX3ZuZXRfaGRyKTsKPiAr
CXBpbmZvLmxlbiAgICAgICAgID0gbGVuIC0gdmktPmhkcl9sZW47Cj4gKwlwaW5mby5tZXRhc2l6
ZSAgICA9IDA7Cj4gKwo+ICsJc2tiID0gdmlydG5ldF9iaWdfcGFnZV90b19za2IoJnBpbmZvKTsK
PiAgIAo+ICAgCXN0YXRzLT5ieXRlcyArPSBsZW4gLSB2aS0+aGRyX2xlbjsKPiAgIAlpZiAodW5s
aWtlbHkoIXNrYikpCj4gQEAgLTg3MCwxMiArOTI1LDExIEBAIHN0YXRpYyBzdHJ1Y3Qgc2tfYnVm
ZiAqcmVjZWl2ZV9tZXJnZWFibGUoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiAgIAlzdHJ1Y3Qg
dmlydGlvX25ldF9oZHJfbXJnX3J4YnVmICpoZHIgPSBidWY7Cj4gICAJdTE2IG51bV9idWYgPSB2
aXJ0aW8xNl90b19jcHUodmktPnZkZXYsIGhkci0+bnVtX2J1ZmZlcnMpOwo+ICAgCXN0cnVjdCBw
YWdlICpwYWdlID0gdmlydF90b19oZWFkX3BhZ2UoYnVmKTsKPiAtCWludCBvZmZzZXQgPSBidWYg
LSBwYWdlX2FkZHJlc3MocGFnZSk7Cj4gICAJc3RydWN0IHNrX2J1ZmYgKmhlYWRfc2tiLCAqY3Vy
cl9za2I7Cj4gKwlzdHJ1Y3QgdmlydG5ldF9wYWdlX2luZm8gcGluZm87Cj4gICAJc3RydWN0IGJw
Zl9wcm9nICp4ZHBfcHJvZzsKPiAgIAl1bnNpZ25lZCBpbnQgdHJ1ZXNpemUgPSBtZXJnZWFibGVf
Y3R4X3RvX3RydWVzaXplKGN0eCk7Cj4gICAJdW5zaWduZWQgaW50IGhlYWRyb29tID0gbWVyZ2Vh
YmxlX2N0eF90b19oZWFkcm9vbShjdHgpOwo+IC0JdW5zaWduZWQgaW50IG1ldGFzaXplID0gMDsK
PiAgIAl1bnNpZ25lZCBpbnQgZnJhbWVfc3o7Cj4gICAJaW50IGVycjsKPiAgIAo+IEBAIC04ODcs
OCArOTQxLDggQEAgc3RhdGljIHN0cnVjdCBza19idWZmICpyZWNlaXZlX21lcmdlYWJsZShzdHJ1
Y3QgbmV0X2RldmljZSAqZGV2LAo+ICAgCWlmICh4ZHBfcHJvZykgewo+ICAgCQlzdHJ1Y3QgeGRw
X2ZyYW1lICp4ZHBmOwo+ICAgCQlzdHJ1Y3QgcGFnZSAqeGRwX3BhZ2U7Cj4gKwkJdm9pZCAqaGFy
ZF9zdGFydDsKPiAgIAkJc3RydWN0IHhkcF9idWZmIHhkcDsKPiAtCQl2b2lkICpkYXRhOwo+ICAg
CQl1MzIgYWN0Owo+ICAgCj4gICAJCS8qIFRyYW5zaWVudCBmYWlsdXJlIHdoaWNoIGluIHRoZW9y
eSBjb3VsZCBvY2N1ciBpZgo+IEBAIC05MTIsNTQgKzk2Niw0NyBAQCBzdGF0aWMgc3RydWN0IHNr
X2J1ZmYgKnJlY2VpdmVfbWVyZ2VhYmxlKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gICAJCWlm
ICh1bmxpa2VseShudW1fYnVmID4gMSB8fAo+ICAgCQkJICAgICBoZWFkcm9vbSA8IHZpcnRuZXRf
Z2V0X2hlYWRyb29tKHZpKSkpIHsKPiAgIAkJCS8qIGxpbmVhcml6ZSBkYXRhIGZvciBYRFAgKi8K
PiAtCQkJeGRwX3BhZ2UgPSB4ZHBfbGluZWFyaXplX3BhZ2UocnEsICZudW1fYnVmLAo+IC0JCQkJ
CQkgICAgICBwYWdlLCBvZmZzZXQsCj4gKwkJCXhkcF9wYWdlID0geGRwX2xpbmVhcml6ZV9wYWdl
KHJxLCAmbnVtX2J1ZiwgYnVmLAo+ICAgCQkJCQkJICAgICAgVklSVElPX1hEUF9IRUFEUk9PTSwK
PiAgIAkJCQkJCSAgICAgICZsZW4pOwo+ICAgCQkJZnJhbWVfc3ogPSBQQUdFX1NJWkU7Cj4gICAK
PiAgIAkJCWlmICgheGRwX3BhZ2UpCj4gICAJCQkJZ290byBlcnJfeGRwOwo+IC0JCQlvZmZzZXQg
PSBWSVJUSU9fWERQX0hFQURST09NOwo+ICsKPiArCQkJaGFyZF9zdGFydCA9IHBhZ2VfYWRkcmVz
cyh4ZHBfcGFnZSkgKyB2aS0+aGRyX2xlbjsKPiAgIAkJfSBlbHNlIHsKPiAgIAkJCXhkcF9wYWdl
ID0gcGFnZTsKPiArCQkJaGFyZF9zdGFydCA9IGJ1ZiArIHZpLT5oZHJfbGVuIC0gVklSVElPX1hE
UF9IRUFEUk9PTTsKPiAgIAkJfQo+ICAgCj4gICAJCS8qIEFsbG93IGNvbnN1bWluZyBoZWFkcm9v
bSBidXQgcmVzZXJ2ZSBlbm91Z2ggc3BhY2UgdG8gcHVzaAo+ICAgCQkgKiB0aGUgZGVzY3JpcHRv
ciBvbiBpZiB3ZSBnZXQgYW4gWERQX1RYIHJldHVybiBjb2RlLgo+ICAgCQkgKi8KPiAtCQlkYXRh
ID0gcGFnZV9hZGRyZXNzKHhkcF9wYWdlKSArIG9mZnNldDsKPiAgIAkJeGRwX2luaXRfYnVmZigm
eGRwLCBmcmFtZV9zeiAtIHZpLT5oZHJfbGVuLCAmcnEtPnhkcF9yeHEpOwo+IC0JCXhkcF9wcmVw
YXJlX2J1ZmYoJnhkcCwgZGF0YSAtIFZJUlRJT19YRFBfSEVBRFJPT00gKyB2aS0+aGRyX2xlbiwK
PiAtCQkJCSBWSVJUSU9fWERQX0hFQURST09NLCBsZW4gLSB2aS0+aGRyX2xlbiwgdHJ1ZSk7Cj4g
KwkJeGRwX3ByZXBhcmVfYnVmZigmeGRwLCBoYXJkX3N0YXJ0LCBWSVJUSU9fWERQX0hFQURST09N
LAo+ICsJCQkJIGxlbiAtIHZpLT5oZHJfbGVuLCB0cnVlKTsKPiAgIAo+ICAgCQlhY3QgPSBicGZf
cHJvZ19ydW5feGRwKHhkcF9wcm9nLCAmeGRwKTsKPiAgIAkJc3RhdHMtPnhkcF9wYWNrZXRzKys7
Cj4gICAKPiAgIAkJc3dpdGNoIChhY3QpIHsKPiAgIAkJY2FzZSBYRFBfUEFTUzoKPiAtCQkJbWV0
YXNpemUgPSB4ZHAuZGF0YSAtIHhkcC5kYXRhX21ldGE7Cj4gLQo+IC0JCQkvKiByZWNhbGN1bGF0
ZSBvZmZzZXQgdG8gYWNjb3VudCBmb3IgYW55IGhlYWRlcgo+IC0JCQkgKiBhZGp1c3RtZW50cyBh
bmQgbWludXMgdGhlIG1ldGFzaXplIHRvIGNvcHkgdGhlCj4gLQkJCSAqIG1ldGFkYXRhIGluIHBh
Z2VfdG9fc2tiKCkuIE5vdGUgb3RoZXIgY2FzZXMgZG8gbm90Cj4gLQkJCSAqIGJ1aWxkIGFuIHNr
YiBhbmQgYXZvaWQgdXNpbmcgb2Zmc2V0Cj4gLQkJCSAqLwo+IC0JCQlvZmZzZXQgPSB4ZHAuZGF0
YSAtIHBhZ2VfYWRkcmVzcyh4ZHBfcGFnZSkgLQo+IC0JCQkJIHZpLT5oZHJfbGVuIC0gbWV0YXNp
emU7Cj4gLQo+IC0JCQkvKiByZWNhbGN1bGF0ZSBsZW4gaWYgeGRwLmRhdGEsIHhkcC5kYXRhX2Vu
ZCBvcgo+IC0JCQkgKiB4ZHAuZGF0YV9tZXRhIHdlcmUgYWRqdXN0ZWQKPiAtCQkJICovCj4gLQkJ
CWxlbiA9IHhkcC5kYXRhX2VuZCAtIHhkcC5kYXRhICsgdmktPmhkcl9sZW4gKyBtZXRhc2l6ZTsK
PiArCQkJcGluZm8ucnEgICAgICAgICAgPSBycTsKPiArCQkJcGluZm8udmkgICAgICAgICAgPSB2
aTsKPiArCQkJcGluZm8ucGFnZSAgICAgICAgPSB4ZHBfcGFnZTsKPiArCQkJcGluZm8uYnVmICAg
ICAgICAgPSB4ZHAuZGF0YV9oYXJkX3N0YXJ0IC0gdmktPmhkcl9sZW47Cj4gKwkJCXBpbmZvLmJ1
Zl9zaXplICAgID0gUEFHRV9TSVpFOwo+ICsJCQlwaW5mby52aXJ0bmV0X2hkciA9IE5VTEw7Cj4g
KwkJCXBpbmZvLnBhY2tldCAgICAgID0geGRwLmRhdGE7Cj4gKwkJCXBpbmZvLmxlbiAgICAgICAg
ID0geGRwLmRhdGFfZW5kIC0geGRwLmRhdGE7Cj4gKwkJCXBpbmZvLm1ldGFzaXplICAgID0geGRw
LmRhdGEgLSB4ZHAuZGF0YV9tZXRhOwo+ICAgCQkJLyogV2UgY2FuIG9ubHkgY3JlYXRlIHNrYiBi
YXNlZCBvbiB4ZHBfcGFnZS4gKi8KPiAgIAkJCWlmICh1bmxpa2VseSh4ZHBfcGFnZSAhPSBwYWdl
KSkgewo+ICAgCQkJCXJjdV9yZWFkX3VubG9jaygpOwo+ICAgCQkJCXB1dF9wYWdlKHBhZ2UpOwo+
IC0JCQkJaGVhZF9za2IgPSBwYWdlX3RvX3NrYih2aSwgcnEsIHhkcF9wYWdlLCBvZmZzZXQsCj4g
LQkJCQkJCSAgICAgICBsZW4sIFBBR0VfU0laRSwgZmFsc2UsCj4gLQkJCQkJCSAgICAgICBtZXRh
c2l6ZSwgaGVhZHJvb20pOwo+IC0JCQkJcmV0dXJuIGhlYWRfc2tiOwo+ICsKPiArCQkJCXJldHVy
biB2aXJ0bmV0X21lcmdlX3BhZ2VfdG9fc2tiKCZwaW5mbyk7Cj4gICAJCQl9Cj4gICAJCQlicmVh
azsKPiAgIAkJY2FzZSBYRFBfVFg6Cj4gQEAgLTEwMDUsOCArMTA1MiwyMiBAQCBzdGF0aWMgc3Ry
dWN0IHNrX2J1ZmYgKnJlY2VpdmVfbWVyZ2VhYmxlKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4g
ICAJCQkJX19mcmVlX3BhZ2VzKHhkcF9wYWdlLCAwKTsKPiAgIAkJCWdvdG8gZXJyX3hkcDsKPiAg
IAkJfQo+ICsJCXJjdV9yZWFkX3VubG9jaygpOwo+ICsKPiArCQkvKiBwaW5mbyBoYXMgYmVlbiBm
aWxsZWQgaW5zaWRlIFhEUF9QQVNTICovCj4gKwl9IGVsc2Ugewo+ICsJCXJjdV9yZWFkX3VubG9j
aygpOwo+ICsKPiArCQlwaW5mby5ycSAgICAgICAgICA9IHJxOwo+ICsJCXBpbmZvLnZpICAgICAg
ICAgID0gdmk7Cj4gKwkJcGluZm8ucGFnZSAgICAgICAgPSBwYWdlOwo+ICsJCXBpbmZvLmJ1ZiAg
ICAgICAgID0gYnVmIC0gaGVhZHJvb207Cj4gKwkJcGluZm8uYnVmX3NpemUgICAgPSBoZWFkcm9v
bSA/IFBBR0VfU0laRSA6IHRydWVzaXplOwo+ICsJCXBpbmZvLnZpcnRuZXRfaGRyID0gYnVmOwo+
ICsJCXBpbmZvLnBhY2tldCAgICAgID0gYnVmICsgc2l6ZW9mKCpoZHIpOwo+ICsJCXBpbmZvLmxl
biAgICAgICAgID0gbGVuIC0gc2l6ZW9mKCpoZHIpOwo+ICsJCXBpbmZvLm1ldGFzaXplICAgID0g
MDsKPiAgIAl9Cj4gLQlyY3VfcmVhZF91bmxvY2soKTsKPiAgIAo+ICAgCWlmICh1bmxpa2VseShs
ZW4gPiB0cnVlc2l6ZSkpIHsKPiAgIAkJcHJfZGVidWcoIiVzOiByeCBlcnJvcjogbGVuICV1IGV4
Y2VlZHMgdHJ1ZXNpemUgJWx1XG4iLAo+IEBAIC0xMDE1LDE0ICsxMDc2LDE0IEBAIHN0YXRpYyBz
dHJ1Y3Qgc2tfYnVmZiAqcmVjZWl2ZV9tZXJnZWFibGUoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwK
PiAgIAkJZ290byBlcnJfc2tiOwo+ICAgCX0KPiAgIAo+IC0JaGVhZF9za2IgPSBwYWdlX3RvX3Nr
Yih2aSwgcnEsIHBhZ2UsIG9mZnNldCwgbGVuLCB0cnVlc2l6ZSwgIXhkcF9wcm9nLAo+IC0JCQkg
ICAgICAgbWV0YXNpemUsIGhlYWRyb29tKTsKPiArCWhlYWRfc2tiID0gdmlydG5ldF9tZXJnZV9w
YWdlX3RvX3NrYigmcGluZm8pOwo+ICAgCWN1cnJfc2tiID0gaGVhZF9za2I7Cj4gICAKPiAgIAlp
ZiAodW5saWtlbHkoIWN1cnJfc2tiKSkKPiAgIAkJZ290byBlcnJfc2tiOwo+ICAgCXdoaWxlICgt
LW51bV9idWYpIHsKPiAgIAkJaW50IG51bV9za2JfZnJhZ3M7Cj4gKwkJaW50IG9mZnNldDsKPiAg
IAo+ICAgCQlidWYgPSB2aXJ0cXVldWVfZ2V0X2J1Zl9jdHgocnEtPnZxLCAmbGVuLCAmY3R4KTsK
PiAgIAkJaWYgKHVubGlrZWx5KCFidWYpKSB7CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmlydHVhbGl6
YXRpb25AbGlzdHMubGludXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51eGZvdW5k
YXRpb24ub3JnL21haWxtYW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
