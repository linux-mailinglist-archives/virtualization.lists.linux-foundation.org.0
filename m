Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 28B0E221F7C
	for <lists.virtualization@lfdr.de>; Thu, 16 Jul 2020 11:15:02 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 79B4E8764D;
	Thu, 16 Jul 2020 09:15:00 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 4mVS8xltaiQ5; Thu, 16 Jul 2020 09:14:55 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id ECCF388CED;
	Thu, 16 Jul 2020 09:14:55 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id C98D2C08A5;
	Thu, 16 Jul 2020 09:14:55 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 27EF8C0733
 for <virtualization@lists.linux-foundation.org>;
 Thu, 16 Jul 2020 09:14:54 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by fraxinus.osuosl.org (Postfix) with ESMTP id 00B0D8764D
 for <virtualization@lists.linux-foundation.org>;
 Thu, 16 Jul 2020 09:14:54 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 7VmjII4EczTl
 for <virtualization@lists.linux-foundation.org>;
 Thu, 16 Jul 2020 09:14:49 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from us-smtp-1.mimecast.com (us-smtp-1.mimecast.com [207.211.31.81])
 by fraxinus.osuosl.org (Postfix) with ESMTPS id 8879587642
 for <virtualization@lists.linux-foundation.org>;
 Thu, 16 Jul 2020 09:14:49 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1594890888;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=m2+rX/68ugRwN90BkzZo7uw0Lve7uZNmHsSbVbW+onw=;
 b=fUzpenuRvAlH+5yOE6OmxjMF4qwCr3AfaLtdPY455ouWfafCaG5l1XlwmvUTDPtjrEeA5T
 m/I9TmNohAmsh07wrLJ66224LEYXwJyKTarhC9jD6gUPpq1vSrG2GzeSlS2NO8olVL/ohe
 BGKwfpzNPS6TOY3HuWVqUZeTi3aHUeM=
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-11-IBUi1-RVN--PCqzEdrZwVQ-1; Thu, 16 Jul 2020 05:14:43 -0400
X-MC-Unique: IBUi1-RVN--PCqzEdrZwVQ-1
Received: from smtp.corp.redhat.com (int-mx02.intmail.prod.int.phx2.redhat.com
 [10.5.11.12])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id A960F8027ED;
 Thu, 16 Jul 2020 09:14:41 +0000 (UTC)
Received: from [10.72.12.131] (ovpn-12-131.pek2.redhat.com [10.72.12.131])
 by smtp.corp.redhat.com (Postfix) with ESMTP id ACCEA610AF;
 Thu, 16 Jul 2020 09:14:34 +0000 (UTC)
Subject: Re: [PATCH vhost next 10/10] vdpa/mlx5: Add VDPA driver for supported
 mlx5 devices
To: Eli Cohen <eli@mellanox.com>, mst@redhat.com,
 virtualization@lists.linux-foundation.org, linux-kernel@vger.kernel.org
References: <20200716072327.5359-1-eli@mellanox.com>
 <20200716072327.5359-11-eli@mellanox.com>
From: Jason Wang <jasowang@redhat.com>
Message-ID: <454850cc-269b-72aa-4511-2bf793a215cc@redhat.com>
Date: Thu, 16 Jul 2020 17:14:32 +0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.10.0
MIME-Version: 1.0
In-Reply-To: <20200716072327.5359-11-eli@mellanox.com>
Content-Language: en-US
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.12
Cc: shahafs@mellanox.com, Parav Pandit <parav@mellanox.com>,
 saeedm@mellanox.com
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

Ck9uIDIwMjAvNy8xNiDkuIvljYgzOjIzLCBFbGkgQ29oZW4gd3JvdGU6Cj4gQWRkIGEgZnJvbnQg
ZW5kIFZEUEEgZHJpdmVyIHRoYXQgcmVnaXN0ZXJzIGluIHRoZSBWRFBBIGJ1cyBhbmQgcHJvdmlk
ZXMKPiBuZXR3b3JraW5nIHRvIGEgZ3Vlc3QuIFRoZSBWRFBBIGRyaXZlciBjcmVhdGVzIHRoZSBu
ZWNlc3NhcnkgcmVzb3VyY2VzCj4gb24gdGhlIFZGIGl0IGlzIGRyaXZpbmcgc3VjaCB0aGF0IGRh
dGEgcGF0aCB3aWxsIGJlIG9mZmxvYWRlZC4KPgo+IE5vdGlmaWNhdGlvbnMgYXJlIGJlaW5nIGNv
bW11bmljYXRlZCB0aHJvdWdoIHRoZSBkcml2ZXIuCj4KPiBDdXJyZW50bHksIG9ubHkgVkZzIGFy
ZSBzdXBwb3J0ZWQuIEluIHN1YnNlcXVlbnQgcGF0Y2hlcyB3ZSB3aWxsIGhhdmUKPiBkZXZsaW5r
IHN1cHBvcnQgdG8gY29udHJvbCB3aGljaCBWRiBpcyB1c2VkIGZvciBWRFBBIGFuZCB3aGljaCBm
dW5jdGlvbgo+IGlzIHVzZWQgZm9yIHJlZ3VsYXIgbmV0d29ya2luZy4KPgo+IFJldmlld2VkLWJ5
OiBQYXJhdiBQYW5kaXQgPHBhcmF2QG1lbGxhbm94LmNvbT4KPiBTaWduZWQtb2ZmLWJ5OiBFbGkg
Q29oZW4gPGVsaUBtZWxsYW5veC5jb20+CgoKTG9va3MgZ29vZCBvdmVyYWxsLgoKRmV3IG5pdHMg
aW5saW5lLgoKCj4gLS0tCj4gICBkcml2ZXJzL3ZkcGEvS2NvbmZpZyAgICAgICAgICAgICAgfCAg
IDEwICsKPiAgIGRyaXZlcnMvdmRwYS9tbHg1L01ha2VmaWxlICAgICAgICB8ICAgIDUgKy0KPiAg
IGRyaXZlcnMvdmRwYS9tbHg1L2NvcmUvbXIuYyAgICAgICB8ICAgIDIgKy0KPiAgIGRyaXZlcnMv
dmRwYS9tbHg1L25ldC9tYWluLmMgICAgICB8ICAgNzYgKysKPiAgIGRyaXZlcnMvdmRwYS9tbHg1
L25ldC9tbHg1X3ZuZXQuYyB8IDE5NjYgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKPiAg
IGRyaXZlcnMvdmRwYS9tbHg1L25ldC9tbHg1X3ZuZXQuaCB8ICAgMzIgKwo+ICAgNiBmaWxlcyBj
aGFuZ2VkLCAyMDg5IGluc2VydGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCj4gICBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy92ZHBhL21seDUvbmV0L21haW4uYwo+ICAgY3JlYXRlIG1vZGUgMTAw
NjQ0IGRyaXZlcnMvdmRwYS9tbHg1L25ldC9tbHg1X3ZuZXQuYwo+ICAgY3JlYXRlIG1vZGUgMTAw
NjQ0IGRyaXZlcnMvdmRwYS9tbHg1L25ldC9tbHg1X3ZuZXQuaAo+Cj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvdmRwYS9LY29uZmlnIGIvZHJpdmVycy92ZHBhL0tjb25maWcKPiBpbmRleCA0OGExYTc3
NmRkODYuLjgwOWNiNGMyZWVjZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL3ZkcGEvS2NvbmZpZwo+
ICsrKyBiL2RyaXZlcnMvdmRwYS9LY29uZmlnCj4gQEAgLTM2LDQgKzM2LDE0IEBAIGNvbmZpZyBN
TFg1X1ZEUEEKPiAgIAkgIFN1cHBvcnQgbGlicmFyeSBmb3IgTWVsbGFub3ggVkRQQSBkcml2ZXJz
LiBQcm92aWRlcyBjb2RlIHRoYXQgaXMKPiAgIAkgIGNvbW1vbiBmb3IgYWxsIHR5cGVzIG9mIFZE
UEEgZHJpdmVycy4KPiAgIAo+ICtjb25maWcgTUxYNV9WRFBBX05FVAo+ICsJdHJpc3RhdGUgInZE
UEEgZHJpdmVyIGZvciBDb25uZWN0WCBkZXZpY2VzIgo+ICsJZGVwZW5kcyBvbiBNTFg1X1ZEUEEK
PiArCWRlZmF1bHQgbgo+ICsJaGVscAo+ICsJICBWRFBBIG5ldHdvcmsgZHJpdmVyIGZvciBDb25u
ZWN0WDYgYW5kIG5ld2VyLiBQcm92aWRlcyBvZmZsb2FkaW5nCj4gKwkgIG9mIHZpcnRpbyBuZXQg
ZGF0YXBhdGggc3VjaCB0aGF0IGRlc2NyaXB0b3JzIHB1dCBvbiB0aGUgcmluZyB3aWxsCj4gKwkg
IGJlIGV4ZWN1dGVkIGJ5IHRoZSBoYXJkd2FyZS4gSXQgYWxzbyBzdXBwb3J0cyBhIHZhcmlldHkg
b2Ygc3RhdGVsZXNzCj4gKwkgIG9mZmxvYWRzIGRlcGVuZGluZyBvbiB0aGUgYWN0dWFsIGRldmlj
ZSB1c2VkIGFuZCBmaXJtd2FyZSB2ZXJzaW9uLgo+ICsKPiAgIGVuZGlmICMgVkRQQQo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL3ZkcGEvbWx4NS9NYWtlZmlsZSBiL2RyaXZlcnMvdmRwYS9tbHg1L01h
a2VmaWxlCj4gaW5kZXggYjM0N2M2MjAzMmVhLi4zZjg4NTBjMWEzMDAgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy92ZHBhL21seDUvTWFrZWZpbGUKPiArKysgYi9kcml2ZXJzL3ZkcGEvbWx4NS9NYWtl
ZmlsZQo+IEBAIC0xICsxLDQgQEAKPiAtb2JqLSQoQ09ORklHX01MWDVfVkRQQSkgKz0gY29yZS9y
ZXNvdXJjZXMubyBjb3JlL21yLm8KPiArc3ViZGlyLWNjZmxhZ3MteSArPSAtSSQoc3JjKS9jb3Jl
Cj4gKwo+ICtvYmotJChDT05GSUdfTUxYNV9WRFBBX05FVCkgKz0gbWx4NV92ZHBhLm8KPiArbWx4
NV92ZHBhLSQoQ09ORklHX01MWDVfVkRQQV9ORVQpICs9IG5ldC9tYWluLm8gbmV0L21seDVfdm5l
dC5vIGNvcmUvcmVzb3VyY2VzLm8gY29yZS9tci5vCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdmRw
YS9tbHg1L2NvcmUvbXIuYyBiL2RyaXZlcnMvdmRwYS9tbHg1L2NvcmUvbXIuYwo+IGluZGV4IDk3
NWFhNDVmZDc4Yi4uMzRlM2JiYjgwZGY4IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvdmRwYS9tbHg1
L2NvcmUvbXIuYwo+ICsrKyBiL2RyaXZlcnMvdmRwYS9tbHg1L2NvcmUvbXIuYwo+IEBAIC00NTMs
NyArNDUzLDcgQEAgaW50IG1seDVfdmRwYV9oYW5kbGVfc2V0X21hcChzdHJ1Y3QgbWx4NV92ZHBh
X2RldiAqbXZkZXYsIHN0cnVjdCB2aG9zdF9pb3RsYiAqaW8KPiAgIAkJCSAgICAgYm9vbCAqY2hh
bmdlX21hcCkKPiAgIHsKPiAgIAlzdHJ1Y3QgbWx4NV92ZHBhX21yICptciA9ICZtdmRldi0+bXI7
Cj4gLQlpbnQgZXJyOwo+ICsJaW50IGVyciA9IDA7Cj4gICAKPiAgIAkqY2hhbmdlX21hcCA9IGZh
bHNlOwo+ICAgCWlmIChtYXBfZW1wdHkoaW90bGIpKSB7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
dmRwYS9tbHg1L25ldC9tYWluLmMgYi9kcml2ZXJzL3ZkcGEvbWx4NS9uZXQvbWFpbi5jCj4gbmV3
IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMDAwMDAuLjgzOGNkOTgzODZmZgo+IC0t
LSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL3ZkcGEvbWx4NS9uZXQvbWFpbi5jCj4gQEAgLTAs
MCArMSw3NiBAQAo+ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCBPUiBMaW51
eC1PcGVuSUIKPiArLyogQ29weXJpZ2h0IChjKSAyMDIwIE1lbGxhbm94IFRlY2hub2xvZ2llcyBM
dGQuICovCj4gKwo+ICsjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+Cj4gKyNpbmNsdWRlIDxsaW51
eC9tbHg1L2RyaXZlci5oPgo+ICsjaW5jbHVkZSA8bGludXgvbWx4NS9kZXZpY2UuaD4KPiArI2lu
Y2x1ZGUgIm1seDVfdmRwYV9pZmMuaCIKPiArI2luY2x1ZGUgIm1seDVfdm5ldC5oIgo+ICsKPiAr
TU9EVUxFX0FVVEhPUigiRWxpIENvaGVuIDxlbGlAbWVsbGFub3guY29tPiIpOwo+ICtNT0RVTEVf
REVTQ1JJUFRJT04oIk1lbGxhbm94IFZEUEEgZHJpdmVyIik7Cj4gK01PRFVMRV9MSUNFTlNFKCJE
dWFsIEJTRC9HUEwiKTsKPiArCj4gK3N0YXRpYyBib29sIHJlcXVpcmVkX2NhcHNfc3VwcG9ydGVk
KHN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2KQo+ICt7Cj4gKwl1OCBldmVudF9tb2RlOwo+ICsJ
dTY0IGdvdDsKPiArCj4gKwlnb3QgPSBNTFg1X0NBUF9HRU5fNjQobWRldiwgZ2VuZXJhbF9vYmpf
dHlwZXMpOwo+ICsKPiArCWlmICghKGdvdCAmIE1MWDVfR0VORVJBTF9PQkpfVFlQRVNfQ0FQX1ZJ
UlRJT19ORVRfUSkpCj4gKwkJcmV0dXJuIGZhbHNlOwo+ICsKPiArCWV2ZW50X21vZGUgPSBNTFg1
X0NBUF9ERVZfVkRQQV9FTVVMQVRJT04obWRldiwgZXZlbnRfbW9kZSk7Cj4gKwlpZiAoIShldmVu
dF9tb2RlICYgTUxYNV9WSVJUSU9fUV9FVkVOVF9NT0RFX1FQX01PREUpKQo+ICsJCXJldHVybiBm
YWxzZTsKPiArCj4gKwlpZiAoIU1MWDVfQ0FQX0RFVl9WRFBBX0VNVUxBVElPTihtZGV2LCBldGhf
ZnJhbWVfb2ZmbG9hZF90eXBlKSkKPiArCQlyZXR1cm4gZmFsc2U7Cj4gKwo+ICsJcmV0dXJuIHRy
dWU7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkICptbHg1X3ZkcGFfYWRkKHN0cnVjdCBtbHg1X2Nv
cmVfZGV2ICptZGV2KQo+ICt7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX2RldiAqdmRldjsKPiArCj4g
KwlpZiAobWx4NV9jb3JlX2lzX3BmKG1kZXYpKQo+ICsJCXJldHVybiBOVUxMOwo+ICsKPiArCWlm
ICghcmVxdWlyZWRfY2Fwc19zdXBwb3J0ZWQobWRldikpIHsKPiArCQlkZXZfaW5mbyhtZGV2LT5k
ZXZpY2UsICJ2aXJ0aW8gbmV0IGVtdWxhdGlvbiBub3Qgc3VwcG9ydGVkXG4iKTsKPiArCQlyZXR1
cm4gTlVMTDsKPiArCX0KPiArCXZkZXYgPSBtbHg1X3ZkcGFfYWRkX2RldihtZGV2KTsKPiArCWlm
IChJU19FUlIodmRldikpCj4gKwkJcmV0dXJuIE5VTEw7Cj4gKwo+ICsJcmV0dXJuIHZkZXY7Cj4g
K30KPiArCj4gK3N0YXRpYyB2b2lkIG1seDVfdmRwYV9yZW1vdmUoc3RydWN0IG1seDVfY29yZV9k
ZXYgKm1kZXYsIHZvaWQgKmNvbnRleHQpCj4gK3sKPiArCXN0cnVjdCBtbHg1X3ZkcGFfZGV2ICp2
ZGV2ID0gY29udGV4dDsKPiArCj4gKwltbHg1X3ZkcGFfcmVtb3ZlX2Rldih2ZGV2KTsKPiArfQo+
ICsKPiArc3RhdGljIHN0cnVjdCBtbHg1X2ludGVyZmFjZSBtbHg1X3ZkcGFfaW50ZXJmYWNlID0g
ewo+ICsJLmFkZCA9IG1seDVfdmRwYV9hZGQsCj4gKwkucmVtb3ZlID0gbWx4NV92ZHBhX3JlbW92
ZSwKPiArCS5wcm90b2NvbCA9IE1MWDVfSU5URVJGQUNFX1BST1RPQ09MX1ZEUEEsCj4gK307Cj4g
Kwo+ICtzdGF0aWMgaW50IF9faW5pdCBtbHg1X3ZkcGFfaW5pdCh2b2lkKQo+ICt7Cj4gKwlyZXR1
cm4gbWx4NV9yZWdpc3Rlcl9pbnRlcmZhY2UoJm1seDVfdmRwYV9pbnRlcmZhY2UpOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgdm9pZCBfX2V4aXQgbWx4NV92ZHBhX2V4aXQodm9pZCkKPiArewo+ICsJbWx4
NV91bnJlZ2lzdGVyX2ludGVyZmFjZSgmbWx4NV92ZHBhX2ludGVyZmFjZSk7Cj4gK30KPiArCj4g
K21vZHVsZV9pbml0KG1seDVfdmRwYV9pbml0KTsKPiArbW9kdWxlX2V4aXQobWx4NV92ZHBhX2V4
aXQpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3ZkcGEvbWx4NS9uZXQvbWx4NV92bmV0LmMgYi9k
cml2ZXJzL3ZkcGEvbWx4NS9uZXQvbWx4NV92bmV0LmMKPiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+
IGluZGV4IDAwMDAwMDAwMDAwMC4uZjdkM2M3YTBlYjkyCj4gLS0tIC9kZXYvbnVsbAo+ICsrKyBi
L2RyaXZlcnMvdmRwYS9tbHg1L25ldC9tbHg1X3ZuZXQuYwo+IEBAIC0wLDAgKzEsMTk2NiBAQAo+
ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCBPUiBMaW51eC1PcGVuSUIKPiAr
LyogQ29weXJpZ2h0IChjKSAyMDIwIE1lbGxhbm94IFRlY2hub2xvZ2llcyBMdGQuICovCj4gKwo+
ICsjaW5jbHVkZSA8bGludXgvdmRwYS5oPgo+ICsjaW5jbHVkZSA8dWFwaS9saW51eC92aXJ0aW9f
aWRzLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC92aXJ0aW9fY29uZmlnLmg+Cj4gKyNpbmNsdWRlIDxs
aW51eC9tbHg1L3FwLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9tbHg1L2RldmljZS5oPgo+ICsjaW5j
bHVkZSA8bGludXgvbWx4NS92cG9ydC5oPgo+ICsjaW5jbHVkZSA8bGludXgvbWx4NS9mcy5oPgo+
ICsjaW5jbHVkZSA8bGludXgvbWx4NS9kZXZpY2UuaD4KPiArI2luY2x1ZGUgIm1seDVfdm5ldC5o
Igo+ICsjaW5jbHVkZSAiLi4vY29yZS9tbHg1X3ZkcGFfaWZjLmgiCj4gKyNpbmNsdWRlICIuLi9j
b3JlL21seDVfdmRwYS5oIgo+ICsKPiArI2RlZmluZSB0b19tdmRldihfX3ZkZXYpIGNvbnRhaW5l
cl9vZigoX192ZGV2KSwgc3RydWN0IG1seDVfdmRwYV9kZXYsIHZkZXYpCj4gKwo+ICsjZGVmaW5l
IFZBTElEX0ZFQVRVUkVTX01BU0sgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCj4gKwkoQklUKFZJUlRJT19ORVRf
Rl9DU1VNKSB8IEJJVChWSVJUSU9fTkVUX0ZfR1VFU1RfQ1NVTSkgfCAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAo+ICsJIEJJVChWSVJUSU9fTkVUX0ZfQ1RSTF9HVUVTVF9PRkZM
T0FEUykgfCBCSVQoVklSVElPX05FVF9GX01UVSkgfCBCSVQoVklSVElPX05FVF9GX01BQykgfCAg
IFwKPiArCSBCSVQoVklSVElPX05FVF9GX0dVRVNUX1RTTzQpIHwgQklUKFZJUlRJT19ORVRfRl9H
VUVTVF9UU082KSB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCj4gKwkgQklUKFZJUlRJ
T19ORVRfRl9HVUVTVF9FQ04pIHwgQklUKFZJUlRJT19ORVRfRl9HVUVTVF9VRk8pIHwgQklUKFZJ
UlRJT19ORVRfRl9IT1NUX1RTTzQpIHwgXAo+ICsJIEJJVChWSVJUSU9fTkVUX0ZfSE9TVF9UU082
KSB8IEJJVChWSVJUSU9fTkVUX0ZfSE9TVF9FQ04pIHwgQklUKFZJUlRJT19ORVRfRl9IT1NUX1VG
TykgfCAgIFwKPiArCSBCSVQoVklSVElPX05FVF9GX01SR19SWEJVRikgfCBCSVQoVklSVElPX05F
VF9GX1NUQVRVUykgfCBCSVQoVklSVElPX05FVF9GX0NUUkxfVlEpIHwgICAgICBcCj4gKwkgQklU
KFZJUlRJT19ORVRfRl9DVFJMX1JYKSB8IEJJVChWSVJUSU9fTkVUX0ZfQ1RSTF9WTEFOKSB8ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ICsJIEJJVChWSVJUSU9fTkVUX0ZfQ1RS
TF9SWF9FWFRSQSkgfCBCSVQoVklSVElPX05FVF9GX0dVRVNUX0FOTk9VTkNFKSB8ICAgICAgICAg
ICAgICAgICAgICAgIFwKPiArCSBCSVQoVklSVElPX05FVF9GX01RKSB8IEJJVChWSVJUSU9fTkVU
X0ZfQ1RSTF9NQUNfQUREUikgfCBCSVQoVklSVElPX05FVF9GX0hBU0hfUkVQT1JUKSB8ICBcCj4g
KwkgQklUKFZJUlRJT19ORVRfRl9SU1MpIHwgQklUKFZJUlRJT19ORVRfRl9SU0NfRVhUKSB8IEJJ
VChWSVJUSU9fTkVUX0ZfU1RBTkRCWSkgfCAgICAgICAgICAgXAo+ICsJIEJJVChWSVJUSU9fTkVU
X0ZfU1BFRURfRFVQTEVYKSB8IEJJVChWSVJUSU9fRl9OT1RJRllfT05fRU1QVFkpIHwgICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKPiArCSBCSVQoVklSVElPX0ZfQU5ZX0xBWU9VVCkgfCBCSVQo
VklSVElPX0ZfVkVSU0lPTl8xKSB8IEJJVChWSVJUSU9fRl9JT01NVV9QTEFURk9STSkgfCAgICAg
ICBcCj4gKwkgQklUKFZJUlRJT19GX1JJTkdfUEFDS0VEKSB8IEJJVChWSVJUSU9fRl9PUkRFUl9Q
TEFURk9STSkgfCBCSVQoVklSVElPX0ZfU1JfSU9WKSkKPiArCj4gKyNkZWZpbmUgVkFMSURfU1RB
VFVTX01BU0sgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKPiArCShWSVJUSU9fQ09ORklHX1NfQUNLTk9XTEVE
R0UgfCBWSVJUSU9fQ09ORklHX1NfRFJJVkVSIHwgVklSVElPX0NPTkZJR19TX0RSSVZFUl9PSyB8
ICAgICAgICBcCj4gKwkgVklSVElPX0NPTkZJR19TX0ZFQVRVUkVTX09LIHwgVklSVElPX0NPTkZJ
R19TX05FRURTX1JFU0VUIHwgVklSVElPX0NPTkZJR19TX0ZBSUxFRCkKPiArCj4gK3N0cnVjdCBt
bHg1X3ZkcGFfbmV0X3Jlc291cmNlcyB7Cj4gKwl1MzIgdGlzbjsKPiArCXUzMiB0ZG47Cj4gKwl1
MzIgdGlybjsKPiArCXUzMiBycXRuOwo+ICsJYm9vbCB2YWxpZDsKPiArfTsKPiArCj4gK3N0cnVj
dCBtbHg1X3ZkcGFfY3FfYnVmIHsKPiArCXN0cnVjdCBtbHg1X2ZyYWdfYnVmX2N0cmwgZmJjOwo+
ICsJc3RydWN0IG1seDVfZnJhZ19idWYgZnJhZ19idWY7Cj4gKwlpbnQgY3FlX3NpemU7Cj4gKwlp
bnQgbmVudDsKPiArfTsKPiArCj4gK3N0cnVjdCBtbHg1X3ZkcGFfY3Egewo+ICsJc3RydWN0IG1s
eDVfY29yZV9jcSBtY3E7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX2NxX2J1ZiBidWY7Cj4gKwlzdHJ1
Y3QgbWx4NV9kYiBkYjsKPiArCWludCBjcWU7Cj4gK307Cj4gKwo+ICtzdHJ1Y3QgbWx4NV92ZHBh
X3VtZW0gewo+ICsJc3RydWN0IG1seDVfZnJhZ19idWZfY3RybCBmYmM7Cj4gKwlzdHJ1Y3QgbWx4
NV9mcmFnX2J1ZiBmcmFnX2J1ZjsKPiArCWludCBzaXplOwo+ICsJdTMyIGlkOwo+ICt9Owo+ICsK
PiArc3RydWN0IG1seDVfdmRwYV9xcCB7Cj4gKwlzdHJ1Y3QgbWx4NV9jb3JlX3FwIG1xcDsKPiAr
CXN0cnVjdCBtbHg1X2ZyYWdfYnVmIGZyYWdfYnVmOwo+ICsJc3RydWN0IG1seDVfZGIgZGI7Cj4g
Kwl1MTYgaGVhZDsKPiArCWJvb2wgZnc7Cj4gK307Cj4gKwo+ICtzdHJ1Y3QgbWx4NV92cV9yZXN0
b3JlX2luZm8gewo+ICsJdTMyIG51bV9lbnQ7Cj4gKwl1NjQgZGVzY19hZGRyOwo+ICsJdTY0IGRl
dmljZV9hZGRyOwo+ICsJdTY0IGRyaXZlcl9hZGRyOwo+ICsJdTE2IGF2YWlsX2luZGV4Owo+ICsJ
Ym9vbCByZWFkeTsKPiArCXN0cnVjdCB2ZHBhX2NhbGxiYWNrIGNiOwo+ICsJYm9vbCByZXN0b3Jl
Owo+ICt9Owo+ICsKPiArc3RydWN0IG1seDVfdmRwYV92aXJ0cXVldWUgewo+ICsJYm9vbCByZWFk
eTsKPiArCXU2NCBkZXNjX2FkZHI7Cj4gKwl1NjQgZGV2aWNlX2FkZHI7Cj4gKwl1NjQgZHJpdmVy
X2FkZHI7Cj4gKwl1MzIgbnVtX2VudDsKPiArCXN0cnVjdCB2ZHBhX2NhbGxiYWNrIGV2ZW50X2Ni
Owo+ICsKPiArCS8qIFJlc291cmNlcyBmb3IgaW1wbGVtZW50aW5nIHRoZSBub3RpZmljYXRpb24g
Y2hhbm5lbCBmcm9tIHRoZSBkZXZpY2UKPiArCSAqIHRvIHRoZSBkcml2ZXIuIGZ3cXAgaXMgdGhl
IGZpcm13YXJlIGVuZCBvZiBhbiBSQyBjb25uZWN0aW9uOyB0aGUKPiArCSAqIG90aGVyIGVuZCBp
cyB2cXFwIHVzZWQgYnkgdGhlIGRyaXZlci4gY3EgaXMgaXMgd2hlcmUgY29tcGxldGlvbnMgYXJl
Cj4gKwkgKiByZXBvcnRlZC4KPiArCSAqLwo+ICsJc3RydWN0IG1seDVfdmRwYV9jcSBjcTsKPiAr
CXN0cnVjdCBtbHg1X3ZkcGFfcXAgZndxcDsKPiArCXN0cnVjdCBtbHg1X3ZkcGFfcXAgdnFxcDsK
PiArCj4gKwkvKiB1bWVtIHJlc291cmNlcyBhcmUgcmVxdWlyZWQgZm9yIHRoZSB2aXJ0cXVldWUg
b3BlcmF0aW9uLiBUaGV5J3JlIHVzZQo+ICsJICogaXMgaW50ZXJuYWwgYW5kIHRoZXkgbXVzdCBi
ZSBwcm92aWRlZCBieSB0aGUgZHJpdmVyLgo+ICsJICovCj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX3Vt
ZW0gdW1lbTE7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX3VtZW0gdW1lbTI7Cj4gKwlzdHJ1Y3QgbWx4
NV92ZHBhX3VtZW0gdW1lbTM7Cj4gKwo+ICsJYm9vbCBpbml0aWFsaXplZDsKPiArCWludCBpbmRl
eDsKPiArCXUzMiB2aXJ0cV9pZDsKPiArCXN0cnVjdCBtbHg1X3ZkcGFfbmV0ICpuZGV2Owo+ICsJ
dTE2IGF2YWlsX2lkeDsKPiArCWludCBmd19zdGF0ZTsKPiArCj4gKwkvKiBrZWVwIGxhc3QgaW4g
dGhlIHN0cnVjdCAqLwo+ICsJc3RydWN0IG1seDVfdnFfcmVzdG9yZV9pbmZvIHJpOwo+ICt9Owo+
ICsKPiArLyogV2Ugd2lsbCByZW1vdmUgdGhpcyBsaW1pdGF0aW9uIG9uY2UgbWx4NV92ZHBhX2Fs
bG9jX3Jlc291cmNlcygpCj4gKyAqIHByb3ZpZGVzIGZvciBkcml2ZXIgc3BhY2UgYWxsb2NhdGlv
bgo+ICsgKi8KPiArI2RlZmluZSBNTFg1X01BWF9TVVBQT1JURURfVlFTIDE2Cj4gKwo+ICtzdHJ1
Y3QgbWx4NV92ZHBhX25ldCB7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX2RldiBtdmRldjsKPiArCXN0
cnVjdCBtbHg1X3ZkcGFfbmV0X3Jlc291cmNlcyByZXM7Cj4gKwlzdHJ1Y3QgdmlydGlvX25ldF9j
b25maWcgY29uZmlnOwo+ICsJc3RydWN0IG1seDVfdmRwYV92aXJ0cXVldWUgdnFzW01MWDVfTUFY
X1NVUFBPUlRFRF9WUVNdOwo+ICsKPiArCS8qIFNlcmlhbGl6ZSB2cSByZXNvdXJjZXMgY3JlYXRp
b24gYW5kIGRlc3RydWN0aW9uLiBUaGlzIGlzIHJlcXVpcmVkCj4gKwkgKiBzaW5jZSBtZW1vcnkg
bWFwIG1pZ2h0IGNoYW5nZSBhbmQgd2UgbmVlZCB0byBkZXN0cm95IGFuZCBjcmVhdGUKPiArCSAq
IHJlc291cmNlcyB3aGlsZSBkcml2ZXIgaW4gb3BlcmF0aW9uYWwuCj4gKwkgKi8KPiArCXN0cnVj
dCBtdXRleCByZXNsb2NrOwo+ICsJc3RydWN0IG1seDVfZmxvd190YWJsZSAqcnhmdDsKPiArCXN0
cnVjdCBtbHg1X2ZjICpyeF9jb3VudGVyOwo+ICsJc3RydWN0IG1seDVfZmxvd19oYW5kbGUgKnJ4
X3J1bGU7Cj4gKwlib29sIHNldHVwOwo+ICt9Owo+ICsKPiArc3RhdGljIHZvaWQgZnJlZV9yZXNv
dXJjZXMoc3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYpOwo+ICtzdGF0aWMgdm9pZCBpbml0X212
cXMoc3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYpOwo+ICtzdGF0aWMgaW50IHNldHVwX2RyaXZl
cihzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldik7Cj4gK3N0YXRpYyB2b2lkIHRlYXJkb3duX2Ry
aXZlcihzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldik7Cj4gKwo+ICtzdGF0aWMgYm9vbCBtbHg1
X3ZkcGFfZGVidWc7Cj4gKwo+ICsjZGVmaW5lIE1MWDVfTE9HX1ZJT19GTEFHKF9mZWF0dXJlKSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBcCj4gKwlkbyB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ICsJCWlmIChm
ZWF0dXJlcyAmIEJJVChfZmVhdHVyZSkpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgXAo+ICsJCQltbHg1X3ZkcGFfaW5mbyhtdmRldiwgIiVzXG4i
LCAjX2ZlYXR1cmUpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCj4gKwl9IHdo
aWxlICgwKQo+ICsKPiArI2RlZmluZSBNTFg1X0xPR19WSU9fU1RBVChfc3RhdHVzKSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
XAo+ICsJZG8geyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKPiArCQlpZiAoc3RhdHVz
ICYgKF9zdGF0dXMpKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFwKPiArCQkJbWx4NV92ZHBhX2luZm8obXZkZXYsICIlc1xuIiwgI19z
dGF0dXMpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ICsJfSB3aGlsZSAo
MCkKPiArCj4gK3N0YXRpYyB2b2lkIHByaW50X3N0YXR1cyhzdHJ1Y3QgbWx4NV92ZHBhX2RldiAq
bXZkZXYsIHU4IHN0YXR1cywgYm9vbCBzZXQpCj4gK3sKPiArCWlmIChzdGF0dXMgJiB+VkFMSURf
U1RBVFVTX01BU0spCj4gKwkJbWx4NV92ZHBhX3dhcm4obXZkZXYsICJXYXJuaW5nOiB0aGVyZSBh
cmUgaW52YWxpZCBzdGF0dXMgYml0cyAweCV4XG4iLAo+ICsJCQkgICAgICAgc3RhdHVzICYgflZB
TElEX1NUQVRVU19NQVNLKTsKPiArCj4gKwlpZiAoIW1seDVfdmRwYV9kZWJ1ZykKPiArCQlyZXR1
cm47Cj4gKwo+ICsJbWx4NV92ZHBhX2luZm8obXZkZXYsICJkcml2ZXIgc3RhdHVzICVzIiwgc2V0
ID8gInNldCIgOiAiZ2V0Iik7Cj4gKwlpZiAoc2V0ICYmICFzdGF0dXMpIHsKPiArCQltbHg1X3Zk
cGFfaW5mbyhtdmRldiwgImRyaXZlciByZXNldHMgdGhlIGRldmljZVxuIik7Cj4gKwkJcmV0dXJu
Owo+ICsJfQo+ICsKPiArCU1MWDVfTE9HX1ZJT19TVEFUKFZJUlRJT19DT05GSUdfU19BQ0tOT1dM
RURHRSk7Cj4gKwlNTFg1X0xPR19WSU9fU1RBVChWSVJUSU9fQ09ORklHX1NfRFJJVkVSKTsKPiAr
CU1MWDVfTE9HX1ZJT19TVEFUKFZJUlRJT19DT05GSUdfU19EUklWRVJfT0spOwo+ICsJTUxYNV9M
T0dfVklPX1NUQVQoVklSVElPX0NPTkZJR19TX0ZFQVRVUkVTX09LKTsKPiArCU1MWDVfTE9HX1ZJ
T19TVEFUKFZJUlRJT19DT05GSUdfU19ORUVEU19SRVNFVCk7Cj4gKwlNTFg1X0xPR19WSU9fU1RB
VChWSVJUSU9fQ09ORklHX1NfRkFJTEVEKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgcHJpbnRf
ZmVhdHVyZXMoc3RydWN0IG1seDVfdmRwYV9kZXYgKm12ZGV2LCB1NjQgZmVhdHVyZXMsIGJvb2wg
c2V0KQo+ICt7Cj4gKwlpZiAoZmVhdHVyZXMgJiB+VkFMSURfRkVBVFVSRVNfTUFTSykKPiArCQlt
bHg1X3ZkcGFfd2FybihtdmRldiwgIlRoZXJlIGFyZSBpbnZhbGlkIGZlYXR1cmUgYml0cyAweCVs
bHhcbiIsCj4gKwkJCSAgICAgICBmZWF0dXJlcyAmIH5WQUxJRF9GRUFUVVJFU19NQVNLKTsKPiAr
Cj4gKwlpZiAoIW1seDVfdmRwYV9kZWJ1ZykKPiArCQlyZXR1cm47Cj4gKwo+ICsJbWx4NV92ZHBh
X2luZm8obXZkZXYsICJkcml2ZXIgJXMgZmVhdHVyZSBiaXRzOlxuIiwgc2V0ID8gInNldHMiIDog
InJlYWRzIik7Cj4gKwlpZiAoIWZlYXR1cmVzKQo+ICsJCW1seDVfdmRwYV9pbmZvKG12ZGV2LCAi
YWxsIGZlYXR1cmUgYml0cyBhcmUgY2xlYXJlZFxuIik7Cj4gKwo+ICsJTUxYNV9MT0dfVklPX0ZM
QUcoVklSVElPX05FVF9GX0NTVU0pOwo+ICsJTUxYNV9MT0dfVklPX0ZMQUcoVklSVElPX05FVF9G
X0dVRVNUX0NTVU0pOwo+ICsJTUxYNV9MT0dfVklPX0ZMQUcoVklSVElPX05FVF9GX0NUUkxfR1VF
U1RfT0ZGTE9BRFMpOwo+ICsJTUxYNV9MT0dfVklPX0ZMQUcoVklSVElPX05FVF9GX01UVSk7Cj4g
KwlNTFg1X0xPR19WSU9fRkxBRyhWSVJUSU9fTkVUX0ZfTUFDKTsKPiArCU1MWDVfTE9HX1ZJT19G
TEFHKFZJUlRJT19ORVRfRl9HVUVTVF9UU080KTsKPiArCU1MWDVfTE9HX1ZJT19GTEFHKFZJUlRJ
T19ORVRfRl9HVUVTVF9UU082KTsKPiArCU1MWDVfTE9HX1ZJT19GTEFHKFZJUlRJT19ORVRfRl9H
VUVTVF9FQ04pOwo+ICsJTUxYNV9MT0dfVklPX0ZMQUcoVklSVElPX05FVF9GX0dVRVNUX1VGTyk7
Cj4gKwlNTFg1X0xPR19WSU9fRkxBRyhWSVJUSU9fTkVUX0ZfSE9TVF9UU080KTsKPiArCU1MWDVf
TE9HX1ZJT19GTEFHKFZJUlRJT19ORVRfRl9IT1NUX1RTTzYpOwo+ICsJTUxYNV9MT0dfVklPX0ZM
QUcoVklSVElPX05FVF9GX0hPU1RfRUNOKTsKPiArCU1MWDVfTE9HX1ZJT19GTEFHKFZJUlRJT19O
RVRfRl9IT1NUX1VGTyk7Cj4gKwlNTFg1X0xPR19WSU9fRkxBRyhWSVJUSU9fTkVUX0ZfTVJHX1JY
QlVGKTsKPiArCU1MWDVfTE9HX1ZJT19GTEFHKFZJUlRJT19ORVRfRl9TVEFUVVMpOwo+ICsJTUxY
NV9MT0dfVklPX0ZMQUcoVklSVElPX05FVF9GX0NUUkxfVlEpOwo+ICsJTUxYNV9MT0dfVklPX0ZM
QUcoVklSVElPX05FVF9GX0NUUkxfUlgpOwo+ICsJTUxYNV9MT0dfVklPX0ZMQUcoVklSVElPX05F
VF9GX0NUUkxfVkxBTik7Cj4gKwlNTFg1X0xPR19WSU9fRkxBRyhWSVJUSU9fTkVUX0ZfQ1RSTF9S
WF9FWFRSQSk7Cj4gKwlNTFg1X0xPR19WSU9fRkxBRyhWSVJUSU9fTkVUX0ZfR1VFU1RfQU5OT1VO
Q0UpOwo+ICsJTUxYNV9MT0dfVklPX0ZMQUcoVklSVElPX05FVF9GX01RKTsKPiArCU1MWDVfTE9H
X1ZJT19GTEFHKFZJUlRJT19ORVRfRl9DVFJMX01BQ19BRERSKTsKPiArCU1MWDVfTE9HX1ZJT19G
TEFHKFZJUlRJT19ORVRfRl9IQVNIX1JFUE9SVCk7Cj4gKwlNTFg1X0xPR19WSU9fRkxBRyhWSVJU
SU9fTkVUX0ZfUlNTKTsKPiArCU1MWDVfTE9HX1ZJT19GTEFHKFZJUlRJT19ORVRfRl9SU0NfRVhU
KTsKPiArCU1MWDVfTE9HX1ZJT19GTEFHKFZJUlRJT19ORVRfRl9TVEFOREJZKTsKPiArCU1MWDVf
TE9HX1ZJT19GTEFHKFZJUlRJT19ORVRfRl9TUEVFRF9EVVBMRVgpOwo+ICsJTUxYNV9MT0dfVklP
X0ZMQUcoVklSVElPX0ZfTk9USUZZX09OX0VNUFRZKTsKPiArCU1MWDVfTE9HX1ZJT19GTEFHKFZJ
UlRJT19GX0FOWV9MQVlPVVQpOwo+ICsJTUxYNV9MT0dfVklPX0ZMQUcoVklSVElPX0ZfVkVSU0lP
Tl8xKTsKPiArCU1MWDVfTE9HX1ZJT19GTEFHKFZJUlRJT19GX0lPTU1VX1BMQVRGT1JNKTsKPiAr
CU1MWDVfTE9HX1ZJT19GTEFHKFZJUlRJT19GX1JJTkdfUEFDS0VEKTsKPiArCU1MWDVfTE9HX1ZJ
T19GTEFHKFZJUlRJT19GX09SREVSX1BMQVRGT1JNKTsKPiArCU1MWDVfTE9HX1ZJT19GTEFHKFZJ
UlRJT19GX1NSX0lPVik7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgY3JlYXRlX3RpcyhzdHJ1Y3Qg
bWx4NV92ZHBhX25ldCAqbmRldikKPiArewo+ICsJc3RydWN0IG1seDVfdmRwYV9kZXYgKm12ZGV2
ID0gJm5kZXYtPm12ZGV2Owo+ICsJdTMyIGluW01MWDVfU1RfU1pfRFcoY3JlYXRlX3Rpc19pbild
ID0ge307Cj4gKwl2b2lkICp0aXNjOwo+ICsJaW50IGVycjsKPiArCj4gKwl0aXNjID0gTUxYNV9B
RERSX09GKGNyZWF0ZV90aXNfaW4sIGluLCBjdHgpOwo+ICsJTUxYNV9TRVQodGlzYywgdGlzYywg
dHJhbnNwb3J0X2RvbWFpbiwgbmRldi0+cmVzLnRkbik7Cj4gKwllcnIgPSBtbHg1X3ZkcGFfY3Jl
YXRlX3RpcyhtdmRldiwgaW4sICZuZGV2LT5yZXMudGlzbik7Cj4gKwlpZiAoZXJyKQo+ICsJCW1s
eDVfdmRwYV93YXJuKG12ZGV2LCAiY3JlYXRlIFRJUyAoJWQpXG4iLCBlcnIpOwo+ICsKPiArCXJl
dHVybiBlcnI7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGRlc3Ryb3lfdGlzKHN0cnVjdCBtbHg1
X3ZkcGFfbmV0ICpuZGV2KQo+ICt7Cj4gKwltbHg1X3ZkcGFfZGVzdHJveV90aXMoJm5kZXYtPm12
ZGV2LCBuZGV2LT5yZXMudGlzbik7Cj4gK30KPiArCj4gKyNkZWZpbmUgTUxYNV9WRFBBX0NRRV9T
SVpFIDY0Cj4gKyNkZWZpbmUgTUxYNV9WRFBBX0xPR19DUUVfU0laRSBpbG9nMihNTFg1X1ZEUEFf
Q1FFX1NJWkUpCj4gKwo+ICtzdGF0aWMgaW50IGNxX2ZyYWdfYnVmX2FsbG9jKHN0cnVjdCBtbHg1
X3ZkcGFfbmV0ICpuZGV2LCBzdHJ1Y3QgbWx4NV92ZHBhX2NxX2J1ZiAqYnVmLCBpbnQgbmVudCkK
PiArewo+ICsJc3RydWN0IG1seDVfZnJhZ19idWYgKmZyYWdfYnVmID0gJmJ1Zi0+ZnJhZ19idWY7
Cj4gKwl1OCBsb2dfd3Ffc3RyaWRlID0gTUxYNV9WRFBBX0xPR19DUUVfU0laRTsKPiArCXU4IGxv
Z193cV9zeiA9IE1MWDVfVkRQQV9MT0dfQ1FFX1NJWkU7Cj4gKwlpbnQgZXJyOwo+ICsKPiArCWVy
ciA9IG1seDVfZnJhZ19idWZfYWxsb2Nfbm9kZShuZGV2LT5tdmRldi5tZGV2LCBuZW50ICogTUxY
NV9WRFBBX0NRRV9TSVpFLCBmcmFnX2J1ZiwKPiArCQkJCSAgICAgICBuZGV2LT5tdmRldi5tZGV2
LT5wcml2Lm51bWFfbm9kZSk7Cj4gKwlpZiAoZXJyKQo+ICsJCXJldHVybiBlcnI7Cj4gKwo+ICsJ
bWx4NV9pbml0X2ZiYyhmcmFnX2J1Zi0+ZnJhZ3MsIGxvZ193cV9zdHJpZGUsIGxvZ193cV9zeiwg
JmJ1Zi0+ZmJjKTsKPiArCj4gKwlidWYtPmNxZV9zaXplID0gTUxYNV9WRFBBX0NRRV9TSVpFOwo+
ICsJYnVmLT5uZW50ID0gbmVudDsKPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGlj
IGludCB1bWVtX2ZyYWdfYnVmX2FsbG9jKHN0cnVjdCBtbHg1X3ZkcGFfbmV0ICpuZGV2LCBzdHJ1
Y3QgbWx4NV92ZHBhX3VtZW0gKnVtZW0sIGludCBzaXplKQo+ICt7Cj4gKwlzdHJ1Y3QgbWx4NV9m
cmFnX2J1ZiAqZnJhZ19idWYgPSAmdW1lbS0+ZnJhZ19idWY7Cj4gKwo+ICsJcmV0dXJuIG1seDVf
ZnJhZ19idWZfYWxsb2Nfbm9kZShuZGV2LT5tdmRldi5tZGV2LCBzaXplLCBmcmFnX2J1ZiwKPiAr
CQkJCQluZGV2LT5tdmRldi5tZGV2LT5wcml2Lm51bWFfbm9kZSk7Cj4gK30KPiArCj4gK3N0YXRp
YyB2b2lkIGNxX2ZyYWdfYnVmX2ZyZWUoc3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYsIHN0cnVj
dCBtbHg1X3ZkcGFfY3FfYnVmICpidWYpCj4gK3sKPiArCW1seDVfZnJhZ19idWZfZnJlZShuZGV2
LT5tdmRldi5tZGV2LCAmYnVmLT5mcmFnX2J1Zik7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkICpn
ZXRfY3FlKHN0cnVjdCBtbHg1X3ZkcGFfY3EgKnZjcSwgaW50IG4pCj4gK3sKPiArCXJldHVybiBt
bHg1X2ZyYWdfYnVmX2dldF93cWUoJnZjcS0+YnVmLmZiYywgbik7Cj4gK30KPiArCj4gK3N0YXRp
YyB2b2lkIGNxX2ZyYWdfYnVmX2luaXQoc3RydWN0IG1seDVfdmRwYV9jcSAqdmNxLCBzdHJ1Y3Qg
bWx4NV92ZHBhX2NxX2J1ZiAqYnVmKQo+ICt7Cj4gKwlzdHJ1Y3QgbWx4NV9jcWU2NCAqY3FlNjQ7
Cj4gKwl2b2lkICpjcWU7Cj4gKwlpbnQgaTsKPiArCj4gKwlmb3IgKGkgPSAwOyBpIDwgYnVmLT5u
ZW50OyBpKyspIHsKPiArCQljcWUgPSBnZXRfY3FlKHZjcSwgaSk7Cj4gKwkJY3FlNjQgPSBjcWU7
Cj4gKwkJY3FlNjQtPm9wX293biA9IE1MWDVfQ1FFX0lOVkFMSUQgPDwgNDsKPiArCX0KPiArfQo+
ICsKPiArc3RhdGljIHZvaWQgKmdldF9zd19jcWUoc3RydWN0IG1seDVfdmRwYV9jcSAqY3EsIGlu
dCBuKQo+ICt7Cj4gKwlzdHJ1Y3QgbWx4NV9jcWU2NCAqY3FlNjQgPSBnZXRfY3FlKGNxLCBuICYg
KGNxLT5jcWUgLSAxKSk7Cj4gKwo+ICsJaWYgKGxpa2VseShnZXRfY3FlX29wY29kZShjcWU2NCkg
IT0gTUxYNV9DUUVfSU5WQUxJRCkgJiYKPiArCSAgICAhKChjcWU2NC0+b3Bfb3duICYgTUxYNV9D
UUVfT1dORVJfTUFTSykgXiAhIShuICYgY3EtPmNxZSkpKQo+ICsJCXJldHVybiBjcWU2NDsKPiAr
Cj4gKwlyZXR1cm4gTlVMTDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgcnhfcG9zdChzdHJ1Y3Qg
bWx4NV92ZHBhX3FwICp2cXAsIGludCBuKQo+ICt7Cj4gKwl2cXAtPmhlYWQgKz0gbjsKPiArCXZx
cC0+ZGIuZGJbMF0gPSBjcHVfdG9fYmUzMih2cXAtPmhlYWQpOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
dm9pZCBxcF9wcmVwYXJlKHN0cnVjdCBtbHg1X3ZkcGFfbmV0ICpuZGV2LCBib29sIGZ3LCB2b2lk
ICppbiwKPiArCQkgICAgICAgc3RydWN0IG1seDVfdmRwYV92aXJ0cXVldWUgKm12cSwgdTMyIG51
bV9lbnQpCj4gK3sKPiArCXN0cnVjdCBtbHg1X3ZkcGFfcXAgKnZxcDsKPiArCV9fYmU2NCAqcGFz
Owo+ICsJdm9pZCAqcXBjOwo+ICsKPiArCXZxcCA9IGZ3ID8gJm12cS0+ZndxcCA6ICZtdnEtPnZx
cXA7Cj4gKwlNTFg1X1NFVChjcmVhdGVfcXBfaW4sIGluLCB1aWQsIG5kZXYtPm12ZGV2LnJlcy51
aWQpOwo+ICsJcXBjID0gTUxYNV9BRERSX09GKGNyZWF0ZV9xcF9pbiwgaW4sIHFwYyk7Cj4gKwlp
ZiAodnFwLT5mdykgewo+ICsJCS8qIEZpcm13YXJlIFFQIGlzIGFsbG9jYXRlZCBieSB0aGUgZHJp
dmVyIGZvciB0aGUgZmlybXdhcmUncwo+ICsJCSAqIHVzZSBzbyB3ZSBjYW4gc2tpcCBwYXJ0IG9m
IHRoZSBwYXJhbXMgYXMgdGhleSB3aWxsIGJlIGNob3NlbiBieSBmaXJtd2FyZQo+ICsJCSAqLwo+
ICsJCXFwYyA9IE1MWDVfQUREUl9PRihjcmVhdGVfcXBfaW4sIGluLCBxcGMpOwo+ICsJCU1MWDVf
U0VUKHFwYywgcXBjLCBycV90eXBlLCBNTFg1X1pFUk9fTEVOX1JRKTsKPiArCQlNTFg1X1NFVChx
cGMsIHFwYywgbm9fc3EsIDEpOwo+ICsJCXJldHVybjsKPiArCX0KPiArCj4gKwlNTFg1X1NFVChx
cGMsIHFwYywgc3QsIE1MWDVfUVBfU1RfUkMpOwo+ICsJTUxYNV9TRVQocXBjLCBxcGMsIHBtX3N0
YXRlLCBNTFg1X1FQX1BNX01JR1JBVEVEKTsKPiArCU1MWDVfU0VUKHFwYywgcXBjLCBwZCwgbmRl
di0+bXZkZXYucmVzLnBkbik7Cj4gKwlNTFg1X1NFVChxcGMsIHFwYywgbXR1LCBNTFg1X1FQQ19N
VFVfMjU2X0JZVEVTKTsKPiArCU1MWDVfU0VUKHFwYywgcXBjLCB1YXJfcGFnZSwgbmRldi0+bXZk
ZXYucmVzLnVhci0+aW5kZXgpOwo+ICsJTUxYNV9TRVQocXBjLCBxcGMsIGxvZ19wYWdlX3NpemUs
IHZxcC0+ZnJhZ19idWYucGFnZV9zaGlmdCAtIE1MWDVfQURBUFRFUl9QQUdFX1NISUZUKTsKPiAr
CU1MWDVfU0VUKHFwYywgcXBjLCBub19zcSwgMSk7Cj4gKwlNTFg1X1NFVChxcGMsIHFwYywgY3Fu
X3JjdiwgbXZxLT5jcS5tY3EuY3FuKTsKPiArCU1MWDVfU0VUKHFwYywgcXBjLCBsb2dfcnFfc2l6
ZSwgaWxvZzIobnVtX2VudCkpOwo+ICsJTUxYNV9TRVQocXBjLCBxcGMsIHJxX3R5cGUsIE1MWDVf
Tk9OX1pFUk9fUlEpOwo+ICsJcGFzID0gKF9fYmU2NCAqKU1MWDVfQUREUl9PRihjcmVhdGVfcXBf
aW4sIGluLCBwYXMpOwo+ICsJbWx4NV9maWxsX3BhZ2VfZnJhZ19hcnJheSgmdnFwLT5mcmFnX2J1
ZiwgcGFzKTsKPiArfQo+ICsKPiArc3RhdGljIGludCBycV9idWZfYWxsb2Moc3RydWN0IG1seDVf
dmRwYV9uZXQgKm5kZXYsIHN0cnVjdCBtbHg1X3ZkcGFfcXAgKnZxcCwgdTMyIG51bV9lbnQpCj4g
K3sKPiArCXJldHVybiBtbHg1X2ZyYWdfYnVmX2FsbG9jX25vZGUobmRldi0+bXZkZXYubWRldiwK
PiArCQkJCQludW1fZW50ICogc2l6ZW9mKHN0cnVjdCBtbHg1X3dxZV9kYXRhX3NlZyksICZ2cXAt
PmZyYWdfYnVmLAo+ICsJCQkJCW5kZXYtPm12ZGV2Lm1kZXYtPnByaXYubnVtYV9ub2RlKTsKPiAr
fQo+ICsKPiArc3RhdGljIHZvaWQgcnFfYnVmX2ZyZWUoc3RydWN0IG1seDVfdmRwYV9uZXQgKm5k
ZXYsIHN0cnVjdCBtbHg1X3ZkcGFfcXAgKnZxcCkKPiArewo+ICsJbWx4NV9mcmFnX2J1Zl9mcmVl
KG5kZXYtPm12ZGV2Lm1kZXYsICZ2cXAtPmZyYWdfYnVmKTsKPiArfQo+ICsKPiArc3RhdGljIGlu
dCBxcF9jcmVhdGUoc3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYsIHN0cnVjdCBtbHg1X3ZkcGFf
dmlydHF1ZXVlICptdnEsCj4gKwkJICAgICBzdHJ1Y3QgbWx4NV92ZHBhX3FwICp2cXApCj4gK3sK
PiArCXN0cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2ID0gbmRldi0+bXZkZXYubWRldjsKPiArCWlu
dCBpbmxlbiA9IE1MWDVfU1RfU1pfQllURVMoY3JlYXRlX3FwX2luKTsKPiArCXUzMiBvdXRbTUxY
NV9TVF9TWl9EVyhjcmVhdGVfcXBfb3V0KV0gPSB7fTsKPiArCXZvaWQgKnFwYzsKPiArCXZvaWQg
KmluOwo+ICsJaW50IGVycjsKPiArCj4gKwlpZiAoIXZxcC0+ZncpIHsKPiArCQl2cXAgPSAmbXZx
LT52cXFwOwo+ICsJCWVyciA9IHJxX2J1Zl9hbGxvYyhuZGV2LCB2cXAsIG12cS0+bnVtX2VudCk7
Cj4gKwkJaWYgKGVycikKPiArCQkJcmV0dXJuIGVycjsKPiArCj4gKwkJZXJyID0gbWx4NV9kYl9h
bGxvYyhuZGV2LT5tdmRldi5tZGV2LCAmdnFwLT5kYik7Cj4gKwkJaWYgKGVycikKPiArCQkJZ290
byBlcnJfZGI7Cj4gKwkJaW5sZW4gKz0gdnFwLT5mcmFnX2J1Zi5ucGFnZXMgKiBzaXplb2YoX19i
ZTY0KTsKPiArCX0KPiArCj4gKwlpbiA9IGt6YWxsb2MoaW5sZW4sIEdGUF9LRVJORUwpOwo+ICsJ
aWYgKCFpbikgewo+ICsJCWVyciA9IC1FTk9NRU07Cj4gKwkJZ290byBlcnJfa3phbGxvYzsKPiAr
CX0KPiArCj4gKwlxcF9wcmVwYXJlKG5kZXYsIHZxcC0+ZncsIGluLCBtdnEsIG12cS0+bnVtX2Vu
dCk7Cj4gKwlxcGMgPSBNTFg1X0FERFJfT0YoY3JlYXRlX3FwX2luLCBpbiwgcXBjKTsKPiArCU1M
WDVfU0VUKHFwYywgcXBjLCBzdCwgTUxYNV9RUF9TVF9SQyk7Cj4gKwlNTFg1X1NFVChxcGMsIHFw
YywgcG1fc3RhdGUsIE1MWDVfUVBfUE1fTUlHUkFURUQpOwo+ICsJTUxYNV9TRVQocXBjLCBxcGMs
IHBkLCBuZGV2LT5tdmRldi5yZXMucGRuKTsKPiArCU1MWDVfU0VUKHFwYywgcXBjLCBtdHUsIE1M
WDVfUVBDX01UVV8yNTZfQllURVMpOwo+ICsJaWYgKCF2cXAtPmZ3KQo+ICsJCU1MWDVfU0VUNjQo
cXBjLCBxcGMsIGRicl9hZGRyLCB2cXAtPmRiLmRtYSk7Cj4gKwlNTFg1X1NFVChjcmVhdGVfcXBf
aW4sIGluLCBvcGNvZGUsIE1MWDVfQ01EX09QX0NSRUFURV9RUCk7Cj4gKwllcnIgPSBtbHg1X2Nt
ZF9leGVjKG1kZXYsIGluLCBpbmxlbiwgb3V0LCBzaXplb2Yob3V0KSk7Cj4gKwlrZnJlZShpbik7
Cj4gKwlpZiAoZXJyKQo+ICsJCWdvdG8gZXJyX2t6YWxsb2M7Cj4gKwo+ICsJdnFwLT5tcXAudWlk
ID0gTUxYNV9HRVQoY3JlYXRlX3FwX2luLCBpbiwgdWlkKTsKPiArCXZxcC0+bXFwLnFwbiA9IE1M
WDVfR0VUKGNyZWF0ZV9xcF9vdXQsIG91dCwgcXBuKTsKPiArCj4gKwlpZiAoIXZxcC0+ZncpCj4g
KwkJcnhfcG9zdCh2cXAsIG12cS0+bnVtX2VudCk7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gKwo+ICtl
cnJfa3phbGxvYzoKPiArCWlmICghdnFwLT5mdykKPiArCQltbHg1X2RiX2ZyZWUobmRldi0+bXZk
ZXYubWRldiwgJnZxcC0+ZGIpOwo+ICtlcnJfZGI6Cj4gKwlpZiAoIXZxcC0+ZncpCj4gKwkJcnFf
YnVmX2ZyZWUobmRldiwgdnFwKTsKPiArCj4gKwlyZXR1cm4gZXJyOwo+ICt9Cj4gKwo+ICtzdGF0
aWMgdm9pZCBxcF9kZXN0cm95KHN0cnVjdCBtbHg1X3ZkcGFfbmV0ICpuZGV2LCBzdHJ1Y3QgbWx4
NV92ZHBhX3FwICp2cXApCj4gK3sKPiArCXUzMiBpbltNTFg1X1NUX1NaX0RXKGRlc3Ryb3lfcXBf
aW4pXSA9IHt9Owo+ICsKPiArCU1MWDVfU0VUKGRlc3Ryb3lfcXBfaW4sIGluLCBvcGNvZGUsIE1M
WDVfQ01EX09QX0RFU1RST1lfUVApOwo+ICsJTUxYNV9TRVQoZGVzdHJveV9xcF9pbiwgaW4sIHFw
biwgdnFwLT5tcXAucXBuKTsKPiArCU1MWDVfU0VUKGRlc3Ryb3lfcXBfaW4sIGluLCB1aWQsIG5k
ZXYtPm12ZGV2LnJlcy51aWQpOwo+ICsJaWYgKG1seDVfY21kX2V4ZWNfaW4obmRldi0+bXZkZXYu
bWRldiwgZGVzdHJveV9xcCwgaW4pKQo+ICsJCW1seDVfdmRwYV93YXJuKCZuZGV2LT5tdmRldiwg
ImRlc3Ryb3kgcXAgMHgleFxuIiwgdnFwLT5tcXAucXBuKTsKPiArCWlmICghdnFwLT5mdykgewo+
ICsJCW1seDVfZGJfZnJlZShuZGV2LT5tdmRldi5tZGV2LCAmdnFwLT5kYik7Cj4gKwkJcnFfYnVm
X2ZyZWUobmRldiwgdnFwKTsKPiArCX0KPiArfQo+ICsKPiArc3RhdGljIHZvaWQgKm5leHRfY3Fl
X3N3KHN0cnVjdCBtbHg1X3ZkcGFfY3EgKmNxKQo+ICt7Cj4gKwlyZXR1cm4gZ2V0X3N3X2NxZShj
cSwgY3EtPm1jcS5jb25zX2luZGV4KTsKPiArfQo+ICsKPiArc3RhdGljIGludCBtbHg1X3ZkcGFf
cG9sbF9vbmUoc3RydWN0IG1seDVfdmRwYV9jcSAqdmNxKQo+ICt7Cj4gKwlzdHJ1Y3QgbWx4NV9j
cWU2NCAqY3FlNjQ7Cj4gKwo+ICsJY3FlNjQgPSBuZXh0X2NxZV9zdyh2Y3EpOwo+ICsJaWYgKCFj
cWU2NCkKPiArCQlyZXR1cm4gLUVBR0FJTjsKPiArCj4gKwl2Y3EtPm1jcS5jb25zX2luZGV4Kys7
Cj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgbWx4NV92ZHBhX2hhbmRsZV9j
b21wbGV0aW9ucyhzdHJ1Y3QgbWx4NV92ZHBhX3ZpcnRxdWV1ZSAqbXZxLCBpbnQgbnVtKQo+ICt7
Cj4gKwltbHg1X2NxX3NldF9jaSgmbXZxLT5jcS5tY3EpOwo+ICsJcnhfcG9zdCgmbXZxLT52cXFw
LCBudW0pOwo+ICsJaWYgKG12cS0+ZXZlbnRfY2IuY2FsbGJhY2spCj4gKwkJbXZxLT5ldmVudF9j
Yi5jYWxsYmFjayhtdnEtPmV2ZW50X2NiLnByaXZhdGUpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9p
ZCBtbHg1X3ZkcGFfY3FfY29tcChzdHJ1Y3QgbWx4NV9jb3JlX2NxICptY3EsIHN0cnVjdCBtbHg1
X2VxZSAqZXFlKQo+ICt7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX3ZpcnRxdWV1ZSAqbXZxID0gY29u
dGFpbmVyX29mKG1jcSwgc3RydWN0IG1seDVfdmRwYV92aXJ0cXVldWUsIGNxLm1jcSk7Cj4gKwlz
dHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldiA9IG12cS0+bmRldjsKPiArCXZvaWQgX19pb21lbSAq
dWFyX3BhZ2UgPSBuZGV2LT5tdmRldi5yZXMudWFyLT5tYXA7Cj4gKwlpbnQgbnVtID0gMDsKPiAr
Cj4gKwl3aGlsZSAoIW1seDVfdmRwYV9wb2xsX29uZSgmbXZxLT5jcSkpIHsKPiArCQludW0rKzsK
PiArCQlpZiAobnVtID4gbXZxLT5udW1fZW50IC8gMikgewo+ICsJCQkvKiBJZiBjb21wbGV0aW9u
cyBrZWVwIGNvbWluZyB3aGlsZSB3ZSBwb2xsLCB3ZSB3YW50IHRvCj4gKwkJCSAqIGxldCB0aGUg
aGFyZHdhcmUga25vdyB0aGF0IHdlIGNvbnN1bWVkIHRoZW0gYnkKPiArCQkJICogdXBkYXRpbmcg
dGhlIGRvb3JiZWxsIHJlY29yZC4gIFdlIGFsc28gbGV0IHZkcGEgY29yZQo+ICsJCQkgKiBrbm93
IGFib3V0IHRoaXMgc28gaXQgcGFzc2VzIGl0IG9uIHRoZSB2aXJ0aW8gZHJpdmVyCj4gKwkJCSAq
IG9uIHRoZSBndWVzdC4KPiArCQkJICovCj4gKwkJCW1seDVfdmRwYV9oYW5kbGVfY29tcGxldGlv
bnMobXZxLCBudW0pOwo+ICsJCQludW0gPSAwOwo+ICsJCX0KPiArCX0KPiArCj4gKwlpZiAobnVt
KQo+ICsJCW1seDVfdmRwYV9oYW5kbGVfY29tcGxldGlvbnMobXZxLCBudW0pOwo+ICsKPiArCW1s
eDVfY3FfYXJtKCZtdnEtPmNxLm1jcSwgTUxYNV9DUV9EQl9SRVFfTk9ULCB1YXJfcGFnZSwgbXZx
LT5jcS5tY3EuY29uc19pbmRleCk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgY3FfY3JlYXRlKHN0
cnVjdCBtbHg1X3ZkcGFfbmV0ICpuZGV2LCB1MTYgaWR4LCB1MzIgbnVtX2VudCkKPiArewo+ICsJ
c3RydWN0IG1seDVfdmRwYV92aXJ0cXVldWUgKm12cSA9ICZuZGV2LT52cXNbaWR4XTsKPiArCXN0
cnVjdCBtbHg1X2NvcmVfZGV2ICptZGV2ID0gbmRldi0+bXZkZXYubWRldjsKPiArCXZvaWQgX19p
b21lbSAqdWFyX3BhZ2UgPSBuZGV2LT5tdmRldi5yZXMudWFyLT5tYXA7Cj4gKwl1MzIgb3V0W01M
WDVfU1RfU1pfRFcoY3JlYXRlX2NxX291dCldOwo+ICsJc3RydWN0IG1seDVfdmRwYV9jcSAqdmNx
ID0gJm12cS0+Y3E7Cj4gKwl1bnNpZ25lZCBpbnQgaXJxbjsKPiArCV9fYmU2NCAqcGFzOwo+ICsJ
aW50IGlubGVuOwo+ICsJdm9pZCAqY3FjOwo+ICsJdm9pZCAqaW47Cj4gKwlpbnQgZXJyOwo+ICsJ
aW50IGVxbjsKPiArCj4gKwllcnIgPSBtbHg1X2RiX2FsbG9jKG1kZXYsICZ2Y3EtPmRiKTsKPiAr
CWlmIChlcnIpCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwl2Y3EtPm1jcS5zZXRfY2lfZGIgPSB2
Y3EtPmRiLmRiOwo+ICsJdmNxLT5tY3EuYXJtX2RiID0gdmNxLT5kYi5kYiArIDE7Cj4gKwl2Y3Et
Pm1jcS5jcWVfc3ogPSA2NDsKPiArCj4gKwllcnIgPSBjcV9mcmFnX2J1Zl9hbGxvYyhuZGV2LCAm
dmNxLT5idWYsIG51bV9lbnQpOwo+ICsJaWYgKGVycikKPiArCQlnb3RvIGVycl9kYjsKPiArCj4g
KwljcV9mcmFnX2J1Zl9pbml0KHZjcSwgJnZjcS0+YnVmKTsKPiArCj4gKwlpbmxlbiA9IE1MWDVf
U1RfU1pfQllURVMoY3JlYXRlX2NxX2luKSArCj4gKwkJTUxYNV9GTERfU1pfQllURVMoY3JlYXRl
X2NxX2luLCBwYXNbMF0pICogdmNxLT5idWYuZnJhZ19idWYubnBhZ2VzOwo+ICsJaW4gPSBremFs
bG9jKGlubGVuLCBHRlBfS0VSTkVMKTsKPiArCWlmICghaW4pIHsKPiArCQllcnIgPSAtRU5PTUVN
Owo+ICsJCWdvdG8gZXJyX3Z6YWxsb2M7Cj4gKwl9Cj4gKwo+ICsJTUxYNV9TRVQoY3JlYXRlX2Nx
X2luLCBpbiwgdWlkLCBuZGV2LT5tdmRldi5yZXMudWlkKTsKPiArCXBhcyA9IChfX2JlNjQgKilN
TFg1X0FERFJfT0YoY3JlYXRlX2NxX2luLCBpbiwgcGFzKTsKPiArCW1seDVfZmlsbF9wYWdlX2Zy
YWdfYXJyYXkoJnZjcS0+YnVmLmZyYWdfYnVmLCBwYXMpOwo+ICsKPiArCWNxYyA9IE1MWDVfQURE
Ul9PRihjcmVhdGVfY3FfaW4sIGluLCBjcV9jb250ZXh0KTsKPiArCU1MWDVfU0VUKGNxYywgY3Fj
LCBsb2dfcGFnZV9zaXplLCB2Y3EtPmJ1Zi5mcmFnX2J1Zi5wYWdlX3NoaWZ0IC0gTUxYNV9BREFQ
VEVSX1BBR0VfU0hJRlQpOwo+ICsKPiArCS8qIFVzZSB2ZWN0b3IgMCBieSBkZWZhdWx0LiBDb25z
aWRlciBhZGRpbmcgY29kZSB0byBjaG9vc2UgbGVhc3QgdXNlZAo+ICsJICogdmVjdG9yLgo+ICsJ
ICovCj4gKwllcnIgPSBtbHg1X3ZlY3RvcjJlcW4obWRldiwgMCwgJmVxbiwgJmlycW4pOwo+ICsJ
aWYgKGVycikKPiArCQlnb3RvIGVycl92ZWM7Cj4gKwo+ICsJY3FjID0gTUxYNV9BRERSX09GKGNy
ZWF0ZV9jcV9pbiwgaW4sIGNxX2NvbnRleHQpOwo+ICsJTUxYNV9TRVQoY3FjLCBjcWMsIGxvZ19j
cV9zaXplLCBpbG9nMihudW1fZW50KSk7Cj4gKwlNTFg1X1NFVChjcWMsIGNxYywgdWFyX3BhZ2Us
IG5kZXYtPm12ZGV2LnJlcy51YXItPmluZGV4KTsKPiArCU1MWDVfU0VUKGNxYywgY3FjLCBjX2Vx
biwgZXFuKTsKPiArCU1MWDVfU0VUNjQoY3FjLCBjcWMsIGRicl9hZGRyLCB2Y3EtPmRiLmRtYSk7
Cj4gKwo+ICsJZXJyID0gbWx4NV9jb3JlX2NyZWF0ZV9jcShtZGV2LCAmdmNxLT5tY3EsIGluLCBp
bmxlbiwgb3V0LCBzaXplb2Yob3V0KSk7Cj4gKwlpZiAoZXJyKQo+ICsJCWdvdG8gZXJyX3ZlYzsK
PiArCj4gKwl2Y3EtPm1jcS5jb21wID0gbWx4NV92ZHBhX2NxX2NvbXA7Cj4gKwl2Y3EtPmNxZSA9
IG51bV9lbnQ7Cj4gKwl2Y3EtPm1jcS5zZXRfY2lfZGIgPSB2Y3EtPmRiLmRiOwo+ICsJdmNxLT5t
Y3EuYXJtX2RiID0gdmNxLT5kYi5kYiArIDE7Cj4gKwltbHg1X2NxX2FybSgmbXZxLT5jcS5tY3Es
IE1MWDVfQ1FfREJfUkVRX05PVCwgdWFyX3BhZ2UsIG12cS0+Y3EubWNxLmNvbnNfaW5kZXgpOwo+
ICsJa2ZyZWUoaW4pOwo+ICsJcmV0dXJuIDA7Cj4gKwo+ICtlcnJfdmVjOgo+ICsJa2ZyZWUoaW4p
Owo+ICtlcnJfdnphbGxvYzoKPiArCWNxX2ZyYWdfYnVmX2ZyZWUobmRldiwgJnZjcS0+YnVmKTsK
PiArZXJyX2RiOgo+ICsJbWx4NV9kYl9mcmVlKG5kZXYtPm12ZGV2Lm1kZXYsICZ2Y3EtPmRiKTsK
PiArCXJldHVybiBlcnI7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGNxX2Rlc3Ryb3koc3RydWN0
IG1seDVfdmRwYV9uZXQgKm5kZXYsIHUxNiBpZHgpCj4gK3sKPiArCXN0cnVjdCBtbHg1X3ZkcGFf
dmlydHF1ZXVlICptdnEgPSAmbmRldi0+dnFzW2lkeF07Cj4gKwlzdHJ1Y3QgbWx4NV9jb3JlX2Rl
diAqbWRldiA9IG5kZXYtPm12ZGV2Lm1kZXY7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX2NxICp2Y3Eg
PSAmbXZxLT5jcTsKPiArCj4gKwlpZiAobWx4NV9jb3JlX2Rlc3Ryb3lfY3EobWRldiwgJnZjcS0+
bWNxKSkgewo+ICsJCW1seDVfdmRwYV93YXJuKCZuZGV2LT5tdmRldiwgImRlc3Ryb3kgQ1EgMHgl
eFxuIiwgdmNxLT5tY3EuY3FuKTsKPiArCQlyZXR1cm47Cj4gKwl9Cj4gKwljcV9mcmFnX2J1Zl9m
cmVlKG5kZXYsICZ2Y3EtPmJ1Zik7Cj4gKwltbHg1X2RiX2ZyZWUobmRldi0+bXZkZXYubWRldiwg
JnZjcS0+ZGIpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHVtZW1fc2l6ZShzdHJ1Y3QgbWx4NV92
ZHBhX25ldCAqbmRldiwgc3RydWN0IG1seDVfdmRwYV92aXJ0cXVldWUgKm12cSwgaW50IG51bSwK
PiArCQkgICAgIHN0cnVjdCBtbHg1X3ZkcGFfdW1lbSAqKnVtZW1wKQo+ICt7Cj4gKwlzdHJ1Y3Qg
bWx4NV9jb3JlX2RldiAqbWRldiA9IG5kZXYtPm12ZGV2Lm1kZXY7Cj4gKwlpbnQgcF9hOwo+ICsJ
aW50IHBfYjsKPiArCj4gKwlzd2l0Y2ggKG51bSkgewo+ICsJY2FzZSAxOgo+ICsJCXBfYSA9IE1M
WDVfQ0FQX0RFVl9WRFBBX0VNVUxBVElPTihtZGV2LCB1bWVtXzFfYnVmZmVyX3BhcmFtX2EpOwo+
ICsJCXBfYiA9IE1MWDVfQ0FQX0RFVl9WRFBBX0VNVUxBVElPTihtZGV2LCB1bWVtXzFfYnVmZmVy
X3BhcmFtX2IpOwo+ICsJCSp1bWVtcCA9ICZtdnEtPnVtZW0xOwo+ICsJCWJyZWFrOwo+ICsJY2Fz
ZSAyOgo+ICsJCXBfYSA9IE1MWDVfQ0FQX0RFVl9WRFBBX0VNVUxBVElPTihtZGV2LCB1bWVtXzJf
YnVmZmVyX3BhcmFtX2EpOwo+ICsJCXBfYiA9IE1MWDVfQ0FQX0RFVl9WRFBBX0VNVUxBVElPTiht
ZGV2LCB1bWVtXzJfYnVmZmVyX3BhcmFtX2IpOwo+ICsJCSp1bWVtcCA9ICZtdnEtPnVtZW0yOwo+
ICsJCWJyZWFrOwo+ICsJY2FzZSAzOgo+ICsJCXBfYSA9IE1MWDVfQ0FQX0RFVl9WRFBBX0VNVUxB
VElPTihtZGV2LCB1bWVtXzNfYnVmZmVyX3BhcmFtX2EpOwo+ICsJCXBfYiA9IE1MWDVfQ0FQX0RF
Vl9WRFBBX0VNVUxBVElPTihtZGV2LCB1bWVtXzNfYnVmZmVyX3BhcmFtX2IpOwo+ICsJCSp1bWVt
cCA9ICZtdnEtPnVtZW0zOwo+ICsJCWJyZWFrOwo+ICsJfQo+ICsJcmV0dXJuIHBfYSAqIG12cS0+
bnVtX2VudCArIHBfYjsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdW1lbV9mcmFnX2J1Zl9mcmVl
KHN0cnVjdCBtbHg1X3ZkcGFfbmV0ICpuZGV2LCBzdHJ1Y3QgbWx4NV92ZHBhX3VtZW0gKnVtZW0p
Cj4gK3sKPiArCW1seDVfZnJhZ19idWZfZnJlZShuZGV2LT5tdmRldi5tZGV2LCAmdW1lbS0+ZnJh
Z19idWYpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGNyZWF0ZV91bWVtKHN0cnVjdCBtbHg1X3Zk
cGFfbmV0ICpuZGV2LCBzdHJ1Y3QgbWx4NV92ZHBhX3ZpcnRxdWV1ZSAqbXZxLCBpbnQgbnVtKQo+
ICt7Cj4gKwlpbnQgaW5sZW47Cj4gKwl1MzIgb3V0W01MWDVfU1RfU1pfRFcoY3JlYXRlX3VtZW1f
b3V0KV0gPSB7fTsKPiArCXZvaWQgKnVtOwo+ICsJdm9pZCAqaW47Cj4gKwlpbnQgZXJyOwo+ICsJ
X19iZTY0ICpwYXM7Cj4gKwlpbnQgc2l6ZTsKPiArCXN0cnVjdCBtbHg1X3ZkcGFfdW1lbSAqdW1l
bTsKPiArCj4gKwlzaXplID0gdW1lbV9zaXplKG5kZXYsIG12cSwgbnVtLCAmdW1lbSk7Cj4gKwlp
ZiAoc2l6ZSA8IDApCj4gKwkJcmV0dXJuIHNpemU7Cj4gKwo+ICsJdW1lbS0+c2l6ZSA9IHNpemU7
Cj4gKwllcnIgPSB1bWVtX2ZyYWdfYnVmX2FsbG9jKG5kZXYsIHVtZW0sIHNpemUpOwo+ICsJaWYg
KGVycikKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCWlubGVuID0gTUxYNV9TVF9TWl9CWVRFUyhj
cmVhdGVfdW1lbV9pbikgKyBNTFg1X1NUX1NaX0JZVEVTKG10dCkgKiB1bWVtLT5mcmFnX2J1Zi5u
cGFnZXM7Cj4gKwo+ICsJaW4gPSBremFsbG9jKGlubGVuLCBHRlBfS0VSTkVMKTsKPiArCWlmICgh
aW4pIHsKPiArCQllcnIgPSAtRU5PTUVNOwo+ICsJCWdvdG8gZXJyX2luOwo+ICsJfQo+ICsKPiAr
CU1MWDVfU0VUKGNyZWF0ZV91bWVtX2luLCBpbiwgb3Bjb2RlLCBNTFg1X0NNRF9PUF9DUkVBVEVf
VU1FTSk7Cj4gKwlNTFg1X1NFVChjcmVhdGVfdW1lbV9pbiwgaW4sIHVpZCwgbmRldi0+bXZkZXYu
cmVzLnVpZCk7Cj4gKwl1bSA9IE1MWDVfQUREUl9PRihjcmVhdGVfdW1lbV9pbiwgaW4sIHVtZW0p
Owo+ICsJTUxYNV9TRVQodW1lbSwgdW0sIGxvZ19wYWdlX3NpemUsIHVtZW0tPmZyYWdfYnVmLnBh
Z2Vfc2hpZnQgLSBNTFg1X0FEQVBURVJfUEFHRV9TSElGVCk7Cj4gKwlNTFg1X1NFVDY0KHVtZW0s
IHVtLCBudW1fb2ZfbXR0LCB1bWVtLT5mcmFnX2J1Zi5ucGFnZXMpOwo+ICsKPiArCXBhcyA9IChf
X2JlNjQgKilNTFg1X0FERFJfT0YodW1lbSwgdW0sIG10dFswXSk7Cj4gKwltbHg1X2ZpbGxfcGFn
ZV9mcmFnX2FycmF5X3Blcm0oJnVtZW0tPmZyYWdfYnVmLCBwYXMsIE1MWDVfTVRUX1BFUk1fUlcp
Owo+ICsKPiArCWVyciA9IG1seDVfY21kX2V4ZWMobmRldi0+bXZkZXYubWRldiwgaW4sIGlubGVu
LCBvdXQsIHNpemVvZihvdXQpKTsKPiArCWlmIChlcnIpIHsKPiArCQltbHg1X3ZkcGFfd2Fybigm
bmRldi0+bXZkZXYsICJjcmVhdGUgdW1lbSglZClcbiIsIGVycik7Cj4gKwkJZ290byBlcnJfY21k
Owo+ICsJfQo+ICsKPiArCWtmcmVlKGluKTsKPiArCXVtZW0tPmlkID0gTUxYNV9HRVQoY3JlYXRl
X3VtZW1fb3V0LCBvdXQsIHVtZW1faWQpOwo+ICsKPiArCXJldHVybiAwOwo+ICsKPiArZXJyX2Nt
ZDoKPiArCWtmcmVlKGluKTsKPiArZXJyX2luOgo+ICsJdW1lbV9mcmFnX2J1Zl9mcmVlKG5kZXYs
IHVtZW0pOwo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdW1lbV9kZXN0
cm95KHN0cnVjdCBtbHg1X3ZkcGFfbmV0ICpuZGV2LCBzdHJ1Y3QgbWx4NV92ZHBhX3ZpcnRxdWV1
ZSAqbXZxLCBpbnQgbnVtKQo+ICt7Cj4gKwl1MzIgaW5bTUxYNV9TVF9TWl9EVyhkZXN0cm95X3Vt
ZW1faW4pXSA9IHt9Owo+ICsJdTMyIG91dFtNTFg1X1NUX1NaX0RXKGRlc3Ryb3lfdW1lbV9vdXQp
XSA9IHt9Owo+ICsJc3RydWN0IG1seDVfdmRwYV91bWVtICp1bWVtOwo+ICsKPiArCXN3aXRjaCAo
bnVtKSB7Cj4gKwljYXNlIDE6Cj4gKwkJdW1lbSA9ICZtdnEtPnVtZW0xOwo+ICsJCWJyZWFrOwo+
ICsJY2FzZSAyOgo+ICsJCXVtZW0gPSAmbXZxLT51bWVtMjsKPiArCQlicmVhazsKPiArCWNhc2Ug
MzoKPiArCQl1bWVtID0gJm12cS0+dW1lbTM7Cj4gKwkJYnJlYWs7Cj4gKwl9Cj4gKwo+ICsJTUxY
NV9TRVQoZGVzdHJveV91bWVtX2luLCBpbiwgb3Bjb2RlLCBNTFg1X0NNRF9PUF9ERVNUUk9ZX1VN
RU0pOwo+ICsJTUxYNV9TRVQoZGVzdHJveV91bWVtX2luLCBpbiwgdW1lbV9pZCwgdW1lbS0+aWQp
Owo+ICsJaWYgKG1seDVfY21kX2V4ZWMobmRldi0+bXZkZXYubWRldiwgaW4sIHNpemVvZihpbiks
IG91dCwgc2l6ZW9mKG91dCkpKQo+ICsJCXJldHVybjsKPiArCj4gKwl1bWVtX2ZyYWdfYnVmX2Zy
ZWUobmRldiwgdW1lbSk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgdW1lbXNfY3JlYXRlKHN0cnVj
dCBtbHg1X3ZkcGFfbmV0ICpuZGV2LCBzdHJ1Y3QgbWx4NV92ZHBhX3ZpcnRxdWV1ZSAqbXZxKQo+
ICt7Cj4gKwlpbnQgbnVtOwo+ICsJaW50IGVycjsKPiArCj4gKwlmb3IgKG51bSA9IDE7IG51bSA8
PSAzOyBudW0rKykgewo+ICsJCWVyciA9IGNyZWF0ZV91bWVtKG5kZXYsIG12cSwgbnVtKTsKPiAr
CQlpZiAoZXJyKQo+ICsJCQlnb3RvIGVycl91bWVtOwo+ICsJfQo+ICsJcmV0dXJuIDA7Cj4gKwo+
ICtlcnJfdW1lbToKPiArCWZvciAobnVtLS07IG51bSA+IDA7IG51bS0tKQo+ICsJCXVtZW1fZGVz
dHJveShuZGV2LCBtdnEsIG51bSk7Cj4gKwo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3Rh
dGljIHZvaWQgdW1lbXNfZGVzdHJveShzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldiwgc3RydWN0
IG1seDVfdmRwYV92aXJ0cXVldWUgKm12cSkKPiArewo+ICsJaW50IG51bTsKPiArCj4gKwlmb3Ig
KG51bSA9IDM7IG51bSA+IDA7IG51bS0tKQo+ICsJCXVtZW1fZGVzdHJveShuZGV2LCBtdnEsIG51
bSk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgZ2V0X3F1ZXVlX3R5cGUoc3RydWN0IG1seDVfdmRw
YV9uZXQgKm5kZXYpCj4gK3sKPiArCXUzMiB0eXBlX21hc2s7Cj4gKwo+ICsJdHlwZV9tYXNrID0g
TUxYNV9DQVBfREVWX1ZEUEFfRU1VTEFUSU9OKG5kZXYtPm12ZGV2Lm1kZXYsIHZpcnRpb19xdWV1
ZV90eXBlKTsKPiArCj4gKwkvKiBwcmVmZXIgc3BsaXQgcXVldWUgKi8KPiArCWlmICh0eXBlX21h
c2sgJiBNTFg1X1ZJUlRJT19FTVVMQVRJT05fQ0FQX1ZJUlRJT19RVUVVRV9UWVBFX1BBQ0tFRCkK
PiArCQlyZXR1cm4gTUxYNV9WSVJUSU9fRU1VTEFUSU9OX1ZJUlRJT19RVUVVRV9UWVBFX1BBQ0tF
RDsKPiArCj4gKwlXQVJOX09OKCEodHlwZV9tYXNrICYgTUxYNV9WSVJUSU9fRU1VTEFUSU9OX0NB
UF9WSVJUSU9fUVVFVUVfVFlQRV9TUExJVCkpOwo+ICsKPiArCXJldHVybiBNTFg1X1ZJUlRJT19F
TVVMQVRJT05fVklSVElPX1FVRVVFX1RZUEVfU1BMSVQ7Cj4gK30KPiArCj4gK3N0YXRpYyBib29s
IHZxX2lzX3R4KHUxNiBpZHgpCj4gK3sKPiArCXJldHVybiBpZHggJSAyOwo+ICt9Cj4gKwo+ICtz
dGF0aWMgdTE2IGdldF9mZWF0dXJlc18xMl8zKHU2NCBmZWF0dXJlcykKPiArewo+ICsJcmV0dXJu
ICghIShmZWF0dXJlcyAmIEJJVChWSVJUSU9fTkVUX0ZfSE9TVF9UU080KSkgPDwgOSkgfAo+ICsJ
ICAgICAgICghIShmZWF0dXJlcyAmIEJJVChWSVJUSU9fTkVUX0ZfSE9TVF9UU082KSkgPDwgOCkg
fAo+ICsJICAgICAgICghIShmZWF0dXJlcyAmIEJJVChWSVJUSU9fTkVUX0ZfQ1NVTSkpIDw8IDcp
IHwKPiArCSAgICAgICAoISEoZmVhdHVyZXMgJiBCSVQoVklSVElPX05FVF9GX0dVRVNUX0NTVU0p
KSA8PCA2KTsKPiArfQo+ICsKPiArc3RhdGljIGludCBjcmVhdGVfdmlydHF1ZXVlKHN0cnVjdCBt
bHg1X3ZkcGFfbmV0ICpuZGV2LCBzdHJ1Y3QgbWx4NV92ZHBhX3ZpcnRxdWV1ZSAqbXZxKQo+ICt7
Cj4gKwlpbnQgaW5sZW4gPSBNTFg1X1NUX1NaX0JZVEVTKGNyZWF0ZV92aXJ0aW9fbmV0X3FfaW4p
Owo+ICsJdTMyIG91dFtNTFg1X1NUX1NaX0RXKGNyZWF0ZV92aXJ0aW9fbmV0X3Ffb3V0KV0gPSB7
fTsKPiArCXZvaWQgKm9ial9jb250ZXh0Owo+ICsJdm9pZCAqY21kX2hkcjsKPiArCXZvaWQgKnZx
X2N0eDsKPiArCXZvaWQgKmluOwo+ICsJaW50IGVycjsKPiArCj4gKwllcnIgPSB1bWVtc19jcmVh
dGUobmRldiwgbXZxKTsKPiArCWlmIChlcnIpCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwlpbiA9
IGt6YWxsb2MoaW5sZW4sIEdGUF9LRVJORUwpOwo+ICsJaWYgKCFpbikgewo+ICsJCWVyciA9IC1F
Tk9NRU07Cj4gKwkJZ290byBlcnJfYWxsb2M7Cj4gKwl9Cj4gKwo+ICsJY21kX2hkciA9IE1MWDVf
QUREUl9PRihjcmVhdGVfdmlydGlvX25ldF9xX2luLCBpbiwgZ2VuZXJhbF9vYmpfaW5fY21kX2hk
cik7Cj4gKwo+ICsJTUxYNV9TRVQoZ2VuZXJhbF9vYmpfaW5fY21kX2hkciwgY21kX2hkciwgb3Bj
b2RlLCBNTFg1X0NNRF9PUF9DUkVBVEVfR0VORVJBTF9PQkpFQ1QpOwo+ICsJTUxYNV9TRVQoZ2Vu
ZXJhbF9vYmpfaW5fY21kX2hkciwgY21kX2hkciwgb2JqX3R5cGUsIE1MWDVfT0JKX1RZUEVfVklS
VElPX05FVF9RKTsKPiArCU1MWDVfU0VUKGdlbmVyYWxfb2JqX2luX2NtZF9oZHIsIGNtZF9oZHIs
IHVpZCwgbmRldi0+bXZkZXYucmVzLnVpZCk7Cj4gKwo+ICsJb2JqX2NvbnRleHQgPSBNTFg1X0FE
RFJfT0YoY3JlYXRlX3ZpcnRpb19uZXRfcV9pbiwgaW4sIG9ial9jb250ZXh0KTsKPiArCU1MWDVf
U0VUKHZpcnRpb19uZXRfcV9vYmplY3QsIG9ial9jb250ZXh0LCBod19hdmFpbGFibGVfaW5kZXgs
IG12cS0+YXZhaWxfaWR4KTsKPiArCU1MWDVfU0VUKHZpcnRpb19uZXRfcV9vYmplY3QsIG9ial9j
b250ZXh0LCBxdWV1ZV9mZWF0dXJlX2JpdF9tYXNrXzEyXzMsCj4gKwkJIGdldF9mZWF0dXJlc18x
Ml8zKG5kZXYtPm12ZGV2LmFjdHVhbF9mZWF0dXJlcykpOwo+ICsJdnFfY3R4ID0gTUxYNV9BRERS
X09GKHZpcnRpb19uZXRfcV9vYmplY3QsIG9ial9jb250ZXh0LCB2aXJ0aW9fcV9jb250ZXh0KTsK
PiArCU1MWDVfU0VUKHZpcnRpb19xLCB2cV9jdHgsIHZpcnRpb19xX3R5cGUsIGdldF9xdWV1ZV90
eXBlKG5kZXYpKTsKPiArCj4gKwlpZiAodnFfaXNfdHgobXZxLT5pbmRleCkpCj4gKwkJTUxYNV9T
RVQodmlydGlvX25ldF9xX29iamVjdCwgb2JqX2NvbnRleHQsIHRpc25fb3JfcXBuLCBuZGV2LT5y
ZXMudGlzbik7Cj4gKwo+ICsJTUxYNV9TRVQodmlydGlvX3EsIHZxX2N0eCwgZXZlbnRfbW9kZSwg
TUxYNV9WSVJUSU9fUV9FVkVOVF9NT0RFX1FQX01PREUpOwo+ICsJTUxYNV9TRVQodmlydGlvX3Es
IHZxX2N0eCwgcXVldWVfaW5kZXgsIG12cS0+aW5kZXgpOwo+ICsJTUxYNV9TRVQodmlydGlvX3Es
IHZxX2N0eCwgZXZlbnRfcXBuX29yX21zaXgsIG12cS0+ZndxcC5tcXAucXBuKTsKPiArCU1MWDVf
U0VUKHZpcnRpb19xLCB2cV9jdHgsIHF1ZXVlX3NpemUsIG12cS0+bnVtX2VudCk7Cj4gKwlNTFg1
X1NFVCh2aXJ0aW9fcSwgdnFfY3R4LCB2aXJ0aW9fdmVyc2lvbl8xXzAsCj4gKwkJICEhKG5kZXYt
Pm12ZGV2LmFjdHVhbF9mZWF0dXJlcyAmIFZJUlRJT19GX1ZFUlNJT05fMSkpOwo+ICsJTUxYNV9T
RVQ2NCh2aXJ0aW9fcSwgdnFfY3R4LCBkZXNjX2FkZHIsIG12cS0+ZGVzY19hZGRyKTsKPiArCU1M
WDVfU0VUNjQodmlydGlvX3EsIHZxX2N0eCwgdXNlZF9hZGRyLCBtdnEtPmRldmljZV9hZGRyKTsK
PiArCU1MWDVfU0VUNjQodmlydGlvX3EsIHZxX2N0eCwgYXZhaWxhYmxlX2FkZHIsIG12cS0+ZHJp
dmVyX2FkZHIpOwo+ICsJTUxYNV9TRVQodmlydGlvX3EsIHZxX2N0eCwgdmlydGlvX3FfbWtleSwg
bmRldi0+bXZkZXYubXIubWtleS5rZXkpOwo+ICsJTUxYNV9TRVQodmlydGlvX3EsIHZxX2N0eCwg
dW1lbV8xX2lkLCBtdnEtPnVtZW0xLmlkKTsKPiArCU1MWDVfU0VUKHZpcnRpb19xLCB2cV9jdHgs
IHVtZW1fMV9zaXplLCBtdnEtPnVtZW0xLnNpemUpOwo+ICsJTUxYNV9TRVQodmlydGlvX3EsIHZx
X2N0eCwgdW1lbV8yX2lkLCBtdnEtPnVtZW0yLmlkKTsKPiArCU1MWDVfU0VUKHZpcnRpb19xLCB2
cV9jdHgsIHVtZW1fMl9zaXplLCBtdnEtPnVtZW0xLnNpemUpOwo+ICsJTUxYNV9TRVQodmlydGlv
X3EsIHZxX2N0eCwgdW1lbV8zX2lkLCBtdnEtPnVtZW0zLmlkKTsKPiArCU1MWDVfU0VUKHZpcnRp
b19xLCB2cV9jdHgsIHVtZW1fM19zaXplLCBtdnEtPnVtZW0xLnNpemUpOwo+ICsJTUxYNV9TRVQo
dmlydGlvX3EsIHZxX2N0eCwgcGQsIG5kZXYtPm12ZGV2LnJlcy5wZG4pOwo+ICsJaWYgKE1MWDVf
Q0FQX0RFVl9WRFBBX0VNVUxBVElPTihuZGV2LT5tdmRldi5tZGV2LCBldGhfZnJhbWVfb2ZmbG9h
ZF90eXBlKSkKPiArCQlNTFg1X1NFVCh2aXJ0aW9fcSwgdnFfY3R4LCB2aXJ0aW9fdmVyc2lvbl8x
XzAsIDEpOwo+ICsKPiArCWVyciA9IG1seDVfY21kX2V4ZWMobmRldi0+bXZkZXYubWRldiwgaW4s
IGlubGVuLCBvdXQsIHNpemVvZihvdXQpKTsKPiArCWlmIChlcnIpCj4gKwkJZ290byBlcnJfY21k
Owo+ICsKPiArCWtmcmVlKGluKTsKPiArCW12cS0+dmlydHFfaWQgPSBNTFg1X0dFVChnZW5lcmFs
X29ial9vdXRfY21kX2hkciwgb3V0LCBvYmpfaWQpOwo+ICsKPiArCXJldHVybiAwOwo+ICsKPiAr
ZXJyX2NtZDoKPiArCWtmcmVlKGluKTsKPiArZXJyX2FsbG9jOgo+ICsJdW1lbXNfZGVzdHJveShu
ZGV2LCBtdnEpOwo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZGVzdHJv
eV92aXJ0cXVldWUoc3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYsIHN0cnVjdCBtbHg1X3ZkcGFf
dmlydHF1ZXVlICptdnEpCj4gK3sKPiArCXUzMiBpbltNTFg1X1NUX1NaX0RXKGRlc3Ryb3lfdmly
dGlvX25ldF9xX2luKV0gPSB7fTsKPiArCXUzMiBvdXRbTUxYNV9TVF9TWl9EVyhkZXN0cm95X3Zp
cnRpb19uZXRfcV9vdXQpXSA9IHt9Owo+ICsKPiArCU1MWDVfU0VUKGRlc3Ryb3lfdmlydGlvX25l
dF9xX2luLCBpbiwgZ2VuZXJhbF9vYmpfb3V0X2NtZF9oZHIub3Bjb2RlLAo+ICsJCSBNTFg1X0NN
RF9PUF9ERVNUUk9ZX0dFTkVSQUxfT0JKRUNUKTsKPiArCU1MWDVfU0VUKGRlc3Ryb3lfdmlydGlv
X25ldF9xX2luLCBpbiwgZ2VuZXJhbF9vYmpfb3V0X2NtZF9oZHIub2JqX2lkLCBtdnEtPnZpcnRx
X2lkKTsKPiArCU1MWDVfU0VUKGRlc3Ryb3lfdmlydGlvX25ldF9xX2luLCBpbiwgZ2VuZXJhbF9v
Ympfb3V0X2NtZF9oZHIudWlkLCBuZGV2LT5tdmRldi5yZXMudWlkKTsKPiArCU1MWDVfU0VUKGRl
c3Ryb3lfdmlydGlvX25ldF9xX2luLCBpbiwgZ2VuZXJhbF9vYmpfb3V0X2NtZF9oZHIub2JqX3R5
cGUsCj4gKwkJIE1MWDVfT0JKX1RZUEVfVklSVElPX05FVF9RKTsKPiArCWlmIChtbHg1X2NtZF9l
eGVjKG5kZXYtPm12ZGV2Lm1kZXYsIGluLCBzaXplb2YoaW4pLCBvdXQsIHNpemVvZihvdXQpKSkg
ewo+ICsJCW1seDVfdmRwYV93YXJuKCZuZGV2LT5tdmRldiwgImRlc3Ryb3kgdmlydHF1ZXVlIDB4
JXhcbiIsIG12cS0+dmlydHFfaWQpOwo+ICsJCXJldHVybjsKPiArCX0KPiArCXVtZW1zX2Rlc3Ry
b3kobmRldiwgbXZxKTsKPiArfQo+ICsKPiArc3RhdGljIHUzMiBnZXRfcnFwbihzdHJ1Y3QgbWx4
NV92ZHBhX3ZpcnRxdWV1ZSAqbXZxLCBib29sIGZ3KQo+ICt7Cj4gKwlyZXR1cm4gZncgPyBtdnEt
PnZxcXAubXFwLnFwbiA6IG12cS0+ZndxcC5tcXAucXBuOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdTMy
IGdldF9xcG4oc3RydWN0IG1seDVfdmRwYV92aXJ0cXVldWUgKm12cSwgYm9vbCBmdykKPiArewo+
ICsJcmV0dXJuIGZ3ID8gbXZxLT5md3FwLm1xcC5xcG4gOiBtdnEtPnZxcXAubXFwLnFwbjsKPiAr
fQo+ICsKPiArc3RhdGljIHZvaWQgYWxsb2NfaW5vdXQoc3RydWN0IG1seDVfdmRwYV9uZXQgKm5k
ZXYsIGludCBjbWQsIHZvaWQgKippbiwgaW50ICppbmxlbiwgdm9pZCAqKm91dCwKPiArCQkJaW50
ICpvdXRsZW4sIHUzMiBxcG4sIHUzMiBycXBuKQo+ICt7Cj4gKwl2b2lkICpxcGM7Cj4gKwl2b2lk
ICpwcDsKPiArCj4gKwlzd2l0Y2ggKGNtZCkgewo+ICsJY2FzZSBNTFg1X0NNRF9PUF8yUlNUX1FQ
Ogo+ICsJCSppbmxlbiA9IE1MWDVfU1RfU1pfQllURVMocXBfMnJzdF9pbik7Cj4gKwkJKm91dGxl
biA9IE1MWDVfU1RfU1pfQllURVMocXBfMnJzdF9vdXQpOwo+ICsJCSppbiA9IGt6YWxsb2MoKmlu
bGVuLCBHRlBfS0VSTkVMKTsKPiArCQkqb3V0ID0ga3phbGxvYygqb3V0bGVuLCBHRlBfS0VSTkVM
KTsKPiArCQlpZiAoIWluIHx8ICFvdXQpCj4gKwkJCWdvdG8gb3V0ZXJyOwo+ICsKPiArCQlNTFg1
X1NFVChxcF8ycnN0X2luLCAqaW4sIG9wY29kZSwgY21kKTsKPiArCQlNTFg1X1NFVChxcF8ycnN0
X2luLCAqaW4sIHVpZCwgbmRldi0+bXZkZXYucmVzLnVpZCk7Cj4gKwkJTUxYNV9TRVQocXBfMnJz
dF9pbiwgKmluLCBxcG4sIHFwbik7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIE1MWDVfQ01EX09QX1JT
VDJJTklUX1FQOgo+ICsJCSppbmxlbiA9IE1MWDVfU1RfU1pfQllURVMocnN0MmluaXRfcXBfaW4p
Owo+ICsJCSpvdXRsZW4gPSBNTFg1X1NUX1NaX0JZVEVTKHJzdDJpbml0X3FwX291dCk7Cj4gKwkJ
KmluID0ga3phbGxvYygqaW5sZW4sIEdGUF9LRVJORUwpOwo+ICsJCSpvdXQgPSBremFsbG9jKE1M
WDVfU1RfU1pfQllURVMocnN0MmluaXRfcXBfb3V0KSwgR0ZQX0tFUk5FTCk7Cj4gKwkJaWYgKCFp
biB8fCAhb3V0KQo+ICsJCQlnb3RvIG91dGVycjsKPiArCj4gKwkJTUxYNV9TRVQocnN0MmluaXRf
cXBfaW4sICppbiwgb3Bjb2RlLCBjbWQpOwo+ICsJCU1MWDVfU0VUKHJzdDJpbml0X3FwX2luLCAq
aW4sIHVpZCwgbmRldi0+bXZkZXYucmVzLnVpZCk7Cj4gKwkJTUxYNV9TRVQocnN0MmluaXRfcXBf
aW4sICppbiwgcXBuLCBxcG4pOwo+ICsJCXFwYyA9IE1MWDVfQUREUl9PRihyc3QyaW5pdF9xcF9p
biwgKmluLCBxcGMpOwo+ICsJCU1MWDVfU0VUKHFwYywgcXBjLCByZW1vdGVfcXBuLCBycXBuKTsK
PiArCQlNTFg1X1NFVChxcGMsIHFwYywgcndlLCAxKTsKPiArCQlwcCA9IE1MWDVfQUREUl9PRihx
cGMsIHFwYywgcHJpbWFyeV9hZGRyZXNzX3BhdGgpOwo+ICsJCU1MWDVfU0VUKGFkcywgcHAsIHZo
Y2FfcG9ydF9udW0sIDEpOwo+ICsJCWJyZWFrOwo+ICsJY2FzZSBNTFg1X0NNRF9PUF9JTklUMlJU
Ul9RUDoKPiArCQkqaW5sZW4gPSBNTFg1X1NUX1NaX0JZVEVTKGluaXQycnRyX3FwX2luKTsKPiAr
CQkqb3V0bGVuID0gTUxYNV9TVF9TWl9CWVRFUyhpbml0MnJ0cl9xcF9vdXQpOwo+ICsJCSppbiA9
IGt6YWxsb2MoKmlubGVuLCBHRlBfS0VSTkVMKTsKPiArCQkqb3V0ID0ga3phbGxvYyhNTFg1X1NU
X1NaX0JZVEVTKGluaXQycnRyX3FwX291dCksIEdGUF9LRVJORUwpOwo+ICsJCWlmICghaW4gfHwg
IW91dCkKPiArCQkJZ290byBvdXRlcnI7Cj4gKwo+ICsJCU1MWDVfU0VUKGluaXQycnRyX3FwX2lu
LCAqaW4sIG9wY29kZSwgY21kKTsKPiArCQlNTFg1X1NFVChpbml0MnJ0cl9xcF9pbiwgKmluLCB1
aWQsIG5kZXYtPm12ZGV2LnJlcy51aWQpOwo+ICsJCU1MWDVfU0VUKGluaXQycnRyX3FwX2luLCAq
aW4sIHFwbiwgcXBuKTsKPiArCQlxcGMgPSBNTFg1X0FERFJfT0YocnN0MmluaXRfcXBfaW4sICpp
biwgcXBjKTsKPiArCQlNTFg1X1NFVChxcGMsIHFwYywgbXR1LCBNTFg1X1FQQ19NVFVfMjU2X0JZ
VEVTKTsKPiArCQlNTFg1X1NFVChxcGMsIHFwYywgbG9nX21zZ19tYXgsIDMwKTsKPiArCQlNTFg1
X1NFVChxcGMsIHFwYywgcmVtb3RlX3FwbiwgcnFwbik7Cj4gKwkJcHAgPSBNTFg1X0FERFJfT0Yo
cXBjLCBxcGMsIHByaW1hcnlfYWRkcmVzc19wYXRoKTsKPiArCQlNTFg1X1NFVChhZHMsIHBwLCBm
bCwgMSk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIE1MWDVfQ01EX09QX1JUUjJSVFNfUVA6Cj4gKwkJ
KmlubGVuID0gTUxYNV9TVF9TWl9CWVRFUyhydHIycnRzX3FwX2luKTsKPiArCQkqb3V0bGVuID0g
TUxYNV9TVF9TWl9CWVRFUyhydHIycnRzX3FwX291dCk7Cj4gKwkJKmluID0ga3phbGxvYygqaW5s
ZW4sIEdGUF9LRVJORUwpOwo+ICsJCSpvdXQgPSBremFsbG9jKE1MWDVfU1RfU1pfQllURVMocnRy
MnJ0c19xcF9vdXQpLCBHRlBfS0VSTkVMKTsKPiArCQlpZiAoIWluIHx8ICFvdXQpCj4gKwkJCWdv
dG8gb3V0ZXJyOwo+ICsKPiArCQlNTFg1X1NFVChydHIycnRzX3FwX2luLCAqaW4sIG9wY29kZSwg
Y21kKTsKPiArCQlNTFg1X1NFVChydHIycnRzX3FwX2luLCAqaW4sIHVpZCwgbmRldi0+bXZkZXYu
cmVzLnVpZCk7Cj4gKwkJTUxYNV9TRVQocnRyMnJ0c19xcF9pbiwgKmluLCBxcG4sIHFwbik7Cj4g
KwkJcXBjID0gTUxYNV9BRERSX09GKHJzdDJpbml0X3FwX2luLCAqaW4sIHFwYyk7Cj4gKwkJcHAg
PSBNTFg1X0FERFJfT0YocXBjLCBxcGMsIHByaW1hcnlfYWRkcmVzc19wYXRoKTsKPiArCQlNTFg1
X1NFVChhZHMsIHBwLCBhY2tfdGltZW91dCwgMTQpOwo+ICsJCU1MWDVfU0VUKHFwYywgcXBjLCBy
ZXRyeV9jb3VudCwgNyk7Cj4gKwkJTUxYNV9TRVQocXBjLCBxcGMsIHJucl9yZXRyeSwgNyk7Cj4g
KwkJYnJlYWs7Cj4gKwlkZWZhdWx0Ogo+ICsJCWdvdG8gb3V0ZXJyOwo+ICsJfQo+ICsJaWYgKCEq
aW4gfHwgISpvdXQpCj4gKwkJZ290byBvdXRlcnI7Cj4gKwo+ICsJcmV0dXJuOwo+ICsKPiArb3V0
ZXJyOgo+ICsJa2ZyZWUoKmluKTsKPiArCWtmcmVlKCpvdXQpOwo+ICsJKmluID0gTlVMTDsKPiAr
CSpvdXQgPSBOVUxMOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBmcmVlX2lub3V0KHZvaWQgKmlu
LCB2b2lkICpvdXQpCj4gK3sKPiArCWtmcmVlKGluKTsKPiArCWtmcmVlKG91dCk7Cj4gK30KPiAr
Cj4gKy8qIFR3byBRUHMgYXJlIHVzZWQgYnkgZWFjaCB2aXJ0cXVldWUuIE9uZSBpcyB1c2VkIGJ5
IHRoZSBkcml2ZXIgYW5kIG9uZSBieQo+ICsgKiBmaXJtd2FyZS4gVGhlIGZ3IGFyZ3VtZW50IGlu
ZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0ZWQgUVAgaXMgdGhlIG9uZSB1c2VkCj4gKyAqIGJ5
IGZpcm13YXJlLgo+ICsgKi8KPiArc3RhdGljIGludCBtb2RpZnlfcXAoc3RydWN0IG1seDVfdmRw
YV9uZXQgKm5kZXYsIHN0cnVjdCBtbHg1X3ZkcGFfdmlydHF1ZXVlICptdnEsIGJvb2wgZncsIGlu
dCBjbWQpCj4gK3sKPiArCWludCBvdXRsZW47Cj4gKwlpbnQgaW5sZW47Cj4gKwl2b2lkICpvdXQ7
Cj4gKwl2b2lkICppbjsKPiArCWludCBlcnI7Cj4gKwo+ICsJYWxsb2NfaW5vdXQobmRldiwgY21k
LCAmaW4sICZpbmxlbiwgJm91dCwgJm91dGxlbiwgZ2V0X3FwbihtdnEsIGZ3KSwgZ2V0X3JxcG4o
bXZxLCBmdykpOwo+ICsJaWYgKCFpbiB8fCAhb3V0KQo+ICsJCXJldHVybiAtRU5PTUVNOwo+ICsK
PiArCWVyciA9IG1seDVfY21kX2V4ZWMobmRldi0+bXZkZXYubWRldiwgaW4sIGlubGVuLCBvdXQs
IG91dGxlbik7Cj4gKwlmcmVlX2lub3V0KGluLCBvdXQpOwo+ICsJcmV0dXJuIGVycjsKPiArfQo+
ICsKPiArc3RhdGljIGludCBjb25uZWN0X3FwcyhzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldiwg
c3RydWN0IG1seDVfdmRwYV92aXJ0cXVldWUgKm12cSkKPiArewo+ICsJaW50IGVycjsKPiArCj4g
KwllcnIgPSBtb2RpZnlfcXAobmRldiwgbXZxLCB0cnVlLCBNTFg1X0NNRF9PUF8yUlNUX1FQKTsK
PiArCWlmIChlcnIpCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwllcnIgPSBtb2RpZnlfcXAobmRl
diwgbXZxLCBmYWxzZSwgTUxYNV9DTURfT1BfMlJTVF9RUCk7Cj4gKwlpZiAoZXJyKQo+ICsJCXJl
dHVybiBlcnI7Cj4gKwo+ICsJZXJyID0gbW9kaWZ5X3FwKG5kZXYsIG12cSwgdHJ1ZSwgTUxYNV9D
TURfT1BfUlNUMklOSVRfUVApOwo+ICsJaWYgKGVycikKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiAr
CWVyciA9IG1vZGlmeV9xcChuZGV2LCBtdnEsIGZhbHNlLCBNTFg1X0NNRF9PUF9SU1QySU5JVF9R
UCk7Cj4gKwlpZiAoZXJyKQo+ICsJCXJldHVybiBlcnI7Cj4gKwo+ICsJZXJyID0gbW9kaWZ5X3Fw
KG5kZXYsIG12cSwgdHJ1ZSwgTUxYNV9DTURfT1BfSU5JVDJSVFJfUVApOwo+ICsJaWYgKGVycikK
PiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCWVyciA9IG1vZGlmeV9xcChuZGV2LCBtdnEsIGZhbHNl
LCBNTFg1X0NNRF9PUF9JTklUMlJUUl9RUCk7Cj4gKwlpZiAoZXJyKQo+ICsJCXJldHVybiBlcnI7
Cj4gKwo+ICsJcmV0dXJuIG1vZGlmeV9xcChuZGV2LCBtdnEsIHRydWUsIE1MWDVfQ01EX09QX1JU
UjJSVFNfUVApOwo+ICt9Cj4gKwo+ICtzdHJ1Y3QgbWx4NV92aXJ0cV9hdHRyIHsKPiArCXU4IHN0
YXRlOwo+ICsJdTE2IGF2YWlsYWJsZV9pbmRleDsKPiArfTsKPiArCj4gK3N0YXRpYyBpbnQgcXVl
cnlfdmlydHF1ZXVlKHN0cnVjdCBtbHg1X3ZkcGFfbmV0ICpuZGV2LCBzdHJ1Y3QgbWx4NV92ZHBh
X3ZpcnRxdWV1ZSAqbXZxLAo+ICsJCQkgICBzdHJ1Y3QgbWx4NV92aXJ0cV9hdHRyICphdHRyKQo+
ICt7Cj4gKwlpbnQgb3V0bGVuID0gTUxYNV9TVF9TWl9CWVRFUyhxdWVyeV92aXJ0aW9fbmV0X3Ff
b3V0KTsKPiArCXUzMiBpbltNTFg1X1NUX1NaX0RXKHF1ZXJ5X3ZpcnRpb19uZXRfcV9pbildID0g
e307Cj4gKwl2b2lkICpvdXQ7Cj4gKwl2b2lkICpvYmpfY29udGV4dDsKPiArCXZvaWQgKmNtZF9o
ZHI7Cj4gKwlpbnQgZXJyOwo+ICsKPiArCW91dCA9IGt6YWxsb2Mob3V0bGVuLCBHRlBfS0VSTkVM
KTsKPiArCWlmICghb3V0KQo+ICsJCXJldHVybiAtRU5PTUVNOwo+ICsKPiArCWNtZF9oZHIgPSBN
TFg1X0FERFJfT0YocXVlcnlfdmlydGlvX25ldF9xX2luLCBpbiwgZ2VuZXJhbF9vYmpfaW5fY21k
X2hkcik7Cj4gKwo+ICsJTUxYNV9TRVQoZ2VuZXJhbF9vYmpfaW5fY21kX2hkciwgY21kX2hkciwg
b3Bjb2RlLCBNTFg1X0NNRF9PUF9RVUVSWV9HRU5FUkFMX09CSkVDVCk7Cj4gKwlNTFg1X1NFVChn
ZW5lcmFsX29ial9pbl9jbWRfaGRyLCBjbWRfaGRyLCBvYmpfdHlwZSwgTUxYNV9PQkpfVFlQRV9W
SVJUSU9fTkVUX1EpOwo+ICsJTUxYNV9TRVQoZ2VuZXJhbF9vYmpfaW5fY21kX2hkciwgY21kX2hk
ciwgb2JqX2lkLCBtdnEtPnZpcnRxX2lkKTsKPiArCU1MWDVfU0VUKGdlbmVyYWxfb2JqX2luX2Nt
ZF9oZHIsIGNtZF9oZHIsIHVpZCwgbmRldi0+bXZkZXYucmVzLnVpZCk7Cj4gKwllcnIgPSBtbHg1
X2NtZF9leGVjKG5kZXYtPm12ZGV2Lm1kZXYsIGluLCBzaXplb2YoaW4pLCBvdXQsIG91dGxlbik7
Cj4gKwlpZiAoZXJyKQo+ICsJCWdvdG8gZXJyX2NtZDsKPiArCj4gKwlvYmpfY29udGV4dCA9IE1M
WDVfQUREUl9PRihxdWVyeV92aXJ0aW9fbmV0X3Ffb3V0LCBvdXQsIG9ial9jb250ZXh0KTsKPiAr
CW1lbXNldChhdHRyLCAwLCBzaXplb2YoKmF0dHIpKTsKPiArCWF0dHItPnN0YXRlID0gTUxYNV9H
RVQodmlydGlvX25ldF9xX29iamVjdCwgb2JqX2NvbnRleHQsIHN0YXRlKTsKPiArCWF0dHItPmF2
YWlsYWJsZV9pbmRleCA9IE1MWDVfR0VUKHZpcnRpb19uZXRfcV9vYmplY3QsIG9ial9jb250ZXh0
LCBod19hdmFpbGFibGVfaW5kZXgpOwo+ICsJa2ZyZWUob3V0KTsKPiArCXJldHVybiAwOwo+ICsK
PiArZXJyX2NtZDoKPiArCWtmcmVlKG91dCk7Cj4gKwlyZXR1cm4gZXJyOwo+ICt9Cj4gKwo+ICtz
dGF0aWMgaW50IG1vZGlmeV92aXJ0cXVldWUoc3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYsIHN0
cnVjdCBtbHg1X3ZkcGFfdmlydHF1ZXVlICptdnEsIGludCBzdGF0ZSkKPiArewo+ICsJaW50IGlu
bGVuID0gTUxYNV9TVF9TWl9CWVRFUyhtb2RpZnlfdmlydGlvX25ldF9xX2luKTsKPiArCXUzMiBv
dXRbTUxYNV9TVF9TWl9EVyhtb2RpZnlfdmlydGlvX25ldF9xX291dCldID0ge307Cj4gKwl2b2lk
ICpvYmpfY29udGV4dDsKPiArCXZvaWQgKmNtZF9oZHI7Cj4gKwl2b2lkICppbjsKPiArCWludCBl
cnI7Cj4gKwo+ICsJaW4gPSBremFsbG9jKGlubGVuLCBHRlBfS0VSTkVMKTsKPiArCWlmICghaW4p
Cj4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsJY21kX2hkciA9IE1MWDVfQUREUl9PRihtb2Rp
ZnlfdmlydGlvX25ldF9xX2luLCBpbiwgZ2VuZXJhbF9vYmpfaW5fY21kX2hkcik7Cj4gKwo+ICsJ
TUxYNV9TRVQoZ2VuZXJhbF9vYmpfaW5fY21kX2hkciwgY21kX2hkciwgb3Bjb2RlLCBNTFg1X0NN
RF9PUF9NT0RJRllfR0VORVJBTF9PQkpFQ1QpOwo+ICsJTUxYNV9TRVQoZ2VuZXJhbF9vYmpfaW5f
Y21kX2hkciwgY21kX2hkciwgb2JqX3R5cGUsIE1MWDVfT0JKX1RZUEVfVklSVElPX05FVF9RKTsK
PiArCU1MWDVfU0VUKGdlbmVyYWxfb2JqX2luX2NtZF9oZHIsIGNtZF9oZHIsIG9ial9pZCwgbXZx
LT52aXJ0cV9pZCk7Cj4gKwlNTFg1X1NFVChnZW5lcmFsX29ial9pbl9jbWRfaGRyLCBjbWRfaGRy
LCB1aWQsIG5kZXYtPm12ZGV2LnJlcy51aWQpOwo+ICsKPiArCW9ial9jb250ZXh0ID0gTUxYNV9B
RERSX09GKG1vZGlmeV92aXJ0aW9fbmV0X3FfaW4sIGluLCBvYmpfY29udGV4dCk7Cj4gKwlNTFg1
X1NFVDY0KHZpcnRpb19uZXRfcV9vYmplY3QsIG9ial9jb250ZXh0LCBtb2RpZnlfZmllbGRfc2Vs
ZWN0LAo+ICsJCSAgIE1MWDVfVklSVFFfTU9ESUZZX01BU0tfU1RBVEUpOwo+ICsJTUxYNV9TRVQo
dmlydGlvX25ldF9xX29iamVjdCwgb2JqX2NvbnRleHQsIHN0YXRlLCBzdGF0ZSk7Cj4gKwllcnIg
PSBtbHg1X2NtZF9leGVjKG5kZXYtPm12ZGV2Lm1kZXYsIGluLCBpbmxlbiwgb3V0LCBzaXplb2Yo
b3V0KSk7Cj4gKwlrZnJlZShpbik7Cj4gKwlpZiAoIWVycikKPiArCQltdnEtPmZ3X3N0YXRlID0g
c3RhdGU7Cj4gKwo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGljIGludCBzZXR1cF92
cShzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldiwgc3RydWN0IG1seDVfdmRwYV92aXJ0cXVldWUg
Km12cSkKPiArewo+ICsJdTE2IGlkeCA9IG12cS0+aW5kZXg7Cj4gKwlpbnQgZXJyOwo+ICsKPiAr
CWlmICghbXZxLT5udW1fZW50KQo+ICsJCXJldHVybiAwOwo+ICsKPiArCWlmIChtdnEtPmluaXRp
YWxpemVkKSB7Cj4gKwkJbWx4NV92ZHBhX3dhcm4oJm5kZXYtPm12ZGV2LCAiYXR0ZW1wdCByZSBp
bml0XG4iKTsKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCX0KPiArCj4gKwllcnIgPSBjcV9jcmVh
dGUobmRldiwgaWR4LCBtdnEtPm51bV9lbnQpOwo+ICsJaWYgKGVycikKPiArCQlyZXR1cm4gZXJy
Owo+ICsKPiArCWVyciA9IHFwX2NyZWF0ZShuZGV2LCBtdnEsICZtdnEtPmZ3cXApOwo+ICsJaWYg
KGVycikKPiArCQlnb3RvIGVycl9md3FwOwo+ICsKPiArCWVyciA9IHFwX2NyZWF0ZShuZGV2LCBt
dnEsICZtdnEtPnZxcXApOwo+ICsJaWYgKGVycikKPiArCQlnb3RvIGVycl92cXFwOwo+ICsKPiAr
CWVyciA9IGNvbm5lY3RfcXBzKG5kZXYsIG12cSk7Cj4gKwlpZiAoZXJyKQo+ICsJCWdvdG8gZXJy
X2Nvbm5lY3Q7Cj4gKwo+ICsJZXJyID0gY3JlYXRlX3ZpcnRxdWV1ZShuZGV2LCBtdnEpOwo+ICsJ
aWYgKGVycikKPiArCQlnb3RvIGVycl9jb25uZWN0Owo+ICsKPiArCWlmIChtdnEtPnJlYWR5KSB7
Cj4gKwkJZXJyID0gbW9kaWZ5X3ZpcnRxdWV1ZShuZGV2LCBtdnEsIE1MWDVfVklSVElPX05FVF9R
X09CSkVDVF9TVEFURV9SRFkpOwo+ICsJCWlmIChlcnIpIHsKPiArCQkJbWx4NV92ZHBhX3dhcm4o
Jm5kZXYtPm12ZGV2LCAiZmFpbGVkIHRvIG1vZGlmeSB0byByZWFkeSB2cSBpZHggJWQoJWQpXG4i
LAo+ICsJCQkJICAgICAgIGlkeCwgZXJyKTsKPiArCQkJZ290byBlcnJfY29ubmVjdDsKPiArCQl9
Cj4gKwl9Cj4gKwo+ICsJbXZxLT5pbml0aWFsaXplZCA9IHRydWU7Cj4gKwlyZXR1cm4gMDsKPiAr
Cj4gK2Vycl9jb25uZWN0Ogo+ICsJcXBfZGVzdHJveShuZGV2LCAmbXZxLT52cXFwKTsKPiArZXJy
X3ZxcXA6Cj4gKwlxcF9kZXN0cm95KG5kZXYsICZtdnEtPmZ3cXApOwo+ICtlcnJfZndxcDoKPiAr
CWNxX2Rlc3Ryb3kobmRldiwgaWR4KTsKPiArCXJldHVybiBlcnI7Cj4gK30KPiArCj4gK3N0YXRp
YyB2b2lkIHN1c3BlbmRfdnEoc3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYsIHN0cnVjdCBtbHg1
X3ZkcGFfdmlydHF1ZXVlICptdnEpCj4gK3sKPiArCXN0cnVjdCBtbHg1X3ZpcnRxX2F0dHIgYXR0
cjsKPiArCj4gKwlpZiAoIW12cS0+aW5pdGlhbGl6ZWQpCj4gKwkJcmV0dXJuOwo+ICsKPiArCWlm
IChxdWVyeV92aXJ0cXVldWUobmRldiwgbXZxLCAmYXR0cikpIHsKPiArCQltbHg1X3ZkcGFfd2Fy
bigmbmRldi0+bXZkZXYsICJmYWlsZWQgdG8gcXVlcnkgdmlydHF1ZXVlXG4iKTsKPiArCQlyZXR1
cm47Cj4gKwl9Cj4gKwlpZiAobXZxLT5md19zdGF0ZSAhPSBNTFg1X1ZJUlRJT19ORVRfUV9PQkpF
Q1RfU1RBVEVfUkRZKQo+ICsJCXJldHVybjsKPiArCj4gKwlpZiAobW9kaWZ5X3ZpcnRxdWV1ZShu
ZGV2LCBtdnEsIE1MWDVfVklSVElPX05FVF9RX09CSkVDVF9TVEFURV9TVVNQRU5EKSkKPiArCQlt
bHg1X3ZkcGFfd2FybigmbmRldi0+bXZkZXYsICJtb2RpZnkgdG8gc3VzcGVuZCBmYWlsZWRcbiIp
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBzdXNwZW5kX3ZxcyhzdHJ1Y3QgbWx4NV92ZHBhX25l
dCAqbmRldikKPiArewo+ICsJaW50IGk7Cj4gKwo+ICsJZm9yIChpID0gMDsgaSA8IE1MWDVfTUFY
X1NVUFBPUlRFRF9WUVM7IGkrKykKPiArCQlzdXNwZW5kX3ZxKG5kZXYsICZuZGV2LT52cXNbaV0p
OwoKCkluIHRlYXJkb3duX3ZpcnRxdWV1ZXMoKSBpdCBoYXMgYSBjaGVjayBvZiBtdnEtPm51bV9l
bnQsIGFueSByZWFzb24gbm90IApkb2luZyBpdCBoZXJlPwoKCj4gK30KPiArCj4gK3N0YXRpYyB2
b2lkIHRlYXJkb3duX3ZxKHN0cnVjdCBtbHg1X3ZkcGFfbmV0ICpuZGV2LCBzdHJ1Y3QgbWx4NV92
ZHBhX3ZpcnRxdWV1ZSAqbXZxKQo+ICt7Cj4gKwlpZiAoIW12cS0+aW5pdGlhbGl6ZWQgfHwgIW12
cS0+bnVtX2VudCkKPiArCQlyZXR1cm47Cj4gKwo+ICsJc3VzcGVuZF92cShuZGV2LCBtdnEpOwo+
ICsJZGVzdHJveV92aXJ0cXVldWUobmRldiwgbXZxKTsKPiArCXFwX2Rlc3Ryb3kobmRldiwgJm12
cS0+dnFxcCk7Cj4gKwlxcF9kZXN0cm95KG5kZXYsICZtdnEtPmZ3cXApOwo+ICsJY3FfZGVzdHJv
eShuZGV2LCBtdnEtPmluZGV4KTsKPiArCW12cS0+aW5pdGlhbGl6ZWQgPSBmYWxzZTsKPiArfQo+
ICsKPiArc3RhdGljIGludCBjcmVhdGVfcnF0KHN0cnVjdCBtbHg1X3ZkcGFfbmV0ICpuZGV2KQo+
ICt7Cj4gKwlpbnQgbG9nX21heF9ycXQ7Cj4gKwlpbnQgYWN1dGFsX3JxdDsKPiArCV9fYmUzMiAq
bGlzdDsKPiArCXZvaWQgKnJxdGM7Cj4gKwlpbnQgaW5sZW47Cj4gKwl2b2lkICppbjsKPiArCWlu
dCBpLCBqOwo+ICsJaW50IGVycjsKPiArCj4gKwlsb2dfbWF4X3JxdCA9IG1pbl90KGludCwgMSwg
TUxYNV9DQVBfR0VOKG5kZXYtPm12ZGV2Lm1kZXYsIGxvZ19tYXhfcnF0X3NpemUpKTsKPiArCWlm
IChsb2dfbWF4X3JxdCA8IDEpCj4gKwkJcmV0dXJuIC1FT1BOT1RTVVBQOwo+ICsKPiArCWFjdXRh
bF9ycXQgPSAxOwo+ICsJaW5sZW4gPSBNTFg1X1NUX1NaX0JZVEVTKGNyZWF0ZV9ycXRfaW4pICsg
KDEgPDwgbG9nX21heF9ycXQpICogTUxYNV9TVF9TWl9CWVRFUyhycV9udW0pOwo+ICsJaW4gPSBr
emFsbG9jKGlubGVuLCBHRlBfS0VSTkVMKTsKPiArCWlmICghaW4pCj4gKwkJcmV0dXJuIC1FTk9N
RU07Cj4gKwo+ICsJTUxYNV9TRVQoY3JlYXRlX3JxdF9pbiwgaW4sIHVpZCwgbmRldi0+bXZkZXYu
cmVzLnVpZCk7Cj4gKwlycXRjID0gTUxYNV9BRERSX09GKGNyZWF0ZV9ycXRfaW4sIGluLCBycXRf
Y29udGV4dCk7Cj4gKwo+ICsJTUxYNV9TRVQocnF0YywgcnF0YywgbGlzdF9xX3R5cGUsIE1MWDVf
UlFUQ19MSVNUX1FfVFlQRV9WSVJUSU9fTkVUX1EpOwo+ICsJTUxYNV9TRVQocnF0YywgcnF0Yywg
cnF0X21heF9zaXplLCAxIDw8IGxvZ19tYXhfcnF0KTsKPiArCU1MWDVfU0VUKHJxdGMsIHJxdGMs
IHJxdF9hY3R1YWxfc2l6ZSwgMSk7Cj4gKwlsaXN0ID0gTUxYNV9BRERSX09GKHJxdGMsIHJxdGMs
IHJxX251bVswXSk7Cj4gKwlmb3IgKGkgPSAwLCBqID0gMDsgaiA8IG5kZXYtPm12ZGV2Lm1heF92
cXM7IGorKykgewo+ICsJCWlmICghbmRldi0+dnFzW2pdLmluaXRpYWxpemVkKQo+ICsJCQljb250
aW51ZTsKPiArCj4gKwkJaWYgKCF2cV9pc190eChuZGV2LT52cXNbal0uaW5kZXgpKSB7Cj4gKwkJ
CWxpc3RbaV0gPSBjcHVfdG9fYmUzMihuZGV2LT52cXNbal0udmlydHFfaWQpOwo+ICsJCQlpKys7
Cj4gKwkJfQo+ICsJfQo+ICsKPiArCWVyciA9IG1seDVfdmRwYV9jcmVhdGVfcnF0KCZuZGV2LT5t
dmRldiwgaW4sIGlubGVuLCAmbmRldi0+cmVzLnJxdG4pOwo+ICsJa2ZyZWUoaW4pOwo+ICsJaWYg
KGVycikKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0
aWMgdm9pZCBkZXN0cm95X3JxdChzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldikKPiArewo+ICsJ
bWx4NV92ZHBhX2Rlc3Ryb3lfcnF0KCZuZGV2LT5tdmRldiwgbmRldi0+cmVzLnJxdG4pOwo+ICt9
Cj4gKwo+ICtzdGF0aWMgaW50IGNyZWF0ZV90aXIoc3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYp
Cj4gK3sKPiArI2RlZmluZSBIQVNIX0lQX0w0UE9SVFMgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ICsJ
KE1MWDVfSEFTSF9GSUVMRF9TRUxfU1JDX0lQIHwgTUxYNV9IQVNIX0ZJRUxEX1NFTF9EU1RfSVAg
fCBNTFg1X0hBU0hfRklFTERfU0VMX0w0X1NQT1JUIHwgIFwKPiArCSBNTFg1X0hBU0hfRklFTERf
U0VMX0w0X0RQT1JUKQo+ICsJc3RhdGljIGNvbnN0IHU4IHJ4X2hhc2hfdG9lcGxpdHpfa2V5W10g
PSB7IDB4MmMsIDB4YzYsIDB4ODEsIDB4ZDEsIDB4NWIsIDB4ZGIsIDB4ZjQsIDB4ZjcsCj4gKwkJ
CQkJCSAgIDB4ZmMsIDB4YTIsIDB4ODMsIDB4MTksIDB4ZGIsIDB4MWEsIDB4M2UsIDB4OTQsCj4g
KwkJCQkJCSAgIDB4NmIsIDB4OWUsIDB4MzgsIDB4ZDksIDB4MmMsIDB4OWMsIDB4MDMsIDB4ZDEs
Cj4gKwkJCQkJCSAgIDB4YWQsIDB4OTksIDB4NDQsIDB4YTcsIDB4ZDksIDB4NTYsIDB4M2QsIDB4
NTksCj4gKwkJCQkJCSAgIDB4MDYsIDB4M2MsIDB4MjUsIDB4ZjMsIDB4ZmMsIDB4MWYsIDB4ZGMs
IDB4MmEgfTsKPiArCXZvaWQgKnJzc19rZXk7Cj4gKwl2b2lkICpvdXRlcjsKPiArCXZvaWQgKnRp
cmM7Cj4gKwl2b2lkICppbjsKPiArCWludCBlcnI7Cj4gKwo+ICsJaW4gPSBremFsbG9jKE1MWDVf
U1RfU1pfQllURVMoY3JlYXRlX3Rpcl9pbiksIEdGUF9LRVJORUwpOwo+ICsJaWYgKCFpbikKPiAr
CQlyZXR1cm4gLUVOT01FTTsKPiArCj4gKwlNTFg1X1NFVChjcmVhdGVfdGlyX2luLCBpbiwgdWlk
LCBuZGV2LT5tdmRldi5yZXMudWlkKTsKPiArCXRpcmMgPSBNTFg1X0FERFJfT0YoY3JlYXRlX3Rp
cl9pbiwgaW4sIGN0eCk7Cj4gKwlNTFg1X1NFVCh0aXJjLCB0aXJjLCBkaXNwX3R5cGUsIE1MWDVf
VElSQ19ESVNQX1RZUEVfSU5ESVJFQ1QpOwo+ICsKPiArCU1MWDVfU0VUKHRpcmMsIHRpcmMsIHJ4
X2hhc2hfc3ltbWV0cmljLCAxKTsKPiArCU1MWDVfU0VUKHRpcmMsIHRpcmMsIHJ4X2hhc2hfZm4s
IE1MWDVfUlhfSEFTSF9GTl9UT0VQTElUWik7Cj4gKwlyc3Nfa2V5ID0gTUxYNV9BRERSX09GKHRp
cmMsIHRpcmMsIHJ4X2hhc2hfdG9lcGxpdHpfa2V5KTsKPiArCW1lbWNweShyc3Nfa2V5LCByeF9o
YXNoX3RvZXBsaXR6X2tleSwgc2l6ZW9mKHJ4X2hhc2hfdG9lcGxpdHpfa2V5KSk7Cj4gKwo+ICsJ
b3V0ZXIgPSBNTFg1X0FERFJfT0YodGlyYywgdGlyYywgcnhfaGFzaF9maWVsZF9zZWxlY3Rvcl9v
dXRlcik7Cj4gKwlNTFg1X1NFVChyeF9oYXNoX2ZpZWxkX3NlbGVjdCwgb3V0ZXIsIGwzX3Byb3Rf
dHlwZSwgTUxYNV9MM19QUk9UX1RZUEVfSVBWNCk7Cj4gKwlNTFg1X1NFVChyeF9oYXNoX2ZpZWxk
X3NlbGVjdCwgb3V0ZXIsIGw0X3Byb3RfdHlwZSwgTUxYNV9MNF9QUk9UX1RZUEVfVENQKTsKPiAr
CU1MWDVfU0VUKHJ4X2hhc2hfZmllbGRfc2VsZWN0LCBvdXRlciwgc2VsZWN0ZWRfZmllbGRzLCBI
QVNIX0lQX0w0UE9SVFMpOwo+ICsKPiArCU1MWDVfU0VUKHRpcmMsIHRpcmMsIGluZGlyZWN0X3Rh
YmxlLCBuZGV2LT5yZXMucnF0bik7Cj4gKwlNTFg1X1NFVCh0aXJjLCB0aXJjLCB0cmFuc3BvcnRf
ZG9tYWluLCBuZGV2LT5yZXMudGRuKTsKPiArCj4gKwllcnIgPSBtbHg1X3ZkcGFfY3JlYXRlX3Rp
cigmbmRldi0+bXZkZXYsIGluLCAmbmRldi0+cmVzLnRpcm4pOwo+ICsJa2ZyZWUoaW4pOwo+ICsJ
cmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZGVzdHJveV90aXIoc3RydWN0IG1s
eDVfdmRwYV9uZXQgKm5kZXYpCj4gK3sKPiArCW1seDVfdmRwYV9kZXN0cm95X3RpcigmbmRldi0+
bXZkZXYsIG5kZXYtPnJlcy50aXJuKTsKPiArfQo+ICsKPiArc3RhdGljIGludCBhZGRfZndkX3Rv
X3RpcihzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldikKPiArewo+ICsJc3RydWN0IG1seDVfZmxv
d19kZXN0aW5hdGlvbiBkZXN0WzJdID0ge307Cj4gKwlzdHJ1Y3QgbWx4NV9mbG93X3RhYmxlX2F0
dHIgZnRfYXR0ciA9IHt9Owo+ICsJc3RydWN0IG1seDVfZmxvd19hY3QgZmxvd19hY3QgPSB7fTsK
PiArCXN0cnVjdCBtbHg1X2Zsb3dfbmFtZXNwYWNlICpuczsKPiArCWludCBlcnI7Cj4gKwo+ICsJ
LyogZm9yIG5vdywgb25lIGVudHJ5LCBtYXRjaCBhbGwsIGZvcndhcmQgdG8gdGlyICovCj4gKwlm
dF9hdHRyLm1heF9mdGUgPSAxOwo+ICsJZnRfYXR0ci5hdXRvZ3JvdXAubWF4X251bV9ncm91cHMg
PSAxOwo+ICsKPiArCW5zID0gbWx4NV9nZXRfZmxvd19uYW1lc3BhY2UobmRldi0+bXZkZXYubWRl
diwgTUxYNV9GTE9XX05BTUVTUEFDRV9CWVBBU1MpOwo+ICsJaWYgKCFucykgewo+ICsJCW1seDVf
dmRwYV93YXJuKCZuZGV2LT5tdmRldiwgImdldCBmbG93IG5hbWVzcGFjZVxuIik7Cj4gKwkJcmV0
dXJuIC1FT1BOT1RTVVBQOwo+ICsJfQo+ICsKPiArCW5kZXYtPnJ4ZnQgPSBtbHg1X2NyZWF0ZV9h
dXRvX2dyb3VwZWRfZmxvd190YWJsZShucywgJmZ0X2F0dHIpOwo+ICsJaWYgKElTX0VSUihuZGV2
LT5yeGZ0KSkKPiArCQlyZXR1cm4gUFRSX0VSUihuZGV2LT5yeGZ0KTsKPiArCj4gKwluZGV2LT5y
eF9jb3VudGVyID0gbWx4NV9mY19jcmVhdGUobmRldi0+bXZkZXYubWRldiwgZmFsc2UpOwo+ICsJ
aWYgKElTX0VSUihuZGV2LT5yeF9jb3VudGVyKSkgewo+ICsJCWVyciA9IFBUUl9FUlIobmRldi0+
cnhfY291bnRlcik7Cj4gKwkJZ290byBlcnJfZmM7Cj4gKwl9Cj4gKwo+ICsJZmxvd19hY3QuYWN0
aW9uID0gTUxYNV9GTE9XX0NPTlRFWFRfQUNUSU9OX0ZXRF9ERVNUIHwgTUxYNV9GTE9XX0NPTlRF
WFRfQUNUSU9OX0NPVU5UOwo+ICsJZGVzdFswXS50eXBlID0gTUxYNV9GTE9XX0RFU1RJTkFUSU9O
X1RZUEVfVElSOwo+ICsJZGVzdFswXS50aXJfbnVtID0gbmRldi0+cmVzLnRpcm47Cj4gKwlkZXN0
WzFdLnR5cGUgPSBNTFg1X0ZMT1dfREVTVElOQVRJT05fVFlQRV9DT1VOVEVSOwo+ICsJZGVzdFsx
XS5jb3VudGVyX2lkID0gbWx4NV9mY19pZChuZGV2LT5yeF9jb3VudGVyKTsKPiArCW5kZXYtPnJ4
X3J1bGUgPSBtbHg1X2FkZF9mbG93X3J1bGVzKG5kZXYtPnJ4ZnQsIE5VTEwsICZmbG93X2FjdCwg
ZGVzdCwgMik7Cj4gKwlpZiAoSVNfRVJSKG5kZXYtPnJ4X3J1bGUpKSB7Cj4gKwkJZXJyID0gUFRS
X0VSUihuZGV2LT5yeF9ydWxlKTsKPiArCQluZGV2LT5yeF9ydWxlID0gTlVMTDsKPiArCQlnb3Rv
IGVycl9ydWxlOwo+ICsJfQo+ICsKPiArCXJldHVybiAwOwo+ICsKPiArZXJyX3J1bGU6Cj4gKwlt
bHg1X2ZjX2Rlc3Ryb3kobmRldi0+bXZkZXYubWRldiwgbmRldi0+cnhfY291bnRlcik7Cj4gK2Vy
cl9mYzoKPiArCW1seDVfZGVzdHJveV9mbG93X3RhYmxlKG5kZXYtPnJ4ZnQpOwo+ICsJcmV0dXJu
IGVycjsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgcmVtb3ZlX2Z3ZF90b190aXIoc3RydWN0IG1s
eDVfdmRwYV9uZXQgKm5kZXYpCj4gK3sKPiArCWlmICghbmRldi0+cnhfcnVsZSkKPiArCQlyZXR1
cm47Cj4gKwo+ICsJbWx4NV9kZWxfZmxvd19ydWxlcyhuZGV2LT5yeF9ydWxlKTsKPiArCW1seDVf
ZmNfZGVzdHJveShuZGV2LT5tdmRldi5tZGV2LCBuZGV2LT5yeF9jb3VudGVyKTsKPiArCW1seDVf
ZGVzdHJveV9mbG93X3RhYmxlKG5kZXYtPnJ4ZnQpOwo+ICsKPiArCW5kZXYtPnJ4X3J1bGUgPSBO
VUxMOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBtbHg1X3ZkcGFfa2lja192cShzdHJ1Y3QgdmRw
YV9kZXZpY2UgKnZkZXYsIHUxNiBpZHgpCj4gK3sKPiArCXN0cnVjdCBtbHg1X3ZkcGFfZGV2ICpt
dmRldiA9IHRvX212ZGV2KHZkZXYpOwo+ICsJc3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYgPSB0
b19tbHg1X3ZkcGFfbmRldihtdmRldik7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX3ZpcnRxdWV1ZSAq
bXZxID0gJm5kZXYtPnZxc1tpZHhdOwo+ICsKPiArCWlmICh1bmxpa2VseSghbXZxLT5yZWFkeSkp
Cj4gKwkJcmV0dXJuOwo+ICsKPiArCWlvd3JpdGUxNihpZHgsIG5kZXYtPm12ZGV2LnJlcy5raWNr
X2FkZHIpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IG1seDVfdmRwYV9zZXRfdnFfYWRkcmVzcyhz
dHJ1Y3QgdmRwYV9kZXZpY2UgKnZkZXYsIHUxNiBpZHgsIHU2NCBkZXNjX2FyZWEsCj4gKwkJCQkg
ICAgdTY0IGRyaXZlcl9hcmVhLCB1NjQgZGV2aWNlX2FyZWEpCj4gK3sKPiArCXN0cnVjdCBtbHg1
X3ZkcGFfZGV2ICptdmRldiA9IHRvX212ZGV2KHZkZXYpOwo+ICsJc3RydWN0IG1seDVfdmRwYV9u
ZXQgKm5kZXYgPSB0b19tbHg1X3ZkcGFfbmRldihtdmRldik7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBh
X3ZpcnRxdWV1ZSAqbXZxID0gJm5kZXYtPnZxc1tpZHhdOwo+ICsKPiArCW12cS0+ZGVzY19hZGRy
ID0gZGVzY19hcmVhOwo+ICsJbXZxLT5kZXZpY2VfYWRkciA9IGRldmljZV9hcmVhOwo+ICsJbXZx
LT5kcml2ZXJfYWRkciA9IGRyaXZlcl9hcmVhOwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0
YXRpYyB2b2lkIG1seDVfdmRwYV9zZXRfdnFfbnVtKHN0cnVjdCB2ZHBhX2RldmljZSAqdmRldiwg
dTE2IGlkeCwgdTMyIG51bSkKPiArewo+ICsJc3RydWN0IG1seDVfdmRwYV9kZXYgKm12ZGV2ID0g
dG9fbXZkZXYodmRldik7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldiA9IHRvX21seDVf
dmRwYV9uZGV2KG12ZGV2KTsKPiArCXN0cnVjdCBtbHg1X3ZkcGFfdmlydHF1ZXVlICptdnE7Cj4g
Kwo+ICsJbXZxID0gJm5kZXYtPnZxc1tpZHhdOwo+ICsJbXZxLT5udW1fZW50ID0gbnVtOwo+ICt9
Cj4gKwo+ICtzdGF0aWMgdm9pZCBtbHg1X3ZkcGFfc2V0X3ZxX2NiKHN0cnVjdCB2ZHBhX2Rldmlj
ZSAqdmRldiwgdTE2IGlkeCwgc3RydWN0IHZkcGFfY2FsbGJhY2sgKmNiKQo+ICt7Cj4gKwlzdHJ1
Y3QgbWx4NV92ZHBhX2RldiAqbXZkZXYgPSB0b19tdmRldih2ZGV2KTsKPiArCXN0cnVjdCBtbHg1
X3ZkcGFfbmV0ICpuZGV2ID0gdG9fbWx4NV92ZHBhX25kZXYobXZkZXYpOwo+ICsJc3RydWN0IG1s
eDVfdmRwYV92aXJ0cXVldWUgKnZxID0gJm5kZXYtPnZxc1tpZHhdOwo+ICsKPiArCXZxLT5ldmVu
dF9jYiA9ICpjYjsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgbWx4NV92ZHBhX3NldF92cV9yZWFk
eShzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkZXYsIHUxNiBpZHgsIGJvb2wgcmVhZHkpCj4gK3sKPiAr
CXN0cnVjdCBtbHg1X3ZkcGFfZGV2ICptdmRldiA9IHRvX212ZGV2KHZkZXYpOwo+ICsJc3RydWN0
IG1seDVfdmRwYV9uZXQgKm5kZXYgPSB0b19tbHg1X3ZkcGFfbmRldihtdmRldik7Cj4gKwlzdHJ1
Y3QgbWx4NV92ZHBhX3ZpcnRxdWV1ZSAqbXZxID0gJm5kZXYtPnZxc1tpZHhdOwo+ICsJaW50IGVy
cjsKPiArCj4gKwlpZiAoIW12cS0+cmVhZHkgJiYgcmVhZHkgJiYgbXZxLT5md19zdGF0ZSAhPSBN
TFg1X1ZJUlRJT19ORVRfUV9PQkpFQ1RfU1RBVEVfUkRZKSB7Cj4gKwkJZXJyID0gbW9kaWZ5X3Zp
cnRxdWV1ZShuZGV2LCBtdnEsIE1MWDVfVklSVElPX05FVF9RX09CSkVDVF9TVEFURV9SRFkpOwo+
ICsJCWlmIChlcnIpIHsKPiArCQkJbWx4NV92ZHBhX3dhcm4obXZkZXYsICJmYWlsZWQgdG8gbW9k
aWZ5IHZpcnRxdWV1ZSglZClcbiIsIGVycik7Cj4gKwkJCXJldHVybjsKPiArCQl9Cj4gKwl9CgoK
SSB3b25kZXIgd2hhdCdzIHRoZSByZWFzb24gb2YgY2hhbmdpbmcgdnEgc3RhdGUgb24gdGhlIGhh
cmR3YXJlIGhlcmUuIEkgCnRoaW5rIHdlIGNhbiBkZWZlciBpdCB0byBzZXRfc3RhdHVzKCkuCgoo
QW55aG93IHdlIGRvbid0IHN5bmMgdnEgYWRkcmVzcyBpbiBzZXRfdnFfYWRkcmVzcygpKS4KCgo+
ICsKPiArCW12cS0+cmVhZHkgPSByZWFkeTsKPiArfQo+ICsKPiArc3RhdGljIGJvb2wgbWx4NV92
ZHBhX2dldF92cV9yZWFkeShzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkZXYsIHUxNiBpZHgpCj4gK3sK
PiArCXN0cnVjdCBtbHg1X3ZkcGFfZGV2ICptdmRldiA9IHRvX212ZGV2KHZkZXYpOwo+ICsJc3Ry
dWN0IG1seDVfdmRwYV9uZXQgKm5kZXYgPSB0b19tbHg1X3ZkcGFfbmRldihtdmRldik7Cj4gKwlz
dHJ1Y3QgbWx4NV92ZHBhX3ZpcnRxdWV1ZSAqbXZxID0gJm5kZXYtPnZxc1tpZHhdOwo+ICsKPiAr
CXJldHVybiBtdnEtPnJlYWR5Owo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IG1seDVfdmRwYV9zZXRf
dnFfc3RhdGUoc3RydWN0IHZkcGFfZGV2aWNlICp2ZGV2LCB1MTYgaWR4LAo+ICsJCQkJICBjb25z
dCBzdHJ1Y3QgdmRwYV92cV9zdGF0ZSAqc3RhdGUpCj4gK3sKPiArCXN0cnVjdCBtbHg1X3ZkcGFf
ZGV2ICptdmRldiA9IHRvX212ZGV2KHZkZXYpOwo+ICsJc3RydWN0IG1seDVfdmRwYV9uZXQgKm5k
ZXYgPSB0b19tbHg1X3ZkcGFfbmRldihtdmRldik7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX3ZpcnRx
dWV1ZSAqbXZxID0gJm5kZXYtPnZxc1tpZHhdOwo+ICsKPiArCWlmIChtdnEtPmZ3X3N0YXRlID09
IE1MWDVfVklSVElPX05FVF9RX09CSkVDVF9TVEFURV9SRFkpIHsKPiArCQltbHg1X3ZkcGFfd2Fy
bihtdmRldiwgImNhbid0IG1vZGlmeSBhdmFpbGFibGUgaW5kZXhcbiIpOwo+ICsJCXJldHVybiAt
RUlOVkFMOwo+ICsJfQo+ICsKPiArCW12cS0+YXZhaWxfaWR4ID0gc3RhdGUtPmF2YWlsX2luZGV4
Owo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIG1seDVfdmRwYV9nZXRfdnFf
c3RhdGUoc3RydWN0IHZkcGFfZGV2aWNlICp2ZGV2LCB1MTYgaWR4LCBzdHJ1Y3QgdmRwYV92cV9z
dGF0ZSAqc3RhdGUpCj4gK3sKPiArCXN0cnVjdCBtbHg1X3ZkcGFfZGV2ICptdmRldiA9IHRvX212
ZGV2KHZkZXYpOwo+ICsJc3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYgPSB0b19tbHg1X3ZkcGFf
bmRldihtdmRldik7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX3ZpcnRxdWV1ZSAqbXZxID0gJm5kZXYt
PnZxc1tpZHhdOwo+ICsJc3RydWN0IG1seDVfdmlydHFfYXR0ciBhdHRyOwo+ICsJaW50IGVycjsK
PiArCj4gKwlpZiAoIW12cS0+aW5pdGlhbGl6ZWQpCj4gKwkJZ290byBub3RfcmVhZHk7Cj4gKwo+
ICsJZXJyID0gcXVlcnlfdmlydHF1ZXVlKG5kZXYsIG12cSwgJmF0dHIpOwo+ICsJaWYgKGVycikg
ewo+ICsJCW1seDVfdmRwYV93YXJuKG12ZGV2LCAiZmFpbGVkIHRvIHF1ZXJ5IHZpcnRxdWV1ZVxu
Iik7Cj4gKwkJZ290byBub3RfcmVhZHk7Cj4gKwl9Cj4gKwlzdGF0ZS0+YXZhaWxfaW5kZXggPSBh
dHRyLmF2YWlsYWJsZV9pbmRleDsKPiArCj4gK25vdF9yZWFkeToKPiArCXN0YXRlLT5zdGF0ZSA9
IFZRX1NUQVRFX05PVF9SRUFEWTsKPiArfQo+ICsKPiArc3RhdGljIHUzMiBtbHg1X3ZkcGFfZ2V0
X3ZxX2FsaWduKHN0cnVjdCB2ZHBhX2RldmljZSAqdmRldikKPiArewo+ICsJcmV0dXJuIFBBR0Vf
U0laRTsKPiArfQo+ICsKPiArZW51bSB7IE1MWDVfVklSVElPX05FVF9GX0dVRVNUX0NTVU0gPSAx
IDw8IDksCj4gKwlNTFg1X1ZJUlRJT19ORVRfRl9DU1VNID0gMSA8PCAxMCwKPiArCU1MWDVfVklS
VElPX05FVF9GX0hPU1RfVFNPNiA9IDEgPDwgMTEsCj4gKwlNTFg1X1ZJUlRJT19ORVRfRl9IT1NU
X1RTTzQgPSAxIDw8IDEyLAo+ICt9Owo+ICsKPiArc3RhdGljIHU2NCBtbHhfdG9fdnJpdGlvX2Zl
YXR1cmVzKHUxNiBkZXZfZmVhdHVyZXMpCj4gK3sKPiArCXU2NCByZXN1bHQgPSAwOwo+ICsKPiAr
CWlmIChkZXZfZmVhdHVyZXMgJiBNTFg1X1ZJUlRJT19ORVRfRl9HVUVTVF9DU1VNKQo+ICsJCXJl
c3VsdCB8PSBCSVQoVklSVElPX05FVF9GX0dVRVNUX0NTVU0pOwo+ICsJaWYgKGRldl9mZWF0dXJl
cyAmIE1MWDVfVklSVElPX05FVF9GX0NTVU0pCj4gKwkJcmVzdWx0IHw9IEJJVChWSVJUSU9fTkVU
X0ZfQ1NVTSk7Cj4gKwlpZiAoZGV2X2ZlYXR1cmVzICYgTUxYNV9WSVJUSU9fTkVUX0ZfSE9TVF9U
U082KQo+ICsJCXJlc3VsdCB8PSBCSVQoVklSVElPX05FVF9GX0hPU1RfVFNPNik7Cj4gKwlpZiAo
ZGV2X2ZlYXR1cmVzICYgTUxYNV9WSVJUSU9fTkVUX0ZfSE9TVF9UU080KQo+ICsJCXJlc3VsdCB8
PSBCSVQoVklSVElPX05FVF9GX0hPU1RfVFNPNCk7Cj4gKwo+ICsJcmV0dXJuIHJlc3VsdDsKPiAr
fQo+ICsKPiArc3RhdGljIHU2NCBtbHg1X3ZkcGFfZ2V0X2ZlYXR1cmVzKHN0cnVjdCB2ZHBhX2Rl
dmljZSAqdmRldikKPiArewo+ICsJc3RydWN0IG1seDVfdmRwYV9kZXYgKm12ZGV2ID0gdG9fbXZk
ZXYodmRldik7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldiA9IHRvX21seDVfdmRwYV9u
ZGV2KG12ZGV2KTsKPiArCXUxNiBkZXZfZmVhdHVyZXM7Cj4gKwo+ICsJZGV2X2ZlYXR1cmVzID0g
TUxYNV9DQVBfREVWX1ZEUEFfRU1VTEFUSU9OKG12ZGV2LT5tZGV2LCBkZXZpY2VfZmVhdHVyZXNf
Yml0c19tYXNrKTsKPiArCW5kZXYtPm12ZGV2Lm1seF9mZWF0dXJlcyA9IG1seF90b192cml0aW9f
ZmVhdHVyZXMoZGV2X2ZlYXR1cmVzKTsKPiArCWlmIChNTFg1X0NBUF9ERVZfVkRQQV9FTVVMQVRJ
T04obXZkZXYtPm1kZXYsIHZpcnRpb192ZXJzaW9uXzFfMCkpCj4gKwkJbmRldi0+bXZkZXYubWx4
X2ZlYXR1cmVzIHw9IEJJVChWSVJUSU9fRl9WRVJTSU9OXzEpOwoKClRoaXMgaXMgaW50ZXJlc3Rp
bmcuIFRoaXMgc3VnZ2VzdHMgIVZJUlRJT19GX1ZFUlNJT05fMSAmJiAKVklSVElPX0ZfSU9NTVVf
UExBVEZPUk0gaXMgdmFsaWQuIEJ1dCB2aXJpdG8gc3BlYyBkb2Vzbid0IGFsbG93IHN1Y2ggCmNv
bmZpZ3VyYXRpb24uCgpTbyBJIHRoaW5rIHlvdSBuZWVkIGVpdGhlcjoKCjEpIEZhaWwgdkRQQSBk
ZXZpY2UgcHJvYmUgd2hlbiBWRVJTSU9OXzEgaXMgbm90IHN1cHBvcnRlZAoyKSBjbGVhciBJT01N
VV9QTEFURk9STSBpZiBWRVJTSU9OXzEgaXMgbm90IG5lZ290aWF0ZWQKCkZvciAyKSBJIGd1ZXNz
IGl0IGNhbid0IHdvcmssIGFjY29yZGluZyB0byB0aGUgc3BlYywgd2l0aG91dCAKSU9NTVVfUExB
VEZPUk0sIGRldmljZSBuZWVkIHRvIHVzZSBQQSB0byBhY2Nlc3MgdGhlIG1lbW9yeQoKCj4gKwlu
ZGV2LT5tdmRldi5tbHhfZmVhdHVyZXMgfD0gQklUKFZJUlRJT19GX0FOWV9MQVlPVVQpOwo+ICsJ
bmRldi0+bXZkZXYubWx4X2ZlYXR1cmVzIHw9IEJJVChWSVJUSU9fRl9JT01NVV9QTEFURk9STSk7
Cj4gKwlpZiAobWx4NV92ZHBhX21heF9xcHMobmRldi0+bXZkZXYubWF4X3ZxcykgPiAxKQo+ICsJ
CW5kZXYtPm12ZGV2Lm1seF9mZWF0dXJlcyB8PSBCSVQoVklSVElPX05FVF9GX01RKTsKPiArCj4g
KwlwcmludF9mZWF0dXJlcyhtdmRldiwgbmRldi0+bXZkZXYubWx4X2ZlYXR1cmVzLCBmYWxzZSk7
Cj4gKwlyZXR1cm4gbmRldi0+bXZkZXYubWx4X2ZlYXR1cmVzOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
aW50IHZlcmlmeV9taW5fZmVhdHVyZXMoc3RydWN0IG1seDVfdmRwYV9kZXYgKm12ZGV2LCB1NjQg
ZmVhdHVyZXMpCj4gK3sKPiArCS8qIEZJWE1FOiBxZW11IGN1cnJlbnRseSBkb2VzIG5vdCBzZXQg
YWxsIHRoZSBmZWF1cmVzIGR1ZSB0byBhIGJ1Zy4KPiArCSAqIEFkZCBjaGVja3Mgd2hlbiB0aGlz
IGlzIGZpeGVkLgo+ICsJICovCgoKSSB0aGluayB3ZSBzaG91bGQgYWRkIHRoZSBjaGVjayBub3cg
dGhlbiBxZW11IGNhbiBnZXQgbm90aWZpZWQuIChFLmcgCklPTU1VX1BMQVRGT1JNKQoKCj4gKwly
ZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGludCBzZXR1cF92aXJ0cXVldWVzKHN0cnVjdCBt
bHg1X3ZkcGFfbmV0ICpuZGV2KQo+ICt7Cj4gKwlpbnQgZXJyOwo+ICsJaW50IGk7Cj4gKwo+ICsJ
Zm9yIChpID0gMDsgaSA8IDIgKiBtbHg1X3ZkcGFfbWF4X3FwcyhuZGV2LT5tdmRldi5tYXhfdnFz
KTsgaSsrKSB7Cj4gKwkJZXJyID0gc2V0dXBfdnEobmRldiwgJm5kZXYtPnZxc1tpXSk7Cj4gKwkJ
aWYgKGVycikKPiArCQkJZ290byBlcnJfdnE7Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gKwo+
ICtlcnJfdnE6Cj4gKwlmb3IgKC0taTsgaSA+PSAwOyBpLS0pCj4gKwkJdGVhcmRvd25fdnEobmRl
diwgJm5kZXYtPnZxc1tpXSk7Cj4gKwo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGlj
IHZvaWQgdGVhcmRvd25fdmlydHF1ZXVlcyhzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldikKPiAr
ewo+ICsJc3RydWN0IG1seDVfdmRwYV92aXJ0cXVldWUgKm12cTsKPiArCWludCBpOwo+ICsKPiAr
CWZvciAoaSA9IG5kZXYtPm12ZGV2Lm1heF92cXMgLSAxOyBpID49IDA7IGktLSkgewo+ICsJCW12
cSA9ICZuZGV2LT52cXNbaV07Cj4gKwkJaWYgKCFtdnEtPm51bV9lbnQpCj4gKwkJCWNvbnRpbnVl
Owo+ICsKPiArCQl0ZWFyZG93bl92cShuZGV2LCBtdnEpOwo+ICsJfQo+ICt9Cj4gKwo+ICtzdGF0
aWMgaW50IG1seDVfdmRwYV9zZXRfZmVhdHVyZXMoc3RydWN0IHZkcGFfZGV2aWNlICp2ZGV2LCB1
NjQgZmVhdHVyZXMpCj4gK3sKPiArCXN0cnVjdCBtbHg1X3ZkcGFfZGV2ICptdmRldiA9IHRvX212
ZGV2KHZkZXYpOwo+ICsJc3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYgPSB0b19tbHg1X3ZkcGFf
bmRldihtdmRldik7Cj4gKwlpbnQgZXJyOwo+ICsKPiArCXByaW50X2ZlYXR1cmVzKG12ZGV2LCBm
ZWF0dXJlcywgdHJ1ZSk7Cj4gKwo+ICsJZXJyID0gdmVyaWZ5X21pbl9mZWF0dXJlcyhtdmRldiwg
ZmVhdHVyZXMpOwo+ICsJaWYgKGVycikKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCW5kZXYtPm12
ZGV2LmFjdHVhbF9mZWF0dXJlcyA9IGZlYXR1cmVzICYgbmRldi0+bXZkZXYubWx4X2ZlYXR1cmVz
Owo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgbWx4NV92ZHBhX3NldF9j
b25maWdfY2Ioc3RydWN0IHZkcGFfZGV2aWNlICp2ZGV2LCBzdHJ1Y3QgdmRwYV9jYWxsYmFjayAq
Y2IpCj4gK3sKPiArCS8qIG5vdCBpbXBsZW1lbnRlZCAqLwo+ICsJbWx4NV92ZHBhX3dhcm4odG9f
bXZkZXYodmRldiksICJzZXQgY29uZmlnIGNhbGxiYWNrIG5vdCBzdXBwb3J0ZWRcbiIpOwo+ICt9
Cj4gKwo+ICsjZGVmaW5lIE1MWDVfVkRQQV9NQVhfVlFfRU5UUklFUyAyNTYKCgpJcyB0aGlzIGEg
aGFyZHdhcmUgbGltaXRhdGlvbiwgcWVtdSBjYW4gc3VwcG9ydCB1cCB0byAxSyB3aGljaCB0aGUg
CnJlcXVpcmVtZW50IG9mIHNvbWUgTkZWIGNhc2VzLgoKCj4gK3N0YXRpYyB1MTYgbWx4NV92ZHBh
X2dldF92cV9udW1fbWF4KHN0cnVjdCB2ZHBhX2RldmljZSAqdmRldikKPiArewo+ICsJcmV0dXJu
IE1MWDVfVkRQQV9NQVhfVlFfRU5UUklFUzsKPiArfQo+ICsKPiArc3RhdGljIHUzMiBtbHg1X3Zk
cGFfZ2V0X2RldmljZV9pZChzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkZXYpCj4gK3sKPiArCXJldHVy
biBWSVJUSU9fSURfTkVUOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdTMyIG1seDVfdmRwYV9nZXRfdmVu
ZG9yX2lkKHN0cnVjdCB2ZHBhX2RldmljZSAqdmRldikKPiArewo+ICsJcmV0dXJuIFBDSV9WRU5E
T1JfSURfTUVMTEFOT1g7Cj4gK30KPiArCj4gK3N0YXRpYyB1OCBtbHg1X3ZkcGFfZ2V0X3N0YXR1
cyhzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkZXYpCj4gK3sKPiArCXN0cnVjdCBtbHg1X3ZkcGFfZGV2
ICptdmRldiA9IHRvX212ZGV2KHZkZXYpOwo+ICsJc3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYg
PSB0b19tbHg1X3ZkcGFfbmRldihtdmRldik7Cj4gKwo+ICsJcHJpbnRfc3RhdHVzKG12ZGV2LCBu
ZGV2LT5tdmRldi5zdGF0dXMsIGZhbHNlKTsKPiArCXJldHVybiBuZGV2LT5tdmRldi5zdGF0dXM7
Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgc2F2ZV9jaGFubmVsX2luZm8oc3RydWN0IG1seDVfdmRw
YV9uZXQgKm5kZXYsIHN0cnVjdCBtbHg1X3ZkcGFfdmlydHF1ZXVlICptdnEpCj4gK3sKPiArCXN0
cnVjdCBtbHg1X3ZxX3Jlc3RvcmVfaW5mbyAqcmkgPSAmbXZxLT5yaTsKPiArCXN0cnVjdCBtbHg1
X3ZpcnRxX2F0dHIgYXR0cjsKPiArCWludCBlcnI7Cj4gKwo+ICsJaWYgKCFtdnEtPmluaXRpYWxp
emVkKQo+ICsJCXJldHVybiAwOwo+ICsKPiArCWVyciA9IHF1ZXJ5X3ZpcnRxdWV1ZShuZGV2LCBt
dnEsICZhdHRyKTsKPiArCWlmIChlcnIpCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwlyaS0+YXZh
aWxfaW5kZXggPSBhdHRyLmF2YWlsYWJsZV9pbmRleDsKPiArCXJpLT5yZWFkeSA9IG12cS0+cmVh
ZHk7Cj4gKwlyaS0+bnVtX2VudCA9IG12cS0+bnVtX2VudDsKPiArCXJpLT5kZXNjX2FkZHIgPSBt
dnEtPmRlc2NfYWRkcjsKPiArCXJpLT5kZXZpY2VfYWRkciA9IG12cS0+ZGV2aWNlX2FkZHI7Cj4g
KwlyaS0+ZHJpdmVyX2FkZHIgPSBtdnEtPmRyaXZlcl9hZGRyOwo+ICsJcmktPmNiID0gbXZxLT5l
dmVudF9jYjsKPiArCXJpLT5yZXN0b3JlID0gdHJ1ZTsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+
ICtzdGF0aWMgaW50IHNhdmVfY2hhbm5lbHNfaW5mbyhzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRl
dikKPiArewo+ICsJaW50IGk7Cj4gKwo+ICsJZm9yIChpID0gMDsgaSA8IG5kZXYtPm12ZGV2Lm1h
eF92cXM7IGkrKykgewo+ICsJCW1lbXNldCgmbmRldi0+dnFzW2ldLnJpLCAwLCBzaXplb2YobmRl
di0+dnFzW2ldLnJpKSk7Cj4gKwkJc2F2ZV9jaGFubmVsX2luZm8obmRldiwgJm5kZXYtPnZxc1tp
XSk7Cj4gKwl9Cj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgbWx4NV9jbGVh
cl92cXMoc3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYpCj4gK3sKPiArCWludCBpOwo+ICsKPiAr
CWZvciAoaSA9IDA7IGkgPCBuZGV2LT5tdmRldi5tYXhfdnFzOyBpKyspCj4gKwkJbWVtc2V0KCZu
ZGV2LT52cXNbaV0sIDAsIG9mZnNldG9mKHN0cnVjdCBtbHg1X3ZkcGFfdmlydHF1ZXVlLCByaSkp
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCByZXN0b3JlX2NoYW5uZWxzX2luZm8oc3RydWN0IG1s
eDVfdmRwYV9uZXQgKm5kZXYpCj4gK3sKPiArCXN0cnVjdCBtbHg1X3ZkcGFfdmlydHF1ZXVlICpt
dnE7Cj4gKwlzdHJ1Y3QgbWx4NV92cV9yZXN0b3JlX2luZm8gKnJpOwo+ICsJaW50IGk7Cj4gKwo+
ICsJbWx4NV9jbGVhcl92cXMobmRldik7Cj4gKwlpbml0X212cXMobmRldik7Cj4gKwlmb3IgKGkg
PSAwOyBpIDwgbmRldi0+bXZkZXYubWF4X3ZxczsgaSsrKSB7Cj4gKwkJbXZxID0gJm5kZXYtPnZx
c1tpXTsKPiArCQlyaSA9ICZtdnEtPnJpOwo+ICsJCWlmICghcmktPnJlc3RvcmUpCj4gKwkJCWNv
bnRpbnVlOwo+ICsKPiArCQltdnEtPmF2YWlsX2lkeCA9IHJpLT5hdmFpbF9pbmRleDsKPiArCQlt
dnEtPnJlYWR5ID0gcmktPnJlYWR5Owo+ICsJCW12cS0+bnVtX2VudCA9IHJpLT5udW1fZW50Owo+
ICsJCW12cS0+ZGVzY19hZGRyID0gcmktPmRlc2NfYWRkcjsKPiArCQltdnEtPmRldmljZV9hZGRy
ID0gcmktPmRldmljZV9hZGRyOwo+ICsJCW12cS0+ZHJpdmVyX2FkZHIgPSByaS0+ZHJpdmVyX2Fk
ZHI7Cj4gKwkJbXZxLT5ldmVudF9jYiA9IHJpLT5jYjsKPiArCX0KPiArfQo+ICsKPiArc3RhdGlj
IGludCBtbHg1X3ZkcGFfY2hhbmdlX21hcChzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldiwgc3Ry
dWN0IHZob3N0X2lvdGxiICppb3RsYikKPiArewo+ICsJaW50IGVycjsKPiArCj4gKwlzdXNwZW5k
X3ZxcyhuZGV2KTsKPiArCWVyciA9IHNhdmVfY2hhbm5lbHNfaW5mbyhuZGV2KTsKPiArCWlmIChl
cnIpCj4gKwkJZ290byBlcnJfbXI7Cj4gKwo+ICsJdGVhcmRvd25fZHJpdmVyKG5kZXYpOwo+ICsJ
bWx4NV92ZHBhX2Rlc3Ryb3lfbXIoJm5kZXYtPm12ZGV2KTsKPiArCWVyciA9IG1seDVfdmRwYV9j
cmVhdGVfbXIoJm5kZXYtPm12ZGV2LCBpb3RsYik7Cj4gKwlpZiAoZXJyKQo+ICsJCWdvdG8gZXJy
X21yOwo+ICsKPiArCXJlc3RvcmVfY2hhbm5lbHNfaW5mbyhuZGV2KTsKPiArCWVyciA9IHNldHVw
X2RyaXZlcihuZGV2KTsKPiArCWlmIChlcnIpCj4gKwkJZ290byBlcnJfc2V0dXA7Cj4gKwo+ICsJ
cmV0dXJuIDA7Cj4gKwo+ICtlcnJfc2V0dXA6Cj4gKwltbHg1X3ZkcGFfZGVzdHJveV9tcigmbmRl
di0+bXZkZXYpOwo+ICtlcnJfbXI6Cj4gKwlyZXR1cm4gZXJyOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
aW50IHNldHVwX2RyaXZlcihzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldikKPiArewo+ICsJaW50
IGVycjsKPiArCj4gKwltdXRleF9sb2NrKCZuZGV2LT5yZXNsb2NrKTsKPiArCWlmIChuZGV2LT5z
ZXR1cCkgewo+ICsJCW1seDVfdmRwYV93YXJuKCZuZGV2LT5tdmRldiwgInNldHVwIGRyaXZlciBj
YWxsZWQgZm9yIGFscmVhZHkgc2V0dXAgZHJpdmVyXG4iKTsKPiArCQllcnIgPSAwOwo+ICsJCWdv
dG8gb3V0Owo+ICsJfQo+ICsJZXJyID0gc2V0dXBfdmlydHF1ZXVlcyhuZGV2KTsKPiArCWlmIChl
cnIpIHsKPiArCQltbHg1X3ZkcGFfd2FybigmbmRldi0+bXZkZXYsICJzZXR1cF92aXJ0cXVldWVz
XG4iKTsKPiArCQlnb3RvIG91dDsKPiArCX0KPiArCj4gKwllcnIgPSBjcmVhdGVfcnF0KG5kZXYp
Owo+ICsJaWYgKGVycikgewo+ICsJCW1seDVfdmRwYV93YXJuKCZuZGV2LT5tdmRldiwgImNyZWF0
ZV9ycXRcbiIpOwo+ICsJCWdvdG8gZXJyX3JxdDsKPiArCX0KPiArCj4gKwllcnIgPSBjcmVhdGVf
dGlyKG5kZXYpOwo+ICsJaWYgKGVycikgewo+ICsJCW1seDVfdmRwYV93YXJuKCZuZGV2LT5tdmRl
diwgImNyZWF0ZV90aXJcbiIpOwo+ICsJCWdvdG8gZXJyX3RpcjsKPiArCX0KPiArCj4gKwllcnIg
PSBhZGRfZndkX3RvX3RpcihuZGV2KTsKPiArCWlmIChlcnIpIHsKPiArCQltbHg1X3ZkcGFfd2Fy
bigmbmRldi0+bXZkZXYsICJhZGRfZndkX3RvX3RpclxuIik7Cj4gKwkJZ290byBlcnJfZndkOwo+
ICsJfQo+ICsJbmRldi0+c2V0dXAgPSB0cnVlOwo+ICsJbXV0ZXhfdW5sb2NrKCZuZGV2LT5yZXNs
b2NrKTsKPiArCj4gKwlyZXR1cm4gMDsKPiArCj4gK2Vycl9md2Q6Cj4gKwlkZXN0cm95X3Rpcihu
ZGV2KTsKPiArZXJyX3RpcjoKPiArCWRlc3Ryb3lfcnF0KG5kZXYpOwo+ICtlcnJfcnF0Ogo+ICsJ
dGVhcmRvd25fdmlydHF1ZXVlcyhuZGV2KTsKPiArb3V0Ogo+ICsJbXV0ZXhfdW5sb2NrKCZuZGV2
LT5yZXNsb2NrKTsKPiArCXJldHVybiBlcnI7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHRlYXJk
b3duX2RyaXZlcihzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldikKPiArewo+ICsJbXV0ZXhfbG9j
aygmbmRldi0+cmVzbG9jayk7Cj4gKwlpZiAoIW5kZXYtPnNldHVwKQo+ICsJCWdvdG8gb3V0Owo+
ICsKPiArCXJlbW92ZV9md2RfdG9fdGlyKG5kZXYpOwo+ICsJZGVzdHJveV90aXIobmRldik7Cj4g
KwlkZXN0cm95X3JxdChuZGV2KTsKPiArCXRlYXJkb3duX3ZpcnRxdWV1ZXMobmRldik7Cj4gKwlu
ZGV2LT5zZXR1cCA9IGZhbHNlOwo+ICtvdXQ6Cj4gKwltdXRleF91bmxvY2soJm5kZXYtPnJlc2xv
Y2spOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBtbHg1X3ZkcGFfc2V0X3N0YXR1cyhzdHJ1Y3Qg
dmRwYV9kZXZpY2UgKnZkZXYsIHU4IHN0YXR1cykKPiArewo+ICsJc3RydWN0IG1seDVfdmRwYV9k
ZXYgKm12ZGV2ID0gdG9fbXZkZXYodmRldik7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRl
diA9IHRvX21seDVfdmRwYV9uZGV2KG12ZGV2KTsKPiArCWludCBlcnI7Cj4gKwo+ICsJcHJpbnRf
c3RhdHVzKG12ZGV2LCBzdGF0dXMsIHRydWUpOwo+ICsJaWYgKCFzdGF0dXMpIHsKPiArCQltbHg1
X3ZkcGFfaW5mbyhtdmRldiwgInBlcmZvcm1pbmcgZGV2aWNlIHJlc2V0XG4iKTsKPiArCQl0ZWFy
ZG93bl9kcml2ZXIobmRldik7Cj4gKwkJbWx4NV92ZHBhX2Rlc3Ryb3lfbXIoJm5kZXYtPm12ZGV2
KTsKPiArCQluZGV2LT5tdmRldi5zdGF0dXMgPSAwOwo+ICsJCW5kZXYtPm12ZGV2Lm1seF9mZWF0
dXJlcyA9IDA7Cj4gKwkJKyttdmRldi0+Z2VuZXJhdGlvbjsKPiArCQlyZXR1cm47Cj4gKwl9Cj4g
Kwo+ICsJaWYgKChzdGF0dXMgXiBuZGV2LT5tdmRldi5zdGF0dXMpICYgVklSVElPX0NPTkZJR19T
X0RSSVZFUl9PSykgewo+ICsJCWlmIChzdGF0dXMgJiBWSVJUSU9fQ09ORklHX1NfRFJJVkVSX09L
KSB7Cj4gKwkJCWVyciA9IHNldHVwX2RyaXZlcihuZGV2KTsKPiArCQkJaWYgKGVycikgewo+ICsJ
CQkJbWx4NV92ZHBhX3dhcm4obXZkZXYsICJmYWlsZWQgdG8gc2V0dXAgZHJpdmVyXG4iKTsKPiAr
CQkJCWdvdG8gZXJyX3NldHVwOwo+ICsJCQl9Cj4gKwkJfSBlbHNlIHsKPiArCQkJbWx4NV92ZHBh
X3dhcm4obXZkZXYsICJkaWQgbm90IGV4cGVjdCBEUklWRVJfT0sgdG8gYmUgY2xlYXJlZFxuIik7
Cj4gKwkJCXJldHVybjsKPiArCQl9Cj4gKwl9Cj4gKwo+ICsJbmRldi0+bXZkZXYuc3RhdHVzID0g
c3RhdHVzOwo+ICsJcmV0dXJuOwo+ICsKPiArZXJyX3NldHVwOgo+ICsJbWx4NV92ZHBhX2Rlc3Ry
b3lfbXIoJm5kZXYtPm12ZGV2KTsKPiArCW5kZXYtPm12ZGV2LnN0YXR1cyB8PSBWSVJUSU9fQ09O
RklHX1NfRkFJTEVEOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBtbHg1X3ZkcGFfZ2V0X2NvbmZp
ZyhzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkZXYsIHVuc2lnbmVkIGludCBvZmZzZXQsIHZvaWQgKmJ1
ZiwKPiArCQkJCSB1bnNpZ25lZCBpbnQgbGVuKQo+ICt7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX2Rl
diAqbXZkZXYgPSB0b19tdmRldih2ZGV2KTsKPiArCXN0cnVjdCBtbHg1X3ZkcGFfbmV0ICpuZGV2
ID0gdG9fbWx4NV92ZHBhX25kZXYobXZkZXYpOwo+ICsKPiArCWlmIChvZmZzZXQgKyBsZW4gPCBz
aXplb2Yoc3RydWN0IHZpcnRpb19uZXRfY29uZmlnKSkKPiArCQltZW1jcHkoYnVmLCAmbmRldi0+
Y29uZmlnICsgb2Zmc2V0LCBsZW4pOwoKCk5vdGUgdGhhdCBndWVzdCBleHBlY3QgTEUsIHdoYXQn
cyB0aGUgZW5kaWFuIGZvciBuZGV2LT5jb25maWc/CgoKPiArfQo+ICsKPiArc3RhdGljIHZvaWQg
bWx4NV92ZHBhX3NldF9jb25maWcoc3RydWN0IHZkcGFfZGV2aWNlICp2ZGV2LCB1bnNpZ25lZCBp
bnQgb2Zmc2V0LCBjb25zdCB2b2lkICpidWYsCj4gKwkJCQkgdW5zaWduZWQgaW50IGxlbikKPiAr
ewo+ICsJLyogbm90IHN1cHBvcnRlZCAqLwo+ICt9Cj4gKwo+ICtzdGF0aWMgdTMyIG1seDVfdmRw
YV9nZXRfZ2VuZXJhdGlvbihzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkZXYpCj4gK3sKPiArCXN0cnVj
dCBtbHg1X3ZkcGFfZGV2ICptdmRldiA9IHRvX212ZGV2KHZkZXYpOwo+ICsKPiArCXJldHVybiBt
dmRldi0+Z2VuZXJhdGlvbjsKPiArfQo+ICsKPiArc3RhdGljIGludCBtbHg1X3ZkcGFfc2V0X21h
cChzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkZXYsIHN0cnVjdCB2aG9zdF9pb3RsYiAqaW90bGIpCj4g
K3sKPiArCXN0cnVjdCBtbHg1X3ZkcGFfZGV2ICptdmRldiA9IHRvX212ZGV2KHZkZXYpOwo+ICsJ
c3RydWN0IG1seDVfdmRwYV9uZXQgKm5kZXYgPSB0b19tbHg1X3ZkcGFfbmRldihtdmRldik7Cj4g
Kwlib29sIGNoYW5nZV9tYXA7Cj4gKwlpbnQgZXJyOwo+ICsKPiArCWVyciA9IG1seDVfdmRwYV9o
YW5kbGVfc2V0X21hcChtdmRldiwgaW90bGIsICZjaGFuZ2VfbWFwKTsKPiArCWlmIChlcnIpIHsK
PiArCQltbHg1X3ZkcGFfd2FybihtdmRldiwgInNldCBtYXAgZmFpbGVkKCVkKVxuIiwgZXJyKTsK
PiArCQlyZXR1cm4gZXJyOwo+ICsJfQo+ICsKPiArCWlmIChjaGFuZ2VfbWFwKQo+ICsJCXJldHVy
biBtbHg1X3ZkcGFfY2hhbmdlX21hcChuZGV2LCBpb3RsYik7CgoKQW55IHJlYXNvbiBmb3Igbm90
IGRvaW5nIHRoaXMgaW5zaWRlIG1seDVfaGFuZGxlX3NldF9tYXAoKT8KCgo+ICsKPiArCXJldHVy
biAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBtbHg1X3ZkcGFfZnJlZShzdHJ1Y3QgdmRwYV9k
ZXZpY2UgKnZkZXYpCj4gK3sKPiArCS8qIG5vdCB1c2VkICovCj4gK30KPiArCj4gK3N0YXRpYyBj
b25zdCBzdHJ1Y3QgdmRwYV9jb25maWdfb3BzIG1seDVfdmRwYV9vcHMgPSB7Cj4gKwkuc2V0X3Zx
X2FkZHJlc3MgPSBtbHg1X3ZkcGFfc2V0X3ZxX2FkZHJlc3MsCj4gKwkuc2V0X3ZxX251bSA9IG1s
eDVfdmRwYV9zZXRfdnFfbnVtLAo+ICsJLmtpY2tfdnEgPSBtbHg1X3ZkcGFfa2lja192cSwKPiAr
CS5zZXRfdnFfY2IgPSBtbHg1X3ZkcGFfc2V0X3ZxX2NiLAo+ICsJLnNldF92cV9yZWFkeSA9IG1s
eDVfdmRwYV9zZXRfdnFfcmVhZHksCj4gKwkuZ2V0X3ZxX3JlYWR5ID0gbWx4NV92ZHBhX2dldF92
cV9yZWFkeSwKPiArCS5zZXRfdnFfc3RhdGUgPSBtbHg1X3ZkcGFfc2V0X3ZxX3N0YXRlLAo+ICsJ
LmdldF92cV9zdGF0ZSA9IG1seDVfdmRwYV9nZXRfdnFfc3RhdGUsCj4gKwkuZ2V0X3ZxX2FsaWdu
ID0gbWx4NV92ZHBhX2dldF92cV9hbGlnbiwKPiArCS5nZXRfZmVhdHVyZXMgPSBtbHg1X3ZkcGFf
Z2V0X2ZlYXR1cmVzLAo+ICsJLnNldF9mZWF0dXJlcyA9IG1seDVfdmRwYV9zZXRfZmVhdHVyZXMs
Cj4gKwkuc2V0X2NvbmZpZ19jYiA9IG1seDVfdmRwYV9zZXRfY29uZmlnX2NiLAo+ICsJLmdldF92
cV9udW1fbWF4ID0gbWx4NV92ZHBhX2dldF92cV9udW1fbWF4LAo+ICsJLmdldF9kZXZpY2VfaWQg
PSBtbHg1X3ZkcGFfZ2V0X2RldmljZV9pZCwKPiArCS5nZXRfdmVuZG9yX2lkID0gbWx4NV92ZHBh
X2dldF92ZW5kb3JfaWQsCj4gKwkuZ2V0X3N0YXR1cyA9IG1seDVfdmRwYV9nZXRfc3RhdHVzLAo+
ICsJLnNldF9zdGF0dXMgPSBtbHg1X3ZkcGFfc2V0X3N0YXR1cywKPiArCS5nZXRfY29uZmlnID0g
bWx4NV92ZHBhX2dldF9jb25maWcsCj4gKwkuc2V0X2NvbmZpZyA9IG1seDVfdmRwYV9zZXRfY29u
ZmlnLAo+ICsJLmdldF9nZW5lcmF0aW9uID0gbWx4NV92ZHBhX2dldF9nZW5lcmF0aW9uLAo+ICsJ
LnNldF9tYXAgPSBtbHg1X3ZkcGFfc2V0X21hcCwKPiArCS5mcmVlID0gbWx4NV92ZHBhX2ZyZWUs
Cj4gK307Cj4gKwo+ICtzdGF0aWMgaW50IGFsbG9jX3Jlc291cmNlcyhzdHJ1Y3QgbWx4NV92ZHBh
X25ldCAqbmRldikKPiArewo+ICsJc3RydWN0IG1seDVfdmRwYV9uZXRfcmVzb3VyY2VzICpyZXMg
PSAmbmRldi0+cmVzOwo+ICsJaW50IGVycjsKPiArCj4gKwlpZiAocmVzLT52YWxpZCkgewo+ICsJ
CW1seDVfdmRwYV93YXJuKCZuZGV2LT5tdmRldiwgInJlc291cmNlcyBhbHJlYWR5IGFsbG9jYXRl
ZFxuIik7Cj4gKwkJcmV0dXJuIC1FRVhJU1Q7Cj4gKwl9Cj4gKwo+ICsJZXJyID0gbWx4NV92ZHBh
X2FsbG9jX3RyYW5zcG9ydF9kb21haW4oJm5kZXYtPm12ZGV2LCAmcmVzLT50ZG4pOwo+ICsJaWYg
KGVycikKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCWVyciA9IGNyZWF0ZV90aXMobmRldik7Cj4g
KwlpZiAoZXJyKQo+ICsJCWdvdG8gZXJyX3RpczsKPiArCj4gKwlyZXMtPnZhbGlkID0gdHJ1ZTsK
PiArCj4gKwlyZXR1cm4gMDsKPiArCj4gK2Vycl90aXM6Cj4gKwltbHg1X3ZkcGFfZGVhbGxvY190
cmFuc3BvcnRfZG9tYWluKCZuZGV2LT5tdmRldiwgcmVzLT50ZG4pOwo+ICsJcmV0dXJuIGVycjsK
PiArfQo+ICsKPiArc3RhdGljIHZvaWQgZnJlZV9yZXNvdXJjZXMoc3RydWN0IG1seDVfdmRwYV9u
ZXQgKm5kZXYpCj4gK3sKPiArCXN0cnVjdCBtbHg1X3ZkcGFfbmV0X3Jlc291cmNlcyAqcmVzID0g
Jm5kZXYtPnJlczsKPiArCj4gKwlpZiAoIXJlcy0+dmFsaWQpCj4gKwkJcmV0dXJuOwo+ICsKPiAr
CWRlc3Ryb3lfdGlzKG5kZXYpOwo+ICsJbWx4NV92ZHBhX2RlYWxsb2NfdHJhbnNwb3J0X2RvbWFp
bigmbmRldi0+bXZkZXYsIHJlcy0+dGRuKTsKPiArCXJlcy0+dmFsaWQgPSBmYWxzZTsKPiArfQo+
ICsKPiArc3RhdGljIHZvaWQgaW5pdF9tdnFzKHN0cnVjdCBtbHg1X3ZkcGFfbmV0ICpuZGV2KQo+
ICt7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX3ZpcnRxdWV1ZSAqbXZxOwo+ICsJaW50IGk7Cj4gKwo+
ICsJZm9yIChpID0gMDsgaSA8IDIgKiBtbHg1X3ZkcGFfbWF4X3FwcyhuZGV2LT5tdmRldi5tYXhf
dnFzKTsgKytpKSB7Cj4gKwkJbXZxID0gJm5kZXYtPnZxc1tpXTsKPiArCQltZW1zZXQobXZxLCAw
LCBvZmZzZXRvZihzdHJ1Y3QgbWx4NV92ZHBhX3ZpcnRxdWV1ZSwgcmkpKTsKPiArCQltdnEtPmlu
ZGV4ID0gaTsKPiArCQltdnEtPm5kZXYgPSBuZGV2Owo+ICsJCW12cS0+ZndxcC5mdyA9IHRydWU7
Cj4gKwl9Cj4gKwlmb3IgKDsgaSA8IG5kZXYtPm12ZGV2Lm1heF92cXM7IGkrKykgewo+ICsJCW12
cSA9ICZuZGV2LT52cXNbaV07Cj4gKwkJbWVtc2V0KG12cSwgMCwgb2Zmc2V0b2Yoc3RydWN0IG1s
eDVfdmRwYV92aXJ0cXVldWUsIHJpKSk7Cj4gKwkJbXZxLT5pbmRleCA9IGk7Cj4gKwkJbXZxLT5u
ZGV2ID0gbmRldjsKPiArCX0KPiArfQo+ICsKPiArdm9pZCAqbWx4NV92ZHBhX2FkZF9kZXYoc3Ry
dWN0IG1seDVfY29yZV9kZXYgKm1kZXYpCj4gK3sKPiArCXN0cnVjdCB2aXJ0aW9fbmV0X2NvbmZp
ZyAqY29uZmlnOwo+ICsJc3RydWN0IG1seDVfdmRwYV9kZXYgKm12ZGV2Owo+ICsJc3RydWN0IG1s
eDVfdmRwYV9uZXQgKm5kZXY7Cj4gKwl1MzIgbWF4X3ZxczsKPiArCWludCBlcnI7Cj4gKwo+ICsJ
Lyogd2Ugc2F2ZSBvbmUgdmlydHF1ZXVlIGZvciBjb250cm9sIHZpcnRxdWV1ZSBzaG91bGQgd2Ug
cmVxdWlyZSBpdCAqLwo+ICsJbWF4X3ZxcyA9IE1MWDVfQ0FQX0RFVl9WRFBBX0VNVUxBVElPTiht
ZGV2LCBtYXhfbnVtX3ZpcnRpb19xdWV1ZXMpOwo+ICsJbWF4X3ZxcyA9IG1pbl90KHUzMiwgbWF4
X3ZxcywgTUxYNV9NQVhfU1VQUE9SVEVEX1ZRUyk7Cj4gKwo+ICsJbmRldiA9IHZkcGFfYWxsb2Nf
ZGV2aWNlKHN0cnVjdCBtbHg1X3ZkcGFfbmV0LCBtdmRldi52ZGV2LCBtZGV2LT5kZXZpY2UsICZt
bHg1X3ZkcGFfb3BzLAo+ICsJCQkJIDIgKiBtbHg1X3ZkcGFfbWF4X3FwcyhtYXhfdnFzKSk7Cj4g
KwlpZiAoSVNfRVJSKG5kZXYpKQo+ICsJCXJldHVybiBuZGV2Owo+ICsKPiArCW5kZXYtPm12ZGV2
Lm1heF92cXMgPSBtYXhfdnFzOwo+ICsJbXZkZXYgPSAmbmRldi0+bXZkZXY7Cj4gKwltdmRldi0+
bWRldiA9IG1kZXY7Cj4gKwlpbml0X212cXMobmRldik7Cj4gKwltdXRleF9pbml0KCZuZGV2LT5y
ZXNsb2NrKTsKPiArCWNvbmZpZyA9ICZuZGV2LT5jb25maWc7Cj4gKwllcnIgPSBtbHg1X3F1ZXJ5
X25pY192cG9ydF9tdHUobWRldiwgJmNvbmZpZy0+bXR1KTsKPiArCWlmIChlcnIpCj4gKwkJZ290
byBlcnJfbXR1Owo+ICsKPiArCWVyciA9IG1seDVfcXVlcnlfbmljX3Zwb3J0X21hY19hZGRyZXNz
KG1kZXYsIDAsIDAsIGNvbmZpZy0+bWFjKTsKPiArCWlmIChlcnIpCj4gKwkJZ290byBlcnJfbXR1
Owo+ICsKPiArCW12ZGV2LT52ZGV2LmRtYV9kZXYgPSBtZGV2LT5kZXZpY2U7Cj4gKwllcnIgPSBt
bHg1X3ZkcGFfYWxsb2NfcmVzb3VyY2VzKCZuZGV2LT5tdmRldik7Cj4gKwlpZiAoZXJyKQo+ICsJ
CWdvdG8gZXJyX210dTsKPiArCj4gKwllcnIgPSBhbGxvY19yZXNvdXJjZXMobmRldik7Cj4gKwlp
ZiAoZXJyKQo+ICsJCWdvdG8gZXJyX3JlczsKPiArCj4gKwllcnIgPSB2ZHBhX3JlZ2lzdGVyX2Rl
dmljZSgmbXZkZXYtPnZkZXYpOwo+ICsJaWYgKGVycikKPiArCQlnb3RvIGVycl9yZWc7Cj4gKwo+
ICsJcmV0dXJuIG5kZXY7Cj4gKwo+ICtlcnJfcmVnOgo+ICsJZnJlZV9yZXNvdXJjZXMobmRldik7
Cj4gK2Vycl9yZXM6Cj4gKwltbHg1X3ZkcGFfZnJlZV9yZXNvdXJjZXMoJm5kZXYtPm12ZGV2KTsK
PiArZXJyX210dToKPiArCW11dGV4X2Rlc3Ryb3koJm5kZXYtPnJlc2xvY2spOwo+ICsJcHV0X2Rl
dmljZSgmbXZkZXYtPnZkZXYuZGV2KTsKPiArCXJldHVybiBFUlJfUFRSKGVycik7Cj4gK30KPiAr
Cj4gK3ZvaWQgbWx4NV92ZHBhX3JlbW92ZV9kZXYoc3RydWN0IG1seDVfdmRwYV9kZXYgKm12ZGV2
KQo+ICt7Cj4gKwlzdHJ1Y3QgbWx4NV92ZHBhX25ldCAqbmRldjsKPiArCj4gKwltdmRldi0+c3Rh
dHVzID0gMDsKCgpUaGlzIGlzIHByb2JhYmx5IHVubmVjZXNzYXJ5LgoKVGhhbmtzCgoKPiArCW5k
ZXYgPSBjb250YWluZXJfb2YobXZkZXYsIHN0cnVjdCBtbHg1X3ZkcGFfbmV0LCBtdmRldik7Cj4g
Kwl2ZHBhX3VucmVnaXN0ZXJfZGV2aWNlKCZuZGV2LT5tdmRldi52ZGV2KTsKPiArCWZyZWVfcmVz
b3VyY2VzKG5kZXYpOwo+ICsJbWx4NV92ZHBhX2ZyZWVfcmVzb3VyY2VzKCZuZGV2LT5tdmRldik7
Cj4gKwltdXRleF9kZXN0cm95KCZuZGV2LT5yZXNsb2NrKTsKPiArCXB1dF9kZXZpY2UoJm12ZGV2
LT52ZGV2LmRldik7Cj4gK30KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy92ZHBhL21seDUvbmV0L21s
eDVfdm5ldC5oIGIvZHJpdmVycy92ZHBhL21seDUvbmV0L21seDVfdm5ldC5oCj4gbmV3IGZpbGUg
bW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMDAwMDAuLjM4YmI5YWRhYWRjMQo+IC0tLSAvZGV2
L251bGwKPiArKysgYi9kcml2ZXJzL3ZkcGEvbWx4NS9uZXQvbWx4NV92bmV0LmgKPiBAQCAtMCww
ICsxLDMyIEBACj4gKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wIE9SIExpbnV4
LU9wZW5JQiAqLwo+ICsvKiBDb3B5cmlnaHQgKGMpIDIwMjAgTWVsbGFub3ggVGVjaG5vbG9naWVz
IEx0ZC4gKi8KPiArCj4gKyNpZm5kZWYgX19NTFg1X1ZORVRfSF8KPiArI2RlZmluZSBfX01MWDVf
Vk5FVF9IXwo+ICsKPiArI2luY2x1ZGUgPGxpbnV4L3ZkcGEuaD4KPiArI2luY2x1ZGUgPGxpbnV4
L3ZpcnRpb19uZXQuaD4KPiArI2luY2x1ZGUgPGxpbnV4L3ZyaW5naC5oPgo+ICsjaW5jbHVkZSA8
bGludXgvbWx4NS9kcml2ZXIuaD4KPiArI2luY2x1ZGUgPGxpbnV4L21seDUvY3EuaD4KPiArI2lu
Y2x1ZGUgPGxpbnV4L21seDUvcXAuaD4KPiArI2luY2x1ZGUgIi4uL2NvcmUvbWx4NV92ZHBhLmgi
Cj4gKwo+ICsvKiB3ZSB3YW50IHRvIGhhdmUgb25lIHZpcnRxdWV1ZSByZXNlcnZlZCBmb3IgY29u
dHJvbCBxdWV1ZS4gIFdlIGRvIHRoaXMKPiArICogcmVzZXJ2YXRpb24gb25seSBpZiB3ZSBoYXZl
IG1vcmUgdGhhbiB0d28gdnFzIGF2YWlsYWJsZS4KPiArICovCj4gK3N0YXRpYyBpbmxpbmUgdTMy
IG1seDVfdmRwYV9tYXhfcXBzKGludCBtYXhfdnFzKQo+ICt7Cj4gKwlpZiAobWF4X3ZxcyA+IDIp
Cj4gKwkJcmV0dXJuIChtYXhfdnFzIC0gMSkgLyAyOwo+ICsKPiArCXJldHVybiBtYXhfdnFzIC8g
MjsKPiArfQo+ICsKPiArI2RlZmluZSB0b19tbHg1X3ZkcGFfbmRldihfX212ZGV2KSBjb250YWlu
ZXJfb2YoX19tdmRldiwgc3RydWN0IG1seDVfdmRwYV9uZXQsIG12ZGV2KQo+ICt2b2lkICptbHg1
X3ZkcGFfYWRkX2RldihzdHJ1Y3QgbWx4NV9jb3JlX2RldiAqbWRldik7Cj4gK3ZvaWQgbWx4NV92
ZHBhX3JlbW92ZV9kZXYoc3RydWN0IG1seDVfdmRwYV9kZXYgKm12ZGV2KTsKPiAraW50IG1seDVf
dmRwYV9jcmVhdGVfbXIoc3RydWN0IG1seDVfdmRwYV9kZXYgKm12ZGV2LCBzdHJ1Y3Qgdmhvc3Rf
aW90bGIgKmlvdGxiKTsKPiArdm9pZCBtbHg1X3ZkcGFfZGVzdHJveV9tcihzdHJ1Y3QgbWx4NV92
ZHBhX2RldiAqbXZkZXYpOwo+ICsKPiArI2VuZGlmIC8qIF9fTUxYNV9WTkVUX0hfICovCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpWaXJ0dWFsaXphdGlv
biBtYWlsaW5nIGxpc3QKVmlydHVhbGl6YXRpb25AbGlzdHMubGludXgtZm91bmRhdGlvbi5vcmcK
aHR0cHM6Ly9saXN0cy5saW51eGZvdW5kYXRpb24ub3JnL21haWxtYW4vbGlzdGluZm8vdmlydHVh
bGl6YXRpb24=

