Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp1.osuosl.org (smtp1.osuosl.org [140.211.166.138])
	by mail.lfdr.de (Postfix) with ESMTPS id 411076B89E9
	for <lists.virtualization@lfdr.de>; Tue, 14 Mar 2023 05:54:22 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by smtp1.osuosl.org (Postfix) with ESMTP id AFF1781584;
	Tue, 14 Mar 2023 04:54:20 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org AFF1781584
Authentication-Results: smtp1.osuosl.org;
	dkim=fail reason="signature verification failed" (1024-bit key) header.d=redhat.com header.i=@redhat.com header.a=rsa-sha256 header.s=mimecast20190719 header.b=MpaMrJuA
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp1.osuosl.org ([127.0.0.1])
	by localhost (smtp1.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id vxXxG_ptMUeU; Tue, 14 Mar 2023 04:54:19 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by smtp1.osuosl.org (Postfix) with ESMTPS id 1F7B181768;
	Tue, 14 Mar 2023 04:54:19 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org 1F7B181768
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 4B1E7C008A;
	Tue, 14 Mar 2023 04:54:18 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp1.osuosl.org (smtp1.osuosl.org [140.211.166.138])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 35D0FC0032
 for <virtualization@lists.linux-foundation.org>;
 Tue, 14 Mar 2023 04:54:16 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp1.osuosl.org (Postfix) with ESMTP id 0817381758
 for <virtualization@lists.linux-foundation.org>;
 Tue, 14 Mar 2023 04:54:16 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org 0817381758
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp1.osuosl.org ([127.0.0.1])
 by localhost (smtp1.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 2PkEkSZ4dPGB
 for <virtualization@lists.linux-foundation.org>;
 Tue, 14 Mar 2023 04:54:14 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org 791CC81BE3
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.129.124])
 by smtp1.osuosl.org (Postfix) with ESMTPS id 791CC81BE3
 for <virtualization@lists.linux-foundation.org>;
 Tue, 14 Mar 2023 04:54:13 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1678769652;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=mhbeQsCOWkBmfbdwAK6IkHvnb648Y/rpGHwMeBRvTFU=;
 b=MpaMrJuA+9voXox2MfFWjqHxu5PGbwM1RsxgRnj9zl1xuOFjT2ERGF2JBmCNq/f53GVXo8
 wzw5l/XqvJNhBoXv3S0pXmEdLkOOkGKlIl/0CGC6f5UAxpvQwTEJcqCF7hTbG1OO/COMyz
 qQrmm541HvMYgiyG7jU85oFbOIPuAIc=
Received: from mail-ot1-f72.google.com (mail-ot1-f72.google.com
 [209.85.210.72]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384) id
 us-mta-577-Wb7ivds7Om-9_iyi1ldasg-1; Tue, 14 Mar 2023 00:54:11 -0400
X-MC-Unique: Wb7ivds7Om-9_iyi1ldasg-1
Received: by mail-ot1-f72.google.com with SMTP id
 x10-20020a056830408a00b0068db8db7c5aso7045371ott.11
 for <virtualization@lists.linux-foundation.org>;
 Mon, 13 Mar 2023 21:54:11 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20210112; t=1678769649;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
 :subject:date:message-id:reply-to;
 bh=mhbeQsCOWkBmfbdwAK6IkHvnb648Y/rpGHwMeBRvTFU=;
 b=iuOr3/F16oOYJ0wbTSjZAcPSJgKi1aN7RDadIf3nE9NgZt2hGCRaV3QGSQux1MDPJV
 G4T3o7Ho2GwNHIp3bQEGF4RNIm1n2qKgk5FNkuhkofnb1PX3vNE+yvrFwwcpsmoGtLMW
 ItDhzLXDdqBgC0BBretYJCLfApZT6KEqr5LGij4VcnbJtNUlrVy2rL1vhV+ksKCUgkpV
 Lm46/90uy7kiMLAB2xin8EXvJ7/sNyJEV/rcPmCDemKp7I31tezSw6sR94CZHfiGkccT
 GKc+kdGTtwS6QaRKRrGBIe0Q02uM/qXcDgIbgxDwnjH+AGmKHVlrVyoFz9RqoGXLeXtr
 8uqA==
X-Gm-Message-State: AO0yUKUQlWpKVuMG8GQCet7M+EaHqyGPqFJXUXNr47APb1NvhCe3GXpj
 DltBTkftCe8yk7PBAHsOICilanzq8R89K8J6Dps1UKD56+LWIuXFhDAW2l4iFXLpnyD63cGB2Jr
 JTsTCh4volXghoPkye8mrReWBjU3EEMpE0t11vdWbu+0MwTZbauYPK+V+FA==
X-Received: by 2002:a05:6870:5147:b0:177:b9c0:bcba with SMTP id
 z7-20020a056870514700b00177b9c0bcbamr2444290oak.3.1678769649260; 
 Mon, 13 Mar 2023 21:54:09 -0700 (PDT)
X-Google-Smtp-Source: AK7set+nRM380JVzXg4oGG6ZzdC0Wyk+h+IHs+whvfeimKYfKtBA7Fkefnns9aW+jmQB5Dnx/xRGCvWfvJjeLfw2NKQ=
X-Received: by 2002:a05:6870:5147:b0:177:b9c0:bcba with SMTP id
 z7-20020a056870514700b00177b9c0bcbamr2444279oak.3.1678769648938; Mon, 13 Mar
 2023 21:54:08 -0700 (PDT)
MIME-Version: 1.0
References: <20230302113421.174582-1-sgarzare@redhat.com>
 <20230302113421.174582-5-sgarzare@redhat.com>
In-Reply-To: <20230302113421.174582-5-sgarzare@redhat.com>
From: Jason Wang <jasowang@redhat.com>
Date: Tue, 14 Mar 2023 12:53:57 +0800
Message-ID: <CACGkMEui+-8JcTOsF+=b3W7oduMLsaL3Y7upUDmAMu4zPcrQTg@mail.gmail.com>
Subject: Re: [PATCH v2 4/8] vringh: support VA with iotlb
To: Stefano Garzarella <sgarzare@redhat.com>
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Cc: Andrey Zhadchenko <andrey.zhadchenko@virtuozzo.com>, kvm@vger.kernel.org,
 "Michael S. Tsirkin" <mst@redhat.com>, netdev@vger.kernel.org,
 linux-kernel@vger.kernel.org, virtualization@lists.linux-foundation.org,
 eperezma@redhat.com, stefanha@redhat.com
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gVGh1LCBNYXIgMiwgMjAyMyBhdCA3OjM14oCvUE0gU3RlZmFubyBHYXJ6YXJlbGxhIDxzZ2Fy
emFyZUByZWRoYXQuY29tPiB3cm90ZToKPgo+IHZEUEEgc3VwcG9ydHMgdGhlIHBvc3NpYmlsaXR5
IHRvIHVzZSB1c2VyIFZBIGluIHRoZSBpb3RsYiBtZXNzYWdlcy4KPiBTbywgbGV0J3MgYWRkIHN1
cHBvcnQgZm9yIHVzZXIgVkEgaW4gdnJpbmdoIHRvIHVzZSBpdCBpbiB0aGUgdkRQQQo+IHNpbXVs
YXRvcnMuCj4KPiBTaWduZWQtb2ZmLWJ5OiBTdGVmYW5vIEdhcnphcmVsbGEgPHNnYXJ6YXJlQHJl
ZGhhdC5jb20+Cj4gLS0tCj4KPiBOb3RlczoKPiAgICAgdjI6Cj4gICAgIC0gcmVwbGFjZSBrbWFw
X2F0b21pYygpIHdpdGgga21hcF9sb2NhbF9wYWdlKCkgW3NlZSBwcmV2aW91cyBwYXRjaF0KPiAg
ICAgLSBmaXggY2FzdCB3YXJuaW5ncyB3aGVuIGJ1aWxkIHdpdGggVz0xIEM9MQo+Cj4gIGluY2x1
ZGUvbGludXgvdnJpbmdoLmggICAgICAgICAgICB8ICAgNSArLQo+ICBkcml2ZXJzL3ZkcGEvbWx4
NS9uZXQvbWx4NV92bmV0LmMgfCAgIDIgKy0KPiAgZHJpdmVycy92ZHBhL3ZkcGFfc2ltL3ZkcGFf
c2ltLmMgIHwgICA0ICstCj4gIGRyaXZlcnMvdmhvc3QvdnJpbmdoLmMgICAgICAgICAgICB8IDI0
NyArKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0KPiAgNCBmaWxlcyBjaGFuZ2VkLCAyMDUg
aW5zZXJ0aW9ucygrKSwgNTMgZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9s
aW51eC92cmluZ2guaCBiL2luY2x1ZGUvbGludXgvdnJpbmdoLmgKPiBpbmRleCAxOTkxYTAyYzY0
MzEuLmQzOWI5ZjJkY2JhMCAxMDA2NDQKPiAtLS0gYS9pbmNsdWRlL2xpbnV4L3ZyaW5naC5oCj4g
KysrIGIvaW5jbHVkZS9saW51eC92cmluZ2guaAo+IEBAIC0zMiw2ICszMiw5IEBAIHN0cnVjdCB2
cmluZ2ggewo+ICAgICAgICAgLyogQ2FuIHdlIGdldCBhd2F5IHdpdGggd2VhayBiYXJyaWVycz8g
Ki8KPiAgICAgICAgIGJvb2wgd2Vha19iYXJyaWVyczsKPgo+ICsgICAgICAgLyogVXNlIHVzZXIn
cyBWQSAqLwo+ICsgICAgICAgYm9vbCB1c2VfdmE7Cj4gKwo+ICAgICAgICAgLyogTGFzdCBhdmFp
bGFibGUgaW5kZXggd2Ugc2F3IChpZS4gd2hlcmUgd2UncmUgdXAgdG8pLiAqLwo+ICAgICAgICAg
dTE2IGxhc3RfYXZhaWxfaWR4Owo+Cj4gQEAgLTI3OSw3ICsyODIsNyBAQCB2b2lkIHZyaW5naF9z
ZXRfaW90bGIoc3RydWN0IHZyaW5naCAqdnJoLCBzdHJ1Y3Qgdmhvc3RfaW90bGIgKmlvdGxiLAo+
ICAgICAgICAgICAgICAgICAgICAgICBzcGlubG9ja190ICppb3RsYl9sb2NrKTsKPgo+ICBpbnQg
dnJpbmdoX2luaXRfaW90bGIoc3RydWN0IHZyaW5naCAqdnJoLCB1NjQgZmVhdHVyZXMsCj4gLSAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBudW0sIGJvb2wgd2Vha19iYXJyaWVycywK
PiArICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG51bSwgYm9vbCB3ZWFrX2JhcnJp
ZXJzLCBib29sIHVzZV92YSwKPiAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHZyaW5nX2Rl
c2MgKmRlc2MsCj4gICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2cmluZ19hdmFpbCAqYXZh
aWwsCj4gICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2cmluZ191c2VkICp1c2VkKTsKPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy92ZHBhL21seDUvbmV0L21seDVfdm5ldC5jIGIvZHJpdmVycy92
ZHBhL21seDUvbmV0L21seDVfdm5ldC5jCj4gaW5kZXggM2EwZTcyMWFlZjA1Li5iYWJjOGRkMTcx
YTYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy92ZHBhL21seDUvbmV0L21seDVfdm5ldC5jCj4gKysr
IGIvZHJpdmVycy92ZHBhL21seDUvbmV0L21seDVfdm5ldC5jCj4gQEAgLTI1MzcsNyArMjUzNyw3
IEBAIHN0YXRpYyBpbnQgc2V0dXBfY3ZxX3ZyaW5nKHN0cnVjdCBtbHg1X3ZkcGFfZGV2ICptdmRl
dikKPgo+ICAgICAgICAgaWYgKG12ZGV2LT5hY3R1YWxfZmVhdHVyZXMgJiBCSVRfVUxMKFZJUlRJ
T19ORVRfRl9DVFJMX1ZRKSkKPiAgICAgICAgICAgICAgICAgZXJyID0gdnJpbmdoX2luaXRfaW90
bGIoJmN2cS0+dnJpbmcsIG12ZGV2LT5hY3R1YWxfZmVhdHVyZXMsCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIE1MWDVfQ1ZRX01BWF9FTlQsIGZhbHNlLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNTFg1X0NWUV9NQVhfRU5ULCBmYWxz
ZSwgZmFsc2UsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzdHJ1
Y3QgdnJpbmdfZGVzYyAqKSh1aW50cHRyX3QpY3ZxLT5kZXNjX2FkZHIsCj4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzdHJ1Y3QgdnJpbmdfYXZhaWwgKikodWludHB0
cl90KWN2cS0+ZHJpdmVyX2FkZHIsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIChzdHJ1Y3QgdnJpbmdfdXNlZCAqKSh1aW50cHRyX3QpY3ZxLT5kZXZpY2VfYWRkcik7
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdmRwYS92ZHBhX3NpbS92ZHBhX3NpbS5jIGIvZHJpdmVy
cy92ZHBhL3ZkcGFfc2ltL3ZkcGFfc2ltLmMKPiBpbmRleCA2YTBhNjU4MTQ2MjYuLjQ4MWViMTU2
NjU4YiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL3ZkcGEvdmRwYV9zaW0vdmRwYV9zaW0uYwo+ICsr
KyBiL2RyaXZlcnMvdmRwYS92ZHBhX3NpbS92ZHBhX3NpbS5jCj4gQEAgLTYwLDcgKzYwLDcgQEAg
c3RhdGljIHZvaWQgdmRwYXNpbV9xdWV1ZV9yZWFkeShzdHJ1Y3QgdmRwYXNpbSAqdmRwYXNpbSwg
dW5zaWduZWQgaW50IGlkeCkKPiAgICAgICAgIHN0cnVjdCB2ZHBhc2ltX3ZpcnRxdWV1ZSAqdnEg
PSAmdmRwYXNpbS0+dnFzW2lkeF07Cj4gICAgICAgICB1aW50MTZfdCBsYXN0X2F2YWlsX2lkeCA9
IHZxLT52cmluZy5sYXN0X2F2YWlsX2lkeDsKPgo+IC0gICAgICAgdnJpbmdoX2luaXRfaW90bGIo
JnZxLT52cmluZywgdmRwYXNpbS0+ZmVhdHVyZXMsIHZxLT5udW0sIHRydWUsCj4gKyAgICAgICB2
cmluZ2hfaW5pdF9pb3RsYigmdnEtPnZyaW5nLCB2ZHBhc2ltLT5mZWF0dXJlcywgdnEtPm51bSwg
dHJ1ZSwgZmFsc2UsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAoc3RydWN0IHZyaW5nX2Rl
c2MgKikodWludHB0cl90KXZxLT5kZXNjX2FkZHIsCj4gICAgICAgICAgICAgICAgICAgICAgICAg
ICAoc3RydWN0IHZyaW5nX2F2YWlsICopCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAodWlu
dHB0cl90KXZxLT5kcml2ZXJfYWRkciwKPiBAQCAtODEsNyArODEsNyBAQCBzdGF0aWMgdm9pZCB2
ZHBhc2ltX3ZxX3Jlc2V0KHN0cnVjdCB2ZHBhc2ltICp2ZHBhc2ltLAo+ICAgICAgICAgdnEtPmNi
ID0gTlVMTDsKPiAgICAgICAgIHZxLT5wcml2YXRlID0gTlVMTDsKPiAgICAgICAgIHZyaW5naF9p
bml0X2lvdGxiKCZ2cS0+dnJpbmcsIHZkcGFzaW0tPmRldl9hdHRyLnN1cHBvcnRlZF9mZWF0dXJl
cywKPiAtICAgICAgICAgICAgICAgICAgICAgICAgIFZEUEFTSU1fUVVFVUVfTUFYLCBmYWxzZSwg
TlVMTCwgTlVMTCwgTlVMTCk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICBWRFBBU0lNX1FV
RVVFX01BWCwgZmFsc2UsIGZhbHNlLCBOVUxMLCBOVUxMLCBOVUxMKTsKPgo+ICAgICAgICAgdnEt
PnZyaW5nLm5vdGlmeSA9IE5VTEw7Cj4gIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy92aG9zdC92
cmluZ2guYyBiL2RyaXZlcnMvdmhvc3QvdnJpbmdoLmMKPiBpbmRleCAwYmEzZWY4MDllNDguLjYx
Yzc5Y2VhNDRjYSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL3Zob3N0L3ZyaW5naC5jCj4gKysrIGIv
ZHJpdmVycy92aG9zdC92cmluZ2guYwo+IEBAIC0xMDk0LDE1ICsxMDk0LDk5IEBAIEVYUE9SVF9T
WU1CT0wodnJpbmdoX25lZWRfbm90aWZ5X2tlcm4pOwo+Cj4gICNpZiBJU19SRUFDSEFCTEUoQ09O
RklHX1ZIT1NUX0lPVExCKQo+Cj4gLXN0YXRpYyBpbnQgaW90bGJfdHJhbnNsYXRlKGNvbnN0IHN0
cnVjdCB2cmluZ2ggKnZyaCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICB1NjQgYWRkciwg
dTY0IGxlbiwgdTY0ICp0cmFuc2xhdGVkLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCBiaW9fdmVjIGlvdltdLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgIGludCBpb3Zf
c2l6ZSwgdTMyIHBlcm0pCj4gK3N0YXRpYyBpbnQgaW90bGJfdHJhbnNsYXRlX3ZhKGNvbnN0IHN0
cnVjdCB2cmluZ2ggKnZyaCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1NjQgYWRk
ciwgdTY0IGxlbiwgdTY0ICp0cmFuc2xhdGVkLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHN0cnVjdCBpb3ZlYyBpb3ZbXSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
bnQgaW92X3NpemUsIHUzMiBwZXJtKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3Qgdmhvc3RfaW90bGJf
bWFwICptYXA7Cj4gICAgICAgICBzdHJ1Y3Qgdmhvc3RfaW90bGIgKmlvdGxiID0gdnJoLT5pb3Rs
YjsKPiArICAgICAgIHU2NCBzID0gMCwgbGFzdCA9IGFkZHIgKyBsZW4gLSAxOwo+ICAgICAgICAg
aW50IHJldCA9IDA7Cj4gKwo+ICsgICAgICAgc3Bpbl9sb2NrKHZyaC0+aW90bGJfbG9jayk7Cj4g
Kwo+ICsgICAgICAgd2hpbGUgKGxlbiA+IHMpIHsKPiArICAgICAgICAgICAgICAgdTY0IHNpemU7
Cj4gKwo+ICsgICAgICAgICAgICAgICBpZiAodW5saWtlbHkocmV0ID49IGlvdl9zaXplKSkgewo+
ICsgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IC1FTk9CVUZTOwo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgICAgICAgICB9Cj4gKwo+ICsgICAgICAgICAgICAg
ICBtYXAgPSB2aG9zdF9pb3RsYl9pdHJlZV9maXJzdChpb3RsYiwgYWRkciwgbGFzdCk7Cj4gKyAg
ICAgICAgICAgICAgIGlmICghbWFwIHx8IG1hcC0+c3RhcnQgPiBhZGRyKSB7Cj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgcmV0ID0gLUVJTlZBTDsKPiArICAgICAgICAgICAgICAgICAgICAgICBi
cmVhazsKPiArICAgICAgICAgICAgICAgfSBlbHNlIGlmICghKG1hcC0+cGVybSAmIHBlcm0pKSB7
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gLUVQRVJNOwo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgICAgICAgICB9Cj4gKwo+ICsgICAgICAgICAgICAg
ICBzaXplID0gbWFwLT5zaXplIC0gYWRkciArIG1hcC0+c3RhcnQ7Cj4gKyAgICAgICAgICAgICAg
IGlvdltyZXRdLmlvdl9sZW4gPSBtaW4obGVuIC0gcywgc2l6ZSk7Cj4gKyAgICAgICAgICAgICAg
IGlvdltyZXRdLmlvdl9iYXNlID0gKHZvaWQgX191c2VyICopKHVuc2lnbmVkIGxvbmcpCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG1hcC0+YWRkciArIGFkZHIgLSBtYXAt
PnN0YXJ0KTsKPiArICAgICAgICAgICAgICAgcyArPSBzaXplOwo+ICsgICAgICAgICAgICAgICBh
ZGRyICs9IHNpemU7Cj4gKyAgICAgICAgICAgICAgICsrcmV0Owo+ICsgICAgICAgfQo+ICsKPiAr
ICAgICAgIHNwaW5fdW5sb2NrKHZyaC0+aW90bGJfbG9jayk7Cj4gKwo+ICsgICAgICAgaWYgKHRy
YW5zbGF0ZWQpCj4gKyAgICAgICAgICAgICAgICp0cmFuc2xhdGVkID0gbWluKGxlbiwgcyk7Cj4g
Kwo+ICsgICAgICAgcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3RhdGljIGlubGluZSBpbnQgY29w
eV9mcm9tX3ZhKGNvbnN0IHN0cnVjdCB2cmluZ2ggKnZyaCwgdm9pZCAqZHN0LCB2b2lkICpzcmMs
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHU2NCBsZW4sIHU2NCAqdHJhbnNsYXRl
ZCkKPiArewo+ICsgICAgICAgc3RydWN0IGlvdmVjIGlvdlsxNl07Cj4gKyAgICAgICBzdHJ1Y3Qg
aW92X2l0ZXIgaXRlcjsKPiArICAgICAgIGludCByZXQ7Cj4gKwo+ICsgICAgICAgcmV0ID0gaW90
bGJfdHJhbnNsYXRlX3ZhKHZyaCwgKHU2NCkodWludHB0cl90KXNyYywgbGVuLCB0cmFuc2xhdGVk
LCBpb3YsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQVJSQVlfU0laRShpb3Yp
LCBWSE9TVF9NQVBfUk8pOwo+ICsgICAgICAgaWYgKHJldCA9PSAtRU5PQlVGUykKPiArICAgICAg
ICAgICAgICAgcmV0ID0gQVJSQVlfU0laRShpb3YpOwo+ICsgICAgICAgZWxzZSBpZiAocmV0IDwg
MCkKPiArICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPiArCj4gKyAgICAgICBpb3ZfaXRlcl9p
bml0KCZpdGVyLCBJVEVSX1NPVVJDRSwgaW92LCByZXQsICp0cmFuc2xhdGVkKTsKPiArCj4gKyAg
ICAgICByZXR1cm4gY29weV9mcm9tX2l0ZXIoZHN0LCAqdHJhbnNsYXRlZCwgJml0ZXIpOwo+ICt9
Cj4gKwo+ICtzdGF0aWMgaW5saW5lIGludCBjb3B5X3RvX3ZhKGNvbnN0IHN0cnVjdCB2cmluZ2gg
KnZyaCwgdm9pZCAqZHN0LCB2b2lkICpzcmMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB1NjQgbGVuLCB1NjQgKnRyYW5zbGF0ZWQpCj4gK3sKPiArICAgICAgIHN0cnVjdCBpb3ZlYyBp
b3ZbMTZdOwo+ICsgICAgICAgc3RydWN0IGlvdl9pdGVyIGl0ZXI7Cj4gKyAgICAgICBpbnQgcmV0
Owo+ICsKPiArICAgICAgIHJldCA9IGlvdGxiX3RyYW5zbGF0ZV92YSh2cmgsICh1NjQpKHVpbnRw
dHJfdClkc3QsIGxlbiwgdHJhbnNsYXRlZCwgaW92LAo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIEFSUkFZX1NJWkUoaW92KSwgVkhPU1RfTUFQX1dPKTsKPiArICAgICAgIGlmIChy
ZXQgPT0gLUVOT0JVRlMpCj4gKyAgICAgICAgICAgICAgIHJldCA9IEFSUkFZX1NJWkUoaW92KTsK
PiArICAgICAgIGVsc2UgaWYgKHJldCA8IDApCj4gKyAgICAgICAgICAgICAgIHJldHVybiByZXQ7
Cj4gKwo+ICsgICAgICAgaW92X2l0ZXJfaW5pdCgmaXRlciwgSVRFUl9ERVNULCBpb3YsIHJldCwg
KnRyYW5zbGF0ZWQpOwo+ICsKPiArICAgICAgIHJldHVybiBjb3B5X3RvX2l0ZXIoc3JjLCAqdHJh
bnNsYXRlZCwgJml0ZXIpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGlvdGxiX3RyYW5zbGF0ZV9w
YShjb25zdCBzdHJ1Y3QgdnJpbmdoICp2cmgsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdTY0IGFkZHIsIHU2NCBsZW4sIHU2NCAqdHJhbnNsYXRlZCwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdHJ1Y3QgYmlvX3ZlYyBpb3ZbXSwKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpbnQgaW92X3NpemUsIHUzMiBwZXJtKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3Qg
dmhvc3RfaW90bGJfbWFwICptYXA7Cj4gKyAgICAgICBzdHJ1Y3Qgdmhvc3RfaW90bGIgKmlvdGxi
ID0gdnJoLT5pb3RsYjsKPiAgICAgICAgIHU2NCBzID0gMCwgbGFzdCA9IGFkZHIgKyBsZW4gLSAx
Owo+ICsgICAgICAgaW50IHJldCA9IDA7Cj4KPiAgICAgICAgIHNwaW5fbG9jayh2cmgtPmlvdGxi
X2xvY2spOwo+Cj4gQEAgLTExNDEsMjggKzEyMjUsNjEgQEAgc3RhdGljIGludCBpb3RsYl90cmFu
c2xhdGUoY29uc3Qgc3RydWN0IHZyaW5naCAqdnJoLAo+ICAgICAgICAgcmV0dXJuIHJldDsKPiAg
fQo+Cj4gK3N0YXRpYyBpbmxpbmUgaW50IGNvcHlfZnJvbV9wYShjb25zdCBzdHJ1Y3QgdnJpbmdo
ICp2cmgsIHZvaWQgKmRzdCwgdm9pZCAqc3JjLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1NjQgbGVuLCB1NjQgKnRyYW5zbGF0ZWQpCj4gK3sKPiArICAgICAgIHN0cnVjdCBiaW9f
dmVjIGlvdlsxNl07Cj4gKyAgICAgICBzdHJ1Y3QgaW92X2l0ZXIgaXRlcjsKPiArICAgICAgIGlu
dCByZXQ7Cj4gKwo+ICsgICAgICAgcmV0ID0gaW90bGJfdHJhbnNsYXRlX3BhKHZyaCwgKHU2NCko
dWludHB0cl90KXNyYywgbGVuLCB0cmFuc2xhdGVkLCBpb3YsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgQVJSQVlfU0laRShpb3YpLCBWSE9TVF9NQVBfUk8pOwo+ICsgICAgICAg
aWYgKHJldCA9PSAtRU5PQlVGUykKPiArICAgICAgICAgICAgICAgcmV0ID0gQVJSQVlfU0laRShp
b3YpOwo+ICsgICAgICAgZWxzZSBpZiAocmV0IDwgMCkKPiArICAgICAgICAgICAgICAgcmV0dXJu
IHJldDsKPiArCj4gKyAgICAgICBpb3ZfaXRlcl9idmVjKCZpdGVyLCBJVEVSX1NPVVJDRSwgaW92
LCByZXQsICp0cmFuc2xhdGVkKTsKPiArCj4gKyAgICAgICByZXR1cm4gY29weV9mcm9tX2l0ZXIo
ZHN0LCAqdHJhbnNsYXRlZCwgJml0ZXIpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW5saW5lIGludCBj
b3B5X3RvX3BhKGNvbnN0IHN0cnVjdCB2cmluZ2ggKnZyaCwgdm9pZCAqZHN0LCB2b2lkICpzcmMs
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICB1NjQgbGVuLCB1NjQgKnRyYW5zbGF0ZWQp
Cj4gK3sKPiArICAgICAgIHN0cnVjdCBiaW9fdmVjIGlvdlsxNl07Cj4gKyAgICAgICBzdHJ1Y3Qg
aW92X2l0ZXIgaXRlcjsKPiArICAgICAgIGludCByZXQ7Cj4gKwo+ICsgICAgICAgcmV0ID0gaW90
bGJfdHJhbnNsYXRlX3BhKHZyaCwgKHU2NCkodWludHB0cl90KWRzdCwgbGVuLCB0cmFuc2xhdGVk
LCBpb3YsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQVJSQVlfU0laRShpb3Yp
LCBWSE9TVF9NQVBfV08pOwo+ICsgICAgICAgaWYgKHJldCA9PSAtRU5PQlVGUykKPiArICAgICAg
ICAgICAgICAgcmV0ID0gQVJSQVlfU0laRShpb3YpOwo+ICsgICAgICAgZWxzZSBpZiAocmV0IDwg
MCkKPiArICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPiArCj4gKyAgICAgICBpb3ZfaXRlcl9i
dmVjKCZpdGVyLCBJVEVSX0RFU1QsIGlvdiwgcmV0LCAqdHJhbnNsYXRlZCk7Cj4gKwo+ICsgICAg
ICAgcmV0dXJuIGNvcHlfdG9faXRlcihzcmMsICp0cmFuc2xhdGVkLCAmaXRlcik7Cj4gK30KPiAr
Cj4gIHN0YXRpYyBpbmxpbmUgaW50IGNvcHlfZnJvbV9pb3RsYihjb25zdCBzdHJ1Y3QgdnJpbmdo
ICp2cmgsIHZvaWQgKmRzdCwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9p
ZCAqc3JjLCBzaXplX3QgbGVuKQo+ICB7Cj4gICAgICAgICB1NjQgdG90YWxfdHJhbnNsYXRlZCA9
IDA7Cj4KPiAgICAgICAgIHdoaWxlICh0b3RhbF90cmFuc2xhdGVkIDwgbGVuKSB7Cj4gLSAgICAg
ICAgICAgICAgIHN0cnVjdCBiaW9fdmVjIGlvdlsxNl07Cj4gLSAgICAgICAgICAgICAgIHN0cnVj
dCBpb3ZfaXRlciBpdGVyOwo+ICAgICAgICAgICAgICAgICB1NjQgdHJhbnNsYXRlZDsKPiAgICAg
ICAgICAgICAgICAgaW50IHJldDsKPgo+IC0gICAgICAgICAgICAgICByZXQgPSBpb3RsYl90cmFu
c2xhdGUodnJoLCAodTY0KSh1aW50cHRyX3Qpc3JjLAo+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbGVuIC0gdG90YWxfdHJhbnNsYXRlZCwgJnRyYW5zbGF0ZWQsCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpb3YsIEFSUkFZX1NJWkUoaW92KSwg
VkhPU1RfTUFQX1JPKTsKPiAtICAgICAgICAgICAgICAgaWYgKHJldCA9PSAtRU5PQlVGUykKPiAt
ICAgICAgICAgICAgICAgICAgICAgICByZXQgPSBBUlJBWV9TSVpFKGlvdik7Cj4gLSAgICAgICAg
ICAgICAgIGVsc2UgaWYgKHJldCA8IDApCj4gLSAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu
IHJldDsKPiAtCj4gLSAgICAgICAgICAgICAgIGlvdl9pdGVyX2J2ZWMoJml0ZXIsIElURVJfU09V
UkNFLCBpb3YsIHJldCwgdHJhbnNsYXRlZCk7Cj4gKyAgICAgICAgICAgICAgIGlmICh2cmgtPnVz
ZV92YSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IGNvcHlfZnJvbV92YSh2cmgs
IGRzdCwgc3JjLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBs
ZW4gLSB0b3RhbF90cmFuc2xhdGVkLCAmdHJhbnNsYXRlZCk7Cj4gKyAgICAgICAgICAgICAgIH0g
ZWxzZSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gY29weV9mcm9tX3BhKHZyaCwg
ZHN0LCBzcmMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxl
biAtIHRvdGFsX3RyYW5zbGF0ZWQsICZ0cmFuc2xhdGVkKTsKPiArICAgICAgICAgICAgICAgfQo+
Cj4gLSAgICAgICAgICAgICAgIHJldCA9IGNvcHlfZnJvbV9pdGVyKGRzdCwgdHJhbnNsYXRlZCwg
Jml0ZXIpOwo+ICAgICAgICAgICAgICAgICBpZiAocmV0IDwgMCkKPiAgICAgICAgICAgICAgICAg
ICAgICAgICByZXR1cm4gcmV0Owo+Cj4gQEAgLTExODAsMjIgKzEyOTcsMTcgQEAgc3RhdGljIGlu
bGluZSBpbnQgY29weV90b19pb3RsYihjb25zdCBzdHJ1Y3QgdnJpbmdoICp2cmgsIHZvaWQgKmRz
dCwKPiAgICAgICAgIHU2NCB0b3RhbF90cmFuc2xhdGVkID0gMDsKPgo+ICAgICAgICAgd2hpbGUg
KHRvdGFsX3RyYW5zbGF0ZWQgPCBsZW4pIHsKPiAtICAgICAgICAgICAgICAgc3RydWN0IGJpb192
ZWMgaW92WzE2XTsKPiAtICAgICAgICAgICAgICAgc3RydWN0IGlvdl9pdGVyIGl0ZXI7Cj4gICAg
ICAgICAgICAgICAgIHU2NCB0cmFuc2xhdGVkOwo+ICAgICAgICAgICAgICAgICBpbnQgcmV0Owo+
Cj4gLSAgICAgICAgICAgICAgIHJldCA9IGlvdGxiX3RyYW5zbGF0ZSh2cmgsICh1NjQpKHVpbnRw
dHJfdClkc3QsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZW4gLSB0
b3RhbF90cmFuc2xhdGVkLCAmdHJhbnNsYXRlZCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGlvdiwgQVJSQVlfU0laRShpb3YpLCBWSE9TVF9NQVBfV08pOwo+IC0gICAg
ICAgICAgICAgICBpZiAocmV0ID09IC1FTk9CVUZTKQo+IC0gICAgICAgICAgICAgICAgICAgICAg
IHJldCA9IEFSUkFZX1NJWkUoaW92KTsKPiAtICAgICAgICAgICAgICAgZWxzZSBpZiAocmV0IDwg
MCkKPiAtICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+IC0KPiAtICAgICAgICAg
ICAgICAgaW92X2l0ZXJfYnZlYygmaXRlciwgSVRFUl9ERVNULCBpb3YsIHJldCwgdHJhbnNsYXRl
ZCk7Cj4gKyAgICAgICAgICAgICAgIGlmICh2cmgtPnVzZV92YSkgewo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIHJldCA9IGNvcHlfdG9fdmEodnJoLCBkc3QsIHNyYywKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbiAtIHRvdGFsX3RyYW5zbGF0ZWQsICZ0cmFu
c2xhdGVkKTsKPiArICAgICAgICAgICAgICAgfSBlbHNlIHsKPiArICAgICAgICAgICAgICAgICAg
ICAgICByZXQgPSBjb3B5X3RvX3BhKHZyaCwgZHN0LCBzcmMsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBsZW4gLSB0b3RhbF90cmFuc2xhdGVkLCAmdHJhbnNsYXRl
ZCk7Cj4gKyAgICAgICAgICAgICAgIH0KPgo+IC0gICAgICAgICAgICAgICByZXQgPSBjb3B5X3Rv
X2l0ZXIoc3JjLCB0cmFuc2xhdGVkLCAmaXRlcik7Cj4gICAgICAgICAgICAgICAgIGlmIChyZXQg
PCAwKQo+ICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4KPiBAQCAtMTIxMCwy
MCArMTMyMiwzNyBAQCBzdGF0aWMgaW5saW5lIGludCBjb3B5X3RvX2lvdGxiKGNvbnN0IHN0cnVj
dCB2cmluZ2ggKnZyaCwgdm9pZCAqZHN0LAo+ICBzdGF0aWMgaW5saW5lIGludCBnZXR1MTZfaW90
bGIoY29uc3Qgc3RydWN0IHZyaW5naCAqdnJoLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1MTYgKnZhbCwgY29uc3QgX192aXJ0aW8xNiAqcCkKPiAgewo+IC0gICAgICAgc3RydWN0
IGJpb192ZWMgaW92Owo+IC0gICAgICAgdm9pZCAqa2FkZHIsICpmcm9tOwo+ICAgICAgICAgaW50
IHJldDsKPgo+ICAgICAgICAgLyogQXRvbWljIHJlYWQgaXMgbmVlZGVkIGZvciBnZXR1MTYgKi8K
PiAtICAgICAgIHJldCA9IGlvdGxiX3RyYW5zbGF0ZSh2cmgsICh1NjQpKHVpbnRwdHJfdClwLCBz
aXplb2YoKnApLCBOVUxMLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICZpb3YsIDEs
IFZIT1NUX01BUF9STyk7Cj4gLSAgICAgICBpZiAocmV0IDwgMCkKPiAtICAgICAgICAgICAgICAg
cmV0dXJuIHJldDsKPiArICAgICAgIGlmICh2cmgtPnVzZV92YSkgewo+ICsgICAgICAgICAgICAg
ICBzdHJ1Y3QgaW92ZWMgaW92Owo+ICsgICAgICAgICAgICAgICBfX3ZpcnRpbzE2IHRtcDsKPiAr
Cj4gKyAgICAgICAgICAgICAgIHJldCA9IGlvdGxiX3RyYW5zbGF0ZV92YSh2cmgsICh1NjQpKHVp
bnRwdHJfdClwLCBzaXplb2YoKnApLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgTlVMTCwgJmlvdiwgMSwgVkhPU1RfTUFQX1JPKTsKPiArICAgICAgICAgICAgICAg
aWYgKHJldCA8IDApCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKCk5pdDog
c2luY2Ugd2UgaGF2ZSBjb3B5X3RvX3ZhL2NvcHlfdG9fcGEgdmFyaWFudHMsIGxldCdzIGludHJv
ZHVjZQpnZXR1MTZfaW90bGJfdmEvcGEgdmFyaWFudHM/Cgo+Cj4gLSAgICAgICBrYWRkciA9IGtt
YXBfbG9jYWxfcGFnZShpb3YuYnZfcGFnZSk7Cj4gLSAgICAgICBmcm9tID0ga2FkZHIgKyBpb3Yu
YnZfb2Zmc2V0Owo+IC0gICAgICAgKnZhbCA9IHZyaW5naDE2X3RvX2NwdSh2cmgsIFJFQURfT05D
RSgqKF9fdmlydGlvMTYgKilmcm9tKSk7Cj4gLSAgICAgICBrdW5tYXBfbG9jYWwoa2FkZHIpOwo+
ICsgICAgICAgICAgICAgICByZXQgPSBfX2dldF91c2VyKHRtcCwgKF9fdmlydGlvMTYgX191c2Vy
ICopaW92Lmlvdl9iYXNlKTsKPiArICAgICAgICAgICAgICAgaWYgKHJldCkKPiArICAgICAgICAg
ICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+ICsKPiArICAgICAgICAgICAgICAgKnZhbCA9IHZy
aW5naDE2X3RvX2NwdSh2cmgsIHRtcCk7Cj4gKyAgICAgICB9IGVsc2Ugewo+ICsgICAgICAgICAg
ICAgICBzdHJ1Y3QgYmlvX3ZlYyBpb3Y7Cj4gKyAgICAgICAgICAgICAgIHZvaWQgKmthZGRyLCAq
ZnJvbTsKPiArCj4gKyAgICAgICAgICAgICAgIHJldCA9IGlvdGxiX3RyYW5zbGF0ZV9wYSh2cmgs
ICh1NjQpKHVpbnRwdHJfdClwLCBzaXplb2YoKnApLAo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgTlVMTCwgJmlvdiwgMSwgVkhPU1RfTUFQX1JPKTsKPiArICAgICAg
ICAgICAgICAgaWYgKHJldCA8IDApCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJl
dDsKPiArCj4gKyAgICAgICAgICAgICAgIGthZGRyID0ga21hcF9sb2NhbF9wYWdlKGlvdi5idl9w
YWdlKTsKCklmIHdlIGRlY2lkZSB0byBoYXZlIGEgdXNlX3ZhIHN3aXRjaCwgaXMga21hcF9sb2Nh
bF9wYWdlKCkgc3RpbGwgcmVxdWlyZWQgaGVyZT8KCk90aGVyIGxvb2tzIGdvb2QuCgpUaGFua3MK
Cj4gKyAgICAgICAgICAgICAgIGZyb20gPSBrYWRkciArIGlvdi5idl9vZmZzZXQ7Cj4gKyAgICAg
ICAgICAgICAgICp2YWwgPSB2cmluZ2gxNl90b19jcHUodnJoLCBSRUFEX09OQ0UoKihfX3ZpcnRp
bzE2ICopZnJvbSkpOwo+ICsgICAgICAgICAgICAgICBrdW5tYXBfbG9jYWwoa2FkZHIpOwo+ICsg
ICAgICAgfQo+Cj4gICAgICAgICByZXR1cm4gMDsKPiAgfQo+IEBAIC0xMjMxLDIwICsxMzYwLDM3
IEBAIHN0YXRpYyBpbmxpbmUgaW50IGdldHUxNl9pb3RsYihjb25zdCBzdHJ1Y3QgdnJpbmdoICp2
cmgsCj4gIHN0YXRpYyBpbmxpbmUgaW50IHB1dHUxNl9pb3RsYihjb25zdCBzdHJ1Y3QgdnJpbmdo
ICp2cmgsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fdmlydGlvMTYgKnAsIHUx
NiB2YWwpCj4gIHsKPiAtICAgICAgIHN0cnVjdCBiaW9fdmVjIGlvdjsKPiAtICAgICAgIHZvaWQg
KmthZGRyLCAqdG87Cj4gICAgICAgICBpbnQgcmV0Owo+Cj4gICAgICAgICAvKiBBdG9taWMgd3Jp
dGUgaXMgbmVlZGVkIGZvciBwdXR1MTYgKi8KPiAtICAgICAgIHJldCA9IGlvdGxiX3RyYW5zbGF0
ZSh2cmgsICh1NjQpKHVpbnRwdHJfdClwLCBzaXplb2YoKnApLCBOVUxMLAo+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICZpb3YsIDEsIFZIT1NUX01BUF9XTyk7Cj4gLSAgICAgICBpZiAo
cmV0IDwgMCkKPiAtICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPiArICAgICAgIGlmICh2cmgt
PnVzZV92YSkgewo+ICsgICAgICAgICAgICAgICBzdHJ1Y3QgaW92ZWMgaW92Owo+ICsgICAgICAg
ICAgICAgICBfX3ZpcnRpbzE2IHRtcDsKPgo+IC0gICAgICAga2FkZHIgPSBrbWFwX2xvY2FsX3Bh
Z2UoaW92LmJ2X3BhZ2UpOwo+IC0gICAgICAgdG8gPSBrYWRkciArIGlvdi5idl9vZmZzZXQ7Cj4g
LSAgICAgICBXUklURV9PTkNFKCooX192aXJ0aW8xNiAqKXRvLCBjcHVfdG9fdnJpbmdoMTYodnJo
LCB2YWwpKTsKPiAtICAgICAgIGt1bm1hcF9sb2NhbChrYWRkcik7Cj4gKyAgICAgICAgICAgICAg
IHJldCA9IGlvdGxiX3RyYW5zbGF0ZV92YSh2cmgsICh1NjQpKHVpbnRwdHJfdClwLCBzaXplb2Yo
KnApLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCwgJmlv
diwgMSwgVkhPU1RfTUFQX1JPKTsKPiArICAgICAgICAgICAgICAgaWYgKHJldCA8IDApCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPiArCj4gKyAgICAgICAgICAgICAgIHRt
cCA9IGNwdV90b192cmluZ2gxNih2cmgsIHZhbCk7Cj4gKwo+ICsgICAgICAgICAgICAgICByZXQg
PSBfX3B1dF91c2VyKHRtcCwgKF9fdmlydGlvMTYgX191c2VyICopaW92Lmlvdl9iYXNlKTsKPiAr
ICAgICAgICAgICAgICAgaWYgKHJldCkKPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4g
cmV0Owo+ICsgICAgICAgfSBlbHNlIHsKPiArICAgICAgICAgICAgICAgc3RydWN0IGJpb192ZWMg
aW92Owo+ICsgICAgICAgICAgICAgICB2b2lkICprYWRkciwgKnRvOwo+ICsKPiArICAgICAgICAg
ICAgICAgcmV0ID0gaW90bGJfdHJhbnNsYXRlX3BhKHZyaCwgKHU2NCkodWludHB0cl90KXAsIHNp
emVvZigqcCksIE5VTEwsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAmaW92LCAxLCBWSE9TVF9NQVBfV08pOwo+ICsgICAgICAgICAgICAgICBpZiAocmV0IDwgMCkK
PiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+ICsKPiArICAgICAgICAgICAg
ICAga2FkZHIgPSBrbWFwX2xvY2FsX3BhZ2UoaW92LmJ2X3BhZ2UpOwo+ICsgICAgICAgICAgICAg
ICB0byA9IGthZGRyICsgaW92LmJ2X29mZnNldDsKPiArICAgICAgICAgICAgICAgV1JJVEVfT05D
RSgqKF9fdmlydGlvMTYgKil0bywgY3B1X3RvX3ZyaW5naDE2KHZyaCwgdmFsKSk7Cj4gKyAgICAg
ICAgICAgICAgIGt1bm1hcF9sb2NhbChrYWRkcik7Cj4gKyAgICAgICB9Cj4KPiAgICAgICAgIHJl
dHVybiAwOwo+ICB9Cj4gQEAgLTEzMDYsNiArMTQ1Miw3IEBAIHN0YXRpYyBpbmxpbmUgaW50IHB1
dHVzZWRfaW90bGIoY29uc3Qgc3RydWN0IHZyaW5naCAqdnJoLAo+ICAgKiBAZmVhdHVyZXM6IHRo
ZSBmZWF0dXJlIGJpdHMgZm9yIHRoaXMgcmluZy4KPiAgICogQG51bTogdGhlIG51bWJlciBvZiBl
bGVtZW50cy4KPiAgICogQHdlYWtfYmFycmllcnM6IHRydWUgaWYgd2Ugb25seSBuZWVkIG1lbW9y
eSBiYXJyaWVycywgbm90IEkvTy4KPiArICogQHVzZV92YTogdHJ1ZSBpZiBJT1RMQiBjb250YWlu
cyB1c2VyIFZBCj4gICAqIEBkZXNjOiB0aGUgdXNlcnBhY2UgZGVzY3JpcHRvciBwb2ludGVyLgo+
ICAgKiBAYXZhaWw6IHRoZSB1c2VycGFjZSBhdmFpbCBwb2ludGVyLgo+ICAgKiBAdXNlZDogdGhl
IHVzZXJwYWNlIHVzZWQgcG9pbnRlci4KPiBAQCAtMTMxMywxMSArMTQ2MCwxMyBAQCBzdGF0aWMg
aW5saW5lIGludCBwdXR1c2VkX2lvdGxiKGNvbnN0IHN0cnVjdCB2cmluZ2ggKnZyaCwKPiAgICog
UmV0dXJucyBhbiBlcnJvciBpZiBudW0gaXMgaW52YWxpZC4KPiAgICovCj4gIGludCB2cmluZ2hf
aW5pdF9pb3RsYihzdHJ1Y3QgdnJpbmdoICp2cmgsIHU2NCBmZWF0dXJlcywKPiAtICAgICAgICAg
ICAgICAgICAgICAgdW5zaWduZWQgaW50IG51bSwgYm9vbCB3ZWFrX2JhcnJpZXJzLAo+ICsgICAg
ICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgbnVtLCBib29sIHdlYWtfYmFycmllcnMsIGJv
b2wgdXNlX3ZhLAo+ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdnJpbmdfZGVzYyAqZGVz
YywKPiAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHZyaW5nX2F2YWlsICphdmFpbCwKPiAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHZyaW5nX3VzZWQgKnVzZWQpCj4gIHsKPiArICAg
ICAgIHZyaC0+dXNlX3ZhID0gdXNlX3ZhOwo+ICsKPiAgICAgICAgIHJldHVybiB2cmluZ2hfaW5p
dF9rZXJuKHZyaCwgZmVhdHVyZXMsIG51bSwgd2Vha19iYXJyaWVycywKPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGRlc2MsIGF2YWlsLCB1c2VkKTsKPiAgfQo+IC0tCj4gMi4zOS4y
Cj4KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClZpcnR1
YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0cy5saW51eC1mb3VuZGF0
aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcvbWFpbG1hbi9saXN0aW5m
by92aXJ0dWFsaXphdGlvbg==
