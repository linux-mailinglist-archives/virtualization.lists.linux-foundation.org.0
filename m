Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp2.osuosl.org (smtp2.osuosl.org [IPv6:2605:bc80:3010::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 571A87AE3C2
	for <lists.virtualization@lfdr.de>; Tue, 26 Sep 2023 04:47:45 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp2.osuosl.org (Postfix) with ESMTP id 520D94173A;
	Tue, 26 Sep 2023 02:47:43 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 520D94173A
Authentication-Results: smtp2.osuosl.org;
	dkim=fail reason="signature verification failed" (1024-bit key) header.d=redhat.com header.i=@redhat.com header.a=rsa-sha256 header.s=mimecast20190719 header.b=WpGXwEx2
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
	by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id a5Sg_XQtb5Ej; Tue, 26 Sep 2023 02:47:42 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by smtp2.osuosl.org (Postfix) with ESMTPS id C6FD441737;
	Tue, 26 Sep 2023 02:47:41 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org C6FD441737
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 1A405C008C;
	Tue, 26 Sep 2023 02:47:41 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp2.osuosl.org (smtp2.osuosl.org [IPv6:2605:bc80:3010::133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 16761C0032
 for <virtualization@lists.linux-foundation.org>;
 Tue, 26 Sep 2023 02:47:39 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp2.osuosl.org (Postfix) with ESMTP id E5A3A41737
 for <virtualization@lists.linux-foundation.org>;
 Tue, 26 Sep 2023 02:47:38 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org E5A3A41737
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
 by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 5Z4BZWF4GepL
 for <virtualization@lists.linux-foundation.org>;
 Tue, 26 Sep 2023 02:47:38 +0000 (UTC)
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.129.124])
 by smtp2.osuosl.org (Postfix) with ESMTPS id BEA9240328
 for <virtualization@lists.linux-foundation.org>;
 Tue, 26 Sep 2023 02:47:37 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org BEA9240328
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1695696455;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=ztxwBiWjNYtfi79s4jLwwVHnBkUaOUXQf9uizWvEnN8=;
 b=WpGXwEx21oDsFUyKm4X6KTZ1OI23WfnKVW4Z0RQdGzq0so33pXtxNvERNtMo1ETT1Rc08z
 55+o6Eje2AfZb7K4bVBNtQbQUCHOih9gzhtw4HFu1NuyfM955xKyXvaD0H9LzPqIt1Pnrq
 H547megJw1/IuWxKRh3FECN2QVHO66M=
Received: from mail-lf1-f70.google.com (mail-lf1-f70.google.com
 [209.85.167.70]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384) id
 us-mta-353-aaD9w0C6NG68EVxkq-0Zpg-1; Mon, 25 Sep 2023 22:47:32 -0400
X-MC-Unique: aaD9w0C6NG68EVxkq-0Zpg-1
Received: by mail-lf1-f70.google.com with SMTP id
 2adb3069b0e04-50428596a79so6921349e87.0
 for <virtualization@lists.linux-foundation.org>;
 Mon, 25 Sep 2023 19:47:32 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20230601; t=1695696450; x=1696301250;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
 :subject:date:message-id:reply-to;
 bh=ztxwBiWjNYtfi79s4jLwwVHnBkUaOUXQf9uizWvEnN8=;
 b=ItuqFpsJTvkz0GHWe/xtBDK6DaJOD337/28po7+d/t896Xh0v8I/tJQainNvDYnDNO
 vCMUetuBztRLLCKkg8Yaihkj2I5nIHa7VGB31jO8ia38ZVI6VtVPiZybaifbgpZD/THp
 WrZL/nxeydCMifCySbVbSA3lJJscwdbWGygzA4WofhTWLn+rkHJtpPjclXY0oVmyLgid
 XrjM6wpq9QfoYnqaKrMzeSgu3YQ+LknD58cPqbeQfeHEcmdy1TmjfnIWhHcvzJ0+4fWx
 REP20COsO27nzT6VU1WmRPhWbxklS3mp3pWSLOkicwPQfCpHecNb1op78IRH/QQq9kwW
 SNpg==
X-Gm-Message-State: AOJu0YxnKb570fPLoEsucXHugRLh4OtFg4QeW8U/u4Wg74b02tkyyKGF
 QL+4x8hl7Hx8QL9rWP7/Q36AVcZ80kRkzAPfLCKB7yzVLnU75FGhiAeRIBbhkJW5AOpLycnTcBe
 x8guJNb3NAIOfhAnJyOz0Hjvc78S8qBb/oMyXQ1GI2/pi9LI9slUYrtKlaQ==
X-Received: by 2002:a05:6512:39d6:b0:501:ba04:f352 with SMTP id
 k22-20020a05651239d600b00501ba04f352mr487402lfu.1.1695696450318; 
 Mon, 25 Sep 2023 19:47:30 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IH6CBnbXdSxs5iiUHc9AWqZr29LCRBHXUdN1dRWPuxmiiGV9XdjBZfsAAUTJRVIU06fUsZpKVpseSRShGAY5BU=
X-Received: by 2002:a05:6512:39d6:b0:501:ba04:f352 with SMTP id
 k22-20020a05651239d600b00501ba04f352mr487392lfu.1.1695696449930; Mon, 25 Sep
 2023 19:47:29 -0700 (PDT)
MIME-Version: 1.0
References: <20230923170540.1447301-1-lulu@redhat.com>
 <20230923170540.1447301-4-lulu@redhat.com>
In-Reply-To: <20230923170540.1447301-4-lulu@redhat.com>
From: Jason Wang <jasowang@redhat.com>
Date: Tue, 26 Sep 2023 10:47:19 +0800
Message-ID: <CACGkMEt4zsQdZXUTa2Yv+D2udyHan9h3OkK8mDJR2sjtSSROGQ@mail.gmail.com>
Subject: Re: [RFC 3/7] vhost: Add 3 new uapi to support iommufd
To: Cindy Lu <lulu@redhat.com>
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Cc: yi.l.liu@intel.com, mst@redhat.com, netdev@vger.kernel.org,
 linux-kernel@vger.kernel.org, virtualization@lists.linux-foundation.org,
 jgg@nvidia.com
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gU3VuLCBTZXAgMjQsIDIwMjMgYXQgMTowNeKAr0FNIENpbmR5IEx1IDxsdWx1QHJlZGhhdC5j
b20+IHdyb3RlOgo+Cj4gVkhPU1RfVkRQQV9TRVRfSU9NTVVfRkQ6IGJpbmQgdGhlIGRldmljZSB0
byBpb21tdWZkIGRldmljZQo+Cj4gVkRQQV9ERVZJQ0VfQVRUQUNIX0lPTU1VRkRfQVM6IEF0dGFj
aCBhIHZkcGEgZGV2aWNlIHRvIGFuIGlvbW11ZmQKPiBhZGRyZXNzIHNwYWNlIHNwZWNpZmllZCBi
eSBJT0FTIGlkLgo+Cj4gVkRQQV9ERVZJQ0VfREVUQUNIX0lPTU1VRkRfQVM6IERldGFjaCBhIHZk
cGEgZGV2aWNlCj4gZnJvbSB0aGUgaW9tbXVmZCBhZGRyZXNzIHNwYWNlCj4KPiBTaWduZWQtb2Zm
LWJ5OiBDaW5keSBMdSA8bHVsdUByZWRoYXQuY29tPgo+IC0tLQo+ICBkcml2ZXJzL3Zob3N0L3Zk
cGEuYyAgICAgICB8IDE5MSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCj4g
IGluY2x1ZGUvdWFwaS9saW51eC92aG9zdC5oIHwgIDcxICsrKysrKysrKysrKysrCj4gIDIgZmls
ZXMgY2hhbmdlZCwgMjYyIGluc2VydGlvbnMoKykKPgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3Zo
b3N0L3ZkcGEuYyBiL2RyaXZlcnMvdmhvc3QvdmRwYS5jCj4gaW5kZXggZWMzMmY3ODVkZmRlLi45
MWRhMDEyMDg0ZTkgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy92aG9zdC92ZHBhLmMKPiArKysgYi9k
cml2ZXJzL3Zob3N0L3ZkcGEuYwo+IEBAIC0xOCw2ICsxOCw3IEBACj4gICNpbmNsdWRlIDxsaW51
eC9tbS5oPgo+ICAjaW5jbHVkZSA8bGludXgvc2xhYi5oPgo+ICAjaW5jbHVkZSA8bGludXgvaW9t
bXUuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2lvbW11ZmQuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3V1
aWQuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3ZkcGEuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L25vc3Bl
Yy5oPgo+IEBAIC0yNSw2ICsyNiw4IEBACj4KPiAgI2luY2x1ZGUgInZob3N0LmgiCj4KPiArTU9E
VUxFX0lNUE9SVF9OUyhJT01NVUZEKTsKPiArCj4gIGVudW0gewo+ICAgICAgICAgVkhPU1RfVkRQ
QV9CQUNLRU5EX0ZFQVRVUkVTID0KPiAgICAgICAgICgxVUxMIDw8IFZIT1NUX0JBQ0tFTkRfRl9J
T1RMQl9NU0dfVjIpIHwKPiBAQCAtNjksNiArNzIsMTUgQEAgc3RhdGljIHZvaWQgdmhvc3RfdmRw
YV9pb3RsYl91bm1hcChzdHJ1Y3Qgdmhvc3RfdmRwYSAqdiwKPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCB2aG9zdF9pb3RsYiAqaW90bGIsIHU2NCBzdGFydCwKPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHU2NCBsYXN0LCB1MzIgYXNpZCk7Cj4K
PiArdm9pZCB2aG9zdF92ZHBhX2xvY2tkZXBfYXNzZXJ0X2hlbGQoc3RydWN0IHZkcGFfZGV2aWNl
ICp2ZHBhKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3Qgdmhvc3RfdmRwYSAqdiA9IHZkcGFfZ2V0X2Ry
dmRhdGEodmRwYSk7Cj4gKwo+ICsgICAgICAgaWYgKFdBUk5fT04oIXYpKQo+ICsgICAgICAgICAg
ICAgICByZXR1cm47Cj4gKyAgICAgICBsb2NrZGVwX2Fzc2VydF9oZWxkKCZ2LT52ZGV2Lm11dGV4
KTsKPiArfQo+ICsKPiAgc3RhdGljIGlubGluZSB1MzIgaW90bGJfdG9fYXNpZChzdHJ1Y3Qgdmhv
c3RfaW90bGIgKmlvdGxiKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3Qgdmhvc3RfdmRwYV9hcyAqYXMg
PSBjb250YWluZXJfb2YoaW90bGIsIHN0cnVjdAo+IEBAIC00OTcsNiArNTA5LDE3MyBAQCBzdGF0
aWMgbG9uZyB2aG9zdF92ZHBhX3N1c3BlbmQoc3RydWN0IHZob3N0X3ZkcGEgKnYpCj4KPiAgICAg
ICAgIHJldHVybiBvcHMtPnN1c3BlbmQodmRwYSk7Cj4gIH0KPiArc3RhdGljIGxvbmcgdmhvc3Rf
dmRwYV90bXBfc2V0X2lvbW11ZmQoc3RydWN0IHZob3N0X3ZkcGEgKnYsIHZvaWQgX191c2VyICph
cmdwKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZGV2aWNlICpkbWFfZGV2ID0gdmRwYV9nZXRfZG1h
X2Rldih2LT52ZHBhKTsKPiArICAgICAgIHN0cnVjdCB2aG9zdF92ZHBhX3NldF9pb21tdWZkIHNl
dF9pb21tdWZkOwo+ICsgICAgICAgc3RydWN0IHZkcGFfZGV2aWNlICp2ZHBhID0gdi0+dmRwYTsK
PiArICAgICAgIHN0cnVjdCBpb21tdWZkX2N0eCAqaWN0eDsKPiArICAgICAgIHVuc2lnbmVkIGxv
bmcgbWluc3o7Cj4gKyAgICAgICB1MzIgcHRfaWQsIGRldl9pZDsKPiArICAgICAgIHN0cnVjdCBm
ZCBmOwo+ICsgICAgICAgbG9uZyByID0gMDsKPiArICAgICAgIGludCBpZHg7Cj4gKwo+ICsgICAg
ICAgbWluc3ogPSBvZmZzZXRvZmVuZChzdHJ1Y3Qgdmhvc3RfdmRwYV9zZXRfaW9tbXVmZCwgaW9h
c19pZCk7Cj4gKyAgICAgICBpZiAoY29weV9mcm9tX3VzZXIoJnNldF9pb21tdWZkLCBhcmdwLCBt
aW5zeikpCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUZBVUxUOwo+ICsKPiArICAgICAgIGlm
IChzZXRfaW9tbXVmZC5ncm91cF9pZCA+PSB2LT5udnFzKQo+ICsgICAgICAgICAgICAgICByZXR1
cm4gLUVOT0JVRlM7CgpOZWVkcyB0byBiZSB2LT5uZ3JvdXBzIGJ1dCBhcyByZXBsaWVkIGJlbG93
LCBidXQgSSB0aGluayBpdCBzaG91bGQgYmUgYXNpZC4KCj4gKwo+ICsgICAgICAgaWR4ID0gYXJy
YXlfaW5kZXhfbm9zcGVjKHNldF9pb21tdWZkLmdyb3VwX2lkLCB2LT5udnFzKTsKPiArCj4gKyAg
ICAgICAvKiBVbnNldCBJT01NVUZEICovCj4gKyAgICAgICBpZiAoc2V0X2lvbW11ZmQuaW9tbXVm
ZCA8IDApIHsKPiArICAgICAgICAgICAgICAgaWYgKCF0ZXN0X2JpdChpZHgsIHZkcGEtPnZxX2Jp
dG1hcCkpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gKwo+ICsg
ICAgICAgICAgICAgICBpZiAoIXZkcGEtPmlvbW11ZmRfaWN0eCB8fCAhdmRwYS0+aW9tbXVmZF9k
ZXZpY2UpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gKyAgICAg
ICAgICAgICAgIGlmIChhdG9taWNfcmVhZCgmdmRwYS0+aW9tbXVmZF91c2VycykpIHsKPiArICAg
ICAgICAgICAgICAgICAgICAgICBhdG9taWNfZGVjKCZ2ZHBhLT5pb21tdWZkX3VzZXJzKTsKPiAr
ICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsKPiArICAgICAgICAgICAgICAgfQo+ICsg
ICAgICAgICAgICAgICB2ZHBhX2lvbW11ZmRfdW5iaW5kKHYtPnZkcGEpOwo+ICsgICAgICAgICAg
ICAgICB2ZHBhLT5pb21tdWZkX2RldmljZSA9IE5VTEw7Cj4gKyAgICAgICAgICAgICAgIHZkcGEt
PmlvbW11ZmRfaWN0eCA9IE5VTEw7Cj4gKyAgICAgICAgICAgICAgIGNsZWFyX2JpdChpZHgsIHZk
cGEtPnZxX2JpdG1hcCk7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBpb21tdV9hdHRhY2hfZGV2
aWNlKHYtPmRvbWFpbiwgZG1hX2Rldik7Cj4gKyAgICAgICB9Cj4gKyAgICAgICAvKiBGaXJzdCBv
cGVuZWQgdmlydHF1ZXVlIG9mIHRoaXMgdmRwYSBkZXZpY2UgKi8KPiArCj4gKyAgICAgICBpZiAo
IXZkcGEtPnZxX2JpdG1hcCkgewo+ICsgICAgICAgICAgICAgICB2ZHBhLT52cV9iaXRtYXAgPSBi
aXRtYXBfYWxsb2Modi0+bnZxcywgR0ZQX0tFUk5FTCk7Cj4gKyAgICAgICB9Cj4gKyAgICAgICAv
Ly9pZiAodGVzdF9iaXQoaWR4LCB2ZHBhLT52cV9iaXRtYXApKQo+ICsgICAgICAgLy9yZXR1cm4g
LUVCVVNZOwo+ICsKPiArICAgICAgIC8qIEZvciBzYW1lIGRldmljZSBidXQgZGlmZmVyZW50IGdy
b3VwcywgKytyZWZjb3VudCBvbmx5ICovCj4gKyAgICAgICBpZiAodmRwYS0+aW9tbXVmZF9kZXZp
Y2UpCj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0X2luYzsKPiArCj4gKyAgICAgICByID0gLUVC
QURGOwo+ICsgICAgICAgZiA9IGZkZ2V0KHNldF9pb21tdWZkLmlvbW11ZmQpOwo+ICsgICAgICAg
aWYgKCFmLmZpbGUpCj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0X2JpdG1hcF9mcmVlOwo+ICsK
PiArICAgICAgIHIgPSAtRUlOVkFMOwo+ICsgICAgICAgaWN0eCA9IGlvbW11ZmRfY3R4X2Zyb21f
ZmlsZShmLmZpbGUpOwo+ICsgICAgICAgaWYgKElTX0VSUihpY3R4KSkKPiArICAgICAgICAgICAg
ICAgZ290byBvdXRfZmRwdXQ7Cj4gKwo+ICsgICAgICAgaWYgKHYtPmRvbWFpbikKPiArICAgICAg
ICAgICAgICAgaW9tbXVfZGV0YWNoX2RldmljZSh2LT5kb21haW4sIGRtYV9kZXYpOwo+ICsKPiAr
I2lmIDAKPiArICAgICAgIGlvbW11X2dyb3VwX2FkZF9kZXZpY2UoaW9tbXVfZ3JvdXBfYWxsb2Mo
KSwgJnZkcGEtPmRldik7Cj4gKyNlbmRpZgo+ICsgICAgICAgcHRfaWQgPSBzZXRfaW9tbXVmZC5p
b2FzX2lkOwo+ICsgICAgICAgciA9IHZkcGFfaW9tbXVmZF9iaW5kKHZkcGEsIGljdHgsICZwdF9p
ZCwgJmRldl9pZCk7Cj4gKyAgICAgICBpZiAocikKPiArICAgICAgICAgICAgICAgZ290byBvdXRf
cmVhdHRhY2g7Cj4gKwo+ICsgICAgICAgc2V0X2lvbW11ZmQub3V0X2Rldl9pZCA9IGRldl9pZDsK
PiArICAgICAgIHNldF9pb21tdWZkLm91dF9od3B0X2lkID0gcHRfaWQ7Cj4gKyAgICAgICByID0g
Y29weV90b191c2VyKGFyZ3AgKyBtaW5zeiwgJnNldF9pb21tdWZkLm91dF9kZXZfaWQsCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgIHNpemVvZihzZXRfaW9tbXVmZC5vdXRfZGV2X2lkKSArCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKHNldF9pb21tdWZkLm91dF9o
d3B0X2lkKSkgPwo+ICsgICAgICAgICAgICAgICAgICAgLUVGQVVMVCA6Cj4gKyAgICAgICAgICAg
ICAgICAgICAwOwo+ICsgICAgICAgaWYgKHIpCj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0X2Rl
dmljZV91bmJpbmQ7Cj4gKyAgICAgICBwcmludGsoS0VSTl9FUlIgIlslc10gJWQgY2FsbGVkICVw
XG4iLCBfX2Z1bmNfXywgX19MSU5FX18sCj4gKyAgICAgICAgICAgICAgdmRwYS0+aW9tbXVmZF9p
Y3R4KTsKPiArCj4gKyAgICAgICB2ZHBhLT5pb21tdWZkX2ljdHggPSBpY3R4Owo+ICsKPiArb3V0
X2luYzoKPiArICAgICAgIGF0b21pY19pbmMoJnZkcGEtPmlvbW11ZmRfdXNlcnMpOwo+ICsgICAg
ICAgc2V0X2JpdChpZHgsIHZkcGEtPnZxX2JpdG1hcCk7Cj4gKwo+ICsgICAgICAgZ290byBvdXRf
ZmRwdXQ7Cj4gKwo+ICtvdXRfZGV2aWNlX3VuYmluZDoKPiArCj4gKyAgICAgICB2ZHBhX2lvbW11
ZmRfdW5iaW5kKHZkcGEpOwo+ICtvdXRfcmVhdHRhY2g6Cj4gKwo+ICsgICAgICAgaW9tbXVfYXR0
YWNoX2RldmljZSh2LT5kb21haW4sIGRtYV9kZXYpOwo+ICsgICAgICAgaW9tbXVmZF9jdHhfcHV0
KGljdHgpOwo+ICtvdXRfZmRwdXQ6Cj4gKyAgICAgICBmZHB1dChmKTsKPiArb3V0X2JpdG1hcF9m
cmVlOgo+ICsgICAgICAgYml0bWFwX2ZyZWUodmRwYS0+dnFfYml0bWFwKTsKPiArICAgICAgIHJl
dHVybiByOwo+ICt9Cj4gK2ludCB2ZHBhX2lvY3RsX2RldmljZV9hdHRhY2goc3RydWN0IHZob3N0
X3ZkcGEgKnYsIHZvaWQgX191c2VyICphcmcpCj4gK3sKPiArICAgICAgIHN0cnVjdCB2ZHBhX2Rl
dmljZV9hdHRhY2hfaW9tbXVmZF9hcyBhdHRhY2g7Cj4gKyAgICAgICB1bnNpZ25lZCBsb25nIG1p
bnN6Owo+ICsgICAgICAgaW50IHJldDsKPiArCj4gKyAgICAgICBtaW5zeiA9IG9mZnNldG9mZW5k
KHN0cnVjdCB2ZHBhX2RldmljZV9hdHRhY2hfaW9tbXVmZF9hcywgaW9hc19pZCk7Cj4gKwo+ICsg
ICAgICAgaWYgKGNvcHlfZnJvbV91c2VyKCZhdHRhY2gsICh2b2lkIF9fdXNlciAqKWFyZywgbWlu
c3opKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsKPiArCj4gKyAgICAgICBpZiAo
YXR0YWNoLmFyZ3N6IDwgbWluc3ogfHwgYXR0YWNoLmZsYWdzIHx8Cj4gKyAgICAgICAgICAgYXR0
YWNoLmlvYXNfaWQgPT0gSU9NTVVGRF9JTlZBTElEX0lEKQo+ICsgICAgICAgICAgICAgICByZXR1
cm4gLUVJTlZBTDsKPiArCj4gKyAgICAgICBpZiAoIXYtPnZkcGEtPmNvbmZpZy0+YmluZF9pb21t
dWZkKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVOT0RFVjsKPiArCj4gKyAgICAgICBpZiAo
IXYtPnZkcGEtPmlvbW11ZmRfaWN0eCkgewo+ICsgICAgICAgICAgICAgICByZXQgPSAtRUlOVkFM
Owo+ICsgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+ICsgICAgICAgfQo+ICsKPiArICAgICAg
IHJldCA9IHYtPnZkcGEtPmNvbmZpZy0+YXR0YWNoX2lvYXModi0+dmRwYSwgJmF0dGFjaC5pb2Fz
X2lkKTsKPiArCj4gKyAgICAgICBpZiAocmV0KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gcmV0
Owo+ICsKPiArICAgICAgIHJldCA9IGNvcHlfdG9fdXNlcigKPiArICAgICAgICAgICAgICAgICAg
ICAgKHZvaWQgX191c2VyICopYXJnICsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBv
ZmZzZXRvZmVuZChzdHJ1Y3QgdmRwYV9kZXZpY2VfYXR0YWNoX2lvbW11ZmRfYXMsCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxhZ3MpLAo+ICsgICAgICAgICAg
ICAgICAgICAgICAmYXR0YWNoLmlvYXNfaWQsIHNpemVvZihhdHRhY2guaW9hc19pZCkpID8KPiAr
ICAgICAgICAgICAgICAgICAgICAgLUVGQVVMVCA6Cj4gKyAgICAgICAgICAgICAgICAgICAgIDA7
Cj4gKwo+ICsgICAgICAgaWYgKHJldCkKPiArICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPiAr
Cj4gKyAgICAgICByZXR1cm4gMDsKPiArfQo+ICsKPiAraW50IHZkcGFfaW9jdGxfZGV2aWNlX2Rl
dGFjaChzdHJ1Y3Qgdmhvc3RfdmRwYSAqdiwgdm9pZCBfX3VzZXIgKmFyZykKPiArewo+ICsgICAg
ICAgc3RydWN0IHZkcGFfZGV2aWNlX2RldGFjaF9pb21tdWZkX2FzIGRldGFjaDsKPiArICAgICAg
IHVuc2lnbmVkIGxvbmcgbWluc3o7Cj4gKwo+ICsgICAgICAgbWluc3ogPSBvZmZzZXRvZmVuZChz
dHJ1Y3QgdmRwYV9kZXZpY2VfZGV0YWNoX2lvbW11ZmRfYXMsIGZsYWdzKTsKPiArCj4gKyAgICAg
ICBpZiAoY29weV9mcm9tX3VzZXIoJmRldGFjaCwgKHZvaWQgX191c2VyICopYXJnLCBtaW5zeikp
Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUZBVUxUOwo+ICsKPiArICAgICAgIGlmIChkZXRh
Y2guYXJnc3ogPCBtaW5zeiB8fCBkZXRhY2guZmxhZ3MpCj4gKyAgICAgICAgICAgICAgIHJldHVy
biAtRUlOVkFMOwo+ICsKPiArICAgICAgIGlmICghdi0+dmRwYS0+Y29uZmlnLT5iaW5kX2lvbW11
ZmQpCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PREVWOwo+ICsKPiArICAgICAgIGlmICh2
LT52ZHBhLT5pb21tdWZkX2ljdHgpIHsKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7
Cj4gKyAgICAgICB9Cj4gKyAgICAgICByZXR1cm4gdi0+dmRwYS0+Y29uZmlnLT5kZXRhY2hfaW9h
cyh2LT52ZHBhKTsKPiArfQo+Cj4gIHN0YXRpYyBsb25nIHZob3N0X3ZkcGFfdnJpbmdfaW9jdGwo
c3RydWN0IHZob3N0X3ZkcGEgKnYsIHVuc2lnbmVkIGludCBjbWQsCj4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB2b2lkIF9fdXNlciAqYXJncCkKPiBAQCAtNjU1LDYgKzgzNCwx
OCBAQCBzdGF0aWMgbG9uZyB2aG9zdF92ZHBhX3VubG9ja2VkX2lvY3RsKHN0cnVjdCBmaWxlICpm
aWxlcCwKPiAgICAgICAgIGNhc2UgVkhPU1RfU0VUX0xPR19GRDoKPiAgICAgICAgICAgICAgICAg
ciA9IC1FTk9JT0NUTENNRDsKPiAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICBjYXNl
IFZIT1NUX1ZEUEFfU0VUX0lPTU1VX0ZEOgo+ICsKPiArICAgICAgICAgICAgICAgciA9IHZob3N0
X3ZkcGFfdG1wX3NldF9pb21tdWZkKHYsIGFyZ3ApOwo+ICsgICAgICAgICAgICAgICBicmVhazsK
PiArICAgICAgIGNhc2UgVkRQQV9ERVZJQ0VfQVRUQUNIX0lPTU1VRkRfQVM6Cj4gKyAgICAgICAg
ICAgICAgIHIgPSB2ZHBhX2lvY3RsX2RldmljZV9hdHRhY2godiwgKHZvaWQgX191c2VyICopYXJn
KTsKPiArICAgICAgICAgICAgICAgYnJlYWs7Cj4gKwo+ICsgICAgICAgY2FzZSBWRFBBX0RFVklD
RV9ERVRBQ0hfSU9NTVVGRF9BUzoKPiArICAgICAgICAgICAgICAgciA9IHZkcGFfaW9jdGxfZGV2
aWNlX2RldGFjaCh2LCAodm9pZCBfX3VzZXIgKilhcmcpOwo+ICsgICAgICAgICAgICAgICBicmVh
azsKPiArCj4gICAgICAgICBjYXNlIFZIT1NUX1ZEUEFfU0VUX0NPTkZJR19DQUxMOgo+ICAgICAg
ICAgICAgICAgICByID0gdmhvc3RfdmRwYV9zZXRfY29uZmlnX2NhbGwodiwgYXJncCk7Cj4gICAg
ICAgICAgICAgICAgIGJyZWFrOwo+IGRpZmYgLS1naXQgYS9pbmNsdWRlL3VhcGkvbGludXgvdmhv
c3QuaCBiL2luY2x1ZGUvdWFwaS9saW51eC92aG9zdC5oCj4gaW5kZXggZjlmMTE1YTdjNzViLi5j
ZGRhMGMxODYwZDggMTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS91YXBpL2xpbnV4L3Zob3N0LmgKPiAr
KysgYi9pbmNsdWRlL3VhcGkvbGludXgvdmhvc3QuaAo+IEBAIC00NSw2ICs0NSw3IEBACj4gICNk
ZWZpbmUgVkhPU1RfU0VUX0xPR19CQVNFIF9JT1coVkhPU1RfVklSVElPLCAweDA0LCBfX3U2NCkK
PiAgLyogU3BlY2lmeSBhbiBldmVudGZkIGZpbGUgZGVzY3JpcHRvciB0byBzaWduYWwgb24gbG9n
IHdyaXRlLiAqLwo+ICAjZGVmaW5lIFZIT1NUX1NFVF9MT0dfRkQgX0lPVyhWSE9TVF9WSVJUSU8s
IDB4MDcsIGludCkKPiArLyogU3BlY2lmeSBhbiBpb21tdWZkIGZpbGUgZGVzY3JpcHRvciBmb3Ig
SU8gYWRkcmVzcyB0cmFuc2xhdGlvbiAqLwo+Cj4gIC8qIFJpbmcgc2V0dXAuICovCj4gIC8qIFNl
dCBudW1iZXIgb2YgZGVzY3JpcHRvcnMgaW4gcmluZy4gVGhpcyBwYXJhbWV0ZXIgY2FuIG5vdAo+
IEBAIC0xODAsNCArMTgxLDc0IEBACj4gICAqLwo+ICAjZGVmaW5lIFZIT1NUX1ZEUEFfU1VTUEVO
RCAgICAgICAgICAgICBfSU8oVkhPU1RfVklSVElPLCAweDdEKQo+Cj4gKy8qIHZob3N0IHZkcGEg
c2V0IGlvbW11ZmQKPiArICogSW5wdXQgcGFyYW1ldGVyczoKPiArICogQGlvbW11ZmQ6IGZpbGUg
ZGVzY3JpcHRvciBmcm9tIC9kZXYvaW9tbXU7IHBhc3MgLTEgdG8gdW5zZXQKPiArICogQGdyb3Vw
X2lkOiBpZGVudGlmaWVyIG9mIHRoZSBncm91cCB0aGF0IGEgdmlydHF1ZXVlIGJlbG9uZ3MgdG8K
PiArICogQGlvYXNfaWQ6IElPQVMgaWRlbnRpZmllciByZXR1cm5lZCBmcm9tIGlvY3RsKElPTU1V
X0lPQVNfQUxMT0MpCj4gKyAqIE91dHB1dCBwYXJhbWV0ZXJzOgo+ICsgKiBAb3V0X2Rldl9pZDog
ZGV2aWNlIGlkZW50aWZpZXIKPiArICogQG91dF9od3B0X2lkOiBoYXJkd2FyZSBJTyBwYWdldGFi
bGUgaWRlbnRpZmllcgo+ICsgKi8KPiArc3RydWN0IHZob3N0X3ZkcGFfc2V0X2lvbW11ZmQgewo+
ICsgICAgICAgX19zMzIgaW9tbXVmZDsKPiArICAgICAgIF9fdTMyIGdyb3VwX2lkOwoKVGhpcyBu
ZWVkcyB0byBiZSBBU0lEIG9mIGEgdmRwYSBkZXZpY2UsIGFzIHRoZSBjdXJyZW50IGFkZHJlc3Mg
c3BhY2UKY291bGQgYmUgc2hhcmVkIGFtb25nIHZhcmlvdXMgZ3JvdXBzLiBBbmQgdGhlIGRldmlj
ZSBkbyB0cmFuc2xhdGlvbgpiYXNlZCBvbjoKCnZpcnRxdWV1ZSAtPiBncm91cCAtPiBBUyAtPiBJ
T0FTIG9mIGlvbW11ZmQKClRoYW5rcwoKCgo+ICsgICAgICAgX191MzIgaW9hc19pZDsKPiArICAg
ICAgIF9fdTMyIG91dF9kZXZfaWQ7Cj4gKyAgICAgICBfX3UzMiBvdXRfaHdwdF9pZDsKPiArfTsK
PiArCj4gKyNkZWZpbmUgVkhPU1RfVkRQQV9TRVRfSU9NTVVfRkQgXAo+ICsgICAgICAgX0lPVyhW
SE9TVF9WSVJUSU8sIDB4N2UsIHN0cnVjdCB2aG9zdF92ZHBhX3NldF9pb21tdWZkKQo+ICsKPiAr
LyoKPiArICogVkRQQV9ERVZJQ0VfQVRUQUNIX0lPTU1VRkRfQVMgLQo+ICsgKiBfSU9XKFZIT1NU
X1ZJUlRJTywgMHg3Ziwgc3RydWN0IHZkcGFfZGV2aWNlX2F0dGFjaF9pb21tdWZkX2FzKQo+ICsg
Kgo+ICsgKiBBdHRhY2ggYSB2ZHBhIGRldmljZSB0byBhbiBpb21tdWZkIGFkZHJlc3Mgc3BhY2Ug
c3BlY2lmaWVkIGJ5IElPQVMKPiArICogaWQuCj4gKyAqCj4gKyAqIEF2YWlsYWJsZSBvbmx5IGFm
dGVyIGEgZGV2aWNlIGhhcyBiZWVuIGJvdW5kIHRvIGlvbW11ZmQgdmlhCj4gKyAqIFZIT1NUX1ZE
UEFfU0VUX0lPTU1VX0ZECj4gKyAqCj4gKyAqIFVuZG8gYnkgVkRQQV9ERVZJQ0VfREVUQUNIX0lP
TU1VRkRfQVMgb3IgZGV2aWNlIGZkIGNsb3NlLgo+ICsgKgo+ICsgKiBAYXJnc3o6ICAgICB1c2Vy
IGZpbGxlZCBzaXplIG9mIHRoaXMgZGF0YS4KPiArICogQGZsYWdzOiAgICAgbXVzdCBiZSAwLgo+
ICsgKiBAaW9hc19pZDogICBJbnB1dCB0aGUgdGFyZ2V0IGlkIHdoaWNoIGNhbiByZXByZXNlbnQg
YW4gaW9hcwo+ICsgKiAgICAgICAgICAgICBhbGxvY2F0ZWQgdmlhIGlvbW11ZmQgc3Vic3lzdGVt
Lgo+ICsgKgo+ICsgKiBSZXR1cm46IDAgb24gc3VjY2VzcywgLWVycm5vIG9uIGZhaWx1cmUuCj4g
KyAqLwo+ICtzdHJ1Y3QgdmRwYV9kZXZpY2VfYXR0YWNoX2lvbW11ZmRfYXMgewo+ICsgICAgICAg
X191MzIgYXJnc3o7Cj4gKyAgICAgICBfX3UzMiBmbGFnczsKPiArICAgICAgIF9fdTMyIGlvYXNf
aWQ7Cj4gK307Cj4gKwo+ICsjZGVmaW5lIFZEUEFfREVWSUNFX0FUVEFDSF9JT01NVUZEX0FTIFwK
PiArICAgICAgIF9JT1coVkhPU1RfVklSVElPLCAweDdmLCBzdHJ1Y3QgdmRwYV9kZXZpY2VfYXR0
YWNoX2lvbW11ZmRfYXMpCj4gKwo+ICsvKgo+ICsgKiBWRFBBX0RFVklDRV9ERVRBQ0hfSU9NTVVG
RF9BUwo+ICsgKgo+ICsgKiBEZXRhY2ggYSB2ZHBhIGRldmljZSBmcm9tIHRoZSBpb21tdWZkIGFk
ZHJlc3Mgc3BhY2UgaXQgaGFzIGJlZW4KPiArICogYXR0YWNoZWQgdG8uIEFmdGVyIGl0LCBkZXZp
Y2Ugc2hvdWxkIGJlIGluIGEgYmxvY2tpbmcgRE1BIHN0YXRlLgo+ICsgKgo+ICsgKiBBdmFpbGFi
bGUgb25seSBhZnRlciBhIGRldmljZSBoYXMgYmVlbiBib3VuZCB0byBpb21tdWZkIHZpYQo+ICsg
KiBWSE9TVF9WRFBBX1NFVF9JT01NVV9GRAo+ICsgKgo+ICsgKiBAYXJnc3o6ICAgICB1c2VyIGZp
bGxlZCBzaXplIG9mIHRoaXMgZGF0YS4KPiArICogQGZsYWdzOiAgICAgbXVzdCBiZSAwLgo+ICsg
Kgo+ICsgKiBSZXR1cm46IDAgb24gc3VjY2VzcywgLWVycm5vIG9uIGZhaWx1cmUuCj4gKyAqLwo+
ICtzdHJ1Y3QgdmRwYV9kZXZpY2VfZGV0YWNoX2lvbW11ZmRfYXMgewo+ICsgICAgICAgX191MzIg
YXJnc3o7Cj4gKyAgICAgICBfX3UzMiBmbGFnczsKPiArfTsKPiArCj4gKyNkZWZpbmUgVkRQQV9E
RVZJQ0VfREVUQUNIX0lPTU1VRkRfQVMgXAo+ICsgICAgICAgX0lPVyhWSE9TVF9WSVJUSU8sIDB4
ODMsIHN0cnVjdCB2ZHBhX2RldmljZV9kZXRhY2hfaW9tbXVmZF9hcykKPiArCj4gICNlbmRpZgo+
IC0tCj4gMi4zNC4zCj4KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0cy5s
aW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcvbWFp
bG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
