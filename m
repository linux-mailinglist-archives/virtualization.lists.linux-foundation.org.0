Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
	by mail.lfdr.de (Postfix) with ESMTPS id B8DD8197886
	for <lists.virtualization@lfdr.de>; Mon, 30 Mar 2020 12:13:08 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by hemlock.osuosl.org (Postfix) with ESMTP id 8D37A8848F;
	Mon, 30 Mar 2020 10:13:06 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id AJhxgJn-cXu7; Mon, 30 Mar 2020 10:13:04 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by hemlock.osuosl.org (Postfix) with ESMTP id 07331884B2;
	Mon, 30 Mar 2020 10:13:02 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id D8CB2C1AE8;
	Mon, 30 Mar 2020 10:13:01 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id BD920C07FF
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:12:56 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by hemlock.osuosl.org (Postfix) with ESMTP id AD2B187D9F
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:12:56 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id T2xE7mc-cgfF
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:12:56 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by hemlock.osuosl.org (Postfix) with ESMTPS id 25C8C87F5D
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:12:55 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 A7CA13074B69; Mon, 30 Mar 2020 13:12:53 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 8897C305B7A0;
 Mon, 30 Mar 2020 13:12:53 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v8 32/81] KVM: x86: page track: provide all page tracking
 hooks with the guest virtual address
Date: Mon, 30 Mar 2020 13:12:19 +0300
Message-Id: <20200330101308.21702-33-alazar@bitdefender.com>
In-Reply-To: <20200330101308.21702-1-alazar@bitdefender.com>
References: <20200330101308.21702-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBpcyBuZWVk
ZWQgYmVjYXVzZSB0aGUgZW11bGF0b3IgY2FsbHMgdGhlIHBhZ2UgdHJhY2tpbmcgY29kZQppcnJl
c3BlY3RpdmUgb2YgdGhlIGN1cnJlbnQgVk0tZXhpdCByZWFzb24gb3IgYXZhaWxhYmxlIGluZm9y
bWF0aW9uLgoKU2lnbmVkLW9mZi1ieTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIu
Y29tPgpTaWduZWQtb2ZmLWJ5OiBBZGFsYmVydCBMYXrEg3IgPGFsYXphckBiaXRkZWZlbmRlci5j
b20+Ci0tLQogYXJjaC94ODYvaW5jbHVkZS9hc20va3ZtX2hvc3QuaCAgICAgICB8ICAyICstCiBh
cmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1fcGFnZV90cmFjay5oIHwgMTAgKysrKysrLS0tLQogYXJj
aC94ODYva3ZtL21tdS9tbXUuYyAgICAgICAgICAgICAgICB8ICAyICstCiBhcmNoL3g4Ni9rdm0v
bW11L3BhZ2VfdHJhY2suYyAgICAgICAgIHwgIDYgKysrLS0tCiBhcmNoL3g4Ni9rdm0veDg2LmMg
ICAgICAgICAgICAgICAgICAgIHwgMTYgKysrKysrKystLS0tLS0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Z0L2t2bWd0LmMgICAgICB8ICAyICstCiA2IGZpbGVzIGNoYW5nZWQsIDIwIGluc2Vy
dGlvbnMoKyksIDE4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2FyY2gveDg2L2luY2x1ZGUv
YXNtL2t2bV9ob3N0LmggYi9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1faG9zdC5oCmluZGV4IDk3
NzJlMDdmODI1My4uNjE2OWUxMmQyNTQwIDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9pbmNsdWRlL2Fz
bS9rdm1faG9zdC5oCisrKyBiL2FyY2gveDg2L2luY2x1ZGUvYXNtL2t2bV9ob3N0LmgKQEAgLTEz
NTksNyArMTM1OSw3IEBAIHZvaWQga3ZtX21tdV9jaGFuZ2VfbW11X3BhZ2VzKHN0cnVjdCBrdm0g
Kmt2bSwgdW5zaWduZWQgbG9uZyBrdm1fbnJfbW11X3BhZ2VzKTsKIGludCBsb2FkX3BkcHRycyhz
dHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHN0cnVjdCBrdm1fbW11ICptbXUsIHVuc2lnbmVkIGxvbmcg
Y3IzKTsKIGJvb2wgcGRwdHJzX2NoYW5nZWQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIAotaW50
IGVtdWxhdG9yX3dyaXRlX3BoeXMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsCitp
bnQgZW11bGF0b3Jfd3JpdGVfcGh5cyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIGdwYV90IGdwYSwg
Z3ZhX3QgZ3ZhLAogCQkJICBjb25zdCB2b2lkICp2YWwsIGludCBieXRlcyk7CiAKIHN0cnVjdCBr
dm1faXJxX21hc2tfbm90aWZpZXIgewpkaWZmIC0tZ2l0IGEvYXJjaC94ODYvaW5jbHVkZS9hc20v
a3ZtX3BhZ2VfdHJhY2suaCBiL2FyY2gveDg2L2luY2x1ZGUvYXNtL2t2bV9wYWdlX3RyYWNrLmgK
aW5kZXggMTcyZjk3NDlkYmIyLi5lOTFmNWExNmU3NDEgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2lu
Y2x1ZGUvYXNtL2t2bV9wYWdlX3RyYWNrLmgKKysrIGIvYXJjaC94ODYvaW5jbHVkZS9hc20va3Zt
X3BhZ2VfdHJhY2suaApAQCAtMjgsMTIgKzI4LDE0IEBAIHN0cnVjdCBrdm1fcGFnZV90cmFja19u
b3RpZmllcl9ub2RlIHsKIAkgKgogCSAqIEB2Y3B1OiB0aGUgdmNwdSB3aGVyZSB0aGUgd3JpdGUg
YWNjZXNzIGhhcHBlbmVkLgogCSAqIEBncGE6IHRoZSBwaHlzaWNhbCBhZGRyZXNzIHdyaXR0ZW4g
YnkgZ3Vlc3QuCisJICogQGd2YTogdGhlIHZpcnR1YWwgYWRkcmVzcyB3cml0dGVuIGJ5IGd1ZXN0
LgogCSAqIEBuZXc6IHRoZSBkYXRhIHdhcyB3cml0dGVuIHRvIHRoZSBhZGRyZXNzLgogCSAqIEBi
eXRlczogdGhlIHdyaXR0ZW4gbGVuZ3RoLgogCSAqIEBub2RlOiB0aGlzIG5vZGUKIAkgKi8KLQl2
b2lkICgqdHJhY2tfd3JpdGUpKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgZ3BhX3QgZ3BhLCBjb25z
dCB1OCAqbmV3LAotCQkJICAgIGludCBieXRlcywgc3RydWN0IGt2bV9wYWdlX3RyYWNrX25vdGlm
aWVyX25vZGUgKm5vZGUpOworCXZvaWQgKCp0cmFja193cml0ZSkoc3RydWN0IGt2bV92Y3B1ICp2
Y3B1LCBncGFfdCBncGEsIGd2YV90IGd2YSwKKwkJCSAgICBjb25zdCB1OCAqbmV3LCBpbnQgYnl0
ZXMsCisJCQkgICAgc3RydWN0IGt2bV9wYWdlX3RyYWNrX25vdGlmaWVyX25vZGUgKm5vZGUpOwog
CS8qCiAJICogSXQgaXMgY2FsbGVkIHdoZW4gbWVtb3J5IHNsb3QgaXMgYmVpbmcgbW92ZWQgb3Ig
cmVtb3ZlZAogCSAqIHVzZXJzIGNhbiBkcm9wIHdyaXRlLXByb3RlY3Rpb24gZm9yIHRoZSBwYWdl
cyBpbiB0aGF0IG1lbW9yeSBzbG90CkBAIC02OSw3ICs3MSw3IEBAIGt2bV9wYWdlX3RyYWNrX3Jl
Z2lzdGVyX25vdGlmaWVyKHN0cnVjdCBrdm0gKmt2bSwKIHZvaWQKIGt2bV9wYWdlX3RyYWNrX3Vu
cmVnaXN0ZXJfbm90aWZpZXIoc3RydWN0IGt2bSAqa3ZtLAogCQkJCSAgIHN0cnVjdCBrdm1fcGFn
ZV90cmFja19ub3RpZmllcl9ub2RlICpuKTsKLXZvaWQga3ZtX3BhZ2VfdHJhY2tfd3JpdGUoc3Ry
dWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsIGNvbnN0IHU4ICpuZXcsCi0JCQkgIGludCBi
eXRlcyk7Cit2b2lkIGt2bV9wYWdlX3RyYWNrX3dyaXRlKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwg
Z3BhX3QgZ3BhLCBndmFfdCBndmEsCisJCQkgIGNvbnN0IHU4ICpuZXcsIGludCBieXRlcyk7CiB2
b2lkIGt2bV9wYWdlX3RyYWNrX2ZsdXNoX3Nsb3Qoc3RydWN0IGt2bSAqa3ZtLCBzdHJ1Y3Qga3Zt
X21lbW9yeV9zbG90ICpzbG90KTsKICNlbmRpZgpkaWZmIC0tZ2l0IGEvYXJjaC94ODYva3ZtL21t
dS9tbXUuYyBiL2FyY2gveDg2L2t2bS9tbXUvbW11LmMKaW5kZXggODdlOWJhMjdhZGExLi40ZWRl
YjNlMjc1YmMgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS9tbXUvbW11LmMKKysrIGIvYXJjaC94
ODYva3ZtL21tdS9tbXUuYwpAQCAtNTMyOSw3ICs1MzI5LDcgQEAgc3RhdGljIHU2NCAqZ2V0X3dy
aXR0ZW5fc3B0ZXMoc3RydWN0IGt2bV9tbXVfcGFnZSAqc3AsIGdwYV90IGdwYSwgaW50ICpuc3B0
ZSkKIAlyZXR1cm4gc3B0ZTsKIH0KIAotc3RhdGljIHZvaWQga3ZtX21tdV9wdGVfd3JpdGUoc3Ry
dWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsCitzdGF0aWMgdm9pZCBrdm1fbW11X3B0ZV93
cml0ZShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIGdwYV90IGdwYSwgZ3ZhX3QgZ3ZhLAogCQkJICAg
ICAgY29uc3QgdTggKm5ldywgaW50IGJ5dGVzLAogCQkJICAgICAgc3RydWN0IGt2bV9wYWdlX3Ry
YWNrX25vdGlmaWVyX25vZGUgKm5vZGUpCiB7CmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9rdm0vbW11
L3BhZ2VfdHJhY2suYyBiL2FyY2gveDg2L2t2bS9tbXUvcGFnZV90cmFjay5jCmluZGV4IDM1MjFl
MmQxNzZmMi4uZGM4OTFkNmEyNTUzIDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9rdm0vbW11L3BhZ2Vf
dHJhY2suYworKysgYi9hcmNoL3g4Ni9rdm0vbW11L3BhZ2VfdHJhY2suYwpAQCAtMjIwLDggKzIy
MCw4IEBAIEVYUE9SVF9TWU1CT0xfR1BMKGt2bV9wYWdlX3RyYWNrX3VucmVnaXN0ZXJfbm90aWZp
ZXIpOwogICogVGhlIG5vZGUgc2hvdWxkIGZpZ3VyZSBvdXQgaWYgdGhlIHdyaXR0ZW4gcGFnZSBp
cyB0aGUgb25lIHRoYXQgbm9kZSBpcwogICogaW50ZXJlc3RlZCBpbiBieSBpdHNlbGYuCiAgKi8K
LXZvaWQga3ZtX3BhZ2VfdHJhY2tfd3JpdGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBn
cGEsIGNvbnN0IHU4ICpuZXcsCi0JCQkgIGludCBieXRlcykKK3ZvaWQga3ZtX3BhZ2VfdHJhY2tf
d3JpdGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsIGd2YV90IGd2YSwKKwkJCSAg
Y29uc3QgdTggKm5ldywgaW50IGJ5dGVzKQogewogCXN0cnVjdCBrdm1fcGFnZV90cmFja19ub3Rp
Zmllcl9oZWFkICpoZWFkOwogCXN0cnVjdCBrdm1fcGFnZV90cmFja19ub3RpZmllcl9ub2RlICpu
OwpAQCAtMjM1LDcgKzIzNSw3IEBAIHZvaWQga3ZtX3BhZ2VfdHJhY2tfd3JpdGUoc3RydWN0IGt2
bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsIGNvbnN0IHU4ICpuZXcsCiAJaWR4ID0gc3JjdV9yZWFk
X2xvY2soJmhlYWQtPnRyYWNrX3NyY3UpOwogCWhsaXN0X2Zvcl9lYWNoX2VudHJ5X3JjdShuLCAm
aGVhZC0+dHJhY2tfbm90aWZpZXJfbGlzdCwgbm9kZSkKIAkJaWYgKG4tPnRyYWNrX3dyaXRlKQot
CQkJbi0+dHJhY2tfd3JpdGUodmNwdSwgZ3BhLCBuZXcsIGJ5dGVzLCBuKTsKKwkJCW4tPnRyYWNr
X3dyaXRlKHZjcHUsIGdwYSwgZ3ZhLCBuZXcsIGJ5dGVzLCBuKTsKIAlzcmN1X3JlYWRfdW5sb2Nr
KCZoZWFkLT50cmFja19zcmN1LCBpZHgpOwogfQogCmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9rdm0v
eDg2LmMgYi9hcmNoL3g4Ni9rdm0veDg2LmMKaW5kZXggNzMwMjJlZWQ5YTk0Li5kMzVlYTE5NDE3
Y2EgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS94ODYuYworKysgYi9hcmNoL3g4Ni9rdm0veDg2
LmMKQEAgLTU2NDMsNyArNTY0Myw3IEBAIHN0YXRpYyBpbnQgdmNwdV9tbWlvX2d2YV90b19ncGEo
c3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1bnNpZ25lZCBsb25nIGd2YSwKIAlyZXR1cm4gdmNwdV9p
c19tbWlvX2dwYSh2Y3B1LCBndmEsICpncGEsIHdyaXRlKTsKIH0KIAotaW50IGVtdWxhdG9yX3dy
aXRlX3BoeXMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsCitpbnQgZW11bGF0b3Jf
d3JpdGVfcGh5cyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIGdwYV90IGdwYSwgZ3ZhX3QgZ3ZhLAog
CQkJY29uc3Qgdm9pZCAqdmFsLCBpbnQgYnl0ZXMpCiB7CiAJaW50IHJldDsKQEAgLTU2NTEsMTQg
KzU2NTEsMTQgQEAgaW50IGVtdWxhdG9yX3dyaXRlX3BoeXMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
LCBncGFfdCBncGEsCiAJcmV0ID0ga3ZtX3ZjcHVfd3JpdGVfZ3Vlc3QodmNwdSwgZ3BhLCB2YWws
IGJ5dGVzKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIDA7Ci0Ja3ZtX3BhZ2VfdHJhY2tfd3Jp
dGUodmNwdSwgZ3BhLCB2YWwsIGJ5dGVzKTsKKwlrdm1fcGFnZV90cmFja193cml0ZSh2Y3B1LCBn
cGEsIGd2YSwgdmFsLCBieXRlcyk7CiAJcmV0dXJuIDE7CiB9CiAKIHN0cnVjdCByZWFkX3dyaXRl
X2VtdWxhdG9yX29wcyB7CiAJaW50ICgqcmVhZF93cml0ZV9wcmVwYXJlKShzdHJ1Y3Qga3ZtX3Zj
cHUgKnZjcHUsIHZvaWQgKnZhbCwKIAkJCQkgIGludCBieXRlcyk7Ci0JaW50ICgqcmVhZF93cml0
ZV9lbXVsYXRlKShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIGdwYV90IGdwYSwKKwlpbnQgKCpyZWFk
X3dyaXRlX2VtdWxhdGUpKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgZ3BhX3QgZ3BhLCBndmFfdCBn
dmEsCiAJCQkJICB2b2lkICp2YWwsIGludCBieXRlcyk7CiAJaW50ICgqcmVhZF93cml0ZV9tbWlv
KShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIGdwYV90IGdwYSwKIAkJCSAgICAgICBpbnQgYnl0ZXMs
IHZvaWQgKnZhbCk7CkBAIC01Njc5LDE2ICs1Njc5LDE2IEBAIHN0YXRpYyBpbnQgcmVhZF9wcmVw
YXJlKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdm9pZCAqdmFsLCBpbnQgYnl0ZXMpCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgcmVhZF9lbXVsYXRlKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwg
Z3BhX3QgZ3BhLAorc3RhdGljIGludCByZWFkX2VtdWxhdGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
LCBncGFfdCBncGEsIGd2YV90IGd2YSwKIAkJCXZvaWQgKnZhbCwgaW50IGJ5dGVzKQogewogCXJl
dHVybiAha3ZtX3ZjcHVfcmVhZF9ndWVzdCh2Y3B1LCBncGEsIHZhbCwgYnl0ZXMpOwogfQogCi1z
dGF0aWMgaW50IHdyaXRlX2VtdWxhdGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEs
CitzdGF0aWMgaW50IHdyaXRlX2VtdWxhdGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBn
cGEsIGd2YV90IGd2YSwKIAkJCSB2b2lkICp2YWwsIGludCBieXRlcykKIHsKLQlyZXR1cm4gZW11
bGF0b3Jfd3JpdGVfcGh5cyh2Y3B1LCBncGEsIHZhbCwgYnl0ZXMpOworCXJldHVybiBlbXVsYXRv
cl93cml0ZV9waHlzKHZjcHUsIGdwYSwgZ3ZhLCB2YWwsIGJ5dGVzKTsKIH0KIAogc3RhdGljIGlu
dCB3cml0ZV9tbWlvKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgZ3BhX3QgZ3BhLCBpbnQgYnl0ZXMs
IHZvaWQgKnZhbCkKQEAgLTU3NTcsNyArNTc1Nyw3IEBAIHN0YXRpYyBpbnQgZW11bGF0b3JfcmVh
ZF93cml0ZV9vbmVwYWdlKHVuc2lnbmVkIGxvbmcgYWRkciwgdm9pZCAqdmFsLAogCQkJcmV0dXJu
IFg4NkVNVUxfUFJPUEFHQVRFX0ZBVUxUOwogCX0KIAotCWlmICghcmV0ICYmIG9wcy0+cmVhZF93
cml0ZV9lbXVsYXRlKHZjcHUsIGdwYSwgdmFsLCBieXRlcykpCisJaWYgKCFyZXQgJiYgb3BzLT5y
ZWFkX3dyaXRlX2VtdWxhdGUodmNwdSwgZ3BhLCBhZGRyLCB2YWwsIGJ5dGVzKSkKIAkJcmV0dXJu
IFg4NkVNVUxfQ09OVElOVUU7CiAKIAkvKgpAQCAtNTkxNiw3ICs1OTE2LDcgQEAgc3RhdGljIGlu
dCBlbXVsYXRvcl9jbXB4Y2hnX2VtdWxhdGVkKHN0cnVjdCB4ODZfZW11bGF0ZV9jdHh0ICpjdHh0
LAogCWlmICghZXhjaGFuZ2VkKQogCQlyZXR1cm4gWDg2RU1VTF9DTVBYQ0hHX0ZBSUxFRDsKIAot
CWt2bV9wYWdlX3RyYWNrX3dyaXRlKHZjcHUsIGdwYSwgbmV3LCBieXRlcyk7CisJa3ZtX3BhZ2Vf
dHJhY2tfd3JpdGUodmNwdSwgZ3BhLCBhZGRyLCBuZXcsIGJ5dGVzKTsKIAogCXJldHVybiBYODZF
TVVMX0NPTlRJTlVFOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQva3Zt
Z3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9rdm1ndC5jCmluZGV4IDMyNTlhMWZhNjll
MS4uZGRhZDYzYWJhOWI0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQva3Zt
Z3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQva3ZtZ3QuYwpAQCAtMTY4Miw3ICsx
NjgyLDcgQEAgc3RhdGljIGludCBrdm1ndF9wYWdlX3RyYWNrX3JlbW92ZSh1bnNpZ25lZCBsb25n
IGhhbmRsZSwgdTY0IGdmbikKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIHZvaWQga3ZtZ3RfcGFn
ZV90cmFja193cml0ZShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIGdwYV90IGdwYSwKK3N0YXRpYyB2
b2lkIGt2bWd0X3BhZ2VfdHJhY2tfd3JpdGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBn
cGEsIGd2YV90IGd2YSwKIAkJY29uc3QgdTggKnZhbCwgaW50IGxlbiwKIAkJc3RydWN0IGt2bV9w
YWdlX3RyYWNrX25vdGlmaWVyX25vZGUgKm5vZGUpCiB7Cl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0
dWFsaXphdGlvbkBsaXN0cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4
Zm91bmRhdGlvbi5vcmcvbWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
