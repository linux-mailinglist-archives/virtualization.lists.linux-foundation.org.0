Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp2.osuosl.org (smtp2.osuosl.org [140.211.166.133])
	by mail.lfdr.de (Postfix) with ESMTPS id 04F77751722
	for <lists.virtualization@lfdr.de>; Thu, 13 Jul 2023 06:06:21 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp2.osuosl.org (Postfix) with ESMTP id 797F640640;
	Thu, 13 Jul 2023 04:06:19 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 797F640640
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
	by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id OUVVO4JiERHS; Thu, 13 Jul 2023 04:06:18 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by smtp2.osuosl.org (Postfix) with ESMTPS id 16DBC404CF;
	Thu, 13 Jul 2023 04:06:18 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 16DBC404CF
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 59584C0DD4;
	Thu, 13 Jul 2023 04:06:17 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp4.osuosl.org (smtp4.osuosl.org [140.211.166.137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 56F54C0032
 for <virtualization@lists.linux-foundation.org>;
 Thu, 13 Jul 2023 04:06:16 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp4.osuosl.org (Postfix) with ESMTP id 29C0A41FA8
 for <virtualization@lists.linux-foundation.org>;
 Thu, 13 Jul 2023 04:06:16 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 29C0A41FA8
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
 by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id NszusuNdytrn
 for <virtualization@lists.linux-foundation.org>;
 Thu, 13 Jul 2023 04:06:14 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org E330F41F03
Received: from out30-118.freemail.mail.aliyun.com
 (out30-118.freemail.mail.aliyun.com [115.124.30.118])
 by smtp4.osuosl.org (Postfix) with ESMTPS id E330F41F03
 for <virtualization@lists.linux-foundation.org>;
 Thu, 13 Jul 2023 04:06:13 +0000 (UTC)
X-Alimail-AntiSpam: AC=PASS; BC=-1|-1; BR=01201311R161e4; CH=green; DM=||false|;
 DS=||; FP=0|-1|-1|-1|0|-1|-1|-1; HT=ay29a033018046056;
 MF=xuanzhuo@linux.alibaba.com; NM=1; PH=DS; RN=14; SR=0;
 TI=SMTPD_---0VnFW1kU_1689221166; 
Received: from localhost(mailfrom:xuanzhuo@linux.alibaba.com
 fp:SMTPD_---0VnFW1kU_1689221166) by smtp.aliyun-inc.com;
 Thu, 13 Jul 2023 12:06:07 +0800
Message-ID: <1689220976.8908284-1-xuanzhuo@linux.alibaba.com>
Subject: Re: [PATCH vhost v11 06/10] virtio_ring: skip unmap for premapped
Date: Thu, 13 Jul 2023 12:02:56 +0800
From: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
To: Jason Wang <jasowang@redhat.com>
References: <20230710034237.12391-1-xuanzhuo@linux.alibaba.com>
 <20230710034237.12391-7-xuanzhuo@linux.alibaba.com>
 <CACGkMEtb_wYyXLU6kAaC2Ju2d4K=J+YbytUCMvKcNtPF+BvpJw@mail.gmail.com>
In-Reply-To: <CACGkMEtb_wYyXLU6kAaC2Ju2d4K=J+YbytUCMvKcNtPF+BvpJw@mail.gmail.com>
Cc: Jesper Dangaard Brouer <hawk@kernel.org>,
 Daniel Borkmann <daniel@iogearbox.net>, "Michael S. Tsirkin" <mst@redhat.com>,
 netdev@vger.kernel.org, John Fastabend <john.fastabend@gmail.com>,
 Alexei Starovoitov <ast@kernel.org>, virtualization@lists.linux-foundation.org,
 Christoph Hellwig <hch@infradead.org>, Eric Dumazet <edumazet@google.com>,
 Jakub Kicinski <kuba@kernel.org>, bpf@vger.kernel.org,
 Paolo Abeni <pabeni@redhat.com>, "David S. Miller" <davem@davemloft.net>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gVGh1LCAxMyBKdWwgMjAyMyAxMTo1MDo1NyArMDgwMCwgSmFzb24gV2FuZyA8amFzb3dhbmdA
cmVkaGF0LmNvbT4gd3JvdGU6Cj4gT24gTW9uLCBKdWwgMTAsIDIwMjMgYXQgMTE6NDLigK9BTSBY
dWFuIFpodW8gPHh1YW56aHVvQGxpbnV4LmFsaWJhYmEuY29tPiB3cm90ZToKPiA+Cj4gPiBOb3cg
d2UgYWRkIGEgY2FzZSB3aGVyZSB3ZSBza2lwIGRtYSB1bm1hcCwgdGhlIHZxLT5wcmVtYXBwZWQg
aXMgdHJ1ZS4KPiA+Cj4gPiBXZSBjYW4ndCBqdXN0IHJlbHkgb24gdXNlX2RtYV9hcGkgdG8gZGV0
ZXJtaW5lIHdoZXRoZXIgdG8gc2tpcCB0aGUgZG1hCj4gPiBvcGVyYXRpb24uIEZvciBjb252ZW5p
ZW5jZSwgSSBpbnRyb2R1Y2VkIHRoZSAiZG9fdW5tYXAiLiBCeSBkZWZhdWx0LCBpdAo+ID4gaXMg
dGhlIHNhbWUgYXMgdXNlX2RtYV9hcGkuIElmIHRoZSBkcml2ZXIgaXMgY29uZmlndXJlZCB3aXRo
IHByZW1hcHBlZCwKPiA+IHRoZW4gZG9fdW5tYXAgaXMgZmFsc2UuCj4gPgo+ID4gU28gYXMgbG9u
ZyBhcyBkb191bm1hcCBpcyBmYWxzZSwgZm9yIGFkZHIgb2YgZGVzYywgd2Ugc2hvdWxkIHNraXAg
ZG1hCj4gPiB1bm1hcCBvcGVyYXRpb24uCj4gPgo+ID4gU2lnbmVkLW9mZi1ieTogWHVhbiBaaHVv
IDx4dWFuemh1b0BsaW51eC5hbGliYWJhLmNvbT4KPiA+IC0tLQo+ID4gIGRyaXZlcnMvdmlydGlv
L3ZpcnRpb19yaW5nLmMgfCA0MiArKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0K
PiA+ICAxIGZpbGUgY2hhbmdlZCwgMjggaW5zZXJ0aW9ucygrKSwgMTQgZGVsZXRpb25zKC0pCj4g
Pgo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5nLmMgYi9kcml2ZXJz
L3ZpcnRpby92aXJ0aW9fcmluZy5jCj4gPiBpbmRleCAxZmIyYzZkY2E5ZWEuLjEwZWUzYjdjZTU3
MSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5nLmMKPiA+ICsrKyBi
L2RyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5nLmMKPiA+IEBAIC0xNzUsNiArMTc1LDExIEBAIHN0
cnVjdCB2cmluZ192aXJ0cXVldWUgewo+ID4gICAgICAgICAvKiBEbyBETUEgbWFwcGluZyBieSBk
cml2ZXIgKi8KPiA+ICAgICAgICAgYm9vbCBwcmVtYXBwZWQ7Cj4gPgo+ID4gKyAgICAgICAvKiBE
byB1bm1hcCBvciBub3QgZm9yIGRlc2MuIEp1c3Qgd2hlbiBwcmVtYXBwZWQgaXMgRmFsc2UgYW5k
Cj4gPiArICAgICAgICAqIHVzZV9kbWFfYXBpIGlzIHRydWUsIHRoaXMgaXMgdHJ1ZS4KPiA+ICsg
ICAgICAgICovCj4gPiArICAgICAgIGJvb2wgZG9fdW5tYXA7Cj4gPiArCj4gPiAgICAgICAgIC8q
IEhlYWQgb2YgZnJlZSBidWZmZXIgbGlzdC4gKi8KPiA+ICAgICAgICAgdW5zaWduZWQgaW50IGZy
ZWVfaGVhZDsKPiA+ICAgICAgICAgLyogTnVtYmVyIHdlJ3ZlIGFkZGVkIHNpbmNlIGxhc3Qgc3lu
Yy4gKi8KPiA+IEBAIC00NDAsNyArNDQ1LDcgQEAgc3RhdGljIHZvaWQgdnJpbmdfdW5tYXBfb25l
X3NwbGl0X2luZGlyZWN0KGNvbnN0IHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLAo+ID4gIHsK
PiA+ICAgICAgICAgdTE2IGZsYWdzOwo+ID4KPiA+IC0gICAgICAgaWYgKCF2cS0+dXNlX2RtYV9h
cGkpCj4gPiArICAgICAgIGlmICghdnEtPmRvX3VubWFwKQo+ID4gICAgICAgICAgICAgICAgIHJl
dHVybjsKPiA+Cj4gPiAgICAgICAgIGZsYWdzID0gdmlydGlvMTZfdG9fY3B1KHZxLT52cS52ZGV2
LCBkZXNjLT5mbGFncyk7Cj4gPiBAQCAtNDU4LDE4ICs0NjMsMjEgQEAgc3RhdGljIHVuc2lnbmVk
IGludCB2cmluZ191bm1hcF9vbmVfc3BsaXQoY29uc3Qgc3RydWN0IHZyaW5nX3ZpcnRxdWV1ZSAq
dnEsCj4gPiAgICAgICAgIHN0cnVjdCB2cmluZ19kZXNjX2V4dHJhICpleHRyYSA9IHZxLT5zcGxp
dC5kZXNjX2V4dHJhOwo+ID4gICAgICAgICB1MTYgZmxhZ3M7Cj4gPgo+ID4gLSAgICAgICBpZiAo
IXZxLT51c2VfZG1hX2FwaSkKPiA+IC0gICAgICAgICAgICAgICBnb3RvIG91dDsKPiA+IC0KPiA+
ICAgICAgICAgZmxhZ3MgPSBleHRyYVtpXS5mbGFnczsKPiA+Cj4gPiAgICAgICAgIGlmIChmbGFn
cyAmIFZSSU5HX0RFU0NfRl9JTkRJUkVDVCkgewo+ID4gKyAgICAgICAgICAgICAgIGlmICghdnEt
PnVzZV9kbWFfYXBpKQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXQ7Cj4gPiAr
Cj4gPiAgICAgICAgICAgICAgICAgZG1hX3VubWFwX3NpbmdsZSh2cmluZ19kbWFfZGV2KHZxKSwK
PiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhW2ldLmFkZHIsCj4gPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYVtpXS5sZW4sCj4gPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAoZmxhZ3MgJiBWUklOR19ERVNDX0ZfV1JJVEUpID8K
PiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERNQV9GUk9NX0RFVklDRSA6IERN
QV9UT19ERVZJQ0UpOwo+ID4gICAgICAgICB9IGVsc2Ugewo+ID4gKyAgICAgICAgICAgICAgIGlm
ICghdnEtPmRvX3VubWFwKQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXQ7Cj4g
PiArCj4gPiAgICAgICAgICAgICAgICAgZG1hX3VubWFwX3BhZ2UodnJpbmdfZG1hX2Rldih2cSks
Cj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFbaV0uYWRkciwKPiA+ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYVtpXS5sZW4sCj4gPiBAQCAtNjM1LDcg
KzY0Myw3IEBAIHN0YXRpYyBpbmxpbmUgaW50IHZpcnRxdWV1ZV9hZGRfc3BsaXQoc3RydWN0IHZp
cnRxdWV1ZSAqX3ZxLAo+ID4gICAgICAgICB9Cj4gPiAgICAgICAgIC8qIExhc3Qgb25lIGRvZXNu
J3QgY29udGludWUuICovCj4gPiAgICAgICAgIGRlc2NbcHJldl0uZmxhZ3MgJj0gY3B1X3RvX3Zp
cnRpbzE2KF92cS0+dmRldiwgflZSSU5HX0RFU0NfRl9ORVhUKTsKPiA+IC0gICAgICAgaWYgKCFp
bmRpcmVjdCAmJiB2cS0+dXNlX2RtYV9hcGkpCj4gPiArICAgICAgIGlmICghaW5kaXJlY3QgJiYg
dnEtPmRvX3VubWFwKQo+ID4gICAgICAgICAgICAgICAgIHZxLT5zcGxpdC5kZXNjX2V4dHJhW3By
ZXYgJiAodnEtPnNwbGl0LnZyaW5nLm51bSAtIDEpXS5mbGFncyAmPQo+ID4gICAgICAgICAgICAg
ICAgICAgICAgICAgflZSSU5HX0RFU0NfRl9ORVhUOwo+ID4KPiA+IEBAIC03OTQsNyArODAyLDcg
QEAgc3RhdGljIHZvaWQgZGV0YWNoX2J1Zl9zcGxpdChzdHJ1Y3QgdnJpbmdfdmlydHF1ZXVlICp2
cSwgdW5zaWduZWQgaW50IGhlYWQsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFZSSU5HX0RFU0NfRl9JTkRJUkVDVCkpOwo+ID4gICAgICAgICAgICAgICAgIEJVR19PTihsZW4g
PT0gMCB8fCBsZW4gJSBzaXplb2Yoc3RydWN0IHZyaW5nX2Rlc2MpKTsKPiA+Cj4gPiAtICAgICAg
ICAgICAgICAgaWYgKHZxLT51c2VfZG1hX2FwaSkgewo+ID4gKyAgICAgICAgICAgICAgIGlmICh2
cS0+ZG9fdW5tYXApIHsKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGog
PCBsZW4gLyBzaXplb2Yoc3RydWN0IHZyaW5nX2Rlc2MpOyBqKyspCj4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHZyaW5nX3VubWFwX29uZV9zcGxpdF9pbmRpcmVjdCh2cSwgJmlu
ZGlyX2Rlc2Nbal0pOwo+ID4gICAgICAgICAgICAgICAgIH0KPiA+IEBAIC0xMjE3LDE3ICsxMjI1
LDIwIEBAIHN0YXRpYyB2b2lkIHZyaW5nX3VubWFwX2V4dHJhX3BhY2tlZChjb25zdCBzdHJ1Y3Qg
dnJpbmdfdmlydHF1ZXVlICp2cSwKPiA+ICB7Cj4gPiAgICAgICAgIHUxNiBmbGFnczsKPiA+Cj4g
PiAtICAgICAgIGlmICghdnEtPnVzZV9kbWFfYXBpKQo+ID4gLSAgICAgICAgICAgICAgIHJldHVy
bjsKPiA+IC0KPiA+ICAgICAgICAgZmxhZ3MgPSBleHRyYS0+ZmxhZ3M7Cj4gPgo+ID4gICAgICAg
ICBpZiAoZmxhZ3MgJiBWUklOR19ERVNDX0ZfSU5ESVJFQ1QpIHsKPiA+ICsgICAgICAgICAgICAg
ICBpZiAoIXZxLT51c2VfZG1hX2FwaSkKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVy
bjsKPiA+ICsKPiA+ICAgICAgICAgICAgICAgICBkbWFfdW5tYXBfc2luZ2xlKHZyaW5nX2RtYV9k
ZXYodnEpLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmEtPmFkZHIs
IGV4dHJhLT5sZW4sCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZmxhZ3Mg
JiBWUklOR19ERVNDX0ZfV1JJVEUpID8KPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIERNQV9GUk9NX0RFVklDRSA6IERNQV9UT19ERVZJQ0UpOwo+ID4gICAgICAgICB9IGVsc2Ug
ewo+ID4gKyAgICAgICAgICAgICAgIGlmICghdnEtPmRvX3VubWFwKQo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuOwo+Cj4gVGhpcyBzZWVtcyBub3Qgc3RyYWlnaHRmb3J3YXJkIHRo
YW46Cj4KPiBpZiAoIXZxLT51c2VfZG1hX2FwaSkKPiAgICAgcmV0dXJuOwo+Cj4gaWYgKElORElS
RUNUKSB7Cj4gfSBlbHNlIGlmICghdnEtPnByZW1hcHBlZCkgewo+IH0KPgo+ID8KCgpNeSBsb2dp
YyBoZXJlIGlzIHRoYXQgZm9yIHRoZSByZWFsIGJ1ZmZlciwgd2UgdXNlIGRvX3VubWFwIHRvIGp1
ZGdlIHVuaWZvcm1seS4KQW5kIGluZGlyZWN0IHN0aWxsIHVzZSB1c2VfZG1hX2FwaSB0byBqdWRn
ZS4KCkZyb20gdGhpcyBwb2ludCBvZiB2aWV3LCBob3cgZG8geW91IGZlZWw/CgpUaGFua3MuCgoK
Pgo+IFRoYW5rcwo+Cj4gPiArCj4gPiAgICAgICAgICAgICAgICAgZG1hX3VubWFwX3BhZ2UodnJp
bmdfZG1hX2Rldih2cSksCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmEt
PmFkZHIsIGV4dHJhLT5sZW4sCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGZs
YWdzICYgVlJJTkdfREVTQ19GX1dSSVRFKSA/Cj4gPiBAQCAtMTI0MCw3ICsxMjUxLDcgQEAgc3Rh
dGljIHZvaWQgdnJpbmdfdW5tYXBfZGVzY19wYWNrZWQoY29uc3Qgc3RydWN0IHZyaW5nX3ZpcnRx
dWV1ZSAqdnEsCj4gPiAgewo+ID4gICAgICAgICB1MTYgZmxhZ3M7Cj4gPgo+ID4gLSAgICAgICBp
ZiAoIXZxLT51c2VfZG1hX2FwaSkKPiA+ICsgICAgICAgaWYgKCF2cS0+ZG9fdW5tYXApCj4gPiAg
ICAgICAgICAgICAgICAgcmV0dXJuOwo+ID4KPiA+ICAgICAgICAgZmxhZ3MgPSBsZTE2X3RvX2Nw
dShkZXNjLT5mbGFncyk7Cj4gPiBAQCAtMTMyOSw3ICsxMzQwLDcgQEAgc3RhdGljIGludCB2aXJ0
cXVldWVfYWRkX2luZGlyZWN0X3BhY2tlZChzdHJ1Y3QgdnJpbmdfdmlydHF1ZXVlICp2cSwKPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKHN0cnVjdCB2cmluZ19wYWNr
ZWRfZGVzYykpOwo+ID4gICAgICAgICB2cS0+cGFja2VkLnZyaW5nLmRlc2NbaGVhZF0uaWQgPSBj
cHVfdG9fbGUxNihpZCk7Cj4gPgo+ID4gLSAgICAgICBpZiAodnEtPnVzZV9kbWFfYXBpKSB7Cj4g
PiArICAgICAgIGlmICh2cS0+ZG9fdW5tYXApIHsKPiA+ICAgICAgICAgICAgICAgICB2cS0+cGFj
a2VkLmRlc2NfZXh0cmFbaWRdLmFkZHIgPSBhZGRyOwo+ID4gICAgICAgICAgICAgICAgIHZxLT5w
YWNrZWQuZGVzY19leHRyYVtpZF0ubGVuID0gdG90YWxfc2cgKgo+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzaXplb2Yoc3RydWN0IHZyaW5nX3BhY2tlZF9kZXNjKTsKPiA+IEBA
IC0xNDcwLDcgKzE0ODEsNyBAQCBzdGF0aWMgaW5saW5lIGludCB2aXJ0cXVldWVfYWRkX3BhY2tl
ZChzdHJ1Y3QgdmlydHF1ZXVlICpfdnEsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICBkZXNj
W2ldLmxlbiA9IGNwdV90b19sZTMyKHNnLT5sZW5ndGgpOwo+ID4gICAgICAgICAgICAgICAgICAg
ICAgICAgZGVzY1tpXS5pZCA9IGNwdV90b19sZTE2KGlkKTsKPiA+Cj4gPiAtICAgICAgICAgICAg
ICAgICAgICAgICBpZiAodW5saWtlbHkodnEtPnVzZV9kbWFfYXBpKSkgewo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KHZxLT5kb191bm1hcCkpIHsKPiA+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdnEtPnBhY2tlZC5kZXNjX2V4dHJhW2N1cnJdLmFkZHIg
PSBhZGRyOwo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2cS0+cGFja2VkLmRl
c2NfZXh0cmFbY3Vycl0ubGVuID0gc2ctPmxlbmd0aDsKPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdnEtPnBhY2tlZC5kZXNjX2V4dHJhW2N1cnJdLmZsYWdzID0KPiA+IEBAIC0x
NjA0LDcgKzE2MTUsNyBAQCBzdGF0aWMgdm9pZCBkZXRhY2hfYnVmX3BhY2tlZChzdHJ1Y3QgdnJp
bmdfdmlydHF1ZXVlICp2cSwKPiA+ICAgICAgICAgdnEtPmZyZWVfaGVhZCA9IGlkOwo+ID4gICAg
ICAgICB2cS0+dnEubnVtX2ZyZWUgKz0gc3RhdGUtPm51bTsKPiA+Cj4gPiAtICAgICAgIGlmICh1
bmxpa2VseSh2cS0+dXNlX2RtYV9hcGkpKSB7Cj4gPiArICAgICAgIGlmICh1bmxpa2VseSh2cS0+
ZG9fdW5tYXApKSB7Cj4gPiAgICAgICAgICAgICAgICAgY3VyciA9IGlkOwo+ID4gICAgICAgICAg
ICAgICAgIGZvciAoaSA9IDA7IGkgPCBzdGF0ZS0+bnVtOyBpKyspIHsKPiA+ICAgICAgICAgICAg
ICAgICAgICAgICAgIHZyaW5nX3VubWFwX2V4dHJhX3BhY2tlZCh2cSwKPiA+IEBAIC0xNjIxLDcg
KzE2MzIsNyBAQCBzdGF0aWMgdm9pZCBkZXRhY2hfYnVmX3BhY2tlZChzdHJ1Y3QgdnJpbmdfdmly
dHF1ZXVlICp2cSwKPiA+ICAgICAgICAgICAgICAgICBpZiAoIWRlc2MpCj4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICByZXR1cm47Cj4gPgo+ID4gLSAgICAgICAgICAgICAgIGlmICh2cS0+dXNl
X2RtYV9hcGkpIHsKPiA+ICsgICAgICAgICAgICAgICBpZiAodnEtPmRvX3VubWFwKSB7Cj4gPiAg
ICAgICAgICAgICAgICAgICAgICAgICBsZW4gPSB2cS0+cGFja2VkLmRlc2NfZXh0cmFbaWRdLmxl
bjsKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW4gLyBzaXpl
b2Yoc3RydWN0IHZyaW5nX3BhY2tlZF9kZXNjKTsKPiA+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpKyspCj4gPiBAQCAtMjA4MCw2ICsyMDkxLDcgQEAgc3RhdGljIHN0
cnVjdCB2aXJ0cXVldWUgKnZyaW5nX2NyZWF0ZV92aXJ0cXVldWVfcGFja2VkKAo+ID4gICAgICAg
ICB2cS0+ZG1hX2RldiA9IGRtYV9kZXY7Cj4gPiAgICAgICAgIHZxLT51c2VfZG1hX2FwaSA9IHZy
aW5nX3VzZV9kbWFfYXBpKHZkZXYpOwo+ID4gICAgICAgICB2cS0+cHJlbWFwcGVkID0gZmFsc2U7
Cj4gPiArICAgICAgIHZxLT5kb191bm1hcCA9IHZxLT51c2VfZG1hX2FwaTsKPiA+Cj4gPiAgICAg
ICAgIHZxLT5pbmRpcmVjdCA9IHZpcnRpb19oYXNfZmVhdHVyZSh2ZGV2LCBWSVJUSU9fUklOR19G
X0lORElSRUNUX0RFU0MpICYmCj4gPiAgICAgICAgICAgICAgICAgIWNvbnRleHQ7Cj4gPiBAQCAt
MjU4Nyw2ICsyNTk5LDcgQEAgc3RhdGljIHN0cnVjdCB2aXJ0cXVldWUgKl9fdnJpbmdfbmV3X3Zp
cnRxdWV1ZSh1bnNpZ25lZCBpbnQgaW5kZXgsCj4gPiAgICAgICAgIHZxLT5kbWFfZGV2ID0gZG1h
X2RldjsKPiA+ICAgICAgICAgdnEtPnVzZV9kbWFfYXBpID0gdnJpbmdfdXNlX2RtYV9hcGkodmRl
dik7Cj4gPiAgICAgICAgIHZxLT5wcmVtYXBwZWQgPSBmYWxzZTsKPiA+ICsgICAgICAgdnEtPmRv
X3VubWFwID0gdnEtPnVzZV9kbWFfYXBpOwo+ID4KPiA+ICAgICAgICAgdnEtPmluZGlyZWN0ID0g
dmlydGlvX2hhc19mZWF0dXJlKHZkZXYsIFZJUlRJT19SSU5HX0ZfSU5ESVJFQ1RfREVTQykgJiYK
PiA+ICAgICAgICAgICAgICAgICAhY29udGV4dDsKPiA+IEBAIC0yNzY1LDYgKzI3NzgsNyBAQCBp
bnQgdmlydHF1ZXVlX3NldF9wcmVtYXBwZWQoc3RydWN0IHZpcnRxdWV1ZSAqX3ZxKQo+ID4gICAg
ICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ID4KPiA+ICAgICAgICAgdnEtPnByZW1hcHBl
ZCA9IHRydWU7Cj4gPiArICAgICAgIHZxLT5kb191bm1hcCA9IGZhbHNlOwo+ID4KPiA+ICAgICAg
ICAgcmV0dXJuIDA7Cj4gPiAgfQo+ID4gLS0KPiA+IDIuMzIuMC4zLmcwMTE5NWNmOWYKPiA+Cj4K
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6
YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24u
b3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3Zp
cnR1YWxpemF0aW9u
