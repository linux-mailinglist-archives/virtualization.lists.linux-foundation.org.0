Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp4.osuosl.org (smtp4.osuosl.org [IPv6:2605:bc80:3010::137])
	by mail.lfdr.de (Postfix) with ESMTPS id 05F4E707CBB
	for <lists.virtualization@lfdr.de>; Thu, 18 May 2023 11:24:42 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp4.osuosl.org (Postfix) with ESMTP id 4767C410D5;
	Thu, 18 May 2023 09:24:40 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 4767C410D5
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
	by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id XOq6-arasXV9; Thu, 18 May 2023 09:24:38 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp4.osuosl.org (Postfix) with ESMTPS id 53ED5415DB;
	Thu, 18 May 2023 09:24:38 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 53ED5415DB
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 978DAC002A;
	Thu, 18 May 2023 09:24:37 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp3.osuosl.org (smtp3.osuosl.org [IPv6:2605:bc80:3010::136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 94501C002A
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 09:24:35 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp3.osuosl.org (Postfix) with ESMTP id 6F55B60F9A
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 09:24:35 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp3.osuosl.org 6F55B60F9A
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp3.osuosl.org ([127.0.0.1])
 by localhost (smtp3.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id duTN6oEdMWo3
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 09:24:34 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp3.osuosl.org 496F460F99
Received: from out30-112.freemail.mail.aliyun.com
 (out30-112.freemail.mail.aliyun.com [115.124.30.112])
 by smtp3.osuosl.org (Postfix) with ESMTPS id 496F460F99
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 09:24:32 +0000 (UTC)
X-Alimail-AntiSpam: AC=PASS; BC=-1|-1; BR=01201311R911e4; CH=green; DM=||false|;
 DS=||; FP=0|-1|-1|-1|0|-1|-1|-1; HT=ay29a033018045192;
 MF=xuanzhuo@linux.alibaba.com; NM=1; PH=DS; RN=4; SR=0;
 TI=SMTPD_---0ViwEMcC_1684401867; 
Received: from localhost(mailfrom:xuanzhuo@linux.alibaba.com
 fp:SMTPD_---0ViwEMcC_1684401867) by smtp.aliyun-inc.com;
 Thu, 18 May 2023 17:24:28 +0800
Message-ID: <1684401845.146663-1-xuanzhuo@linux.alibaba.com>
Subject: Re: [PATCH vhost v9 05/12] virtio_ring: split: virtqueue_add_split()
 support premapped
Date: Thu, 18 May 2023 17:24:05 +0800
From: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
To: "Michael S. Tsirkin" <mst@redhat.com>
References: <20230517022249.20790-1-xuanzhuo@linux.alibaba.com>
 <20230517022249.20790-6-xuanzhuo@linux.alibaba.com>
 <CACGkMEu7+kDPiWmULXW_saW6pb5yF=gnqXRkSWcYbZCiJmszHQ@mail.gmail.com>
 <20230518030701-mutt-send-email-mst@kernel.org>
In-Reply-To: <20230518030701-mutt-send-email-mst@kernel.org>
Cc: Christoph Hellwig <hch@infradead.org>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gVGh1LCAxOCBNYXkgMjAyMyAwMzoxMToyNSAtMDQwMCwgIk1pY2hhZWwgUy4gVHNpcmtpbiIg
PG1zdEByZWRoYXQuY29tPiB3cm90ZToKPiBPbiBUaHUsIE1heSAxOCwgMjAyMyBhdCAwMjo1MTo1
N1BNICswODAwLCBKYXNvbiBXYW5nIHdyb3RlOgo+ID4gT24gV2VkLCBNYXkgMTcsIDIwMjMgYXQg
MTA6MjPigK9BTSBYdWFuIFpodW8gPHh1YW56aHVvQGxpbnV4LmFsaWJhYmEuY29tPiB3cm90ZToK
PiA+ID4KPiA+ID4gdmlydHF1ZXVlX2FkZF9zcGxpdCgpIG9ubHkgc3VwcG9ydHMgdmlydHVhbCBh
ZGRyZXNzZXMsIGRtYSBpcyBjb21wbGV0ZWQKPiA+ID4gaW4gdmlydHF1ZXVlX2FkZF9zcGxpdCgp
Lgo+ID4gPgo+ID4gPiBJbiBzb21lIHNjZW5hcmlvcyAoc3VjaCBhcyB0aGUgQUZfWERQIHNjZW5h
cmlvKSwgdGhlIG1lbW9yeSBpcyBhbGxvY2F0ZWQKPiA+ID4gYW5kIERNQSBpcyBjb21wbGV0ZWQg
aW4gYWR2YW5jZSwgc28gaXQgaXMgbmVjZXNzYXJ5IGZvciB1cyB0byBzdXBwb3J0Cj4gPiA+IHBh
c3NpbmcgdGhlIERNQSBhZGRyZXNzIHRvIHZpcnRxdWV1ZV9hZGRfc3BsaXQoKS4KPiA+ID4KPiA+
ID4gUmVjb3JkIHRoaXMgaW5mb3JtYXRpb24gaW4gZGVzY19zdGF0ZSwgd2UgY2FuIHNraXAgdW5t
YXAgYmFzZWQgb24gdGhpcwo+ID4gPiB3aGVuIGV4ZWN1dGluZyBkbWEgdW5tYXAuCj4gPgo+ID4g
SSB3b3VsZCBhbHNvIHN1Z2dlc3QgZG9jdW1lbnRpbmcgd2h5IGEgcGVyIGRlc2NyaXB0b3IgbWV0
YWRhdGEgaXMKPiA+IG5lZWRlZCBpbnN0ZWFkIG9mIGEgcGVyIHZpcnRxdWV1ZSBvbmUuCj4KPiBJ
IHRoaW5rIHdlIGNvdWxkIG1ha2UgaXQgcGVyIHZpcnRxdWV1ZS4gVGhhdCB3b3VsZCBtZWFuIGFs
bCBjb2RlIGluCj4gdmlydGlvIG5ldCB3b3VsZCBoYXZlIHRvIGNoYW5nZSB0byBkbyBkbWEgbWFw
cGluZyBpdHNlbGYgaW5zdGVhZCBvZgo+IHJlbHlpbmcgb24gdmlydGlvIGNvcmUgdGhvdWdoLiAg
V2hpY2ggaXMgbWF5YmUgYSBnb29kIGlkZWE/IERlZmluaXRlbHkgYQo+IHZlcnkgaW50cnVzaXZl
IGNoYW5nZSB0aG91Z2gsIHdpbGwgbmVlZCBhIGxvdCBvZiBwZXJmb3JtYW5jZSB0ZXN0aW5nCj4g
dG8gbWFrZSBzdXJlIHdlIGRvbid0IGJyZWFrIGFueXRoaW5nLgoKV2UgY2FuIGRvIHRoaXMsIHZp
cnRpby1uZXQgZG9lcyBub3QgaGF2ZSB0byB1c2UgcHJlbWFwcGVkIGJ5IGRlZmF1bHQsIHdlIGNh
bgpzd2l0Y2ggd2hlbiB2cSByZXNldC4gVGhpcyBpcyBvayBmb3IgYWYteGRwCgpUaGFua3MuCgoK
Pgo+Cj4KPgo+ID4gPgo+ID4gPiBTaWduZWQtb2ZmLWJ5OiBYdWFuIFpodW8gPHh1YW56aHVvQGxp
bnV4LmFsaWJhYmEuY29tPgo+ID4gPiAtLS0KPiA+ID4gIGRyaXZlcnMvdmlydGlvL3ZpcnRpb19y
aW5nLmMgfCAzOCArKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0KPiA+ID4gIDEg
ZmlsZSBjaGFuZ2VkLCAyOSBpbnNlcnRpb25zKCspLCA5IGRlbGV0aW9ucygtKQo+ID4gPgo+ID4g
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy92aXJ0aW8vdmlydGlvX3JpbmcuYyBiL2RyaXZlcnMvdmly
dGlvL3ZpcnRpb19yaW5nLmMKPiA+ID4gaW5kZXggZTJmYzUwYzA1YmVjLi5iZDVlODRhZmFiMzcg
MTAwNjQ0Cj4gPiA+IC0tLSBhL2RyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5nLmMKPiA+ID4gKysr
IGIvZHJpdmVycy92aXJ0aW8vdmlydGlvX3JpbmcuYwo+ID4gPiBAQCAtNzAsNiArNzAsNyBAQAo+
ID4gPiAgc3RydWN0IHZyaW5nX2Rlc2Nfc3RhdGVfc3BsaXQgewo+ID4gPiAgICAgICAgIHZvaWQg
KmRhdGE7ICAgICAgICAgICAgICAgICAgICAgLyogRGF0YSBmb3IgY2FsbGJhY2suICovCj4gPiA+
ICAgICAgICAgc3RydWN0IHZyaW5nX2Rlc2MgKmluZGlyX2Rlc2M7ICAvKiBJbmRpcmVjdCBkZXNj
cmlwdG9yLCBpZiBhbnkuICovCj4gPiA+ICsgICAgICAgYm9vbCBwcmVtYXBwZWQ7ICAgICAgICAg
ICAgICAgICAvKiBETUEgbWFwcGluZyBpcyBkb25lIGJ5IGRyaXZlci4gKi8KPiA+Cj4gPiBHb2lu
ZyBiYWNrIHRvIHRoZSBvcmlnaW5hbCBkaXNjdXNzaW9uIGFyb3VuZCB3aGVyZSB0aGlzIHNob3Vs
ZCBiZQo+ID4gcGxhY2VkLiBJIHdvbmRlciBpZiB3ZSBjYW4gZmluZCBhIGNvbW1vbiBwbGFjZSB0
byBzdG9yZSB0aGlzIHNpbmNlIGl0Cj4gPiBoYXMgbm90aGluZyByZWxhdGVkIHRvIHZpcnRxdWV1
ZSBsYXlvdXQuIE1heWJlIGRlc2NfZXh0cmE/IEFuZCBpdAo+ID4gd291bGQgYmUgZXZlbiBiZXR0
ZXIgaWYgd2UgY2FuIGF2b2lkIHN0cmVzc2luZyB0aGUgY2FjaGUgbGlrZSBhYm92ZS4KPiA+Cj4g
PiA+ICB9Owo+ID4gPgo+ID4gPiAgc3RydWN0IHZyaW5nX2Rlc2Nfc3RhdGVfcGFja2VkIHsKPiA+
ID4gQEAgLTM1Niw4ICszNTcsMTQgQEAgc3RhdGljIHN0cnVjdCBkZXZpY2UgKnZyaW5nX2RtYV9k
ZXYoY29uc3Qgc3RydWN0IHZyaW5nX3ZpcnRxdWV1ZSAqdnEpCj4gPiA+Cj4gPiA+ICAvKiBNYXAg
b25lIHNnIGVudHJ5LiAqLwo+ID4gPiAgc3RhdGljIGludCB2cmluZ19tYXBfb25lX3NnKGNvbnN0
IHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLCBzdHJ1Y3Qgc2NhdHRlcmxpc3QgKnNnLAo+ID4g
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGly
ZWN0aW9uLCBzdGF0aWMgZG1hX2FkZHJfdCAqYWRkcikKPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGVudW0gZG1hX2RhdGFfZGlyZWN0aW9uIGRpcmVjdGlvbiwKPiA+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGJvb2wgcHJlbWFwcGVkLCBkbWFfYWRkcl90ICphZGRyKQo+
ID4KPiA+IGhhdmluZyB0aGluZ3MgbGlrZToKPiA+Cj4gPiBpbnQgZnVuYyhib29sIGRvKQo+ID4g
ewo+ID4gaWYgKCFkbykKPiA+ICAgICByZXR1cm47Cj4gPiB9Cj4gPgo+ID4gaXMgYSBoaW50IHRo
YXQgdGhlIGNoZWNrIG5lZWRzIHRvIGJlIGRvbmUgYnkgdGhlIGNhbGxlcj8KPiA+Cj4gPiBBbmQg
dGhpcyBjaGFuZ2Ugc2hvdWxkIHdvcmsgZm9yIGJvdGggcGFja2VkIGFuZCBzcGxpdC4gSSB0aGlu
ayB3ZSBuZWVkCj4gPiB0byBzcXVhc2ggdGhlIHBhY2tlZCBjaGFuZ2VzIGhlcmUuCj4gPgo+ID4g
TG9va2luZyBhdCBob3cgcGFja2VkIHZpcnRxdWV1ZSB1c2VzIHRoaXMgaW4gdGhpcyBwYXRjaCwg
SSBkb24ndCB0aGluawo+ID4gdGhpcyBwYXRjaCBjYW4gZXZlbiBiZSBidWlsdC4gSSB3aWxsIHdh
aXQgZm9yIGEgbmV3IHZlcnNpb24gYW5kCj4gPiBjb250aW51ZSB0aGUgcmV2aWV3IGZyb20gdGhl
cmUuCj4gPgo+ID4gVGhhbmtzCj4gPgo+ID4KPiA+Cj4gPiA+ICB7Cj4gPiA+ICsgICAgICAgaWYg
KHByZW1hcHBlZCkgewo+ID4gPiArICAgICAgICAgICAgICAgKmFkZHIgPSBzZ19kbWFfYWRkcmVz
cyhzZyk7Cj4gPiA+ICsgICAgICAgICAgICAgICByZXR1cm4gMDsKPiA+ID4gKyAgICAgICB9Cj4g
PiA+ICsKPiA+ID4gICAgICAgICBpZiAoIXZxLT51c2VfZG1hX2FwaSkgewo+ID4gPiAgICAgICAg
ICAgICAgICAgLyoKPiA+ID4gICAgICAgICAgICAgICAgICAqIElmIERNQSBpcyBub3QgdXNlZCwg
S01TQU4gZG9lc24ndCBrbm93IHRoYXQgdGhlIHNjYXR0ZXJsaXN0Cj4gPiA+IEBAIC00NDUsNyAr
NDUyLDcgQEAgc3RhdGljIHZvaWQgdnJpbmdfdW5tYXBfb25lX3NwbGl0X2luZGlyZWN0KGNvbnN0
IHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLAo+ID4gPiAgfQo+ID4gPgo+ID4gPiAgc3RhdGlj
IHVuc2lnbmVkIGludCB2cmluZ191bm1hcF9vbmVfc3BsaXQoY29uc3Qgc3RydWN0IHZyaW5nX3Zp
cnRxdWV1ZSAqdnEsCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVuc2lnbmVkIGludCBpKQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1bnNpZ25lZCBpbnQgaSwgYm9vbCBwcmVtYXBwZWQpCj4gPiA+ICB7Cj4gPiA+
ICAgICAgICAgc3RydWN0IHZyaW5nX2Rlc2NfZXh0cmEgKmV4dHJhID0gdnEtPnNwbGl0LmRlc2Nf
ZXh0cmE7Cj4gPiA+ICAgICAgICAgdTE2IGZsYWdzOwo+ID4gPiBAQCAtNDYyLDYgKzQ2OSw5IEBA
IHN0YXRpYyB1bnNpZ25lZCBpbnQgdnJpbmdfdW5tYXBfb25lX3NwbGl0KGNvbnN0IHN0cnVjdCB2
cmluZ192aXJ0cXVldWUgKnZxLAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAoZmxhZ3MgJiBWUklOR19ERVNDX0ZfV1JJVEUpID8KPiA+ID4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgRE1BX0ZST01fREVWSUNFIDogRE1BX1RPX0RFVklDRSk7Cj4gPiA+ICAg
ICAgICAgfSBlbHNlIHsKPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChwcmVtYXBwZWQpCj4gPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0Owo+ID4gPiArCj4gPiA+ICAgICAgICAg
ICAgICAgICBkbWFfdW5tYXBfcGFnZSh2cmluZ19kbWFfZGV2KHZxKSwKPiA+ID4gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGV4dHJhW2ldLmFkZHIsCj4gPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBleHRyYVtpXS5sZW4sCj4gPiA+IEBAIC01MzIsNiArNTQyLDcgQEAg
c3RhdGljIGlubGluZSBpbnQgdmlydHF1ZXVlX2FkZF9zcGxpdChzdHJ1Y3QgdmlydHF1ZXVlICpf
dnEsCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQg
aW50IGluX3NncywKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2
b2lkICpkYXRhLAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZv
aWQgKmN0eCwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29s
IHByZW1hcHBlZCwKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
ZnBfdCBnZnApCj4gPiA+ICB7Cj4gPiA+ICAgICAgICAgc3RydWN0IHZyaW5nX3ZpcnRxdWV1ZSAq
dnEgPSB0b192dnEoX3ZxKTsKPiA+ID4gQEAgLTU5NSw3ICs2MDYsNyBAQCBzdGF0aWMgaW5saW5l
IGludCB2aXJ0cXVldWVfYWRkX3NwbGl0KHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ID4gICAg
ICAgICAgICAgICAgIGZvciAoc2cgPSBzZ3Nbbl07IHNnOyBzZyA9IHNnX25leHQoc2cpKSB7Cj4g
PiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGRtYV9hZGRyX3QgYWRkcjsKPiA+ID4KPiA+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZyaW5nX21hcF9vbmVfc2codnEsIHNnLCBETUFf
VE9fREVWSUNFLCAmYWRkcikpCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmICh2cmlu
Z19tYXBfb25lX3NnKHZxLCBzZywgRE1BX1RPX0RFVklDRSwgcHJlbWFwcGVkLCAmYWRkcikpCj4g
PiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byB1bm1hcF9yZWxlYXNlOwo+
ID4gPgo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2ID0gaTsKPiA+ID4gQEAgLTYx
MSw3ICs2MjIsNyBAQCBzdGF0aWMgaW5saW5lIGludCB2aXJ0cXVldWVfYWRkX3NwbGl0KHN0cnVj
dCB2aXJ0cXVldWUgKl92cSwKPiA+ID4gICAgICAgICAgICAgICAgIGZvciAoc2cgPSBzZ3Nbbl07
IHNnOyBzZyA9IHNnX25leHQoc2cpKSB7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGRt
YV9hZGRyX3QgYWRkcjsKPiA+ID4KPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZy
aW5nX21hcF9vbmVfc2codnEsIHNnLCBETUFfRlJPTV9ERVZJQ0UsICZhZGRyKSkKPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKHZyaW5nX21hcF9vbmVfc2codnEsIHNnLCBETUFfRlJP
TV9ERVZJQ0UsIHByZW1hcHBlZCwgJmFkZHIpKQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGdvdG8gdW5tYXBfcmVsZWFzZTsKPiA+ID4KPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgcHJldiA9IGk7Cj4gPiA+IEBAIC02NTcsNiArNjY4LDcgQEAgc3RhdGljIGlubGlu
ZSBpbnQgdmlydHF1ZXVlX2FkZF9zcGxpdChzdHJ1Y3QgdmlydHF1ZXVlICpfdnEsCj4gPiA+Cj4g
PiA+ICAgICAgICAgLyogU3RvcmUgdG9rZW4gYW5kIGluZGlyZWN0IGJ1ZmZlciBzdGF0ZS4gKi8K
PiA+ID4gICAgICAgICB2cS0+c3BsaXQuZGVzY19zdGF0ZVtoZWFkXS5kYXRhID0gZGF0YTsKPiA+
ID4gKyAgICAgICB2cS0+c3BsaXQuZGVzY19zdGF0ZVtoZWFkXS5wcmVtYXBwZWQgPSBwcmVtYXBw
ZWQ7Cj4gPiA+ICAgICAgICAgaWYgKGluZGlyZWN0KQo+ID4gPiAgICAgICAgICAgICAgICAgdnEt
PnNwbGl0LmRlc2Nfc3RhdGVbaGVhZF0uaW5kaXJfZGVzYyA9IGRlc2M7Cj4gPiA+ICAgICAgICAg
ZWxzZQo+ID4gPiBAQCAtNjg2LDYgKzY5OCwxNCBAQCBzdGF0aWMgaW5saW5lIGludCB2aXJ0cXVl
dWVfYWRkX3NwbGl0KHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ID4gICAgICAgICByZXR1cm4g
MDsKPiA+ID4KPiA+ID4gIHVubWFwX3JlbGVhc2U6Cj4gPiA+ICsgICAgICAgaWYgKHByZW1hcHBl
ZCkgewo+ID4gPiArICAgICAgICAgICAgICAgaWYgKGluZGlyZWN0KQo+ID4gPiArICAgICAgICAg
ICAgICAgICAgICAgICBrZnJlZShkZXNjKTsKPiA+ID4gKwo+ID4gPiArICAgICAgICAgICAgICAg
RU5EX1VTRSh2cSk7Cj4gPiA+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiA+ID4g
KyAgICAgICB9Cj4gPiA+ICsKPiA+ID4gICAgICAgICBlcnJfaWR4ID0gaTsKPiA+ID4KPiA+ID4g
ICAgICAgICBpZiAoaW5kaXJlY3QpCj4gPiA+IEBAIC03MDAsNyArNzIwLDcgQEAgc3RhdGljIGlu
bGluZSBpbnQgdmlydHF1ZXVlX2FkZF9zcGxpdChzdHJ1Y3QgdmlydHF1ZXVlICpfdnEsCj4gPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgIHZyaW5nX3VubWFwX29uZV9zcGxpdF9pbmRpcmVjdCh2
cSwgJmRlc2NbaV0pOwo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBpID0gdmlydGlvMTZf
dG9fY3B1KF92cS0+dmRldiwgZGVzY1tpXS5uZXh0KTsKPiA+ID4gICAgICAgICAgICAgICAgIH0g
ZWxzZQo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBpID0gdnJpbmdfdW5tYXBfb25lX3Nw
bGl0KHZxLCBpKTsKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgaSA9IHZyaW5nX3VubWFw
X29uZV9zcGxpdCh2cSwgaSwgZmFsc2UpOwo+ID4gPiAgICAgICAgIH0KPiA+ID4KPiA+ID4gICAg
ICAgICBpZiAoaW5kaXJlY3QpCj4gPiA+IEBAIC03NTcsMTIgKzc3NywxMiBAQCBzdGF0aWMgdm9p
ZCBkZXRhY2hfYnVmX3NwbGl0KHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLCB1bnNpZ25lZCBp
bnQgaGVhZCwKPiA+ID4gICAgICAgICBpID0gaGVhZDsKPiA+ID4KPiA+ID4gICAgICAgICB3aGls
ZSAodnEtPnNwbGl0LnZyaW5nLmRlc2NbaV0uZmxhZ3MgJiBuZXh0ZmxhZykgewo+ID4gPiAtICAg
ICAgICAgICAgICAgdnJpbmdfdW5tYXBfb25lX3NwbGl0KHZxLCBpKTsKPiA+ID4gKyAgICAgICAg
ICAgICAgIHZyaW5nX3VubWFwX29uZV9zcGxpdCh2cSwgaSwgc3RhdGUtPnByZW1hcHBlZCk7Cj4g
PiA+ICAgICAgICAgICAgICAgICBpID0gdnEtPnNwbGl0LmRlc2NfZXh0cmFbaV0ubmV4dDsKPiA+
ID4gICAgICAgICAgICAgICAgIHZxLT52cS5udW1fZnJlZSsrOwo+ID4gPiAgICAgICAgIH0KPiA+
ID4KPiA+ID4gLSAgICAgICB2cmluZ191bm1hcF9vbmVfc3BsaXQodnEsIGkpOwo+ID4gPiArICAg
ICAgIHZyaW5nX3VubWFwX29uZV9zcGxpdCh2cSwgaSwgc3RhdGUtPnByZW1hcHBlZCk7Cj4gPiA+
ICAgICAgICAgdnEtPnNwbGl0LmRlc2NfZXh0cmFbaV0ubmV4dCA9IHZxLT5mcmVlX2hlYWQ7Cj4g
PiA+ICAgICAgICAgdnEtPmZyZWVfaGVhZCA9IGhlYWQ7Cj4gPiA+Cj4gPiA+IEBAIC03ODMsNyAr
ODAzLDcgQEAgc3RhdGljIHZvaWQgZGV0YWNoX2J1Zl9zcGxpdChzdHJ1Y3QgdnJpbmdfdmlydHF1
ZXVlICp2cSwgdW5zaWduZWQgaW50IGhlYWQsCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgVlJJTkdfREVTQ19GX0lORElSRUNUKSk7Cj4gPiA+ICAgICAgICAgICAgICAgICBC
VUdfT04obGVuID09IDAgfHwgbGVuICUgc2l6ZW9mKHN0cnVjdCB2cmluZ19kZXNjKSk7Cj4gPiA+
Cj4gPiA+IC0gICAgICAgICAgICAgICBpZiAodnEtPnVzZV9kbWFfYXBpKSB7Cj4gPiA+ICsgICAg
ICAgICAgICAgICBpZiAodnEtPnVzZV9kbWFfYXBpICYmICFzdGF0ZS0+cHJlbWFwcGVkKSB7Cj4g
PiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBsZW4gLyBzaXplb2Yo
c3RydWN0IHZyaW5nX2Rlc2MpOyBqKyspCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdnJpbmdfdW5tYXBfb25lX3NwbGl0X2luZGlyZWN0KHZxLCAmaW5kaXJfZGVzY1tqXSk7
Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+IEBAIC0yMTQzLDcgKzIxNjMsNyBAQCBzdGF0
aWMgaW5saW5lIGludCB2aXJ0cXVldWVfYWRkKHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ID4g
ICAgICAgICByZXR1cm4gdnEtPnBhY2tlZF9yaW5nID8gdmlydHF1ZXVlX2FkZF9wYWNrZWQoX3Zx
LCBzZ3MsIHRvdGFsX3NnLAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgb3V0X3NncywgaW5fc2dzLCBkYXRhLCBjdHgsIGdmcCkgOgo+ID4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB2aXJ0cXVldWVfYWRkX3NwbGl0KF92cSwgc2dzLCB0b3Rh
bF9zZywKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dF9z
Z3MsIGluX3NncywgZGF0YSwgY3R4LCBnZnApOwo+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgb3V0X3NncywgaW5fc2dzLCBkYXRhLCBjdHgsIHByZW1hcHBlZCwg
Z2ZwKTsKPiA+ID4gIH0KPiA+ID4KPiA+ID4gIC8qKgo+ID4gPiAtLQo+ID4gPiAyLjMyLjAuMy5n
MDExOTVjZjlmCj4gPiA+Cj4KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0aW9uQGxpc3Rz
LmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0aW9uLm9yZy9t
YWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
