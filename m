Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
	by mail.lfdr.de (Postfix) with ESMTPS id 32EF51978D8
	for <lists.virtualization@lfdr.de>; Mon, 30 Mar 2020 12:20:16 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by whitealder.osuosl.org (Postfix) with ESMTP id D205787A3D;
	Mon, 30 Mar 2020 10:20:14 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id mURViEcm3xUZ; Mon, 30 Mar 2020 10:20:10 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by whitealder.osuosl.org (Postfix) with ESMTP id 63B8987C25;
	Mon, 30 Mar 2020 10:20:08 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 4232BC07FF;
	Mon, 30 Mar 2020 10:20:08 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id A1FA0C1D8E
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:55 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by silver.osuosl.org (Postfix) with ESMTP id 926AA23244
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:55 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id shs+y7UVnBBO
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:53 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by silver.osuosl.org (Postfix) with ESMTPS id AFB94230F6
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:52 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 1C831305FFB2; Mon, 30 Mar 2020 13:12:58 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id EFC39305B7A0;
 Mon, 30 Mar 2020 13:12:57 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v8 58/81] KVM: introspection: add KVMI_VCPU_SET_REGISTERS
Date: Mon, 30 Mar 2020 13:12:45 +0300
Message-Id: <20200330101308.21702-59-alazar@bitdefender.com>
In-Reply-To: <20200330101308.21702-1-alazar@bitdefender.com>
References: <20200330101308.21702-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Mircea=20C=C3=AErjaliu?= <mcirjaliu@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKRHVyaW5nIGFuIGlu
dHJvc3BlY3Rpb24gZXZlbnQsIHRoZSBpbnRyb3NwZWN0aW9uIHRvb2wgbWlnaHQgbmVlZCB0bwpj
aGFuZ2UgdGhlIHZDUFUgc3RhdGUsIGZvciBleGFtcGxlLCB0byBza2lwIHRoZSBjdXJyZW50IGlu
c3RydWN0aW9uLgoKVGhpcyBjb21tYW5kIGlzIGFsbG93ZWQgb25seSBkdXJpbmcgdkNQVSBldmVu
dHMgYW5kIHRoZSByZWdpc3RlcnMgd2lsbApiZSBzZXQgd2hlbiB0aGUgcmVwbHkgaGFzIGJlZW4g
cmVjZWl2ZWQuCgpTaWduZWQtb2ZmLWJ5OiBNaWhhaSBEb27Im3UgPG1kb250dUBiaXRkZWZlbmRl
ci5jb20+CkNvLWRldmVsb3BlZC1ieTogTWlyY2VhIEPDrnJqYWxpdSA8bWNpcmphbGl1QGJpdGRl
ZmVuZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogTWlyY2VhIEPDrnJqYWxpdSA8bWNpcmphbGl1QGJp
dGRlZmVuZGVyLmNvbT4KQ28tZGV2ZWxvcGVkLWJ5OiBBZGFsYmVydCBMYXrEg3IgPGFsYXphckBi
aXRkZWZlbmRlci5jb20+ClNpZ25lZC1vZmYtYnk6IEFkYWxiZXJ0IExhesSDciA8YWxhemFyQGJp
dGRlZmVuZGVyLmNvbT4KLS0tCiBEb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0ICAgICAg
ICAgICAgICAgfCAyOSArKysrKysrCiBpbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oICAgICAgICAg
ICAgICAgICAgICAgfCAgMyArCiBpbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oICAgICAgICAgICAg
ICAgICAgICAgfCAgMSArCiAuLi4vdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rl
c3QuYyAgfCA3OCArKysrKysrKysrKysrKysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2
bWkuYyAgICAgICAgICAgICAgICAgfCAyNCArKysrKysKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24v
a3ZtaV9pbnQuaCAgICAgICAgICAgICB8ICAzICsKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3Zt
aV9tc2cuYyAgICAgICAgICAgICB8IDE1ICsrKysKIDcgZmlsZXMgY2hhbmdlZCwgMTUzIGluc2Vy
dGlvbnMoKykKCmRpZmYgLS1naXQgYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0IGIv
RG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdAppbmRleCAwMDAwMDk5ZTgwMzguLjdkNmQ4
NWFhMTkxYSAxMDA2NDQKLS0tIGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdAorKysg
Yi9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CkBAIC02MDgsNiArNjA4LDM1IEBAIHJl
Z2lzdGVycywgdGhlIHNwZWNpYWwgcmVnaXN0ZXJzIGFuZCB0aGUgcmVxdWVzdGVkIHNldCBvZiBN
U1JzLgogKiAtS1ZNX0VBR0FJTiAtIHRoZSBzZWxlY3RlZCB2Q1BVIGNhbid0IGJlIGludHJvc3Bl
Y3RlZCB5ZXQKICogLUtWTV9FTk9NRU0gLSB0aGVyZSBpcyBub3QgZW5vdWdoIG1lbW9yeSB0byBh
bGxvY2F0ZSB0aGUgcmVwbHkKIAorMTIuIEtWTUlfVkNQVV9TRVRfUkVHSVNURVJTCistLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0KKworOkFyY2hpdGVjdHVyZXM6IHg4NgorOlZlcnNpb25zOiA+
PSAxCis6UGFyYW1ldGVyczoKKworOjoKKworCXN0cnVjdCBrdm1pX3ZjcHVfaGRyOworCXN0cnVj
dCBrdm1fcmVnczsKKworOlJldHVybnM6CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV9lcnJvcl9jb2Rl
CisKK1NldHMgdGhlIGdlbmVyYWwgcHVycG9zZSByZWdpc3RlcnMgZm9yIHRoZSBnaXZlbiB2Q1BV
LiBUaGUgY2hhbmdlcyBiZWNvbWUKK3Zpc2libGUgdG8gb3RoZXIgdGhyZWFkcyBhY2Nlc3Npbmcg
dGhlIEtWTSB2Q1BVIHN0cnVjdHVyZSBhZnRlciB0aGUgZXZlbnQKK2N1cnJlbnRseSBiZWluZyBo
YW5kbGVkIGlzIHJlcGxpZWQgdG8uCisKKzpFcnJvcnM6CisKKyogLUtWTV9FSU5WQUwgLSB0aGUg
c2VsZWN0ZWQgdkNQVSBpcyBpbnZhbGlkCisqIC1LVk1fRUlOVkFMIC0gdGhlIHBhZGRpbmcgaXMg
bm90IHplcm8KKyogLUtWTV9FQUdBSU4gLSB0aGUgc2VsZWN0ZWQgdkNQVSBjYW4ndCBiZSBpbnRy
b3NwZWN0ZWQgeWV0CisqIC1LVk1fRU9QTk9UU1VQUCAtIHRoZSBjb21tYW5kIGhhc24ndCBiZWVu
IHJlY2VpdmVkIGR1cmluZyBhbiBpbnRyb3NwZWN0aW9uIGV2ZW50CisKIEV2ZW50cwogPT09PT09
CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmggYi9pbmNsdWRlL2xpbnV4
L2t2bWlfaG9zdC5oCmluZGV4IDhlOGFiOWQ4MzZmZS4uZmUwNzFhOTI1MTBjIDEwMDY0NAotLS0g
YS9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oCisrKyBiL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0
LmgKQEAgLTM4LDYgKzM4LDkgQEAgc3RydWN0IGt2bV92Y3B1X2ludHJvc3BlY3Rpb24gewogCWJv
b2wgd2FpdGluZ19mb3JfcmVwbHk7CiAKIAlERUNMQVJFX0JJVE1BUChldl9lbmFibGVfbWFzaywg
S1ZNSV9OVU1fRVZFTlRTKTsKKworCXN0cnVjdCBrdm1fcmVncyBkZWxheWVkX3JlZ3M7CisJYm9v
bCBoYXZlX2RlbGF5ZWRfcmVnczsKIH07CiAKIHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiB7CmRp
ZmYgLS1naXQgYS9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oIGIvaW5jbHVkZS91YXBpL2xpbnV4
L2t2bWkuaAppbmRleCBjMzU0YzVlMTViZTEuLjc0NmY0MzNiODI2OSAxMDA2NDQKLS0tIGEvaW5j
bHVkZS91YXBpL2xpbnV4L2t2bWkuaAorKysgYi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oCkBA
IC0yOSw2ICsyOSw3IEBAIGVudW0gewogCUtWTUlfVkNQVV9QQVVTRSAgICAgICAgICA9IDEwLAog
CUtWTUlfVkNQVV9DT05UUk9MX0VWRU5UUyA9IDExLAogCUtWTUlfVkNQVV9HRVRfUkVHSVNURVJT
ICA9IDEyLAorCUtWTUlfVkNQVV9TRVRfUkVHSVNURVJTICA9IDEzLAogCiAJS1ZNSV9OVU1fTUVT
U0FHRVMKIH07CmRpZmYgLS1naXQgYS90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0
L2t2bWlfdGVzdC5jIGIvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rl
c3QuYwppbmRleCAyZmIxOTE3NDBjYWUuLjE4Y2NjNzk0YzZjYyAxMDA2NDQKLS0tIGEvdG9vbHMv
dGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYworKysgYi90b29scy90ZXN0
aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCkBAIC04MzIsNiArODMyLDgzIEBA
IHN0YXRpYyB2b2lkIHRlc3RfY21kX3ZjcHVfZ2V0X3JlZ2lzdGVycyhzdHJ1Y3Qga3ZtX3ZtICp2
bSkKIAlERUJVRygiZ2V0X3JlZ2lzdGVycyByaXAgMHglbGx4XG4iLCByZWdzLnJpcCk7CiB9CiAK
K3N0YXRpYyBpbnQgX19jbWRfc2V0X3JlZ2lzdGVycyhzdHJ1Y3Qga3ZtX3ZtICp2bSwKKwkJCSAg
ICAgICBzdHJ1Y3Qga3ZtX3JlZ3MgKnJlZ3MpCit7CisJc3RydWN0IHsKKwkJc3RydWN0IGt2bWlf
bXNnX2hkciBoZHI7CisJCXN0cnVjdCBrdm1pX3ZjcHVfaGRyIHZjcHVfaGRyOworCQlzdHJ1Y3Qg
a3ZtX3JlZ3MgcmVnczsKKwl9IHJlcSA9IHt9OworCV9fdTE2IHZjcHVfaW5kZXggPSAwOworCisJ
cmVxLnZjcHVfaGRyLnZjcHUgPSB2Y3B1X2luZGV4OworCisJbWVtY3B5KCZyZXEucmVncywgcmVn
cywgc2l6ZW9mKHJlcS5yZWdzKSk7CisKKwlyZXR1cm4gZG9fY29tbWFuZChLVk1JX1ZDUFVfU0VU
X1JFR0lTVEVSUywKKwkJCSAgJnJlcS5oZHIsIHNpemVvZihyZXEpLCBOVUxMLCAwKTsKK30KKwor
c3RhdGljIGludCBjbWRfc2V0X3JlZ2lzdGVycyhzdHJ1Y3Qga3ZtX3ZtICp2bSwKKwkJCSAgICAg
c3RydWN0IGt2bV9yZWdzICpyZWdzKQoreworCXN0cnVjdCB2Y3B1X3dvcmtlcl9kYXRhIGRhdGEg
PSB7LnZtID0gdm0sIC52Y3B1X2lkID0gVkNQVV9JRH07CisJcHRocmVhZF90IHZjcHVfdGhyZWFk
OworCWludCByOworCisJdmNwdV90aHJlYWQgPSBzdGFydF92Y3B1X3dvcmtlcigmZGF0YSk7CisK
KwlyID0gX19jbWRfc2V0X3JlZ2lzdGVycyh2bSwgcmVncyk7CisKKwlzdG9wX3ZjcHVfd29ya2Vy
KHZjcHVfdGhyZWFkLCAmZGF0YSk7CisKKwlyZXR1cm4gcjsKK30KKworc3RhdGljIHZvaWQgX19z
ZXRfcmVnaXN0ZXJzKHN0cnVjdCBrdm1fdm0gKnZtLAorCQkJICAgIHN0cnVjdCBrdm1fcmVncyAq
cmVncykKK3sKKwlpbnQgcjsKKworCXIgPSBfX2NtZF9zZXRfcmVnaXN0ZXJzKHZtLCByZWdzKTsK
KwlURVNUX0FTU0VSVChyID09IDAsCisJCSJLVk1JX1ZDUFVfU0VUX1JFR0lTVEVSUyBmYWlsZWQs
IGVycm9yICVkKCVzKVxuIiwKKwkJLXIsIGt2bV9zdHJlcnJvcigtcikpOworfQorCitzdGF0aWMg
dm9pZCB0ZXN0X2NtZF92Y3B1X3NldF9yZWdpc3RlcnMoc3RydWN0IGt2bV92bSAqdm0pCit7CisJ
c3RydWN0IHZjcHVfd29ya2VyX2RhdGEgZGF0YSA9IHsudm0gPSB2bSwgLnZjcHVfaWQgPSBWQ1BV
X0lEfTsKKwlfX3UxNiBldmVudF9pZCA9IEtWTUlfRVZFTlRfUEFVU0VfVkNQVTsKKwlzdHJ1Y3Qg
a3ZtaV9tc2dfaGRyIGhkcjsKKwlwdGhyZWFkX3QgdmNwdV90aHJlYWQ7CisJc3RydWN0IGt2bWlf
ZXZlbnQgZXY7CisJc3RydWN0IHZjcHVfcmVwbHkgcnBsID0ge307CisJc3RydWN0IGt2bV9yZWdz
IHJlZ3MgPSB7fTsKKwlpbnQgcjsKKworCWdldF92Y3B1X3JlZ2lzdGVycyh2bSwgJnJlZ3MpOwor
CisJciA9IGNtZF9zZXRfcmVnaXN0ZXJzKHZtLCAmcmVncyk7CisJVEVTVF9BU1NFUlQociA9PSAt
S1ZNX0VPUE5PVFNVUFAsCisJCSJLVk1JX1ZDUFVfU0VUX1JFR0lTVEVSUyBkaWRuJ3QgZmFpbGVk
IHdpdGggS1ZNX0VPUE5PVFNVUFAsIGVycm9yICVkKCVzKVxuIiwKKwkJLXIsIGt2bV9zdHJlcnJv
cigtcikpOworCisJcGF1c2VfdmNwdSh2bSk7CisKKwl2Y3B1X3RocmVhZCA9IHN0YXJ0X3ZjcHVf
d29ya2VyKCZkYXRhKTsKKworCXJlY2VpdmVfZXZlbnQoJmhkciwgJmV2LCBzaXplb2YoZXYpLCBl
dmVudF9pZCk7CisKKwlfX3NldF9yZWdpc3RlcnModm0sICZldi5hcmNoLnJlZ3MpOworCisJcmVw
bHlfdG9fZXZlbnQoJmhkciwgJmV2LCBLVk1JX0VWRU5UX0FDVElPTl9DT05USU5VRSwKKwkJCSZy
cGwsIHNpemVvZihycGwpKTsKKworCXN0b3BfdmNwdV93b3JrZXIodmNwdV90aHJlYWQsICZkYXRh
KTsKK30KKwogc3RhdGljIHZvaWQgdGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZt
KQogewogCXNyYW5kb20odGltZSgwKSk7CkBAIC04NTAsNiArOTI3LDcgQEAgc3RhdGljIHZvaWQg
dGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQogCXRlc3RfcGF1c2Uodm0pOwog
CXRlc3RfY21kX3ZjcHVfY29udHJvbF9ldmVudHModm0pOwogCXRlc3RfY21kX3ZjcHVfZ2V0X3Jl
Z2lzdGVycyh2bSk7CisJdGVzdF9jbWRfdmNwdV9zZXRfcmVnaXN0ZXJzKHZtKTsKIAogCXVuaG9v
a19pbnRyb3NwZWN0aW9uKHZtKTsKIH0KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rp
b24va3ZtaS5jIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKaW5kZXggOGQyOTJhNGJl
MjcwLi5kMTg5OGJmOGRhMWEgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3Zt
aS5jCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCkBAIC04MTUsMyArODE1LDI3
IEBAIGludCBrdm1pX2NtZF92Y3B1X3BhdXNlKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgYm9vbCB3
YWl0KQogCiAJcmV0dXJuIDA7CiB9CisKK2ludCBrdm1pX2NtZF92Y3B1X3NldF9yZWdpc3RlcnMo
c3RydWN0IGt2bV92Y3B1ICp2Y3B1LAorCQkJCWNvbnN0IHN0cnVjdCBrdm1fcmVncyAqcmVncykK
K3sKKwlzdHJ1Y3Qga3ZtX3ZjcHVfaW50cm9zcGVjdGlvbiAqdmNwdWkgPSBWQ1BVSSh2Y3B1KTsK
KworCWlmICghdmNwdWktPndhaXRpbmdfZm9yX3JlcGx5KQorCQlyZXR1cm4gLUtWTV9FT1BOT1RT
VVBQOworCisJbWVtY3B5KCZ2Y3B1aS0+ZGVsYXllZF9yZWdzLCByZWdzLCBzaXplb2YodmNwdWkt
PmRlbGF5ZWRfcmVncykpOworCXZjcHVpLT5oYXZlX2RlbGF5ZWRfcmVncyA9IHRydWU7CisKKwly
ZXR1cm4gMDsKK30KKwordm9pZCBrdm1pX3Bvc3RfcmVwbHkoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
KQoreworCXN0cnVjdCBrdm1fdmNwdV9pbnRyb3NwZWN0aW9uICp2Y3B1aSA9IFZDUFVJKHZjcHUp
OworCisJaWYgKHZjcHVpLT5oYXZlX2RlbGF5ZWRfcmVncykgeworCQlrdm1fYXJjaF92Y3B1X3Nl
dF9yZWdzKHZjcHUsICZ2Y3B1aS0+ZGVsYXllZF9yZWdzLCBmYWxzZSk7CisJCXZjcHVpLT5oYXZl
X2RlbGF5ZWRfcmVncyA9IGZhbHNlOworCX0KK30KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJv
c3BlY3Rpb24va3ZtaV9pbnQuaCBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaApp
bmRleCAzZTQ3MWUzYTc1NWQuLjBmNDQ4OTNiY2JkYyAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50
cm9zcGVjdGlvbi9rdm1pX2ludC5oCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9p
bnQuaApAQCAtMzksNiArMzksNyBAQCBpbnQga3ZtaV9hZGRfam9iKHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSwKIAkJIHZvaWQgKCpmY3QpKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdm9pZCAqY3R4KSwK
IAkJIHZvaWQgKmN0eCwgdm9pZCAoKmZyZWVfZmN0KSh2b2lkICpjdHgpKTsKIHZvaWQga3ZtaV9y
dW5fam9icyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwordm9pZCBrdm1pX3Bvc3RfcmVwbHkoc3Ry
dWN0IGt2bV92Y3B1ICp2Y3B1KTsKIGludCBrdm1pX2NtZF92bV9jb250cm9sX2V2ZW50cyhzdHJ1
Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWksCiAJCQkJdW5zaWduZWQgaW50IGV2ZW50X2lkLCBi
b29sIGVuYWJsZSk7CiBpbnQga3ZtaV9jbWRfdmNwdV9jb250cm9sX2V2ZW50cyhzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUsCkBAIC01MSw2ICs1Miw4IEBAIGludCBrdm1pX2NtZF9yZWFkX3BoeXNpY2Fs
KHN0cnVjdCBrdm0gKmt2bSwgdTY0IGdwYSwgc2l6ZV90IHNpemUsCiBpbnQga3ZtaV9jbWRfd3Jp
dGVfcGh5c2ljYWwoc3RydWN0IGt2bSAqa3ZtLCB1NjQgZ3BhLCBzaXplX3Qgc2l6ZSwKIAkJCSAg
ICBjb25zdCB2b2lkICpidWYpOwogaW50IGt2bWlfY21kX3ZjcHVfcGF1c2Uoc3RydWN0IGt2bV92
Y3B1ICp2Y3B1LCBib29sIHdhaXQpOworaW50IGt2bWlfY21kX3ZjcHVfc2V0X3JlZ2lzdGVycyhz
dHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCisJCQkJY29uc3Qgc3RydWN0IGt2bV9yZWdzICpyZWdzKTsK
IAogLyogYXJjaCAqLwogaW50IGt2bWlfYXJjaF9jbWRfdmNwdV9nZXRfaW5mbyhzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUsCmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNn
LmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKaW5kZXggZTMwZTFhZDVlNDQz
Li4zOGUxYWNkZjc0NGYgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9t
c2cuYworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKQEAgLTMyLDYgKzMy
LDcgQEAgc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IG1zZ19JRHNbXSA9IHsKIAlbS1ZNSV9WQ1BV
X0dFVF9JTkZPXSAgICAgICA9ICJLVk1JX1ZDUFVfR0VUX0lORk8iLAogCVtLVk1JX1ZDUFVfR0VU
X1JFR0lTVEVSU10gID0gIktWTUlfVkNQVV9HRVRfUkVHSVNURVJTIiwKIAlbS1ZNSV9WQ1BVX1BB
VVNFXSAgICAgICAgICA9ICJLVk1JX1ZDUFVfUEFVU0UiLAorCVtLVk1JX1ZDUFVfU0VUX1JFR0lT
VEVSU10gID0gIktWTUlfVkNQVV9TRVRfUkVHSVNURVJTIiwKIH07CiAKIHN0YXRpYyBjb25zdCBj
aGFyICppZDJzdHIodTE2IGlkKQpAQCAtNDg2LDYgKzQ4NywxOCBAQCBzdGF0aWMgaW50IGhhbmRs
ZV9nZXRfcmVnaXN0ZXJzKGNvbnN0IHN0cnVjdCBrdm1pX3ZjcHVfY21kX2pvYiAqam9iLAogCXJl
dHVybiBlcnI7CiB9CiAKK3N0YXRpYyBpbnQgaGFuZGxlX3NldF9yZWdpc3RlcnMoY29uc3Qgc3Ry
dWN0IGt2bWlfdmNwdV9jbWRfam9iICpqb2IsCisJCQkJY29uc3Qgc3RydWN0IGt2bWlfbXNnX2hk
ciAqbXNnLAorCQkJCWNvbnN0IHZvaWQgKl9yZXEpCit7CisJY29uc3Qgc3RydWN0IGt2bV9yZWdz
ICpyZWdzID0gX3JlcTsKKwlpbnQgZWM7CisKKwllYyA9IGt2bWlfY21kX3ZjcHVfc2V0X3JlZ2lz
dGVycyhqb2ItPnZjcHUsIHJlZ3MpOworCisJcmV0dXJuIGt2bWlfbXNnX3ZjcHVfcmVwbHkoam9i
LCBtc2csIGVjLCBOVUxMLCAwKTsKK30KKwogLyoKICAqIFRoZXNlIGNvbW1hbmRzIGFyZSBleGVj
dXRlZCBmcm9tIHRoZSB2Q1BVIHRocmVhZC4gVGhlIHJlY2VpdmluZyB0aHJlYWQKICAqIHBhc3Nl
cyB0aGUgbWVzc2FnZXMgdXNpbmcgYSBuZXdseSBhbGxvY2F0ZWQgJ3N0cnVjdCBrdm1pX3ZjcHVf
Y21kX2pvYicKQEAgLTQ5OCw2ICs1MTEsNyBAQCBzdGF0aWMgaW50KCpjb25zdCBtc2dfdmNwdVtd
KShjb25zdCBzdHJ1Y3Qga3ZtaV92Y3B1X2NtZF9qb2IgKiwKIAlbS1ZNSV9WQ1BVX0NPTlRST0xf
RVZFTlRTXSA9IGhhbmRsZV92Y3B1X2NvbnRyb2xfZXZlbnRzLAogCVtLVk1JX1ZDUFVfR0VUX0lO
Rk9dICAgICAgID0gaGFuZGxlX2dldF92Y3B1X2luZm8sCiAJW0tWTUlfVkNQVV9HRVRfUkVHSVNU
RVJTXSAgPSBoYW5kbGVfZ2V0X3JlZ2lzdGVycywKKwlbS1ZNSV9WQ1BVX1NFVF9SRUdJU1RFUlNd
ICA9IGhhbmRsZV9zZXRfcmVnaXN0ZXJzLAogfTsKIAogc3RhdGljIGJvb2wgaXNfdmNwdV9jb21t
YW5kKHUxNiBpZCkKQEAgLTc4Nyw2ICs4MDEsNyBAQCBzdGF0aWMgaW50IGt2bWlfc2VuZF9ldmVu
dChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHUzMiBldl9pZCwKIAlpZiAoZXJyKQogCQlnb3RvIG91
dDsKIAorCWt2bWlfcG9zdF9yZXBseSh2Y3B1KTsKIAkqYWN0aW9uID0gdmNwdWktPnJlcGx5LmFj
dGlvbjsKIAogb3V0OgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmlydHVhbGl6YXRpb25AbGlzdHMubGlu
dXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51eGZvdW5kYXRpb24ub3JnL21haWxt
YW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
