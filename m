Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp2.osuosl.org (smtp2.osuosl.org [140.211.166.133])
	by mail.lfdr.de (Postfix) with ESMTPS id C8C0F6AD7B0
	for <lists.virtualization@lfdr.de>; Tue,  7 Mar 2023 07:54:16 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by smtp2.osuosl.org (Postfix) with ESMTP id 6116C4010F;
	Tue,  7 Mar 2023 06:54:15 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 6116C4010F
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
	by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id btCJ3TDBSm2R; Tue,  7 Mar 2023 06:54:14 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by smtp2.osuosl.org (Postfix) with ESMTPS id 003B0402F3;
	Tue,  7 Mar 2023 06:54:13 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 003B0402F3
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 418EFC0089;
	Tue,  7 Mar 2023 06:54:13 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp3.osuosl.org (smtp3.osuosl.org [140.211.166.136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 80173C0032
 for <virtualization@lists.linux-foundation.org>;
 Tue,  7 Mar 2023 06:54:11 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp3.osuosl.org (Postfix) with ESMTP id 5A8876058F
 for <virtualization@lists.linux-foundation.org>;
 Tue,  7 Mar 2023 06:54:11 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp3.osuosl.org 5A8876058F
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp3.osuosl.org ([127.0.0.1])
 by localhost (smtp3.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id jE7qKFpKfTZ7
 for <virtualization@lists.linux-foundation.org>;
 Tue,  7 Mar 2023 06:54:10 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp3.osuosl.org 648BA60011
Received: from out30-130.freemail.mail.aliyun.com
 (out30-130.freemail.mail.aliyun.com [115.124.30.130])
 by smtp3.osuosl.org (Postfix) with ESMTPS id 648BA60011
 for <virtualization@lists.linux-foundation.org>;
 Tue,  7 Mar 2023 06:54:08 +0000 (UTC)
X-Alimail-AntiSpam: AC=PASS; BC=-1|-1; BR=01201311R101e4; CH=green; DM=||false|;
 DS=||; FP=0|-1|-1|-1|0|-1|-1|-1; HT=ay29a033018046051;
 MF=xuanzhuo@linux.alibaba.com; NM=1; PH=DS; RN=3; SR=0;
 TI=SMTPD_---0VdKKhYE_1678172043; 
Received: from localhost(mailfrom:xuanzhuo@linux.alibaba.com
 fp:SMTPD_---0VdKKhYE_1678172043) by smtp.aliyun-inc.com;
 Tue, 07 Mar 2023 14:54:03 +0800
Message-ID: <1678171817.752717-1-xuanzhuo@linux.alibaba.com>
Subject: Re: [PATCH vhost v1 01/12] virtio_ring: split: refactor
 virtqueue_add_split() for premapped
Date: Tue, 7 Mar 2023 14:50:17 +0800
From: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
To: Jason Wang <jasowang@redhat.com>
References: <20230302115908.1461-1-xuanzhuo@linux.alibaba.com>
 <20230302115908.1461-2-xuanzhuo@linux.alibaba.com>
 <CACGkMEsA-YnhNA-cJTOrpDMvAv61A2KEYSznNy4g8o=nZ+jvfw@mail.gmail.com>
In-Reply-To: <CACGkMEsA-YnhNA-cJTOrpDMvAv61A2KEYSznNy4g8o=nZ+jvfw@mail.gmail.com>
Cc: "Michael S. Tsirkin" <mst@redhat.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gVHVlLCA3IE1hciAyMDIzIDE0OjQzOjM1ICswODAwLCBKYXNvbiBXYW5nIDxqYXNvd2FuZ0By
ZWRoYXQuY29tPiB3cm90ZToKPiBPbiBUaHUsIE1hciAyLCAyMDIzIGF0IDc6NTnigK9QTSBYdWFu
IFpodW8gPHh1YW56aHVvQGxpbnV4LmFsaWJhYmEuY29tPiB3cm90ZToKPiA+Cj4gPiBUaGlzIGNv
bW1pdCBzcGxpdHMgdmlydHF1ZXVlX2FkZF9zcGxpdCgpIHRvIHR3byBmdW5jdGlvbnMuIFRoZSBw
dXJwb3NlCj4gPiBvZiBzdWNoIHNwbGl0dGluZyBpcyB0byBzZXBhcmF0ZSBETUEgb3BlcmF0aW9u
cy4KPiA+Cj4gPiBUaGUgZmlyc3QgZnVuY3Rpb24gaW5jbHVkZXMgYWxsIGNvZGVzIHRoYXQgbWF5
IGZhaWwgYmVmb3JlIHRoZSBETUEKPiA+IG9wZXJhdGlvbi4gVGhlIHN1YnNlcXVlbnQgcGFydCBp
cyB1c2VkIGFzIHRoZSBzZWNvbmQgZnVuY3Rpb24uCj4gPgo+ID4gSW4gdGhpcyB3YXksIHdlIGNh
biBwZXJmb3JtIERNQSBvcGVyYXRpb25zIGluIHRoZSBtaWRkbGUgb2YgdGhlIHR3bwo+ID4gZnVu
Y3Rpb25zLiBJZiB0aGUgZmlyc3QgZnVuY3Rpb24gZmFpbHMsIHdlIGRvIG5vdCBuZWVkIHRvIHBl
cmZvcm0gRE1BCj4gPiBvcGVyYXRpb25zLiBJZiBpdCBpcyBwcmVtYXBwZWQsIHdlIGNhbiBwYXNz
IHRoZSBETUEgb3BlcmF0aW9uLgo+ID4KPiA+IFNpZ25lZC1vZmYtYnk6IFh1YW4gWmh1byA8eHVh
bnpodW9AbGludXguYWxpYmFiYS5jb20+Cj4gPiAtLS0KPiA+ICBkcml2ZXJzL3ZpcnRpby92aXJ0
aW9fcmluZy5jIHwgMTMxICsrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tCj4gPiAg
MSBmaWxlIGNoYW5nZWQsIDg4IGluc2VydGlvbnMoKyksIDQzIGRlbGV0aW9ucygtKQo+ID4KPiA+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL3ZpcnRpby92aXJ0aW9fcmluZy5jIGIvZHJpdmVycy92aXJ0
aW8vdmlydGlvX3JpbmcuYwo+ID4gaW5kZXggNDExNDRiNTI0NmE4Li4zMDA1ODkzZWNjNjEgMTAw
NjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL3ZpcnRpby92aXJ0aW9fcmluZy5jCj4gPiArKysgYi9kcml2
ZXJzL3ZpcnRpby92aXJ0aW9fcmluZy5jCj4gPiBAQCAtNTIwLDU3ICs1MjAsMzggQEAgc3RhdGlj
IGlubGluZSB1bnNpZ25lZCBpbnQgdmlydHF1ZXVlX2FkZF9kZXNjX3NwbGl0KHN0cnVjdCB2aXJ0
cXVldWUgKnZxLAo+ID4gICAgICAgICByZXR1cm4gbmV4dDsKPiA+ICB9Cj4gPgo+ID4gLXN0YXRp
YyBpbmxpbmUgaW50IHZpcnRxdWV1ZV9hZGRfc3BsaXQoc3RydWN0IHZpcnRxdWV1ZSAqX3ZxLAo+
ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NhdHRlcmxp
c3QgKnNnc1tdLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNp
Z25lZCBpbnQgdG90YWxfc2csCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVuc2lnbmVkIGludCBvdXRfc2dzLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1bnNpZ25lZCBpbnQgaW5fc2dzLAo+ID4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB2b2lkICpkYXRhLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB2b2lkICpjdHgsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGdmcF90IGdmcCkKPiA+ICsvKiBub3RlOiByZXR1cm4gTlVMTCBtZWFucyBubyBp
bmRpcmVjdCB0aGF0IGlzIHZhbGlkLiAqLwo+ID4gK3N0YXRpYyBzdHJ1Y3QgdnJpbmdfZGVzYyAq
dmlydHF1ZXVlX2dldF9kZXNjX3NwbGl0KHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLAo+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWdu
ZWQgaW50IHRvdGFsX3NnLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG91dF9zZ3MsCj4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpkYXRhLAo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqY3R4LAo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2Zw
X3QgZ2ZwKQo+ID4gIHsKPgo+IEkgZG9uJ3Qgb2JqZWN0IHRvIHRoZSBjaGFuZ2VzIGJ1dCBJIGRv
bid0IHNlZSBtdWNoIHZhbHVlIGluIGZhY3RvcmluZwo+IHRoaXMgb3V0LCBzaW5jZSBpdCdzIG5v
dCByZWxhdGVkIHRvIGFueSBkbWEgbWFwcGluZyBsb2dpYy4KCgpJIHdhbnQ6CgoJdmlydHF1ZXVl
X2dldF9kZXNjX3NwbGl0KCkKLS0tPgl2aXJ0cXVldWVfbWFwX3NncygpCgl2aXJ0cXVldWVfYWRk
X3ZyaW5nX3NwbGl0KCkKClRoZW4gd2UgY2FuIGNob29zZSB0byBkbyBkbWEgb3Igbm90IHdpdGhv
dXQgZmxhZ3MgdG8gdmlydHF1ZXVlX2FkZF92cmluZ19zcGxpdCgpLgoKU28gSSBzcGxpdCB0aGUg
dmlydHF1ZXVlX2FkZF9zcGxpdCgpIHRvIHR3byBmdW5jcy4KCgo+Cj4gPiAtICAgICAgIHN0cnVj
dCB2cmluZ192aXJ0cXVldWUgKnZxID0gdG9fdnZxKF92cSk7Cj4gPiAtICAgICAgIHN0cnVjdCBz
Y2F0dGVybGlzdCAqc2c7Cj4gPiAgICAgICAgIHN0cnVjdCB2cmluZ19kZXNjICpkZXNjOwo+ID4g
LSAgICAgICB1bnNpZ25lZCBpbnQgaSwgbiwgYXZhaWwsIGRlc2NzX3VzZWQsIHByZXYsIGVycl9p
ZHg7Cj4gPiAtICAgICAgIGludCBoZWFkOwo+ID4gLSAgICAgICBib29sIGluZGlyZWN0Owo+ID4g
LQo+ID4gLSAgICAgICBTVEFSVF9VU0UodnEpOwo+ID4gKyAgICAgICB1bnNpZ25lZCBpbnQgZGVz
Y3NfdXNlZDsKPiA+Cj4gPiAgICAgICAgIEJVR19PTihkYXRhID09IE5VTEwpOwo+ID4gICAgICAg
ICBCVUdfT04oY3R4ICYmIHZxLT5pbmRpcmVjdCk7Cj4gPgo+ID4gLSAgICAgICBpZiAodW5saWtl
bHkodnEtPmJyb2tlbikpIHsKPiA+IC0gICAgICAgICAgICAgICBFTkRfVVNFKHZxKTsKPiA+IC0g
ICAgICAgICAgICAgICByZXR1cm4gLUVJTzsKPiA+IC0gICAgICAgfQo+ID4gKyAgICAgICBpZiAo
dW5saWtlbHkodnEtPmJyb2tlbikpCj4gPiArICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIo
LUVJTyk7Cj4gPgo+ID4gICAgICAgICBMQVNUX0FERF9USU1FX1VQREFURSh2cSk7Cj4gPgo+ID4g
ICAgICAgICBCVUdfT04odG90YWxfc2cgPT0gMCk7Cj4gPgo+ID4gLSAgICAgICBoZWFkID0gdnEt
PmZyZWVfaGVhZDsKPiA+IC0KPiA+ICAgICAgICAgaWYgKHZpcnRxdWV1ZV91c2VfaW5kaXJlY3Qo
dnEsIHRvdGFsX3NnKSkKPiA+IC0gICAgICAgICAgICAgICBkZXNjID0gYWxsb2NfaW5kaXJlY3Rf
c3BsaXQoX3ZxLCB0b3RhbF9zZywgZ2ZwKTsKPiA+ICsgICAgICAgICAgICAgICBkZXNjID0gYWxs
b2NfaW5kaXJlY3Rfc3BsaXQoJnZxLT52cSwgdG90YWxfc2csIGdmcCk7Cj4gPiAgICAgICAgIGVs
c2Ugewo+ID4gICAgICAgICAgICAgICAgIGRlc2MgPSBOVUxMOwo+ID4gICAgICAgICAgICAgICAg
IFdBUk5fT05fT05DRSh0b3RhbF9zZyA+IHZxLT5zcGxpdC52cmluZy5udW0gJiYgIXZxLT5pbmRp
cmVjdCk7Cj4gPiAgICAgICAgIH0KPiA+Cj4gPiAtICAgICAgIGlmIChkZXNjKSB7Cj4gPiAtICAg
ICAgICAgICAgICAgLyogVXNlIGEgc2luZ2xlIGJ1ZmZlciB3aGljaCBkb2Vzbid0IGNvbnRpbnVl
ICovCj4gPiAtICAgICAgICAgICAgICAgaW5kaXJlY3QgPSB0cnVlOwo+ID4gLSAgICAgICAgICAg
ICAgIC8qIFNldCB1cCByZXN0IHRvIHVzZSB0aGlzIGluZGlyZWN0IHRhYmxlLiAqLwo+ID4gLSAg
ICAgICAgICAgICAgIGkgPSAwOwo+ID4gKyAgICAgICBpZiAoZGVzYykKPiA+ICAgICAgICAgICAg
ICAgICBkZXNjc191c2VkID0gMTsKPiA+IC0gICAgICAgfSBlbHNlIHsKPiA+IC0gICAgICAgICAg
ICAgICBpbmRpcmVjdCA9IGZhbHNlOwo+ID4gLSAgICAgICAgICAgICAgIGRlc2MgPSB2cS0+c3Bs
aXQudnJpbmcuZGVzYzsKPiA+IC0gICAgICAgICAgICAgICBpID0gaGVhZDsKPiA+ICsgICAgICAg
ZWxzZQo+ID4gICAgICAgICAgICAgICAgIGRlc2NzX3VzZWQgPSB0b3RhbF9zZzsKPiA+IC0gICAg
ICAgfQo+ID4KPiA+ICAgICAgICAgaWYgKHVubGlrZWx5KHZxLT52cS5udW1fZnJlZSA8IGRlc2Nz
X3VzZWQpKSB7Cj4gPiAgICAgICAgICAgICAgICAgcHJfZGVidWcoIkNhbid0IGFkZCBidWYgbGVu
ICVpIC0gYXZhaWwgPSAlaVxuIiwKPiA+IEBAIC01ODAsMTAgKzU2MSwzOSBAQCBzdGF0aWMgaW5s
aW5lIGludCB2aXJ0cXVldWVfYWRkX3NwbGl0KHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ICAg
ICAgICAgICAgICAgICAgKiBob3N0IHNob3VsZCBzZXJ2aWNlIHRoZSByaW5nIEFTQVAuICovCj4g
PiAgICAgICAgICAgICAgICAgaWYgKG91dF9zZ3MpCj4gPiAgICAgICAgICAgICAgICAgICAgICAg
ICB2cS0+bm90aWZ5KCZ2cS0+dnEpOwo+ID4gLSAgICAgICAgICAgICAgIGlmIChpbmRpcmVjdCkK
PiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGtmcmVlKGRlc2MpOwo+ID4gLSAgICAgICAgICAg
ICAgIEVORF9VU0UodnEpOwo+ID4gLSAgICAgICAgICAgICAgIHJldHVybiAtRU5PU1BDOwo+ID4g
KyAgICAgICAgICAgICAgIGtmcmVlKGRlc2MpOwo+ID4gKyAgICAgICAgICAgICAgIHJldHVybiBF
UlJfUFRSKC1FTk9TUEMpOwo+ID4gKyAgICAgICB9Cj4gPiArCj4gPiArICAgICAgIHJldHVybiBk
ZXNjOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW5saW5lIGludCB2aXJ0cXVldWVfYWRkX3Zy
aW5nX3NwbGl0KHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLAo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NhdHRlcmxpc3QgKnNnc1tdLAo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBp
bnQgdG90YWxfc2csCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVuc2lnbmVkIGludCBvdXRfc2dzLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgaW5fc2dzLAo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdnJpbmdfZGVzYyAqZGVzYykKPiA+
ICt7Cj4gPiArICAgICAgIHN0cnVjdCB2aXJ0cXVldWUgKl92cSA9ICZ2cS0+dnE7Cj4gPiArICAg
ICAgIHN0cnVjdCBzY2F0dGVybGlzdCAqc2c7Cj4gPiArICAgICAgIHVuc2lnbmVkIGludCBpLCBu
LCBhdmFpbCwgZGVzY3NfdXNlZCwgcHJldiwgZXJyX2lkeDsKPiA+ICsgICAgICAgaW50IGhlYWQ7
Cj4gPiArICAgICAgIGJvb2wgaW5kaXJlY3Q7Cj4gPiArCj4gPiArICAgICAgIGhlYWQgPSB2cS0+
ZnJlZV9oZWFkOwo+ID4gKwo+ID4gKyAgICAgICBpZiAoZGVzYykgewo+ID4gKyAgICAgICAgICAg
ICAgIC8qIFVzZSBhIHNpbmdsZSBidWZmZXIgd2hpY2ggZG9lc24ndCBjb250aW51ZSAqLwo+ID4g
KyAgICAgICAgICAgICAgIGluZGlyZWN0ID0gdHJ1ZTsKPiA+ICsgICAgICAgICAgICAgICAvKiBT
ZXQgdXAgcmVzdCB0byB1c2UgdGhpcyBpbmRpcmVjdCB0YWJsZS4gKi8KPiA+ICsgICAgICAgICAg
ICAgICBpID0gMDsKPiA+ICsgICAgICAgICAgICAgICBkZXNjc191c2VkID0gMTsKPiA+ICsgICAg
ICAgfSBlbHNlIHsKPiA+ICsgICAgICAgICAgICAgICBpbmRpcmVjdCA9IGZhbHNlOwo+ID4gKyAg
ICAgICAgICAgICAgIGRlc2MgPSB2cS0+c3BsaXQudnJpbmcuZGVzYzsKPiA+ICsgICAgICAgICAg
ICAgICBpID0gaGVhZDsKPiA+ICsgICAgICAgICAgICAgICBkZXNjc191c2VkID0gdG90YWxfc2c7
Cj4gPiAgICAgICAgIH0KPiA+Cj4gPiAgICAgICAgIGZvciAobiA9IDA7IG4gPCBvdXRfc2dzOyBu
KyspIHsKPiA+IEBAIC02NDgsMTMgKzY1OCw2IEBAIHN0YXRpYyBpbmxpbmUgaW50IHZpcnRxdWV1
ZV9hZGRfc3BsaXQoc3RydWN0IHZpcnRxdWV1ZSAqX3ZxLAo+ID4gICAgICAgICBlbHNlCj4gPiAg
ICAgICAgICAgICAgICAgdnEtPmZyZWVfaGVhZCA9IGk7Cj4gPgo+ID4gLSAgICAgICAvKiBTdG9y
ZSB0b2tlbiBhbmQgaW5kaXJlY3QgYnVmZmVyIHN0YXRlLiAqLwo+ID4gLSAgICAgICB2cS0+c3Bs
aXQuZGVzY19zdGF0ZVtoZWFkXS5kYXRhID0gZGF0YTsKPiA+IC0gICAgICAgaWYgKGluZGlyZWN0
KQo+ID4gLSAgICAgICAgICAgICAgIHZxLT5zcGxpdC5kZXNjX3N0YXRlW2hlYWRdLmluZGlyX2Rl
c2MgPSBkZXNjOwo+ID4gLSAgICAgICBlbHNlCj4gPiAtICAgICAgICAgICAgICAgdnEtPnNwbGl0
LmRlc2Nfc3RhdGVbaGVhZF0uaW5kaXJfZGVzYyA9IGN0eDsKPiA+IC0KPiA+ICAgICAgICAgLyog
UHV0IGVudHJ5IGluIGF2YWlsYWJsZSBhcnJheSAoYnV0IGRvbid0IHVwZGF0ZSBhdmFpbC0+aWR4
IHVudGlsIHRoZXkKPiA+ICAgICAgICAgICogZG8gc3luYykuICovCj4gPiAgICAgICAgIGF2YWls
ID0gdnEtPnNwbGl0LmF2YWlsX2lkeF9zaGFkb3cgJiAodnEtPnNwbGl0LnZyaW5nLm51bSAtIDEp
Owo+ID4gQEAgLTcwMyw2ICs3MDYsNDggQEAgc3RhdGljIGlubGluZSBpbnQgdmlydHF1ZXVlX2Fk
ZF9zcGxpdChzdHJ1Y3QgdmlydHF1ZXVlICpfdnEsCj4gPiAgICAgICAgIHJldHVybiAtRU5PTUVN
Owo+ID4gIH0KPiA+Cj4gPiArc3RhdGljIGlubGluZSBpbnQgdmlydHF1ZXVlX2FkZF9zcGxpdChz
dHJ1Y3QgdmlydHF1ZXVlICpfdnEsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCBzY2F0dGVybGlzdCAqc2dzW10sCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCB0b3RhbF9zZywKPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG91dF9zZ3MsCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBpbl9zZ3MsCj4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKmRhdGEsCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKmN0eCwKPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZwX3QgZ2ZwKQo+ID4gK3sKPiA+ICsg
ICAgICAgc3RydWN0IHZyaW5nX3ZpcnRxdWV1ZSAqdnEgPSB0b192dnEoX3ZxKTsKPiA+ICsgICAg
ICAgc3RydWN0IHZyaW5nX2Rlc2MgKmRlc2M7Cj4gPiArICAgICAgIGludCBoZWFkOwo+ID4gKyAg
ICAgICBpbnQgZXJyOwo+ID4gKwo+ID4gKyAgICAgICBTVEFSVF9VU0UodnEpOwo+ID4gKwo+ID4g
KyAgICAgICAvKiBjaGVjayB2cSBzdGF0ZSBhbmQgdHJ5IHRvIGFsbG9jIGRlc2MgZm9yIGluZGly
ZWN0LiAqLwo+ID4gKyAgICAgICBkZXNjID0gdmlydHF1ZXVlX2dldF9kZXNjX3NwbGl0KHZxLCB0
b3RhbF9zZywgb3V0X3NncywgZGF0YSwgY3R4LCBnZnApOwo+ID4gKyAgICAgICBpZiAoSVNfRVJS
KGRlc2MpKSB7Cj4gPiArICAgICAgICAgICAgICAgZXJyID0gUFRSX0VSUihkZXNjKTsKPiA+ICsg
ICAgICAgICAgICAgICBnb3RvIGVuZDsKPiA+ICsgICAgICAgfQo+ID4gKwo+ID4gKyAgICAgICBo
ZWFkID0gdnEtPmZyZWVfaGVhZDsKPiA+ICsgICAgICAgZXJyID0gdmlydHF1ZXVlX2FkZF92cmlu
Z19zcGxpdCh2cSwgc2dzLCB0b3RhbF9zZywgb3V0X3NncywgaW5fc2dzLCBkZXNjKTsKPiA+ICsg
ICAgICAgaWYgKGVycikKPiA+ICsgICAgICAgICAgICAgICBnb3RvIGVycjsKPiA+ICsKPiA+ICsg
ICAgICAgLyogU3RvcmUgdG9rZW4gYW5kIGluZGlyZWN0IGJ1ZmZlciBzdGF0ZS4gKi8KPiA+ICsg
ICAgICAgdnEtPnNwbGl0LmRlc2Nfc3RhdGVbaGVhZF0uZGF0YSA9IGRhdGE7Cj4gPiArICAgICAg
IHZxLT5zcGxpdC5kZXNjX3N0YXRlW2hlYWRdLmluZGlyX2Rlc2MgPSBkZXNjID8gZGVzYyA6IGN0
eDsKPiA+ICsKPiA+ICsgICAgICAgZ290byBlbmQ7Cj4KPiBOaXQ6IHRoaXMgc2VlbXMgbm90IGVs
ZWdhbnQuIEkgd291bGQgcmF0aGVyIGR1cGxpY2F0ZQo+Cj4gRU5EX1VTRSh2cSk7Cj4gcmV0dXJu
IGVycjsKPgoKV2lsbCBmaXguCgpUaGFua3MuCgoKPiBoZXJlLgo+Cj4gVGhhbmtzCj4KPgo+Cj4K
PiA+ICsKPiA+ICtlcnI6Cj4gPiArICAgICAgIGtmcmVlKGRlc2MpOwo+ID4gKwo+ID4gK2VuZDoK
PiA+ICsgICAgICAgRU5EX1VTRSh2cSk7Cj4gPiArICAgICAgIHJldHVybiBlcnI7Cj4gPiArfQo+
ID4gKwo+ID4gIHN0YXRpYyBib29sIHZpcnRxdWV1ZV9raWNrX3ByZXBhcmVfc3BsaXQoc3RydWN0
IHZpcnRxdWV1ZSAqX3ZxKQo+ID4gIHsKPiA+ICAgICAgICAgc3RydWN0IHZyaW5nX3ZpcnRxdWV1
ZSAqdnEgPSB0b192dnEoX3ZxKTsKPiA+IC0tCj4gPiAyLjMyLjAuMy5nMDExOTVjZjlmCj4gPgo+
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClZpcnR1YWxp
emF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0cy5saW51eC1mb3VuZGF0aW9u
Lm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcvbWFpbG1hbi9saXN0aW5mby92
aXJ0dWFsaXphdGlvbg==
