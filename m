Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 646981EE082
	for <lists.virtualization@lfdr.de>; Thu,  4 Jun 2020 11:06:02 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id E7FFB86EA8;
	Thu,  4 Jun 2020 09:06:00 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id UPk5sYTSd6o4; Thu,  4 Jun 2020 09:05:59 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id AAA4086DD7;
	Thu,  4 Jun 2020 09:05:59 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 72EBEC016E;
	Thu,  4 Jun 2020 09:05:59 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id EE947C016E
 for <virtualization@lists.linux-foundation.org>;
 Thu,  4 Jun 2020 09:05:57 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by hemlock.osuosl.org (Postfix) with ESMTP id E1E50887F9
 for <virtualization@lists.linux-foundation.org>;
 Thu,  4 Jun 2020 09:05:57 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id r9ehEOKpDltL
 for <virtualization@lists.linux-foundation.org>;
 Thu,  4 Jun 2020 09:05:56 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from us-smtp-delivery-1.mimecast.com (us-smtp-2.mimecast.com
 [205.139.110.61])
 by hemlock.osuosl.org (Postfix) with ESMTPS id 4CBAE8874A
 for <virtualization@lists.linux-foundation.org>;
 Thu,  4 Jun 2020 09:05:56 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1591261555;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=v6aK2hpgClJ6HivdtvQMmbhWQibPdYDHnwlJip8pmN0=;
 b=iIaqoRotiEvjX1p8hECLv81M9dz0nUMUGo+9Tqb5HUUrr9bOTfacktcCPd7ELVp6rXsQyu
 8JE+ju+0Qsd7XOvPZYciHXWX4DeJ1+M7D7E7Zr2THtrNVWO3vaVmZzkNxmrVrTnIjVEm9M
 NCQ0F6mfx0TPyNmrcGG8jMfyVX9/Kwc=
Received: from mail-wr1-f70.google.com (mail-wr1-f70.google.com
 [209.85.221.70]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-58-kpv5eVxQN9Gdaz-llf7Vnw-1; Thu, 04 Jun 2020 05:05:53 -0400
X-MC-Unique: kpv5eVxQN9Gdaz-llf7Vnw-1
Received: by mail-wr1-f70.google.com with SMTP id n6so2159372wrv.6
 for <virtualization@lists.linux-foundation.org>;
 Thu, 04 Jun 2020 02:05:52 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:date:from:to:cc:subject:message-id:references
 :mime-version:content-disposition:content-transfer-encoding
 :in-reply-to;
 bh=v6aK2hpgClJ6HivdtvQMmbhWQibPdYDHnwlJip8pmN0=;
 b=Yu55rNiiPgQJqVd/HLlqMST6QMG4MLWgphZ8UJ/YqSfXvYPa8U4oqn9n109uNQrXIy
 PQXcjqTsaxMZYVsAiB0tPrRdn8sdQ/lNvzm98FAjhyr3AwNHlwWIGAzJMmuykmkt4htL
 5k2c3DBw5Vy/IiZTpgtJE+T6l8UtcQlKMG+YOzRuJrR4jjDs9HCAhaJcRIeouISaiJPI
 IxyKUP7X+4QY5vIunUuJ3bnarCs37vZ2Xbh7+qDwqdjzxK/6hgGN16FPHKCkc+IMPwk/
 9uatDCfrZQGTnFl3bpMRZAHyZlURP57U0m//aswzSE0CX0J/oQU8i60iJScgTZ3ULrmW
 04xg==
X-Gm-Message-State: AOAM530U7nqihBqd0wyHWHXlWrUlwv7GhIm/CaIZT54RONtF70ZzDogy
 Iq8MYQqS8WzKks01jv/4WgAtldnzNRbRgFKvoiWsD39wDTA7BtQr9gTF+B/l7Yzwu4DTYqyCE+z
 95hx5FjZF4Rf6Cmi3Z/Ut7F867sSqjf2wwMN3ipXNuA==
X-Received: by 2002:adf:f5d0:: with SMTP id k16mr3622121wrp.288.1591261551652; 
 Thu, 04 Jun 2020 02:05:51 -0700 (PDT)
X-Google-Smtp-Source: ABdhPJyi+CU2C+brb/iCtICGkKIxnwDqSCBSke7/ca4OcXimxY2yNqEMNHuLL4VWSXsyXnSJovbNlw==
X-Received: by 2002:adf:f5d0:: with SMTP id k16mr3622030wrp.288.1591261550603; 
 Thu, 04 Jun 2020 02:05:50 -0700 (PDT)
Received: from redhat.com ([2a00:a040:185:f65:9a3b:8fff:fed3:ad8d])
 by smtp.gmail.com with ESMTPSA id i74sm7061245wri.49.2020.06.04.02.05.44
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 04 Jun 2020 02:05:49 -0700 (PDT)
Date: Thu, 4 Jun 2020 05:05:42 -0400
From: "Michael S. Tsirkin" <mst@redhat.com>
To: Jason Wang <jasowang@redhat.com>
Subject: Re: [PATCH RFC 08/13] vhost/net: convert to new API: heads->bufs
Message-ID: <20200604050332-mutt-send-email-mst@kernel.org>
References: <20200602130543.578420-1-mst@redhat.com>
 <20200602130543.578420-9-mst@redhat.com>
 <8e5c4e5d-9729-2458-893d-a767b758e7ef@redhat.com>
MIME-Version: 1.0
In-Reply-To: <8e5c4e5d-9729-2458-893d-a767b758e7ef@redhat.com>
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Content-Disposition: inline
Cc: Eugenio =?iso-8859-1?Q?P=E9rez?= <eperezma@redhat.com>,
 netdev@vger.kernel.org, linux-kernel@vger.kernel.org, kvm@vger.kernel.org,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gV2VkLCBKdW4gMDMsIDIwMjAgYXQgMDQ6MTE6NTRQTSArMDgwMCwgSmFzb24gV2FuZyB3cm90
ZToKPiAKPiBPbiAyMDIwLzYvMiDkuIvljYg5OjA2LCBNaWNoYWVsIFMuIFRzaXJraW4gd3JvdGU6
Cj4gPiBDb252ZXJ0IHZob3N0IG5ldCB0byB1c2UgdGhlIG5ldyBmb3JtYXQtYWdub3N0aWMgQVBJ
Lgo+ID4gSW4gcGFydGljdWxhciwgZG9uJ3QgcG9rZSBhdCB2cSBpbnRlcm5hbHMgc3VjaCBhcyB0
aGUKPiA+IGhlYWRzIGFycmF5Lgo+ID4gCj4gPiBTaWduZWQtb2ZmLWJ5OiBNaWNoYWVsIFMuIFRz
aXJraW4gPG1zdEByZWRoYXQuY29tPgo+ID4gLS0tCj4gPiAgIGRyaXZlcnMvdmhvc3QvbmV0LmMg
fCAxNTMgKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0KPiA+ICAg
MSBmaWxlIGNoYW5nZWQsIDgxIGluc2VydGlvbnMoKyksIDcyIGRlbGV0aW9ucygtKQo+ID4gCj4g
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy92aG9zdC9uZXQuYyBiL2RyaXZlcnMvdmhvc3QvbmV0LmMK
PiA+IGluZGV4IDc0OWE5Y2Y1MWE1OS4uNDdhZjNkMWNlM2RkIDEwMDY0NAo+ID4gLS0tIGEvZHJp
dmVycy92aG9zdC9uZXQuYwo+ID4gKysrIGIvZHJpdmVycy92aG9zdC9uZXQuYwo+ID4gQEAgLTU5
LDEzICs1OSwxMyBAQCBNT0RVTEVfUEFSTV9ERVNDKGV4cGVyaW1lbnRhbF96Y29weXR4LCAiRW5h
YmxlIFplcm8gQ29weSBUWDsiCj4gPiAgICAqIHN0YXR1cyBpbnRlcm5hbGx5OyB1c2VkIGZvciB6
ZXJvY29weSB0eCBvbmx5Lgo+ID4gICAgKi8KPiA+ICAgLyogTG93ZXIgZGV2aWNlIERNQSBmYWls
ZWQgKi8KPiA+IC0jZGVmaW5lIFZIT1NUX0RNQV9GQUlMRURfTEVOCSgoX19mb3JjZSBfX3ZpcnRp
bzMyKTMpCj4gPiArI2RlZmluZSBWSE9TVF9ETUFfRkFJTEVEX0xFTgkoMykKPiA+ICAgLyogTG93
ZXIgZGV2aWNlIERNQSBkb25lICovCj4gPiAtI2RlZmluZSBWSE9TVF9ETUFfRE9ORV9MRU4JKChf
X2ZvcmNlIF9fdmlydGlvMzIpMikKPiA+ICsjZGVmaW5lIFZIT1NUX0RNQV9ET05FX0xFTgkoMikK
PiA+ICAgLyogTG93ZXIgZGV2aWNlIERNQSBpbiBwcm9ncmVzcyAqLwo+ID4gLSNkZWZpbmUgVkhP
U1RfRE1BX0lOX1BST0dSRVNTCSgoX19mb3JjZSBfX3ZpcnRpbzMyKTEpCj4gPiArI2RlZmluZSBW
SE9TVF9ETUFfSU5fUFJPR1JFU1MJKDEpCj4gPiAgIC8qIEJ1ZmZlciB1bnVzZWQgKi8KPiA+IC0j
ZGVmaW5lIFZIT1NUX0RNQV9DTEVBUl9MRU4JKChfX2ZvcmNlIF9fdmlydGlvMzIpMCkKPiA+ICsj
ZGVmaW5lIFZIT1NUX0RNQV9DTEVBUl9MRU4JKDApCj4gCj4gCj4gQW5vdGhlciBwYXRjaCBmb3Ig
dGhpcz8KCkl0IGNhbid0IGJlIGEgc2VwYXJhdGUgcGF0Y2guIFdpdGhvdXQgc3dpdGNoaW5nIHRv
IHZob3N0X2J1ZiB3ZSBhcmUKcGFzc2luZyB2cmluZ191c2VkIHN0cnVjdHMgYXJvdW5kLCBhbmQg
dGhhdCBoYXMgX192aXJ0aW8zMiBsZW5ndGguIElmCnN3aXRjaGluZyB0byB2aG9zdF9idWYsIHRo
ZSBsZW5ndGggaXMgdTMyLgpKdXN0IDQgbGluZXMsIG5vdCBhIGxvdCB3b3VsZCBiZSBnYWluZWQg
Ynkgc3BsaXR0aW5nIGl0IG91dCBhbnl3YXkuCgo+IAo+ID4gICAjZGVmaW5lIFZIT1NUX0RNQV9J
U19ET05FKGxlbikgKChfX2ZvcmNlIHUzMikobGVuKSA+PSAoX19mb3JjZSB1MzIpVkhPU1RfRE1B
X0RPTkVfTEVOKQo+ID4gQEAgLTExMiw5ICsxMTIsMTIgQEAgc3RydWN0IHZob3N0X25ldF92aXJ0
cXVldWUgewo+ID4gICAJLyogbGFzdCB1c2VkIGlkeCBmb3Igb3V0c3RhbmRpbmcgRE1BIHplcm9j
b3B5IGJ1ZmZlcnMgKi8KPiA+ICAgCWludCB1cGVuZF9pZHg7Cj4gPiAgIAkvKiBGb3IgVFgsIGZp
cnN0IHVzZWQgaWR4IGZvciBETUEgZG9uZSB6ZXJvY29weSBidWZmZXJzCj4gPiAtCSAqIEZvciBS
WCwgbnVtYmVyIG9mIGJhdGNoZWQgaGVhZHMKPiA+ICsJICogRm9yIFJYLCBudW1iZXIgb2YgYmF0
Y2hlZCBidWZzCj4gPiAgIAkgKi8KPiA+ICAgCWludCBkb25lX2lkeDsKPiA+ICsJLyogT3V0c3Rh
bmRpbmcgdXNlciBidWZzLiBVSU9fTUFYSU9WIGluIGxlbmd0aC4gKi8KPiA+ICsJLyogVE9ETzog
d2UgY2FuIG1ha2UgdGhpcyBzbWFsbGVyIGZvciBzdXJlLiAqLwo+ID4gKwlzdHJ1Y3Qgdmhvc3Rf
YnVmICpidWZzOwo+ID4gICAJLyogTnVtYmVyIG9mIFhEUCBmcmFtZXMgYmF0Y2hlZCAqLwo+ID4g
ICAJaW50IGJhdGNoZWRfeGRwOwo+ID4gICAJLyogYW4gYXJyYXkgb2YgdXNlcnNwYWNlIGJ1ZmZl
cnMgaW5mbyAqLwo+ID4gQEAgLTI3MSw2ICsyNzQsOCBAQCBzdGF0aWMgdm9pZCB2aG9zdF9uZXRf
Y2xlYXJfdWJ1Zl9pbmZvKHN0cnVjdCB2aG9zdF9uZXQgKm4pCj4gPiAgIAlpbnQgaTsKPiA+ICAg
CWZvciAoaSA9IDA7IGkgPCBWSE9TVF9ORVRfVlFfTUFYOyArK2kpIHsKPiA+ICsJCWtmcmVlKG4t
PnZxc1tpXS5idWZzKTsKPiA+ICsJCW4tPnZxc1tpXS5idWZzID0gTlVMTDsKPiA+ICAgCQlrZnJl
ZShuLT52cXNbaV0udWJ1Zl9pbmZvKTsKPiA+ICAgCQluLT52cXNbaV0udWJ1Zl9pbmZvID0gTlVM
TDsKPiA+ICAgCX0KPiA+IEBAIC0yODIsNiArMjg3LDEyIEBAIHN0YXRpYyBpbnQgdmhvc3RfbmV0
X3NldF91YnVmX2luZm8oc3RydWN0IHZob3N0X25ldCAqbikKPiA+ICAgCWludCBpOwo+ID4gICAJ
Zm9yIChpID0gMDsgaSA8IFZIT1NUX05FVF9WUV9NQVg7ICsraSkgewo+ID4gKwkJbi0+dnFzW2ld
LmJ1ZnMgPSBrbWFsbG9jX2FycmF5KFVJT19NQVhJT1YsCj4gPiArCQkJCQkgICAgICAgc2l6ZW9m
KCpuLT52cXNbaV0uYnVmcyksCj4gPiArCQkJCQkgICAgICAgR0ZQX0tFUk5FTCk7Cj4gPiArCQlp
ZiAoIW4tPnZxc1tpXS5idWZzKQo+ID4gKwkJCWdvdG8gZXJyOwo+ID4gKwo+ID4gICAJCXpjb3B5
ID0gdmhvc3RfbmV0X3pjb3B5X21hc2sgJiAoMHgxIDw8IGkpOwo+ID4gICAJCWlmICghemNvcHkp
Cj4gPiAgIAkJCWNvbnRpbnVlOwo+ID4gQEAgLTM2NCwxOCArMzc1LDE4IEBAIHN0YXRpYyB2b2lk
IHZob3N0X3plcm9jb3B5X3NpZ25hbF91c2VkKHN0cnVjdCB2aG9zdF9uZXQgKm5ldCwKPiA+ICAg
CWludCBqID0gMDsKPiA+ICAgCWZvciAoaSA9IG52cS0+ZG9uZV9pZHg7IGkgIT0gbnZxLT51cGVu
ZF9pZHg7IGkgPSAoaSArIDEpICUgVUlPX01BWElPVikgewo+ID4gLQkJaWYgKHZxLT5oZWFkc1tp
XS5sZW4gPT0gVkhPU1RfRE1BX0ZBSUxFRF9MRU4pCj4gPiArCQlpZiAobnZxLT5idWZzW2ldLmlu
X2xlbiA9PSBWSE9TVF9ETUFfRkFJTEVEX0xFTikKPiA+ICAgCQkJdmhvc3RfbmV0X3R4X2Vycihu
ZXQpOwo+ID4gLQkJaWYgKFZIT1NUX0RNQV9JU19ET05FKHZxLT5oZWFkc1tpXS5sZW4pKSB7Cj4g
PiAtCQkJdnEtPmhlYWRzW2ldLmxlbiA9IFZIT1NUX0RNQV9DTEVBUl9MRU47Cj4gPiArCQlpZiAo
VkhPU1RfRE1BX0lTX0RPTkUobnZxLT5idWZzW2ldLmluX2xlbikpIHsKPiA+ICsJCQludnEtPmJ1
ZnNbaV0uaW5fbGVuID0gVkhPU1RfRE1BX0NMRUFSX0xFTjsKPiA+ICAgCQkJKytqOwo+ID4gICAJ
CX0gZWxzZQo+ID4gICAJCQlicmVhazsKPiA+ICAgCX0KPiA+ICAgCXdoaWxlIChqKSB7Cj4gPiAg
IAkJYWRkID0gbWluKFVJT19NQVhJT1YgLSBudnEtPmRvbmVfaWR4LCBqKTsKPiA+IC0JCXZob3N0
X2FkZF91c2VkX2FuZF9zaWduYWxfbih2cS0+ZGV2LCB2cSwKPiA+IC0JCQkJCSAgICAmdnEtPmhl
YWRzW252cS0+ZG9uZV9pZHhdLCBhZGQpOwo+ID4gKwkJdmhvc3RfcHV0X3VzZWRfbl9idWZzKHZx
LCAmbnZxLT5idWZzW252cS0+ZG9uZV9pZHhdLCBhZGQpOwo+ID4gKwkJdmhvc3Rfc2lnbmFsKHZx
LT5kZXYsIHZxKTsKPiA+ICAgCQludnEtPmRvbmVfaWR4ID0gKG52cS0+ZG9uZV9pZHggKyBhZGQp
ICUgVUlPX01BWElPVjsKPiA+ICAgCQlqIC09IGFkZDsKPiA+ICAgCX0KPiA+IEBAIC0zOTAsNyAr
NDAxLDcgQEAgc3RhdGljIHZvaWQgdmhvc3RfemVyb2NvcHlfY2FsbGJhY2soc3RydWN0IHVidWZf
aW5mbyAqdWJ1ZiwgYm9vbCBzdWNjZXNzKQo+ID4gICAJcmN1X3JlYWRfbG9ja19iaCgpOwo+ID4g
ICAJLyogc2V0IGxlbiB0byBtYXJrIHRoaXMgZGVzYyBidWZmZXJzIGRvbmUgRE1BICovCj4gPiAt
CW52cS0+dnEuaGVhZHNbdWJ1Zi0+ZGVzY10uaW5fbGVuID0gc3VjY2VzcyA/Cj4gPiArCW52cS0+
YnVmc1t1YnVmLT5kZXNjXS5pbl9sZW4gPSBzdWNjZXNzID8KPiA+ICAgCQlWSE9TVF9ETUFfRE9O
RV9MRU4gOiBWSE9TVF9ETUFfRkFJTEVEX0xFTjsKPiA+ICAgCWNudCA9IHZob3N0X25ldF91YnVm
X3B1dCh1YnVmcyk7Cj4gPiBAQCAtNDUyLDcgKzQ2Myw4IEBAIHN0YXRpYyB2b2lkIHZob3N0X25l
dF9zaWduYWxfdXNlZChzdHJ1Y3Qgdmhvc3RfbmV0X3ZpcnRxdWV1ZSAqbnZxKQo+ID4gICAJaWYg
KCFudnEtPmRvbmVfaWR4KQo+ID4gICAJCXJldHVybjsKPiA+IC0Jdmhvc3RfYWRkX3VzZWRfYW5k
X3NpZ25hbF9uKGRldiwgdnEsIHZxLT5oZWFkcywgbnZxLT5kb25lX2lkeCk7Cj4gPiArCXZob3N0
X3B1dF91c2VkX25fYnVmcyh2cSwgbnZxLT5idWZzLCBudnEtPmRvbmVfaWR4KTsKPiA+ICsJdmhv
c3Rfc2lnbmFsKGRldiwgdnEpOwo+ID4gICAJbnZxLT5kb25lX2lkeCA9IDA7Cj4gPiAgIH0KPiA+
IEBAIC01NTgsNiArNTcwLDcgQEAgc3RhdGljIHZvaWQgdmhvc3RfbmV0X2J1c3lfcG9sbChzdHJ1
Y3Qgdmhvc3RfbmV0ICpuZXQsCj4gPiAgIHN0YXRpYyBpbnQgdmhvc3RfbmV0X3R4X2dldF92cV9k
ZXNjKHN0cnVjdCB2aG9zdF9uZXQgKm5ldCwKPiA+ICAgCQkJCSAgICBzdHJ1Y3Qgdmhvc3RfbmV0
X3ZpcnRxdWV1ZSAqdG52cSwKPiA+ICsJCQkJICAgIHN0cnVjdCB2aG9zdF9idWYgKmJ1ZiwKPiA+
ICAgCQkJCSAgICB1bnNpZ25lZCBpbnQgKm91dF9udW0sIHVuc2lnbmVkIGludCAqaW5fbnVtLAo+
ID4gICAJCQkJICAgIHN0cnVjdCBtc2doZHIgKm1zZ2hkciwgYm9vbCAqYnVzeWxvb3BfaW50cikK
PiA+ICAgewo+ID4gQEAgLTU2NSwxMCArNTc4LDEwIEBAIHN0YXRpYyBpbnQgdmhvc3RfbmV0X3R4
X2dldF92cV9kZXNjKHN0cnVjdCB2aG9zdF9uZXQgKm5ldCwKPiA+ICAgCXN0cnVjdCB2aG9zdF92
aXJ0cXVldWUgKnJ2cSA9ICZybnZxLT52cTsKPiA+ICAgCXN0cnVjdCB2aG9zdF92aXJ0cXVldWUg
KnR2cSA9ICZ0bnZxLT52cTsKPiA+IC0JaW50IHIgPSB2aG9zdF9nZXRfdnFfZGVzYyh0dnEsIHR2
cS0+aW92LCBBUlJBWV9TSVpFKHR2cS0+aW92KSwKPiA+IC0JCQkJICBvdXRfbnVtLCBpbl9udW0s
IE5VTEwsIE5VTEwpOwo+ID4gKwlpbnQgciA9IHZob3N0X2dldF9hdmFpbF9idWYodHZxLCBidWYs
IHR2cS0+aW92LCBBUlJBWV9TSVpFKHR2cS0+aW92KSwKPiA+ICsJCQkJICAgIG91dF9udW0sIGlu
X251bSwgTlVMTCwgTlVMTCk7Cj4gPiAtCWlmIChyID09IHR2cS0+bnVtICYmIHR2cS0+YnVzeWxv
b3BfdGltZW91dCkgewo+ID4gKwlpZiAoIXIgJiYgdHZxLT5idXN5bG9vcF90aW1lb3V0KSB7Cj4g
PiAgIAkJLyogRmx1c2ggYmF0Y2hlZCBwYWNrZXRzIGZpcnN0ICovCj4gPiAgIAkJaWYgKCF2aG9z
dF9zb2NrX3pjb3B5KHZob3N0X3ZxX2dldF9iYWNrZW5kKHR2cSkpKQo+ID4gICAJCQl2aG9zdF90
eF9iYXRjaChuZXQsIHRudnEsCj4gPiBAQCAtNTc3LDggKzU5MCw4IEBAIHN0YXRpYyBpbnQgdmhv
c3RfbmV0X3R4X2dldF92cV9kZXNjKHN0cnVjdCB2aG9zdF9uZXQgKm5ldCwKPiA+ICAgCQl2aG9z
dF9uZXRfYnVzeV9wb2xsKG5ldCwgcnZxLCB0dnEsIGJ1c3lsb29wX2ludHIsIGZhbHNlKTsKPiA+
IC0JCXIgPSB2aG9zdF9nZXRfdnFfZGVzYyh0dnEsIHR2cS0+aW92LCBBUlJBWV9TSVpFKHR2cS0+
aW92KSwKPiA+IC0JCQkJICAgICAgb3V0X251bSwgaW5fbnVtLCBOVUxMLCBOVUxMKTsKPiA+ICsJ
CXIgPSB2aG9zdF9nZXRfYXZhaWxfYnVmKHR2cSwgYnVmLCB0dnEtPmlvdiwgQVJSQVlfU0laRSh0
dnEtPmlvdiksCj4gPiArCQkJCQlvdXRfbnVtLCBpbl9udW0sIE5VTEwsIE5VTEwpOwo+ID4gICAJ
fQo+ID4gICAJcmV0dXJuIHI7Cj4gPiBAQCAtNjA3LDYgKzYyMCw3IEBAIHN0YXRpYyBzaXplX3Qg
aW5pdF9pb3ZfaXRlcihzdHJ1Y3Qgdmhvc3RfdmlydHF1ZXVlICp2cSwgc3RydWN0IGlvdl9pdGVy
ICppdGVyLAo+ID4gICBzdGF0aWMgaW50IGdldF90eF9idWZzKHN0cnVjdCB2aG9zdF9uZXQgKm5l
dCwKPiA+ICAgCQkgICAgICAgc3RydWN0IHZob3N0X25ldF92aXJ0cXVldWUgKm52cSwKPiA+ICsJ
CSAgICAgICBzdHJ1Y3Qgdmhvc3RfYnVmICpidWYsCj4gPiAgIAkJICAgICAgIHN0cnVjdCBtc2do
ZHIgKm1zZywKPiA+ICAgCQkgICAgICAgdW5zaWduZWQgaW50ICpvdXQsIHVuc2lnbmVkIGludCAq
aW4sCj4gPiAgIAkJICAgICAgIHNpemVfdCAqbGVuLCBib29sICpidXN5bG9vcF9pbnRyKQo+ID4g
QEAgLTYxNCw5ICs2MjgsOSBAQCBzdGF0aWMgaW50IGdldF90eF9idWZzKHN0cnVjdCB2aG9zdF9u
ZXQgKm5ldCwKPiA+ICAgCXN0cnVjdCB2aG9zdF92aXJ0cXVldWUgKnZxID0gJm52cS0+dnE7Cj4g
PiAgIAlpbnQgcmV0Owo+ID4gLQlyZXQgPSB2aG9zdF9uZXRfdHhfZ2V0X3ZxX2Rlc2MobmV0LCBu
dnEsIG91dCwgaW4sIG1zZywgYnVzeWxvb3BfaW50cik7Cj4gPiArCXJldCA9IHZob3N0X25ldF90
eF9nZXRfdnFfZGVzYyhuZXQsIG52cSwgYnVmLCBvdXQsIGluLCBtc2csIGJ1c3lsb29wX2ludHIp
Owo+ID4gLQlpZiAocmV0IDwgMCB8fCByZXQgPT0gdnEtPm51bSkKPiA+ICsJaWYgKHJldCA8PSAw
KQo+ID4gICAJCXJldHVybiByZXQ7Cj4gPiAgIAlpZiAoKmluKSB7Cj4gPiBAQCAtNzYxLDcgKzc3
NSw3IEBAIHN0YXRpYyB2b2lkIGhhbmRsZV90eF9jb3B5KHN0cnVjdCB2aG9zdF9uZXQgKm5ldCwg
c3RydWN0IHNvY2tldCAqc29jaykKPiA+ICAgCXN0cnVjdCB2aG9zdF9uZXRfdmlydHF1ZXVlICpu
dnEgPSAmbmV0LT52cXNbVkhPU1RfTkVUX1ZRX1RYXTsKPiA+ICAgCXN0cnVjdCB2aG9zdF92aXJ0
cXVldWUgKnZxID0gJm52cS0+dnE7Cj4gPiAgIAl1bnNpZ25lZCBvdXQsIGluOwo+ID4gLQlpbnQg
aGVhZDsKPiA+ICsJaW50IHJldDsKPiA+ICAgCXN0cnVjdCBtc2doZHIgbXNnID0gewo+ID4gICAJ
CS5tc2dfbmFtZSA9IE5VTEwsCj4gPiAgIAkJLm1zZ19uYW1lbGVuID0gMCwKPiA+IEBAIC03NzMs
NiArNzg3LDcgQEAgc3RhdGljIHZvaWQgaGFuZGxlX3R4X2NvcHkoc3RydWN0IHZob3N0X25ldCAq
bmV0LCBzdHJ1Y3Qgc29ja2V0ICpzb2NrKQo+ID4gICAJaW50IGVycjsKPiA+ICAgCWludCBzZW50
X3BrdHMgPSAwOwo+ID4gICAJYm9vbCBzb2NrX2Nhbl9iYXRjaCA9IChzb2NrLT5zay0+c2tfc25k
YnVmID09IElOVF9NQVgpOwo+ID4gKwlzdHJ1Y3Qgdmhvc3RfYnVmIGJ1ZjsKPiA+ICAgCWRvIHsK
PiA+ICAgCQlib29sIGJ1c3lsb29wX2ludHIgPSBmYWxzZTsKPiA+IEBAIC03ODAsMTMgKzc5NSwx
MyBAQCBzdGF0aWMgdm9pZCBoYW5kbGVfdHhfY29weShzdHJ1Y3Qgdmhvc3RfbmV0ICpuZXQsIHN0
cnVjdCBzb2NrZXQgKnNvY2spCj4gPiAgIAkJaWYgKG52cS0+ZG9uZV9pZHggPT0gVkhPU1RfTkVU
X0JBVENIKQo+ID4gICAJCQl2aG9zdF90eF9iYXRjaChuZXQsIG52cSwgc29jaywgJm1zZyk7Cj4g
PiAtCQloZWFkID0gZ2V0X3R4X2J1ZnMobmV0LCBudnEsICZtc2csICZvdXQsICZpbiwgJmxlbiwK
PiA+IC0JCQkJICAgJmJ1c3lsb29wX2ludHIpOwo+ID4gKwkJcmV0ID0gZ2V0X3R4X2J1ZnMobmV0
LCBudnEsICZidWYsICZtc2csICZvdXQsICZpbiwgJmxlbiwKPiA+ICsJCQkJICAmYnVzeWxvb3Bf
aW50cik7Cj4gPiAgIAkJLyogT24gZXJyb3IsIHN0b3AgaGFuZGxpbmcgdW50aWwgdGhlIG5leHQg
a2ljay4gKi8KPiA+IC0JCWlmICh1bmxpa2VseShoZWFkIDwgMCkpCj4gPiArCQlpZiAodW5saWtl
bHkocmV0IDwgMCkpCj4gPiAgIAkJCWJyZWFrOwo+ID4gICAJCS8qIE5vdGhpbmcgbmV3PyAgV2Fp
dCBmb3IgZXZlbnRmZCB0byB0ZWxsIHVzIHRoZXkgcmVmaWxsZWQuICovCj4gPiAtCQlpZiAoaGVh
ZCA9PSB2cS0+bnVtKSB7Cj4gPiArCQlpZiAoIXJldCkgewo+ID4gICAJCQlpZiAodW5saWtlbHko
YnVzeWxvb3BfaW50cikpIHsKPiA+ICAgCQkJCXZob3N0X3BvbGxfcXVldWUoJnZxLT5wb2xsKTsK
PiA+ICAgCQkJfSBlbHNlIGlmICh1bmxpa2VseSh2aG9zdF9lbmFibGVfbm90aWZ5KCZuZXQtPmRl
diwKPiA+IEBAIC04MDgsNyArODIzLDcgQEAgc3RhdGljIHZvaWQgaGFuZGxlX3R4X2NvcHkoc3Ry
dWN0IHZob3N0X25ldCAqbmV0LCBzdHJ1Y3Qgc29ja2V0ICpzb2NrKQo+ID4gICAJCQkJZ290byBk
b25lOwo+ID4gICAJCQl9IGVsc2UgaWYgKHVubGlrZWx5KGVyciAhPSAtRU5PU1BDKSkgewo+ID4g
ICAJCQkJdmhvc3RfdHhfYmF0Y2gobmV0LCBudnEsIHNvY2ssICZtc2cpOwo+ID4gLQkJCQl2aG9z
dF9kaXNjYXJkX3ZxX2Rlc2ModnEsIDEpOwo+ID4gKwkJCQl2aG9zdF9kaXNjYXJkX2F2YWlsX2J1
ZnModnEsICZidWYsIDEpOwo+ID4gICAJCQkJdmhvc3RfbmV0X2VuYWJsZV92cShuZXQsIHZxKTsK
PiA+ICAgCQkJCWJyZWFrOwo+ID4gICAJCQl9Cj4gPiBAQCAtODI5LDcgKzg0NCw3IEBAIHN0YXRp
YyB2b2lkIGhhbmRsZV90eF9jb3B5KHN0cnVjdCB2aG9zdF9uZXQgKm5ldCwgc3RydWN0IHNvY2tl
dCAqc29jaykKPiA+ICAgCQkvKiBUT0RPOiBDaGVjayBzcGVjaWZpYyBlcnJvciBhbmQgYm9tYiBv
dXQgdW5sZXNzIEVOT0JVRlM/ICovCj4gPiAgIAkJZXJyID0gc29jay0+b3BzLT5zZW5kbXNnKHNv
Y2ssICZtc2csIGxlbik7Cj4gPiAgIAkJaWYgKHVubGlrZWx5KGVyciA8IDApKSB7Cj4gPiAtCQkJ
dmhvc3RfZGlzY2FyZF92cV9kZXNjKHZxLCAxKTsKPiA+ICsJCQl2aG9zdF9kaXNjYXJkX2F2YWls
X2J1ZnModnEsICZidWYsIDEpOwo+IAo+IAo+IERvIHdlIG5lZWQgdG8gZGVjcmVhc2UgZmlyc3Rf
ZGVzYyBpbiB2aG9zdF9kaXNjYXJkX2F2YWlsX2J1ZnMoKT8KPiAKPiAKPiA+ICAgCQkJdmhvc3Rf
bmV0X2VuYWJsZV92cShuZXQsIHZxKTsKPiA+ICAgCQkJYnJlYWs7Cj4gPiAgIAkJfQo+ID4gQEAg
LTgzNyw4ICs4NTIsNyBAQCBzdGF0aWMgdm9pZCBoYW5kbGVfdHhfY29weShzdHJ1Y3Qgdmhvc3Rf
bmV0ICpuZXQsIHN0cnVjdCBzb2NrZXQgKnNvY2spCj4gPiAgIAkJCXByX2RlYnVnKCJUcnVuY2F0
ZWQgVFggcGFja2V0OiBsZW4gJWQgIT0gJXpkXG4iLAo+ID4gICAJCQkJIGVyciwgbGVuKTsKPiA+
ICAgZG9uZToKPiA+IC0JCXZxLT5oZWFkc1tudnEtPmRvbmVfaWR4XS5pZCA9IGNwdV90b192aG9z
dDMyKHZxLCBoZWFkKTsKPiA+IC0JCXZxLT5oZWFkc1tudnEtPmRvbmVfaWR4XS5sZW4gPSAwOwo+
ID4gKwkJbnZxLT5idWZzW252cS0+ZG9uZV9pZHhdID0gYnVmOwo+ID4gICAJCSsrbnZxLT5kb25l
X2lkeDsKPiA+ICAgCX0gd2hpbGUgKGxpa2VseSghdmhvc3RfZXhjZWVkc193ZWlnaHQodnEsICsr
c2VudF9wa3RzLCB0b3RhbF9sZW4pKSk7Cj4gPiBAQCAtODUwLDcgKzg2NCw3IEBAIHN0YXRpYyB2
b2lkIGhhbmRsZV90eF96ZXJvY29weShzdHJ1Y3Qgdmhvc3RfbmV0ICpuZXQsIHN0cnVjdCBzb2Nr
ZXQgKnNvY2spCj4gPiAgIAlzdHJ1Y3Qgdmhvc3RfbmV0X3ZpcnRxdWV1ZSAqbnZxID0gJm5ldC0+
dnFzW1ZIT1NUX05FVF9WUV9UWF07Cj4gPiAgIAlzdHJ1Y3Qgdmhvc3RfdmlydHF1ZXVlICp2cSA9
ICZudnEtPnZxOwo+ID4gICAJdW5zaWduZWQgb3V0LCBpbjsKPiA+IC0JaW50IGhlYWQ7Cj4gPiAr
CWludCByZXQ7Cj4gPiAgIAlzdHJ1Y3QgbXNnaGRyIG1zZyA9IHsKPiA+ICAgCQkubXNnX25hbWUg
PSBOVUxMLAo+ID4gICAJCS5tc2dfbmFtZWxlbiA9IDAsCj4gPiBAQCAtODY0LDYgKzg3OCw3IEBA
IHN0YXRpYyB2b2lkIGhhbmRsZV90eF96ZXJvY29weShzdHJ1Y3Qgdmhvc3RfbmV0ICpuZXQsIHN0
cnVjdCBzb2NrZXQgKnNvY2spCj4gPiAgIAlzdHJ1Y3Qgdmhvc3RfbmV0X3VidWZfcmVmICp1bmlu
aXRpYWxpemVkX3Zhcih1YnVmcyk7Cj4gPiAgIAlib29sIHpjb3B5X3VzZWQ7Cj4gPiAgIAlpbnQg
c2VudF9wa3RzID0gMDsKPiA+ICsJc3RydWN0IHZob3N0X2J1ZiBidWY7Cj4gPiAgIAlkbyB7Cj4g
PiAgIAkJYm9vbCBidXN5bG9vcF9pbnRyOwo+ID4gQEAgLTg3MiwxMyArODg3LDEzIEBAIHN0YXRp
YyB2b2lkIGhhbmRsZV90eF96ZXJvY29weShzdHJ1Y3Qgdmhvc3RfbmV0ICpuZXQsIHN0cnVjdCBz
b2NrZXQgKnNvY2spCj4gPiAgIAkJdmhvc3RfemVyb2NvcHlfc2lnbmFsX3VzZWQobmV0LCB2cSk7
Cj4gPiAgIAkJYnVzeWxvb3BfaW50ciA9IGZhbHNlOwo+ID4gLQkJaGVhZCA9IGdldF90eF9idWZz
KG5ldCwgbnZxLCAmbXNnLCAmb3V0LCAmaW4sICZsZW4sCj4gPiAtCQkJCSAgICZidXN5bG9vcF9p
bnRyKTsKPiA+ICsJCXJldCA9IGdldF90eF9idWZzKG5ldCwgbnZxLCAmYnVmLCAmbXNnLCAmb3V0
LCAmaW4sICZsZW4sCj4gPiArCQkJCSAgJmJ1c3lsb29wX2ludHIpOwo+ID4gICAJCS8qIE9uIGVy
cm9yLCBzdG9wIGhhbmRsaW5nIHVudGlsIHRoZSBuZXh0IGtpY2suICovCj4gPiAtCQlpZiAodW5s
aWtlbHkoaGVhZCA8IDApKQo+ID4gKwkJaWYgKHVubGlrZWx5KHJldCA8IDApKQo+ID4gICAJCQli
cmVhazsKPiA+ICAgCQkvKiBOb3RoaW5nIG5ldz8gIFdhaXQgZm9yIGV2ZW50ZmQgdG8gdGVsbCB1
cyB0aGV5IHJlZmlsbGVkLiAqLwo+ID4gLQkJaWYgKGhlYWQgPT0gdnEtPm51bSkgewo+ID4gKwkJ
aWYgKCFyZXQpIHsKPiA+ICAgCQkJaWYgKHVubGlrZWx5KGJ1c3lsb29wX2ludHIpKSB7Cj4gPiAg
IAkJCQl2aG9zdF9wb2xsX3F1ZXVlKCZ2cS0+cG9sbCk7Cj4gPiAgIAkJCX0gZWxzZSBpZiAodW5s
aWtlbHkodmhvc3RfZW5hYmxlX25vdGlmeSgmbmV0LT5kZXYsIHZxKSkpIHsKPiA+IEBAIC04OTcs
OCArOTEyLDggQEAgc3RhdGljIHZvaWQgaGFuZGxlX3R4X3plcm9jb3B5KHN0cnVjdCB2aG9zdF9u
ZXQgKm5ldCwgc3RydWN0IHNvY2tldCAqc29jaykKPiA+ICAgCQkJc3RydWN0IHVidWZfaW5mbyAq
dWJ1ZjsKPiA+ICAgCQkJdWJ1ZiA9IG52cS0+dWJ1Zl9pbmZvICsgbnZxLT51cGVuZF9pZHg7Cj4g
PiAtCQkJdnEtPmhlYWRzW252cS0+dXBlbmRfaWR4XS5pZCA9IGNwdV90b192aG9zdDMyKHZxLCBo
ZWFkKTsKPiA+IC0JCQl2cS0+aGVhZHNbbnZxLT51cGVuZF9pZHhdLmxlbiA9IFZIT1NUX0RNQV9J
Tl9QUk9HUkVTUzsKPiA+ICsJCQludnEtPmJ1ZnNbbnZxLT51cGVuZF9pZHhdID0gYnVmOwo+ID4g
KwkJCW52cS0+YnVmc1tudnEtPnVwZW5kX2lkeF0uaW5fbGVuID0gVkhPU1RfRE1BX0lOX1BST0dS
RVNTOwo+ID4gICAJCQl1YnVmLT5jYWxsYmFjayA9IHZob3N0X3plcm9jb3B5X2NhbGxiYWNrOwo+
ID4gICAJCQl1YnVmLT5jdHggPSBudnEtPnVidWZzOwo+ID4gICAJCQl1YnVmLT5kZXNjID0gbnZx
LT51cGVuZF9pZHg7Cj4gPiBAQCAtOTMwLDE3ICs5NDUsMTkgQEAgc3RhdGljIHZvaWQgaGFuZGxl
X3R4X3plcm9jb3B5KHN0cnVjdCB2aG9zdF9uZXQgKm5ldCwgc3RydWN0IHNvY2tldCAqc29jaykK
PiA+ICAgCQkJCW52cS0+dXBlbmRfaWR4ID0gKCh1bnNpZ25lZCludnEtPnVwZW5kX2lkeCAtIDEp
Cj4gPiAgIAkJCQkJJSBVSU9fTUFYSU9WOwo+ID4gICAJCQl9Cj4gPiAtCQkJdmhvc3RfZGlzY2Fy
ZF92cV9kZXNjKHZxLCAxKTsKPiA+ICsJCQl2aG9zdF9kaXNjYXJkX2F2YWlsX2J1ZnModnEsICZi
dWYsIDEpOwo+ID4gICAJCQl2aG9zdF9uZXRfZW5hYmxlX3ZxKG5ldCwgdnEpOwo+ID4gICAJCQli
cmVhazsKPiA+ICAgCQl9Cj4gPiAgIAkJaWYgKGVyciAhPSBsZW4pCj4gPiAgIAkJCXByX2RlYnVn
KCJUcnVuY2F0ZWQgVFggcGFja2V0OiAiCj4gPiAgIAkJCQkgIiBsZW4gJWQgIT0gJXpkXG4iLCBl
cnIsIGxlbik7Cj4gPiAtCQlpZiAoIXpjb3B5X3VzZWQpCj4gPiAtCQkJdmhvc3RfYWRkX3VzZWRf
YW5kX3NpZ25hbCgmbmV0LT5kZXYsIHZxLCBoZWFkLCAwKTsKPiA+IC0JCWVsc2UKPiA+ICsJCWlm
ICghemNvcHlfdXNlZCkgewo+ID4gKwkJCXZob3N0X3B1dF91c2VkX2J1Zih2cSwgJmJ1Zik7Cj4g
PiArCQkJdmhvc3Rfc2lnbmFsKCZuZXQtPmRldiwgdnEpOwo+IAo+IAo+IERvIHdlIG5lZWQgc29t
ZXRoaW5nIGxpa2Ugdmhvc3RfcHV0X3VzZWRfYW5kX3NpZ25hbCgpPwo+IAo+IFRoYW5rcwo+IAo+
IAo+ID4gKwkJfSBlbHNlIHsKPiA+ICAgCQkJdmhvc3RfemVyb2NvcHlfc2lnbmFsX3VzZWQobmV0
LCB2cSk7Cj4gPiArCQl9Cj4gPiAgIAkJdmhvc3RfbmV0X3R4X3BhY2tldChuZXQpOwo+ID4gICAJ
fSB3aGlsZSAobGlrZWx5KCF2aG9zdF9leGNlZWRzX3dlaWdodCh2cSwgKytzZW50X3BrdHMsIHRv
dGFsX2xlbikpKTsKPiA+ICAgfQo+ID4gQEAgLTEwMDQsNyArMTAyMSw3IEBAIHN0YXRpYyBpbnQg
dmhvc3RfbmV0X3J4X3BlZWtfaGVhZF9sZW4oc3RydWN0IHZob3N0X25ldCAqbmV0LCBzdHJ1Y3Qg
c29jayAqc2ssCj4gPiAgIAlpbnQgbGVuID0gcGVla19oZWFkX2xlbihybnZxLCBzayk7Cj4gPiAg
IAlpZiAoIWxlbiAmJiBydnEtPmJ1c3lsb29wX3RpbWVvdXQpIHsKPiA+IC0JCS8qIEZsdXNoIGJh
dGNoZWQgaGVhZHMgZmlyc3QgKi8KPiA+ICsJCS8qIEZsdXNoIGJhdGNoZWQgYnVmcyBmaXJzdCAq
Lwo+ID4gICAJCXZob3N0X25ldF9zaWduYWxfdXNlZChybnZxKTsKPiA+ICAgCQkvKiBCb3RoIHR4
IHZxIGFuZCByeCBzb2NrZXQgd2VyZSBwb2xsZWQgaGVyZSAqLwo+ID4gICAJCXZob3N0X25ldF9i
dXN5X3BvbGwobmV0LCBydnEsIHR2cSwgYnVzeWxvb3BfaW50ciwgdHJ1ZSk7Cj4gPiBAQCAtMTAy
MiwxMSArMTAzOSwxMSBAQCBzdGF0aWMgaW50IHZob3N0X25ldF9yeF9wZWVrX2hlYWRfbGVuKHN0
cnVjdCB2aG9zdF9uZXQgKm5ldCwgc3RydWN0IHNvY2sgKnNrLAo+ID4gICAgKiBAaW92Y291bnQJ
LSByZXR1cm5lZCBjb3VudCBvZiBpbyB2ZWN0b3JzIHdlIGZpbGwKPiA+ICAgICogQGxvZwkJLSB2
aG9zdCBsb2cKPiA+ICAgICogQGxvZ19udW0JLSBsb2cgb2Zmc2V0Cj4gPiAtICogQHF1b3RhICAg
ICAgIC0gaGVhZGNvdW50IHF1b3RhLCAxIGZvciBiaWcgYnVmZmVyCj4gPiAtICoJcmV0dXJucyBu
dW1iZXIgb2YgYnVmZmVyIGhlYWRzIGFsbG9jYXRlZCwgbmVnYXRpdmUgb24gZXJyb3IKPiA+ICsg
KiBAcXVvdGEgICAgICAgLSBidWZjb3VudCBxdW90YSwgMSBmb3IgYmlnIGJ1ZmZlcgo+ID4gKyAq
CXJldHVybnMgbnVtYmVyIG9mIGJ1ZmZlcnMgYWxsb2NhdGVkLCBuZWdhdGl2ZSBvbiBlcnJvcgo+
ID4gICAgKi8KPiA+ICAgc3RhdGljIGludCBnZXRfcnhfYnVmcyhzdHJ1Y3Qgdmhvc3RfdmlydHF1
ZXVlICp2cSwKPiA+IC0JCSAgICAgICBzdHJ1Y3QgdnJpbmdfdXNlZF9lbGVtICpoZWFkcywKPiA+
ICsJCSAgICAgICBzdHJ1Y3Qgdmhvc3RfYnVmICpidWZzLAo+ID4gICAJCSAgICAgICBpbnQgZGF0
YWxlbiwKPiA+ICAgCQkgICAgICAgdW5zaWduZWQgKmlvdmNvdW50LAo+ID4gICAJCSAgICAgICBz
dHJ1Y3Qgdmhvc3RfbG9nICpsb2csCj4gPiBAQCAtMTAzNSwzMCArMTA1MiwyNCBAQCBzdGF0aWMg
aW50IGdldF9yeF9idWZzKHN0cnVjdCB2aG9zdF92aXJ0cXVldWUgKnZxLAo+ID4gICB7Cj4gPiAg
IAl1bnNpZ25lZCBpbnQgb3V0LCBpbjsKPiA+ICAgCWludCBzZWcgPSAwOwo+ID4gLQlpbnQgaGVh
ZGNvdW50ID0gMDsKPiA+IC0JdW5zaWduZWQgZDsKPiA+ICsJaW50IGJ1ZmNvdW50ID0gMDsKPiA+
ICAgCWludCByLCBubG9ncyA9IDA7Cj4gPiAgIAkvKiBsZW4gaXMgYWx3YXlzIGluaXRpYWxpemVk
IGJlZm9yZSB1c2Ugc2luY2Ugd2UgYXJlIGFsd2F5cyBjYWxsZWQgd2l0aAo+ID4gICAJICogZGF0
YWxlbiA+IDAuCj4gPiAgIAkgKi8KPiA+ICAgCXUzMiB1bmluaXRpYWxpemVkX3ZhcihsZW4pOwo+
ID4gLQl3aGlsZSAoZGF0YWxlbiA+IDAgJiYgaGVhZGNvdW50IDwgcXVvdGEpIHsKPiA+ICsJd2hp
bGUgKGRhdGFsZW4gPiAwICYmIGJ1ZmNvdW50IDwgcXVvdGEpIHsKPiA+ICAgCQlpZiAodW5saWtl
bHkoc2VnID49IFVJT19NQVhJT1YpKSB7Cj4gPiAgIAkJCXIgPSAtRU5PQlVGUzsKPiA+ICAgCQkJ
Z290byBlcnI7Cj4gPiAgIAkJfQo+ID4gLQkJciA9IHZob3N0X2dldF92cV9kZXNjKHZxLCB2cS0+
aW92ICsgc2VnLAo+ID4gLQkJCQkgICAgICBBUlJBWV9TSVpFKHZxLT5pb3YpIC0gc2VnLCAmb3V0
LAo+ID4gLQkJCQkgICAgICAmaW4sIGxvZywgbG9nX251bSk7Cj4gPiAtCQlpZiAodW5saWtlbHko
ciA8IDApKQo+ID4gKwkJciA9IHZob3N0X2dldF9hdmFpbF9idWYodnEsIGJ1ZnMgKyBidWZjb3Vu
dCwgdnEtPmlvdiArIHNlZywKPiA+ICsJCQkJCUFSUkFZX1NJWkUodnEtPmlvdikgLSBzZWcsICZv
dXQsCj4gPiArCQkJCQkmaW4sIGxvZywgbG9nX251bSk7Cj4gPiArCQlpZiAodW5saWtlbHkociA8
PSAwKSkKPiA+ICAgCQkJZ290byBlcnI7Cj4gPiAtCQlkID0gcjsKPiA+IC0JCWlmIChkID09IHZx
LT5udW0pIHsKPiA+IC0JCQlyID0gMDsKPiA+IC0JCQlnb3RvIGVycjsKPiA+IC0JCX0KPiA+ICAg
CQlpZiAodW5saWtlbHkob3V0IHx8IGluIDw9IDApKSB7Cj4gPiAgIAkJCXZxX2Vycih2cSwgInVu
ZXhwZWN0ZWQgZGVzY3JpcHRvciBmb3JtYXQgZm9yIFJYOiAiCj4gPiAgIAkJCQkib3V0ICVkLCBp
biAlZFxuIiwgb3V0LCBpbik7Cj4gPiBAQCAtMTA2OSwxNCArMTA4MCwxMiBAQCBzdGF0aWMgaW50
IGdldF9yeF9idWZzKHN0cnVjdCB2aG9zdF92aXJ0cXVldWUgKnZxLAo+ID4gICAJCQlubG9ncyAr
PSAqbG9nX251bTsKPiA+ICAgCQkJbG9nICs9ICpsb2dfbnVtOwo+ID4gICAJCX0KPiA+IC0JCWhl
YWRzW2hlYWRjb3VudF0uaWQgPSBjcHVfdG9fdmhvc3QzMih2cSwgZCk7Cj4gPiAgIAkJbGVuID0g
aW92X2xlbmd0aCh2cS0+aW92ICsgc2VnLCBpbik7Cj4gPiAtCQloZWFkc1toZWFkY291bnRdLmxl
biA9IGNwdV90b192aG9zdDMyKHZxLCBsZW4pOwo+ID4gICAJCWRhdGFsZW4gLT0gbGVuOwo+ID4g
LQkJKytoZWFkY291bnQ7Cj4gPiArCQkrK2J1ZmNvdW50Owo+ID4gICAJCXNlZyArPSBpbjsKPiA+
ICAgCX0KPiA+IC0JaGVhZHNbaGVhZGNvdW50IC0gMV0ubGVuID0gY3B1X3RvX3Zob3N0MzIodnEs
IGxlbiArIGRhdGFsZW4pOwo+ID4gKwlidWZzW2J1ZmNvdW50IC0gMV0uaW5fbGVuID0gbGVuICsg
ZGF0YWxlbjsKPiA+ICAgCSppb3Zjb3VudCA9IHNlZzsKPiA+ICAgCWlmICh1bmxpa2VseShsb2cp
KQo+ID4gICAJCSpsb2dfbnVtID0gbmxvZ3M7Cj4gPiBAQCAtMTA4Niw5ICsxMDk1LDkgQEAgc3Rh
dGljIGludCBnZXRfcnhfYnVmcyhzdHJ1Y3Qgdmhvc3RfdmlydHF1ZXVlICp2cSwKPiA+ICAgCQly
ID0gVUlPX01BWElPViArIDE7Cj4gPiAgIAkJZ290byBlcnI7Cj4gPiAgIAl9Cj4gPiAtCXJldHVy
biBoZWFkY291bnQ7Cj4gPiArCXJldHVybiBidWZjb3VudDsKPiA+ICAgZXJyOgo+ID4gLQl2aG9z
dF9kaXNjYXJkX3ZxX2Rlc2ModnEsIGhlYWRjb3VudCk7Cj4gPiArCXZob3N0X2Rpc2NhcmRfYXZh
aWxfYnVmcyh2cSwgYnVmcywgYnVmY291bnQpOwo+ID4gICAJcmV0dXJuIHI7Cj4gPiAgIH0KPiA+
IEBAIC0xMTEzLDcgKzExMjIsNyBAQCBzdGF0aWMgdm9pZCBoYW5kbGVfcngoc3RydWN0IHZob3N0
X25ldCAqbmV0KQo+ID4gICAJfTsKPiA+ICAgCXNpemVfdCB0b3RhbF9sZW4gPSAwOwo+ID4gICAJ
aW50IGVyciwgbWVyZ2VhYmxlOwo+ID4gLQlzMTYgaGVhZGNvdW50Owo+ID4gKwlpbnQgYnVmY291
bnQ7Cj4gPiAgIAlzaXplX3Qgdmhvc3RfaGxlbiwgc29ja19obGVuOwo+ID4gICAJc2l6ZV90IHZo
b3N0X2xlbiwgc29ja19sZW47Cj4gPiAgIAlib29sIGJ1c3lsb29wX2ludHIgPSBmYWxzZTsKPiA+
IEBAIC0xMTQ3LDE0ICsxMTU2LDE0IEBAIHN0YXRpYyB2b2lkIGhhbmRsZV9yeChzdHJ1Y3Qgdmhv
c3RfbmV0ICpuZXQpCj4gPiAgIAkJCWJyZWFrOwo+ID4gICAJCXNvY2tfbGVuICs9IHNvY2tfaGxl
bjsKPiA+ICAgCQl2aG9zdF9sZW4gPSBzb2NrX2xlbiArIHZob3N0X2hsZW47Cj4gPiAtCQloZWFk
Y291bnQgPSBnZXRfcnhfYnVmcyh2cSwgdnEtPmhlYWRzICsgbnZxLT5kb25lX2lkeCwKPiA+IC0J
CQkJCXZob3N0X2xlbiwgJmluLCB2cV9sb2csICZsb2csCj4gPiAtCQkJCQlsaWtlbHkobWVyZ2Vh
YmxlKSA/IFVJT19NQVhJT1YgOiAxKTsKPiA+ICsJCWJ1ZmNvdW50ID0gZ2V0X3J4X2J1ZnModnEs
IG52cS0+YnVmcyArIG52cS0+ZG9uZV9pZHgsCj4gPiArCQkJCSAgICAgICB2aG9zdF9sZW4sICZp
biwgdnFfbG9nLCAmbG9nLAo+ID4gKwkJCQkgICAgICAgbGlrZWx5KG1lcmdlYWJsZSkgPyBVSU9f
TUFYSU9WIDogMSk7Cj4gPiAgIAkJLyogT24gZXJyb3IsIHN0b3AgaGFuZGxpbmcgdW50aWwgdGhl
IG5leHQga2ljay4gKi8KPiA+IC0JCWlmICh1bmxpa2VseShoZWFkY291bnQgPCAwKSkKPiA+ICsJ
CWlmICh1bmxpa2VseShidWZjb3VudCA8IDApKQo+ID4gICAJCQlnb3RvIG91dDsKPiA+ICAgCQkv
KiBPSywgbm93IHdlIG5lZWQgdG8ga25vdyBhYm91dCBhZGRlZCBkZXNjcmlwdG9ycy4gKi8KPiA+
IC0JCWlmICghaGVhZGNvdW50KSB7Cj4gPiArCQlpZiAoIWJ1ZmNvdW50KSB7Cj4gPiAgIAkJCWlm
ICh1bmxpa2VseShidXN5bG9vcF9pbnRyKSkgewo+ID4gICAJCQkJdmhvc3RfcG9sbF9xdWV1ZSgm
dnEtPnBvbGwpOwo+ID4gICAJCQl9IGVsc2UgaWYgKHVubGlrZWx5KHZob3N0X2VuYWJsZV9ub3Rp
ZnkoJm5ldC0+ZGV2LCB2cSkpKSB7Cj4gPiBAQCAtMTE3MSw3ICsxMTgwLDcgQEAgc3RhdGljIHZv
aWQgaGFuZGxlX3J4KHN0cnVjdCB2aG9zdF9uZXQgKm5ldCkKPiA+ICAgCQlpZiAobnZxLT5yeF9y
aW5nKQo+ID4gICAJCQltc2cubXNnX2NvbnRyb2wgPSB2aG9zdF9uZXRfYnVmX2NvbnN1bWUoJm52
cS0+cnhxKTsKPiA+ICAgCQkvKiBPbiBvdmVycnVuLCB0cnVuY2F0ZSBhbmQgZGlzY2FyZCAqLwo+
ID4gLQkJaWYgKHVubGlrZWx5KGhlYWRjb3VudCA+IFVJT19NQVhJT1YpKSB7Cj4gPiArCQlpZiAo
dW5saWtlbHkoYnVmY291bnQgPiBVSU9fTUFYSU9WKSkgewo+ID4gICAJCQlpb3ZfaXRlcl9pbml0
KCZtc2cubXNnX2l0ZXIsIFJFQUQsIHZxLT5pb3YsIDEsIDEpOwo+ID4gICAJCQllcnIgPSBzb2Nr
LT5vcHMtPnJlY3Ztc2coc29jaywgJm1zZywKPiA+ICAgCQkJCQkJIDEsIE1TR19ET05UV0FJVCB8
IE1TR19UUlVOQyk7Cj4gPiBAQCAtMTE5NSw3ICsxMjA0LDcgQEAgc3RhdGljIHZvaWQgaGFuZGxl
X3J4KHN0cnVjdCB2aG9zdF9uZXQgKm5ldCkKPiA+ICAgCQlpZiAodW5saWtlbHkoZXJyICE9IHNv
Y2tfbGVuKSkgewo+ID4gICAJCQlwcl9kZWJ1ZygiRGlzY2FyZGVkIHJ4IHBhY2tldDogIgo+ID4g
ICAJCQkJICIgbGVuICVkLCBleHBlY3RlZCAlemRcbiIsIGVyciwgc29ja19sZW4pOwo+ID4gLQkJ
CXZob3N0X2Rpc2NhcmRfdnFfZGVzYyh2cSwgaGVhZGNvdW50KTsKPiA+ICsJCQl2aG9zdF9kaXNj
YXJkX2F2YWlsX2J1ZnModnEsIG52cS0+YnVmcyArIG52cS0+ZG9uZV9pZHgsIGJ1ZmNvdW50KTsK
PiA+ICAgCQkJY29udGludWU7Cj4gPiAgIAkJfQo+ID4gICAJCS8qIFN1cHBseSB2aXJ0aW9fbmV0
X2hkciBpZiBWSE9TVF9ORVRfRl9WSVJUSU9fTkVUX0hEUiAqLwo+ID4gQEAgLTEyMTQsMTUgKzEy
MjMsMTUgQEAgc3RhdGljIHZvaWQgaGFuZGxlX3J4KHN0cnVjdCB2aG9zdF9uZXQgKm5ldCkKPiA+
ICAgCQl9Cj4gPiAgIAkJLyogVE9ETzogU2hvdWxkIGNoZWNrIGFuZCBoYW5kbGUgY2hlY2tzdW0u
ICovCj4gPiAtCQludW1fYnVmZmVycyA9IGNwdV90b192aG9zdDE2KHZxLCBoZWFkY291bnQpOwo+
ID4gKwkJbnVtX2J1ZmZlcnMgPSBjcHVfdG9fdmhvc3QxNih2cSwgYnVmY291bnQpOwo+ID4gICAJ
CWlmIChsaWtlbHkobWVyZ2VhYmxlKSAmJgo+ID4gICAJCSAgICBjb3B5X3RvX2l0ZXIoJm51bV9i
dWZmZXJzLCBzaXplb2YgbnVtX2J1ZmZlcnMsCj4gPiAgIAkJCQkgJmZpeHVwKSAhPSBzaXplb2Yg
bnVtX2J1ZmZlcnMpIHsKPiA+ICAgCQkJdnFfZXJyKHZxLCAiRmFpbGVkIG51bV9idWZmZXJzIHdy
aXRlIik7Cj4gPiAtCQkJdmhvc3RfZGlzY2FyZF92cV9kZXNjKHZxLCBoZWFkY291bnQpOwo+ID4g
KwkJCXZob3N0X2Rpc2NhcmRfYXZhaWxfYnVmcyh2cSwgbnZxLT5idWZzICsgbnZxLT5kb25lX2lk
eCwgYnVmY291bnQpOwo+ID4gICAJCQlnb3RvIG91dDsKPiA+ICAgCQl9Cj4gPiAtCQludnEtPmRv
bmVfaWR4ICs9IGhlYWRjb3VudDsKPiA+ICsJCW52cS0+ZG9uZV9pZHggKz0gYnVmY291bnQ7Cj4g
PiAgIAkJaWYgKG52cS0+ZG9uZV9pZHggPiBWSE9TVF9ORVRfQkFUQ0gpCj4gPiAgIAkJCXZob3N0
X25ldF9zaWduYWxfdXNlZChudnEpOwo+ID4gICAJCWlmICh1bmxpa2VseSh2cV9sb2cpKQoKX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRp
b24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3Jn
Cmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1
YWxpemF0aW9u
