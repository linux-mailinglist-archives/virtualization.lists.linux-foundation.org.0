Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
	by mail.lfdr.de (Postfix) with ESMTPS id D13952F9BC1
	for <lists.virtualization@lfdr.de>; Mon, 18 Jan 2021 10:10:56 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by silver.osuosl.org (Postfix) with ESMTP id E083E20016;
	Mon, 18 Jan 2021 09:10:54 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 5iJWQVcdSb-C; Mon, 18 Jan 2021 09:10:52 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by silver.osuosl.org (Postfix) with ESMTP id 286912001C;
	Mon, 18 Jan 2021 09:10:52 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id E93EFC013A;
	Mon, 18 Jan 2021 09:10:51 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id E6F04C013A
 for <virtualization@lists.linux-foundation.org>;
 Mon, 18 Jan 2021 09:10:49 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by hemlock.osuosl.org (Postfix) with ESMTP id D0F5587060
 for <virtualization@lists.linux-foundation.org>;
 Mon, 18 Jan 2021 09:10:49 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id PCmWBpMtG+jl
 for <virtualization@lists.linux-foundation.org>;
 Mon, 18 Jan 2021 09:10:49 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [216.205.24.124])
 by hemlock.osuosl.org (Postfix) with ESMTPS id CBCD28702D
 for <virtualization@lists.linux-foundation.org>;
 Mon, 18 Jan 2021 09:10:48 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1610961047;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=TzTJs4ezB/yY9IJmEJpq3qUpKxULr6PlO/4tkvd75MM=;
 b=QQKE6Syi161WxxecTlBHM2alihRu0ehE9XacO1dB8zkEVbhREuKwNVsB42JLp1s7lm5k7o
 Ga5kqfdtok4IidJKBaPu+asHRH4BpfLXYB1E4V872p7XlaCAn3dJFtXr/DFG94g0GK4rPR
 dsH1GXl99KA7K6VLNBQcMgfWgP+4Nz0=
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-169-uvZskcWSPi6njHAqFZ0WrQ-1; Mon, 18 Jan 2021 04:10:42 -0500
X-MC-Unique: uvZskcWSPi6njHAqFZ0WrQ-1
Received: from smtp.corp.redhat.com (int-mx07.intmail.prod.int.phx2.redhat.com
 [10.5.11.22])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id E87AF107ACE4;
 Mon, 18 Jan 2021 09:10:39 +0000 (UTC)
Received: from [10.72.13.12] (ovpn-13-12.pek2.redhat.com [10.72.13.12])
 by smtp.corp.redhat.com (Postfix) with ESMTP id C579A10013C0;
 Mon, 18 Jan 2021 09:10:25 +0000 (UTC)
Subject: Re: [PATCH net-next v2 5/7] virtio-net, xsk: realize the function of
 xsk packet sending
To: Xuan Zhuo <xuanzhuo@linux.alibaba.com>, netdev@vger.kernel.org
References: <cover.1609837120.git.xuanzhuo@linux.alibaba.com>
 <cover.1610765285.git.xuanzhuo@linux.alibaba.com>
 <9e1f5a4b633887ce1f66e39bc762b8497a379a43.1610765285.git.xuanzhuo@linux.alibaba.com>
From: Jason Wang <jasowang@redhat.com>
Message-ID: <20e27fa0-c7c3-0cc3-bd27-19d1fe9b7717@redhat.com>
Date: Mon, 18 Jan 2021 17:10:24 +0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.10.0
MIME-Version: 1.0
In-Reply-To: <9e1f5a4b633887ce1f66e39bc762b8497a379a43.1610765285.git.xuanzhuo@linux.alibaba.com>
Content-Language: en-US
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.22
Cc: Song Liu <songliubraving@fb.com>, Martin KaFai Lau <kafai@fb.com>,
 Jesper Dangaard Brouer <hawk@kernel.org>,
 Daniel Borkmann <daniel@iogearbox.net>, "Michael S. Tsirkin" <mst@redhat.com>,
 Yonghong Song <yhs@fb.com>, John Fastabend <john.fastabend@gmail.com>,
 Alexei Starovoitov <ast@kernel.org>, Andrii Nakryiko <andrii@kernel.org>,
 Jonathan Lemon <jonathan.lemon@gmail.com>, KP Singh <kpsingh@kernel.org>,
 Jakub Kicinski <kuba@kernel.org>, bpf@vger.kernel.org,
 =?UTF-8?B?QmrDtnJuIFTDtnBlbA==?= <bjorn.topel@intel.com>,
 virtualization@lists.linux-foundation.org,
 "David S. Miller" <davem@davemloft.net>,
 Magnus Karlsson <magnus.karlsson@intel.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

Ck9uIDIwMjEvMS8xNiDkuIrljYgxMDo1OSwgWHVhbiBaaHVvIHdyb3RlOgo+IHZpcnRuZXRfeHNr
X3J1biB3aWxsIGJlIGNhbGxlZCBpbiB0aGUgdHggaW50ZXJydXB0IGhhbmRsaW5nIGZ1bmN0aW9u
Cj4gdmlydG5ldF9wb2xsX3R4Lgo+Cj4gVGhlIHNlbmRpbmcgcHJvY2VzcyBnZXRzIGRlc2MgZnJv
bSB0aGUgeHNrIHR4IHF1ZXVlLCBhbmQgYXNzZW1ibGVzIGl0IHRvCj4gc2VuZCB0aGUgZGF0YS4K
Pgo+IENvbXBhcmVkIHdpdGggb3RoZXIgZHJpdmVycywgYSBzcGVjaWFsIHBsYWNlIGlzIHRoYXQg
dGhlIHBhZ2Ugb2YgdGhlCj4gZGF0YSBpbiB4c2sgaXMgdXNlZCBoZXJlIGluc3RlYWQgb2YgdGhl
IGRtYSBhZGRyZXNzLiBCZWNhdXNlIHRoZSB2aXJ0aW8KPiBpbnRlcmZhY2UgZG9lcyBub3QgdXNl
IHRoZSBkbWEgYWRkcmVzcy4KPgo+IFNpZ25lZC1vZmYtYnk6IFh1YW4gWmh1byA8eHVhbnpodW9A
bGludXguYWxpYmFiYS5jb20+Cj4gLS0tCj4gICBkcml2ZXJzL25ldC92aXJ0aW9fbmV0LmMgfCAy
MDAgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0KPiAgIDEg
ZmlsZSBjaGFuZ2VkLCAxOTcgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKPgo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL25ldC92aXJ0aW9fbmV0LmMgYi9kcml2ZXJzL25ldC92aXJ0aW9fbmV0
LmMKPiBpbmRleCBhNjJkNDU2Li40MmFhOWFkIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvbmV0L3Zp
cnRpb19uZXQuYwo+ICsrKyBiL2RyaXZlcnMvbmV0L3ZpcnRpb19uZXQuYwo+IEBAIC0xMTksNiAr
MTE5LDggQEAgc3RydWN0IHZpcnRuZXRfeHNrX2hkciB7Cj4gICAJdTMyIGxlbjsKPiAgIH07Cj4g
ICAKPiArI2RlZmluZSBWSVJUTkVUX1NUQVRFX1hTS19XQUtFVVAgMQo+ICsKPiAgICNkZWZpbmUg
VklSVE5FVF9TUV9TVEFUKG0pCW9mZnNldG9mKHN0cnVjdCB2aXJ0bmV0X3NxX3N0YXRzLCBtKQo+
ICAgI2RlZmluZSBWSVJUTkVUX1JRX1NUQVQobSkJb2Zmc2V0b2Yoc3RydWN0IHZpcnRuZXRfcnFf
c3RhdHMsIG0pCj4gICAKPiBAQCAtMTYzLDkgKzE2NSwxMiBAQCBzdHJ1Y3Qgc2VuZF9xdWV1ZSB7
Cj4gICAJCXN0cnVjdCB4c2tfYnVmZl9wb29sICAgX19yY3UgKnBvb2w7Cj4gICAJCXN0cnVjdCB2
aXJ0bmV0X3hza19oZHIgX19yY3UgKmhkcjsKPiAgIAo+ICsJCXVuc2lnbmVkIGxvbmcgICAgICAg
ICAgc3RhdGU7Cj4gICAJCXU2NCAgICAgICAgICAgICAgICAgICAgaGRyX2NvbjsKPiAgIAkJdTY0
ICAgICAgICAgICAgICAgICAgICBoZHJfcHJvOwo+ICAgCQl1NjQgICAgICAgICAgICAgICAgICAg
IGhkcl9uOwo+ICsJCXN0cnVjdCB4ZHBfZGVzYyAgICAgICAgbGFzdF9kZXNjOwo+ICsJCWJvb2wg
ICAgICAgICAgICAgICAgICAgd2FpdF9zbG90Owo+ICAgCX0geHNrOwo+ICAgfTsKPiAgIAo+IEBA
IC0yODQsNiArMjg5LDggQEAgc3RhdGljIHZvaWQgX19mcmVlX29sZF94bWl0X3B0cihzdHJ1Y3Qg
c2VuZF9xdWV1ZSAqc3EsIGJvb2wgaW5fbmFwaSwKPiAgIAkJCQlib29sIHhza193YWtldXAsCj4g
ICAJCQkJdW5zaWduZWQgaW50ICpfcGFja2V0cywgdW5zaWduZWQgaW50ICpfYnl0ZXMpOwo+ICAg
c3RhdGljIHZvaWQgZnJlZV9vbGRfeG1pdF9za2JzKHN0cnVjdCBzZW5kX3F1ZXVlICpzcSwgYm9v
bCBpbl9uYXBpKTsKPiArc3RhdGljIGludCB2aXJ0bmV0X3hza19ydW4oc3RydWN0IHNlbmRfcXVl
dWUgKnNxLAo+ICsJCQkgICBzdHJ1Y3QgeHNrX2J1ZmZfcG9vbCAqcG9vbCwgaW50IGJ1ZGdldCk7
Cj4gICAKPiAgIHN0YXRpYyBib29sIGlzX3hkcF9mcmFtZSh2b2lkICpwdHIpCj4gICB7Cj4gQEAg
LTE1OTAsNiArMTU5Nyw4IEBAIHN0YXRpYyBpbnQgdmlydG5ldF9wb2xsX3R4KHN0cnVjdCBuYXBp
X3N0cnVjdCAqbmFwaSwgaW50IGJ1ZGdldCkKPiAgIAlzdHJ1Y3QgdmlydG5ldF9pbmZvICp2aSA9
IHNxLT52cS0+dmRldi0+cHJpdjsKPiAgIAl1bnNpZ25lZCBpbnQgaW5kZXggPSB2cTJ0eHEoc3Et
PnZxKTsKPiAgIAlzdHJ1Y3QgbmV0ZGV2X3F1ZXVlICp0eHE7Cj4gKwlzdHJ1Y3QgeHNrX2J1ZmZf
cG9vbCAqcG9vbDsKPiArCWludCB3b3JrID0gMDsKPiAgIAo+ICAgCWlmICh1bmxpa2VseShpc194
ZHBfcmF3X2J1ZmZlcl9xdWV1ZSh2aSwgaW5kZXgpKSkgewo+ICAgCQkvKiBXZSBkb24ndCBuZWVk
IHRvIGVuYWJsZSBjYiBmb3IgWERQICovCj4gQEAgLTE1OTksMTUgKzE2MDgsMjYgQEAgc3RhdGlj
IGludCB2aXJ0bmV0X3BvbGxfdHgoc3RydWN0IG5hcGlfc3RydWN0ICpuYXBpLCBpbnQgYnVkZ2V0
KQo+ICAgCj4gICAJdHhxID0gbmV0ZGV2X2dldF90eF9xdWV1ZSh2aS0+ZGV2LCBpbmRleCk7Cj4g
ICAJX19uZXRpZl90eF9sb2NrKHR4cSwgcmF3X3NtcF9wcm9jZXNzb3JfaWQoKSk7Cj4gLQlmcmVl
X29sZF94bWl0X3NrYnMoc3EsIHRydWUpOwo+ICsKPiArCXJjdV9yZWFkX2xvY2soKTsKPiArCXBv
b2wgPSByY3VfZGVyZWZlcmVuY2Uoc3EtPnhzay5wb29sKTsKPiArCWlmIChwb29sKSB7Cj4gKwkJ
d29yayA9IHZpcnRuZXRfeHNrX3J1bihzcSwgcG9vbCwgYnVkZ2V0KTsKPiArCQlyY3VfcmVhZF91
bmxvY2soKTsKPiArCX0gZWxzZSB7Cj4gKwkJcmN1X3JlYWRfdW5sb2NrKCk7Cj4gKwkJZnJlZV9v
bGRfeG1pdF9za2JzKHNxLCB0cnVlKTsKPiArCX0KPiArCj4gICAJX19uZXRpZl90eF91bmxvY2so
dHhxKTsKPiAgIAo+IC0JdmlydHF1ZXVlX25hcGlfY29tcGxldGUobmFwaSwgc3EtPnZxLCAwKTsK
PiArCWlmICh3b3JrIDwgYnVkZ2V0KQo+ICsJCXZpcnRxdWV1ZV9uYXBpX2NvbXBsZXRlKG5hcGks
IHNxLT52cSwgMCk7Cj4gICAKPiAgIAlpZiAoc3EtPnZxLT5udW1fZnJlZSA+PSAyICsgTUFYX1NL
Ql9GUkFHUykKPiAgIAkJbmV0aWZfdHhfd2FrZV9xdWV1ZSh0eHEpOwo+ICAgCj4gLQlyZXR1cm4g
MDsKPiArCXJldHVybiB3b3JrOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50IHhtaXRfc2tiKHN0
cnVjdCBzZW5kX3F1ZXVlICpzcSwgc3RydWN0IHNrX2J1ZmYgKnNrYikKPiBAQCAtMjY0Nyw2ICsy
NjY3LDE4MCBAQCBzdGF0aWMgaW50IHZpcnRuZXRfeGRwKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYs
IHN0cnVjdCBuZXRkZXZfYnBmICp4ZHApCj4gICAJfQo+ICAgfQo+ICAgCj4gK3N0YXRpYyBpbnQg
dmlydG5ldF94c2tfeG1pdChzdHJ1Y3Qgc2VuZF9xdWV1ZSAqc3EsIHN0cnVjdCB4c2tfYnVmZl9w
b29sICpwb29sLAo+ICsJCQkgICAgc3RydWN0IHhkcF9kZXNjICpkZXNjKQo+ICt7Cj4gKwlzdHJ1
Y3QgdmlydG5ldF9pbmZvICp2aSA9IHNxLT52cS0+dmRldi0+cHJpdjsKPiArCXZvaWQgKmRhdGEs
ICpwdHI7Cj4gKwlzdHJ1Y3QgcGFnZSAqcGFnZTsKPiArCXN0cnVjdCB2aXJ0bmV0X3hza19oZHIg
Knhza2hkcjsKPiArCXUzMiBpZHgsIG9mZnNldCwgbiwgaSwgY29weSwgY29waWVkOwo+ICsJdTY0
IGFkZHI7Cj4gKwlpbnQgZXJyLCBtOwo+ICsKPiArCWFkZHIgPSBkZXNjLT5hZGRyOwo+ICsKPiAr
CWRhdGEgPSB4c2tfYnVmZl9yYXdfZ2V0X2RhdGEocG9vbCwgYWRkcik7Cj4gKwlvZmZzZXQgPSBv
ZmZzZXRfaW5fcGFnZShkYXRhKTsKPiArCj4gKwkvKiBvbmUgZm9yIGhkciwgb25lIGZvciB0aGUg
Zmlyc3QgcGFnZSAqLwo+ICsJbiA9IDI7Cj4gKwltID0gZGVzYy0+bGVuIC0gKFBBR0VfU0laRSAt
IG9mZnNldCk7Cj4gKwlpZiAobSA+IDApIHsKPiArCQluICs9IG0gPj4gUEFHRV9TSElGVDsKPiAr
CQlpZiAobSAmIFBBR0VfTUFTSykKPiArCQkJKytuOwo+ICsKPiArCQluID0gbWluX3QodTMyLCBu
LCBBUlJBWV9TSVpFKHNxLT5zZykpOwo+ICsJfQo+ICsKPiArCWlkeCA9IHNxLT54c2suaGRyX2Nv
biAlIHNxLT54c2suaGRyX247CgoKSSBkb24ndCB1bmRlcnN0YW5kIHRoZSByZWFzb24gb2YgdGhl
IGhkciBhcnJheS4gSXQgbG9va3MgdG8gbWUgYWxsIG9mIAp0aGVtIGFyZSB6ZXJvIGFuZCByZWFk
IG9ubHkgZnJvbSBkZXZpY2UuCgpBbnkgcmVhc29uIGZvciBub3QgcmV1c2luZyBhIHNpbmdsZSBo
ZHIgZm9yIGFsbCB4ZHAgZGVzY3JpcHRvcnM/IE9yIAptYXliZSBpdCdzIHRpbWUgdG8gaW50cm9k
dWNlIFZJUlRJT19ORVRfRl9OT19IRFIuCgoKPiArCXhza2hkciA9ICZzcS0+eHNrLmhkcltpZHhd
Owo+ICsKPiArCS8qIHhza2hkci0+aGRyIGhhcyBiZWVuIG1lbXNldCB0byB6ZXJvLCBzbyBub3Qg
bmVlZCB0byBjbGVhciBhZ2FpbiAqLwo+ICsKPiArCXNnX2luaXRfdGFibGUoc3EtPnNnLCBuKTsK
PiArCXNnX3NldF9idWYoc3EtPnNnLCAmeHNraGRyLT5oZHIsIHZpLT5oZHJfbGVuKTsKPiArCj4g
Kwljb3BpZWQgPSAwOwo+ICsJZm9yIChpID0gMTsgaSA8IG47ICsraSkgewo+ICsJCWNvcHkgPSBt
aW5fdChpbnQsIGRlc2MtPmxlbiAtIGNvcGllZCwgUEFHRV9TSVpFIC0gb2Zmc2V0KTsKPiArCj4g
KwkJcGFnZSA9IHhza19idWZmX3Jhd19nZXRfcGFnZShwb29sLCBhZGRyICsgY29waWVkKTsKPiAr
Cj4gKwkJc2dfc2V0X3BhZ2Uoc3EtPnNnICsgaSwgcGFnZSwgY29weSwgb2Zmc2V0KTsKPiArCQlj
b3BpZWQgKz0gY29weTsKPiArCQlpZiAob2Zmc2V0KQo+ICsJCQlvZmZzZXQgPSAwOwo+ICsJfQoK
Ckl0IGxvb2tzIHRvIG1lIHdlIG5lZWQgdG8gdGVybWluYXRlIHRoZSBzZzoKCioqCiDCoCogdmly
dHF1ZXVlX2FkZF9vdXRidWYgLSBleHBvc2Ugb3V0cHV0IGJ1ZmZlcnMgdG8gb3RoZXIgZW5kCiDC
oCogQHZxOiB0aGUgc3RydWN0IHZpcnRxdWV1ZSB3ZSdyZSB0YWxraW5nIGFib3V0LgogwqAqIEBz
Zzogc2NhdHRlcmxpc3QgKG11c3QgYmUgd2VsbC1mb3JtZWQgYW5kIHRlcm1pbmF0ZWQhKQoKCj4g
Kwo+ICsJeHNraGRyLT5sZW4gPSBkZXNjLT5sZW47Cj4gKwlwdHIgPSB4ZHBfdG9fcHRyKCZ4c2to
ZHItPnR5cGUpOwo+ICsKPiArCWVyciA9IHZpcnRxdWV1ZV9hZGRfb3V0YnVmKHNxLT52cSwgc3Et
PnNnLCBuLCBwdHIsIEdGUF9BVE9NSUMpOwo+ICsJaWYgKHVubGlrZWx5KGVycikpCj4gKwkJc3Et
Pnhzay5sYXN0X2Rlc2MgPSAqZGVzYzsKPiArCWVsc2UKPiArCQlzcS0+eHNrLmhkcl9jb24rKzsK
PiArCj4gKwlyZXR1cm4gZXJyOwo+ICt9Cj4gKwo+ICtzdGF0aWMgYm9vbCB2aXJ0bmV0X3hza19k
ZXZfaXNfZnVsbChzdHJ1Y3Qgc2VuZF9xdWV1ZSAqc3EpCj4gK3sKPiArCWlmIChzcS0+dnEtPm51
bV9mcmVlIDwgMiArIE1BWF9TS0JfRlJBR1MpCj4gKwkJcmV0dXJuIHRydWU7Cj4gKwo+ICsJaWYg
KHNxLT54c2suaGRyX2NvbiA9PSBzcS0+eHNrLmhkcl9wcm8pCj4gKwkJcmV0dXJuIHRydWU7CgoK
Q2FuIHdlIHJlYWxseSByZWFjaCBoZXJlPwoKCj4gKwo+ICsJcmV0dXJuIGZhbHNlOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgaW50IHZpcnRuZXRfeHNrX3htaXRfemMoc3RydWN0IHNlbmRfcXVldWUgKnNx
LAo+ICsJCQkgICAgICAgc3RydWN0IHhza19idWZmX3Bvb2wgKnBvb2wsIHVuc2lnbmVkIGludCBi
dWRnZXQpCj4gK3sKPiArCXN0cnVjdCB4ZHBfZGVzYyBkZXNjOwo+ICsJaW50IGVyciwgcGFja2V0
ID0gMDsKPiArCWludCByZXQgPSAtRUFHQUlOOwo+ICsKPiArCWlmIChzcS0+eHNrLmxhc3RfZGVz
Yy5hZGRyKSB7Cj4gKwkJZXJyID0gdmlydG5ldF94c2tfeG1pdChzcSwgcG9vbCwgJnNxLT54c2su
bGFzdF9kZXNjKTsKPiArCQlpZiAodW5saWtlbHkoZXJyKSkKPiArCQkJcmV0dXJuIC1FQlVTWTsK
PiArCj4gKwkJKytwYWNrZXQ7Cj4gKwkJc3EtPnhzay5sYXN0X2Rlc2MuYWRkciA9IDA7Cj4gKwl9
Cj4gKwo+ICsJd2hpbGUgKGJ1ZGdldC0tID4gMCkgewo+ICsJCWlmICh2aXJ0bmV0X3hza19kZXZf
aXNfZnVsbChzcSkpIHsKPiArCQkJcmV0ID0gLUVCVVNZOwo+ICsJCQlicmVhazsKPiArCQl9CgoK
SXQgbG9va3MgdG8gbWUgd2Ugd2lsbCBhbHdheXMgaGl0IHRoaXMgaWYgdXNlcnNwYWNlIGlzIGZh
c3QuIEUuZyB3ZSAKZG9uJ3Qga2ljayB1bnRpbCB0aGUgdmlydHF1ZXVlIGlzIGZ1bGwgLi4uCgoK
PiArCj4gKwkJaWYgKCF4c2tfdHhfcGVla19kZXNjKHBvb2wsICZkZXNjKSkgewo+ICsJCQkvKiBk
b25lICovCj4gKwkJCXJldCA9IDA7Cj4gKwkJCWJyZWFrOwo+ICsJCX0KPiArCj4gKwkJZXJyID0g
dmlydG5ldF94c2tfeG1pdChzcSwgcG9vbCwgJmRlc2MpOwo+ICsJCWlmICh1bmxpa2VseShlcnIp
KSB7Cj4gKwkJCXJldCA9IC1FQlVTWTsKPiArCQkJYnJlYWs7Cj4gKwkJfQo+ICsKPiArCQkrK3Bh
Y2tldDsKPiArCX0KPiArCj4gKwlpZiAocGFja2V0KSB7Cj4gKwkJeHNrX3R4X3JlbGVhc2UocG9v
bCk7Cj4gKwo+ICsJCWlmICh2aXJ0cXVldWVfa2lja19wcmVwYXJlKHNxLT52cSkgJiYgdmlydHF1
ZXVlX25vdGlmeShzcS0+dnEpKSB7Cj4gKwkJCXU2NF9zdGF0c191cGRhdGVfYmVnaW4oJnNxLT5z
dGF0cy5zeW5jcCk7Cj4gKwkJCXNxLT5zdGF0cy5raWNrcysrOwo+ICsJCQl1NjRfc3RhdHNfdXBk
YXRlX2VuZCgmc3EtPnN0YXRzLnN5bmNwKTsKPiArCQl9Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIHJl
dDsKPiArfQo+ICsKPiArc3RhdGljIGludCB2aXJ0bmV0X3hza19ydW4oc3RydWN0IHNlbmRfcXVl
dWUgKnNxLAo+ICsJCQkgICBzdHJ1Y3QgeHNrX2J1ZmZfcG9vbCAqcG9vbCwgaW50IGJ1ZGdldCkK
PiArewo+ICsJaW50IGVyciwgcmV0ID0gMDsKPiArCXVuc2lnbmVkIGludCBfcGFja2V0cyA9IDA7
Cj4gKwl1bnNpZ25lZCBpbnQgX2J5dGVzID0gMDsKPiArCj4gKwlzcS0+eHNrLndhaXRfc2xvdCA9
IGZhbHNlOwo+ICsKPiArCV9fZnJlZV9vbGRfeG1pdF9wdHIoc3EsIHRydWUsIGZhbHNlLCAmX3Bh
Y2tldHMsICZfYnl0ZXMpOwo+ICsKPiArCWVyciA9IHZpcnRuZXRfeHNrX3htaXRfemMoc3EsIHBv
b2wsIHhza19idWRnZXQpOwo+ICsJaWYgKCFlcnIpIHsKPiArCQlzdHJ1Y3QgeGRwX2Rlc2MgZGVz
YzsKPiArCj4gKwkJY2xlYXJfYml0KFZJUlRORVRfU1RBVEVfWFNLX1dBS0VVUCwgJnNxLT54c2su
c3RhdGUpOwo+ICsJCXhza19zZXRfdHhfbmVlZF93YWtldXAocG9vbCk7Cj4gKwo+ICsJCS8qIFJh
Y2UgYnJlYWtlci4gSWYgbmV3IGlzIGNvbWluZyBhZnRlciBsYXN0IHhtaXQKPiArCQkgKiBidXQg
YmVmb3JlIGZsYWcgY2hhbmdlCj4gKwkJICovCj4gKwo+ICsJCWlmICgheHNrX3R4X3BlZWtfZGVz
Yyhwb29sLCAmZGVzYykpCj4gKwkJCWdvdG8gZW5kOwo+ICsKPiArCQlzZXRfYml0KFZJUlRORVRf
U1RBVEVfWFNLX1dBS0VVUCwgJnNxLT54c2suc3RhdGUpOwo+ICsJCXhza19jbGVhcl90eF9uZWVk
X3dha2V1cChwb29sKTsKCgpIb3cgbWVtb3J5IG9yZGVyaW5nIGlzIGdvaW5nIHRvIHdvcmsgaGVy
ZT8gT3Igd2UgZG9uJ3QgbmVlZCB0byBjYXJlIAphYm91dCB0aGF0PwoKCj4gKwo+ICsJCXNxLT54
c2subGFzdF9kZXNjID0gZGVzYzsKPiArCQlyZXQgPSBidWRnZXQ7Cj4gKwkJZ290byBlbmQ7Cj4g
Kwl9Cj4gKwo+ICsJeHNrX2NsZWFyX3R4X25lZWRfd2FrZXVwKHBvb2wpOwo+ICsKPiArCWlmIChl
cnIgPT0gLUVBR0FJTikgewo+ICsJCXJldCA9IGJ1ZGdldDsKPiArCQlnb3RvIGVuZDsKPiArCX0K
PiArCj4gKwlfX2ZyZWVfb2xkX3htaXRfcHRyKHNxLCB0cnVlLCBmYWxzZSwgJl9wYWNrZXRzLCAm
X2J5dGVzKTsKPiArCj4gKwlpZiAoIXZpcnRuZXRfeHNrX2Rldl9pc19mdWxsKHNxKSkgewo+ICsJ
CXJldCA9IGJ1ZGdldDsKPiArCQlnb3RvIGVuZDsKPiArCX0KPiArCj4gKwlzcS0+eHNrLndhaXRf
c2xvdCA9IHRydWU7Cj4gKwo+ICsJdmlydG5ldF9zcV9zdG9wX2NoZWNrKHNxLCB0cnVlKTsKPiAr
ZW5kOgo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiAgIHN0YXRpYyBpbnQgdmlydG5ldF9nZXRf
cGh5c19wb3J0X25hbWUoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgY2hhciAqYnVmLAo+ICAgCQkJ
CSAgICAgIHNpemVfdCBsZW4pCj4gICB7CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmlydHVhbGl6YXRp
b25AbGlzdHMubGludXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51eGZvdW5kYXRp
b24ub3JnL21haWxtYW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
