Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 9990D2787EF
	for <lists.virtualization@lfdr.de>; Fri, 25 Sep 2020 14:52:19 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 4D66786AEB;
	Fri, 25 Sep 2020 12:52:18 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id gpHNETo7QZYM; Fri, 25 Sep 2020 12:52:17 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id BF95586C9D;
	Fri, 25 Sep 2020 12:52:16 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 8A461C0859;
	Fri, 25 Sep 2020 12:52:16 +0000 (UTC)
X-Original-To: virtualization@lists.linuxfoundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 2B9DAC0890
 for <virtualization@lists.linuxfoundation.org>;
 Fri, 25 Sep 2020 12:52:14 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by whitealder.osuosl.org (Postfix) with ESMTP id 1970F86DD4
 for <virtualization@lists.linuxfoundation.org>;
 Fri, 25 Sep 2020 12:52:14 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id O7qU9+4uQSoH
 for <virtualization@lists.linuxfoundation.org>;
 Fri, 25 Sep 2020 12:52:12 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mail-wm1-f51.google.com (mail-wm1-f51.google.com
 [209.85.128.51])
 by whitealder.osuosl.org (Postfix) with ESMTPS id 2989786DD9
 for <virtualization@lists.linuxfoundation.org>;
 Fri, 25 Sep 2020 12:52:12 +0000 (UTC)
Received: by mail-wm1-f51.google.com with SMTP id q9so2947743wmj.2
 for <virtualization@lists.linuxfoundation.org>;
 Fri, 25 Sep 2020 05:52:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=2gc/eAiM6fc/9xFq9v+gXHzceFFWcZXTxfGGQdY3TKo=;
 b=lL+PE4Xcu99+Yf301fWBDOYOKBRFX4BGFnZJ9UM7e6YQx7nI3w4CwXaBrlDtW24dA7
 9yH0LGCvLuy+6BePjaLK1Vg1wGGk81aoyFSpUs2ZOC/clFHjzRFJ5XlSSO7/i7x/vkjN
 g0roGJSrbKQve6pS7JsMrp+kDyc9YYHw+3/f04F6DOnoJ1nQpXYmGJDG/RvPf7xuxmx7
 ouVpX/eJImiwkjssNy4cVXCMVUjntSt3ydwH8eVazGioYkm5+7tClPR79hX3PJa1G9Od
 Mm7sOQrVgX+nxEgdIFkHH8pbG3IUlI2fURFwA6jXVZzmfqpo/yNQtoPA9PVNEdHPHoJs
 BbsQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=2gc/eAiM6fc/9xFq9v+gXHzceFFWcZXTxfGGQdY3TKo=;
 b=kx/3Ph05UJ8+8f1VCIhSLjPBiElekP4t7ZbLBra7tInZtQ7PDYmaaMHutbkLhMoT/F
 m/plxWBB7/0p9s3Cw0szBFdMmwi1fovgNzuPnmRIJjWCX7G/XBD+1ywmEcoylVQNYWCJ
 F81/Ix9zkE8GV9tUVYiAu2gXXrOAchZjr1kkc93CgGAqxKsgr4A9kB9LdcoMLZ4u5/0k
 geWoStUq/c/QA5OWbuB68rsj4i5iwiYZthL9/1IL0sWkUy6uUzByjohrxxgSwM80DYBK
 2pmE0ICntQiX8wDCvDHCOrrKEONimqlHAYz8H4bOdwXQo+GwvZlJI6AV6OVBMgmWX763
 exGg==
X-Gm-Message-State: AOAM531RxfEcS6n9hfO6W4u5JgSWFTF/nnIq6cVXI4WL/CP5104Wz7vk
 /HMh+GySco8qRwiEpAxI4mU3Qw==
X-Google-Smtp-Source: ABdhPJxeBSupo8i5C6YvM07AtjMhDiqQ1xpAwpiJVWc7s3N20uU84fMRZW1sEDeRezUSSYo0TsiUYQ==
X-Received: by 2002:a1c:ed19:: with SMTP id l25mr3025751wmh.49.1601038330538; 
 Fri, 25 Sep 2020 05:52:10 -0700 (PDT)
Received: from zen.linaroharston ([51.148.130.216])
 by smtp.gmail.com with ESMTPSA id l126sm2849103wmf.39.2020.09.25.05.51.55
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 25 Sep 2020 05:52:00 -0700 (PDT)
Received: from zen.lan (localhost [127.0.0.1])
 by zen.linaroharston (Postfix) with ESMTP id 5E0241FF9B;
 Fri, 25 Sep 2020 13:51:49 +0100 (BST)
From: =?UTF-8?q?Alex=20Benn=C3=A9e?= <alex.bennee@linaro.org>
To: qemu-devel@nongnu.org, maxim.uvarov@linaro.org, joakim.bech@linaro.org,
 ilias.apalodimas@linaro.org, tomas.winkler@intel.com, yang.huang@intel.com,
 bing.zhu@intel.com, Matti.Moell@opensynergy.com, hmo@opensynergy.com
Subject: [RFC PATCH 12/19] tools/vhost-user-rpmb: import hmac_sha256 functions
Date: Fri, 25 Sep 2020 13:51:40 +0100
Message-Id: <20200925125147.26943-13-alex.bennee@linaro.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20200925125147.26943-1-alex.bennee@linaro.org>
References: <20200925125147.26943-1-alex.bennee@linaro.org>
MIME-Version: 1.0
Cc: jean-philippe@linaro.org, takahiro.akashi@linaro.org,
 virtualization@lists.linuxfoundation.org, arnd@linaro.org,
 stratos-dev@op-lists.linaro.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

V2UgbmVlZCB0byBjYWxjdWxhdGUgSE1BQy0yNTZTSEEgYXMgcGFydCBvZiB0aGUgcHJvdG9jb2wu
IFRvIGF2b2lkCm1ha2luZyB0aGUgZGFlbW9uIGRlcGVuZGVudCBvbiBRRU1VJ3MgaW50ZXJuYWwg
Y3J5cHRvIGxpYnJhcnkgd2UKaW1wb3J0IHRoZSBmdW5jdGlvbnMgaGVyZS4KClNpZ25lZC1vZmYt
Ynk6IEFsZXggQmVubsOpZSA8YWxleC5iZW5uZWVAbGluYXJvLm9yZz4KLS0tCiB0b29scy92aG9z
dC11c2VyLXJwbWIvaG1hY19zaGEyNTYuaCB8ICA4NyArKysrKysrKwogdG9vbHMvdmhvc3QtdXNl
ci1ycG1iL2htYWNfc2hhMjU2LmMgfCAzMzEgKysrKysrKysrKysrKysrKysrKysrKysrKysrKwog
dG9vbHMvdmhvc3QtdXNlci1ycG1iL21lc29uLmJ1aWxkICAgfCAgIDMgKy0KIDMgZmlsZXMgY2hh
bmdlZCwgNDIwIGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKIGNyZWF0ZSBtb2RlIDEwMDY0
NCB0b29scy92aG9zdC11c2VyLXJwbWIvaG1hY19zaGEyNTYuaAogY3JlYXRlIG1vZGUgMTAwNjQ0
IHRvb2xzL3Zob3N0LXVzZXItcnBtYi9obWFjX3NoYTI1Ni5jCgpkaWZmIC0tZ2l0IGEvdG9vbHMv
dmhvc3QtdXNlci1ycG1iL2htYWNfc2hhMjU2LmggYi90b29scy92aG9zdC11c2VyLXJwbWIvaG1h
Y19zaGEyNTYuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmU2N2E1
YmFlZGVjZAotLS0gL2Rldi9udWxsCisrKyBiL3Rvb2xzL3Zob3N0LXVzZXItcnBtYi9obWFjX3No
YTI1Ni5oCkBAIC0wLDAgKzEsODcgQEAKKy8qCisgKiBITUFDLVNIQS0yNTYgaW1wbGVtZW50YXRp
b24KKyAqIExhc3QgdXBkYXRlOiAwNi8xNS8yMDA1CisgKiBJc3N1ZSBkYXRlOiAgMDYvMTUvMjAw
NQorICoKKyAqIENvcHlyaWdodCAoQykgMjAwNSBPbGl2aWVyIEdheSA8b2xpdmllci5nYXlAYTMu
ZXBmbC5jaD4KKyAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuCisgKgorICogQ29weXJpZ2h0IChjKSAy
MDE2LCAyMDIwLCBMaW5hcm8gTGltaXRlZAorICogQWxsIHJpZ2h0cyByZXNlcnZlZC4KKyAqCisg
KiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRo
IG9yIHdpdGhvdXQKKyAqIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0
IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucworICogYXJlIG1ldDoKKyAqIDEuIFJlZGlzdHJpYnV0
aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0CisgKiAg
ICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2Ns
YWltZXIuCisgKiAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1
Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAorICogICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0
aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZQorICogICAgZG9jdW1lbnRh
dGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlv
bi4KKyAqIDMuIE5laXRoZXIgdGhlIG5hbWUgb2YgdGhlIHByb2plY3Qgbm9yIHRoZSBuYW1lcyBv
ZiBpdHMgY29udHJpYnV0b3JzCisgKiAgICBtYXkgYmUgdXNlZCB0byBlbmRvcnNlIG9yIHByb21v
dGUgcHJvZHVjdHMgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUKKyAqICAgIHdpdGhvdXQgc3Bl
Y2lmaWMgcHJpb3Igd3JpdHRlbiBwZXJtaXNzaW9uLgorICoKKyAqIFRISVMgU09GVFdBUkUgSVMg
UFJPVklERUQgQlkgVEhFIFBST0pFQ1QgQU5EIENPTlRSSUJVVE9SUyBgYEFTIElTJycgQU5ECisg
KiBBTlkgRVhQUkVTUyBPUiBJTVBMSUVEIFdBUlJBTlRJRVMsIElOQ0xVRElORywgQlVUIE5PVCBM
SU1JVEVEIFRPLCBUSEUKKyAqIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkg
QU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFCisgKiBBUkUgRElTQ0xBSU1FRC4g
IElOIE5PIEVWRU5UIFNIQUxMIFRIRSBQUk9KRUNUIE9SIENPTlRSSUJVVE9SUyBCRSBMSUFCTEUK
KyAqIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBM
QVJZLCBPUiBDT05TRVFVRU5USUFMCisgKiBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBOT1QgTElN
SVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUworICogT1IgU0VSVklDRVM7
IExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04p
CisgKiBIT1dFVkVSIENBVVNFRCBBTkQgT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRI
RVIgSU4gQ09OVFJBQ1QsIFNUUklDVAorICogTElBQklMSVRZLCBPUiBUT1JUIChJTkNMVURJTkcg
TkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWQorICogT1VUIE9GIFRI
RSBVU0UgT0YgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElU
WSBPRgorICogU1VDSCBEQU1BR0UuCisgKi8KKworI2lmbmRlZiBITUFDX1NIQTI1Nl9ICisjZGVm
aW5lIEhNQUNfU0hBMjU2X0gKKworI2RlZmluZSBTSEEyNTZfRElHRVNUX1NJWkUgKCAyNTYgLyA4
KQorI2RlZmluZSBTSEEyNTZfQkxPQ0tfU0laRSAgKCA1MTIgLyA4KQorCisjaWZuZGVmIFNIQTJf
VFlQRVMKKyNkZWZpbmUgU0hBMl9UWVBFUwordHlwZWRlZiB1bnNpZ25lZCBjaGFyIHVpbnQ4Owor
dHlwZWRlZiB1bnNpZ25lZCBpbnQgIHVpbnQzMjsKK3R5cGVkZWYgdW5zaWduZWQgbG9uZyBsb25n
IHVpbnQ2NDsKKyNlbmRpZgorCit0eXBlZGVmIHN0cnVjdCB7CisgICAgdW5zaWduZWQgaW50IHRv
dF9sZW47CisgICAgdW5zaWduZWQgaW50IGxlbjsKKyAgICB1bnNpZ25lZCBjaGFyIGJsb2NrWzIg
KiBTSEEyNTZfQkxPQ0tfU0laRV07CisgICAgdWludDMyIGhbOF07Cit9IHNoYTI1Nl9jdHg7CisK
K3ZvaWQgc2hhMjU2X2luaXQoc2hhMjU2X2N0eCAqIGN0eCk7Cit2b2lkIHNoYTI1Nl91cGRhdGUo
c2hhMjU2X2N0eCAqY3R4LCBjb25zdCB1bnNpZ25lZCBjaGFyICptZXNzYWdlLAorICAgICAgICAg
ICAgICAgICAgIHVuc2lnbmVkIGludCBsZW4pOwordm9pZCBzaGEyNTZfZmluYWwoc2hhMjU2X2N0
eCAqY3R4LCB1bnNpZ25lZCBjaGFyICpkaWdlc3QpOwordm9pZCBzaGEyNTYoY29uc3QgdW5zaWdu
ZWQgY2hhciAqbWVzc2FnZSwgdW5zaWduZWQgaW50IGxlbiwKKyAgICAgICAgICAgIHVuc2lnbmVk
IGNoYXIgKmRpZ2VzdCk7CisKK3R5cGVkZWYgc3RydWN0IHsKKyAgICBzaGEyNTZfY3R4IGN0eF9p
bnNpZGU7CisgICAgc2hhMjU2X2N0eCBjdHhfb3V0c2lkZTsKKworICAgIC8qIGZvciBobWFjX3Jl
aW5pdCAqLworICAgIHNoYTI1Nl9jdHggY3R4X2luc2lkZV9yZWluaXQ7CisgICAgc2hhMjU2X2N0
eCBjdHhfb3V0c2lkZV9yZWluaXQ7CisKKyAgICB1bnNpZ25lZCBjaGFyIGJsb2NrX2lwYWRbU0hB
MjU2X0JMT0NLX1NJWkVdOworICAgIHVuc2lnbmVkIGNoYXIgYmxvY2tfb3BhZFtTSEEyNTZfQkxP
Q0tfU0laRV07Cit9IGhtYWNfc2hhMjU2X2N0eDsKKwordm9pZCBobWFjX3NoYTI1Nl9pbml0KGht
YWNfc2hhMjU2X2N0eCAqY3R4LCBjb25zdCB1bnNpZ25lZCBjaGFyICprZXksCisgICAgICAgICAg
ICAgICAgICAgICAgdW5zaWduZWQgaW50IGtleV9zaXplKTsKK3ZvaWQgaG1hY19zaGEyNTZfcmVp
bml0KGhtYWNfc2hhMjU2X2N0eCAqY3R4KTsKK3ZvaWQgaG1hY19zaGEyNTZfdXBkYXRlKGhtYWNf
c2hhMjU2X2N0eCAqY3R4LCBjb25zdCB1bnNpZ25lZCBjaGFyICptZXNzYWdlLAorICAgICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG1lc3NhZ2VfbGVuKTsKK3ZvaWQgaG1hY19zaGEy
NTZfZmluYWwoaG1hY19zaGEyNTZfY3R4ICpjdHgsIHVuc2lnbmVkIGNoYXIgKm1hYywKKyAgICAg
ICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG1hY19zaXplKTsKK3ZvaWQgaG1hY19zaGEy
NTYoY29uc3QgdW5zaWduZWQgY2hhciAqa2V5LCB1bnNpZ25lZCBpbnQga2V5X3NpemUsCisgICAg
ICAgICAgICAgICAgIGNvbnN0IHVuc2lnbmVkIGNoYXIgKm1lc3NhZ2UsIHVuc2lnbmVkIGludCBt
ZXNzYWdlX2xlbiwKKyAgICAgICAgICAgICAgICAgdW5zaWduZWQgY2hhciAqbWFjLCB1bnNpZ25l
ZCBtYWNfc2l6ZSk7CisKKyNlbmRpZiAvKiAhSE1BQ19TSEEyNTZfSCAqLwpkaWZmIC0tZ2l0IGEv
dG9vbHMvdmhvc3QtdXNlci1ycG1iL2htYWNfc2hhMjU2LmMgYi90b29scy92aG9zdC11c2VyLXJw
bWIvaG1hY19zaGEyNTYuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAu
LmY2NjQwYTQ2YzYxNgotLS0gL2Rldi9udWxsCisrKyBiL3Rvb2xzL3Zob3N0LXVzZXItcnBtYi9o
bWFjX3NoYTI1Ni5jCkBAIC0wLDAgKzEsMzMxIEBACisvKgorICogSE1BQy1TSEEtMjU2IGltcGxl
bWVudGF0aW9uCisgKiBMYXN0IHVwZGF0ZTogMDYvMTUvMjAwNQorICogSXNzdWUgZGF0ZTogIDA2
LzE1LzIwMDUKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMDUgT2xpdmllciBHYXkgPG9saXZpZXIu
Z2F5QGEzLmVwZmwuY2g+CisgKiBBbGwgcmlnaHRzIHJlc2VydmVkLgorICoKKyAqIENvcHlyaWdo
dCAoYykgMjAxNiwgMjAyMCBMaW5hcm8gTGltaXRlZAorICogQWxsIHJpZ2h0cyByZXNlcnZlZC4K
KyAqCisgKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1z
LCB3aXRoIG9yIHdpdGhvdXQKKyAqIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRl
ZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucworICogYXJlIG1ldDoKKyAqIDEuIFJlZGlz
dHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0
CisgKiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5n
IGRpc2NsYWltZXIuCisgKiAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCBy
ZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAorICogICAgbm90aWNlLCB0aGlzIGxpc3Qgb2Yg
Y29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZQorICogICAgZG9j
dW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3Ry
aWJ1dGlvbi4KKyAqIDMuIE5laXRoZXIgdGhlIG5hbWUgb2YgdGhlIHByb2plY3Qgbm9yIHRoZSBu
YW1lcyBvZiBpdHMgY29udHJpYnV0b3JzCisgKiAgICBtYXkgYmUgdXNlZCB0byBlbmRvcnNlIG9y
IHByb21vdGUgcHJvZHVjdHMgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUKKyAqICAgIHdpdGhv
dXQgc3BlY2lmaWMgcHJpb3Igd3JpdHRlbiBwZXJtaXNzaW9uLgorICoKKyAqIFRISVMgU09GVFdB
UkUgSVMgUFJPVklERUQgQlkgVEhFIFBST0pFQ1QgQU5EIENPTlRSSUJVVE9SUyBgYEFTIElTJycg
QU5ECisgKiBBTlkgRVhQUkVTUyBPUiBJTVBMSUVEIFdBUlJBTlRJRVMsIElOQ0xVRElORywgQlVU
IE5PVCBMSU1JVEVEIFRPLCBUSEUKKyAqIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFC
SUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFCisgKiBBUkUgRElTQ0xB
SU1FRC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBQUk9KRUNUIE9SIENPTlRSSUJVVE9SUyBCRSBM
SUFCTEUKKyAqIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwgU1BFQ0lBTCwg
RVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFMCisgKiBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBO
T1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUworICogT1IgU0VS
VklDRVM7IExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJV
UFRJT04pCisgKiBIT1dFVkVSIENBVVNFRCBBTkQgT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFks
IFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVAorICogTElBQklMSVRZLCBPUiBUT1JUIChJTkNM
VURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWQorICogT1VU
IE9GIFRIRSBVU0UgT0YgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NT
SUJJTElUWSBPRgorICogU1VDSCBEQU1BR0UuCisgKi8KKworI2luY2x1ZGUgPHN0cmluZy5oPgor
CisjaW5jbHVkZSAiaG1hY19zaGEyNTYuaCIKKworLyogU0hBMjU2IGZ1bmN0aW9ucyAqLworCisj
ZGVmaW5lIFNIRlIoeCwgbikgICAgKHggPj4gbikKKyNkZWZpbmUgUk9UUih4LCBuKSAgICgoeCA+
PiBuKSB8ICh4IDw8ICgoc2l6ZW9mKHgpIDw8IDMpIC0gbikpKQorI2RlZmluZSBST1RMKHgsIG4p
ICAgKCh4IDw8IG4pIHwgKHggPj4gKChzaXplb2YoeCkgPDwgMykgLSBuKSkpCisjZGVmaW5lIENI
KHgsIHksIHopICAoKHggJiB5KSBeICh+eCAmIHopKQorI2RlZmluZSBNQUooeCwgeSwgeikgKCh4
ICYgeSkgXiAoeCAmIHopIF4gKHkgJiB6KSkKKworI2RlZmluZSBTSEEyNTZfRjEoeCkgKFJPVFIo
eCwgIDIpIF4gUk9UUih4LCAxMykgXiBST1RSKHgsIDIyKSkKKyNkZWZpbmUgU0hBMjU2X0YyKHgp
IChST1RSKHgsICA2KSBeIFJPVFIoeCwgMTEpIF4gUk9UUih4LCAyNSkpCisjZGVmaW5lIFNIQTI1
Nl9GMyh4KSAoUk9UUih4LCAgNykgXiBST1RSKHgsIDE4KSBeIFNIRlIoeCwgIDMpKQorI2RlZmlu
ZSBTSEEyNTZfRjQoeCkgKFJPVFIoeCwgMTcpIF4gUk9UUih4LCAxOSkgXiBTSEZSKHgsIDEwKSkK
KworI2RlZmluZSBVTlBBQ0szMih4LCBzdHIpICAgICAgICAgICAgICAgICAgICAgIFwKK3sgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgKigoc3RyKSAr
IDMpID0gKHVpbnQ4KSAoKHgpICAgICAgKTsgICAgICAgXAorICAgICooKHN0cikgKyAyKSA9ICh1
aW50OCkgKCh4KSA+PiAgOCk7ICAgICAgIFwKKyAgICAqKChzdHIpICsgMSkgPSAodWludDgpICgo
eCkgPj4gMTYpOyAgICAgICBcCisgICAgKigoc3RyKSArIDApID0gKHVpbnQ4KSAoKHgpID4+IDI0
KTsgICAgICAgXAorfQorCisjZGVmaW5lIFBBQ0szMihzdHIsIHgpICAgICAgICAgICAgICAgICAg
ICAgICAgXAoreyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICAqKHgpID0gICAoKHVpbnQzMikgKigoc3RyKSArIDMpICAgICAgKSAgICBcCisgICAgICAg
ICAgIHwgKCh1aW50MzIpICooKHN0cikgKyAyKSA8PCAgOCkgICAgXAorICAgICAgICAgICB8ICgo
dWludDMyKSAqKChzdHIpICsgMSkgPDwgMTYpICAgIFwKKyAgICAgICAgICAgfCAoKHVpbnQzMikg
Kigoc3RyKSArIDApIDw8IDI0KTsgICBcCit9CisKKyNkZWZpbmUgVU5QQUNLNjQoeCwgc3RyKSAg
ICAgICAgICAgICAgICAgICAgICBcCit7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgXAorICAgICooKHN0cikgKyA3KSA9ICh1aW50OCkgKCh4KSAgICAgICk7ICAg
ICAgIFwKKyAgICAqKChzdHIpICsgNikgPSAodWludDgpICgoeCkgPj4gIDgpOyAgICAgICBcCisg
ICAgKigoc3RyKSArIDUpID0gKHVpbnQ4KSAoKHgpID4+IDE2KTsgICAgICAgXAorICAgICooKHN0
cikgKyA0KSA9ICh1aW50OCkgKCh4KSA+PiAyNCk7ICAgICAgIFwKKyAgICAqKChzdHIpICsgMykg
PSAodWludDgpICgoeCkgPj4gMzIpOyAgICAgICBcCisgICAgKigoc3RyKSArIDIpID0gKHVpbnQ4
KSAoKHgpID4+IDQwKTsgICAgICAgXAorICAgICooKHN0cikgKyAxKSA9ICh1aW50OCkgKCh4KSA+
PiA0OCk7ICAgICAgIFwKKyAgICAqKChzdHIpICsgMCkgPSAodWludDgpICgoeCkgPj4gNTYpOyAg
ICAgICBcCit9CisKKyNkZWZpbmUgUEFDSzY0KHN0ciwgeCkgICAgICAgICAgICAgICAgICAgICAg
ICBcCit7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAg
ICooeCkgPSAgICgodWludDY0KSAqKChzdHIpICsgNykgICAgICApICAgIFwKKyAgICAgICAgICAg
fCAoKHVpbnQ2NCkgKigoc3RyKSArIDYpIDw8ICA4KSAgICBcCisgICAgICAgICAgIHwgKCh1aW50
NjQpICooKHN0cikgKyA1KSA8PCAxNikgICAgXAorICAgICAgICAgICB8ICgodWludDY0KSAqKChz
dHIpICsgNCkgPDwgMjQpICAgIFwKKyAgICAgICAgICAgfCAoKHVpbnQ2NCkgKigoc3RyKSArIDMp
IDw8IDMyKSAgICBcCisgICAgICAgICAgIHwgKCh1aW50NjQpICooKHN0cikgKyAyKSA8PCA0MCkg
ICAgXAorICAgICAgICAgICB8ICgodWludDY0KSAqKChzdHIpICsgMSkgPDwgNDgpICAgIFwKKyAg
ICAgICAgICAgfCAoKHVpbnQ2NCkgKigoc3RyKSArIDApIDw8IDU2KTsgICBcCit9CisKKyNkZWZp
bmUgU0hBMjU2X1NDUihpKSAgICAgICAgICAgICAgICAgICAgICAgICBcCit7ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIHdbaV0gPSAgU0hBMjU2X0Y0
KHdbaSAtICAyXSkgKyB3W2kgLSAgN10gIFwKKyAgICAgICAgICArIFNIQTI1Nl9GMyh3W2kgLSAx
NV0pICsgd1tpIC0gMTZdOyBcCit9CisKK3VpbnQzMiBzaGEyNTZfaDBbOF0gPQorICAgICAgICAg
ICAgezB4NmEwOWU2NjcsIDB4YmI2N2FlODUsIDB4M2M2ZWYzNzIsIDB4YTU0ZmY1M2EsCisgICAg
ICAgICAgICAgMHg1MTBlNTI3ZiwgMHg5YjA1Njg4YywgMHgxZjgzZDlhYiwgMHg1YmUwY2QxOX07
CisKK3VpbnQzMiBzaGEyNTZfa1s2NF0gPQorICAgICAgICAgICAgezB4NDI4YTJmOTgsIDB4NzEz
NzQ0OTEsIDB4YjVjMGZiY2YsIDB4ZTliNWRiYTUsCisgICAgICAgICAgICAgMHgzOTU2YzI1Yiwg
MHg1OWYxMTFmMSwgMHg5MjNmODJhNCwgMHhhYjFjNWVkNSwKKyAgICAgICAgICAgICAweGQ4MDdh
YTk4LCAweDEyODM1YjAxLCAweDI0MzE4NWJlLCAweDU1MGM3ZGMzLAorICAgICAgICAgICAgIDB4
NzJiZTVkNzQsIDB4ODBkZWIxZmUsIDB4OWJkYzA2YTcsIDB4YzE5YmYxNzQsCisgICAgICAgICAg
ICAgMHhlNDliNjljMSwgMHhlZmJlNDc4NiwgMHgwZmMxOWRjNiwgMHgyNDBjYTFjYywKKyAgICAg
ICAgICAgICAweDJkZTkyYzZmLCAweDRhNzQ4NGFhLCAweDVjYjBhOWRjLCAweDc2Zjk4OGRhLAor
ICAgICAgICAgICAgIDB4OTgzZTUxNTIsIDB4YTgzMWM2NmQsIDB4YjAwMzI3YzgsIDB4YmY1OTdm
YzcsCisgICAgICAgICAgICAgMHhjNmUwMGJmMywgMHhkNWE3OTE0NywgMHgwNmNhNjM1MSwgMHgx
NDI5Mjk2NywKKyAgICAgICAgICAgICAweDI3YjcwYTg1LCAweDJlMWIyMTM4LCAweDRkMmM2ZGZj
LCAweDUzMzgwZDEzLAorICAgICAgICAgICAgIDB4NjUwYTczNTQsIDB4NzY2YTBhYmIsIDB4ODFj
MmM5MmUsIDB4OTI3MjJjODUsCisgICAgICAgICAgICAgMHhhMmJmZThhMSwgMHhhODFhNjY0Yiwg
MHhjMjRiOGI3MCwgMHhjNzZjNTFhMywKKyAgICAgICAgICAgICAweGQxOTJlODE5LCAweGQ2OTkw
NjI0LCAweGY0MGUzNTg1LCAweDEwNmFhMDcwLAorICAgICAgICAgICAgIDB4MTlhNGMxMTYsIDB4
MWUzNzZjMDgsIDB4Mjc0ODc3NGMsIDB4MzRiMGJjYjUsCisgICAgICAgICAgICAgMHgzOTFjMGNi
MywgMHg0ZWQ4YWE0YSwgMHg1YjljY2E0ZiwgMHg2ODJlNmZmMywKKyAgICAgICAgICAgICAweDc0
OGY4MmVlLCAweDc4YTU2MzZmLCAweDg0Yzg3ODE0LCAweDhjYzcwMjA4LAorICAgICAgICAgICAg
IDB4OTBiZWZmZmEsIDB4YTQ1MDZjZWIsIDB4YmVmOWEzZjcsIDB4YzY3MTc4ZjJ9OworCisvKiBT
SEEtMjU2IGZ1bmN0aW9ucyAqLworCitzdGF0aWMgdm9pZCBzaGEyNTZfdHJhbnNmKHNoYTI1Nl9j
dHggKmN0eCwgY29uc3QgdW5zaWduZWQgY2hhciAqbWVzc2FnZSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgdW5zaWduZWQgaW50IGJsb2NrX25iKQoreworICAgIHVpbnQzMiB3WzY0XTsKKyAg
ICB1aW50MzIgd3ZbOF07CisgICAgdWludDMyIHQxLCB0MjsKKyAgICBjb25zdCB1bnNpZ25lZCBj
aGFyICpzdWJfYmxvY2s7CisgICAgaW50IGk7CisgICAgaW50IGo7CisKKyAgICBmb3IgKGkgPSAw
OyBpIDwgKGludCkgYmxvY2tfbmI7IGkrKykgeworICAgICAgICBzdWJfYmxvY2sgPSBtZXNzYWdl
ICsgKGkgPDwgNik7CisKKyAgICAgICAgZm9yIChqID0gMDsgaiA8IDE2OyBqKyspIHsKKyAgICAg
ICAgICAgIFBBQ0szMigmc3ViX2Jsb2NrW2ogPDwgMl0sICZ3W2pdKTsKKyAgICAgICAgfQorCisg
ICAgICAgIGZvciAoaiA9IDE2OyBqIDwgNjQ7IGorKykgeworICAgICAgICAgICAgU0hBMjU2X1ND
UihqKTsKKyAgICAgICAgfQorCisgICAgICAgIGZvciAoaiA9IDA7IGogPCA4OyBqKyspIHsKKyAg
ICAgICAgICAgIHd2W2pdID0gY3R4LT5oW2pdOworICAgICAgICB9CisKKyAgICAgICAgZm9yIChq
ID0gMDsgaiA8IDY0OyBqKyspIHsKKyAgICAgICAgICAgIHQxID0gd3ZbN10gKyBTSEEyNTZfRjIo
d3ZbNF0pICsgQ0god3ZbNF0sIHd2WzVdLCB3dls2XSkKKyAgICAgICAgICAgICAgICArIHNoYTI1
Nl9rW2pdICsgd1tqXTsKKyAgICAgICAgICAgIHQyID0gU0hBMjU2X0YxKHd2WzBdKSArIE1BSih3
dlswXSwgd3ZbMV0sIHd2WzJdKTsKKyAgICAgICAgICAgIHd2WzddID0gd3ZbNl07CisgICAgICAg
ICAgICB3dls2XSA9IHd2WzVdOworICAgICAgICAgICAgd3ZbNV0gPSB3dls0XTsKKyAgICAgICAg
ICAgIHd2WzRdID0gd3ZbM10gKyB0MTsKKyAgICAgICAgICAgIHd2WzNdID0gd3ZbMl07CisgICAg
ICAgICAgICB3dlsyXSA9IHd2WzFdOworICAgICAgICAgICAgd3ZbMV0gPSB3dlswXTsKKyAgICAg
ICAgICAgIHd2WzBdID0gdDEgKyB0MjsKKyAgICAgICAgfQorCisgICAgICAgIGZvciAoaiA9IDA7
IGogPCA4OyBqKyspIHsKKyAgICAgICAgICAgIGN0eC0+aFtqXSArPSB3dltqXTsKKyAgICAgICAg
fQorICAgIH0KK30KKwordm9pZCBzaGEyNTYoY29uc3QgdW5zaWduZWQgY2hhciAqbWVzc2FnZSwg
dW5zaWduZWQgaW50IGxlbiwgdW5zaWduZWQgY2hhciAqZGlnZXN0KQoreworICAgIHNoYTI1Nl9j
dHggY3R4OworCisgICAgc2hhMjU2X2luaXQoJmN0eCk7CisgICAgc2hhMjU2X3VwZGF0ZSgmY3R4
LCBtZXNzYWdlLCBsZW4pOworICAgIHNoYTI1Nl9maW5hbCgmY3R4LCBkaWdlc3QpOworfQorCit2
b2lkIHNoYTI1Nl9pbml0KHNoYTI1Nl9jdHggKmN0eCkKK3sKKyAgICBpbnQgaTsKKyAgICBmb3Ig
KGkgPSAwOyBpIDwgODsgaSsrKSB7CisgICAgICAgIGN0eC0+aFtpXSA9IHNoYTI1Nl9oMFtpXTsK
KyAgICB9CisKKyAgICBjdHgtPmxlbiA9IDA7CisgICAgY3R4LT50b3RfbGVuID0gMDsKK30KKwor
dm9pZCBzaGEyNTZfdXBkYXRlKHNoYTI1Nl9jdHggKmN0eCwgY29uc3QgdW5zaWduZWQgY2hhciAq
bWVzc2FnZSwKKyAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgbGVuKQoreworICAgIHVu
c2lnbmVkIGludCBibG9ja19uYjsKKyAgICB1bnNpZ25lZCBpbnQgbmV3X2xlbiwgcmVtX2xlbiwg
dG1wX2xlbjsKKyAgICBjb25zdCB1bnNpZ25lZCBjaGFyICpzaGlmdGVkX21lc3NhZ2U7CisKKyAg
ICB0bXBfbGVuID0gU0hBMjU2X0JMT0NLX1NJWkUgLSBjdHgtPmxlbjsKKyAgICByZW1fbGVuID0g
bGVuIDwgdG1wX2xlbiA/IGxlbiA6IHRtcF9sZW47CisKKyAgICBtZW1jcHkoJmN0eC0+YmxvY2tb
Y3R4LT5sZW5dLCBtZXNzYWdlLCByZW1fbGVuKTsKKworICAgIGlmIChjdHgtPmxlbiArIGxlbiA8
IFNIQTI1Nl9CTE9DS19TSVpFKSB7CisgICAgICAgIGN0eC0+bGVuICs9IGxlbjsKKyAgICAgICAg
cmV0dXJuOworICAgIH0KKworICAgIG5ld19sZW4gPSBsZW4gLSByZW1fbGVuOworICAgIGJsb2Nr
X25iID0gbmV3X2xlbiAvIFNIQTI1Nl9CTE9DS19TSVpFOworCisgICAgc2hpZnRlZF9tZXNzYWdl
ID0gbWVzc2FnZSArIHJlbV9sZW47CisKKyAgICBzaGEyNTZfdHJhbnNmKGN0eCwgY3R4LT5ibG9j
aywgMSk7CisgICAgc2hhMjU2X3RyYW5zZihjdHgsIHNoaWZ0ZWRfbWVzc2FnZSwgYmxvY2tfbmIp
OworCisgICAgcmVtX2xlbiA9IG5ld19sZW4gJSBTSEEyNTZfQkxPQ0tfU0laRTsKKworICAgIG1l
bWNweShjdHgtPmJsb2NrLCAmc2hpZnRlZF9tZXNzYWdlW2Jsb2NrX25iIDw8IDZdLAorICAgICAg
ICAgICByZW1fbGVuKTsKKworICAgIGN0eC0+bGVuID0gcmVtX2xlbjsKKyAgICBjdHgtPnRvdF9s
ZW4gKz0gKGJsb2NrX25iICsgMSkgPDwgNjsKK30KKwordm9pZCBzaGEyNTZfZmluYWwoc2hhMjU2
X2N0eCAqY3R4LCB1bnNpZ25lZCBjaGFyICpkaWdlc3QpCit7CisgICAgdW5zaWduZWQgaW50IGJs
b2NrX25iOworICAgIHVuc2lnbmVkIGludCBwbV9sZW47CisgICAgdW5zaWduZWQgaW50IGxlbl9i
OworICAgIGludCBpOworCisgICAgYmxvY2tfbmIgPSAoMSArICgoU0hBMjU2X0JMT0NLX1NJWkUg
LSA5KQorICAgICAgICAgICAgICAgICAgICAgPCAoY3R4LT5sZW4gJSBTSEEyNTZfQkxPQ0tfU0la
RSkpKTsKKworICAgIGxlbl9iID0gKGN0eC0+dG90X2xlbiArIGN0eC0+bGVuKSA8PCAzOworICAg
IHBtX2xlbiA9IGJsb2NrX25iIDw8IDY7CisKKyAgICBtZW1zZXQoY3R4LT5ibG9jayArIGN0eC0+
bGVuLCAwLCBwbV9sZW4gLSBjdHgtPmxlbik7CisgICAgY3R4LT5ibG9ja1tjdHgtPmxlbl0gPSAw
eDgwOworICAgIFVOUEFDSzMyKGxlbl9iLCBjdHgtPmJsb2NrICsgcG1fbGVuIC0gNCk7CisKKyAg
ICBzaGEyNTZfdHJhbnNmKGN0eCwgY3R4LT5ibG9jaywgYmxvY2tfbmIpOworCisgICAgZm9yIChp
ID0gMCA7IGkgPCA4OyBpKyspIHsKKyAgICAgICAgVU5QQUNLMzIoY3R4LT5oW2ldLCAmZGlnZXN0
W2kgPDwgMl0pOworICAgIH0KK30KKworLyogSE1BQy1TSEEtMjU2IGZ1bmN0aW9ucyAqLworCit2
b2lkIGhtYWNfc2hhMjU2X2luaXQoaG1hY19zaGEyNTZfY3R4ICpjdHgsIGNvbnN0IHVuc2lnbmVk
IGNoYXIgKmtleSwKKyAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQga2V5X3NpemUp
Cit7CisgICAgdW5zaWduZWQgaW50IGZpbGw7CisgICAgdW5zaWduZWQgaW50IG51bTsKKworICAg
IGNvbnN0IHVuc2lnbmVkIGNoYXIgKmtleV91c2VkOworICAgIHVuc2lnbmVkIGNoYXIga2V5X3Rl
bXBbU0hBMjU2X0RJR0VTVF9TSVpFXTsKKyAgICBpbnQgaTsKKworICAgIGlmIChrZXlfc2l6ZSA9
PSBTSEEyNTZfQkxPQ0tfU0laRSkgeworICAgICAgICBrZXlfdXNlZCA9IGtleTsKKyAgICAgICAg
bnVtID0gU0hBMjU2X0JMT0NLX1NJWkU7CisgICAgfSBlbHNlIHsKKyAgICAgICAgaWYgKGtleV9z
aXplID4gU0hBMjU2X0JMT0NLX1NJWkUpeworICAgICAgICAgICAgbnVtID0gU0hBMjU2X0RJR0VT
VF9TSVpFOworICAgICAgICAgICAgc2hhMjU2KGtleSwga2V5X3NpemUsIGtleV90ZW1wKTsKKyAg
ICAgICAgICAgIGtleV91c2VkID0ga2V5X3RlbXA7CisgICAgICAgIH0gZWxzZSB7IC8qIGtleV9z
aXplID4gU0hBMjU2X0JMT0NLX1NJWkUgKi8KKyAgICAgICAgICAgIGtleV91c2VkID0ga2V5Owor
ICAgICAgICAgICAgbnVtID0ga2V5X3NpemU7CisgICAgICAgIH0KKyAgICAgICAgZmlsbCA9IFNI
QTI1Nl9CTE9DS19TSVpFIC0gbnVtOworCisgICAgICAgIG1lbXNldChjdHgtPmJsb2NrX2lwYWQg
KyBudW0sIDB4MzYsIGZpbGwpOworICAgICAgICBtZW1zZXQoY3R4LT5ibG9ja19vcGFkICsgbnVt
LCAweDVjLCBmaWxsKTsKKyAgICB9CisKKyAgICBmb3IgKGkgPSAwOyBpIDwgKGludCkgbnVtOyBp
KyspIHsKKyAgICAgICAgY3R4LT5ibG9ja19pcGFkW2ldID0ga2V5X3VzZWRbaV0gXiAweDM2Owor
ICAgICAgICBjdHgtPmJsb2NrX29wYWRbaV0gPSBrZXlfdXNlZFtpXSBeIDB4NWM7CisgICAgfQor
CisgICAgc2hhMjU2X2luaXQoJmN0eC0+Y3R4X2luc2lkZSk7CisgICAgc2hhMjU2X3VwZGF0ZSgm
Y3R4LT5jdHhfaW5zaWRlLCBjdHgtPmJsb2NrX2lwYWQsIFNIQTI1Nl9CTE9DS19TSVpFKTsKKwor
ICAgIHNoYTI1Nl9pbml0KCZjdHgtPmN0eF9vdXRzaWRlKTsKKyAgICBzaGEyNTZfdXBkYXRlKCZj
dHgtPmN0eF9vdXRzaWRlLCBjdHgtPmJsb2NrX29wYWQsCisgICAgICAgICAgICAgICAgICBTSEEy
NTZfQkxPQ0tfU0laRSk7CisKKyAgICAvKiBmb3IgaG1hY19yZWluaXQgKi8KKyAgICBtZW1jcHko
JmN0eC0+Y3R4X2luc2lkZV9yZWluaXQsICZjdHgtPmN0eF9pbnNpZGUsCisgICAgICAgICAgIHNp
emVvZihzaGEyNTZfY3R4KSk7CisgICAgbWVtY3B5KCZjdHgtPmN0eF9vdXRzaWRlX3JlaW5pdCwg
JmN0eC0+Y3R4X291dHNpZGUsCisgICAgICAgICAgIHNpemVvZihzaGEyNTZfY3R4KSk7Cit9CisK
K3ZvaWQgaG1hY19zaGEyNTZfcmVpbml0KGhtYWNfc2hhMjU2X2N0eCAqY3R4KQoreworICAgIG1l
bWNweSgmY3R4LT5jdHhfaW5zaWRlLCAmY3R4LT5jdHhfaW5zaWRlX3JlaW5pdCwKKyAgICAgICAg
ICAgc2l6ZW9mKHNoYTI1Nl9jdHgpKTsKKyAgICBtZW1jcHkoJmN0eC0+Y3R4X291dHNpZGUsICZj
dHgtPmN0eF9vdXRzaWRlX3JlaW5pdCwKKyAgICAgICAgICAgc2l6ZW9mKHNoYTI1Nl9jdHgpKTsK
K30KKwordm9pZCBobWFjX3NoYTI1Nl91cGRhdGUoaG1hY19zaGEyNTZfY3R4ICpjdHgsIGNvbnN0
IHVuc2lnbmVkIGNoYXIgKm1lc3NhZ2UsCisgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25l
ZCBpbnQgbWVzc2FnZV9sZW4pCit7CisgICAgc2hhMjU2X3VwZGF0ZSgmY3R4LT5jdHhfaW5zaWRl
LCBtZXNzYWdlLCBtZXNzYWdlX2xlbik7Cit9CisKK3ZvaWQgaG1hY19zaGEyNTZfZmluYWwoaG1h
Y19zaGEyNTZfY3R4ICpjdHgsIHVuc2lnbmVkIGNoYXIgKm1hYywKKyAgICAgICAgICAgICAgICAg
ICAgICAgdW5zaWduZWQgaW50IG1hY19zaXplKQoreworICAgIHVuc2lnbmVkIGNoYXIgZGlnZXN0
X2luc2lkZVtTSEEyNTZfRElHRVNUX1NJWkVdOworICAgIHVuc2lnbmVkIGNoYXIgbWFjX3RlbXBb
U0hBMjU2X0RJR0VTVF9TSVpFXTsKKworICAgIHNoYTI1Nl9maW5hbCgmY3R4LT5jdHhfaW5zaWRl
LCBkaWdlc3RfaW5zaWRlKTsKKyAgICBzaGEyNTZfdXBkYXRlKCZjdHgtPmN0eF9vdXRzaWRlLCBk
aWdlc3RfaW5zaWRlLCBTSEEyNTZfRElHRVNUX1NJWkUpOworICAgIHNoYTI1Nl9maW5hbCgmY3R4
LT5jdHhfb3V0c2lkZSwgbWFjX3RlbXApOworICAgIG1lbWNweShtYWMsIG1hY190ZW1wLCBtYWNf
c2l6ZSk7Cit9CisKK3ZvaWQgaG1hY19zaGEyNTYoY29uc3QgdW5zaWduZWQgY2hhciAqa2V5LCB1
bnNpZ25lZCBpbnQga2V5X3NpemUsCisgICAgICAgICAgY29uc3QgdW5zaWduZWQgY2hhciAqbWVz
c2FnZSwgdW5zaWduZWQgaW50IG1lc3NhZ2VfbGVuLAorICAgICAgICAgIHVuc2lnbmVkIGNoYXIg
Km1hYywgdW5zaWduZWQgbWFjX3NpemUpCit7CisgICAgaG1hY19zaGEyNTZfY3R4IGN0eDsKKwor
ICAgIGhtYWNfc2hhMjU2X2luaXQoJmN0eCwga2V5LCBrZXlfc2l6ZSk7CisgICAgaG1hY19zaGEy
NTZfdXBkYXRlKCZjdHgsIG1lc3NhZ2UsIG1lc3NhZ2VfbGVuKTsKKyAgICBobWFjX3NoYTI1Nl9m
aW5hbCgmY3R4LCBtYWMsIG1hY19zaXplKTsKK30KZGlmZiAtLWdpdCBhL3Rvb2xzL3Zob3N0LXVz
ZXItcnBtYi9tZXNvbi5idWlsZCBiL3Rvb2xzL3Zob3N0LXVzZXItcnBtYi9tZXNvbi5idWlsZApp
bmRleCBjZjgwYmVkZDk5YWMuLmY5NjQ4MzdkMTUxZCAxMDA2NDQKLS0tIGEvdG9vbHMvdmhvc3Qt
dXNlci1ycG1iL21lc29uLmJ1aWxkCisrKyBiL3Rvb2xzL3Zob3N0LXVzZXItcnBtYi9tZXNvbi5i
dWlsZApAQCAtMSw1ICsxLDYgQEAKIGV4ZWN1dGFibGUoJ3Zob3N0LXVzZXItcnBtYicsIGZpbGVz
KAotICAnbWFpbi5jJyksCisgICdtYWluLmMnLAorICAnaG1hY19zaGEyNTYuYycpLAogICBkZXBl
bmRlbmNpZXM6IFtxZW11dXRpbCwgZ2xpYiwgZ2lvXSwKICAgbGlua193aXRoOiBbbGlidmhvc3Rf
dXNlcl0sCiAgIGluc3RhbGw6IHRydWUsCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApW
aXJ0dWFsaXphdGlvbkBsaXN0cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxp
bnV4Zm91bmRhdGlvbi5vcmcvbWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
