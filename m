Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
	by mail.lfdr.de (Postfix) with ESMTPS id E2A01155E4A
	for <lists.virtualization@lfdr.de>; Fri,  7 Feb 2020 19:36:25 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by silver.osuosl.org (Postfix) with ESMTP id 887F22264C;
	Fri,  7 Feb 2020 18:36:24 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id NmZ8Ed9fMkoF; Fri,  7 Feb 2020 18:36:18 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by silver.osuosl.org (Postfix) with ESMTP id 6EC0222730;
	Fri,  7 Feb 2020 18:36:02 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 3DF3CC013E;
	Fri,  7 Feb 2020 18:36:02 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 933C4C013E
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:57 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by fraxinus.osuosl.org (Postfix) with ESMTP id 7CD7B86969
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:57 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id wG4haQXViVd3
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:56 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by fraxinus.osuosl.org (Postfix) with ESMTPS id 135D886978
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:56 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 193CC305D356; Fri,  7 Feb 2020 20:16:41 +0200 (EET)
Received: from host.bbu.bitdefender.biz (unknown [195.210.4.22])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 0CF17305206F;
 Fri,  7 Feb 2020 20:16:41 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [RFC PATCH v7 56/78] KVM: introspection: add KVMI_VCPU_GET_CPUID
Date: Fri,  7 Feb 2020 20:16:14 +0200
Message-Id: <20200207181636.1065-57-alazar@bitdefender.com>
In-Reply-To: <20200207181636.1065-1-alazar@bitdefender.com>
References: <20200207181636.1065-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 Marian Rotariu <marian.c.rotariu@gmail.com>,
 Sean Christopherson <sean.j.christopherson@intel.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWFyaWFuIFJvdGFyaXUgPG1hcmlhbi5jLnJvdGFyaXVAZ21haWwuY29tPgoKVGhpcyBj
b21tYW5kIHJldHVybnMgYSBDUFVJRCBsZWFmIChhcyBzZWVuIGJ5IHRoZSBndWVzdCBPUykuCgpT
aWduZWQtb2ZmLWJ5OiBNYXJpYW4gUm90YXJpdSA8bWFyaWFuLmMucm90YXJpdUBnbWFpbC5jb20+
CkNvLWRldmVsb3BlZC1ieTogQWRhbGJlcnQgTGF6xINyIDxhbGF6YXJAYml0ZGVmZW5kZXIuY29t
PgpTaWduZWQtb2ZmLWJ5OiBBZGFsYmVydCBMYXrEg3IgPGFsYXphckBiaXRkZWZlbmRlci5jb20+
Ci0tLQogRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdCAgICAgICAgICAgICAgIHwgMzYg
KysrKysrKysrKysrKysrKysrKwogYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmggICAg
ICAgICAgICAgIHwgMTIgKysrKysrKwogYXJjaC94ODYva3ZtL2t2bWkuYyAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHwgMTkgKysrKysrKysrKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCAg
ICAgICAgICAgICAgICAgICAgIHwgIDEgKwogLi4uL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZf
NjQva3ZtaV90ZXN0LmMgIHwgMzQgKysrKysrKysrKysrKysrKysrCiB2aXJ0L2t2bS9pbnRyb3Nw
ZWN0aW9uL2t2bWlfaW50LmggICAgICAgICAgICAgfCAgNCArKysKIHZpcnQva3ZtL2ludHJvc3Bl
Y3Rpb24va3ZtaV9tc2cuYyAgICAgICAgICAgICB8IDE2ICsrKysrKysrKwogNyBmaWxlcyBjaGFu
Z2VkLCAxMjIgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRpb24vdmlydC9r
dm0va3ZtaS5yc3QgYi9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CmluZGV4IGZmMWZl
NWVjMmUxOC4uZjlmOTYxNTA5YzYxIDEwMDY0NAotLS0gYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3Zt
L2t2bWkucnN0CisrKyBiL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKQEAgLTYxOCw2
ICs2MTgsNDIgQEAgY3VycmVudGx5IGJlaW5nIGhhbmRsZWQgaXMgcmVwbGllZCB0by4KICogLUtW
TV9FQUdBSU4gLSB0aGUgc2VsZWN0ZWQgdkNQVSBjYW4ndCBiZSBpbnRyb3NwZWN0ZWQgeWV0CiAq
IC1LVk1fRU9QTk9UU1VQUCAtIHRoZSBjb21tYW5kIGhhc24ndCBiZWVuIHJlY2VpdmVkIGR1cmlu
ZyBhbiBpbnRyb3NwZWN0aW9uIGV2ZW50CiAKKzEzLiBLVk1JX1ZDUFVfR0VUX0NQVUlECistLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLQorCis6QXJjaGl0ZWN0dXJlczogeDg2Cis6VmVyc2lvbnM6ID49
IDEKKzpQYXJhbWV0ZXJzOgorCis6OgorCisJc3RydWN0IGt2bWlfdmNwdV9oZHI7CisJc3RydWN0
IGt2bWlfdmNwdV9nZXRfY3B1aWQgeworCQlfX3UzMiBmdW5jdGlvbjsKKwkJX191MzIgaW5kZXg7
CisJfTsKKworOlJldHVybnM6CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV9lcnJvcl9jb2RlOworCXN0
cnVjdCBrdm1pX3ZjcHVfZ2V0X2NwdWlkX3JlcGx5IHsKKwkJX191MzIgZWF4OworCQlfX3UzMiBl
Yng7CisJCV9fdTMyIGVjeDsKKwkJX191MzIgZWR4OworCX07CisKK1JldHVybnMgYSBDUFVJRCBs
ZWFmIChhcyBzZWVuIGJ5IHRoZSBndWVzdCBPUykuCisKKzpFcnJvcnM6CisKKyogLUtWTV9FSU5W
QUwgLSB0aGUgc2VsZWN0ZWQgdkNQVSBpcyBpbnZhbGlkCisqIC1LVk1fRUlOVkFMIC0gcGFkZGlu
ZyBpcyBub3QgemVybworKiAtS1ZNX0VBR0FJTiAtIHRoZSBzZWxlY3RlZCB2Q1BVIGNhbid0IGJl
IGludHJvc3BlY3RlZCB5ZXQKKyogLUtWTV9FTk9FTlQgLSB0aGUgc2VsZWN0ZWQgbGVhZiBpcyBu
b3QgcHJlc2VudCBvciBpcyBpbnZhbGlkCisKIEV2ZW50cwogPT09PT09CiAKZGlmZiAtLWdpdCBh
L2FyY2gveDg2L2luY2x1ZGUvdWFwaS9hc20va3ZtaS5oIGIvYXJjaC94ODYvaW5jbHVkZS91YXBp
L2FzbS9rdm1pLmgKaW5kZXggZjE0Njc0YzNjMTA5Li41N2M0OGFjZTQxN2YgMTAwNjQ0Ci0tLSBh
L2FyY2gveDg2L2luY2x1ZGUvdWFwaS9hc20va3ZtaS5oCisrKyBiL2FyY2gveDg2L2luY2x1ZGUv
dWFwaS9hc20va3ZtaS5oCkBAIC00NSw0ICs0NSwxNiBAQCBzdHJ1Y3Qga3ZtaV92Y3B1X2dldF9y
ZWdpc3RlcnNfcmVwbHkgewogCXN0cnVjdCBrdm1fbXNycyBtc3JzOwogfTsKIAorc3RydWN0IGt2
bWlfdmNwdV9nZXRfY3B1aWQgeworCV9fdTMyIGZ1bmN0aW9uOworCV9fdTMyIGluZGV4OworfTsK
Kworc3RydWN0IGt2bWlfdmNwdV9nZXRfY3B1aWRfcmVwbHkgeworCV9fdTMyIGVheDsKKwlfX3Uz
MiBlYng7CisJX191MzIgZWN4OworCV9fdTMyIGVkeDsKK307CisKICNlbmRpZiAvKiBfVUFQSV9B
U01fWDg2X0tWTUlfSCAqLwpkaWZmIC0tZ2l0IGEvYXJjaC94ODYva3ZtL2t2bWkuYyBiL2FyY2gv
eDg2L2t2bS9rdm1pLmMKaW5kZXggNjdjZjJkMTliYTBmLi5iYmE4NWYzMzM2MzkgMTAwNjQ0Ci0t
LSBhL2FyY2gveDg2L2t2bS9rdm1pLmMKKysrIGIvYXJjaC94ODYva3ZtL2t2bWkuYwpAQCAtNyw2
ICs3LDcgQEAKIAogI2luY2x1ZGUgImxpbnV4L2t2bV9ob3N0LmgiCiAjaW5jbHVkZSAieDg2Lmgi
CisjaW5jbHVkZSAiY3B1aWQuaCIKICNpbmNsdWRlICIuLi8uLi8uLi92aXJ0L2t2bS9pbnRyb3Nw
ZWN0aW9uL2t2bWlfaW50LmgiCiAKIHN0YXRpYyB1bnNpZ25lZCBpbnQga3ZtaV92Y3B1X21vZGUo
Y29uc3Qgc3RydWN0IGt2bV92Y3B1ICp2Y3B1LApAQCAtMTQwLDMgKzE0MSwyMSBAQCBpbnQga3Zt
aV9hcmNoX2NtZF92Y3B1X2dldF9yZWdpc3RlcnMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LAogCXJl
dHVybiBlcnI7CiAKIH0KKworaW50IGt2bWlfYXJjaF9jbWRfdmNwdV9nZXRfY3B1aWQoc3RydWN0
IGt2bV92Y3B1ICp2Y3B1LAorCQkJCSBjb25zdCBzdHJ1Y3Qga3ZtaV92Y3B1X2dldF9jcHVpZCAq
cmVxLAorCQkJCSBzdHJ1Y3Qga3ZtaV92Y3B1X2dldF9jcHVpZF9yZXBseSAqcnBsKQoreworCXN0
cnVjdCBrdm1fY3B1aWRfZW50cnkyICplOworCisJZSA9IGt2bV9maW5kX2NwdWlkX2VudHJ5KHZj
cHUsIHJlcS0+ZnVuY3Rpb24sIHJlcS0+aW5kZXgpOworCWlmICghZSkKKwkJcmV0dXJuIC1LVk1f
RU5PRU5UOworCisJcnBsLT5lYXggPSBlLT5lYXg7CisJcnBsLT5lYnggPSBlLT5lYng7CisJcnBs
LT5lY3ggPSBlLT5lY3g7CisJcnBsLT5lZHggPSBlLT5lZHg7CisKKwlyZXR1cm4gMDsKK30KZGlm
ZiAtLWdpdCBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmggYi9pbmNsdWRlL3VhcGkvbGludXgv
a3ZtaS5oCmluZGV4IDRkNWY2MzE3ZGIwMy4uMDU1MzVhN2Q5MzEzIDEwMDY0NAotLS0gYS9pbmNs
dWRlL3VhcGkvbGludXgva3ZtaS5oCisrKyBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKQEAg
LTMxLDYgKzMxLDcgQEAgZW51bSB7CiAJS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTID0gMTEsCiAJ
S1ZNSV9WQ1BVX0dFVF9SRUdJU1RFUlMgID0gMTIsCiAJS1ZNSV9WQ1BVX1NFVF9SRUdJU1RFUlMg
ID0gMTMsCisJS1ZNSV9WQ1BVX0dFVF9DUFVJRCAgICAgID0gMTQsCiAKIAlLVk1JX05VTV9NRVNT
QUdFUwogfTsKZGlmZiAtLWdpdCBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQv
a3ZtaV90ZXN0LmMgYi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVz
dC5jCmluZGV4IDZlNDQ5MDM0MGIzNi4uZmEyM2NhMGVkMGQ3IDEwMDY0NAotLS0gYS90b29scy90
ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCisrKyBiL3Rvb2xzL3Rlc3Rp
bmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKQEAgLTkwOSw2ICs5MDksMzkgQEAg
c3RhdGljIHZvaWQgdGVzdF9jbWRfdmNwdV9zZXRfcmVnaXN0ZXJzKHN0cnVjdCBrdm1fdm0gKnZt
KQogCWRpc2FibGVfdmNwdV9ldmVudCh2bSwgZXZlbnRfaWQpOwogfQogCitzdGF0aWMgaW50IGNt
ZF9nZXRfY3B1aWQoc3RydWN0IGt2bV92bSAqdm0sCisJCQkgX191MzIgZnVuY3Rpb24sIF9fdTMy
IGluZGV4LAorCQkJIHN0cnVjdCBrdm1pX3ZjcHVfZ2V0X2NwdWlkX3JlcGx5ICpycGwpCit7CisJ
c3RydWN0IHsKKwkJc3RydWN0IGt2bWlfbXNnX2hkciBoZHI7CisJCXN0cnVjdCBrdm1pX3ZjcHVf
aGRyIHZjcHVfaGRyOworCQlzdHJ1Y3Qga3ZtaV92Y3B1X2dldF9jcHVpZCBjbWQ7CisJfSByZXEg
PSB7fTsKKworCXJlcS5jbWQuZnVuY3Rpb24gPSBmdW5jdGlvbjsKKwlyZXEuY21kLmluZGV4ID0g
aW5kZXg7CisKKwlyZXR1cm4gZG9fdmNwdTBfY29tbWFuZCh2bSwgS1ZNSV9WQ1BVX0dFVF9DUFVJ
RCwgJnJlcS5oZHIsIHNpemVvZihyZXEpLAorCQkJCXJwbCwgc2l6ZW9mKCpycGwpKTsKK30KKwor
c3RhdGljIHZvaWQgdGVzdF9jbWRfdmNwdV9nZXRfY3B1aWQoc3RydWN0IGt2bV92bSAqdm0pCit7
CisJc3RydWN0IGt2bWlfdmNwdV9nZXRfY3B1aWRfcmVwbHkgcnBsID0ge307CisJX191MzIgZnVu
Y3Rpb24gPSAwOworCV9fdTMyIGluZGV4ID0gMDsKKwlpbnQgcjsKKworCXIgPSBjbWRfZ2V0X2Nw
dWlkKHZtLCBmdW5jdGlvbiwgaW5kZXgsICZycGwpOworCVRFU1RfQVNTRVJUKHIgPT0gMCwKKwkJ
IktWTUlfVkNQVV9HRVRfQ1BVSUQgZmFpbGVkLCBlcnJvciAlZCglcylcbiIsCisJCS1yLCBrdm1f
c3RyZXJyb3IoLXIpKTsKKworCURFQlVHKCJjcHVpZCgldSwgJXUpID0+IGVheCAweCUuOHgsIGVi
eCAweCUuOHgsIGVjeCAweCUuOHgsIGVkeCAweCUuOHhcbiIsCisJICAgICAgZnVuY3Rpb24sIGlu
ZGV4LCBycGwuZWF4LCBycGwuZWJ4LCBycGwuZWN4LCBycGwuZWR4KTsKK30KKwogc3RhdGljIHZv
aWQgdGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQogewogCXNldHVwX3NvY2tl
dCgpOwpAQCAtOTI3LDYgKzk2MCw3IEBAIHN0YXRpYyB2b2lkIHRlc3RfaW50cm9zcGVjdGlvbihz
dHJ1Y3Qga3ZtX3ZtICp2bSkKIAl0ZXN0X2NtZF92Y3B1X2NvbnRyb2xfZXZlbnRzKHZtKTsKIAl0
ZXN0X2NtZF92Y3B1X2dldF9yZWdpc3RlcnModm0pOwogCXRlc3RfY21kX3ZjcHVfc2V0X3JlZ2lz
dGVycyh2bSk7CisJdGVzdF9jbWRfdmNwdV9nZXRfY3B1aWQodm0pOwogCiAJdW5ob29rX2ludHJv
c3BlY3Rpb24odm0pOwogfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1p
X2ludC5oIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCmluZGV4IGE3MzZmMzY0
ZjViZS4uMWIzZDg5NThlNmM4IDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2
bWlfaW50LmgKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCkBAIC0zOCw2
ICszOCw3IEBACiAJCQl8IEJJVChLVk1JX1ZDUFVfR0VUX0lORk8pIFwKIAkJCXwgQklUKEtWTUlf
VkNQVV9QQVVTRSkgXAogCQkJfCBCSVQoS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTKSBcCisJCQl8
IEJJVChLVk1JX1ZDUFVfR0VUX0NQVUlEKSBcCiAJCQl8IEJJVChLVk1JX1ZDUFVfR0VUX1JFR0lT
VEVSUykgXAogCQkJfCBCSVQoS1ZNSV9WQ1BVX1NFVF9SRUdJU1RFUlMpIFwKIAkJKQpAQCAtOTIs
NSArOTMsOCBAQCBpbnQga3ZtaV9hcmNoX2NtZF92Y3B1X2dldF9yZWdpc3RlcnMoc3RydWN0IGt2
bV92Y3B1ICp2Y3B1LAogCQkJCWNvbnN0IHN0cnVjdCBrdm1pX3ZjcHVfZ2V0X3JlZ2lzdGVycyAq
cmVxLAogCQkJCXN0cnVjdCBrdm1pX3ZjcHVfZ2V0X3JlZ2lzdGVyc19yZXBseSAqKmRlc3QsCiAJ
CQkJc2l6ZV90ICpkZXN0X3NpemUpOworaW50IGt2bWlfYXJjaF9jbWRfdmNwdV9nZXRfY3B1aWQo
c3RydWN0IGt2bV92Y3B1ICp2Y3B1LAorCQkJCSBjb25zdCBzdHJ1Y3Qga3ZtaV92Y3B1X2dldF9j
cHVpZCAqcmVxLAorCQkJCSBzdHJ1Y3Qga3ZtaV92Y3B1X2dldF9jcHVpZF9yZXBseSAqcnBsKTsK
IAogI2VuZGlmCmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMg
Yi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKaW5kZXggMTFlMDE3MTA3NmM3Li4x
MTg3M2NiM2MyM2IgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cu
YworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKQEAgLTI2LDYgKzI2LDcg
QEAgc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IG1zZ19JRHNbXSA9IHsKIAlbS1ZNSV9WTV9SRUFE
X1BIWVNJQ0FMXSAgICA9ICJLVk1JX1ZNX1JFQURfUEhZU0lDQUwiLAogCVtLVk1JX1ZNX1dSSVRF
X1BIWVNJQ0FMXSAgID0gIktWTUlfVk1fV1JJVEVfUEhZU0lDQUwiLAogCVtLVk1JX1ZDUFVfQ09O
VFJPTF9FVkVOVFNdID0gIktWTUlfVkNQVV9DT05UUk9MX0VWRU5UUyIsCisJW0tWTUlfVkNQVV9H
RVRfQ1BVSURdICAgICAgPSAiS1ZNSV9WQ1BVX0dFVF9DUFVJRCIsCiAJW0tWTUlfVkNQVV9HRVRf
SU5GT10gICAgICAgPSAiS1ZNSV9WQ1BVX0dFVF9JTkZPIiwKIAlbS1ZNSV9WQ1BVX0dFVF9SRUdJ
U1RFUlNdICA9ICJLVk1JX1ZDUFVfR0VUX1JFR0lTVEVSUyIsCiAJW0tWTUlfVkNQVV9QQVVTRV0g
ICAgICAgICAgPSAiS1ZNSV9WQ1BVX1BBVVNFIiwKQEAgLTQ2NCw2ICs0NjUsMjAgQEAgc3RhdGlj
IGludCBoYW5kbGVfc2V0X3JlZ2lzdGVycyhjb25zdCBzdHJ1Y3Qga3ZtaV92Y3B1X2NtZF9qb2Ig
KmpvYiwKIAlyZXR1cm4ga3ZtaV9tc2dfdmNwdV9yZXBseShqb2IsIG1zZywgZWMsIE5VTEwsIDAp
OwogfQogCitzdGF0aWMgaW50IGhhbmRsZV9nZXRfY3B1aWQoY29uc3Qgc3RydWN0IGt2bWlfdmNw
dV9jbWRfam9iICpqb2IsCisJCQkgICAgY29uc3Qgc3RydWN0IGt2bWlfbXNnX2hkciAqbXNnLAor
CQkJICAgIGNvbnN0IHZvaWQgKnJlcSkKK3sKKwlzdHJ1Y3Qga3ZtaV92Y3B1X2dldF9jcHVpZF9y
ZXBseSBycGw7CisJaW50IGVjOworCisJbWVtc2V0KCZycGwsIDAsIHNpemVvZihycGwpKTsKKwor
CWVjID0ga3ZtaV9hcmNoX2NtZF92Y3B1X2dldF9jcHVpZChqb2ItPnZjcHUsIHJlcSwgJnJwbCk7
CisKKwlyZXR1cm4ga3ZtaV9tc2dfdmNwdV9yZXBseShqb2IsIG1zZywgZWMsICZycGwsIHNpemVv
ZihycGwpKTsKK30KKwogLyoKICAqIFRoZXNlIGNvbW1hbmRzIGFyZSBleGVjdXRlZCBvbiB0aGUg
dkNQVSB0aHJlYWQuIFRoZSByZWNlaXZpbmcgdGhyZWFkCiAgKiBwYXNzZXMgdGhlIG1lc3NhZ2Vz
IHVzaW5nIGEgbmV3bHkgYWxsb2NhdGVkICdzdHJ1Y3Qga3ZtaV92Y3B1X2NtZF9qb2InCkBAIC00
NzQsNiArNDg5LDcgQEAgc3RhdGljIGludCgqY29uc3QgbXNnX3ZjcHVbXSkoY29uc3Qgc3RydWN0
IGt2bWlfdmNwdV9jbWRfam9iICosCiAJCQkgICAgICBjb25zdCBzdHJ1Y3Qga3ZtaV9tc2dfaGRy
ICosIGNvbnN0IHZvaWQgKikgPSB7CiAJW0tWTUlfRVZFTlRfUkVQTFldICAgICAgICAgPSBoYW5k
bGVfZXZlbnRfcmVwbHksCiAJW0tWTUlfVkNQVV9DT05UUk9MX0VWRU5UU10gPSBoYW5kbGVfdmNw
dV9jb250cm9sX2V2ZW50cywKKwlbS1ZNSV9WQ1BVX0dFVF9DUFVJRF0gICAgICA9IGhhbmRsZV9n
ZXRfY3B1aWQsCiAJW0tWTUlfVkNQVV9HRVRfSU5GT10gICAgICAgPSBoYW5kbGVfZ2V0X3ZjcHVf
aW5mbywKIAlbS1ZNSV9WQ1BVX0dFVF9SRUdJU1RFUlNdICA9IGhhbmRsZV9nZXRfcmVnaXN0ZXJz
LAogCVtLVk1JX1ZDUFVfU0VUX1JFR0lTVEVSU10gID0gaGFuZGxlX3NldF9yZWdpc3RlcnMsCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClZpcnR1YWxpemF0
aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0cy5saW51eC1mb3VuZGF0aW9uLm9y
ZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcvbWFpbG1hbi9saXN0aW5mby92aXJ0
dWFsaXphdGlvbg==
