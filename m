Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 1E305155E2B
	for <lists.virtualization@lfdr.de>; Fri,  7 Feb 2020 19:35:58 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id CE73F85F59;
	Fri,  7 Feb 2020 18:35:56 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id RZFENYX2ShLV; Fri,  7 Feb 2020 18:35:54 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 827B486972;
	Fri,  7 Feb 2020 18:35:54 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 57CD4C013E;
	Fri,  7 Feb 2020 18:35:54 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 0B3F7C1D85
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:53 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by fraxinus.osuosl.org (Postfix) with ESMTP id 0606585F59
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:53 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id Uu-cNww3fSh3
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:52 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by fraxinus.osuosl.org (Postfix) with ESMTPS id CB2AF84483
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:51 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 94210305D34A; Fri,  7 Feb 2020 20:16:40 +0200 (EET)
Received: from host.bbu.bitdefender.biz (unknown [195.210.4.22])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 8A9003052068;
 Fri,  7 Feb 2020 20:16:40 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [RFC PATCH v7 44/78] KVM: introspection: add KVMI_VM_CONTROL_EVENTS
Date: Fri,  7 Feb 2020 20:16:02 +0200
Message-Id: <20200207181636.1065-45-alazar@bitdefender.com>
In-Reply-To: <20200207181636.1065-1-alazar@bitdefender.com>
References: <20200207181636.1065-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 Sean Christopherson <sean.j.christopherson@intel.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

V2l0aCB0aGlzIGNvbW1hbmQgdGhlIGludHJvc3BlY3Rpb24gdG9vbCBlbmFibGVzL2Rpc2FibGVz
IFZNIGV2ZW50cwooaWUuIEtWTUlfRVZFTlRfVU5IT09LKSwgYmVjYXVzZSBubyBldmVudCAobmVp
dGhlciBWTSBldmVudCwgbm9yIHZDUFUKZXZlbnQpIHdpbGwgYmUgc2VudCB0byB0aGUgaW50cm9z
cGVjdGlvbiB0b29sIHVubGVzcyBlbmFibGVkL3JlcXVlc3RlZC4KClNpZ25lZC1vZmYtYnk6IEFk
YWxiZXJ0IExhesSDciA8YWxhemFyQGJpdGRlZmVuZGVyLmNvbT4KLS0tCiBEb2N1bWVudGF0aW9u
L3ZpcnQva3ZtL2t2bWkucnN0ICAgICAgICAgICAgICAgfCA0NCArKysrKysrKysrKysrKystLQog
aW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaCAgICAgICAgICAgICAgICAgICAgIHwgIDIgKwogaW5j
bHVkZS91YXBpL2xpbnV4L2t2bWkuaCAgICAgICAgICAgICAgICAgICAgIHwgMTggKysrKystLQog
Li4uL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMgIHwgNDggKysrKysr
KysrKysrKysrKysrKwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMgICAgICAgICAgICAg
ICAgIHwgMTQgKysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmggICAgICAg
ICAgICAgfCAgOSArKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgICAgICAg
ICAgICAgfCA0MyArKysrKysrKysrKysrLS0tLQogNyBmaWxlcyBjaGFuZ2VkLCAxNjEgaW5zZXJ0
aW9ucygrKSwgMTcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi92aXJ0
L2t2bS9rdm1pLnJzdCBiL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKaW5kZXggOTQ5
ZTk0MDQ4N2FiLi43MDM5ZjRkMmI3ODIgMTAwNjQ0Ci0tLSBhL0RvY3VtZW50YXRpb24vdmlydC9r
dm0va3ZtaS5yc3QKKysrIGIvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdApAQCAtMzMz
LDExICszMzMsNDUgQEAgVGhpcyBjb21tYW5kIGlzIGFsd2F5cyBhbGxvd2VkLgogCiBSZXR1cm5z
IHRoZSBudW1iZXIgb2Ygb25saW5lIHZDUFVzLgogCis1LiBLVk1JX1ZNX0NPTlRST0xfRVZFTlRT
CistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisKKzpBcmNoaXRlY3R1cmVzOiBhbGwKKzpWZXJz
aW9uczogPj0gMQorOlBhcmFtZXRlcnM6CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV92bV9jb250cm9s
X2V2ZW50cyB7CisJCV9fdTE2IGV2ZW50X2lkOworCQlfX3U4IGVuYWJsZTsKKwkJX191OCBwYWRk
aW5nMTsKKwkJX191MzIgcGFkZGluZzI7CisJfTsKKworOlJldHVybnM6CisKKzo6CisKKwlzdHJ1
Y3Qga3ZtaV9lcnJvcl9jb2RlCisKK0VuYWJsZXMvZGlzYWJsZXMgVk0gaW50cm9zcGVjdGlvbiBl
dmVudHMuIFRoaXMgY29tbWFuZCBjYW4gYmUgdXNlZCB3aXRoCit0aGUgZm9sbG93aW5nIGV2ZW50
czo6CisKKwlLVk1JX0VWRU5UX1VOSE9PSworCis6RXJyb3JzOgorCisqIC1LVk1fRUlOVkFMIC0g
dGhlIGV2ZW50IElEIGlzIGludmFsaWQvdW5rbm93biAodXNlICpLVk1JX1ZNX0NIRUNLX0VWRU5U
KiBmaXJzdCkKKyogLUtWTV9FSU5WQUwgLSBwYWRkaW5nIGlzIG5vdCB6ZXJvCisqIC1LVk1fRVBF
Uk0gLSB0aGUgYWNjZXNzIGlzIHJlc3RyaWN0ZWQgYnkgdGhlIGhvc3QKKwogRXZlbnRzCiA9PT09
PT0KIAogQWxsIGludHJvc3BlY3Rpb24gZXZlbnRzIChWTSBvciB2Q1BVIHJlbGF0ZWQpIGFyZSBz
ZW50Ci11c2luZyB0aGUgKktWTUlfRVZFTlQqIG1lc3NhZ2UgaWQuCit1c2luZyB0aGUgKktWTUlf
RVZFTlQqIG1lc3NhZ2UgaWQuIE5vIGV2ZW50IHdpbGwgYmUgc2VudCB1bmxlc3MKK2l0IGlzIGV4
cGxpY2l0bHkgZW5hYmxlZC4KIAogVGhlICpLVk1JX0VWRU5UX1VOSE9PSyogZXZlbnQgZG9lc24n
dCBoYXZlIGEgcmVwbHkgYW5kIHNoYXJlIHRoZSBrdm1pX2V2ZW50CiBzdHJ1Y3R1cmUsIGZvciBj
b25zaXN0ZW5jeSB3aXRoIHRoZSB2Q1BVIGV2ZW50cy4KQEAgLTM5MSw2ICs0MjUsOCBAQCBTcGVj
aWZpYyBkYXRhIGNhbiBmb2xsb3cgdGhlc2UgY29tbW9uIHN0cnVjdHVyZXMuCiAKIDpSZXR1cm5z
OiBub25lCiAKLVRoaXMgZXZlbnQgaXMgc2VudCB3aGVuIHRoZSBkZXZpY2UgbWFuYWdlciBoYXMg
dG8gcGF1c2Uvc3RvcC9taWdyYXRlIHRoZQotZ3Vlc3QgKHNlZSAqKlVuaG9va2luZyoqKS4gIFRo
ZSBpbnRyb3NwZWN0aW9uIHRvb2wgaGFzIGEgY2hhbmNlIHRvIHVuaG9vawotYW5kIGNsb3NlIHRo
ZSBLVk1JIGNoYW5uZWwgKHNpZ25hbGluZyB0aGF0IHRoZSBvcGVyYXRpb24gY2FuIHByb2NlZWQp
LgorVGhpcyBldmVudCBpcyBzZW50IHdoZW4gdGhlIGRldmljZSBtYW5hZ2VyIGhhcyB0byBwYXVz
ZS9zdG9wL21pZ3JhdGUKK3RoZSBndWVzdCAoc2VlICoqVW5ob29raW5nKiopIGFuZCB0aGUgaW50
cm9zcGVjdGlvbiBoYXMgYmVlbiBlbmFibGVkCitmb3IgdGhpcyBldmVudCAoc2VlICoqS1ZNSV9W
TV9DT05UUk9MX0VWRU5UUyoqKS4gVGhlIGludHJvc3BlY3Rpb24gdG9vbAoraGFzIGEgY2hhbmNl
IHRvIHVuaG9vayBhbmQgY2xvc2UgdGhlIEtWTUkgY2hhbm5lbCAoc2lnbmFsaW5nIHRoYXQgdGhl
CitvcGVyYXRpb24gY2FuIHByb2NlZWQpLgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9rdm1p
X2hvc3QuaCBiL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmgKaW5kZXggMTgwZTI2MzM1YThmLi40
MWIyMmFmNzcxZmIgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmgKKysrIGIv
aW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaApAQCAtMjIsNiArMjIsOCBAQCBzdHJ1Y3Qga3ZtX2lu
dHJvc3BlY3Rpb24gewogCURFQ0xBUkVfQklUTUFQKGNtZF9hbGxvd19tYXNrLCBLVk1JX05VTV9D
T01NQU5EUyk7CiAJREVDTEFSRV9CSVRNQVAoZXZlbnRfYWxsb3dfbWFzaywgS1ZNSV9OVU1fRVZF
TlRTKTsKIAorCURFQ0xBUkVfQklUTUFQKHZtX2V2ZW50X2VuYWJsZV9tYXNrLCBLVk1JX05VTV9F
VkVOVFMpOworCiAJYXRvbWljX3QgZXZfc2VxOwogfTsKIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS91
YXBpL2xpbnV4L2t2bWkuaCBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKaW5kZXggZTc0MjQw
YWZmNWI3Li5kYTliZjMwYWU1MTMgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1p
LmgKKysrIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaApAQCAtMTUsMTIgKzE1LDEzIEBAIGVu
dW0gewogfTsKIAogZW51bSB7Ci0JS1ZNSV9FVkVOVCAgICAgICAgICAgID0gMSwKKwlLVk1JX0VW
RU5UICAgICAgICAgICAgID0gMSwKIAotCUtWTUlfR0VUX1ZFUlNJT04gICAgICA9IDIsCi0JS1ZN
SV9WTV9DSEVDS19DT01NQU5EID0gMywKLQlLVk1JX1ZNX0NIRUNLX0VWRU5UICAgPSA0LAotCUtW
TUlfVk1fR0VUX0lORk8gICAgICA9IDUsCisJS1ZNSV9HRVRfVkVSU0lPTiAgICAgICA9IDIsCisJ
S1ZNSV9WTV9DSEVDS19DT01NQU5EICA9IDMsCisJS1ZNSV9WTV9DSEVDS19FVkVOVCAgICA9IDQs
CisJS1ZNSV9WTV9HRVRfSU5GTyAgICAgICA9IDUsCisJS1ZNSV9WTV9DT05UUk9MX0VWRU5UUyA9
IDYsCiAKIAlLVk1JX05VTV9NRVNTQUdFUwogfTsKQEAgLTY4LDYgKzY5LDEzIEBAIHN0cnVjdCBr
dm1pX3ZtX2dldF9pbmZvX3JlcGx5IHsKIAlfX3UzMiBwYWRkaW5nWzNdOwogfTsKIAorc3RydWN0
IGt2bWlfdm1fY29udHJvbF9ldmVudHMgeworCV9fdTE2IGV2ZW50X2lkOworCV9fdTggZW5hYmxl
OworCV9fdTggcGFkZGluZzE7CisJX191MzIgcGFkZGluZzI7Cit9OworCiBzdHJ1Y3Qga3ZtaV9l
dmVudCB7CiAJX191MTYgc2l6ZTsKIAlfX3UxNiB2Y3B1OwpkaWZmIC0tZ2l0IGEvdG9vbHMvdGVz
dGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2Vs
ZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKaW5kZXggZjVkNjdmZDBjZGU4Li4yM2RiYTcx
ZTdkYzYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3Zt
aV90ZXN0LmMKKysrIGIvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rl
c3QuYwpAQCAtMjk4LDE1ICsyOTgsNjIgQEAgc3RhdGljIHZvaWQgcmVjZWl2ZV9ldmVudChzdHJ1
Y3Qga3ZtaV9tc2dfaGRyICpoZHIsIHN0cnVjdCBrdm1pX2V2ZW50ICpldiwKIAkJZXYtPmV2ZW50
LCBldmVudF9pZCk7CiB9CiAKK3N0YXRpYyBpbnQgY21kX3ZtX2NvbnRyb2xfZXZlbnRzKF9fdTE2
IGV2ZW50X2lkLCBib29sIGVuYWJsZSkKK3sKKwlzdHJ1Y3QgeworCQlzdHJ1Y3Qga3ZtaV9tc2df
aGRyIGhkcjsKKwkJc3RydWN0IGt2bWlfdm1fY29udHJvbF9ldmVudHMgY21kOworCX0gcmVxID0g
e307CisKKwlyZXEuY21kLmV2ZW50X2lkID0gZXZlbnRfaWQ7CisJcmVxLmNtZC5lbmFibGUgPSBl
bmFibGUgPyAxIDogMDsKKworCXJldHVybiBkb19jb21tYW5kKEtWTUlfVk1fQ09OVFJPTF9FVkVO
VFMsICZyZXEuaGRyLCBzaXplb2YocmVxKSwKKwkJCSAgICAgTlVMTCwgMCk7Cit9CisKK3N0YXRp
YyB2b2lkIGVuYWJsZV92bV9ldmVudChfX3UxNiBldmVudF9pZCkKK3sKKwlpbnQgcjsKKworCXIg
PSBjbWRfdm1fY29udHJvbF9ldmVudHMoZXZlbnRfaWQsIHRydWUpOworCVRFU1RfQVNTRVJUKHIg
PT0gMCwKKwkJIktWTUlfVk1fQ09OVFJPTF9FVkVOVFMgZmFpbGVkIHRvIGVuYWJsZSBWTSBldmVu
dCAlZCwgZXJyb3IgJWQgKCVzKVxuIiwKKwkJZXZlbnRfaWQsIC1yLCBrdm1fc3RyZXJyb3IoLXIp
KTsKK30KKworc3RhdGljIHZvaWQgZGlzYWJsZV92bV9ldmVudChfX3UxNiBldmVudF9pZCkKK3sK
KwlpbnQgcjsKKworCXIgPSBjbWRfdm1fY29udHJvbF9ldmVudHMoZXZlbnRfaWQsIGZhbHNlKTsK
KwlURVNUX0FTU0VSVChyID09IDAsCisJCSJLVk1JX1ZNX0NPTlRST0xfRVZFTlRTIGZhaWxlZCB0
byBkaXNhYmxlIFZNIGV2ZW50ICVkLCBlcnJvciAlZCAoJXMpXG4iLAorCQlldmVudF9pZCwgLXIs
IGt2bV9zdHJlcnJvcigtcikpOworfQorCiBzdGF0aWMgdm9pZCB0ZXN0X2V2ZW50X3VuaG9vayhz
dHJ1Y3Qga3ZtX3ZtICp2bSkKIHsKIAlfX3UxNiBpZCA9IEtWTUlfRVZFTlRfVU5IT09LOwogCXN0
cnVjdCBrdm1pX21zZ19oZHIgaGRyOwogCXN0cnVjdCBrdm1pX2V2ZW50IGV2OwogCisJZW5hYmxl
X3ZtX2V2ZW50KGlkKTsKKwogCXRyaWdnZXJfZXZlbnRfdW5ob29rX25vdGlmaWNhdGlvbih2bSk7
CiAKIAlyZWNlaXZlX2V2ZW50KCZoZHIsICZldiwgc2l6ZW9mKGV2KSwgaWQpOworCisJZGlzYWJs
ZV92bV9ldmVudChpZCk7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3RfY21kX3ZtX2NvbnRyb2xfZXZl
bnRzKHZvaWQpCit7CisJX191MTYgaWQgPSBLVk1JX0VWRU5UX1VOSE9PSzsKKworCWVuYWJsZV92
bV9ldmVudChpZCk7CisKKwlkaXNhYmxlX3ZtX2V2ZW50KGlkKTsKIH0KIAogc3RhdGljIHZvaWQg
dGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQpAQCAtMzIwLDYgKzM2Nyw3IEBA
IHN0YXRpYyB2b2lkIHRlc3RfaW50cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkKIAl0ZXN0
X2NtZF9jaGVja19ldmVudCgpOwogCXRlc3RfY21kX2dldF92bV9pbmZvKCk7CiAJdGVzdF9ldmVu
dF91bmhvb2sodm0pOworCXRlc3RfY21kX3ZtX2NvbnRyb2xfZXZlbnRzKCk7CiAKIAl1bmhvb2tf
aW50cm9zcGVjdGlvbih2bSk7CiB9CmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9u
L2t2bWkuYyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCmluZGV4IDc0ZTNlMWFhMzI2
Yi4uOWQyNDYxNTJjNWU4IDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWku
YworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwpAQCAtMzMxLDYgKzMzMSw5IEBA
IHN0YXRpYyBib29sIGt2bWlfdW5ob29rX2V2ZW50KHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAq
a3ZtaSkKIHsKIAlpbnQgZXJyOwogCisJaWYgKCFpc192bV9ldmVudF9lbmFibGVkKGt2bWksIEtW
TUlfRVZFTlRfVU5IT09LKSkKKwkJcmV0dXJuIGZhbHNlOworCiAJZXJyID0ga3ZtaV9tc2dfc2Vu
ZF91bmhvb2soa3ZtaSk7CiAKIAlyZXR1cm4gIWVycjsKQEAgLTM1NCwzICszNTcsMTQgQEAgaW50
IGt2bWlfaW9jdGxfcHJldW5ob29rKHN0cnVjdCBrdm0gKmt2bSkKIAogCXJldHVybiBlcnI7CiB9
CisKK2ludCBrdm1pX2NtZF92bV9jb250cm9sX2V2ZW50cyhzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rp
b24gKmt2bWksCisJCQkJdW5zaWduZWQgaW50IGV2ZW50X2lkLCBib29sIGVuYWJsZSkKK3sKKwlp
ZiAoZW5hYmxlKQorCQlzZXRfYml0KGV2ZW50X2lkLCBrdm1pLT52bV9ldmVudF9lbmFibGVfbWFz
ayk7CisJZWxzZQorCQljbGVhcl9iaXQoZXZlbnRfaWQsIGt2bWktPnZtX2V2ZW50X2VuYWJsZV9t
YXNrKTsKKworCXJldHVybiAwOworfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlv
bi9rdm1pX2ludC5oIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCmluZGV4IDNl
YThlODI1MGY3ZC4uZDFjMTQzMzM0NjI2IDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0
aW9uL2t2bWlfaW50LmgKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCkBA
IC0yOSwxMSArMjksMTggQEAKIAkJCSAgQklUKEtWTUlfR0VUX1ZFUlNJT04pIFwKIAkJCXwgQklU
KEtWTUlfVk1fQ0hFQ0tfQ09NTUFORCkgXAogCQkJfCBCSVQoS1ZNSV9WTV9DSEVDS19FVkVOVCkg
XAorCQkJfCBCSVQoS1ZNSV9WTV9DT05UUk9MX0VWRU5UUykgXAogCQkJfCBCSVQoS1ZNSV9WTV9H
RVRfSU5GTykgXAogCQkpCiAKICNkZWZpbmUgS1ZNSShrdm0pICgoc3RydWN0IGt2bV9pbnRyb3Nw
ZWN0aW9uICopKChrdm0pLT5rdm1pKSkKIAorc3RhdGljIGlubGluZSBib29sIGlzX3ZtX2V2ZW50
X2VuYWJsZWQoc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pLAorCQkJCQlpbnQgZXZlbnQp
Cit7CisJcmV0dXJuIHRlc3RfYml0KGV2ZW50LCBrdm1pLT52bV9ldmVudF9lbmFibGVfbWFzayk7
Cit9CisKIC8qIGt2bWlfbXNnLmMgKi8KIGJvb2wga3ZtaV9zb2NrX2dldChzdHJ1Y3Qga3ZtX2lu
dHJvc3BlY3Rpb24gKmt2bWksIGludCBmZCk7CiB2b2lkIGt2bWlfc29ja19zaHV0ZG93bihzdHJ1
Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkpOwpAQCAtNDUsNSArNTIsNyBAQCBpbnQga3ZtaV9t
c2dfc2VuZF91bmhvb2soc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pKTsKIHZvaWQgKmt2
bWlfbXNnX2FsbG9jKHZvaWQpOwogdm9pZCAqa3ZtaV9tc2dfYWxsb2NfY2hlY2soc2l6ZV90IHNp
emUpOwogdm9pZCBrdm1pX21zZ19mcmVlKHZvaWQgKmFkZHIpOworaW50IGt2bWlfY21kX3ZtX2Nv
bnRyb2xfZXZlbnRzKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSwKKwkJCQl1bnNpZ25l
ZCBpbnQgZXZlbnRfaWQsIGJvb2wgZW5hYmxlKTsKIAogI2VuZGlmCmRpZmYgLS1naXQgYS92aXJ0
L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2
bWlfbXNnLmMKaW5kZXggZGJjMmJhOWExMzk5Li43OWIyNjg1M2I1Y2IgMTAwNjQ0Ci0tLSBhL3Zp
cnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0
aW9uL2t2bWlfbXNnLmMKQEAgLTksMTAgKzksMTEgQEAKICNpbmNsdWRlICJrdm1pX2ludC5oIgog
CiBzdGF0aWMgY29uc3QgY2hhciAqY29uc3QgbXNnX0lEc1tdID0gewotCVtLVk1JX0dFVF9WRVJT
SU9OXSAgICAgID0gIktWTUlfR0VUX1ZFUlNJT04iLAotCVtLVk1JX1ZNX0NIRUNLX0NPTU1BTkRd
ID0gIktWTUlfVk1fQ0hFQ0tfQ09NTUFORCIsCi0JW0tWTUlfVk1fQ0hFQ0tfRVZFTlRdICAgPSAi
S1ZNSV9WTV9DSEVDS19FVkVOVCIsCi0JW0tWTUlfVk1fR0VUX0lORk9dICAgICAgPSAiS1ZNSV9W
TV9HRVRfSU5GTyIsCisJW0tWTUlfR0VUX1ZFUlNJT05dICAgICAgID0gIktWTUlfR0VUX1ZFUlNJ
T04iLAorCVtLVk1JX1ZNX0NIRUNLX0NPTU1BTkRdICA9ICJLVk1JX1ZNX0NIRUNLX0NPTU1BTkQi
LAorCVtLVk1JX1ZNX0NIRUNLX0VWRU5UXSAgICA9ICJLVk1JX1ZNX0NIRUNLX0VWRU5UIiwKKwlb
S1ZNSV9WTV9DT05UUk9MX0VWRU5UU10gPSAiS1ZNSV9WTV9DT05UUk9MX0VWRU5UUyIsCisJW0tW
TUlfVk1fR0VUX0lORk9dICAgICAgID0gIktWTUlfVk1fR0VUX0lORk8iLAogfTsKIAogc3RhdGlj
IGJvb2wgaXNfa25vd25fbWVzc2FnZSh1MTYgaWQpCkBAIC0xODEsMTUgKzE4Miw0MSBAQCBzdGF0
aWMgaW50IGhhbmRsZV9nZXRfaW5mbyhzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWksCiAJ
cmV0dXJuIGt2bWlfbXNnX3ZtX3JlcGx5KGt2bWksIG1zZywgMCwgJnJwbCwgc2l6ZW9mKHJwbCkp
OwogfQogCitzdGF0aWMgaW50IGhhbmRsZV92bV9jb250cm9sX2V2ZW50cyhzdHJ1Y3Qga3ZtX2lu
dHJvc3BlY3Rpb24gKmt2bWksCisJCQkJICAgIGNvbnN0IHN0cnVjdCBrdm1pX21zZ19oZHIgKm1z
ZywKKwkJCQkgICAgY29uc3Qgdm9pZCAqX3JlcSkKK3sKKwljb25zdCBzdHJ1Y3Qga3ZtaV92bV9j
b250cm9sX2V2ZW50cyAqcmVxID0gX3JlcTsKKwlERUNMQVJFX0JJVE1BUChrbm93bl9ldmVudHMs
IEtWTUlfTlVNX0VWRU5UUyk7CisJaW50IGVjOworCisJYml0bWFwX2Zyb21fdTY0KGtub3duX2V2
ZW50cywgS1ZNSV9LTk9XTl9WTV9FVkVOVFMpOworCisJaWYgKHJlcS0+cGFkZGluZzEgfHwgcmVx
LT5wYWRkaW5nMikKKwkJZWMgPSAtS1ZNX0VJTlZBTDsKKwllbHNlIGlmIChyZXEtPmV2ZW50X2lk
ID49IEtWTUlfTlVNX0VWRU5UUykKKwkJZWMgPSAtS1ZNX0VJTlZBTDsKKwllbHNlIGlmICghdGVz
dF9iaXQocmVxLT5ldmVudF9pZCwga25vd25fZXZlbnRzKSkKKwkJZWMgPSAtS1ZNX0VJTlZBTDsK
KwllbHNlIGlmICghaXNfZXZlbnRfYWxsb3dlZChrdm1pLCByZXEtPmV2ZW50X2lkKSkKKwkJZWMg
PSAtS1ZNX0VQRVJNOworCWVsc2UKKwkJZWMgPSBrdm1pX2NtZF92bV9jb250cm9sX2V2ZW50cyhr
dm1pLCByZXEtPmV2ZW50X2lkLAorCQkJCQkJcmVxLT5lbmFibGUpOworCisJcmV0dXJuIGt2bWlf
bXNnX3ZtX3JlcGx5KGt2bWksIG1zZywgZWMsIE5VTEwsIDApOworfQorCiAvKgogICogVGhlc2Ug
Y29tbWFuZHMgYXJlIGV4ZWN1dGVkIGJ5IHRoZSByZWNlaXZpbmcgdGhyZWFkL3dvcmtlci4KICAq
Lwogc3RhdGljIGludCgqY29uc3QgbXNnX3ZtW10pKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAq
LAogCQkJICAgIGNvbnN0IHN0cnVjdCBrdm1pX21zZ19oZHIgKiwgY29uc3Qgdm9pZCAqKSA9IHsK
LQlbS1ZNSV9HRVRfVkVSU0lPTl0gICAgICA9IGhhbmRsZV9nZXRfdmVyc2lvbiwKLQlbS1ZNSV9W
TV9DSEVDS19DT01NQU5EXSA9IGhhbmRsZV9jaGVja19jb21tYW5kLAotCVtLVk1JX1ZNX0NIRUNL
X0VWRU5UXSAgID0gaGFuZGxlX2NoZWNrX2V2ZW50LAotCVtLVk1JX1ZNX0dFVF9JTkZPXSAgICAg
ID0gaGFuZGxlX2dldF9pbmZvLAorCVtLVk1JX0dFVF9WRVJTSU9OXSAgICAgICA9IGhhbmRsZV9n
ZXRfdmVyc2lvbiwKKwlbS1ZNSV9WTV9DSEVDS19DT01NQU5EXSAgPSBoYW5kbGVfY2hlY2tfY29t
bWFuZCwKKwlbS1ZNSV9WTV9DSEVDS19FVkVOVF0gICAgPSBoYW5kbGVfY2hlY2tfZXZlbnQsCisJ
W0tWTUlfVk1fQ09OVFJPTF9FVkVOVFNdID0gaGFuZGxlX3ZtX2NvbnRyb2xfZXZlbnRzLAorCVtL
Vk1JX1ZNX0dFVF9JTkZPXSAgICAgICA9IGhhbmRsZV9nZXRfaW5mbywKIH07CiAKIHN0YXRpYyBi
b29sIGlzX3ZtX21lc3NhZ2UodTE2IGlkKQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmlydHVhbGl6YXRp
b25AbGlzdHMubGludXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51eGZvdW5kYXRp
b24ub3JnL21haWxtYW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
