Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp4.osuosl.org (smtp4.osuosl.org [IPv6:2605:bc80:3010::137])
	by mail.lfdr.de (Postfix) with ESMTPS id 689BA654C52
	for <lists.virtualization@lfdr.de>; Fri, 23 Dec 2022 06:56:19 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by smtp4.osuosl.org (Postfix) with ESMTP id 542604190E;
	Fri, 23 Dec 2022 05:56:15 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 542604190E
Authentication-Results: smtp4.osuosl.org;
	dkim=fail reason="signature verification failed" (1024-bit key) header.d=redhat.com header.i=@redhat.com header.a=rsa-sha256 header.s=mimecast20190719 header.b=DIt75AKX
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
	by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id MJVmDUUpSpvB; Fri, 23 Dec 2022 05:56:13 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by smtp4.osuosl.org (Postfix) with ESMTPS id 21EC7418AB;
	Fri, 23 Dec 2022 05:56:13 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 21EC7418AB
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 55FA7C007C;
	Fri, 23 Dec 2022 05:56:12 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp3.osuosl.org (smtp3.osuosl.org [IPv6:2605:bc80:3010::136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 9711EC0070
 for <virtualization@lists.linux-foundation.org>;
 Fri, 23 Dec 2022 05:56:10 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp3.osuosl.org (Postfix) with ESMTP id 63398607DE
 for <virtualization@lists.linux-foundation.org>;
 Fri, 23 Dec 2022 05:56:10 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp3.osuosl.org 63398607DE
Authentication-Results: smtp3.osuosl.org;
 dkim=pass (1024-bit key) header.d=redhat.com header.i=@redhat.com
 header.a=rsa-sha256 header.s=mimecast20190719 header.b=DIt75AKX
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp3.osuosl.org ([127.0.0.1])
 by localhost (smtp3.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 92So9OSAZUGA
 for <virtualization@lists.linux-foundation.org>;
 Fri, 23 Dec 2022 05:56:09 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp3.osuosl.org 5218F60BC9
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.129.124])
 by smtp3.osuosl.org (Postfix) with ESMTPS id 5218F60BC9
 for <virtualization@lists.linux-foundation.org>;
 Fri, 23 Dec 2022 05:56:09 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1671774968;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=geeXbLqlOO3kE9Ys38rD6Uma1sdzPw7UupQySuFHXU4=;
 b=DIt75AKXyFlHcNZO1Elnge28Mmk9iWIOJZIFTATO3Xtl6w7CL3XBFoEuWTEvK50jbOnCxn
 zFtENb2+h5oql0vvRzUD5B+gWIzAdLONYf1u92qn462WgOevnYhAH/BA1tRuzQlIqrpbVe
 HfUnMbZSF9Cv1aOxiwUcQTFzXbclgCk=
Received: from mimecast-mx02.redhat.com (mimecast-mx02.redhat.com
 [66.187.233.88]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 us-mta-453-lInnbR77NBGqK9kqrLG4Jg-1; Fri, 23 Dec 2022 00:56:06 -0500
X-MC-Unique: lInnbR77NBGqK9kqrLG4Jg-1
Received: from smtp.corp.redhat.com (int-mx01.intmail.prod.int.rdu2.redhat.com
 [10.11.54.1])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx02.redhat.com (Postfix) with ESMTPS id 8AA4B85C6E3;
 Fri, 23 Dec 2022 05:56:06 +0000 (UTC)
Received: from localhost.localdomain (ovpn-12-204.pek2.redhat.com
 [10.72.12.204])
 by smtp.corp.redhat.com (Postfix) with ESMTP id EA72940C2064;
 Fri, 23 Dec 2022 05:56:03 +0000 (UTC)
From: Jason Wang <jasowang@redhat.com>
To: mst@redhat.com,
	jasowang@redhat.com
Subject: [PATCH V3 4/4] vdpa_sim_net: vendor satistics
Date: Fri, 23 Dec 2022 13:55:48 +0800
Message-Id: <20221223055548.27810-5-jasowang@redhat.com>
In-Reply-To: <20221223055548.27810-1-jasowang@redhat.com>
References: <20221223055548.27810-1-jasowang@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 3.1 on 10.11.54.1
Cc: eperezma@redhat.com, virtualization@lists.linux-foundation.org,
 linux-kernel@vger.kernel.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

VGhpcyBwYXRjaCBhZGRzIHN1cHBvcnQgZm9yIGJhc2ljIHZlbmRvciBzdGF0cyB0aGF0IGluY2x1
ZGUgY291bnRlcnMKZm9yIHR4LCByeCBhbmQgY3ZxLgoKQWNrZWQtYnk6IEV1Z2VuaW8gUMOpcmV6
IDxlcGVyZXptYUByZWRoYXQuY29tPgpTaWduZWQtb2ZmLWJ5OiBKYXNvbiBXYW5nIDxqYXNvd2Fu
Z0ByZWRoYXQuY29tPgotLS0KIGRyaXZlcnMvdmRwYS92ZHBhX3NpbS92ZHBhX3NpbV9uZXQuYyB8
IDIxOSArKysrKysrKysrKysrKysrKysrKysrKysrKy0KIDEgZmlsZSBjaGFuZ2VkLCAyMTMgaW5z
ZXJ0aW9ucygrKSwgNiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL3ZkcGEvdmRw
YV9zaW0vdmRwYV9zaW1fbmV0LmMgYi9kcml2ZXJzL3ZkcGEvdmRwYV9zaW0vdmRwYV9zaW1fbmV0
LmMKaW5kZXggNWFiZDRlZmQ5MDI4Li5lODI3NzA4YWRjY2EgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
dmRwYS92ZHBhX3NpbS92ZHBhX3NpbV9uZXQuYworKysgYi9kcml2ZXJzL3ZkcGEvdmRwYV9zaW0v
dmRwYV9zaW1fbmV0LmMKQEAgLTE1LDYgKzE1LDcgQEAKICNpbmNsdWRlIDxsaW51eC9ldGhlcmRl
dmljZS5oPgogI2luY2x1ZGUgPGxpbnV4L3ZyaW5naC5oPgogI2luY2x1ZGUgPGxpbnV4L3ZkcGEu
aD4KKyNpbmNsdWRlIDxuZXQvbmV0bGluay5oPgogI2luY2x1ZGUgPHVhcGkvbGludXgvdmlydGlv
X25ldC5oPgogI2luY2x1ZGUgPHVhcGkvbGludXgvdmRwYS5oPgogCkBAIC0zNyw2ICszOCwzNCBA
QAogI2RlZmluZSBWRFBBU0lNX05FVF9BU19OVU0JMgogI2RlZmluZSBWRFBBU0lNX05FVF9HUk9V
UF9OVU0JMgogCitzdHJ1Y3QgdmRwYXNpbV9kYXRhcV9zdGF0cyB7CisJc3RydWN0IHU2NF9zdGF0
c19zeW5jIHN5bmNwOworCXU2NCBwa3RzOworCXU2NCBieXRlczsKKwl1NjQgZHJvcHM7CisJdTY0
IGVycm9yczsKKwl1NjQgb3ZlcnJ1bnM7Cit9OworCitzdHJ1Y3QgdmRwYXNpbV9jcV9zdGF0cyB7
CisJc3RydWN0IHU2NF9zdGF0c19zeW5jIHN5bmNwOworCXU2NCByZXF1ZXN0czsKKwl1NjQgc3Vj
Y2Vzc2VzOworCXU2NCBlcnJvcnM7Cit9OworCitzdHJ1Y3QgdmRwYXNpbV9uZXR7CisJc3RydWN0
IHZkcGFzaW0gdmRwYXNpbTsKKwlzdHJ1Y3QgdmRwYXNpbV9kYXRhcV9zdGF0cyB0eF9zdGF0czsK
KwlzdHJ1Y3QgdmRwYXNpbV9kYXRhcV9zdGF0cyByeF9zdGF0czsKKwlzdHJ1Y3QgdmRwYXNpbV9j
cV9zdGF0cyBjcV9zdGF0czsKK307CisKK3N0YXRpYyBzdHJ1Y3QgdmRwYXNpbV9uZXQgKnNpbV90
b19uZXQoc3RydWN0IHZkcGFzaW0gKnZkcGFzaW0pCit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZih2
ZHBhc2ltLCBzdHJ1Y3QgdmRwYXNpbV9uZXQsIHZkcGFzaW0pOworfQorCiBzdGF0aWMgdm9pZCB2
ZHBhc2ltX25ldF9jb21wbGV0ZShzdHJ1Y3QgdmRwYXNpbV92aXJ0cXVldWUgKnZxLCBzaXplX3Qg
bGVuKQogewogCS8qIE1ha2Ugc3VyZSBkYXRhIGlzIHdyb3RlIGJlZm9yZSBhZHZhbmNpbmcgaW5k
ZXggKi8KQEAgLTk3LDkgKzEyNiwxMSBAQCBzdGF0aWMgdmlydGlvX25ldF9jdHJsX2FjayB2ZHBh
c2ltX2hhbmRsZV9jdHJsX21hYyhzdHJ1Y3QgdmRwYXNpbSAqdmRwYXNpbSwKIHN0YXRpYyB2b2lk
IHZkcGFzaW1faGFuZGxlX2N2cShzdHJ1Y3QgdmRwYXNpbSAqdmRwYXNpbSkKIHsKIAlzdHJ1Y3Qg
dmRwYXNpbV92aXJ0cXVldWUgKmN2cSA9ICZ2ZHBhc2ltLT52cXNbMl07CisJc3RydWN0IHZkcGFz
aW1fbmV0ICpuZXQgPSBzaW1fdG9fbmV0KHZkcGFzaW0pOwogCXZpcnRpb19uZXRfY3RybF9hY2sg
c3RhdHVzID0gVklSVElPX05FVF9FUlI7CiAJc3RydWN0IHZpcnRpb19uZXRfY3RybF9oZHIgY3Ry
bDsKIAlzaXplX3QgcmVhZCwgd3JpdGU7CisJdTY0IHJlcXVlc3RzID0gMCwgZXJyb3JzID0gMCwg
c3VjY2Vzc2VzID0gMDsKIAlpbnQgZXJyOwogCiAJaWYgKCEodmRwYXNpbS0+ZmVhdHVyZXMgJiAo
MVVMTCA8PCBWSVJUSU9fTkVUX0ZfQ1RSTF9WUSkpKQpAQCAtMTE1LDEwICsxNDYsMTMgQEAgc3Rh
dGljIHZvaWQgdmRwYXNpbV9oYW5kbGVfY3ZxKHN0cnVjdCB2ZHBhc2ltICp2ZHBhc2ltKQogCQlp
ZiAoZXJyIDw9IDApCiAJCQlicmVhazsKIAorCQkrK3JlcXVlc3RzOwogCQlyZWFkID0gdnJpbmdo
X2lvdl9wdWxsX2lvdGxiKCZjdnEtPnZyaW5nLCAmY3ZxLT5pbl9pb3YsICZjdHJsLAogCQkJCQkg
ICAgIHNpemVvZihjdHJsKSk7Ci0JCWlmIChyZWFkICE9IHNpemVvZihjdHJsKSkKKwkJaWYgKHJl
YWQgIT0gc2l6ZW9mKGN0cmwpKSB7CisJCQkrK2Vycm9yczsKIAkJCWJyZWFrOworCQl9CiAKIAkJ
c3dpdGNoIChjdHJsLmNsYXNzKSB7CiAJCWNhc2UgVklSVElPX05FVF9DVFJMX01BQzoKQEAgLTEy
OCw2ICsxNjIsMTEgQEAgc3RhdGljIHZvaWQgdmRwYXNpbV9oYW5kbGVfY3ZxKHN0cnVjdCB2ZHBh
c2ltICp2ZHBhc2ltKQogCQkJYnJlYWs7CiAJCX0KIAorCQlpZiAoc3RhdHVzID09IFZJUlRJT19O
RVRfT0spCisJCQkrK3N1Y2Nlc3NlczsKKwkJZWxzZQorCQkJKytlcnJvcnM7CisKIAkJLyogTWFr
ZSBzdXJlIGRhdGEgaXMgd3JvdGUgYmVmb3JlIGFkdmFuY2luZyBpbmRleCAqLwogCQlzbXBfd21i
KCk7CiAKQEAgLTE0NSw2ICsxODQsMTIgQEAgc3RhdGljIHZvaWQgdmRwYXNpbV9oYW5kbGVfY3Zx
KHN0cnVjdCB2ZHBhc2ltICp2ZHBhc2ltKQogCQkJY3ZxLT5jYihjdnEtPnByaXZhdGUpOwogCQls
b2NhbF9iaF9lbmFibGUoKTsKIAl9CisKKwl1NjRfc3RhdHNfdXBkYXRlX2JlZ2luKCZuZXQtPmNx
X3N0YXRzLnN5bmNwKTsKKwluZXQtPmNxX3N0YXRzLnJlcXVlc3RzICs9IHJlcXVlc3RzOworCW5l
dC0+Y3Ffc3RhdHMuZXJyb3JzICs9IGVycm9yczsKKwluZXQtPmNxX3N0YXRzLnN1Y2Nlc3NlcyAr
PSBzdWNjZXNzZXM7CisJdTY0X3N0YXRzX3VwZGF0ZV9lbmQoJm5ldC0+Y3Ffc3RhdHMuc3luY3Ap
OwogfQogCiBzdGF0aWMgdm9pZCB2ZHBhc2ltX25ldF93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAq
d29yaykKQEAgLTE1Miw4ICsxOTcsMTAgQEAgc3RhdGljIHZvaWQgdmRwYXNpbV9uZXRfd29yayhz
dHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAJc3RydWN0IHZkcGFzaW0gKnZkcGFzaW0gPSBjb250
YWluZXJfb2Yod29yaywgc3RydWN0IHZkcGFzaW0sIHdvcmspOwogCXN0cnVjdCB2ZHBhc2ltX3Zp
cnRxdWV1ZSAqdHhxID0gJnZkcGFzaW0tPnZxc1sxXTsKIAlzdHJ1Y3QgdmRwYXNpbV92aXJ0cXVl
dWUgKnJ4cSA9ICZ2ZHBhc2ltLT52cXNbMF07CisJc3RydWN0IHZkcGFzaW1fbmV0ICpuZXQgPSBz
aW1fdG9fbmV0KHZkcGFzaW0pOwogCXNzaXplX3QgcmVhZCwgd3JpdGU7Ci0JaW50IHBrdHMgPSAw
OworCXU2NCB0eF9wa3RzID0gMCwgcnhfcGt0cyA9IDAsIHR4X2J5dGVzID0gMCwgcnhfYnl0ZXMg
PSAwOworCXU2NCByeF9kcm9wcyA9IDAsIHJ4X292ZXJydW5zID0gMCwgcnhfZXJyb3JzID0gMCwg
dHhfZXJyb3JzID0gMDsKIAlpbnQgZXJyOwogCiAJc3Bpbl9sb2NrKCZ2ZHBhc2ltLT5sb2NrKTsK
QEAgLTE3MiwxNCArMjE5LDIxIEBAIHN0YXRpYyB2b2lkIHZkcGFzaW1fbmV0X3dvcmsoc3RydWN0
IHdvcmtfc3RydWN0ICp3b3JrKQogCXdoaWxlICh0cnVlKSB7CiAJCWVyciA9IHZyaW5naF9nZXRk
ZXNjX2lvdGxiKCZ0eHEtPnZyaW5nLCAmdHhxLT5vdXRfaW92LCBOVUxMLAogCQkJCQkgICAmdHhx
LT5oZWFkLCBHRlBfQVRPTUlDKTsKLQkJaWYgKGVyciA8PSAwKQorCQlpZiAoZXJyIDw9IDApIHsK
KwkJCWlmIChlcnIpCisJCQkJKyt0eF9lcnJvcnM7CiAJCQlicmVhazsKKwkJfQogCisJCSsrdHhf
cGt0czsKIAkJcmVhZCA9IHZyaW5naF9pb3ZfcHVsbF9pb3RsYigmdHhxLT52cmluZywgJnR4cS0+
b3V0X2lvdiwKIAkJCQkJICAgICB2ZHBhc2ltLT5idWZmZXIsCiAJCQkJCSAgICAgUEFHRV9TSVpF
KTsKIAorCQl0eF9ieXRlcyArPSByZWFkOworCiAJCWlmICghcmVjZWl2ZV9maWx0ZXIodmRwYXNp
bSwgcmVhZCkpIHsKKwkJCSsrcnhfZHJvcHM7CiAJCQl2ZHBhc2ltX25ldF9jb21wbGV0ZSh0eHEs
IDApOwogCQkJY29udGludWU7CiAJCX0KQEAgLTE4NywxOSArMjQxLDI1IEBAIHN0YXRpYyB2b2lk
IHZkcGFzaW1fbmV0X3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogCQllcnIgPSB2cmlu
Z2hfZ2V0ZGVzY19pb3RsYigmcnhxLT52cmluZywgTlVMTCwgJnJ4cS0+aW5faW92LAogCQkJCQkg
ICAmcnhxLT5oZWFkLCBHRlBfQVRPTUlDKTsKIAkJaWYgKGVyciA8PSAwKSB7CisJCQkrK3J4X292
ZXJydW5zOwogCQkJdmRwYXNpbV9uZXRfY29tcGxldGUodHhxLCAwKTsKIAkJCWJyZWFrOwogCQl9
CiAKIAkJd3JpdGUgPSB2cmluZ2hfaW92X3B1c2hfaW90bGIoJnJ4cS0+dnJpbmcsICZyeHEtPmlu
X2lvdiwKIAkJCQkJICAgICAgdmRwYXNpbS0+YnVmZmVyLCByZWFkKTsKLQkJaWYgKHdyaXRlIDw9
IDApCisJCWlmICh3cml0ZSA8PSAwKSB7CisJCQkrK3J4X2Vycm9yczsKIAkJCWJyZWFrOworCQl9
CisKKwkJKytyeF9wa3RzOworCQlyeF9ieXRlcyArPSB3cml0ZTsKIAogCQl2ZHBhc2ltX25ldF9j
b21wbGV0ZSh0eHEsIDApOwogCQl2ZHBhc2ltX25ldF9jb21wbGV0ZShyeHEsIHdyaXRlKTsKIAot
CQlpZiAoKytwa3RzID4gNCkgeworCQlpZiAodHhfcGt0cyA+IDQpIHsKIAkJCXNjaGVkdWxlX3dv
cmsoJnZkcGFzaW0tPndvcmspOwogCQkJZ290byBvdXQ7CiAJCX0KQEAgLTIwNyw2ICsyNjcsMTQ1
IEBAIHN0YXRpYyB2b2lkIHZkcGFzaW1fbmV0X3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3Jr
KQogCiBvdXQ6CiAJc3Bpbl91bmxvY2soJnZkcGFzaW0tPmxvY2spOworCisJdTY0X3N0YXRzX3Vw
ZGF0ZV9iZWdpbigmbmV0LT50eF9zdGF0cy5zeW5jcCk7CisJbmV0LT50eF9zdGF0cy5wa3RzICs9
IHR4X3BrdHM7CisJbmV0LT50eF9zdGF0cy5ieXRlcyArPSB0eF9ieXRlczsKKwluZXQtPnR4X3N0
YXRzLmVycm9ycyArPSB0eF9lcnJvcnM7CisJdTY0X3N0YXRzX3VwZGF0ZV9lbmQoJm5ldC0+dHhf
c3RhdHMuc3luY3ApOworCisJdTY0X3N0YXRzX3VwZGF0ZV9iZWdpbigmbmV0LT5yeF9zdGF0cy5z
eW5jcCk7CisJbmV0LT5yeF9zdGF0cy5wa3RzICs9IHJ4X3BrdHM7CisJbmV0LT5yeF9zdGF0cy5i
eXRlcyArPSByeF9ieXRlczsKKwluZXQtPnJ4X3N0YXRzLmRyb3BzICs9IHJ4X2Ryb3BzOworCW5l
dC0+cnhfc3RhdHMuZXJyb3JzICs9IHJ4X2Vycm9yczsKKwluZXQtPnJ4X3N0YXRzLm92ZXJydW5z
ICs9IHJ4X292ZXJydW5zOworCXU2NF9zdGF0c191cGRhdGVfZW5kKCZuZXQtPnJ4X3N0YXRzLnN5
bmNwKTsKK30KKworc3RhdGljIGludCB2ZHBhc2ltX25ldF9nZXRfc3RhdHMoc3RydWN0IHZkcGFz
aW0gKnZkcGFzaW0sIHUxNiBpZHgsCisJCQkJIHN0cnVjdCBza19idWZmICptc2csCisJCQkJIHN0
cnVjdCBuZXRsaW5rX2V4dF9hY2sgKmV4dGFjaykKK3sKKwlzdHJ1Y3QgdmRwYXNpbV9uZXQgKm5l
dCA9IHNpbV90b19uZXQodmRwYXNpbSk7CisJdTY0IHJ4X3BrdHMsIHJ4X2J5dGVzLCByeF9lcnJv
cnMsIHJ4X292ZXJydW5zLCByeF9kcm9wczsKKwl1NjQgdHhfcGt0cywgdHhfYnl0ZXMsIHR4X2Vy
cm9ycywgdHhfZHJvcHM7CisJdTY0IGNxX3JlcXVlc3RzLCBjcV9zdWNjZXNzZXMsIGNxX2Vycm9y
czsKKwl1bnNpZ25lZCBpbnQgc3RhcnQ7CisJaW50IGVyciA9IC1FTVNHU0laRTsKKworCXN3aXRj
aChpZHgpIHsKKwljYXNlIDA6CisJCWRvIHsKKwkJCXN0YXJ0ID0gdTY0X3N0YXRzX2ZldGNoX2Jl
Z2luKCZuZXQtPnJ4X3N0YXRzLnN5bmNwKTsKKwkJCXJ4X3BrdHMgPSBuZXQtPnJ4X3N0YXRzLnBr
dHM7CisJCQlyeF9ieXRlcyA9IG5ldC0+cnhfc3RhdHMuYnl0ZXM7CisJCQlyeF9lcnJvcnMgPSBu
ZXQtPnJ4X3N0YXRzLmVycm9yczsKKwkJCXJ4X292ZXJydW5zID0gbmV0LT5yeF9zdGF0cy5vdmVy
cnVuczsKKwkJCXJ4X2Ryb3BzID0gbmV0LT5yeF9zdGF0cy5kcm9wczsKKwkJfSB3aGlsZSAodTY0
X3N0YXRzX2ZldGNoX3JldHJ5KCZuZXQtPnJ4X3N0YXRzLnN5bmNwLCBzdGFydCkpOworCisJCWlm
IChubGFfcHV0X3N0cmluZyhtc2csIFZEUEFfQVRUUl9ERVZfVkVORE9SX0FUVFJfTkFNRSwKKwkJ
CQkJInJ4IHBhY2tldHMiKSkKKwkJCWJyZWFrOworCQlpZiAobmxhX3B1dF91NjRfNjRiaXQobXNn
LCBWRFBBX0FUVFJfREVWX1ZFTkRPUl9BVFRSX1ZBTFVFLAorCQkJCSAgICAgIHJ4X3BrdHMsIFZE
UEFfQVRUUl9QQUQpKQorCQkJYnJlYWs7CisJCWlmIChubGFfcHV0X3N0cmluZyhtc2csIFZEUEFf
QVRUUl9ERVZfVkVORE9SX0FUVFJfTkFNRSwKKwkJCQkgICJyeCBieXRlcyIpKQorCQkJYnJlYWs7
CisJCWlmIChubGFfcHV0X3U2NF82NGJpdChtc2csIFZEUEFfQVRUUl9ERVZfVkVORE9SX0FUVFJf
VkFMVUUsCisJCQkJICAgICAgcnhfYnl0ZXMsIFZEUEFfQVRUUl9QQUQpKQorCQkJYnJlYWs7CisJ
CWlmIChubGFfcHV0X3N0cmluZyhtc2csIFZEUEFfQVRUUl9ERVZfVkVORE9SX0FUVFJfTkFNRSwK
KwkJCQkgICJyeCBlcnJvcnMiKSkKKwkJCWJyZWFrOworCQlpZiAobmxhX3B1dF91NjRfNjRiaXQo
bXNnLCBWRFBBX0FUVFJfREVWX1ZFTkRPUl9BVFRSX1ZBTFVFLAorCQkJCSAgICAgIHJ4X2Vycm9y
cywgVkRQQV9BVFRSX1BBRCkpCisJCQlicmVhazsKKwkJaWYgKG5sYV9wdXRfc3RyaW5nKG1zZywg
VkRQQV9BVFRSX0RFVl9WRU5ET1JfQVRUUl9OQU1FLAorCQkJCSAgInJ4IG92ZXJydW5zcyIpKQor
CQkJYnJlYWs7CisJCWlmIChubGFfcHV0X3U2NF82NGJpdChtc2csIFZEUEFfQVRUUl9ERVZfVkVO
RE9SX0FUVFJfVkFMVUUsCisJCQkJICAgICAgcnhfb3ZlcnJ1bnMsIFZEUEFfQVRUUl9QQUQpKQor
CQkJYnJlYWs7CisJCWlmIChubGFfcHV0X3N0cmluZyhtc2csIFZEUEFfQVRUUl9ERVZfVkVORE9S
X0FUVFJfTkFNRSwKKwkJCQkgICJyeCBkcm9wcyIpKQorCQkJYnJlYWs7CisJCWlmIChubGFfcHV0
X3U2NF82NGJpdChtc2csIFZEUEFfQVRUUl9ERVZfVkVORE9SX0FUVFJfVkFMVUUsCisJCQkJICAg
ICAgcnhfZHJvcHMsIFZEUEFfQVRUUl9QQUQpKQorCQkJYnJlYWs7CisJCWVyciA9IDA7CisJCWJy
ZWFrOworCWNhc2UgMToKKwkJZG8geworCQkJc3RhcnQgPSB1NjRfc3RhdHNfZmV0Y2hfYmVnaW4o
Jm5ldC0+dHhfc3RhdHMuc3luY3ApOworCQkJdHhfcGt0cyA9IG5ldC0+dHhfc3RhdHMucGt0czsK
KwkJCXR4X2J5dGVzID0gbmV0LT50eF9zdGF0cy5ieXRlczsKKwkJCXR4X2Vycm9ycyA9IG5ldC0+
dHhfc3RhdHMuZXJyb3JzOworCQkJdHhfZHJvcHMgPSBuZXQtPnR4X3N0YXRzLmRyb3BzOworCQl9
IHdoaWxlICh1NjRfc3RhdHNfZmV0Y2hfcmV0cnkoJm5ldC0+dHhfc3RhdHMuc3luY3AsIHN0YXJ0
KSk7CisKKwkJaWYgKG5sYV9wdXRfc3RyaW5nKG1zZywgVkRQQV9BVFRSX0RFVl9WRU5ET1JfQVRU
Ul9OQU1FLAorCQkJCSAgInR4IHBhY2tldHMiKSkKKwkJCWJyZWFrOworCQlpZiAobmxhX3B1dF91
NjRfNjRiaXQobXNnLCBWRFBBX0FUVFJfREVWX1ZFTkRPUl9BVFRSX1ZBTFVFLAorCQkJCSAgICAg
IHR4X3BrdHMsIFZEUEFfQVRUUl9QQUQpKQorCQkJYnJlYWs7CisJCWlmIChubGFfcHV0X3N0cmlu
Zyhtc2csIFZEUEFfQVRUUl9ERVZfVkVORE9SX0FUVFJfTkFNRSwKKwkJCQkgICJ0eCBieXRlcyIp
KQorCQkJYnJlYWs7CisJCWlmIChubGFfcHV0X3U2NF82NGJpdChtc2csIFZEUEFfQVRUUl9ERVZf
VkVORE9SX0FUVFJfVkFMVUUsCisJCQkJICAgICAgdHhfYnl0ZXMsIFZEUEFfQVRUUl9QQUQpKQor
CQkJYnJlYWs7CisJCWlmIChubGFfcHV0X3N0cmluZyhtc2csIFZEUEFfQVRUUl9ERVZfVkVORE9S
X0FUVFJfTkFNRSwKKwkJCQkgICJ0eCBlcnJvcnMiKSkKKwkJCWJyZWFrOworCQlpZiAobmxhX3B1
dF91NjRfNjRiaXQobXNnLCBWRFBBX0FUVFJfREVWX1ZFTkRPUl9BVFRSX1ZBTFVFLAorCQkJCSAg
ICAgIHR4X2Vycm9ycywgVkRQQV9BVFRSX1BBRCkpCisJCQlicmVhazsKKwkJaWYgKG5sYV9wdXRf
c3RyaW5nKG1zZywgVkRQQV9BVFRSX0RFVl9WRU5ET1JfQVRUUl9OQU1FLAorCQkJCSAgInR4IGRy
b3BzIikpCisJCQlicmVhazsKKwkJaWYgKG5sYV9wdXRfdTY0XzY0Yml0KG1zZywgVkRQQV9BVFRS
X0RFVl9WRU5ET1JfQVRUUl9WQUxVRSwKKwkJCQkgICAgICB0eF9kcm9wcywgVkRQQV9BVFRSX1BB
RCkpCisJCQlicmVhazsKKwkJZXJyID0gMDsKKwkJYnJlYWs7CisJY2FzZSAyOgorCQlkbyB7CisJ
CQlzdGFydCA9IHU2NF9zdGF0c19mZXRjaF9iZWdpbigmbmV0LT5jcV9zdGF0cy5zeW5jcCk7CisJ
CQljcV9yZXF1ZXN0cyA9IG5ldC0+Y3Ffc3RhdHMucmVxdWVzdHM7CisJCQljcV9zdWNjZXNzZXMg
PSBuZXQtPmNxX3N0YXRzLnN1Y2Nlc3NlczsKKwkJCWNxX2Vycm9ycyA9IG5ldC0+Y3Ffc3RhdHMu
ZXJyb3JzOworCQl9IHdoaWxlICh1NjRfc3RhdHNfZmV0Y2hfcmV0cnkoJm5ldC0+Y3Ffc3RhdHMu
c3luY3AsIHN0YXJ0KSk7CisKKwkJaWYgKG5sYV9wdXRfc3RyaW5nKG1zZywgVkRQQV9BVFRSX0RF
Vl9WRU5ET1JfQVRUUl9OQU1FLAorCQkJCSAgImN2cSByZXF1ZXN0cyIpKQorCQkJYnJlYWs7CisJ
CWlmIChubGFfcHV0X3U2NF82NGJpdChtc2csIFZEUEFfQVRUUl9ERVZfVkVORE9SX0FUVFJfVkFM
VUUsCisJCQkJICAgICAgY3FfcmVxdWVzdHMsIFZEUEFfQVRUUl9QQUQpKQorCQkJYnJlYWs7CisJ
CWlmIChubGFfcHV0X3N0cmluZyhtc2csIFZEUEFfQVRUUl9ERVZfVkVORE9SX0FUVFJfTkFNRSwK
KwkJCQkgICJjdnEgc3VjY2Vzc2VzIikpCisJCQlicmVhazsKKwkJaWYgKG5sYV9wdXRfdTY0XzY0
Yml0KG1zZywgVkRQQV9BVFRSX0RFVl9WRU5ET1JfQVRUUl9WQUxVRSwKKwkJCQkgICAgICBjcV9z
dWNjZXNzZXMsIFZEUEFfQVRUUl9QQUQpKQorCQkJYnJlYWs7CisJCWlmIChubGFfcHV0X3N0cmlu
Zyhtc2csIFZEUEFfQVRUUl9ERVZfVkVORE9SX0FUVFJfTkFNRSwKKwkJCQkgICJjdnEgZXJyb3Jz
IikpCisJCQlicmVhazsKKwkJaWYgKG5sYV9wdXRfdTY0XzY0Yml0KG1zZywgVkRQQV9BVFRSX0RF
Vl9WRU5ET1JfQVRUUl9WQUxVRSwKKwkJCQkgICAgICBjcV9lcnJvcnMsIFZEUEFfQVRUUl9QQUQp
KQorCQkJYnJlYWs7CisJCWVyciA9IDA7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCWVyciA9IC1F
SU5WQUw7CisJCWJyZWFrOworCX0KKworCXJldHVybiBlcnI7CiB9CiAKIHN0YXRpYyB2b2lkIHZk
cGFzaW1fbmV0X2dldF9jb25maWcoc3RydWN0IHZkcGFzaW0gKnZkcGFzaW0sIHZvaWQgKmNvbmZp
ZykKQEAgLTI0Myw2ICs0NDIsNyBAQCBzdGF0aWMgaW50IHZkcGFzaW1fbmV0X2Rldl9hZGQoc3Ry
dWN0IHZkcGFfbWdtdF9kZXYgKm1kZXYsIGNvbnN0IGNoYXIgKm5hbWUsCiAJCQkgICAgICAgY29u
c3Qgc3RydWN0IHZkcGFfZGV2X3NldF9jb25maWcgKmNvbmZpZykKIHsKIAlzdHJ1Y3QgdmRwYXNp
bV9kZXZfYXR0ciBkZXZfYXR0ciA9IHt9OworCXN0cnVjdCB2ZHBhc2ltX25ldCAqbmV0OwogCXN0
cnVjdCB2ZHBhc2ltICpzaW1kZXY7CiAJaW50IHJldDsKIApAQCAtMjUzLDEwICs0NTMsMTEgQEAg
c3RhdGljIGludCB2ZHBhc2ltX25ldF9kZXZfYWRkKHN0cnVjdCB2ZHBhX21nbXRfZGV2ICptZGV2
LCBjb25zdCBjaGFyICpuYW1lLAogCWRldl9hdHRyLm52cXMgPSBWRFBBU0lNX05FVF9WUV9OVU07
CiAJZGV2X2F0dHIubmdyb3VwcyA9IFZEUEFTSU1fTkVUX0dST1VQX05VTTsKIAlkZXZfYXR0ci5u
YXMgPSBWRFBBU0lNX05FVF9BU19OVU07Ci0JZGV2X2F0dHIuYWxsb2Nfc2l6ZSA9IHNpemVvZihz
dHJ1Y3QgdmRwYXNpbSk7CisJZGV2X2F0dHIuYWxsb2Nfc2l6ZSA9IHNpemVvZihzdHJ1Y3QgdmRw
YXNpbV9uZXQpOwogCWRldl9hdHRyLmNvbmZpZ19zaXplID0gc2l6ZW9mKHN0cnVjdCB2aXJ0aW9f
bmV0X2NvbmZpZyk7CiAJZGV2X2F0dHIuZ2V0X2NvbmZpZyA9IHZkcGFzaW1fbmV0X2dldF9jb25m
aWc7CiAJZGV2X2F0dHIud29ya19mbiA9IHZkcGFzaW1fbmV0X3dvcms7CisJZGV2X2F0dHIuZ2V0
X3N0YXRzID0gdmRwYXNpbV9uZXRfZ2V0X3N0YXRzOwogCWRldl9hdHRyLmJ1ZmZlcl9zaXplID0g
UEFHRV9TSVpFOwogCiAJc2ltZGV2ID0gdmRwYXNpbV9jcmVhdGUoJmRldl9hdHRyLCBjb25maWcp
OwpAQCAtMjY5LDYgKzQ3MCwxMiBAQCBzdGF0aWMgaW50IHZkcGFzaW1fbmV0X2Rldl9hZGQoc3Ry
dWN0IHZkcGFfbWdtdF9kZXYgKm1kZXYsIGNvbnN0IGNoYXIgKm5hbWUsCiAJaWYgKHJldCkKIAkJ
Z290byByZWdfZXJyOwogCisJbmV0ID0gc2ltX3RvX25ldChzaW1kZXYpOworCisJdTY0X3N0YXRz
X2luaXQoJm5ldC0+dHhfc3RhdHMuc3luY3ApOworCXU2NF9zdGF0c19pbml0KCZuZXQtPnJ4X3N0
YXRzLnN5bmNwKTsKKwl1NjRfc3RhdHNfaW5pdCgmbmV0LT5jcV9zdGF0cy5zeW5jcCk7CisKIAly
ZXR1cm4gMDsKIAogcmVnX2VycjoKLS0gCjIuMjUuMQoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1
YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhm
b3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
