Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 30637155E00
	for <lists.virtualization@lfdr.de>; Fri,  7 Feb 2020 19:26:21 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id CC05E869D1;
	Fri,  7 Feb 2020 18:26:19 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id ylSPSq8Qy6y2; Fri,  7 Feb 2020 18:26:16 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id CF64B869F5;
	Fri,  7 Feb 2020 18:26:02 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 9AEFBC1D89;
	Fri,  7 Feb 2020 18:26:02 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id DEFD9C013E
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:57 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by silver.osuosl.org (Postfix) with ESMTP id D193D20487
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:57 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id QY3-HHn-G0Mf
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:57 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by silver.osuosl.org (Postfix) with ESMTPS id 08DEC2263C
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:56 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 39755305D357; Fri,  7 Feb 2020 20:16:41 +0200 (EET)
Received: from host.bbu.bitdefender.biz (unknown [195.210.4.22])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 149E63052079;
 Fri,  7 Feb 2020 20:16:41 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [RFC PATCH v7 57/78] KVM: introspection: add KVMI_EVENT_HYPERCALL
Date: Fri,  7 Feb 2020 20:16:15 +0200
Message-Id: <20200207181636.1065-58-alazar@bitdefender.com>
In-Reply-To: <20200207181636.1065-1-alazar@bitdefender.com>
References: <20200207181636.1065-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 Sean Christopherson <sean.j.christopherson@intel.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBldmVudCBp
cyBzZW50IG9uIGEgc3BlY2lmaWMgdXNlciBoeXBlcmNhbGwuCgpJdCBpcyB1c2VkIGJ5IHRoZSBj
b2RlIHJlc2lkaW5nIGluc2lkZSB0aGUgaW50cm9zcGVjdGVkIGd1ZXN0IHRvIGNhbGwgdGhlCmlu
dHJvc3BlY3Rpb24gdG9vbCBhbmQgdG8gcmVwb3J0IGNlcnRhaW4gZGV0YWlscyBhYm91dCBpdHMg
b3BlcmF0aW9uLgpGb3IgZXhhbXBsZSwgYSBjbGFzc2ljIGFudGltYWx3YXJlIHJlbWVkaWF0aW9u
IHRvb2wgY2FuIHJlcG9ydAp3aGF0IGl0IGhhcyBmb3VuZCBkdXJpbmcgYSBzY2FuLgoKU2lnbmVk
LW9mZi1ieTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgpDby1kZXZlbG9w
ZWQtYnk6IEFkYWxiZXJ0IExhesSDciA8YWxhemFyQGJpdGRlZmVuZGVyLmNvbT4KU2lnbmVkLW9m
Zi1ieTogQWRhbGJlcnQgTGF6xINyIDxhbGF6YXJAYml0ZGVmZW5kZXIuY29tPgotLS0KIERvY3Vt
ZW50YXRpb24vdmlydC9rdm0vaHlwZXJjYWxscy50eHQgICAgICAgICB8IDMyICsrKysrKysrKysr
KysrCiBEb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0ICAgICAgICAgICAgICAgfCAzNiAr
KysrKysrKysrKysrKystCiBhcmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaCAgICAgICAg
ICAgICAgfCAgMiArCiBhcmNoL3g4Ni9rdm0va3ZtaS5jICAgICAgICAgICAgICAgICAgICAgICAg
ICAgfCAzMyArKysrKysrKysrKysrKwogYXJjaC94ODYva3ZtL3g4Ni5jICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHwgMTYgKysrKystLQogaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaCAgICAg
ICAgICAgICAgICAgICAgIHwgIDIgKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2bV9wYXJhLmggICAg
ICAgICAgICAgICAgIHwgIDEgKwogaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCAgICAgICAgICAg
ICAgICAgICAgIHwgIDEgKwogLi4uL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90
ZXN0LmMgIHwgNDMgKysrKysrKysrKysrKysrKysrKwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9r
dm1pLmMgICAgICAgICAgICAgICAgIHwgMjIgKysrKysrKysrKwogdmlydC9rdm0vaW50cm9zcGVj
dGlvbi9rdm1pX2ludC5oICAgICAgICAgICAgIHwgMTMgKysrKystCiB2aXJ0L2t2bS9pbnRyb3Nw
ZWN0aW9uL2t2bWlfbXNnLmMgICAgICAgICAgICAgfCAxMiArKysrKysKIDEyIGZpbGVzIGNoYW5n
ZWQsIDIwOCBpbnNlcnRpb25zKCspLCA1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL0RvY3Vt
ZW50YXRpb24vdmlydC9rdm0vaHlwZXJjYWxscy50eHQgYi9Eb2N1bWVudGF0aW9uL3ZpcnQva3Zt
L2h5cGVyY2FsbHMudHh0CmluZGV4IGFmZjI3MmJlZGUwOC4uYzRmNmNjZTFlNGQzIDEwMDY0NAot
LS0gYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2h5cGVyY2FsbHMudHh0CisrKyBiL0RvY3VtZW50
YXRpb24vdmlydC9rdm0vaHlwZXJjYWxscy50eHQKQEAgLTE1MiwzICsxNTIsMzUgQEAgYTA6IGRl
c3RpbmF0aW9uIEFQSUMgSUQKIAogVXNhZ2UgZXhhbXBsZTogV2hlbiBzZW5kaW5nIGEgY2FsbC1m
dW5jdGlvbiBJUEktbWFueSB0byB2Q1BVcywgeWllbGQgaWYKIGFueSBvZiB0aGUgSVBJIHRhcmdl
dCB2Q1BVcyB3YXMgcHJlZW1wdGVkLgorCis5LiBLVk1fSENfWEVOX0hWTV9PUAorLS0tLS0tLS0t
LS0tLS0tLS0tLS0KKworQXJjaGl0ZWN0dXJlOiB4ODYKK1N0YXR1czogYWN0aXZlCitQdXJwb3Nl
OiBUbyBlbmFibGUgY29tbXVuaWNhdGlvbiBiZXR3ZWVuIGEgZ3Vlc3QgYWdlbnQgYW5kIGEgVk1J
IGFwcGxpY2F0aW9uCitVc2FnZToKKworQW4gZXZlbnQgd2lsbCBiZSBzZW50IHRvIHRoZSBWTUkg
YXBwbGljYXRpb24gKHNlZSBrdm1pLnJzdCkgaWYgdGhlIGZvbGxvd2luZworcmVnaXN0ZXJzLCB3
aGljaCBkaWZmZXIgYmV0d2VlbiAzMmJpdCBhbmQgNjRiaXQsIGhhdmUgdGhlIGZvbGxvd2luZyB2
YWx1ZXM6CisKKyAgICAgICAzMmJpdCAgICAgICA2NGJpdCAgICAgdmFsdWUKKyAgICAgICAtLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAgICAgICBlYnggKGEwKSAgICByZGkgICAgICAgS1ZN
X0hDX1hFTl9IVk1fT1BfR1VFU1RfUkVRVUVTVF9WTV9FVkVOVAorICAgICAgIGVjeCAoYTEpICAg
IHJzaSAgICAgICAwCisKK1RoaXMgc3BlY2lmaWNhdGlvbiBjb3BpZXMgWGVuJ3MgeyBfX0hZUEVS
VklTT1JfaHZtX29wLAorSFZNT1BfZ3Vlc3RfcmVxdWVzdF92bV9ldmVudCB9IGh5cGVyY2FsbCBh
bmQgY2FuIG9yaWdpbmF0ZSBmcm9tIGtlcm5lbCBvcgordXNlcnNwYWNlLgorCitJdCByZXR1cm5z
IDAgaWYgc3VjY2Vzc2Z1bCwgb3IgYSBuZWdhdGl2ZSBQT1NJWC4xIGVycm9yIGNvZGUgaWYgaXQg
ZmFpbHMuIFRoZQorYWJzZW5jZSBvZiBhbiBhY3RpdmUgVk1JIGFwcGxpY2F0aW9uIGlzIG5vdCBz
aWduYWxlZCBpbiBhbnkgd2F5LgorCitUaGUgZm9sbG93aW5nIHJlZ2lzdGVycyBhcmUgY2xvYmJl
cmVkOgorCisgICogMzJiaXQ6IGVkeCwgZXNpLCBlZGksIGVicAorICAqIDY0Yml0OiByZHgsIHIx
MCwgcjgsIHI5CisKK0luIHBhcnRpY3VsYXIsIGZvciBLVk1fSENfWEVOX0hWTV9PUF9HVUVTVF9S
RVFVRVNUX1ZNX0VWRU5ULCB0aGUgbGFzdCB0d28KK3JlZ2lzdGVycyBjYW4gYmUgcG9pc29uZWQg
ZGVsaWJlcmF0ZWx5IGFuZCBjYW5ub3QgYmUgdXNlZCBmb3IgcGFzc2luZworaW5mb3JtYXRpb24u
CmRpZmYgLS1naXQgYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0IGIvRG9jdW1lbnRh
dGlvbi92aXJ0L2t2bS9rdm1pLnJzdAppbmRleCBmOWY5NjE1MDljNjEuLjkwMjU2MTQxYTE1ZCAx
MDA2NDQKLS0tIGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdAorKysgYi9Eb2N1bWVu
dGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CkBAIC01MjcsNyArNTI3LDEwIEBAIFVzZSAqS1ZNSV9W
TV9DSEVDS19FVkVOVCogZmlyc3QuCiAKIAlzdHJ1Y3Qga3ZtaV9lcnJvcl9jb2RlCiAKLUVuYWJs
ZXMvZGlzYWJsZXMgdkNQVSBpbnRyb3NwZWN0aW9uIGV2ZW50cy4KK0VuYWJsZXMvZGlzYWJsZXMg
dkNQVSBpbnRyb3NwZWN0aW9uIGV2ZW50cy4gVGhpcyBjb21tYW5kIGNhbiBiZSB1c2VkIHdpdGgK
K3RoZSBmb2xsb3dpbmcgZXZlbnRzOjoKKworCUtWTUlfRVZFTlRfSFlQRVJDQUxMCiAKIFdoZW4g
YW4gZXZlbnQgaXMgZW5hYmxlZCwgdGhlIGludHJvc3BlY3Rpb24gdG9vbCBpcyBub3RpZmllZCBh
bmQgaXQKIG11c3QgcmVwbHkgd2l0aDogY29udGludWUsIHJldHJ5LCBjcmFzaCwgZXRjLiAoc2Vl
ICoqRXZlbnRzKiogYmVsb3cpLgpAQCAtNzY0LDMgKzc2NywzNCBAQCBUaGlzIGV2ZW50IGlzIHNl
bnQgaW4gcmVzcG9uc2UgdG8gYSAqS1ZNSV9WQ1BVX1BBVVNFKiBjb21tYW5kLgogCiBUaGlzIGV2
ZW50IGhhcyBhIGxvdyBwcmlvcml0eS4gSXQgd2lsbCBiZSBzZW50IGFmdGVyIGFueSBvdGhlciB2
Q1BVCiBpbnRyb3NwZWN0aW9uIGV2ZW50IGFuZCB3aGVuIG5vIHZDUFUgaW50cm9zcGVjdGlvbiBj
b21tYW5kIGlzIHF1ZXVlZC4KKworMy4gS1ZNSV9FVkVOVF9IWVBFUkNBTEwKKy0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tCisKKzpBcmNoaXRlY3R1cmVzOiB4ODYKKzpWZXJzaW9uczogPj0gMQorOkFj
dGlvbnM6IENPTlRJTlVFLCBDUkFTSAorOlBhcmFtZXRlcnM6CisKKzo6CisKKwlzdHJ1Y3Qga3Zt
aV9ldmVudDsKKworOlJldHVybnM6CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV92Y3B1X2hkcjsKKwlz
dHJ1Y3Qga3ZtaV9ldmVudF9yZXBseTsKKworVGhpcyBldmVudCBpcyBzZW50IG9uIGEgc3BlY2lm
aWMgdXNlciBoeXBlcmNhbGwgd2hlbiB0aGUgaW50cm9zcGVjdGlvbiBoYXMKK2JlZW4gZW5hYmxl
ZCBmb3IgdGhpcyBldmVudCAoc2VlICpLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMqKS4KKworVGhl
IGh5cGVyY2FsbCBudW1iZXIgbXVzdCBiZSBgYEtWTV9IQ19YRU5fSFZNX09QYGAgd2l0aCB0aGUK
K2BgS1ZNX0hDX1hFTl9IVk1fT1BfR1VFU1RfUkVRVUVTVF9WTV9FVkVOVGBgIHN1Yi1mdW5jdGlv
bgorKHNlZSBoeXBlcmNhbGxzLnR4dCkuCisKK0l0IGlzIHVzZWQgYnkgdGhlIGNvZGUgcmVzaWRp
bmcgaW5zaWRlIHRoZSBpbnRyb3NwZWN0ZWQgZ3Vlc3QgdG8gY2FsbCB0aGUKK2ludHJvc3BlY3Rp
b24gdG9vbCBhbmQgdG8gcmVwb3J0IGNlcnRhaW4gZGV0YWlscyBhYm91dCBpdHMgb3BlcmF0aW9u
LiBGb3IKK2V4YW1wbGUsIGEgY2xhc3NpYyBhbnRpbWFsd2FyZSByZW1lZGlhdGlvbiB0b29sIGNh
biByZXBvcnQgd2hhdCBpdCBoYXMKK2ZvdW5kIGR1cmluZyBhIHNjYW4uCmRpZmYgLS1naXQgYS9h
cmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaCBiL2FyY2gveDg2L2luY2x1ZGUvdWFwaS9h
c20va3ZtaS5oCmluZGV4IDU3YzQ4YWNlNDE3Zi4uOTg4MmU2OGNhYjc1IDEwMDY0NAotLS0gYS9h
cmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaAorKysgYi9hcmNoL3g4Ni9pbmNsdWRlL3Vh
cGkvYXNtL2t2bWkuaApAQCAtOCw2ICs4LDggQEAKIAogI2luY2x1ZGUgPGFzbS9rdm0uaD4KIAor
I2RlZmluZSBLVk1fSENfWEVOX0hWTV9PUF9HVUVTVF9SRVFVRVNUX1ZNX0VWRU5UIDI0CisKIHN0
cnVjdCBrdm1pX2V2ZW50X2FyY2ggewogCV9fdTggbW9kZTsJCS8qIDIsIDQgb3IgOCAqLwogCV9f
dTggcGFkZGluZ1s3XTsKZGlmZiAtLWdpdCBhL2FyY2gveDg2L2t2bS9rdm1pLmMgYi9hcmNoL3g4
Ni9rdm0va3ZtaS5jCmluZGV4IGJiYTg1ZjMzMzYzOS4uZjU5N2IzYzFjYmEwIDEwMDY0NAotLS0g
YS9hcmNoL3g4Ni9rdm0va3ZtaS5jCisrKyBiL2FyY2gveDg2L2t2bS9rdm1pLmMKQEAgLTE1OSwz
ICsxNTksMzYgQEAgaW50IGt2bWlfYXJjaF9jbWRfdmNwdV9nZXRfY3B1aWQoc3RydWN0IGt2bV92
Y3B1ICp2Y3B1LAogCiAJcmV0dXJuIDA7CiB9CisKK2Jvb2wga3ZtaV9hcmNoX2lzX2FnZW50X2h5
cGVyY2FsbChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCit7CisJdW5zaWduZWQgbG9uZyBzdWJmdW5j
MSwgc3ViZnVuYzI7CisJYm9vbCBsb25nbW9kZSA9IGlzXzY0X2JpdF9tb2RlKHZjcHUpOworCisJ
aWYgKGxvbmdtb2RlKSB7CisJCXN1YmZ1bmMxID0ga3ZtX3JkaV9yZWFkKHZjcHUpOworCQlzdWJm
dW5jMiA9IGt2bV9yc2lfcmVhZCh2Y3B1KTsKKwl9IGVsc2UgeworCQlzdWJmdW5jMSA9IGt2bV9y
YnhfcmVhZCh2Y3B1KTsKKwkJc3ViZnVuYzEgJj0gMHhGRkZGRkZGRjsKKwkJc3ViZnVuYzIgPSBr
dm1fcmN4X3JlYWQodmNwdSk7CisJCXN1YmZ1bmMyICY9IDB4RkZGRkZGRkY7CisJfQorCisJcmV0
dXJuIChzdWJmdW5jMSA9PSBLVk1fSENfWEVOX0hWTV9PUF9HVUVTVF9SRVFVRVNUX1ZNX0VWRU5U
CisJCSYmIHN1YmZ1bmMyID09IDApOworfQorCit2b2lkIGt2bWlfYXJjaF9oeXBlcmNhbGxfZXZl
bnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQoreworCXUzMiBhY3Rpb247CisKKwlhY3Rpb24gPSBr
dm1pX21zZ19zZW5kX2h5cGVyY2FsbCh2Y3B1KTsKKwlzd2l0Y2ggKGFjdGlvbikgeworCWNhc2Ug
S1ZNSV9FVkVOVF9BQ1RJT05fQ09OVElOVUU6CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCWt2bWlf
aGFuZGxlX2NvbW1vbl9ldmVudF9hY3Rpb25zKHZjcHUtPmt2bSwgYWN0aW9uLAorCQkJCQkJIkhZ
UEVSQ0FMTCIpOworCX0KK30KZGlmZiAtLWdpdCBhL2FyY2gveDg2L2t2bS94ODYuYyBiL2FyY2gv
eDg2L2t2bS94ODYuYwppbmRleCA0NmExMzU1OTU4OTMuLmI0YTc4MDVjZTllNCAxMDA2NDQKLS0t
IGEvYXJjaC94ODYva3ZtL3g4Ni5jCisrKyBiL2FyY2gveDg2L2t2bS94ODYuYwpAQCAtNzQzMywx
MSArNzQzMywxNCBAQCBpbnQga3ZtX2VtdWxhdGVfaHlwZXJjYWxsKHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSkKIHsKIAl1bnNpZ25lZCBsb25nIG5yLCBhMCwgYTEsIGEyLCBhMywgcmV0OwogCWludCBv
cF82NF9iaXQ7CisJYm9vbCBrdm1pX2hjOwogCi0JaWYgKGt2bV9odl9oeXBlcmNhbGxfZW5hYmxl
ZCh2Y3B1LT5rdm0pKQorCW5yID0ga3ZtX3JheF9yZWFkKHZjcHUpOworCWt2bWlfaGMgPSAodTMy
KW5yID09IEtWTV9IQ19YRU5fSFZNX09QOworCisJaWYgKGt2bV9odl9oeXBlcmNhbGxfZW5hYmxl
ZCh2Y3B1LT5rdm0pICYmICFrdm1pX2hjKQogCQlyZXR1cm4ga3ZtX2h2X2h5cGVyY2FsbCh2Y3B1
KTsKIAotCW5yID0ga3ZtX3JheF9yZWFkKHZjcHUpOwogCWEwID0ga3ZtX3JieF9yZWFkKHZjcHUp
OwogCWExID0ga3ZtX3JjeF9yZWFkKHZjcHUpOwogCWEyID0ga3ZtX3JkeF9yZWFkKHZjcHUpOwpA
QCAtNzQ1NCw3ICs3NDU3LDcgQEAgaW50IGt2bV9lbXVsYXRlX2h5cGVyY2FsbChzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUpCiAJCWEzICY9IDB4RkZGRkZGRkY7CiAJfQogCi0JaWYgKGt2bV94ODZfb3Bz
LT5nZXRfY3BsKHZjcHUpICE9IDApIHsKKwlpZiAoa3ZtX3g4Nl9vcHMtPmdldF9jcGwodmNwdSkg
IT0gMCAmJiAha3ZtaV9oYykgewogCQlyZXQgPSAtS1ZNX0VQRVJNOwogCQlnb3RvIG91dDsKIAl9
CkBAIC03NDgwLDYgKzc0ODMsMTMgQEAgaW50IGt2bV9lbXVsYXRlX2h5cGVyY2FsbChzdHJ1Y3Qg
a3ZtX3ZjcHUgKnZjcHUpCiAJCWt2bV9zY2hlZF95aWVsZCh2Y3B1LT5rdm0sIGEwKTsKIAkJcmV0
ID0gMDsKIAkJYnJlYWs7CisjaWZkZWYgQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OCisJY2FzZSBL
Vk1fSENfWEVOX0hWTV9PUDoKKwkJcmV0ID0gMDsKKwkJaWYgKCFrdm1pX2h5cGVyY2FsbF9ldmVu
dCh2Y3B1KSkKKwkJCXJldCA9IC1LVk1fRU5PU1lTOworCQlicmVhazsKKyNlbmRpZiAvKiBDT05G
SUdfS1ZNX0lOVFJPU1BFQ1RJT04gKi8KIAlkZWZhdWx0OgogCQlyZXQgPSAtS1ZNX0VOT1NZUzsK
IAkJYnJlYWs7CmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oIGIvaW5jbHVk
ZS9saW51eC9rdm1pX2hvc3QuaAppbmRleCA2OGM3NmRiODM5NzMuLjBhODViZmJkMGMwYyAxMDA2
NDQKLS0tIGEvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaAorKysgYi9pbmNsdWRlL2xpbnV4L2t2
bWlfaG9zdC5oCkBAIC03NSw2ICs3NSw3IEBAIGludCBrdm1pX2lvY3RsX2V2ZW50KHN0cnVjdCBr
dm0gKmt2bSwgdm9pZCBfX3VzZXIgKmFyZ3ApOwogaW50IGt2bWlfaW9jdGxfcHJldW5ob29rKHN0
cnVjdCBrdm0gKmt2bSk7CiAKIHZvaWQga3ZtaV9oYW5kbGVfcmVxdWVzdHMoc3RydWN0IGt2bV92
Y3B1ICp2Y3B1KTsKK2Jvb2wga3ZtaV9oeXBlcmNhbGxfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2
Y3B1KTsKIAogI2Vsc2UKIApAQCAtODUsNiArODYsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQga3Zt
aV9kZXN0cm95X3ZtKHN0cnVjdCBrdm0gKmt2bSkgeyB9CiBzdGF0aWMgaW5saW5lIHZvaWQga3Zt
aV92Y3B1X3VuaW5pdChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpIHsgfQogCiBzdGF0aWMgaW5saW5l
IHZvaWQga3ZtaV9oYW5kbGVfcmVxdWVzdHMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KSB7IH0KK3N0
YXRpYyBpbmxpbmUgYm9vbCBrdm1pX2h5cGVyY2FsbF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZj
cHUpIHsgcmV0dXJuIGZhbHNlOyB9CiAKICNlbmRpZiAvKiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJ
T04gKi8KIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2bV9wYXJhLmggYi9pbmNs
dWRlL3VhcGkvbGludXgva3ZtX3BhcmEuaAppbmRleCAzY2UzODgyNDk2ODIuLjUzY2ViYmUyMjA5
OSAxMDA2NDQKLS0tIGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2bV9wYXJhLmgKKysrIGIvaW5jbHVk
ZS91YXBpL2xpbnV4L2t2bV9wYXJhLmgKQEAgLTMzLDYgKzMzLDcgQEAKICNkZWZpbmUgS1ZNX0hD
X0NMT0NLX1BBSVJJTkcJCTkKICNkZWZpbmUgS1ZNX0hDX1NFTkRfSVBJCQkxMAogI2RlZmluZSBL
Vk1fSENfU0NIRURfWUlFTEQJCTExCisjZGVmaW5lIEtWTV9IQ19YRU5fSFZNX09QCQkzNCAvKiBY
ZW4ncyBfX0hZUEVSVklTT1JfaHZtX29wICovCiAKIC8qCiAgKiBoeXBlcmNhbGxzIHVzZSBhcmNo
aXRlY3R1cmUgc3BlY2lmaWMKZGlmZiAtLWdpdCBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgg
Yi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oCmluZGV4IDA1NTM1YTdkOTMxMy4uMjBlMmYxNTRh
Yjg4IDEwMDY0NAotLS0gYS9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oCisrKyBiL2luY2x1ZGUv
dWFwaS9saW51eC9rdm1pLmgKQEAgLTM5LDYgKzM5LDcgQEAgZW51bSB7CiBlbnVtIHsKIAlLVk1J
X0VWRU5UX1VOSE9PSyAgICAgPSAwLAogCUtWTUlfRVZFTlRfUEFVU0VfVkNQVSA9IDEsCisJS1ZN
SV9FVkVOVF9IWVBFUkNBTEwgID0gMiwKIAogCUtWTUlfTlVNX0VWRU5UUwogfTsKZGlmZiAtLWdp
dCBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMgYi90b29s
cy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCmluZGV4IGZhMjNjYTBl
ZDBkNy4uZWY0ZTMzZTkyZmZmIDEwMDY0NAotLS0gYS90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9r
dm0veDg2XzY0L2t2bWlfdGVzdC5jCisrKyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94
ODZfNjQva3ZtaV90ZXN0LmMKQEAgLTQ4LDYgKzQ4LDcgQEAgc3RydWN0IHZjcHVfd29ya2VyX2Rh
dGEgewogCiBlbnVtIHsKIAlHVUVTVF9URVNUX05PT1AgPSAwLAorCUdVRVNUX1RFU1RfSFlQRVJD
QUxMLAogfTsKIAogI2RlZmluZSBHVUVTVF9SRVFVRVNUX1RFU1QoKSAgICAgR1VFU1RfU1lOQygw
KQpAQCAtNjEsMTIgKzYyLDIzIEBAIHN0YXRpYyBpbnQgZ3Vlc3RfdGVzdF9pZCh2b2lkKQogCXJl
dHVybiBSRUFEX09OQ0UodGVzdF9pZCk7CiB9CiAKK3N0YXRpYyB2b2lkIGd1ZXN0X2h5cGVyY2Fs
bF90ZXN0KHZvaWQpCit7CisJYXNtIHZvbGF0aWxlKCJtb3YgJDM0LCAlcmF4Iik7CisJYXNtIHZv
bGF0aWxlKCJtb3YgJDI0LCAlcmRpIik7CisJYXNtIHZvbGF0aWxlKCJtb3YgJDAsICVyc2kiKTsK
Kwlhc20gdm9sYXRpbGUoIi5ieXRlIDB4MGYsMHgwMSwweGMxIik7Cit9CisKIHN0YXRpYyB2b2lk
IGd1ZXN0X2NvZGUodm9pZCkKIHsKIAl3aGlsZSAodHJ1ZSkgewogCQlzd2l0Y2ggKGd1ZXN0X3Rl
c3RfaWQoKSkgewogCQljYXNlIEdVRVNUX1RFU1RfTk9PUDoKIAkJCWJyZWFrOworCQljYXNlIEdV
RVNUX1RFU1RfSFlQRVJDQUxMOgorCQkJZ3Vlc3RfaHlwZXJjYWxsX3Rlc3QoKTsKKwkJCWJyZWFr
OwogCQl9CiAJCUdVRVNUX1NJR05BTF9URVNUX0RPTkUoKTsKIAl9CkBAIC05NDIsNiArOTU0LDM2
IEBAIHN0YXRpYyB2b2lkIHRlc3RfY21kX3ZjcHVfZ2V0X2NwdWlkKHN0cnVjdCBrdm1fdm0gKnZt
KQogCSAgICAgIGZ1bmN0aW9uLCBpbmRleCwgcnBsLmVheCwgcnBsLmVieCwgcnBsLmVjeCwgcnBs
LmVkeCk7CiB9CiAKK3N0YXRpYyB2b2lkIHRlc3RfZXZlbnRfaHlwZXJjYWxsKHN0cnVjdCBrdm1f
dm0gKnZtKQoreworCXN0cnVjdCB2Y3B1X3dvcmtlcl9kYXRhIGRhdGEgPSB7CisJCS52bSA9IHZt
LAorCQkudmNwdV9pZCA9IFZDUFVfSUQsCisJCS50ZXN0X2lkID0gR1VFU1RfVEVTVF9IWVBFUkNB
TEwsCisJfTsKKwlzdHJ1Y3Qga3ZtaV9tc2dfaGRyIGhkcjsKKwlzdHJ1Y3Qga3ZtaV9ldmVudCBl
djsKKwlzdHJ1Y3QgdmNwdV9yZXBseSBycGwgPSB7fTsKKwlfX3UxNiBldmVudF9pZCA9IEtWTUlf
RVZFTlRfSFlQRVJDQUxMOworCXB0aHJlYWRfdCB2Y3B1X3RocmVhZDsKKworCWVuYWJsZV92Y3B1
X2V2ZW50KHZtLCBldmVudF9pZCk7CisKKwl2Y3B1X3RocmVhZCA9IHN0YXJ0X3ZjcHVfd29ya2Vy
KCZkYXRhKTsKKworCXJlY2VpdmVfZXZlbnQoJmhkciwgJmV2LCBzaXplb2YoZXYpLCBldmVudF9p
ZCk7CisKKwlERUJVRygiSHlwZXJjYWxsIGV2ZW50LCByaXAgMHglbGx4XG4iLAorCQlldi5hcmNo
LnJlZ3MucmlwKTsKKworCXJlcGx5X3RvX2V2ZW50KCZoZHIsICZldiwgS1ZNSV9FVkVOVF9BQ1RJ
T05fQ09OVElOVUUsCisJCQkmcnBsLCBzaXplb2YocnBsKSk7CisKKwlzdG9wX3ZjcHVfd29ya2Vy
KHZjcHVfdGhyZWFkLCAmZGF0YSk7CisKKwlkaXNhYmxlX3ZjcHVfZXZlbnQodm0sIGV2ZW50X2lk
KTsKK30KKwogc3RhdGljIHZvaWQgdGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZt
KQogewogCXNldHVwX3NvY2tldCgpOwpAQCAtOTYxLDYgKzEwMDMsNyBAQCBzdGF0aWMgdm9pZCB0
ZXN0X2ludHJvc3BlY3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCiAJdGVzdF9jbWRfdmNwdV9nZXRf
cmVnaXN0ZXJzKHZtKTsKIAl0ZXN0X2NtZF92Y3B1X3NldF9yZWdpc3RlcnModm0pOwogCXRlc3Rf
Y21kX3ZjcHVfZ2V0X2NwdWlkKHZtKTsKKwl0ZXN0X2V2ZW50X2h5cGVyY2FsbCh2bSk7CiAKIAl1
bmhvb2tfaW50cm9zcGVjdGlvbih2bSk7CiB9CmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3Nw
ZWN0aW9uL2t2bWkuYyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCmluZGV4IDhmZmJm
NDZiYzE3ZC4uYTFjMDU5NDg5ZGVhIDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9u
L2t2bWkuYworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwpAQCAtODI4LDMgKzgy
OCwyNSBAQCB2b2lkIGt2bWlfcG9zdF9yZXBseShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCiAJCXZj
cHVpLT5oYXZlX2RlbGF5ZWRfcmVncyA9IGZhbHNlOwogCX0KIH0KKworYm9vbCBrdm1pX2h5cGVy
Y2FsbF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCit7CisJc3RydWN0IGt2bV9pbnRyb3Nw
ZWN0aW9uICprdm1pOworCWJvb2wgcmV0ID0gZmFsc2U7CisKKwlpZiAoIWt2bWlfYXJjaF9pc19h
Z2VudF9oeXBlcmNhbGwodmNwdSkpCisJCXJldHVybiByZXQ7CisKKwlrdm1pID0ga3ZtaV9nZXQo
dmNwdS0+a3ZtKTsKKwlpZiAoIWt2bWkpCisJCXJldHVybiByZXQ7CisKKwlpZiAoaXNfZXZlbnRf
ZW5hYmxlZCh2Y3B1LCBLVk1JX0VWRU5UX0hZUEVSQ0FMTCkpIHsKKwkJa3ZtaV9hcmNoX2h5cGVy
Y2FsbF9ldmVudCh2Y3B1KTsKKwkJcmV0ID0gdHJ1ZTsKKwl9CisKKwlrdm1pX3B1dCh2Y3B1LT5r
dm0pOworCisJcmV0dXJuIHJldDsKK30KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rp
b24va3ZtaV9pbnQuaCBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaAppbmRleCAx
YjNkODk1OGU2YzguLjNkYmNmOTQ0YTYwNiAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVj
dGlvbi9rdm1pX2ludC5oCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaApA
QCAtMjIsNyArMjIsOCBAQAogCQkJICBCSVQoS1ZNSV9FVkVOVF9VTkhPT0spIFwKIAkJKQogI2Rl
ZmluZSBLVk1JX0tOT1dOX1ZDUFVfRVZFTlRTICggXAotCQkJICBCSVQoS1ZNSV9FVkVOVF9QQVVT
RV9WQ1BVKSBcCisJCQkgICAgQklUKEtWTUlfRVZFTlRfSFlQRVJDQUxMKSBcCisJCQkgIHwgQklU
KEtWTUlfRVZFTlRfUEFVU0VfVkNQVSkgXAogCQkpCiAKICNkZWZpbmUgS1ZNSV9LTk9XTl9FVkVO
VFMgKEtWTUlfS05PV05fVk1fRVZFTlRTIHwgS1ZNSV9LTk9XTl9WQ1BVX0VWRU5UUykKQEAgLTUy
LDYgKzUzLDExIEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBpc192bV9ldmVudF9lbmFibGVkKHN0cnVj
dCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSwKIAlyZXR1cm4gdGVzdF9iaXQoZXZlbnQsIGt2bWkt
PnZtX2V2ZW50X2VuYWJsZV9tYXNrKTsKIH0KIAorc3RhdGljIGlubGluZSBib29sIGlzX2V2ZW50
X2VuYWJsZWQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBpbnQgZXZlbnQpCit7CisJcmV0dXJuIHRl
c3RfYml0KGV2ZW50LCBWQ1BVSSh2Y3B1KS0+ZXZfbWFzayk7Cit9CisKIC8qIGt2bWlfbXNnLmMg
Ki8KIGJvb2wga3ZtaV9zb2NrX2dldChzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWksIGlu
dCBmZCk7CiB2b2lkIGt2bWlfc29ja19zaHV0ZG93bihzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24g
Kmt2bWkpOwpAQCAtNTksNiArNjUsNyBAQCB2b2lkIGt2bWlfc29ja19wdXQoc3RydWN0IGt2bV9p
bnRyb3NwZWN0aW9uICprdm1pKTsKIGJvb2wga3ZtaV9tc2dfcHJvY2VzcyhzdHJ1Y3Qga3ZtX2lu
dHJvc3BlY3Rpb24gKmt2bWkpOwogaW50IGt2bWlfbXNnX3NlbmRfdW5ob29rKHN0cnVjdCBrdm1f
aW50cm9zcGVjdGlvbiAqa3ZtaSk7CiB1MzIga3ZtaV9tc2dfc2VuZF92Y3B1X3BhdXNlKHN0cnVj
dCBrdm1fdmNwdSAqdmNwdSk7Cit1MzIga3ZtaV9tc2dfc2VuZF9oeXBlcmNhbGwoc3RydWN0IGt2
bV92Y3B1ICp2Y3B1KTsKIAogLyoga3ZtaS5jICovCiB2b2lkICprdm1pX21zZ19hbGxvYyh2b2lk
KTsKQEAgLTY5LDYgKzc2LDggQEAgaW50IGt2bWlfYWRkX2pvYihzdHJ1Y3Qga3ZtX3ZjcHUgKnZj
cHUsCiAJCSB2b2lkICpjdHgsIHZvaWQgKCpmcmVlX2ZjdCkodm9pZCAqY3R4KSk7CiB2b2lkIGt2
bWlfcnVuX2pvYnMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIHZvaWQga3ZtaV9wb3N0X3JlcGx5
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7Cit2b2lkIGt2bWlfaGFuZGxlX2NvbW1vbl9ldmVudF9h
Y3Rpb25zKHN0cnVjdCBrdm0gKmt2bSwKKwkJCQkgICAgICB1MzIgYWN0aW9uLCBjb25zdCBjaGFy
ICpzdHIpOwogaW50IGt2bWlfY21kX3ZtX2NvbnRyb2xfZXZlbnRzKHN0cnVjdCBrdm1faW50cm9z
cGVjdGlvbiAqa3ZtaSwKIAkJCQl1bnNpZ25lZCBpbnQgZXZlbnRfaWQsIGJvb2wgZW5hYmxlKTsK
IGludCBrdm1pX2NtZF92Y3B1X2NvbnRyb2xfZXZlbnRzKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwK
QEAgLTk2LDUgKzEwNSw3IEBAIGludCBrdm1pX2FyY2hfY21kX3ZjcHVfZ2V0X3JlZ2lzdGVycyhz
dHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCiBpbnQga3ZtaV9hcmNoX2NtZF92Y3B1X2dldF9jcHVpZChz
dHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCiAJCQkJIGNvbnN0IHN0cnVjdCBrdm1pX3ZjcHVfZ2V0X2Nw
dWlkICpyZXEsCiAJCQkJIHN0cnVjdCBrdm1pX3ZjcHVfZ2V0X2NwdWlkX3JlcGx5ICpycGwpOwor
Ym9vbCBrdm1pX2FyY2hfaXNfYWdlbnRfaHlwZXJjYWxsKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7
Cit2b2lkIGt2bWlfYXJjaF9oeXBlcmNhbGxfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsK
IAogI2VuZGlmCmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMg
Yi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKaW5kZXggMTE4NzNjYjNjMjNiLi5i
Y2RmMTA0ZWFhNDMgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cu
YworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKQEAgLTg2OCwzICs4Njgs
MTUgQEAgdTMyIGt2bWlfbXNnX3NlbmRfdmNwdV9wYXVzZShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUp
CiAKIAlyZXR1cm4gYWN0aW9uOwogfQorCit1MzIga3ZtaV9tc2dfc2VuZF9oeXBlcmNhbGwoc3Ry
dWN0IGt2bV92Y3B1ICp2Y3B1KQoreworCWludCBlcnIsIGFjdGlvbjsKKworCWVyciA9IGt2bWlf
c2VuZF9ldmVudCh2Y3B1LCBLVk1JX0VWRU5UX0hZUEVSQ0FMTCwgTlVMTCwgMCwKKwkJCSAgICAg
IE5VTEwsIDAsICZhY3Rpb24pOworCWlmIChlcnIpCisJCXJldHVybiBLVk1JX0VWRU5UX0FDVElP
Tl9DT05USU5VRTsKKworCXJldHVybiBhY3Rpb247Cit9Cl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0
dWFsaXphdGlvbkBsaXN0cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4
Zm91bmRhdGlvbi5vcmcvbWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
