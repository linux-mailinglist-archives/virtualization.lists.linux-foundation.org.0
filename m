Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id BBF0B2E19A0
	for <lists.virtualization@lfdr.de>; Wed, 23 Dec 2020 09:08:53 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 370FF85D45;
	Wed, 23 Dec 2020 08:08:52 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id pRev0uGcKo5j; Wed, 23 Dec 2020 08:08:48 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id EE60A85D44;
	Wed, 23 Dec 2020 08:08:47 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id C3F95C0893;
	Wed, 23 Dec 2020 08:08:47 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id D83F7C0893
 for <virtualization@lists.linux-foundation.org>;
 Wed, 23 Dec 2020 08:08:45 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by silver.osuosl.org (Postfix) with ESMTP id 9378920344
 for <virtualization@lists.linux-foundation.org>;
 Wed, 23 Dec 2020 08:08:45 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id u5uI6SxeSL2Y
 for <virtualization@lists.linux-foundation.org>;
 Wed, 23 Dec 2020 08:08:40 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [216.205.24.124])
 by silver.osuosl.org (Postfix) with ESMTPS id BE14120334
 for <virtualization@lists.linux-foundation.org>;
 Wed, 23 Dec 2020 08:08:39 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1608710918;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=wUF409s0Z09LuYxcinNf3kQJcw3v3/i6P20S+VZzJLk=;
 b=MTC+aJzy3bSSCkPEdajN/w6rVh5cBfkI6Rb/IsTw8v/H5aBtVKlziBDrzcnV9b41hHcMf2
 EdTLgtNtx0Hi9sVTN+KtsJhZauGoVR+ADVQoMqVcHUCHTte7Q54ZiehHE5msqwmsuQ94fz
 6XxiBqhAEb/M/h6JPX9gtSj5oV9CZeU=
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-299-shy3aBkTOkKXw6Sk8zMHQQ-1; Wed, 23 Dec 2020 03:08:34 -0500
X-MC-Unique: shy3aBkTOkKXw6Sk8zMHQQ-1
Received: from smtp.corp.redhat.com (int-mx08.intmail.prod.int.phx2.redhat.com
 [10.5.11.23])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id 076561800D42;
 Wed, 23 Dec 2020 08:08:32 +0000 (UTC)
Received: from [10.72.12.54] (ovpn-12-54.pek2.redhat.com [10.72.12.54])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 10C6F19725;
 Wed, 23 Dec 2020 08:08:18 +0000 (UTC)
Subject: Re: [RFC v2 06/13] vduse: Introduce VDUSE - vDPA Device in Userspace
To: Xie Yongji <xieyongji@bytedance.com>, mst@redhat.com,
 stefanha@redhat.com, sgarzare@redhat.com, parav@nvidia.com,
 akpm@linux-foundation.org, rdunlap@infradead.org, willy@infradead.org,
 viro@zeniv.linux.org.uk, axboe@kernel.dk, bcrl@kvack.org, corbet@lwn.net
References: <20201222145221.711-1-xieyongji@bytedance.com>
 <20201222145221.711-7-xieyongji@bytedance.com>
From: Jason Wang <jasowang@redhat.com>
Message-ID: <468be90d-1d98-c819-5492-32a2152d2e36@redhat.com>
Date: Wed, 23 Dec 2020 16:08:17 +0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.10.0
MIME-Version: 1.0
In-Reply-To: <20201222145221.711-7-xieyongji@bytedance.com>
Content-Language: en-US
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.23
Cc: linux-aio@kvack.org, kvm@vger.kernel.org, netdev@vger.kernel.org,
 virtualization@lists.linux-foundation.org, linux-mm@kvack.org,
 linux-fsdevel@vger.kernel.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

Ck9uIDIwMjAvMTIvMjIg5LiL5Y2IMTA6NTIsIFhpZSBZb25namkgd3JvdGU6Cj4gVGhpcyBWRFVT
RSBkcml2ZXIgZW5hYmxlcyBpbXBsZW1lbnRpbmcgdkRQQSBkZXZpY2VzIGluIHVzZXJzcGFjZS4K
PiBCb3RoIGNvbnRyb2wgcGF0aCBhbmQgZGF0YSBwYXRoIG9mIHZEUEEgZGV2aWNlcyB3aWxsIGJl
IGFibGUgdG8KPiBiZSBoYW5kbGVkIGluIHVzZXJzcGFjZS4KPgo+IEluIHRoZSBjb250cm9sIHBh
dGgsIHRoZSBWRFVTRSBkcml2ZXIgd2lsbCBtYWtlIHVzZSBvZiBtZXNzYWdlCj4gbWVjaG5pc20g
dG8gZm9yd2FyZCB0aGUgY29uZmlnIG9wZXJhdGlvbiBmcm9tIHZkcGEgYnVzIGRyaXZlcgo+IHRv
IHVzZXJzcGFjZS4gVXNlcnNwYWNlIGNhbiB1c2UgcmVhZCgpL3dyaXRlKCkgdG8gcmVjZWl2ZS9y
ZXBseQo+IHRob3NlIGNvbnRyb2wgbWVzc2FnZXMuCj4KPiBJbiB0aGUgZGF0YSBwYXRoLCB0aGUg
VkRVU0UgZHJpdmVyIGltcGxlbWVudHMgYSBNTVUtYmFzZWQgb24tY2hpcAo+IElPTU1VIGRyaXZl
ciB3aGljaCBzdXBwb3J0cyBtYXBwaW5nIHRoZSBrZXJuZWwgZG1hIGJ1ZmZlciB0byBhCj4gdXNl
cnNwYWNlIGlvdmEgcmVnaW9uIGR5bmFtaWNhbGx5LiBVc2Vyc3BhY2UgY2FuIGFjY2VzcyB0aG9z
ZQo+IGlvdmEgcmVnaW9uIHZpYSBtbWFwKCkuIEJlc2lkZXMsIHRoZSBldmVudGZkIG1lY2hhbmlz
bSBpcyB1c2VkIHRvCj4gdHJpZ2dlciBpbnRlcnJ1cHQgY2FsbGJhY2tzIGFuZCByZWNlaXZlIHZp
cnRxdWV1ZSBraWNrcyBpbiB1c2Vyc3BhY2UKPgo+IE5vdyB3ZSBvbmx5IHN1cHBvcnQgdmlydGlv
LXZkcGEgYnVzIGRyaXZlciB3aXRoIHRoaXMgcGF0Y2ggYXBwbGllZC4KPgo+IFNpZ25lZC1vZmYt
Ynk6IFhpZSBZb25namkgPHhpZXlvbmdqaUBieXRlZGFuY2UuY29tPgo+IC0tLQo+ICAgRG9jdW1l
bnRhdGlvbi9kcml2ZXItYXBpL3ZkdXNlLnJzdCAgICAgICAgICAgICAgICAgfCAgIDc0ICsrCj4g
ICBEb2N1bWVudGF0aW9uL3VzZXJzcGFjZS1hcGkvaW9jdGwvaW9jdGwtbnVtYmVyLnJzdCB8ICAg
IDEgKwo+ICAgZHJpdmVycy92ZHBhL0tjb25maWcgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgfCAgICA4ICsKPiAgIGRyaXZlcnMvdmRwYS9NYWtlZmlsZSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHwgICAgMSArCj4gICBkcml2ZXJzL3ZkcGEvdmRwYV91c2VyL01ha2VmaWxlICAg
ICAgICAgICAgICAgICAgICB8ICAgIDUgKwo+ICAgZHJpdmVycy92ZHBhL3ZkcGFfdXNlci9ldmVu
dGZkLmMgICAgICAgICAgICAgICAgICAgfCAgMjIxICsrKysKPiAgIGRyaXZlcnMvdmRwYS92ZHBh
X3VzZXIvZXZlbnRmZC5oICAgICAgICAgICAgICAgICAgIHwgICA0OCArCj4gICBkcml2ZXJzL3Zk
cGEvdmRwYV91c2VyL2lvdmFfZG9tYWluLmMgICAgICAgICAgICAgICB8ICA0NDIgKysrKysrKysK
PiAgIGRyaXZlcnMvdmRwYS92ZHBhX3VzZXIvaW92YV9kb21haW4uaCAgICAgICAgICAgICAgIHwg
ICA5MyArKwo+ICAgZHJpdmVycy92ZHBhL3ZkcGFfdXNlci92ZHVzZS5oICAgICAgICAgICAgICAg
ICAgICAgfCAgIDU5ICsrCj4gICBkcml2ZXJzL3ZkcGEvdmRwYV91c2VyL3ZkdXNlX2Rldi5jICAg
ICAgICAgICAgICAgICB8IDExMjEgKysrKysrKysrKysrKysrKysrKysKPiAgIGluY2x1ZGUvdWFw
aS9saW51eC92ZHBhLmggICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgMSArCj4gICBpbmNs
dWRlL3VhcGkvbGludXgvdmR1c2UuaCAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgOTkgKysK
PiAgIDEzIGZpbGVzIGNoYW5nZWQsIDIxNzMgaW5zZXJ0aW9ucygrKQo+ICAgY3JlYXRlIG1vZGUg
MTAwNjQ0IERvY3VtZW50YXRpb24vZHJpdmVyLWFwaS92ZHVzZS5yc3QKPiAgIGNyZWF0ZSBtb2Rl
IDEwMDY0NCBkcml2ZXJzL3ZkcGEvdmRwYV91c2VyL01ha2VmaWxlCj4gICBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy92ZHBhL3ZkcGFfdXNlci9ldmVudGZkLmMKPiAgIGNyZWF0ZSBtb2RlIDEw
MDY0NCBkcml2ZXJzL3ZkcGEvdmRwYV91c2VyL2V2ZW50ZmQuaAo+ICAgY3JlYXRlIG1vZGUgMTAw
NjQ0IGRyaXZlcnMvdmRwYS92ZHBhX3VzZXIvaW92YV9kb21haW4uYwo+ICAgY3JlYXRlIG1vZGUg
MTAwNjQ0IGRyaXZlcnMvdmRwYS92ZHBhX3VzZXIvaW92YV9kb21haW4uaAo+ICAgY3JlYXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvdmRwYS92ZHBhX3VzZXIvdmR1c2UuaAo+ICAgY3JlYXRlIG1vZGUg
MTAwNjQ0IGRyaXZlcnMvdmRwYS92ZHBhX3VzZXIvdmR1c2VfZGV2LmMKPiAgIGNyZWF0ZSBtb2Rl
IDEwMDY0NCBpbmNsdWRlL3VhcGkvbGludXgvdmR1c2UuaAo+Cj4gZGlmZiAtLWdpdCBhL0RvY3Vt
ZW50YXRpb24vZHJpdmVyLWFwaS92ZHVzZS5yc3QgYi9Eb2N1bWVudGF0aW9uL2RyaXZlci1hcGkv
dmR1c2UucnN0Cj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMDAwMDAuLmRh
OWIzMDQwZjIwYQo+IC0tLSAvZGV2L251bGwKPiArKysgYi9Eb2N1bWVudGF0aW9uL2RyaXZlci1h
cGkvdmR1c2UucnN0Cj4gQEAgLTAsMCArMSw3NCBAQAo+ICs9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09Cj4gK1ZEVVNFIC0gInZEUEEgRGV2aWNlIGluIFVzZXJzcGFjZSIKPiArPT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQo+ICsKPiArdkRQQSAodmlydGlvIGRhdGEg
cGF0aCBhY2NlbGVyYXRpb24pIGRldmljZSBpcyBhIGRldmljZSB0aGF0IHVzZXMgYQo+ICtkYXRh
cGF0aCB3aGljaCBjb21wbGllcyB3aXRoIHRoZSB2aXJ0aW8gc3BlY2lmaWNhdGlvbnMgd2l0aCB2
ZW5kb3IKPiArc3BlY2lmaWMgY29udHJvbCBwYXRoLiB2RFBBIGRldmljZXMgY2FuIGJlIGJvdGgg
cGh5c2ljYWxseSBsb2NhdGVkIG9uCj4gK3RoZSBoYXJkd2FyZSBvciBlbXVsYXRlZCBieSBzb2Z0
d2FyZS4gVkRVU0UgaXMgYSBmcmFtZXdvcmsgdGhhdCBtYWtlcyBpdAo+ICtwb3NzaWJsZSB0byBp
bXBsZW1lbnQgc29mdHdhcmUtZW11bGF0ZWQgdkRQQSBkZXZpY2VzIGluIHVzZXJzcGFjZS4KPiAr
Cj4gK0hvdyBWRFVTRSB3b3Jrcwo+ICstLS0tLS0tLS0tLS0KPiArRWFjaCB1c2Vyc3BhY2UgdkRQ
QSBkZXZpY2UgaXMgY3JlYXRlZCBieSB0aGUgVkRVU0VfQ1JFQVRFX0RFViBpb2N0bCBvbgo+ICt0
aGUgVkRVU0UgY2hhcmFjdGVyIGRldmljZSAoL2Rldi92ZHVzZSkuIFRoZW4gYSBmaWxlIGRlc2Ny
aXB0b3IgcG9pbnRpbmcKPiArdG8gdGhlIG5ldyByZXNvdXJjZXMgd2lsbCBiZSByZXR1cm5lZCwg
d2hpY2ggY2FuIGJlIHVzZWQgdG8gaW1wbGVtZW50IHRoZQo+ICt1c2Vyc3BhY2UgdkRQQSBkZXZp
Y2UncyBjb250cm9sIHBhdGggYW5kIGRhdGEgcGF0aC4KPiArCj4gK1RvIGltcGxlbWVudCBjb250
cm9sIHBhdGgsIHRoZSByZWFkL3dyaXRlIG9wZXJhdGlvbnMgdG8gdGhlIGZpbGUgZGVzY3JpcHRv
cgo+ICt3aWxsIGJlIHVzZWQgdG8gcmVjZWl2ZS9yZXBseSB0aGUgY29udHJvbCBtZXNzYWdlcyBm
cm9tL3RvIFZEVVNFIGRyaXZlci4KPiArVGhvc2UgY29udHJvbCBtZXNzYWdlcyBhcmUgYmFzZWQg
b24gdGhlIHZkcGFfY29uZmlnX29wcyB3aGljaCBkZWZpbmVzIGEKPiArdW5pZmllZCBpbnRlcmZh
Y2UgdG8gY29udHJvbCBkaWZmZXJlbnQgdHlwZXMgb2YgdkRQQSBkZXZpY2UuCj4gKwo+ICtUaGUg
Zm9sbG93aW5nIHR5cGVzIG9mIG1lc3NhZ2VzIGFyZSBwcm92aWRlZCBieSB0aGUgVkRVU0UgZnJh
bWV3b3JrIG5vdzoKPiArCj4gKy0gVkRVU0VfU0VUX1ZRX0FERFI6IFNldCB0aGUgYWRkcmVzc2Vz
IG9mIHRoZSBkaWZmZXJlbnQgYXNwZWN0cyBvZiB2aXJ0cXVldWUuCj4gKwo+ICstIFZEVVNFX1NF
VF9WUV9OVU06IFNldCB0aGUgc2l6ZSBvZiB2aXJ0cXVldWUKPiArCj4gKy0gVkRVU0VfU0VUX1ZR
X1JFQURZOiBTZXQgcmVhZHkgc3RhdHVzIG9mIHZpcnRxdWV1ZQo+ICsKPiArLSBWRFVTRV9HRVRf
VlFfUkVBRFk6IEdldCByZWFkeSBzdGF0dXMgb2YgdmlydHF1ZXVlCj4gKwo+ICstIFZEVVNFX1NF
VF9GRUFUVVJFUzogU2V0IHZpcnRpbyBmZWF0dXJlcyBzdXBwb3J0ZWQgYnkgdGhlIGRyaXZlcgo+
ICsKPiArLSBWRFVTRV9HRVRfRkVBVFVSRVM6IEdldCB2aXJ0aW8gZmVhdHVyZXMgc3VwcG9ydGVk
IGJ5IHRoZSBkZXZpY2UKPiArCj4gKy0gVkRVU0VfU0VUX1NUQVRVUzogU2V0IHRoZSBkZXZpY2Ug
c3RhdHVzCj4gKwo+ICstIFZEVVNFX0dFVF9TVEFUVVM6IEdldCB0aGUgZGV2aWNlIHN0YXR1cwo+
ICsKPiArLSBWRFVTRV9TRVRfQ09ORklHOiBXcml0ZSB0byBkZXZpY2Ugc3BlY2lmaWMgY29uZmln
dXJhdGlvbiBzcGFjZQo+ICsKPiArLSBWRFVTRV9HRVRfQ09ORklHOiBSZWFkIGZyb20gZGV2aWNl
IHNwZWNpZmljIGNvbmZpZ3VyYXRpb24gc3BhY2UKPiArCj4gK1BsZWFzZSBzZWUgaW5jbHVkZS9s
aW51eC92ZHBhLmggZm9yIGRldGFpbHMuCj4gKwo+ICtJbiB0aGUgZGF0YSBwYXRoLCBWRFVTRSBm
cmFtZXdvcmsgaW1wbGVtZW50cyBhIE1NVS1iYXNlZCBvbi1jaGlwIElPTU1VCj4gK2RyaXZlciB3
aGljaCBzdXBwb3J0cyBtYXBwaW5nIHRoZSBrZXJuZWwgZG1hIGJ1ZmZlciB0byBhIHVzZXJzcGFj
ZSBpb3ZhCj4gK3JlZ2lvbiBkeW5hbWljYWxseS4gVGhlIHVzZXJzcGFjZSBpb3ZhIHJlZ2lvbiBj
YW4gYmUgY3JlYXRlZCBieSBwYXNzaW5nCj4gK3RoZSB1c2Vyc3BhY2UgdkRQQSBkZXZpY2UgZmQg
dG8gbW1hcCgyKS4KPiArCj4gK0Jlc2lkZXMsIHRoZSBldmVudGZkIG1lY2hhbmlzbSBpcyB1c2Vk
IHRvIHRyaWdnZXIgaW50ZXJydXB0IGNhbGxiYWNrcyBhbmQKPiArcmVjZWl2ZSB2aXJ0cXVldWUg
a2lja3MgaW4gdXNlcnNwYWNlLiBUaGUgZm9sbG93aW5nIGlvY3RscyBvbiB0aGUgdXNlcnNwYWNl
Cj4gK3ZEUEEgZGV2aWNlIGZkIGFyZSBwcm92aWRlZCB0byBzdXBwb3J0IHRoYXQ6Cj4gKwo+ICst
IFZEVVNFX1ZRX1NFVFVQX0tJQ0tGRDogc2V0IHRoZSBraWNrZmQgZm9yIHZpcnRxdWV1ZSwgdGhp
cyBldmVudGZkIGlzIHVzZWQKPiArICBieSBWRFVTRSBkcml2ZXIgdG8gbm90aWZ5IHVzZXJzcGFj
ZSB0byBjb25zdW1lIHRoZSB2cmluZy4KPiArCj4gKy0gVkRVU0VfVlFfU0VUVVBfSVJRRkQ6IHNl
dCB0aGUgaXJxZmQgZm9yIHZpcnRxdWV1ZSwgdGhpcyBldmVudGZkIGlzIHVzZWQKPiArICBieSB1
c2Vyc3BhY2UgdG8gbm90aWZ5IFZEVVNFIGRyaXZlciB0byB0cmlnZ2VyIGludGVycnVwdCBjYWxs
YmFja3MuCj4gKwo+ICtNTVUtYmFzZWQgSU9NTVUgRHJpdmVyCj4gKy0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0KPiArVGhlIGJhc2ljIGlkZWEgYmVoaW5kIHRoZSBJT01NVSBkcml2ZXIgaXMgdHJlYXRp
bmcgTU1VIChWQS0+UEEpIGFzCj4gK0lPTU1VIChJT1ZBLT5QQSkuIFRoaXMgZHJpdmVyIHdpbGwg
c2V0IHVwIE1NVSBtYXBwaW5nIGluc3RlYWQgb2YgSU9NTVUgbWFwcGluZwo+ICtmb3IgdGhlIERN
QSB0cmFuc2ZlciBzbyB0aGF0IHRoZSB1c2Vyc3BhY2UgcHJvY2VzcyBpcyBhYmxlIHRvIHVzZSBp
dHMgdmlydHVhbAo+ICthZGRyZXNzIHRvIGFjY2VzcyB0aGUgZG1hIGJ1ZmZlciBpbiBrZXJuZWwu
Cj4gKwo+ICtBbmQgdG8gYXZvaWQgc2VjdXJpdHkgaXNzdWUsIGEgYm91bmNlLWJ1ZmZlcmluZyBt
ZWNoYW5pc20gaXMgaW50cm9kdWNlZCB0bwo+ICtwcmV2ZW50IHVzZXJzcGFjZSBhY2Nlc3Npbmcg
dGhlIG9yaWdpbmFsIGJ1ZmZlciBkaXJlY3RseSB3aGljaCBtYXkgY29udGFpbiBvdGhlcgo+ICtr
ZXJuZWwgZGF0YS4gRHVyaW5nIHRoZSBtYXBwaW5nLCB1bm1hcHBpbmcsIHRoZSBkcml2ZXIgd2ls
bCBjb3B5IHRoZSBkYXRhIGZyb20KPiArdGhlIG9yaWdpbmFsIGJ1ZmZlciB0byB0aGUgYm91bmNl
IGJ1ZmZlciBhbmQgYmFjaywgZGVwZW5kaW5nIG9uIHRoZSBkaXJlY3Rpb24gb2YKPiArdGhlIHRy
YW5zZmVyLiBBbmQgdGhlIGJvdW5jZS1idWZmZXIgYWRkcmVzc2VzIHdpbGwgYmUgbWFwcGVkIGlu
dG8gdGhlIHVzZXIgYWRkcmVzcwo+ICtzcGFjZSBpbnN0ZWFkIG9mIHRoZSBvcmlnaW5hbCBvbmUu
Cj4gZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRpb24vdXNlcnNwYWNlLWFwaS9pb2N0bC9pb2N0bC1u
dW1iZXIucnN0IGIvRG9jdW1lbnRhdGlvbi91c2Vyc3BhY2UtYXBpL2lvY3RsL2lvY3RsLW51bWJl
ci5yc3QKPiBpbmRleCBhNGM3NWEyOGM4MzkuLjcxNzIyZTZmOGYyMyAxMDA2NDQKPiAtLS0gYS9E
b2N1bWVudGF0aW9uL3VzZXJzcGFjZS1hcGkvaW9jdGwvaW9jdGwtbnVtYmVyLnJzdAo+ICsrKyBi
L0RvY3VtZW50YXRpb24vdXNlcnNwYWNlLWFwaS9pb2N0bC9pb2N0bC1udW1iZXIucnN0Cj4gQEAg
LTMwMCw2ICszMDAsNyBAQCBDb2RlICBTZXEjICAgIEluY2x1ZGUgRmlsZSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb21tZW50cwo+ICAgJ3onICAgMTAtNEYgIGRy
aXZlcnMvczM5MC9jcnlwdG8vemNyeXB0X2FwaS5oICAgICAgICAgICAgICAgICAgICAgICAgY29u
ZmxpY3QhCj4gICAnfCcgICAwMC03RiAgbGludXgvbWVkaWEuaAo+ICAgMHg4MCAgMDAtMUYgIGxp
bnV4L2ZiLmgKPiArMHg4MSAgMDAtMUYgIGxpbnV4L3ZkdXNlLmgKPiAgIDB4ODkgIDAwLTA2ICBh
cmNoL3g4Ni9pbmNsdWRlL2FzbS9zb2NraW9zLmgKPiAgIDB4ODkgIDBCLURGICBsaW51eC9zb2Nr
aW9zLmgKPiAgIDB4ODkgIEUwLUVGICBsaW51eC9zb2NraW9zLmggICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFNJT0NQUk9UT1BSSVZBVEUgcmFuZ2UKPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy92ZHBhL0tjb25maWcgYi9kcml2ZXJzL3ZkcGEvS2NvbmZpZwo+IGluZGV4IDRi
ZTdiZTM5YmUyNi4uMjExY2M0NDljYmQzIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvdmRwYS9LY29u
ZmlnCj4gKysrIGIvZHJpdmVycy92ZHBhL0tjb25maWcKPiBAQCAtMjEsNiArMjEsMTQgQEAgY29u
ZmlnIFZEUEFfU0lNCj4gICAJICB0byBSWC4gVGhpcyBkZXZpY2UgaXMgdXNlZCBmb3IgdGVzdGlu
ZywgcHJvdG90eXBpbmcgYW5kCj4gICAJICBkZXZlbG9wbWVudCBvZiB2RFBBLgo+ICAgCj4gK2Nv
bmZpZyBWRFBBX1VTRVIKPiArCXRyaXN0YXRlICJWRFVTRSAodkRQQSBEZXZpY2UgaW4gVXNlcnNw
YWNlKSBzdXBwb3J0Igo+ICsJZGVwZW5kcyBvbiBFVkVOVEZEICYmIE1NVSAmJiBIQVNfRE1BCj4g
KwlkZWZhdWx0IG4KCgpUaGUgImRlZmF1bHQgbiIgaXMgbm90IG5lY2Vzc2FyeS4KCgo+ICsJaGVs
cAo+ICsJICBXaXRoIFZEVVNFIGl0IGlzIHBvc3NpYmxlIHRvIGVtdWxhdGUgYSB2RFBBIERldmlj
ZQo+ICsJICBpbiBhIHVzZXJzcGFjZSBwcm9ncmFtLgo+ICsKPiAgIGNvbmZpZyBJRkNWRgo+ICAg
CXRyaXN0YXRlICJJbnRlbCBJRkMgVkYgdkRQQSBkcml2ZXIiCj4gICAJZGVwZW5kcyBvbiBQQ0lf
TVNJCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdmRwYS9NYWtlZmlsZSBiL2RyaXZlcnMvdmRwYS9N
YWtlZmlsZQo+IGluZGV4IGQxNjBlOWI2M2E2Ni4uNjZlOTc3NzhhZDAzIDEwMDY0NAo+IC0tLSBh
L2RyaXZlcnMvdmRwYS9NYWtlZmlsZQo+ICsrKyBiL2RyaXZlcnMvdmRwYS9NYWtlZmlsZQo+IEBA
IC0xLDUgKzEsNiBAQAo+ICAgIyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAo+ICAg
b2JqLSQoQ09ORklHX1ZEUEEpICs9IHZkcGEubwo+ICAgb2JqLSQoQ09ORklHX1ZEUEFfU0lNKSAr
PSB2ZHBhX3NpbS8KPiArb2JqLSQoQ09ORklHX1ZEUEFfVVNFUikgKz0gdmRwYV91c2VyLwo+ICAg
b2JqLSQoQ09ORklHX0lGQ1ZGKSAgICArPSBpZmN2Zi8KPiAgIG9iai0kKENPTkZJR19NTFg1X1ZE
UEEpICs9IG1seDUvCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdmRwYS92ZHBhX3VzZXIvTWFrZWZp
bGUgYi9kcml2ZXJzL3ZkcGEvdmRwYV91c2VyL01ha2VmaWxlCj4gbmV3IGZpbGUgbW9kZSAxMDA2
NDQKPiBpbmRleCAwMDAwMDAwMDAwMDAuLmI3NjQ1ZTM2OTkyYgo+IC0tLSAvZGV2L251bGwKPiAr
KysgYi9kcml2ZXJzL3ZkcGEvdmRwYV91c2VyL01ha2VmaWxlCj4gQEAgLTAsMCArMSw1IEBACj4g
KyMgU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKPiArCj4gK3ZkdXNlLXkgOj0gdmR1
c2VfZGV2Lm8gaW92YV9kb21haW4ubyBldmVudGZkLm8KCgpEbyB3ZSByZWFsbHkgbmVlZCBldmVu
dGZkLm8gaGVyZSBjb25zaWRlciB3ZSd2ZSBzZWxlY3RlZCBpdC4KCgo+ICsKPiArb2JqLSQoQ09O
RklHX1ZEUEFfVVNFUikgKz0gdmR1c2Uubwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3ZkcGEvdmRw
YV91c2VyL2V2ZW50ZmQuYyBiL2RyaXZlcnMvdmRwYS92ZHBhX3VzZXIvZXZlbnRmZC5jCj4gbmV3
IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMDAwMDAuLmRiZmZkZGIwODkwOAo+IC0t
LSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL3ZkcGEvdmRwYV91c2VyL2V2ZW50ZmQuYwo+IEBA
IC0wLDAgKzEsMjIxIEBACj4gKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9u
bHkKPiArLyoKPiArICogRXZlbnRmZCBzdXBwb3J0IGZvciBWRFVTRQo+ICsgKgo+ICsgKiBDb3B5
cmlnaHQgKEMpIDIwMjAgQnl0ZWRhbmNlIEluYy4gYW5kL29yIGl0cyBhZmZpbGlhdGVzLiBBbGwg
cmlnaHRzIHJlc2VydmVkLgo+ICsgKgo+ICsgKiBBdXRob3I6IFhpZSBZb25namkgPHhpZXlvbmdq
aUBieXRlZGFuY2UuY29tPgo+ICsgKgo+ICsgKi8KPiArCj4gKyNpbmNsdWRlIDxsaW51eC9ldmVu
dGZkLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9wb2xsLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC93YWl0
Lmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9zbGFiLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9maWxlLmg+
Cj4gKyNpbmNsdWRlIDx1YXBpL2xpbnV4L3ZkdXNlLmg+Cj4gKwo+ICsjaW5jbHVkZSAiZXZlbnRm
ZC5oIgo+ICsKPiArc3RhdGljIHN0cnVjdCB3b3JrcXVldWVfc3RydWN0ICp2ZHVzZV9pcnFmZF9j
bGVhbnVwX3dxOwo+ICsKPiArc3RhdGljIHZvaWQgdmR1c2VfdmlycWZkX3NodXRkb3duKHN0cnVj
dCB3b3JrX3N0cnVjdCAqd29yaykKPiArewo+ICsJdTY0IGNudDsKPiArCXN0cnVjdCB2ZHVzZV92
aXJxZmQgKnZpcnFmZCA9IGNvbnRhaW5lcl9vZih3b3JrLAo+ICsJCQkJCXN0cnVjdCB2ZHVzZV92
aXJxZmQsIHNodXRkb3duKTsKPiArCj4gKwlldmVudGZkX2N0eF9yZW1vdmVfd2FpdF9xdWV1ZSh2
aXJxZmQtPmN0eCwgJnZpcnFmZC0+d2FpdCwgJmNudCk7Cj4gKwlmbHVzaF93b3JrKCZ2aXJxZmQt
PmluamVjdCk7Cj4gKwlldmVudGZkX2N0eF9wdXQodmlycWZkLT5jdHgpOwo+ICsJa2ZyZWUodmly
cWZkKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmR1c2VfdmlycWZkX2luamVjdChzdHJ1Y3Qg
d29ya19zdHJ1Y3QgKndvcmspCj4gK3sKPiArCXN0cnVjdCB2ZHVzZV92aXJxZmQgKnZpcnFmZCA9
IGNvbnRhaW5lcl9vZih3b3JrLAo+ICsJCQkJCXN0cnVjdCB2ZHVzZV92aXJxZmQsIGluamVjdCk7
Cj4gKwlzdHJ1Y3QgdmR1c2VfdmlydHF1ZXVlICp2cSA9IHZpcnFmZC0+dnE7Cj4gKwo+ICsJc3Bp
bl9sb2NrX2lycSgmdnEtPmlycV9sb2NrKTsKPiArCWlmICh2cS0+cmVhZHkgJiYgdnEtPmNiKQo+
ICsJCXZxLT5jYih2cS0+cHJpdmF0ZSk7Cj4gKwlzcGluX3VubG9ja19pcnEoJnZxLT5pcnFfbG9j
ayk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHZpcnFmZF9kZWFjdGl2YXRlKHN0cnVjdCB2ZHVz
ZV92aXJxZmQgKnZpcnFmZCkKPiArewo+ICsJcXVldWVfd29yayh2ZHVzZV9pcnFmZF9jbGVhbnVw
X3dxLCAmdmlycWZkLT5zaHV0ZG93bik7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgdmR1c2Vfdmly
cWZkX3dha2V1cCh3YWl0X3F1ZXVlX2VudHJ5X3QgKndhaXQsIHVuc2lnbmVkIGludCBtb2RlLAo+
ICsJCQkJaW50IHN5bmMsIHZvaWQgKmtleSkKPiArewo+ICsJc3RydWN0IHZkdXNlX3ZpcnFmZCAq
dmlycWZkID0gY29udGFpbmVyX29mKHdhaXQsIHN0cnVjdCB2ZHVzZV92aXJxZmQsIHdhaXQpOwo+
ICsJc3RydWN0IHZkdXNlX3ZpcnRxdWV1ZSAqdnEgPSB2aXJxZmQtPnZxOwo+ICsKPiArCV9fcG9s
bF90IGZsYWdzID0ga2V5X3RvX3BvbGwoa2V5KTsKPiArCj4gKwlpZiAoZmxhZ3MgJiBFUE9MTElO
KQo+ICsJCXNjaGVkdWxlX3dvcmsoJnZpcnFmZC0+aW5qZWN0KTsKPiArCj4gKwlpZiAoZmxhZ3Mg
JiBFUE9MTEhVUCkgewo+ICsJCXNwaW5fbG9jaygmdnEtPmlycV9sb2NrKTsKPiArCQlpZiAodnEt
PnZpcnFmZCA9PSB2aXJxZmQpIHsKPiArCQkJdnEtPnZpcnFmZCA9IE5VTEw7Cj4gKwkJCXZpcnFm
ZF9kZWFjdGl2YXRlKHZpcnFmZCk7Cj4gKwkJfQo+ICsJCXNwaW5fdW5sb2NrKCZ2cS0+aXJxX2xv
Y2spOwo+ICsJfQo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCB2ZHVz
ZV92aXJxZmRfcHRhYmxlX3F1ZXVlX3Byb2Moc3RydWN0IGZpbGUgKmZpbGUsCj4gKwkJCXdhaXRf
cXVldWVfaGVhZF90ICp3cWgsIHBvbGxfdGFibGUgKnB0KQo+ICt7Cj4gKwlzdHJ1Y3QgdmR1c2Vf
dmlycWZkICp2aXJxZmQgPSBjb250YWluZXJfb2YocHQsIHN0cnVjdCB2ZHVzZV92aXJxZmQsIHB0
KTsKPiArCj4gKwlhZGRfd2FpdF9xdWV1ZSh3cWgsICZ2aXJxZmQtPndhaXQpOwo+ICt9Cj4gKwo+
ICtpbnQgdmR1c2VfdmlycWZkX3NldHVwKHN0cnVjdCB2ZHVzZV9kZXYgKmRldiwKPiArCQkJc3Ry
dWN0IHZkdXNlX3ZxX2V2ZW50ZmQgKmV2ZW50ZmQpCj4gK3sKPiArCXN0cnVjdCB2ZHVzZV92aXJx
ZmQgKnZpcnFmZDsKPiArCXN0cnVjdCBmZCBpcnFmZDsKPiArCXN0cnVjdCBldmVudGZkX2N0eCAq
Y3R4Owo+ICsJc3RydWN0IHZkdXNlX3ZpcnRxdWV1ZSAqdnE7Cj4gKwlfX3BvbGxfdCBldmVudHM7
Cj4gKwlpbnQgcmV0Owo+ICsKPiArCWlmIChldmVudGZkLT5pbmRleCA+PSBkZXYtPnZxX251bSkK
PiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCj4gKwl2cSA9ICZkZXYtPnZxc1tldmVudGZkLT5pbmRl
eF07Cj4gKwl2aXJxZmQgPSBremFsbG9jKHNpemVvZigqdmlycWZkKSwgR0ZQX0tFUk5FTCk7Cj4g
KwlpZiAoIXZpcnFmZCkKPiArCQlyZXR1cm4gLUVOT01FTTsKPiArCj4gKwlJTklUX1dPUksoJnZp
cnFmZC0+c2h1dGRvd24sIHZkdXNlX3ZpcnFmZF9zaHV0ZG93bik7Cj4gKwlJTklUX1dPUksoJnZp
cnFmZC0+aW5qZWN0LCB2ZHVzZV92aXJxZmRfaW5qZWN0KTsKCgpBbnkgcmVhc29uIHRoYXQgYSB3
b3JrcXVldWUgaXMgbXVzdCBoZXJlPwoKCj4gKwo+ICsJcmV0ID0gLUVCQURGOwo+ICsJaXJxZmQg
PSBmZGdldChldmVudGZkLT5mZCk7Cj4gKwlpZiAoIWlycWZkLmZpbGUpCj4gKwkJZ290byBlcnJf
ZmQ7Cj4gKwo+ICsJY3R4ID0gZXZlbnRmZF9jdHhfZmlsZWdldChpcnFmZC5maWxlKTsKPiArCWlm
IChJU19FUlIoY3R4KSkgewo+ICsJCXJldCA9IFBUUl9FUlIoY3R4KTsKPiArCQlnb3RvIGVycl9j
dHg7Cj4gKwl9Cj4gKwo+ICsJdmlycWZkLT52cSA9IHZxOwo+ICsJdmlycWZkLT5jdHggPSBjdHg7
Cj4gKwlzcGluX2xvY2soJnZxLT5pcnFfbG9jayk7Cj4gKwlpZiAodnEtPnZpcnFmZCkKPiArCQl2
aXJxZmRfZGVhY3RpdmF0ZSh2aXJxZmQpOwo+ICsJdnEtPnZpcnFmZCA9IHZpcnFmZDsKPiArCXNw
aW5fdW5sb2NrKCZ2cS0+aXJxX2xvY2spOwo+ICsKPiArCWluaXRfd2FpdHF1ZXVlX2Z1bmNfZW50
cnkoJnZpcnFmZC0+d2FpdCwgdmR1c2VfdmlycWZkX3dha2V1cCk7Cj4gKwlpbml0X3BvbGxfZnVu
Y3B0cigmdmlycWZkLT5wdCwgdmR1c2VfdmlycWZkX3B0YWJsZV9xdWV1ZV9wcm9jKTsKPiArCj4g
KwlldmVudHMgPSB2ZnNfcG9sbChpcnFmZC5maWxlLCAmdmlycWZkLT5wdCk7Cj4gKwo+ICsJLyoK
PiArCSAqIENoZWNrIGlmIHRoZXJlIHdhcyBhbiBldmVudCBhbHJlYWR5IHBlbmRpbmcgb24gdGhl
IGV2ZW50ZmQKPiArCSAqIGJlZm9yZSB3ZSByZWdpc3RlcmVkIGFuZCB0cmlnZ2VyIGl0IGFzIGlm
IHdlIGRpZG4ndCBtaXNzIGl0Lgo+ICsJICovCj4gKwlpZiAoZXZlbnRzICYgRVBPTExJTikKPiAr
CQlzY2hlZHVsZV93b3JrKCZ2aXJxZmQtPmluamVjdCk7Cj4gKwo+ICsJZmRwdXQoaXJxZmQpOwo+
ICsKPiArCXJldHVybiAwOwo+ICtlcnJfY3R4Ogo+ICsJZmRwdXQoaXJxZmQpOwo+ICtlcnJfZmQ6
Cj4gKwlrZnJlZSh2aXJxZmQpOwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiArdm9pZCB2ZHVz
ZV92aXJxZmRfcmVsZWFzZShzdHJ1Y3QgdmR1c2VfZGV2ICpkZXYpCj4gK3sKPiArCWludCBpOwo+
ICsKPiArCWZvciAoaSA9IDA7IGkgPCBkZXYtPnZxX251bTsgaSsrKSB7Cj4gKwkJc3RydWN0IHZk
dXNlX3ZpcnRxdWV1ZSAqdnEgPSAmZGV2LT52cXNbaV07Cj4gKwo+ICsJCXNwaW5fbG9jaygmdnEt
PmlycV9sb2NrKTsKPiArCQlpZiAodnEtPnZpcnFmZCkgewo+ICsJCQl2aXJxZmRfZGVhY3RpdmF0
ZSh2cS0+dmlycWZkKTsKPiArCQkJdnEtPnZpcnFmZCA9IE5VTEw7Cj4gKwkJfQo+ICsJCXNwaW5f
dW5sb2NrKCZ2cS0+aXJxX2xvY2spOwo+ICsJfQo+ICsJZmx1c2hfd29ya3F1ZXVlKHZkdXNlX2ly
cWZkX2NsZWFudXBfd3EpOwo+ICt9Cj4gKwo+ICtpbnQgdmR1c2VfdmlycWZkX2luaXQodm9pZCkK
PiArewo+ICsJdmR1c2VfaXJxZmRfY2xlYW51cF93cSA9IGFsbG9jX3dvcmtxdWV1ZSgidmR1c2Ut
aXJxZmQtY2xlYW51cCIsCj4gKwkJCQkJCVdRX1VOQk9VTkQsIDApOwo+ICsJaWYgKCF2ZHVzZV9p
cnFmZF9jbGVhbnVwX3dxKQo+ICsJCXJldHVybiAtRU5PTUVNOwo+ICsKPiArCXJldHVybiAwOwo+
ICt9Cj4gKwo+ICt2b2lkIHZkdXNlX3ZpcnFmZF9leGl0KHZvaWQpCj4gK3sKPiArCWRlc3Ryb3lf
d29ya3F1ZXVlKHZkdXNlX2lycWZkX2NsZWFudXBfd3EpOwo+ICt9Cj4gKwo+ICt2b2lkIHZkdXNl
X3ZxX2tpY2soc3RydWN0IHZkdXNlX3ZpcnRxdWV1ZSAqdnEpCj4gK3sKPiArCXNwaW5fbG9jaygm
dnEtPmtpY2tfbG9jayk7Cj4gKwlpZiAodnEtPnJlYWR5ICYmIHZxLT5raWNrZmQpCj4gKwkJZXZl
bnRmZF9zaWduYWwodnEtPmtpY2tmZCwgMSk7Cj4gKwlzcGluX3VubG9jaygmdnEtPmtpY2tfbG9j
ayk7Cj4gK30KPiArCj4gK2ludCB2ZHVzZV9raWNrZmRfc2V0dXAoc3RydWN0IHZkdXNlX2RldiAq
ZGV2LAo+ICsJCQlzdHJ1Y3QgdmR1c2VfdnFfZXZlbnRmZCAqZXZlbnRmZCkKPiArewo+ICsJc3Ry
dWN0IGV2ZW50ZmRfY3R4ICpjdHg7Cj4gKwlzdHJ1Y3QgdmR1c2VfdmlydHF1ZXVlICp2cTsKPiAr
Cj4gKwlpZiAoZXZlbnRmZC0+aW5kZXggPj0gZGV2LT52cV9udW0pCj4gKwkJcmV0dXJuIC1FSU5W
QUw7Cj4gKwo+ICsJdnEgPSAmZGV2LT52cXNbZXZlbnRmZC0+aW5kZXhdOwo+ICsJY3R4ID0gZXZl
bnRmZF9jdHhfZmRnZXQoZXZlbnRmZC0+ZmQpOwo+ICsJaWYgKElTX0VSUihjdHgpKQo+ICsJCXJl
dHVybiBQVFJfRVJSKGN0eCk7Cj4gKwo+ICsJc3Bpbl9sb2NrKCZ2cS0+a2lja19sb2NrKTsKPiAr
CWlmICh2cS0+a2lja2ZkKQo+ICsJCWV2ZW50ZmRfY3R4X3B1dCh2cS0+a2lja2ZkKTsKPiArCXZx
LT5raWNrZmQgPSBjdHg7Cj4gKwlzcGluX3VubG9jaygmdnEtPmtpY2tfbG9jayk7Cj4gKwo+ICsJ
cmV0dXJuIDA7Cj4gK30KPiArCj4gK3ZvaWQgdmR1c2Vfa2lja2ZkX3JlbGVhc2Uoc3RydWN0IHZk
dXNlX2RldiAqZGV2KQo+ICt7Cj4gKwlpbnQgaTsKPiArCj4gKwlmb3IgKGkgPSAwOyBpIDwgZGV2
LT52cV9udW07IGkrKykgewo+ICsJCXN0cnVjdCB2ZHVzZV92aXJ0cXVldWUgKnZxID0gJmRldi0+
dnFzW2ldOwo+ICsKPiArCQlzcGluX2xvY2soJnZxLT5raWNrX2xvY2spOwo+ICsJCWlmICh2cS0+
a2lja2ZkKSB7Cj4gKwkJCWV2ZW50ZmRfY3R4X3B1dCh2cS0+a2lja2ZkKTsKPiArCQkJdnEtPmtp
Y2tmZCA9IE5VTEw7Cj4gKwkJfQo+ICsJCXNwaW5fdW5sb2NrKCZ2cS0+a2lja19sb2NrKTsKPiAr
CX0KPiArfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3ZkcGEvdmRwYV91c2VyL2V2ZW50ZmQuaCBi
L2RyaXZlcnMvdmRwYS92ZHBhX3VzZXIvZXZlbnRmZC5oCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQK
PiBpbmRleCAwMDAwMDAwMDAwMDAuLjE0MjY5ZmYyN2Y0Nwo+IC0tLSAvZGV2L251bGwKPiArKysg
Yi9kcml2ZXJzL3ZkcGEvdmRwYV91c2VyL2V2ZW50ZmQuaAo+IEBAIC0wLDAgKzEsNDggQEAKPiAr
LyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seSAqLwo+ICsvKgo+ICsgKiBF
dmVudGZkIHN1cHBvcnQgZm9yIFZEVVNFCj4gKyAqCj4gKyAqIENvcHlyaWdodCAoQykgMjAyMCBC
eXRlZGFuY2UgSW5jLiBhbmQvb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCByaWdodHMgcmVzZXJ2ZWQu
Cj4gKyAqCj4gKyAqIEF1dGhvcjogWGllIFlvbmdqaSA8eGlleW9uZ2ppQGJ5dGVkYW5jZS5jb20+
Cj4gKyAqCj4gKyAqLwo+ICsKPiArI2lmbmRlZiBfVkRVU0VfRVZFTlRGRF9ICj4gKyNkZWZpbmUg
X1ZEVVNFX0VWRU5URkRfSAo+ICsKPiArI2luY2x1ZGUgPGxpbnV4L2V2ZW50ZmQuaD4KPiArI2lu
Y2x1ZGUgPGxpbnV4L3BvbGwuaD4KPiArI2luY2x1ZGUgPGxpbnV4L3dhaXQuaD4KPiArI2luY2x1
ZGUgPHVhcGkvbGludXgvdmR1c2UuaD4KPiArCj4gKyNpbmNsdWRlICJ2ZHVzZS5oIgo+ICsKPiAr
c3RydWN0IHZkdXNlX2RldjsKPiArCj4gK3N0cnVjdCB2ZHVzZV92aXJxZmQgewo+ICsJc3RydWN0
IGV2ZW50ZmRfY3R4ICpjdHg7Cj4gKwlzdHJ1Y3QgdmR1c2VfdmlydHF1ZXVlICp2cTsKPiArCXN0
cnVjdCB3b3JrX3N0cnVjdCBpbmplY3Q7Cj4gKwlzdHJ1Y3Qgd29ya19zdHJ1Y3Qgc2h1dGRvd247
Cj4gKwl3YWl0X3F1ZXVlX2VudHJ5X3Qgd2FpdDsKPiArCXBvbGxfdGFibGUgcHQ7Cj4gK307Cj4g
Kwo+ICtpbnQgdmR1c2VfdmlycWZkX3NldHVwKHN0cnVjdCB2ZHVzZV9kZXYgKmRldiwKPiArCQkJ
c3RydWN0IHZkdXNlX3ZxX2V2ZW50ZmQgKmV2ZW50ZmQpOwo+ICsKPiArdm9pZCB2ZHVzZV92aXJx
ZmRfcmVsZWFzZShzdHJ1Y3QgdmR1c2VfZGV2ICpkZXYpOwo+ICsKPiAraW50IHZkdXNlX3ZpcnFm
ZF9pbml0KHZvaWQpOwo+ICsKPiArdm9pZCB2ZHVzZV92aXJxZmRfZXhpdCh2b2lkKTsKPiArCj4g
K3ZvaWQgdmR1c2VfdnFfa2ljayhzdHJ1Y3QgdmR1c2VfdmlydHF1ZXVlICp2cSk7Cj4gKwo+ICtp
bnQgdmR1c2Vfa2lja2ZkX3NldHVwKHN0cnVjdCB2ZHVzZV9kZXYgKmRldiwKPiArCQkJc3RydWN0
IHZkdXNlX3ZxX2V2ZW50ZmQgKmV2ZW50ZmQpOwo+ICsKPiArdm9pZCB2ZHVzZV9raWNrZmRfcmVs
ZWFzZShzdHJ1Y3QgdmR1c2VfZGV2ICpkZXYpOwo+ICsKPiArI2VuZGlmIC8qIF9WRFVTRV9FVkVO
VEZEX0ggKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy92ZHBhL3ZkcGFfdXNlci9pb3ZhX2RvbWFp
bi5jIGIvZHJpdmVycy92ZHBhL3ZkcGFfdXNlci9pb3ZhX2RvbWFpbi5jCj4gbmV3IGZpbGUgbW9k
ZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMDAwMDAuLjI3MDIyMTU3YWJjNgo+IC0tLSAvZGV2L251
bGwKPiArKysgYi9kcml2ZXJzL3ZkcGEvdmRwYV91c2VyL2lvdmFfZG9tYWluLmMKPiBAQCAtMCww
ICsxLDQ0MiBAQAo+ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5Cj4g
Ky8qCj4gKyAqIE1NVS1iYXNlZCBJT01NVSBpbXBsZW1lbnRhdGlvbgo+ICsgKgo+ICsgKiBDb3B5
cmlnaHQgKEMpIDIwMjAgQnl0ZWRhbmNlIEluYy4gYW5kL29yIGl0cyBhZmZpbGlhdGVzLiBBbGwg
cmlnaHRzIHJlc2VydmVkLgo+ICsgKgo+ICsgKiBBdXRob3I6IFhpZSBZb25namkgPHhpZXlvbmdq
aUBieXRlZGFuY2UuY29tPgo+ICsgKgo+ICsgKi8KPiArCj4gKyNpbmNsdWRlIDxsaW51eC93YWl0
Lmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9zbGFiLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9nZW5hbGxv
Yy5oPgo+ICsjaW5jbHVkZSA8bGludXgvZG1hLW1hcHBpbmcuaD4KPiArCj4gKyNpbmNsdWRlICJp
b3ZhX2RvbWFpbi5oIgo+ICsKPiArI2RlZmluZSBJT1ZBX0NIVU5LX1NISUZUIDI2Cj4gKyNkZWZp
bmUgSU9WQV9DSFVOS19TSVpFIChfQUMoMSwgVUwpIDw8IElPVkFfQ0hVTktfU0hJRlQpCj4gKyNk
ZWZpbmUgSU9WQV9DSFVOS19NQVNLICh+KElPVkFfQ0hVTktfU0laRSAtIDEpKQo+ICsKPiArI2Rl
ZmluZSBJT1ZBX01JTl9TSVpFIChJT1ZBX0NIVU5LX1NJWkUgPDwgMSkKPiArCj4gKyNkZWZpbmUg
SU9WQV9BTExPQ19PUkRFUiAxMgo+ICsjZGVmaW5lIElPVkFfQUxMT0NfU0laRSAoMSA8PCBJT1ZB
X0FMTE9DX09SREVSKQo+ICsKPiArc3RydWN0IHZkdXNlX21tYXBfdm1hIHsKPiArCXN0cnVjdCB2
bV9hcmVhX3N0cnVjdCAqdm1hOwo+ICsJc3RydWN0IGxpc3RfaGVhZCBsaXN0Owo+ICt9Owo+ICsK
PiArc3RhdGljIGlubGluZSBzdHJ1Y3QgcGFnZSAqCj4gK3ZkdXNlX2RvbWFpbl9nZXRfYm91bmNl
X3BhZ2Uoc3RydWN0IHZkdXNlX2lvdmFfZG9tYWluICpkb21haW4sCj4gKwkJCQl1bnNpZ25lZCBs
b25nIGlvdmEpCj4gK3sKPiArCXVuc2lnbmVkIGxvbmcgaW5kZXggPSBpb3ZhID4+IElPVkFfQ0hV
TktfU0hJRlQ7Cj4gKwl1bnNpZ25lZCBsb25nIGNodW5rb2ZmID0gaW92YSAmIH5JT1ZBX0NIVU5L
X01BU0s7Cj4gKwl1bnNpZ25lZCBsb25nIHBnaW5kZXggPSBjaHVua29mZiA+PiBQQUdFX1NISUZU
Owo+ICsKPiArCXJldHVybiBkb21haW4tPmNodW5rc1tpbmRleF0uYm91bmNlX3BhZ2VzW3BnaW5k
ZXhdOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW5saW5lIHZvaWQKPiArdmR1c2VfZG9tYWluX3NldF9i
b3VuY2VfcGFnZShzdHJ1Y3QgdmR1c2VfaW92YV9kb21haW4gKmRvbWFpbiwKPiArCQkJCXVuc2ln
bmVkIGxvbmcgaW92YSwgc3RydWN0IHBhZ2UgKnBhZ2UpCj4gK3sKPiArCXVuc2lnbmVkIGxvbmcg
aW5kZXggPSBpb3ZhID4+IElPVkFfQ0hVTktfU0hJRlQ7Cj4gKwl1bnNpZ25lZCBsb25nIGNodW5r
b2ZmID0gaW92YSAmIH5JT1ZBX0NIVU5LX01BU0s7Cj4gKwl1bnNpZ25lZCBsb25nIHBnaW5kZXgg
PSBjaHVua29mZiA+PiBQQUdFX1NISUZUOwo+ICsKPiArCWRvbWFpbi0+Y2h1bmtzW2luZGV4XS5i
b3VuY2VfcGFnZXNbcGdpbmRleF0gPSBwYWdlOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW5saW5lIHN0
cnVjdCB2ZHVzZV9pb3ZhX21hcCAqCj4gK3ZkdXNlX2RvbWFpbl9nZXRfaW92YV9tYXAoc3RydWN0
IHZkdXNlX2lvdmFfZG9tYWluICpkb21haW4sCj4gKwkJCQl1bnNpZ25lZCBsb25nIGlvdmEpCj4g
K3sKPiArCXVuc2lnbmVkIGxvbmcgaW5kZXggPSBpb3ZhID4+IElPVkFfQ0hVTktfU0hJRlQ7Cj4g
Kwl1bnNpZ25lZCBsb25nIGNodW5rb2ZmID0gaW92YSAmIH5JT1ZBX0NIVU5LX01BU0s7Cj4gKwl1
bnNpZ25lZCBsb25nIG1hcGluZGV4ID0gY2h1bmtvZmYgPj4gSU9WQV9BTExPQ19PUkRFUjsKPiAr
Cj4gKwlyZXR1cm4gZG9tYWluLT5jaHVua3NbaW5kZXhdLmlvdmFfbWFwW21hcGluZGV4XTsKPiAr
fQo+ICsKPiArc3RhdGljIGlubGluZSB2b2lkCj4gK3ZkdXNlX2RvbWFpbl9zZXRfaW92YV9tYXAo
c3RydWN0IHZkdXNlX2lvdmFfZG9tYWluICpkb21haW4sCj4gKwkJCXVuc2lnbmVkIGxvbmcgaW92
YSwgc3RydWN0IHZkdXNlX2lvdmFfbWFwICptYXApCj4gK3sKPiArCXVuc2lnbmVkIGxvbmcgaW5k
ZXggPSBpb3ZhID4+IElPVkFfQ0hVTktfU0hJRlQ7Cj4gKwl1bnNpZ25lZCBsb25nIGNodW5rb2Zm
ID0gaW92YSAmIH5JT1ZBX0NIVU5LX01BU0s7Cj4gKwl1bnNpZ25lZCBsb25nIG1hcGluZGV4ID0g
Y2h1bmtvZmYgPj4gSU9WQV9BTExPQ19PUkRFUjsKPiArCj4gKwlkb21haW4tPmNodW5rc1tpbmRl
eF0uaW92YV9tYXBbbWFwaW5kZXhdID0gbWFwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50Cj4gK3Zk
dXNlX2RvbWFpbl9mcmVlX2JvdW5jZV9wYWdlcyhzdHJ1Y3QgdmR1c2VfaW92YV9kb21haW4gKmRv
bWFpbiwKPiArCQkJCXVuc2lnbmVkIGxvbmcgaW92YSwgc2l6ZV90IHNpemUpCj4gK3sKPiArCXN0
cnVjdCBwYWdlICpwYWdlOwo+ICsJc2l6ZV90IHdhbGtfc3ogPSAwOwo+ICsJaW50IGZyZWVzID0g
MDsKPiArCj4gKwl3aGlsZSAod2Fsa19zeiA8IHNpemUpIHsKPiArCQlwYWdlID0gdmR1c2VfZG9t
YWluX2dldF9ib3VuY2VfcGFnZShkb21haW4sIGlvdmEpOwo+ICsJCWlmIChwYWdlKSB7Cj4gKwkJ
CXZkdXNlX2RvbWFpbl9zZXRfYm91bmNlX3BhZ2UoZG9tYWluLCBpb3ZhLCBOVUxMKTsKPiArCQkJ
cHV0X3BhZ2UocGFnZSk7Cj4gKwkJCWZyZWVzKys7Cj4gKwkJfQo+ICsJCWlvdmEgKz0gUEFHRV9T
SVpFOwo+ICsJCXdhbGtfc3ogKz0gUEFHRV9TSVpFOwo+ICsJfQo+ICsKPiArCXJldHVybiBmcmVl
czsKPiArfQo+ICsKPiAraW50IHZkdXNlX2RvbWFpbl9hZGRfdm1hKHN0cnVjdCB2ZHVzZV9pb3Zh
X2RvbWFpbiAqZG9tYWluLAo+ICsJCQkJc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpCj4gK3sK
PiArCXVuc2lnbmVkIGxvbmcgc2l6ZSA9IHZtYS0+dm1fZW5kIC0gdm1hLT52bV9zdGFydDsKPiAr
CXN0cnVjdCB2ZHVzZV9tbWFwX3ZtYSAqbW1hcF92bWE7Cj4gKwo+ICsJaWYgKFdBUk5fT04oc2l6
ZSAhPSBkb21haW4tPnNpemUpKQo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsKPiArCW1tYXBfdm1h
ID0ga21hbGxvYyhzaXplb2YoKm1tYXBfdm1hKSwgR0ZQX0tFUk5FTCk7Cj4gKwlpZiAoIW1tYXBf
dm1hKQo+ICsJCXJldHVybiAtRU5PTUVNOwo+ICsKPiArCW1tYXBfdm1hLT52bWEgPSB2bWE7Cj4g
KwltdXRleF9sb2NrKCZkb21haW4tPnZtYV9sb2NrKTsKPiArCWxpc3RfYWRkKCZtbWFwX3ZtYS0+
bGlzdCwgJmRvbWFpbi0+dm1hX2xpc3QpOwo+ICsJbXV0ZXhfdW5sb2NrKCZkb21haW4tPnZtYV9s
b2NrKTsKPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArdm9pZCB2ZHVzZV9kb21haW5fcmVt
b3ZlX3ZtYShzdHJ1Y3QgdmR1c2VfaW92YV9kb21haW4gKmRvbWFpbiwKPiArCQkJCXN0cnVjdCB2
bV9hcmVhX3N0cnVjdCAqdm1hKQo+ICt7Cj4gKwlzdHJ1Y3QgdmR1c2VfbW1hcF92bWEgKm1tYXBf
dm1hOwo+ICsKPiArCW11dGV4X2xvY2soJmRvbWFpbi0+dm1hX2xvY2spOwo+ICsJbGlzdF9mb3Jf
ZWFjaF9lbnRyeShtbWFwX3ZtYSwgJmRvbWFpbi0+dm1hX2xpc3QsIGxpc3QpIHsKPiArCQlpZiAo
bW1hcF92bWEtPnZtYSA9PSB2bWEpIHsKPiArCQkJbGlzdF9kZWwoJm1tYXBfdm1hLT5saXN0KTsK
PiArCQkJa2ZyZWUobW1hcF92bWEpOwo+ICsJCQlicmVhazsKPiArCQl9Cj4gKwl9Cj4gKwltdXRl
eF91bmxvY2soJmRvbWFpbi0+dm1hX2xvY2spOwo+ICt9Cj4gKwo+ICtpbnQgdmR1c2VfZG9tYWlu
X2FkZF9tYXBwaW5nKHN0cnVjdCB2ZHVzZV9pb3ZhX2RvbWFpbiAqZG9tYWluLAo+ICsJCQkJdW5z
aWduZWQgbG9uZyBpb3ZhLCB1bnNpZ25lZCBsb25nIG9yaWcsCj4gKwkJCQlzaXplX3Qgc2l6ZSwg
ZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGlyKQo+ICt7Cj4gKwlzdHJ1Y3QgdmR1c2VfaW92YV9t
YXAgKm1hcDsKPiArCXVuc2lnbmVkIGxvbmcgbGFzdCA9IGlvdmEgKyBzaXplOwo+ICsKPiArCW1h
cCA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCB2ZHVzZV9pb3ZhX21hcCksIEdGUF9BVE9NSUMpOwo+
ICsJaWYgKCFtYXApCj4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsJbWFwLT5pb3ZhID0gaW92
YTsKPiArCW1hcC0+b3JpZyA9IG9yaWc7Cj4gKwltYXAtPnNpemUgPSBzaXplOwo+ICsJbWFwLT5k
aXIgPSBkaXI7Cj4gKwo+ICsJd2hpbGUgKGlvdmEgPCBsYXN0KSB7Cj4gKwkJdmR1c2VfZG9tYWlu
X3NldF9pb3ZhX21hcChkb21haW4sIGlvdmEsIG1hcCk7Cj4gKwkJaW92YSArPSBJT1ZBX0FMTE9D
X1NJWkU7Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0cnVjdCB2ZHVzZV9p
b3ZhX21hcCAqCj4gK3ZkdXNlX2RvbWFpbl9nZXRfbWFwcGluZyhzdHJ1Y3QgdmR1c2VfaW92YV9k
b21haW4gKmRvbWFpbiwKPiArCQkJdW5zaWduZWQgbG9uZyBpb3ZhKQo+ICt7Cj4gKwlyZXR1cm4g
dmR1c2VfZG9tYWluX2dldF9pb3ZhX21hcChkb21haW4sIGlvdmEpOwo+ICt9Cj4gKwo+ICt2b2lk
IHZkdXNlX2RvbWFpbl9yZW1vdmVfbWFwcGluZyhzdHJ1Y3QgdmR1c2VfaW92YV9kb21haW4gKmRv
bWFpbiwKPiArCQkJCXN0cnVjdCB2ZHVzZV9pb3ZhX21hcCAqbWFwKQo+ICt7Cj4gKwl1bnNpZ25l
ZCBsb25nIGlvdmEgPSBtYXAtPmlvdmE7Cj4gKwl1bnNpZ25lZCBsb25nIGxhc3QgPSBpb3ZhICsg
bWFwLT5zaXplOwo+ICsKPiArCXdoaWxlIChpb3ZhIDwgbGFzdCkgewo+ICsJCXZkdXNlX2RvbWFp
bl9zZXRfaW92YV9tYXAoZG9tYWluLCBpb3ZhLCBOVUxMKTsKPiArCQlpb3ZhICs9IElPVkFfQUxM
T0NfU0laRTsKPiArCX0KPiArfQo+ICsKPiArdm9pZCB2ZHVzZV9kb21haW5fdW5tYXAoc3RydWN0
IHZkdXNlX2lvdmFfZG9tYWluICpkb21haW4sCj4gKwkJCXVuc2lnbmVkIGxvbmcgaW92YSwgc2l6
ZV90IHNpemUpCj4gK3sKPiArCXN0cnVjdCB2ZHVzZV9tbWFwX3ZtYSAqbW1hcF92bWE7Cj4gKwl1
bnNpZ25lZCBsb25nIHVhZGRyOwo+ICsKPiArCW11dGV4X2xvY2soJmRvbWFpbi0+dm1hX2xvY2sp
Owo+ICsJbGlzdF9mb3JfZWFjaF9lbnRyeShtbWFwX3ZtYSwgJmRvbWFpbi0+dm1hX2xpc3QsIGxp
c3QpIHsKPiArCQltbWFwX3JlYWRfbG9jayhtbWFwX3ZtYS0+dm1hLT52bV9tbSk7Cj4gKwkJdWFk
ZHIgPSBpb3ZhICsgbW1hcF92bWEtPnZtYS0+dm1fc3RhcnQ7Cj4gKwkJemFwX3BhZ2VfcmFuZ2Uo
bW1hcF92bWEtPnZtYSwgdWFkZHIsIHNpemUpOwo+ICsJCW1tYXBfcmVhZF91bmxvY2sobW1hcF92
bWEtPnZtYS0+dm1fbW0pOwo+ICsJfQo+ICsJbXV0ZXhfdW5sb2NrKCZkb21haW4tPnZtYV9sb2Nr
KTsKPiArfQo+ICsKPiAraW50IHZkdXNlX2RvbWFpbl9kaXJlY3RfbWFwKHN0cnVjdCB2ZHVzZV9p
b3ZhX2RvbWFpbiAqZG9tYWluLAo+ICsJCQlzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwgdW5z
aWduZWQgbG9uZyBpb3ZhKQo+ICt7Cj4gKwl1bnNpZ25lZCBsb25nIHVhZGRyID0gaW92YSArIHZt
YS0+dm1fc3RhcnQ7Cj4gKwl1bnNpZ25lZCBsb25nIHN0YXJ0ID0gaW92YSAmIFBBR0VfTUFTSzsK
PiArCXVuc2lnbmVkIGxvbmcgbGFzdCA9IHN0YXJ0ICsgUEFHRV9TSVpFIC0gMTsKPiArCXVuc2ln
bmVkIGxvbmcgb2Zmc2V0Owo+ICsJc3RydWN0IHZkdXNlX2lvdmFfbWFwICptYXA7Cj4gKwlzdHJ1
Y3QgcGFnZSAqcGFnZSA9IE5VTEw7Cj4gKwo+ICsJbWFwID0gdmR1c2VfZG9tYWluX2dldF9pb3Zh
X21hcChkb21haW4sIGlvdmEpOwo+ICsJaWYgKG1hcCkgewo+ICsJCW9mZnNldCA9IGxhc3QgLSBt
YXAtPmlvdmE7Cj4gKwkJcGFnZSA9IHZpcnRfdG9fcGFnZShtYXAtPm9yaWcgKyBvZmZzZXQpOwo+
ICsJfQo+ICsKPiArCXJldHVybiBwYWdlID8gdm1faW5zZXJ0X3BhZ2Uodm1hLCB1YWRkciwgcGFn
ZSkgOiAtRUZBVUxUOwo+ICt9CgoKU28gYXMgd2UgZGlzY3Vzc2VkIGJlZm9yZSwgd2UgbmVlZCB0
byBmaW5kIHdheSB0byBtYWtlIHZob3N0IHdvcmsuIEFuZCAKaXQncyBiZXR0ZXIgdG8gbWFrZSB2
aG9zdCB0cmFuc3BhcmVudCB0byBWRFVTRS4gT25lIGlkZWEgaXMgdG8gaW1wbGVtZW50IApzaGFk
b3cgdmlydHF1ZXVlIGhlcmUsIHRoYXQgaXMsIGluc3RlYWQgb2YgdHJ5aW5nIHRvIGluc2VydCB0
aGUgcGFnZXMgdG8gClZEVVNFIHVzZXJzcGFjZSwgd2UgdXNlIHRoZSBzaGFkb3cgdmlydHF1ZXVl
IHRvIHJlbGF5IHRoZSBkZXNjcmlwdG9ycyB0byAKdXNlcnNwYWNlLiBXaXRoIHRoaXMsIHdlIGRv
bid0IG5lZWQgc3R1ZmZzIGxpa2Ugc2htZmQgZXRjLgoKCj4gKwo+ICt2b2lkIHZkdXNlX2RvbWFp
bl9ib3VuY2Uoc3RydWN0IHZkdXNlX2lvdmFfZG9tYWluICpkb21haW4sCj4gKwkJCXVuc2lnbmVk
IGxvbmcgaW92YSwgdW5zaWduZWQgbG9uZyBvcmlnLAo+ICsJCQlzaXplX3Qgc2l6ZSwgZW51bSBk
bWFfZGF0YV9kaXJlY3Rpb24gZGlyKQo+ICt7Cj4gKwl1bnNpZ25lZCBpbnQgb2Zmc2V0ID0gb2Zm
c2V0X2luX3BhZ2UoaW92YSk7Cj4gKwo+ICsJd2hpbGUgKHNpemUpIHsKPiArCQlzdHJ1Y3QgcGFn
ZSAqcCA9IHZkdXNlX2RvbWFpbl9nZXRfYm91bmNlX3BhZ2UoZG9tYWluLCBpb3ZhKTsKPiArCQlz
aXplX3QgY29weV9sZW4gPSBtaW5fdChzaXplX3QsIFBBR0VfU0laRSAtIG9mZnNldCwgc2l6ZSk7
Cj4gKwkJdm9pZCAqYWRkcjsKPiArCj4gKwkJaWYgKHApIHsKPiArCQkJYWRkciA9IHBhZ2VfYWRk
cmVzcyhwKSArIG9mZnNldDsKPiArCQkJaWYgKGRpciA9PSBETUFfVE9fREVWSUNFKQo+ICsJCQkJ
bWVtY3B5KGFkZHIsICh2b2lkICopb3JpZywgY29weV9sZW4pOwo+ICsJCQllbHNlIGlmIChkaXIg
PT0gRE1BX0ZST01fREVWSUNFKQo+ICsJCQkJbWVtY3B5KCh2b2lkICopb3JpZywgYWRkciwgY29w
eV9sZW4pOwo+ICsJCX0KCgpJIHRoaW5rIEkgbWlzcyBzb21ldGhpbmcsIGZvciBETUFfRlJPTV9E
RVZJQ0UsIGlmIHAgZG9lc24ndCBleGlzdCBob3cgaXMgCml0IGV4cGVjdGVkIHRvIHdvcms/IE9y
IGRvIHdlIG5lZWQgdG8gd2FybiBoZXJlIGluIHRoaXMgY2FzZT8KCgo+ICsJCXNpemUgLT0gY29w
eV9sZW47Cj4gKwkJb3JpZyArPSBjb3B5X2xlbjsKPiArCQlpb3ZhICs9IGNvcHlfbGVuOwo+ICsJ
CW9mZnNldCA9IDA7Cj4gKwl9Cj4gK30KPiArCj4gK2ludCB2ZHVzZV9kb21haW5fYm91bmNlX21h
cChzdHJ1Y3QgdmR1c2VfaW92YV9kb21haW4gKmRvbWFpbiwKPiArCQkJc3RydWN0IHZtX2FyZWFf
c3RydWN0ICp2bWEsIHVuc2lnbmVkIGxvbmcgaW92YSkKPiArewo+ICsJdW5zaWduZWQgbG9uZyB1
YWRkciA9IGlvdmEgKyB2bWEtPnZtX3N0YXJ0Owo+ICsJdW5zaWduZWQgbG9uZyBzdGFydCA9IGlv
dmEgJiBQQUdFX01BU0s7Cj4gKwl1bnNpZ25lZCBsb25nIG9mZnNldCA9IDA7Cj4gKwlib29sIGZv
dW5kID0gZmFsc2U7Cj4gKwlzdHJ1Y3QgdmR1c2VfaW92YV9tYXAgKm1hcDsKPiArCXN0cnVjdCBw
YWdlICpwYWdlOwo+ICsKPiArCW11dGV4X2xvY2soJmRvbWFpbi0+bWFwX2xvY2spOwo+ICsKPiAr
CXBhZ2UgPSB2ZHVzZV9kb21haW5fZ2V0X2JvdW5jZV9wYWdlKGRvbWFpbiwgaW92YSk7Cj4gKwlp
ZiAocGFnZSkKPiArCQlnb3RvIHVubG9jazsKPiArCj4gKwlwYWdlID0gYWxsb2NfcGFnZShHRlBf
S0VSTkVMKTsKPiArCWlmICghcGFnZSkKPiArCQlnb3RvIHVubG9jazsKPiArCj4gKwl3aGlsZSAo
b2Zmc2V0IDwgUEFHRV9TSVpFKSB7Cj4gKwkJdW5zaWduZWQgaW50IHNyY19vZmZzZXQgPSAwLCBk
c3Rfb2Zmc2V0ID0gMDsKPiArCQl2b2lkICpzcmMsICpkc3Q7Cj4gKwkJc2l6ZV90IGNvcHlfbGVu
Owo+ICsKPiArCQltYXAgPSB2ZHVzZV9kb21haW5fZ2V0X2lvdmFfbWFwKGRvbWFpbiwgc3RhcnQg
KyBvZmZzZXQpOwo+ICsJCWlmICghbWFwKSB7Cj4gKwkJCW9mZnNldCArPSBJT1ZBX0FMTE9DX1NJ
WkU7Cj4gKwkJCWNvbnRpbnVlOwo+ICsJCX0KPiArCj4gKwkJZm91bmQgPSB0cnVlOwo+ICsJCW9m
ZnNldCArPSBtYXAtPnNpemU7Cj4gKwkJaWYgKG1hcC0+ZGlyID09IERNQV9GUk9NX0RFVklDRSkK
PiArCQkJY29udGludWU7Cj4gKwo+ICsJCWlmIChzdGFydCA+IG1hcC0+aW92YSkKPiArCQkJc3Jj
X29mZnNldCA9IHN0YXJ0IC0gbWFwLT5pb3ZhOwo+ICsJCWVsc2UKPiArCQkJZHN0X29mZnNldCA9
IG1hcC0+aW92YSAtIHN0YXJ0Owo+ICsKPiArCQlzcmMgPSAodm9pZCAqKShtYXAtPm9yaWcgKyBz
cmNfb2Zmc2V0KTsKPiArCQlkc3QgPSBwYWdlX2FkZHJlc3MocGFnZSkgKyBkc3Rfb2Zmc2V0Owo+
ICsJCWNvcHlfbGVuID0gbWluX3Qoc2l6ZV90LCBtYXAtPnNpemUgLSBzcmNfb2Zmc2V0LAo+ICsJ
CQkJUEFHRV9TSVpFIC0gZHN0X29mZnNldCk7Cj4gKwkJbWVtY3B5KGRzdCwgc3JjLCBjb3B5X2xl
bik7Cj4gKwl9Cj4gKwlpZiAoIWZvdW5kKSB7Cj4gKwkJcHV0X3BhZ2UocGFnZSk7Cj4gKwkJcGFn
ZSA9IE5VTEw7Cj4gKwl9Cj4gKwl2ZHVzZV9kb21haW5fc2V0X2JvdW5jZV9wYWdlKGRvbWFpbiwg
aW92YSwgcGFnZSk7Cj4gK3VubG9jazoKPiArCW11dGV4X3VubG9jaygmZG9tYWluLT5tYXBfbG9j
ayk7Cj4gKwo+ICsJcmV0dXJuIHBhZ2UgPyB2bV9pbnNlcnRfcGFnZSh2bWEsIHVhZGRyLCBwYWdl
KSA6IC1FRkFVTFQ7Cj4gK30KPiArCj4gK2Jvb2wgdmR1c2VfZG9tYWluX2lzX2RpcmVjdF9tYXAo
c3RydWN0IHZkdXNlX2lvdmFfZG9tYWluICpkb21haW4sCj4gKwkJCQl1bnNpZ25lZCBsb25nIGlv
dmEpCj4gK3sKPiArCXVuc2lnbmVkIGxvbmcgaW5kZXggPSBpb3ZhID4+IElPVkFfQ0hVTktfU0hJ
RlQ7Cj4gKwlzdHJ1Y3QgdmR1c2VfaW92YV9jaHVuayAqY2h1bmsgPSAmZG9tYWluLT5jaHVua3Nb
aW5kZXhdOwo+ICsKPiArCXJldHVybiBhdG9taWNfcmVhZCgmY2h1bmstPm1hcF90eXBlKSA9PSBU
WVBFX0RJUkVDVF9NQVA7Cj4gK30KPiArCj4gK3Vuc2lnbmVkIGxvbmcgdmR1c2VfZG9tYWluX2Fs
bG9jX2lvdmEoc3RydWN0IHZkdXNlX2lvdmFfZG9tYWluICpkb21haW4sCj4gKwkJCQkJc2l6ZV90
IHNpemUsIGVudW0gaW92YV9tYXBfdHlwZSB0eXBlKQo+ICt7Cj4gKwlzdHJ1Y3QgdmR1c2VfaW92
YV9jaHVuayAqY2h1bms7Cj4gKwl1bnNpZ25lZCBsb25nIGlvdmEgPSAwOwo+ICsJaW50IGFsaWdu
ID0gKHR5cGUgPT0gVFlQRV9ESVJFQ1RfTUFQKSA/IFBBR0VfU0laRSA6IElPVkFfQUxMT0NfU0la
RTsKPiArCXN0cnVjdCBnZW5wb29sX2RhdGFfYWxpZ24gZGF0YSA9IHsgLmFsaWduID0gYWxpZ24g
fTsKPiArCWludCBpOwo+ICsKPiArCWZvciAoaSA9IDA7IGkgPCBkb21haW4tPmNodW5rX251bTsg
aSsrKSB7Cj4gKwkJY2h1bmsgPSAmZG9tYWluLT5jaHVua3NbaV07Cj4gKwkJaWYgKHVubGlrZWx5
KGF0b21pY19yZWFkKCZjaHVuay0+bWFwX3R5cGUpID09IFRZUEVfTk9ORSkpCj4gKwkJCWF0b21p
Y19jbXB4Y2hnKCZjaHVuay0+bWFwX3R5cGUsIFRZUEVfTk9ORSwgdHlwZSk7Cj4gKwo+ICsJCWlm
IChhdG9taWNfcmVhZCgmY2h1bmstPm1hcF90eXBlKSAhPSB0eXBlKQo+ICsJCQljb250aW51ZTsK
PiArCj4gKwkJaW92YSA9IGdlbl9wb29sX2FsbG9jX2FsZ28oY2h1bmstPnBvb2wsIHNpemUsCj4g
KwkJCQkJZ2VuX3Bvb2xfZmlyc3RfZml0X2FsaWduLCAmZGF0YSk7Cj4gKwkJaWYgKGlvdmEpCj4g
KwkJCWJyZWFrOwo+ICsJfQo+ICsKPiArCXJldHVybiBpb3ZhOwoKCkkgd29uZGVyIHdoeSBub3Qg
anVzdCByZXVzZSB0aGUgaW92YSBkb21haW4gaW1wbGVtZW50cyBpbiAKZHJpdmVyL2lvbW11L2lv
dmEuYwoKCj4gK30KPiArCj4gK3ZvaWQgdmR1c2VfZG9tYWluX2ZyZWVfaW92YShzdHJ1Y3QgdmR1
c2VfaW92YV9kb21haW4gKmRvbWFpbiwKPiArCQkJCXVuc2lnbmVkIGxvbmcgaW92YSwgc2l6ZV90
IHNpemUpCj4gK3sKPiArCXVuc2lnbmVkIGxvbmcgaW5kZXggPSBpb3ZhID4+IElPVkFfQ0hVTktf
U0hJRlQ7Cj4gKwlzdHJ1Y3QgdmR1c2VfaW92YV9jaHVuayAqY2h1bmsgPSAmZG9tYWluLT5jaHVu
a3NbaW5kZXhdOwo+ICsKPiArCWdlbl9wb29sX2ZyZWUoY2h1bmstPnBvb2wsIGlvdmEsIHNpemUp
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCB2ZHVzZV9pb3ZhX2NodW5rX2NsZWFudXAoc3RydWN0
IHZkdXNlX2lvdmFfY2h1bmsgKmNodW5rKQo+ICt7Cj4gKwl2ZnJlZShjaHVuay0+Ym91bmNlX3Bh
Z2VzKTsKPiArCXZmcmVlKGNodW5rLT5pb3ZhX21hcCk7Cj4gKwlnZW5fcG9vbF9kZXN0cm95KGNo
dW5rLT5wb29sKTsKPiArfQo+ICsKPiArdm9pZCB2ZHVzZV9pb3ZhX2RvbWFpbl9kZXN0cm95KHN0
cnVjdCB2ZHVzZV9pb3ZhX2RvbWFpbiAqZG9tYWluKQo+ICt7Cj4gKwlzdHJ1Y3QgdmR1c2VfaW92
YV9jaHVuayAqY2h1bms7Cj4gKwlpbnQgaTsKPiArCj4gKwlmb3IgKGkgPSAwOyBpIDwgZG9tYWlu
LT5jaHVua19udW07IGkrKykgewo+ICsJCWNodW5rID0gJmRvbWFpbi0+Y2h1bmtzW2ldOwo+ICsJ
CXZkdXNlX2RvbWFpbl9mcmVlX2JvdW5jZV9wYWdlcyhkb21haW4sCj4gKwkJCQkJY2h1bmstPnN0
YXJ0LCBJT1ZBX0NIVU5LX1NJWkUpOwo+ICsJCXZkdXNlX2lvdmFfY2h1bmtfY2xlYW51cChjaHVu
ayk7Cj4gKwl9Cj4gKwo+ICsJbXV0ZXhfZGVzdHJveSgmZG9tYWluLT5tYXBfbG9jayk7Cj4gKwlt
dXRleF9kZXN0cm95KCZkb21haW4tPnZtYV9sb2NrKTsKPiArCWtmcmVlKGRvbWFpbi0+Y2h1bmtz
KTsKPiArCWtmcmVlKGRvbWFpbik7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgdmR1c2VfaW92YV9j
aHVua19pbml0KHN0cnVjdCB2ZHVzZV9pb3ZhX2NodW5rICpjaHVuaywKPiArCQkJCXVuc2lnbmVk
IGxvbmcgYWRkciwgc2l6ZV90IHNpemUpCj4gK3sKPiArCWludCByZXQ7Cj4gKwlpbnQgcGFnZXMg
PSBzaXplID4+IFBBR0VfU0hJRlQ7Cj4gKwo+ICsJY2h1bmstPnBvb2wgPSBnZW5fcG9vbF9jcmVh
dGUoSU9WQV9BTExPQ19PUkRFUiwgLTEpOwo+ICsJaWYgKCFjaHVuay0+cG9vbCkKPiArCQlyZXR1
cm4gLUVOT01FTTsKPiArCj4gKwkvKiBhZGRyIDAgaXMgdXNlZCBpbiBhbGxvY2F0aW9uIGZhaWx1
cmUgY2FzZSAqLwo+ICsJaWYgKGFkZHIgPT0gMCkKPiArCQlhZGRyICs9IElPVkFfQUxMT0NfU0la
RTsKPiArCj4gKwlyZXQgPSBnZW5fcG9vbF9hZGQoY2h1bmstPnBvb2wsIGFkZHIsIHNpemUsIC0x
KTsKPiArCWlmIChyZXQpCj4gKwkJZ290byBlcnI7Cj4gKwo+ICsJcmV0ID0gLUVOT01FTTsKPiAr
CWNodW5rLT5ib3VuY2VfcGFnZXMgPSB2emFsbG9jKHBhZ2VzICogc2l6ZW9mKHN0cnVjdCBwYWdl
ICopKTsKPiArCWlmICghY2h1bmstPmJvdW5jZV9wYWdlcykKPiArCQlnb3RvIGVycjsKPiArCj4g
KwljaHVuay0+aW92YV9tYXAgPSB2emFsbG9jKChzaXplID4+IElPVkFfQUxMT0NfT1JERVIpICoK
PiArCQkJCXNpemVvZihzdHJ1Y3QgdmR1c2VfaW92YV9tYXAgKikpOwo+ICsJaWYgKCFjaHVuay0+
aW92YV9tYXApCj4gKwkJZ290byBlcnI7Cj4gKwo+ICsJY2h1bmstPnN0YXJ0ID0gYWRkcjsKPiAr
CWF0b21pY19zZXQoJmNodW5rLT5tYXBfdHlwZSwgVFlQRV9OT05FKTsKPiArCj4gKwlyZXR1cm4g
MDsKPiArZXJyOgo+ICsJaWYgKGNodW5rLT5ib3VuY2VfcGFnZXMpIHsKPiArCQl2ZnJlZShjaHVu
ay0+Ym91bmNlX3BhZ2VzKTsKPiArCQljaHVuay0+Ym91bmNlX3BhZ2VzID0gTlVMTDsKPiArCX0K
PiArCWdlbl9wb29sX2Rlc3Ryb3koY2h1bmstPnBvb2wpOwo+ICsJcmV0dXJuIHJldDsKPiArfQo+
ICsKPiArc3RydWN0IHZkdXNlX2lvdmFfZG9tYWluICp2ZHVzZV9pb3ZhX2RvbWFpbl9jcmVhdGUo
c2l6ZV90IHNpemUpCj4gK3sKPiArCWludCBqLCBpID0gMDsKPiArCXN0cnVjdCB2ZHVzZV9pb3Zh
X2RvbWFpbiAqZG9tYWluOwo+ICsJdW5zaWduZWQgbG9uZyBudW0gPSBzaXplID4+IElPVkFfQ0hV
TktfU0hJRlQ7Cj4gKwl1bnNpZ25lZCBsb25nIGFkZHIgPSAwOwo+ICsKPiArCWlmIChzaXplIDwg
SU9WQV9NSU5fU0laRSB8fCBzaXplICYgfklPVkFfQ0hVTktfTUFTSykKPiArCQlyZXR1cm4gTlVM
TDsKPiArCj4gKwlkb21haW4gPSBremFsbG9jKHNpemVvZigqZG9tYWluKSwgR0ZQX0tFUk5FTCk7
Cj4gKwlpZiAoIWRvbWFpbikKPiArCQlyZXR1cm4gTlVMTDsKPiArCj4gKwlkb21haW4tPmNodW5r
cyA9IGtjYWxsb2MobnVtLCBzaXplb2Yoc3RydWN0IHZkdXNlX2lvdmFfY2h1bmspLCBHRlBfS0VS
TkVMKTsKPiArCWlmICghZG9tYWluLT5jaHVua3MpCj4gKwkJZ290byBlcnI7Cj4gKwo+ICsJZm9y
IChpID0gMDsgaSA8IG51bTsgaSsrLCBhZGRyICs9IElPVkFfQ0hVTktfU0laRSkKPiArCQlpZiAo
dmR1c2VfaW92YV9jaHVua19pbml0KCZkb21haW4tPmNodW5rc1tpXSwgYWRkciwKPiArCQkJCQlJ
T1ZBX0NIVU5LX1NJWkUpKQo+ICsJCQlnb3RvIGVycjsKPiArCj4gKwlkb21haW4tPmNodW5rX251
bSA9IG51bTsKPiArCWRvbWFpbi0+c2l6ZSA9IHNpemU7Cj4gKwlJTklUX0xJU1RfSEVBRCgmZG9t
YWluLT52bWFfbGlzdCk7Cj4gKwltdXRleF9pbml0KCZkb21haW4tPnZtYV9sb2NrKTsKPiArCW11
dGV4X2luaXQoJmRvbWFpbi0+bWFwX2xvY2spOwo+ICsKPiArCXJldHVybiBkb21haW47Cj4gK2Vy
cjoKPiArCWZvciAoaiA9IDA7IGogPCBpOyBqKyspCj4gKwkJdmR1c2VfaW92YV9jaHVua19jbGVh
bnVwKCZkb21haW4tPmNodW5rc1tqXSk7Cj4gKwlrZnJlZShkb21haW4pOwo+ICsKPiArCXJldHVy
biBOVUxMOwo+ICt9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdmRwYS92ZHBhX3VzZXIvaW92YV9k
b21haW4uaCBiL2RyaXZlcnMvdmRwYS92ZHBhX3VzZXIvaW92YV9kb21haW4uaAo+IG5ldyBmaWxl
IG1vZGUgMTAwNjQ0Cj4gaW5kZXggMDAwMDAwMDAwMDAwLi5mZTE4MTYyODdmNWYKPiAtLS0gL2Rl
di9udWxsCj4gKysrIGIvZHJpdmVycy92ZHBhL3ZkcGFfdXNlci9pb3ZhX2RvbWFpbi5oCj4gQEAg
LTAsMCArMSw5MyBAQAo+ICsvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5
ICovCj4gKy8qCj4gKyAqIE1NVS1iYXNlZCBJT01NVSBpbXBsZW1lbnRhdGlvbgo+ICsgKgo+ICsg
KiBDb3B5cmlnaHQgKEMpIDIwMjAgQnl0ZWRhbmNlIEluYy4gYW5kL29yIGl0cyBhZmZpbGlhdGVz
LiBBbGwgcmlnaHRzIHJlc2VydmVkLgo+ICsgKgo+ICsgKiBBdXRob3I6IFhpZSBZb25namkgPHhp
ZXlvbmdqaUBieXRlZGFuY2UuY29tPgo+ICsgKgo+ICsgKi8KPiArCj4gKyNpZm5kZWYgX1ZEVVNF
X0lPVkFfRE9NQUlOX0gKPiArI2RlZmluZSBfVkRVU0VfSU9WQV9ET01BSU5fSAo+ICsKPiArI2lu
Y2x1ZGUgPGxpbnV4L2dlbmFsbG9jLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9kbWEtbWFwcGluZy5o
Pgo+ICsKPiArZW51bSBpb3ZhX21hcF90eXBlIHsKPiArCVRZUEVfTk9ORSwKPiArCVRZUEVfRElS
RUNUX01BUCwKPiArCVRZUEVfQk9VTkNFX01BUCwKPiArfTsKPiArCj4gK3N0cnVjdCB2ZHVzZV9p
b3ZhX21hcCB7Cj4gKwl1bnNpZ25lZCBsb25nIGlvdmE7Cj4gKwl1bnNpZ25lZCBsb25nIG9yaWc7
Cj4gKwlzaXplX3Qgc2l6ZTsKPiArCWVudW0gZG1hX2RhdGFfZGlyZWN0aW9uIGRpcjsKPiArfTsK
PiArCj4gK3N0cnVjdCB2ZHVzZV9pb3ZhX2NodW5rIHsKPiArCXN0cnVjdCBnZW5fcG9vbCAqcG9v
bDsKPiArCXN0cnVjdCBwYWdlICoqYm91bmNlX3BhZ2VzOwo+ICsJc3RydWN0IHZkdXNlX2lvdmFf
bWFwICoqaW92YV9tYXA7Cj4gKwl1bnNpZ25lZCBsb25nIHN0YXJ0Owo+ICsJYXRvbWljX3QgbWFw
X3R5cGU7Cj4gK307Cj4gKwo+ICtzdHJ1Y3QgdmR1c2VfaW92YV9kb21haW4gewo+ICsJc3RydWN0
IHZkdXNlX2lvdmFfY2h1bmsgKmNodW5rczsKPiArCWludCBjaHVua19udW07Cj4gKwlzaXplX3Qg
c2l6ZTsKPiArCXN0cnVjdCBtdXRleCBtYXBfbG9jazsKPiArCXN0cnVjdCBtdXRleCB2bWFfbG9j
azsKPiArCXN0cnVjdCBsaXN0X2hlYWQgdm1hX2xpc3Q7Cj4gK307CgoKSXQncyBiZXR0ZXIgdG8g
ZXhwbGFpbiB3aHkgeW91IG5lZWQgdG8gb3JnYW5pemUgdGhlIGJvdW5jZSBidWZmZXIgd2l0aCAK
Y2h1bmtzIGJ5IGFkZGluZyBzb21lIGNvbW1lbnRzIGFib3ZlIG9yIGluIHRoZSBjb21taXQgbG9n
LiBJcyB0aGlzIApiZWNhdXNlIHlvdSB3YW50IHRvIGhhdmUgTygxKSBmb3IgZmluZGluZyB0aGUg
cGFnZSBmb3IgYSBzcGVjaWZpYyBJT1ZBPwoKCj4gKwo+ICtpbnQgdmR1c2VfZG9tYWluX2FkZF92
bWEoc3RydWN0IHZkdXNlX2lvdmFfZG9tYWluICpkb21haW4sCj4gKwkJCQlzdHJ1Y3Qgdm1fYXJl
YV9zdHJ1Y3QgKnZtYSk7Cj4gKwo+ICt2b2lkIHZkdXNlX2RvbWFpbl9yZW1vdmVfdm1hKHN0cnVj
dCB2ZHVzZV9pb3ZhX2RvbWFpbiAqZG9tYWluLAo+ICsJCQkJc3RydWN0IHZtX2FyZWFfc3RydWN0
ICp2bWEpOwo+ICsKPiAraW50IHZkdXNlX2RvbWFpbl9hZGRfbWFwcGluZyhzdHJ1Y3QgdmR1c2Vf
aW92YV9kb21haW4gKmRvbWFpbiwKPiArCQkJCXVuc2lnbmVkIGxvbmcgaW92YSwgdW5zaWduZWQg
bG9uZyBvcmlnLAo+ICsJCQkJc2l6ZV90IHNpemUsIGVudW0gZG1hX2RhdGFfZGlyZWN0aW9uIGRp
cik7Cj4gKwo+ICtzdHJ1Y3QgdmR1c2VfaW92YV9tYXAgKgo+ICt2ZHVzZV9kb21haW5fZ2V0X21h
cHBpbmcoc3RydWN0IHZkdXNlX2lvdmFfZG9tYWluICpkb21haW4sCj4gKwkJCXVuc2lnbmVkIGxv
bmcgaW92YSk7Cj4gKwo+ICt2b2lkIHZkdXNlX2RvbWFpbl9yZW1vdmVfbWFwcGluZyhzdHJ1Y3Qg
dmR1c2VfaW92YV9kb21haW4gKmRvbWFpbiwKPiArCQkJCXN0cnVjdCB2ZHVzZV9pb3ZhX21hcCAq
bWFwKTsKPiArCj4gK3ZvaWQgdmR1c2VfZG9tYWluX3VubWFwKHN0cnVjdCB2ZHVzZV9pb3ZhX2Rv
bWFpbiAqZG9tYWluLAo+ICsJCQl1bnNpZ25lZCBsb25nIGlvdmEsIHNpemVfdCBzaXplKTsKPiAr
Cj4gK2ludCB2ZHVzZV9kb21haW5fZGlyZWN0X21hcChzdHJ1Y3QgdmR1c2VfaW92YV9kb21haW4g
KmRvbWFpbiwKPiArCQkJc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsIHVuc2lnbmVkIGxvbmcg
aW92YSk7Cj4gKwo+ICt2b2lkIHZkdXNlX2RvbWFpbl9ib3VuY2Uoc3RydWN0IHZkdXNlX2lvdmFf
ZG9tYWluICpkb21haW4sCj4gKwkJCXVuc2lnbmVkIGxvbmcgaW92YSwgdW5zaWduZWQgbG9uZyBv
cmlnLAo+ICsJCQlzaXplX3Qgc2l6ZSwgZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGlyKTsKPiAr
Cj4gK2ludCB2ZHVzZV9kb21haW5fYm91bmNlX21hcChzdHJ1Y3QgdmR1c2VfaW92YV9kb21haW4g
KmRvbWFpbiwKPiArCQkJc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsIHVuc2lnbmVkIGxvbmcg
aW92YSk7Cj4gKwo+ICtib29sIHZkdXNlX2RvbWFpbl9pc19kaXJlY3RfbWFwKHN0cnVjdCB2ZHVz
ZV9pb3ZhX2RvbWFpbiAqZG9tYWluLAo+ICsJCQkJdW5zaWduZWQgbG9uZyBpb3ZhKTsKPiArCj4g
K3Vuc2lnbmVkIGxvbmcgdmR1c2VfZG9tYWluX2FsbG9jX2lvdmEoc3RydWN0IHZkdXNlX2lvdmFf
ZG9tYWluICpkb21haW4sCj4gKwkJCQkJc2l6ZV90IHNpemUsIGVudW0gaW92YV9tYXBfdHlwZSB0
eXBlKTsKPiArCj4gK3ZvaWQgdmR1c2VfZG9tYWluX2ZyZWVfaW92YShzdHJ1Y3QgdmR1c2VfaW92
YV9kb21haW4gKmRvbWFpbiwKPiArCQkJCXVuc2lnbmVkIGxvbmcgaW92YSwgc2l6ZV90IHNpemUp
Owo+ICsKPiArYm9vbCB2ZHVzZV9kb21haW5faXNfZGlyZWN0X21hcChzdHJ1Y3QgdmR1c2VfaW92
YV9kb21haW4gKmRvbWFpbiwKPiArCQkJCXVuc2lnbmVkIGxvbmcgaW92YSk7Cj4gKwo+ICt2b2lk
IHZkdXNlX2lvdmFfZG9tYWluX2Rlc3Ryb3koc3RydWN0IHZkdXNlX2lvdmFfZG9tYWluICpkb21h
aW4pOwo+ICsKPiArc3RydWN0IHZkdXNlX2lvdmFfZG9tYWluICp2ZHVzZV9pb3ZhX2RvbWFpbl9j
cmVhdGUoc2l6ZV90IHNpemUpOwo+ICsKPiArI2VuZGlmIC8qIF9WRFVTRV9JT1ZBX0RPTUFJTl9I
ICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdmRwYS92ZHBhX3VzZXIvdmR1c2UuaCBiL2RyaXZl
cnMvdmRwYS92ZHBhX3VzZXIvdmR1c2UuaAo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gaW5kZXgg
MDAwMDAwMDAwMDAwLi4xMDQxY2U3YmRkYzQKPiAtLS0gL2Rldi9udWxsCj4gKysrIGIvZHJpdmVy
cy92ZHBhL3ZkcGFfdXNlci92ZHVzZS5oCj4gQEAgLTAsMCArMSw1OSBAQAo+ICsvKiBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5ICovCj4gKy8qCj4gKyAqIFZEVVNFOiB2RFBB
IERldmljZSBpbiBVc2Vyc3BhY2UKPiArICoKPiArICogQ29weXJpZ2h0IChDKSAyMDIwIEJ5dGVk
YW5jZSBJbmMuIGFuZC9vciBpdHMgYWZmaWxpYXRlcy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KPiAr
ICoKPiArICogQXV0aG9yOiBYaWUgWW9uZ2ppIDx4aWV5b25namlAYnl0ZWRhbmNlLmNvbT4KPiAr
ICoKPiArICovCj4gKwo+ICsjaWZuZGVmIF9WRFVTRV9ICj4gKyNkZWZpbmUgX1ZEVVNFX0gKPiAr
Cj4gKyNpbmNsdWRlIDxsaW51eC9ldmVudGZkLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC93YWl0Lmg+
Cj4gKyNpbmNsdWRlIDxsaW51eC92ZHBhLmg+Cj4gKwo+ICsjaW5jbHVkZSAiaW92YV9kb21haW4u
aCIKPiArI2luY2x1ZGUgImV2ZW50ZmQuaCIKPiArCj4gK3N0cnVjdCB2ZHVzZV92aXJ0cXVldWUg
ewo+ICsJdTE2IGluZGV4Owo+ICsJYm9vbCByZWFkeTsKPiArCXNwaW5sb2NrX3Qga2lja19sb2Nr
Owo+ICsJc3BpbmxvY2tfdCBpcnFfbG9jazsKPiArCXN0cnVjdCBldmVudGZkX2N0eCAqa2lja2Zk
Owo+ICsJc3RydWN0IHZkdXNlX3ZpcnFmZCAqdmlycWZkOwo+ICsJdm9pZCAqcHJpdmF0ZTsKPiAr
CWlycXJldHVybl90ICgqY2IpKHZvaWQgKmRhdGEpOwo+ICt9Owo+ICsKPiArc3RydWN0IHZkdXNl
X2RldjsKPiArCj4gK3N0cnVjdCB2ZHVzZV92ZHBhIHsKPiArCXN0cnVjdCB2ZHBhX2RldmljZSB2
ZHBhOwo+ICsJc3RydWN0IHZkdXNlX2RldiAqZGV2Owo+ICt9Owo+ICsKPiArc3RydWN0IHZkdXNl
X2RldiB7Cj4gKwlzdHJ1Y3QgdmR1c2VfdmRwYSAqdmRldjsKPiArCXN0cnVjdCB2ZHVzZV92aXJ0
cXVldWUgKnZxczsKPiArCXN0cnVjdCB2ZHVzZV9pb3ZhX2RvbWFpbiAqZG9tYWluOwo+ICsJc3Ry
dWN0IG11dGV4IGxvY2s7Cj4gKwlzcGlubG9ja190IG1zZ19sb2NrOwo+ICsJYXRvbWljNjRfdCBt
c2dfdW5pcXVlOwo+ICsJd2FpdF9xdWV1ZV9oZWFkX3Qgd2FpdHE7Cj4gKwlzdHJ1Y3QgbGlzdF9o
ZWFkIHNlbmRfbGlzdDsKPiArCXN0cnVjdCBsaXN0X2hlYWQgcmVjdl9saXN0Owo+ICsJc3RydWN0
IGxpc3RfaGVhZCBsaXN0Owo+ICsJcmVmY291bnRfdCByZWZjbnQ7Cj4gKwl1MzIgaWQ7Cj4gKwl1
MTYgdnFfc2l6ZV9tYXg7Cj4gKwl1MTYgdnFfbnVtOwo+ICsJdTMyIHZxX2FsaWduOwo+ICsJdTMy
IGRldmljZV9pZDsKPiArCXUzMiB2ZW5kb3JfaWQ7Cj4gK307Cj4gKwo+ICsjZW5kaWYgLyogX1ZE
VVNFX0hfICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdmRwYS92ZHBhX3VzZXIvdmR1c2VfZGV2
LmMgYi9kcml2ZXJzL3ZkcGEvdmRwYV91c2VyL3ZkdXNlX2Rldi5jCj4gbmV3IGZpbGUgbW9kZSAx
MDA2NDQKPiBpbmRleCAwMDAwMDAwMDAwMDAuLjRhODY5Yjk2OThlZgo+IC0tLSAvZGV2L251bGwK
PiArKysgYi9kcml2ZXJzL3ZkcGEvdmRwYV91c2VyL3ZkdXNlX2Rldi5jCj4gQEAgLTAsMCArMSwx
MTIxIEBACj4gKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkKPiArLyoK
PiArICogVkRVU0U6IHZEUEEgRGV2aWNlIGluIFVzZXJzcGFjZQo+ICsgKgo+ICsgKiBDb3B5cmln
aHQgKEMpIDIwMjAgQnl0ZWRhbmNlIEluYy4gYW5kL29yIGl0cyBhZmZpbGlhdGVzLiBBbGwgcmln
aHRzIHJlc2VydmVkLgo+ICsgKgo+ICsgKiBBdXRob3I6IFhpZSBZb25namkgPHhpZXlvbmdqaUBi
eXRlZGFuY2UuY29tPgo+ICsgKgo+ICsgKi8KPiArCj4gKyNpbmNsdWRlIDxsaW51eC9pbml0Lmg+
Cj4gKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KPiArI2luY2x1ZGUgPGxpbnV4L21pc2NkZXZp
Y2UuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2RldmljZS5oPgo+ICsjaW5jbHVkZSA8bGludXgvZXZl
bnRmZC5oPgo+ICsjaW5jbHVkZSA8bGludXgvc2xhYi5oPgo+ICsjaW5jbHVkZSA8bGludXgvd2Fp
dC5oPgo+ICsjaW5jbHVkZSA8bGludXgvZG1hLW1hcC1vcHMuaD4KPiArI2luY2x1ZGUgPGxpbnV4
L2Fub25faW5vZGVzLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9maWxlLmg+Cj4gKyNpbmNsdWRlIDxs
aW51eC91aW8uaD4KPiArI2luY2x1ZGUgPGxpbnV4L3ZkcGEuaD4KPiArI2luY2x1ZGUgPHVhcGkv
bGludXgvdmR1c2UuaD4KPiArI2luY2x1ZGUgPHVhcGkvbGludXgvdmRwYS5oPgo+ICsjaW5jbHVk
ZSA8dWFwaS9saW51eC92aXJ0aW9fY29uZmlnLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9tb2RfZGV2
aWNldGFibGUuaD4KPiArCj4gKyNpbmNsdWRlICJ2ZHVzZS5oIgo+ICsKPiArI2RlZmluZSBEUlZf
VkVSU0lPTiAgIjEuMCIKPiArI2RlZmluZSBEUlZfQVVUSE9SICAgIllvbmdqaSBYaWUgPHhpZXlv
bmdqaUBieXRlZGFuY2UuY29tPiIKPiArI2RlZmluZSBEUlZfREVTQyAgICAgInZEUEEgRGV2aWNl
IGluIFVzZXJzcGFjZSIKPiArI2RlZmluZSBEUlZfTElDRU5TRSAgIkdQTCB2MiIKPiArCj4gK3N0
cnVjdCB2ZHVzZV9kZXZfbXNnIHsKPiArCXN0cnVjdCB2ZHVzZV9kZXZfcmVxdWVzdCByZXE7Cj4g
KwlzdHJ1Y3QgdmR1c2VfZGV2X3Jlc3BvbnNlIHJlc3A7Cj4gKwlzdHJ1Y3QgbGlzdF9oZWFkIGxp
c3Q7Cj4gKwl3YWl0X3F1ZXVlX2hlYWRfdCB3YWl0cTsKPiArCWJvb2wgY29tcGxldGVkOwo+ICsJ
cmVmY291bnRfdCByZWZjbnQ7Cj4gK307Cj4gKwo+ICtzdGF0aWMgc3RydWN0IHdvcmtxdWV1ZV9z
dHJ1Y3QgKnZkdXNlX3ZkcGFfd3E7Cj4gK3N0YXRpYyBERUZJTkVfTVVURVgodmR1c2VfbG9jayk7
Cj4gK3N0YXRpYyBMSVNUX0hFQUQodmR1c2VfZGV2cyk7Cj4gKwo+ICtzdGF0aWMgaW5saW5lIHN0
cnVjdCB2ZHVzZV9kZXYgKnZkcGFfdG9fdmR1c2Uoc3RydWN0IHZkcGFfZGV2aWNlICp2ZHBhKQo+
ICt7Cj4gKwlzdHJ1Y3QgdmR1c2VfdmRwYSAqdmRldiA9IGNvbnRhaW5lcl9vZih2ZHBhLCBzdHJ1
Y3QgdmR1c2VfdmRwYSwgdmRwYSk7Cj4gKwo+ICsJcmV0dXJuIHZkZXYtPmRldjsKPiArfQo+ICsK
PiArc3RhdGljIGlubGluZSBzdHJ1Y3QgdmR1c2VfZGV2ICpkZXZfdG9fdmR1c2Uoc3RydWN0IGRl
dmljZSAqZGV2KQo+ICt7Cj4gKwlzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkcGEgPSBkZXZfdG9fdmRw
YShkZXYpOwo+ICsKPiArCXJldHVybiB2ZHBhX3RvX3ZkdXNlKHZkcGEpOwo+ICt9Cj4gKwo+ICtz
dGF0aWMgc3RydWN0IHZkdXNlX2Rldl9tc2cgKnZkdXNlX2Rldl9uZXdfbXNnKHN0cnVjdCB2ZHVz
ZV9kZXYgKmRldiwgaW50IHR5cGUpCj4gK3sKPiArCXN0cnVjdCB2ZHVzZV9kZXZfbXNnICptc2cg
PSBremFsbG9jKHNpemVvZigqbXNnKSwKPiArCQkJCQlHRlBfS0VSTkVMIHwgX19HRlBfTk9GQUlM
KTsKPiArCj4gKwltc2ctPnJlcS50eXBlID0gdHlwZTsKPiArCW1zZy0+cmVxLnVuaXF1ZSA9IGF0
b21pYzY0X2ZldGNoX2luYygmZGV2LT5tc2dfdW5pcXVlKTsKPiArCWluaXRfd2FpdHF1ZXVlX2hl
YWQoJm1zZy0+d2FpdHEpOwo+ICsJcmVmY291bnRfc2V0KCZtc2ctPnJlZmNudCwgMSk7Cj4gKwo+
ICsJcmV0dXJuIG1zZzsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmR1c2VfZGV2X21zZ19nZXQo
c3RydWN0IHZkdXNlX2Rldl9tc2cgKm1zZykKPiArewo+ICsJcmVmY291bnRfaW5jKCZtc2ctPnJl
ZmNudCk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHZkdXNlX2Rldl9tc2dfcHV0KHN0cnVjdCB2
ZHVzZV9kZXZfbXNnICptc2cpCj4gK3sKPiArCWlmIChyZWZjb3VudF9kZWNfYW5kX3Rlc3QoJm1z
Zy0+cmVmY250KSkKPiArCQlrZnJlZShtc2cpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgc3RydWN0IHZk
dXNlX2Rldl9tc2cgKnZkdXNlX2Rldl9maW5kX21zZyhzdHJ1Y3QgdmR1c2VfZGV2ICpkZXYsCj4g
KwkJCQkJCXN0cnVjdCBsaXN0X2hlYWQgKmhlYWQsCj4gKwkJCQkJCXVpbnQzMl90IHVuaXF1ZSkK
PiArewo+ICsJc3RydWN0IHZkdXNlX2Rldl9tc2cgKnRtcCwgKm1zZyA9IE5VTEw7Cj4gKwo+ICsJ
c3Bpbl9sb2NrKCZkZXYtPm1zZ19sb2NrKTsKPiArCWxpc3RfZm9yX2VhY2hfZW50cnkodG1wLCBo
ZWFkLCBsaXN0KSB7Cj4gKwkJaWYgKHRtcC0+cmVxLnVuaXF1ZSA9PSB1bmlxdWUpIHsKPiArCQkJ
bXNnID0gdG1wOwo+ICsJCQlsaXN0X2RlbCgmdG1wLT5saXN0KTsKPiArCQkJYnJlYWs7Cj4gKwkJ
fQo+ICsJfQo+ICsJc3Bpbl91bmxvY2soJmRldi0+bXNnX2xvY2spOwo+ICsKPiArCXJldHVybiBt
c2c7Cj4gK30KPiArCj4gK3N0YXRpYyBzdHJ1Y3QgdmR1c2VfZGV2X21zZyAqdmR1c2VfZGV2X2Rl
cXVldWVfbXNnKHN0cnVjdCB2ZHVzZV9kZXYgKmRldiwKPiArCQkJCQkJc3RydWN0IGxpc3RfaGVh
ZCAqaGVhZCkKPiArewo+ICsJc3RydWN0IHZkdXNlX2Rldl9tc2cgKm1zZyA9IE5VTEw7Cj4gKwo+
ICsJc3Bpbl9sb2NrKCZkZXYtPm1zZ19sb2NrKTsKPiArCWlmICghbGlzdF9lbXB0eShoZWFkKSkg
ewo+ICsJCW1zZyA9IGxpc3RfZmlyc3RfZW50cnkoaGVhZCwgc3RydWN0IHZkdXNlX2Rldl9tc2cs
IGxpc3QpOwo+ICsJCWxpc3RfZGVsKCZtc2ctPmxpc3QpOwo+ICsJfQo+ICsJc3Bpbl91bmxvY2so
JmRldi0+bXNnX2xvY2spOwo+ICsKPiArCXJldHVybiBtc2c7Cj4gK30KPiArCj4gK3N0YXRpYyB2
b2lkIHZkdXNlX2Rldl9lbnF1ZXVlX21zZyhzdHJ1Y3QgdmR1c2VfZGV2ICpkZXYsCj4gKwkJCXN0
cnVjdCB2ZHVzZV9kZXZfbXNnICptc2csIHN0cnVjdCBsaXN0X2hlYWQgKmhlYWQpCj4gK3sKPiAr
CXNwaW5fbG9jaygmZGV2LT5tc2dfbG9jayk7Cj4gKwlsaXN0X2FkZF90YWlsKCZtc2ctPmxpc3Qs
IGhlYWQpOwo+ICsJc3Bpbl91bmxvY2soJmRldi0+bXNnX2xvY2spOwo+ICt9Cj4gKwo+ICtzdGF0
aWMgaW50IHZkdXNlX2Rldl9tc2dfc3luYyhzdHJ1Y3QgdmR1c2VfZGV2ICpkZXYsIHN0cnVjdCB2
ZHVzZV9kZXZfbXNnICptc2cpCj4gK3sKPiArCWludCByZXQ7Cj4gKwo+ICsJdmR1c2VfZGV2X2Vu
cXVldWVfbXNnKGRldiwgbXNnLCAmZGV2LT5zZW5kX2xpc3QpOwo+ICsJd2FrZV91cCgmZGV2LT53
YWl0cSk7Cj4gKwl3YWl0X2V2ZW50KG1zZy0+d2FpdHEsIG1zZy0+Y29tcGxldGVkKTsKPiArCS8q
IGNvdXBsZWQgd2l0aCBzbXBfd21iKCkgaW4gdmR1c2VfZGV2X21zZ19jb21wbGV0ZSgpICovCj4g
KwlzbXBfcm1iKCk7Cj4gKwlyZXQgPSBtc2ctPnJlc3AucmVzdWx0Owo+ICsKPiArCXJldHVybiBy
ZXQ7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHZkdXNlX2Rldl9tc2dfY29tcGxldGUoc3RydWN0
IHZkdXNlX2Rldl9tc2cgKm1zZywKPiArCQkJCQlzdHJ1Y3QgdmR1c2VfZGV2X3Jlc3BvbnNlICpy
ZXNwKQo+ICt7Cj4gKwl2ZHVzZV9kZXZfbXNnX2dldChtc2cpOwo+ICsJbWVtY3B5KCZtc2ctPnJl
c3AsIHJlc3AsIHNpemVvZigqcmVzcCkpOwo+ICsJLyogY291cGxlZCB3aXRoIHNtcF9ybWIoKSBp
biB2ZHVzZV9kZXZfbXNnX3N5bmMoKSAqLwo+ICsJc21wX3dtYigpOwo+ICsJbXNnLT5jb21wbGV0
ZWQgPSAxOwo+ICsJd2FrZV91cCgmbXNnLT53YWl0cSk7Cj4gKwl2ZHVzZV9kZXZfbXNnX3B1dCht
c2cpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdTY0IHZkdXNlX2Rldl9nZXRfZmVhdHVyZXMoc3RydWN0
IHZkdXNlX2RldiAqZGV2KQo+ICt7Cj4gKwlzdHJ1Y3QgdmR1c2VfZGV2X21zZyAqbXNnID0gdmR1
c2VfZGV2X25ld19tc2coZGV2LCBWRFVTRV9HRVRfRkVBVFVSRVMpOwo+ICsJdTY0IGZlYXR1cmVz
Owo+ICsKPiArCXZkdXNlX2Rldl9tc2dfc3luYyhkZXYsIG1zZyk7Cj4gKwlmZWF0dXJlcyA9IG1z
Zy0+cmVzcC5mZWF0dXJlczsKPiArCXZkdXNlX2Rldl9tc2dfcHV0KG1zZyk7Cj4gKwo+ICsJcmV0
dXJuIGZlYXR1cmVzOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZkdXNlX2Rldl9zZXRfZmVhdHVy
ZXMoc3RydWN0IHZkdXNlX2RldiAqZGV2LCB1NjQgZmVhdHVyZXMpCj4gK3sKPiArCXN0cnVjdCB2
ZHVzZV9kZXZfbXNnICptc2cgPSB2ZHVzZV9kZXZfbmV3X21zZyhkZXYsIFZEVVNFX1NFVF9GRUFU
VVJFUyk7Cj4gKwlpbnQgcmV0Owo+ICsKPiArCW1zZy0+cmVxLnNpemUgPSBzaXplb2YoZmVhdHVy
ZXMpOwo+ICsJbXNnLT5yZXEuZmVhdHVyZXMgPSBmZWF0dXJlczsKPiArCj4gKwlyZXQgPSB2ZHVz
ZV9kZXZfbXNnX3N5bmMoZGV2LCBtc2cpOwo+ICsJdmR1c2VfZGV2X21zZ19wdXQobXNnKTsKPiAr
Cj4gKwlyZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICtzdGF0aWMgdTggdmR1c2VfZGV2X2dldF9zdGF0
dXMoc3RydWN0IHZkdXNlX2RldiAqZGV2KQo+ICt7Cj4gKwlzdHJ1Y3QgdmR1c2VfZGV2X21zZyAq
bXNnID0gdmR1c2VfZGV2X25ld19tc2coZGV2LCBWRFVTRV9HRVRfU1RBVFVTKTsKPiArCXU4IHN0
YXR1czsKPiArCj4gKwl2ZHVzZV9kZXZfbXNnX3N5bmMoZGV2LCBtc2cpOwo+ICsJc3RhdHVzID0g
bXNnLT5yZXNwLnN0YXR1czsKPiArCXZkdXNlX2Rldl9tc2dfcHV0KG1zZyk7Cj4gKwo+ICsJcmV0
dXJuIHN0YXR1czsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmR1c2VfZGV2X3NldF9zdGF0dXMo
c3RydWN0IHZkdXNlX2RldiAqZGV2LCB1OCBzdGF0dXMpCj4gK3sKPiArCXN0cnVjdCB2ZHVzZV9k
ZXZfbXNnICptc2cgPSB2ZHVzZV9kZXZfbmV3X21zZyhkZXYsIFZEVVNFX1NFVF9TVEFUVVMpOwo+
ICsKPiArCW1zZy0+cmVxLnNpemUgPSBzaXplb2Yoc3RhdHVzKTsKPiArCW1zZy0+cmVxLnN0YXR1
cyA9IHN0YXR1czsKPiArCj4gKwl2ZHVzZV9kZXZfbXNnX3N5bmMoZGV2LCBtc2cpOwo+ICsJdmR1
c2VfZGV2X21zZ19wdXQobXNnKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmR1c2VfZGV2X2dl
dF9jb25maWcoc3RydWN0IHZkdXNlX2RldiAqZGV2LCB1bnNpZ25lZCBpbnQgb2Zmc2V0LAo+ICsJ
CQkJCXZvaWQgKmJ1ZiwgdW5zaWduZWQgaW50IGxlbikKPiArewo+ICsJc3RydWN0IHZkdXNlX2Rl
dl9tc2cgKm1zZyA9IHZkdXNlX2Rldl9uZXdfbXNnKGRldiwgVkRVU0VfR0VUX0NPTkZJRyk7Cj4g
Kwo+ICsJV0FSTl9PTihsZW4gPiBzaXplb2YobXNnLT5yZXEuY29uZmlnLmRhdGEpKTsKPiArCj4g
Kwltc2ctPnJlcS5zaXplID0gc2l6ZW9mKHN0cnVjdCB2ZHVzZV9kZXZfY29uZmlnX2RhdGEpOwo+
ICsJbXNnLT5yZXEuY29uZmlnLm9mZnNldCA9IG9mZnNldDsKPiArCW1zZy0+cmVxLmNvbmZpZy5s
ZW4gPSBsZW47Cj4gKwl2ZHVzZV9kZXZfbXNnX3N5bmMoZGV2LCBtc2cpOwo+ICsJbWVtY3B5KGJ1
ZiwgbXNnLT5yZXNwLmNvbmZpZy5kYXRhLCBsZW4pOwo+ICsJdmR1c2VfZGV2X21zZ19wdXQobXNn
KTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmR1c2VfZGV2X3NldF9jb25maWcoc3RydWN0IHZk
dXNlX2RldiAqZGV2LCB1bnNpZ25lZCBpbnQgb2Zmc2V0LAo+ICsJCQkJCWNvbnN0IHZvaWQgKmJ1
ZiwgdW5zaWduZWQgaW50IGxlbikKPiArewo+ICsJc3RydWN0IHZkdXNlX2Rldl9tc2cgKm1zZyA9
IHZkdXNlX2Rldl9uZXdfbXNnKGRldiwgVkRVU0VfU0VUX0NPTkZJRyk7Cj4gKwo+ICsJV0FSTl9P
TihsZW4gPiBzaXplb2YobXNnLT5yZXEuY29uZmlnLmRhdGEpKTsKPiArCj4gKwltc2ctPnJlcS5z
aXplID0gc2l6ZW9mKHN0cnVjdCB2ZHVzZV9kZXZfY29uZmlnX2RhdGEpOwo+ICsJbXNnLT5yZXEu
Y29uZmlnLm9mZnNldCA9IG9mZnNldDsKPiArCW1zZy0+cmVxLmNvbmZpZy5sZW4gPSBsZW47Cj4g
KwltZW1jcHkobXNnLT5yZXEuY29uZmlnLmRhdGEsIGJ1ZiwgbGVuKTsKPiArCXZkdXNlX2Rldl9t
c2dfc3luYyhkZXYsIG1zZyk7Cj4gKwl2ZHVzZV9kZXZfbXNnX3B1dChtc2cpOwo+ICt9Cj4gKwo+
ICtzdGF0aWMgdm9pZCB2ZHVzZV9kZXZfc2V0X3ZxX251bShzdHJ1Y3QgdmR1c2VfZGV2ICpkZXYs
Cj4gKwkJCQlzdHJ1Y3QgdmR1c2VfdmlydHF1ZXVlICp2cSwgdTMyIG51bSkKPiArewo+ICsJc3Ry
dWN0IHZkdXNlX2Rldl9tc2cgKm1zZyA9IHZkdXNlX2Rldl9uZXdfbXNnKGRldiwgVkRVU0VfU0VU
X1ZRX05VTSk7Cj4gKwo+ICsJbXNnLT5yZXEuc2l6ZSA9IHNpemVvZihzdHJ1Y3QgdmR1c2VfdnFf
bnVtKTsKPiArCW1zZy0+cmVxLnZxX251bS5pbmRleCA9IHZxLT5pbmRleDsKPiArCW1zZy0+cmVx
LnZxX251bS5udW0gPSBudW07Cj4gKwo+ICsJdmR1c2VfZGV2X21zZ19zeW5jKGRldiwgbXNnKTsK
PiArCXZkdXNlX2Rldl9tc2dfcHV0KG1zZyk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgdmR1c2Vf
ZGV2X3NldF92cV9hZGRyKHN0cnVjdCB2ZHVzZV9kZXYgKmRldiwKPiArCQkJCXN0cnVjdCB2ZHVz
ZV92aXJ0cXVldWUgKnZxLCB1NjQgZGVzY19hZGRyLAo+ICsJCQkJdTY0IGRyaXZlcl9hZGRyLCB1
NjQgZGV2aWNlX2FkZHIpCj4gK3sKPiArCXN0cnVjdCB2ZHVzZV9kZXZfbXNnICptc2cgPSB2ZHVz
ZV9kZXZfbmV3X21zZyhkZXYsIFZEVVNFX1NFVF9WUV9BRERSKTsKPiArCWludCByZXQ7Cj4gKwo+
ICsJbXNnLT5yZXEuc2l6ZSA9IHNpemVvZihzdHJ1Y3QgdmR1c2VfdnFfYWRkcik7Cj4gKwltc2ct
PnJlcS52cV9hZGRyLmluZGV4ID0gdnEtPmluZGV4Owo+ICsJbXNnLT5yZXEudnFfYWRkci5kZXNj
X2FkZHIgPSBkZXNjX2FkZHI7Cj4gKwltc2ctPnJlcS52cV9hZGRyLmRyaXZlcl9hZGRyID0gZHJp
dmVyX2FkZHI7Cj4gKwltc2ctPnJlcS52cV9hZGRyLmRldmljZV9hZGRyID0gZGV2aWNlX2FkZHI7
Cj4gKwo+ICsJcmV0ID0gdmR1c2VfZGV2X21zZ19zeW5jKGRldiwgbXNnKTsKPiArCXZkdXNlX2Rl
dl9tc2dfcHV0KG1zZyk7Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3RhdGljIHZv
aWQgdmR1c2VfZGV2X3NldF92cV9yZWFkeShzdHJ1Y3QgdmR1c2VfZGV2ICpkZXYsCj4gKwkJCQlz
dHJ1Y3QgdmR1c2VfdmlydHF1ZXVlICp2cSwgYm9vbCByZWFkeSkKPiArewo+ICsJc3RydWN0IHZk
dXNlX2Rldl9tc2cgKm1zZyA9IHZkdXNlX2Rldl9uZXdfbXNnKGRldiwgVkRVU0VfU0VUX1ZRX1JF
QURZKTsKPiArCj4gKwltc2ctPnJlcS5zaXplID0gc2l6ZW9mKHN0cnVjdCB2ZHVzZV92cV9yZWFk
eSk7Cj4gKwltc2ctPnJlcS52cV9yZWFkeS5pbmRleCA9IHZxLT5pbmRleDsKPiArCW1zZy0+cmVx
LnZxX3JlYWR5LnJlYWR5ID0gcmVhZHk7Cj4gKwo+ICsJdmR1c2VfZGV2X21zZ19zeW5jKGRldiwg
bXNnKTsKPiArCXZkdXNlX2Rldl9tc2dfcHV0KG1zZyk7Cj4gK30KPiArCj4gK3N0YXRpYyBib29s
IHZkdXNlX2Rldl9nZXRfdnFfcmVhZHkoc3RydWN0IHZkdXNlX2RldiAqZGV2LAo+ICsJCQkJICAg
c3RydWN0IHZkdXNlX3ZpcnRxdWV1ZSAqdnEpCj4gK3sKPiArCXN0cnVjdCB2ZHVzZV9kZXZfbXNn
ICptc2cgPSB2ZHVzZV9kZXZfbmV3X21zZyhkZXYsIFZEVVNFX0dFVF9WUV9SRUFEWSk7Cj4gKwli
b29sIHJlYWR5Owo+ICsKPiArCW1zZy0+cmVxLnNpemUgPSBzaXplb2Yoc3RydWN0IHZkdXNlX3Zx
X3JlYWR5KTsKPiArCW1zZy0+cmVxLnZxX3JlYWR5LmluZGV4ID0gdnEtPmluZGV4Owo+ICsKPiAr
CXZkdXNlX2Rldl9tc2dfc3luYyhkZXYsIG1zZyk7Cj4gKwlyZWFkeSA9IG1zZy0+cmVzcC52cV9y
ZWFkeS5yZWFkeTsKPiArCXZkdXNlX2Rldl9tc2dfcHV0KG1zZyk7Cj4gKwo+ICsJcmV0dXJuIHJl
YWR5Owo+ICt9Cj4gKwo+ICtzdGF0aWMgc3NpemVfdCB2ZHVzZV9kZXZfcmVhZF9pdGVyKHN0cnVj
dCBraW9jYiAqaW9jYiwgc3RydWN0IGlvdl9pdGVyICp0bykKPiArewo+ICsJc3RydWN0IGZpbGUg
KmZpbGUgPSBpb2NiLT5raV9maWxwOwo+ICsJc3RydWN0IHZkdXNlX2RldiAqZGV2ID0gZmlsZS0+
cHJpdmF0ZV9kYXRhOwo+ICsJc3RydWN0IHZkdXNlX2Rldl9tc2cgKm1zZzsKPiArCWludCBzaXpl
ID0gc2l6ZW9mKHN0cnVjdCB2ZHVzZV9kZXZfcmVxdWVzdCk7Cj4gKwlzc2l6ZV90IHJldCA9IDA7
Cj4gKwo+ICsJaWYgKGlvdl9pdGVyX2NvdW50KHRvKSA8IHNpemUpCj4gKwkJcmV0dXJuIDA7Cj4g
Kwo+ICsJd2hpbGUgKDEpIHsKPiArCQltc2cgPSB2ZHVzZV9kZXZfZGVxdWV1ZV9tc2coZGV2LCAm
ZGV2LT5zZW5kX2xpc3QpOwo+ICsJCWlmIChtc2cpCj4gKwkJCWJyZWFrOwo+ICsKPiArCQlpZiAo
ZmlsZS0+Zl9mbGFncyAmIE9fTk9OQkxPQ0spCj4gKwkJCXJldHVybiAtRUFHQUlOOwo+ICsKPiAr
CQlyZXQgPSB3YWl0X2V2ZW50X2ludGVycnVwdGlibGVfZXhjbHVzaXZlKGRldi0+d2FpdHEsCj4g
KwkJCQkJIWxpc3RfZW1wdHkoJmRldi0+c2VuZF9saXN0KSk7Cj4gKwkJaWYgKHJldCkKPiArCQkJ
cmV0dXJuIHJldDsKPiArCX0KPiArCXJldCA9IGNvcHlfdG9faXRlcigmbXNnLT5yZXEsIHNpemUs
IHRvKTsKPiArCWlmIChyZXQgIT0gc2l6ZSkgewo+ICsJCXZkdXNlX2Rldl9lbnF1ZXVlX21zZyhk
ZXYsIG1zZywgJmRldi0+c2VuZF9saXN0KTsKPiArCQlyZXR1cm4gLUVGQVVMVDsKPiArCX0KPiAr
CXZkdXNlX2Rldl9lbnF1ZXVlX21zZyhkZXYsIG1zZywgJmRldi0+cmVjdl9saXN0KTsKPiArCj4g
KwlyZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICtzdGF0aWMgc3NpemVfdCB2ZHVzZV9kZXZfd3JpdGVf
aXRlcihzdHJ1Y3Qga2lvY2IgKmlvY2IsIHN0cnVjdCBpb3ZfaXRlciAqZnJvbSkKPiArewo+ICsJ
c3RydWN0IGZpbGUgKmZpbGUgPSBpb2NiLT5raV9maWxwOwo+ICsJc3RydWN0IHZkdXNlX2RldiAq
ZGV2ID0gZmlsZS0+cHJpdmF0ZV9kYXRhOwo+ICsJc3RydWN0IHZkdXNlX2Rldl9yZXNwb25zZSBy
ZXNwOwo+ICsJc3RydWN0IHZkdXNlX2Rldl9tc2cgKm1zZzsKPiArCXNpemVfdCByZXQ7Cj4gKwo+
ICsJcmV0ID0gY29weV9mcm9tX2l0ZXIoJnJlc3AsIHNpemVvZihyZXNwKSwgZnJvbSk7Cj4gKwlp
ZiAocmV0ICE9IHNpemVvZihyZXNwKSkKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCj4gKwltc2cg
PSB2ZHVzZV9kZXZfZmluZF9tc2coZGV2LCAmZGV2LT5yZWN2X2xpc3QsIHJlc3AudW5pcXVlKTsK
PiArCWlmICghbXNnKQo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsKPiArCXZkdXNlX2Rldl9tc2df
Y29tcGxldGUobXNnLCAmcmVzcCk7Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3Rh
dGljIF9fcG9sbF90IHZkdXNlX2Rldl9wb2xsKHN0cnVjdCBmaWxlICpmaWxlLCBwb2xsX3RhYmxl
ICp3YWl0KQo+ICt7Cj4gKwlzdHJ1Y3QgdmR1c2VfZGV2ICpkZXYgPSBmaWxlLT5wcml2YXRlX2Rh
dGE7Cj4gKwlfX3BvbGxfdCBtYXNrID0gMDsKPiArCj4gKwlwb2xsX3dhaXQoZmlsZSwgJmRldi0+
d2FpdHEsIHdhaXQpOwo+ICsKPiArCWlmICghbGlzdF9lbXB0eSgmZGV2LT5zZW5kX2xpc3QpKQo+
ICsJCW1hc2sgfD0gRVBPTExJTiB8IEVQT0xMUkROT1JNOwo+ICsKPiArCXJldHVybiBtYXNrOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCB2ZHVzZV9kZXZfcmVzZXQoc3RydWN0IHZkdXNlX2RldiAq
ZGV2KQo+ICt7Cj4gKwlpbnQgaTsKPiArCj4gKwlmb3IgKGkgPSAwOyBpIDwgZGV2LT52cV9udW07
IGkrKykgewo+ICsJCXN0cnVjdCB2ZHVzZV92aXJ0cXVldWUgKnZxID0gJmRldi0+dnFzW2ldOwo+
ICsKPiArCQlzcGluX2xvY2soJnZxLT5pcnFfbG9jayk7Cj4gKwkJdnEtPnJlYWR5ID0gZmFsc2U7
Cj4gKwkJdnEtPmNiID0gTlVMTDsKPiArCQl2cS0+cHJpdmF0ZSA9IE5VTEw7Cj4gKwkJc3Bpbl91
bmxvY2soJnZxLT5pcnFfbG9jayk7Cj4gKwl9Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgdmR1c2Vf
dmRwYV9zZXRfdnFfYWRkcmVzcyhzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkcGEsIHUxNiBpZHgsCj4g
KwkJCQl1NjQgZGVzY19hcmVhLCB1NjQgZHJpdmVyX2FyZWEsCj4gKwkJCQl1NjQgZGV2aWNlX2Fy
ZWEpCj4gK3sKPiArCXN0cnVjdCB2ZHVzZV9kZXYgKmRldiA9IHZkcGFfdG9fdmR1c2UodmRwYSk7
Cj4gKwlzdHJ1Y3QgdmR1c2VfdmlydHF1ZXVlICp2cSA9ICZkZXYtPnZxc1tpZHhdOwo+ICsKPiAr
CXJldHVybiB2ZHVzZV9kZXZfc2V0X3ZxX2FkZHIoZGV2LCB2cSwgZGVzY19hcmVhLAo+ICsJCQkJ
CWRyaXZlcl9hcmVhLCBkZXZpY2VfYXJlYSk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHZkdXNl
X3ZkcGFfa2lja192cShzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkcGEsIHUxNiBpZHgpCj4gK3sKPiAr
CXN0cnVjdCB2ZHVzZV9kZXYgKmRldiA9IHZkcGFfdG9fdmR1c2UodmRwYSk7Cj4gKwlzdHJ1Y3Qg
dmR1c2VfdmlydHF1ZXVlICp2cSA9ICZkZXYtPnZxc1tpZHhdOwo+ICsKPiArCXZkdXNlX3ZxX2tp
Y2sodnEpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCB2ZHVzZV92ZHBhX3NldF92cV9jYihzdHJ1
Y3QgdmRwYV9kZXZpY2UgKnZkcGEsIHUxNiBpZHgsCj4gKwkJCSAgICAgIHN0cnVjdCB2ZHBhX2Nh
bGxiYWNrICpjYikKPiArewo+ICsJc3RydWN0IHZkdXNlX2RldiAqZGV2ID0gdmRwYV90b192ZHVz
ZSh2ZHBhKTsKPiArCXN0cnVjdCB2ZHVzZV92aXJ0cXVldWUgKnZxID0gJmRldi0+dnFzW2lkeF07
Cj4gKwo+ICsJdnEtPmNiID0gY2ItPmNhbGxiYWNrOwo+ICsJdnEtPnByaXZhdGUgPSBjYi0+cHJp
dmF0ZTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmR1c2VfdmRwYV9zZXRfdnFfbnVtKHN0cnVj
dCB2ZHBhX2RldmljZSAqdmRwYSwgdTE2IGlkeCwgdTMyIG51bSkKPiArewo+ICsJc3RydWN0IHZk
dXNlX2RldiAqZGV2ID0gdmRwYV90b192ZHVzZSh2ZHBhKTsKPiArCXN0cnVjdCB2ZHVzZV92aXJ0
cXVldWUgKnZxID0gJmRldi0+dnFzW2lkeF07Cj4gKwo+ICsJdmR1c2VfZGV2X3NldF92cV9udW0o
ZGV2LCB2cSwgbnVtKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmR1c2VfdmRwYV9zZXRfdnFf
cmVhZHkoc3RydWN0IHZkcGFfZGV2aWNlICp2ZHBhLAo+ICsJCQkJCXUxNiBpZHgsIGJvb2wgcmVh
ZHkpCj4gK3sKPiArCXN0cnVjdCB2ZHVzZV9kZXYgKmRldiA9IHZkcGFfdG9fdmR1c2UodmRwYSk7
Cj4gKwlzdHJ1Y3QgdmR1c2VfdmlydHF1ZXVlICp2cSA9ICZkZXYtPnZxc1tpZHhdOwo+ICsKPiAr
CXZkdXNlX2Rldl9zZXRfdnFfcmVhZHkoZGV2LCB2cSwgcmVhZHkpOwo+ICsJdnEtPnJlYWR5ID0g
cmVhZHk7Cj4gK30KPiArCj4gK3N0YXRpYyBib29sIHZkdXNlX3ZkcGFfZ2V0X3ZxX3JlYWR5KHN0
cnVjdCB2ZHBhX2RldmljZSAqdmRwYSwgdTE2IGlkeCkKPiArewo+ICsJc3RydWN0IHZkdXNlX2Rl
diAqZGV2ID0gdmRwYV90b192ZHVzZSh2ZHBhKTsKPiArCXN0cnVjdCB2ZHVzZV92aXJ0cXVldWUg
KnZxID0gJmRldi0+dnFzW2lkeF07Cj4gKwo+ICsJdnEtPnJlYWR5ID0gdmR1c2VfZGV2X2dldF92
cV9yZWFkeShkZXYsIHZxKTsKPiArCj4gKwlyZXR1cm4gdnEtPnJlYWR5Owo+ICt9Cj4gKwo+ICtz
dGF0aWMgdTMyIHZkdXNlX3ZkcGFfZ2V0X3ZxX2FsaWduKHN0cnVjdCB2ZHBhX2RldmljZSAqdmRw
YSkKPiArewo+ICsJc3RydWN0IHZkdXNlX2RldiAqZGV2ID0gdmRwYV90b192ZHVzZSh2ZHBhKTsK
PiArCj4gKwlyZXR1cm4gZGV2LT52cV9hbGlnbjsKPiArfQo+ICsKPiArc3RhdGljIHU2NCB2ZHVz
ZV92ZHBhX2dldF9mZWF0dXJlcyhzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkcGEpCj4gK3sKPiArCXN0
cnVjdCB2ZHVzZV9kZXYgKmRldiA9IHZkcGFfdG9fdmR1c2UodmRwYSk7Cj4gKwl1NjQgZml4ZWQg
PSAoMVVMTCA8PCBWSVJUSU9fRl9BQ0NFU1NfUExBVEZPUk0pOwo+ICsKPiArCXJldHVybiAodmR1
c2VfZGV2X2dldF9mZWF0dXJlcyhkZXYpIHwgZml4ZWQpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50
IHZkdXNlX3ZkcGFfc2V0X2ZlYXR1cmVzKHN0cnVjdCB2ZHBhX2RldmljZSAqdmRwYSwgdTY0IGZl
YXR1cmVzKQo+ICt7Cj4gKwlzdHJ1Y3QgdmR1c2VfZGV2ICpkZXYgPSB2ZHBhX3RvX3ZkdXNlKHZk
cGEpOwo+ICsKPiArCXJldHVybiB2ZHVzZV9kZXZfc2V0X2ZlYXR1cmVzKGRldiwgZmVhdHVyZXMp
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCB2ZHVzZV92ZHBhX3NldF9jb25maWdfY2Ioc3RydWN0
IHZkcGFfZGV2aWNlICp2ZHBhLAo+ICsJCQkJICBzdHJ1Y3QgdmRwYV9jYWxsYmFjayAqY2IpCj4g
K3sKPiArCS8qIFdlIGRvbid0IHN1cHBvcnQgY29uZmlnIGludGVycnVwdCAqLwo+ICt9Cj4gKwo+
ICtzdGF0aWMgdTE2IHZkdXNlX3ZkcGFfZ2V0X3ZxX251bV9tYXgoc3RydWN0IHZkcGFfZGV2aWNl
ICp2ZHBhKQo+ICt7Cj4gKwlzdHJ1Y3QgdmR1c2VfZGV2ICpkZXYgPSB2ZHBhX3RvX3ZkdXNlKHZk
cGEpOwo+ICsKPiArCXJldHVybiBkZXYtPnZxX3NpemVfbWF4Owo+ICt9Cj4gKwo+ICtzdGF0aWMg
dTMyIHZkdXNlX3ZkcGFfZ2V0X2RldmljZV9pZChzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkcGEpCj4g
K3sKPiArCXN0cnVjdCB2ZHVzZV9kZXYgKmRldiA9IHZkcGFfdG9fdmR1c2UodmRwYSk7Cj4gKwo+
ICsJcmV0dXJuIGRldi0+ZGV2aWNlX2lkOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdTMyIHZkdXNlX3Zk
cGFfZ2V0X3ZlbmRvcl9pZChzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkcGEpCj4gK3sKPiArCXN0cnVj
dCB2ZHVzZV9kZXYgKmRldiA9IHZkcGFfdG9fdmR1c2UodmRwYSk7Cj4gKwo+ICsJcmV0dXJuIGRl
di0+dmVuZG9yX2lkOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdTggdmR1c2VfdmRwYV9nZXRfc3RhdHVz
KHN0cnVjdCB2ZHBhX2RldmljZSAqdmRwYSkKPiArewo+ICsJc3RydWN0IHZkdXNlX2RldiAqZGV2
ID0gdmRwYV90b192ZHVzZSh2ZHBhKTsKPiArCj4gKwlyZXR1cm4gdmR1c2VfZGV2X2dldF9zdGF0
dXMoZGV2KTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmR1c2VfdmRwYV9zZXRfc3RhdHVzKHN0
cnVjdCB2ZHBhX2RldmljZSAqdmRwYSwgdTggc3RhdHVzKQo+ICt7Cj4gKwlzdHJ1Y3QgdmR1c2Vf
ZGV2ICpkZXYgPSB2ZHBhX3RvX3ZkdXNlKHZkcGEpOwo+ICsKPiArCWlmIChzdGF0dXMgPT0gMCkK
PiArCQl2ZHVzZV9kZXZfcmVzZXQoZGV2KTsKPiArCj4gKwl2ZHVzZV9kZXZfc2V0X3N0YXR1cyhk
ZXYsIHN0YXR1cyk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHZkdXNlX3ZkcGFfZ2V0X2NvbmZp
ZyhzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkcGEsIHVuc2lnbmVkIGludCBvZmZzZXQsCj4gKwkJCSAg
ICAgdm9pZCAqYnVmLCB1bnNpZ25lZCBpbnQgbGVuKQo+ICt7Cj4gKwlzdHJ1Y3QgdmR1c2VfZGV2
ICpkZXYgPSB2ZHBhX3RvX3ZkdXNlKHZkcGEpOwo+ICsKPiArCXZkdXNlX2Rldl9nZXRfY29uZmln
KGRldiwgb2Zmc2V0LCBidWYsIGxlbik7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHZkdXNlX3Zk
cGFfc2V0X2NvbmZpZyhzdHJ1Y3QgdmRwYV9kZXZpY2UgKnZkcGEsIHVuc2lnbmVkIGludCBvZmZz
ZXQsCj4gKwkJCWNvbnN0IHZvaWQgKmJ1ZiwgdW5zaWduZWQgaW50IGxlbikKPiArewo+ICsJc3Ry
dWN0IHZkdXNlX2RldiAqZGV2ID0gdmRwYV90b192ZHVzZSh2ZHBhKTsKPiArCj4gKwl2ZHVzZV9k
ZXZfc2V0X2NvbmZpZyhkZXYsIG9mZnNldCwgYnVmLCBsZW4pOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
dm9pZCB2ZHVzZV92ZHBhX2ZyZWUoc3RydWN0IHZkcGFfZGV2aWNlICp2ZHBhKQo+ICt7Cj4gKwlz
dHJ1Y3QgdmR1c2VfZGV2ICpkZXYgPSB2ZHBhX3RvX3ZkdXNlKHZkcGEpOwo+ICsKPiArCXZkdXNl
X2tpY2tmZF9yZWxlYXNlKGRldik7Cj4gKwl2ZHVzZV92aXJxZmRfcmVsZWFzZShkZXYpOwo+ICsK
PiArCVdBUk5fT04oIWxpc3RfZW1wdHkoJmRldi0+c2VuZF9saXN0KSk7Cj4gKwlXQVJOX09OKCFs
aXN0X2VtcHR5KCZkZXYtPnJlY3ZfbGlzdCkpOwo+ICsJZGV2LT52ZGV2ID0gTlVMTDsKPiArfQo+
ICsKPiArc3RhdGljIGNvbnN0IHN0cnVjdCB2ZHBhX2NvbmZpZ19vcHMgdmR1c2VfdmRwYV9jb25m
aWdfb3BzID0gewo+ICsJLnNldF92cV9hZGRyZXNzCQk9IHZkdXNlX3ZkcGFfc2V0X3ZxX2FkZHJl
c3MsCj4gKwkua2lja192cQkJPSB2ZHVzZV92ZHBhX2tpY2tfdnEsCj4gKwkuc2V0X3ZxX2NiCQk9
IHZkdXNlX3ZkcGFfc2V0X3ZxX2NiLAo+ICsJLnNldF92cV9udW0gICAgICAgICAgICAgPSB2ZHVz
ZV92ZHBhX3NldF92cV9udW0sCj4gKwkuc2V0X3ZxX3JlYWR5CQk9IHZkdXNlX3ZkcGFfc2V0X3Zx
X3JlYWR5LAo+ICsJLmdldF92cV9yZWFkeQkJPSB2ZHVzZV92ZHBhX2dldF92cV9yZWFkeSwKPiAr
CS5nZXRfdnFfYWxpZ24JCT0gdmR1c2VfdmRwYV9nZXRfdnFfYWxpZ24sCj4gKwkuZ2V0X2ZlYXR1
cmVzCQk9IHZkdXNlX3ZkcGFfZ2V0X2ZlYXR1cmVzLAo+ICsJLnNldF9mZWF0dXJlcwkJPSB2ZHVz
ZV92ZHBhX3NldF9mZWF0dXJlcywKPiArCS5zZXRfY29uZmlnX2NiCQk9IHZkdXNlX3ZkcGFfc2V0
X2NvbmZpZ19jYiwKPiArCS5nZXRfdnFfbnVtX21heAkJPSB2ZHVzZV92ZHBhX2dldF92cV9udW1f
bWF4LAo+ICsJLmdldF9kZXZpY2VfaWQJCT0gdmR1c2VfdmRwYV9nZXRfZGV2aWNlX2lkLAo+ICsJ
LmdldF92ZW5kb3JfaWQJCT0gdmR1c2VfdmRwYV9nZXRfdmVuZG9yX2lkLAo+ICsJLmdldF9zdGF0
dXMJCT0gdmR1c2VfdmRwYV9nZXRfc3RhdHVzLAo+ICsJLnNldF9zdGF0dXMJCT0gdmR1c2VfdmRw
YV9zZXRfc3RhdHVzLAo+ICsJLmdldF9jb25maWcJCT0gdmR1c2VfdmRwYV9nZXRfY29uZmlnLAo+
ICsJLnNldF9jb25maWcJCT0gdmR1c2VfdmRwYV9zZXRfY29uZmlnLAo+ICsJLmZyZWUJCQk9IHZk
dXNlX3ZkcGFfZnJlZSwKPiArfTsKPiArCj4gK3N0YXRpYyBkbWFfYWRkcl90IHZkdXNlX2Rldl9t
YXBfcGFnZShzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBwYWdlICpwYWdlLAo+ICsJCQkJCXVu
c2lnbmVkIGxvbmcgb2Zmc2V0LCBzaXplX3Qgc2l6ZSwKPiArCQkJCQllbnVtIGRtYV9kYXRhX2Rp
cmVjdGlvbiBkaXIsCj4gKwkJCQkJdW5zaWduZWQgbG9uZyBhdHRycykKPiArewo+ICsJc3RydWN0
IHZkdXNlX2RldiAqdmRldiA9IGRldl90b192ZHVzZShkZXYpOwo+ICsJc3RydWN0IHZkdXNlX2lv
dmFfZG9tYWluICpkb21haW4gPSB2ZGV2LT5kb21haW47Cj4gKwl1bnNpZ25lZCBsb25nIGlvdmEg
PSB2ZHVzZV9kb21haW5fYWxsb2NfaW92YShkb21haW4sIHNpemUsCj4gKwkJCQkJCQlUWVBFX0JP
VU5DRV9NQVApOwo+ICsJdW5zaWduZWQgbG9uZyBvcmlnID0gKHVuc2lnbmVkIGxvbmcpcGFnZV9h
ZGRyZXNzKHBhZ2UpICsgb2Zmc2V0Owo+ICsKPiArCWlmICghaW92YSkKPiArCQlyZXR1cm4gRE1B
X01BUFBJTkdfRVJST1I7Cj4gKwo+ICsJaWYgKHZkdXNlX2RvbWFpbl9hZGRfbWFwcGluZyhkb21h
aW4sIGlvdmEsIG9yaWcsIHNpemUsIGRpcikpIHsKPiArCQl2ZHVzZV9kb21haW5fZnJlZV9pb3Zh
KGRvbWFpbiwgaW92YSwgc2l6ZSk7Cj4gKwkJcmV0dXJuIERNQV9NQVBQSU5HX0VSUk9SOwo+ICsJ
fQo+ICsKPiArCWlmIChkaXIgPT0gRE1BX1RPX0RFVklDRSkKCgpIb3cgYWJvdXQgYmlkaXJlY3Rp
b25hbCBtYXBwaW5nPwoKCj4gKwkJdmR1c2VfZG9tYWluX2JvdW5jZShkb21haW4sIGlvdmEsIG9y
aWcsIHNpemUsIGRpcik7Cj4gKwo+ICsJcmV0dXJuIChkbWFfYWRkcl90KWlvdmE7Cj4gK30KPiAr
Cj4gK3N0YXRpYyB2b2lkIHZkdXNlX2Rldl91bm1hcF9wYWdlKHN0cnVjdCBkZXZpY2UgKmRldiwg
ZG1hX2FkZHJfdCBkbWFfYWRkciwKPiArCQkJCXNpemVfdCBzaXplLCBlbnVtIGRtYV9kYXRhX2Rp
cmVjdGlvbiBkaXIsCj4gKwkJCQl1bnNpZ25lZCBsb25nIGF0dHJzKQo+ICt7Cj4gKwlzdHJ1Y3Qg
dmR1c2VfZGV2ICp2ZGV2ID0gZGV2X3RvX3ZkdXNlKGRldik7Cj4gKwlzdHJ1Y3QgdmR1c2VfaW92
YV9kb21haW4gKmRvbWFpbiA9IHZkZXYtPmRvbWFpbjsKPiArCXVuc2lnbmVkIGxvbmcgaW92YSA9
ICh1bnNpZ25lZCBsb25nKWRtYV9hZGRyOwo+ICsJc3RydWN0IHZkdXNlX2lvdmFfbWFwICptYXAg
PSB2ZHVzZV9kb21haW5fZ2V0X21hcHBpbmcoZG9tYWluLCBpb3ZhKTsKPiArCj4gKwlpZiAoV0FS
Tl9PTighbWFwKSkKPiArCQlyZXR1cm47Cj4gKwo+ICsJaWYgKGRpciA9PSBETUFfRlJPTV9ERVZJ
Q0UpCj4gKwkJdmR1c2VfZG9tYWluX2JvdW5jZShkb21haW4sIGlvdmEsIG1hcC0+b3JpZywgc2l6
ZSwgZGlyKTsKPiArCXZkdXNlX2RvbWFpbl9yZW1vdmVfbWFwcGluZyhkb21haW4sIG1hcCk7Cj4g
Kwl2ZHVzZV9kb21haW5fZnJlZV9pb3ZhKGRvbWFpbiwgaW92YSwgc2l6ZSk7Cj4gKwlrZnJlZSht
YXApOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCAqdmR1c2VfZGV2X2FsbG9jX2NvaGVyZW50KHN0
cnVjdCBkZXZpY2UgKmRldiwgc2l6ZV90IHNpemUsCj4gKwkJCQkJZG1hX2FkZHJfdCAqZG1hX2Fk
ZHIsIGdmcF90IGZsYWcsCj4gKwkJCQkJdW5zaWduZWQgbG9uZyBhdHRycykKPiArewo+ICsJc3Ry
dWN0IHZkdXNlX2RldiAqdmRldiA9IGRldl90b192ZHVzZShkZXYpOwo+ICsJc3RydWN0IHZkdXNl
X2lvdmFfZG9tYWluICpkb21haW4gPSB2ZGV2LT5kb21haW47Cj4gKwl1bnNpZ25lZCBsb25nIGlv
dmEgPSB2ZHVzZV9kb21haW5fYWxsb2NfaW92YShkb21haW4sIHNpemUsCj4gKwkJCQkJCQlUWVBF
X0RJUkVDVF9NQVApOwo+ICsJdm9pZCAqb3JpZyA9IGFsbG9jX3BhZ2VzX2V4YWN0KHNpemUsIGZs
YWcpOwo+ICsKPiArCWlmICghaW92YSB8fCAhb3JpZykKPiArCQlnb3RvIGVycjsKPiArCj4gKwlp
ZiAodmR1c2VfZG9tYWluX2FkZF9tYXBwaW5nKGRvbWFpbiwgaW92YSwKPiArCQkJCSh1bnNpZ25l
ZCBsb25nKW9yaWcsIHNpemUsIERNQV9CSURJUkVDVElPTkFMKSkKPiArCQlnb3RvIGVycjsKPiAr
Cj4gKwkqZG1hX2FkZHIgPSAoZG1hX2FkZHJfdClpb3ZhOwo+ICsKPiArCXJldHVybiBvcmlnOwo+
ICtlcnI6Cj4gKwkqZG1hX2FkZHIgPSBETUFfTUFQUElOR19FUlJPUjsKPiArCWlmIChvcmlnKQo+
ICsJCWZyZWVfcGFnZXNfZXhhY3Qob3JpZywgc2l6ZSk7Cj4gKwlpZiAoaW92YSkKPiArCQl2ZHVz
ZV9kb21haW5fZnJlZV9pb3ZhKGRvbWFpbiwgaW92YSwgc2l6ZSk7Cj4gKwo+ICsJcmV0dXJuIE5V
TEw7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHZkdXNlX2Rldl9mcmVlX2NvaGVyZW50KHN0cnVj
dCBkZXZpY2UgKmRldiwgc2l6ZV90IHNpemUsCj4gKwkJCQkJdm9pZCAqdmFkZHIsIGRtYV9hZGRy
X3QgZG1hX2FkZHIsCj4gKwkJCQkJdW5zaWduZWQgbG9uZyBhdHRycykKPiArewo+ICsJc3RydWN0
IHZkdXNlX2RldiAqdmRldiA9IGRldl90b192ZHVzZShkZXYpOwo+ICsJc3RydWN0IHZkdXNlX2lv
dmFfZG9tYWluICpkb21haW4gPSB2ZGV2LT5kb21haW47Cj4gKwl1bnNpZ25lZCBsb25nIGlvdmEg
PSAodW5zaWduZWQgbG9uZylkbWFfYWRkcjsKPiArCXN0cnVjdCB2ZHVzZV9pb3ZhX21hcCAqbWFw
ID0gdmR1c2VfZG9tYWluX2dldF9tYXBwaW5nKGRvbWFpbiwgaW92YSk7Cj4gKwo+ICsJaWYgKFdB
Uk5fT04oIW1hcCkpCj4gKwkJcmV0dXJuOwo+ICsKPiArCXZkdXNlX2RvbWFpbl9yZW1vdmVfbWFw
cGluZyhkb21haW4sIG1hcCk7Cj4gKwl2ZHVzZV9kb21haW5fdW5tYXAoZG9tYWluLCBtYXAtPmlv
dmEsIFBBR0VfQUxJR04obWFwLT5zaXplKSk7Cj4gKwlmcmVlX3BhZ2VzX2V4YWN0KCh2b2lkICop
bWFwLT5vcmlnLCBtYXAtPnNpemUpOwo+ICsJdmR1c2VfZG9tYWluX2ZyZWVfaW92YShkb21haW4s
IG1hcC0+aW92YSwgbWFwLT5zaXplKTsKPiArCWtmcmVlKG1hcCk7Cj4gK30KPiArCj4gK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgZG1hX21hcF9vcHMgdmR1c2VfZGV2X2RtYV9vcHMgPSB7Cj4gKwkubWFw
X3BhZ2UgPSB2ZHVzZV9kZXZfbWFwX3BhZ2UsCj4gKwkudW5tYXBfcGFnZSA9IHZkdXNlX2Rldl91
bm1hcF9wYWdlLAo+ICsJLmFsbG9jID0gdmR1c2VfZGV2X2FsbG9jX2NvaGVyZW50LAo+ICsJLmZy
ZWUgPSB2ZHVzZV9kZXZfZnJlZV9jb2hlcmVudCwKPiArfTsKPiArCj4gK3N0YXRpYyB2b2lkIHZk
dXNlX2Rldl9tbWFwX29wZW4oc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpCj4gK3sKPiArCXN0
cnVjdCB2ZHVzZV9pb3ZhX2RvbWFpbiAqZG9tYWluID0gdm1hLT52bV9wcml2YXRlX2RhdGE7Cj4g
Kwo+ICsJaWYgKCF2ZHVzZV9kb21haW5fYWRkX3ZtYShkb21haW4sIHZtYSkpCj4gKwkJcmV0dXJu
Owo+ICsKPiArCXZtYS0+dm1fcHJpdmF0ZV9kYXRhID0gTlVMTDsKPiArfQo+ICsKPiArc3RhdGlj
IHZvaWQgdmR1c2VfZGV2X21tYXBfY2xvc2Uoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpCj4g
K3sKPiArCXN0cnVjdCB2ZHVzZV9pb3ZhX2RvbWFpbiAqZG9tYWluID0gdm1hLT52bV9wcml2YXRl
X2RhdGE7Cj4gKwo+ICsJaWYgKCFkb21haW4pCj4gKwkJcmV0dXJuOwo+ICsKPiArCXZkdXNlX2Rv
bWFpbl9yZW1vdmVfdm1hKGRvbWFpbiwgdm1hKTsKPiArfQo+ICsKPiArc3RhdGljIGludCB2ZHVz
ZV9kZXZfbW1hcF9zcGxpdChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSwgdW5zaWduZWQgbG9u
ZyBhZGRyKQo+ICt7Cj4gKwlyZXR1cm4gLUVQRVJNOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm1fZmF1
bHRfdCB2ZHVzZV9kZXZfbW1hcF9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKPiArewo+ICsJ
c3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEgPSB2bWYtPnZtYTsKPiArCXN0cnVjdCB2ZHVzZV9p
b3ZhX2RvbWFpbiAqZG9tYWluID0gdm1hLT52bV9wcml2YXRlX2RhdGE7Cj4gKwl1bnNpZ25lZCBs
b25nIGlvdmEgPSB2bWYtPmFkZHJlc3MgLSB2bWEtPnZtX3N0YXJ0Owo+ICsJaW50IHJldDsKPiAr
Cj4gKwlpZiAoIWRvbWFpbikKPiArCQlyZXR1cm4gVk1fRkFVTFRfU0lHQlVTOwo+ICsKPiArCWlm
ICh2ZHVzZV9kb21haW5faXNfZGlyZWN0X21hcChkb21haW4sIGlvdmEpKQo+ICsJCXJldCA9IHZk
dXNlX2RvbWFpbl9kaXJlY3RfbWFwKGRvbWFpbiwgdm1hLCBpb3ZhKTsKPiArCWVsc2UKPiArCQly
ZXQgPSB2ZHVzZV9kb21haW5fYm91bmNlX21hcChkb21haW4sIHZtYSwgaW92YSk7Cj4gKwo+ICsJ
aWYgKHJldCA9PSAtRU5PTUVNKQo+ICsJCXJldHVybiBWTV9GQVVMVF9PT007Cj4gKwlpZiAocmV0
IDwgMCAmJiByZXQgIT0gLUVCVVNZKQo+ICsJCXJldHVybiBWTV9GQVVMVF9TSUdCVVM7Cj4gKwo+
ICsJcmV0dXJuIFZNX0ZBVUxUX05PUEFHRTsKPiArfQo+ICsKPiArc3RhdGljIGNvbnN0IHN0cnVj
dCB2bV9vcGVyYXRpb25zX3N0cnVjdCB2ZHVzZV9kZXZfbW1hcF9vcHMgPSB7Cj4gKwkub3BlbiA9
IHZkdXNlX2Rldl9tbWFwX29wZW4sCj4gKwkuY2xvc2UgPSB2ZHVzZV9kZXZfbW1hcF9jbG9zZSwK
PiArCS5tYXlfc3BsaXQgPSB2ZHVzZV9kZXZfbW1hcF9zcGxpdCwKPiArCS5mYXVsdCA9IHZkdXNl
X2Rldl9tbWFwX2ZhdWx0LAo+ICt9Owo+ICsKPiArc3RhdGljIGludCB2ZHVzZV9kZXZfbW1hcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpCj4gK3sKPiArCXN0
cnVjdCB2ZHVzZV9kZXYgKmRldiA9IGZpbGUtPnByaXZhdGVfZGF0YTsKPiArCXN0cnVjdCB2ZHVz
ZV9pb3ZhX2RvbWFpbiAqZG9tYWluID0gZGV2LT5kb21haW47Cj4gKwl1bnNpZ25lZCBsb25nIHNp
emUgPSB2bWEtPnZtX2VuZCAtIHZtYS0+dm1fc3RhcnQ7Cj4gKwlpbnQgcmV0Owo+ICsKPiArCWlm
IChkb21haW4tPnNpemUgIT0gc2l6ZSB8fCB2bWEtPnZtX3Bnb2ZmKQo+ICsJCXJldHVybiAtRUlO
VkFMOwo+ICsKPiArCXJldCA9IHZkdXNlX2RvbWFpbl9hZGRfdm1hKGRvbWFpbiwgdm1hKTsKPiAr
CWlmIChyZXQpCj4gKwkJcmV0dXJuIHJldDsKPiArCj4gKwl2bWEtPnZtX2ZsYWdzIHw9IFZNX01J
WEVETUFQIHwgVk1fRE9OVENPUFkgfAo+ICsJCQkJVk1fRE9OVERVTVAgfCBWTV9ET05URVhQQU5E
Owo+ICsJdm1hLT52bV9wcml2YXRlX2RhdGEgPSBkb21haW47Cj4gKwl2bWEtPnZtX29wcyA9ICZ2
ZHVzZV9kZXZfbW1hcF9vcHM7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBs
b25nIHZkdXNlX2Rldl9pb2N0bChzdHJ1Y3QgZmlsZSAqZmlsZSwgdW5zaWduZWQgaW50IGNtZCwK
PiArCQkJdW5zaWduZWQgbG9uZyBhcmcpCj4gK3sKPiArCXN0cnVjdCB2ZHVzZV9kZXYgKmRldiA9
IGZpbGUtPnByaXZhdGVfZGF0YTsKPiArCXZvaWQgX191c2VyICphcmdwID0gKHZvaWQgX191c2Vy
ICopYXJnOwo+ICsJaW50IHJldDsKPiArCj4gKwltdXRleF9sb2NrKCZkZXYtPmxvY2spOwo+ICsJ
c3dpdGNoIChjbWQpIHsKPiArCWNhc2UgVkRVU0VfVlFfU0VUVVBfS0lDS0ZEOiB7Cj4gKwkJc3Ry
dWN0IHZkdXNlX3ZxX2V2ZW50ZmQgZXZlbnRmZDsKPiArCj4gKwkJcmV0ID0gLUVGQVVMVDsKPiAr
CQlpZiAoY29weV9mcm9tX3VzZXIoJmV2ZW50ZmQsIGFyZ3AsIHNpemVvZihldmVudGZkKSkpCj4g
KwkJCWJyZWFrOwo+ICsKPiArCQlyZXQgPSB2ZHVzZV9raWNrZmRfc2V0dXAoZGV2LCAmZXZlbnRm
ZCk7Cj4gKwkJYnJlYWs7Cj4gKwl9Cj4gKwljYXNlIFZEVVNFX1ZRX1NFVFVQX0lSUUZEOiB7Cj4g
KwkJc3RydWN0IHZkdXNlX3ZxX2V2ZW50ZmQgZXZlbnRmZDsKPiArCj4gKwkJcmV0ID0gLUVGQVVM
VDsKPiArCQlpZiAoY29weV9mcm9tX3VzZXIoJmV2ZW50ZmQsIGFyZ3AsIHNpemVvZihldmVudGZk
KSkpCj4gKwkJCWJyZWFrOwo+ICsKPiArCQlyZXQgPSB2ZHVzZV92aXJxZmRfc2V0dXAoZGV2LCAm
ZXZlbnRmZCk7Cj4gKwkJYnJlYWs7Cj4gKwl9Cj4gKwl9Cj4gKwltdXRleF91bmxvY2soJmRldi0+
bG9jayk7Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3RhdGljIGludCB2ZHVzZV9k
ZXZfcmVsZWFzZShzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKPiArewo+
ICsJc3RydWN0IHZkdXNlX2RldiAqZGV2ID0gZmlsZS0+cHJpdmF0ZV9kYXRhOwo+ICsJc3RydWN0
IHZkdXNlX2Rldl9tc2cgKm1zZzsKPiArCj4gKwl3aGlsZSAoKG1zZyA9IHZkdXNlX2Rldl9kZXF1
ZXVlX21zZyhkZXYsICZkZXYtPnJlY3ZfbGlzdCkpKQo+ICsJCXZkdXNlX2Rldl9lbnF1ZXVlX21z
ZyhkZXYsIG1zZywgJmRldi0+c2VuZF9saXN0KTsKPiArCj4gKwlyZWZjb3VudF9kZWMoJmRldi0+
cmVmY250KTsKPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGNvbnN0IHN0cnVj
dCBmaWxlX29wZXJhdGlvbnMgdmR1c2VfZGV2X2ZvcHMgPSB7Cj4gKwkub3duZXIJCT0gVEhJU19N
T0RVTEUsCj4gKwkucmVsZWFzZQk9IHZkdXNlX2Rldl9yZWxlYXNlLAo+ICsJLnJlYWRfaXRlcgk9
IHZkdXNlX2Rldl9yZWFkX2l0ZXIsCj4gKwkud3JpdGVfaXRlcgk9IHZkdXNlX2Rldl93cml0ZV9p
dGVyLAo+ICsJLnBvbGwJCT0gdmR1c2VfZGV2X3BvbGwsCj4gKwkubW1hcAkJPSB2ZHVzZV9kZXZf
bW1hcCwKPiArCS51bmxvY2tlZF9pb2N0bAk9IHZkdXNlX2Rldl9pb2N0bCwKPiArCS5jb21wYXRf
aW9jdGwJPSBjb21wYXRfcHRyX2lvY3RsLAo+ICsJLmxsc2VlawkJPSBub29wX2xsc2VlaywKPiAr
fTsKPiArCj4gK3N0YXRpYyBzdHJ1Y3QgdmR1c2VfZGV2ICp2ZHVzZV9kZXZfY3JlYXRlKHZvaWQp
Cj4gK3sKPiArCXN0cnVjdCB2ZHVzZV9kZXYgKmRldiA9IGt6YWxsb2Moc2l6ZW9mKCpkZXYpLCBH
RlBfS0VSTkVMKTsKPiArCj4gKwlpZiAoIWRldikKPiArCQlyZXR1cm4gTlVMTDsKPiArCj4gKwlt
dXRleF9pbml0KCZkZXYtPmxvY2spOwo+ICsJc3Bpbl9sb2NrX2luaXQoJmRldi0+bXNnX2xvY2sp
Owo+ICsJSU5JVF9MSVNUX0hFQUQoJmRldi0+c2VuZF9saXN0KTsKPiArCUlOSVRfTElTVF9IRUFE
KCZkZXYtPnJlY3ZfbGlzdCk7Cj4gKwlhdG9taWM2NF9zZXQoJmRldi0+bXNnX3VuaXF1ZSwgMCk7
Cj4gKwlpbml0X3dhaXRxdWV1ZV9oZWFkKCZkZXYtPndhaXRxKTsKPiArCXJlZmNvdW50X3NldCgm
ZGV2LT5yZWZjbnQsIDEpOwo+ICsKPiArCXJldHVybiBkZXY7Cj4gK30KPiArCj4gK3N0YXRpYyB2
b2lkIHZkdXNlX2Rldl9kZXN0cm95KHN0cnVjdCB2ZHVzZV9kZXYgKmRldikKPiArewo+ICsJbXV0
ZXhfZGVzdHJveSgmZGV2LT5sb2NrKTsKPiArCWtmcmVlKGRldik7Cj4gK30KPiArCj4gK3N0YXRp
YyBzdHJ1Y3QgdmR1c2VfZGV2ICp2ZHVzZV9maW5kX2Rldih1MzIgaWQpCj4gK3sKPiArCXN0cnVj
dCB2ZHVzZV9kZXYgKnRtcCwgKmRldiA9IE5VTEw7Cj4gKwo+ICsJbGlzdF9mb3JfZWFjaF9lbnRy
eSh0bXAsICZ2ZHVzZV9kZXZzLCBsaXN0KSB7Cj4gKwkJaWYgKHRtcC0+aWQgPT0gaWQpIHsKPiAr
CQkJZGV2ID0gdG1wOwo+ICsJCQlicmVhazsKPiArCQl9Cj4gKwl9Cj4gKwlyZXR1cm4gZGV2Owo+
ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZkdXNlX2dldF9kZXYodTMyIGlkKQo+ICt7Cj4gKwlpbnQg
ZmQ7Cj4gKwljaGFyIG5hbWVbNjRdOwo+ICsJc3RydWN0IHZkdXNlX2RldiAqZGV2ID0gdmR1c2Vf
ZmluZF9kZXYoaWQpOwo+ICsKPiArCWlmICghZGV2KQo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsK
PiArCXNucHJpbnRmKG5hbWUsIHNpemVvZihuYW1lKSwgInZkdXNlLWRldjoldSIsIGRldi0+aWQp
Owo+ICsJZmQgPSBhbm9uX2lub2RlX2dldGZkKG5hbWUsICZ2ZHVzZV9kZXZfZm9wcywgZGV2LCBP
X1JEV1IgfCBPX0NMT0VYRUMpOwo+ICsJaWYgKGZkIDwgMCkKPiArCQlyZXR1cm4gZmQ7Cj4gKwo+
ICsJcmVmY291bnRfaW5jKCZkZXYtPnJlZmNudCk7Cj4gKwo+ICsJcmV0dXJuIGZkOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgaW50IHZkdXNlX2Rlc3Ryb3lfZGV2KHUzMiBpZCkKPiArewo+ICsJc3RydWN0
IHZkdXNlX2RldiAqZGV2ID0gdmR1c2VfZmluZF9kZXYoaWQpOwo+ICsKPiArCWlmICghZGV2KQo+
ICsJCXJldHVybiAtRUlOVkFMOwo+ICsKPiArCWlmIChkZXYtPnZkZXYgfHwgcmVmY291bnRfcmVh
ZCgmZGV2LT5yZWZjbnQpID4gMSkKPiArCQlyZXR1cm4gLUVCVVNZOwo+ICsKPiArCWxpc3RfZGVs
KCZkZXYtPmxpc3QpOwo+ICsJa2ZyZWUoZGV2LT52cXMpOwo+ICsJdmR1c2VfaW92YV9kb21haW5f
ZGVzdHJveShkZXYtPmRvbWFpbik7Cj4gKwl2ZHVzZV9kZXZfZGVzdHJveShkZXYpOwo+ICsKPiAr
CXJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZkdXNlX2NyZWF0ZV9kZXYoc3RydWN0
IHZkdXNlX2Rldl9jb25maWcgKmNvbmZpZykKPiArewo+ICsJaW50IGksIGZkOwo+ICsJc3RydWN0
IHZkdXNlX2RldiAqZGV2Owo+ICsJY2hhciBuYW1lWzY0XTsKPiArCj4gKwlpZiAodmR1c2VfZmlu
ZF9kZXYoY29uZmlnLT5pZCkpCj4gKwkJcmV0dXJuIC1FRVhJU1Q7Cj4gKwo+ICsJZGV2ID0gdmR1
c2VfZGV2X2NyZWF0ZSgpOwo+ICsJaWYgKCFkZXYpCj4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gKwo+
ICsJZGV2LT5pZCA9IGNvbmZpZy0+aWQ7Cj4gKwlkZXYtPmRldmljZV9pZCA9IGNvbmZpZy0+ZGV2
aWNlX2lkOwo+ICsJZGV2LT52ZW5kb3JfaWQgPSBjb25maWctPnZlbmRvcl9pZDsKPiArCWRldi0+
ZG9tYWluID0gdmR1c2VfaW92YV9kb21haW5fY3JlYXRlKGNvbmZpZy0+aW92YV9zaXplKTsKPiAr
CWlmICghZGV2LT5kb21haW4pCj4gKwkJZ290byBlcnJfZG9tYWluOwo+ICsKPiArCWRldi0+dnFf
YWxpZ24gPSBjb25maWctPnZxX2FsaWduOwo+ICsJZGV2LT52cV9zaXplX21heCA9IGNvbmZpZy0+
dnFfc2l6ZV9tYXg7Cj4gKwlkZXYtPnZxX251bSA9IGNvbmZpZy0+dnFfbnVtOwo+ICsJZGV2LT52
cXMgPSBrY2FsbG9jKGRldi0+dnFfbnVtLCBzaXplb2YoKmRldi0+dnFzKSwgR0ZQX0tFUk5FTCk7
Cj4gKwlpZiAoIWRldi0+dnFzKQo+ICsJCWdvdG8gZXJyX3ZxczsKPiArCj4gKwlmb3IgKGkgPSAw
OyBpIDwgZGV2LT52cV9udW07IGkrKykgewo+ICsJCWRldi0+dnFzW2ldLmluZGV4ID0gaTsKPiAr
CQlzcGluX2xvY2tfaW5pdCgmZGV2LT52cXNbaV0ua2lja19sb2NrKTsKPiArCQlzcGluX2xvY2tf
aW5pdCgmZGV2LT52cXNbaV0uaXJxX2xvY2spOwo+ICsJfQo+ICsKPiArCXNucHJpbnRmKG5hbWUs
IHNpemVvZihuYW1lKSwgInZkdXNlLWRldjoldSIsIGNvbmZpZy0+aWQpOwo+ICsJZmQgPSBhbm9u
X2lub2RlX2dldGZkKG5hbWUsICZ2ZHVzZV9kZXZfZm9wcywgZGV2LCBPX1JEV1IgfCBPX0NMT0VY
RUMpOwo+ICsJaWYgKGZkIDwgMCkKPiArCQlnb3RvIGVycl9mZDsKPiArCj4gKwlyZWZjb3VudF9p
bmMoJmRldi0+cmVmY250KTsKPiArCWxpc3RfYWRkKCZkZXYtPmxpc3QsICZ2ZHVzZV9kZXZzKTsK
PiArCj4gKwlyZXR1cm4gZmQ7Cj4gK2Vycl9mZDoKPiArCWtmcmVlKGRldi0+dnFzKTsKPiArZXJy
X3ZxczoKPiArCXZkdXNlX2lvdmFfZG9tYWluX2Rlc3Ryb3koZGV2LT5kb21haW4pOwo+ICtlcnJf
ZG9tYWluOgo+ICsJdmR1c2VfZGV2X2Rlc3Ryb3koZGV2KTsKPiArCXJldHVybiBmZDsKPiArfQo+
ICsKPiArc3RhdGljIGxvbmcgdmR1c2VfaW9jdGwoc3RydWN0IGZpbGUgKmZpbGUsIHVuc2lnbmVk
IGludCBjbWQsCj4gKwkJCXVuc2lnbmVkIGxvbmcgYXJnKQo+ICt7Cj4gKwlpbnQgcmV0Owo+ICsJ
dm9pZCBfX3VzZXIgKmFyZ3AgPSAodm9pZCBfX3VzZXIgKilhcmc7Cj4gKwo+ICsJbXV0ZXhfbG9j
aygmdmR1c2VfbG9jayk7Cj4gKwlzd2l0Y2ggKGNtZCkgewo+ICsJY2FzZSBWRFVTRV9DUkVBVEVf
REVWOiB7Cj4gKwkJc3RydWN0IHZkdXNlX2Rldl9jb25maWcgY29uZmlnOwo+ICsKPiArCQlyZXQg
PSAtRUZBVUxUOwo+ICsJCWlmIChjb3B5X2Zyb21fdXNlcigmY29uZmlnLCBhcmdwLCBzaXplb2Yo
Y29uZmlnKSkpCj4gKwkJCWJyZWFrOwo+ICsKPiArCQlyZXQgPSB2ZHVzZV9jcmVhdGVfZGV2KCZj
b25maWcpOwo+ICsJCWJyZWFrOwo+ICsJfQo+ICsJY2FzZSBWRFVTRV9HRVRfREVWOgo+ICsJCXJl
dCA9IHZkdXNlX2dldF9kZXYoYXJnKTsKPiArCQlicmVhazsKCgpXaGF0J3MgdGhlIHVzZSBjYXNl
IG9mIFZEVVNFX0dFVF9ERVY/IChOZWVkIHRvIGRvY3VtZW50IHRoaXMpCgoKPiArCWNhc2UgVkRV
U0VfREVTVFJPWV9ERVY6Cj4gKwkJcmV0ID0gdmR1c2VfZGVzdHJveV9kZXYoYXJnKTsKPiArCQli
cmVhazsKPiArCWRlZmF1bHQ6Cj4gKwkJcmV0ID0gLUVJTlZBTDsKPiArCQlicmVhazsKPiArCX0K
PiArCW11dGV4X3VubG9jaygmdmR1c2VfbG9jayk7Cj4gKwo+ICsJcmV0dXJuIHJldDsKPiArfQo+
ICsKPiArc3RhdGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgdmR1c2VfZm9wcyA9IHsK
PiArCS5vd25lcgkJPSBUSElTX01PRFVMRSwKPiArCS51bmxvY2tlZF9pb2N0bAk9IHZkdXNlX2lv
Y3RsLAo+ICsJLmNvbXBhdF9pb2N0bAk9IGNvbXBhdF9wdHJfaW9jdGwsCj4gKwkubGxzZWVrCQk9
IG5vb3BfbGxzZWVrLAo+ICt9Owo+ICsKPiArc3RhdGljIHN0cnVjdCBtaXNjZGV2aWNlIHZkdXNl
X21pc2MgPSB7Cj4gKwkuZm9wcyA9ICZ2ZHVzZV9mb3BzLAo+ICsJLm1pbm9yID0gTUlTQ19EWU5B
TUlDX01JTk9SLAo+ICsJLm5hbWUgPSAidmR1c2UiLAo+ICt9Owo+ICsKPiArc3RhdGljIHZvaWQg
dmR1c2VfcGFyZW50X3JlbGVhc2Uoc3RydWN0IGRldmljZSAqZGV2KQo+ICt7Cj4gK30KPiArCj4g
K3N0YXRpYyBzdHJ1Y3QgZGV2aWNlIHZkdXNlX3BhcmVudCA9IHsKPiArCS5pbml0X25hbWUgPSAi
dmR1c2UiLAo+ICsJLnJlbGVhc2UgPSB2ZHVzZV9wYXJlbnRfcmVsZWFzZSwKPiArfTsKPiArCj4g
K3N0YXRpYyBzdHJ1Y3QgdmRwYV9wYXJlbnRfZGV2IHBhcmVudF9kZXY7Cj4gKwo+ICtzdGF0aWMg
aW50IHZkdXNlX2Rldl9hZGRfdmRwYShzdHJ1Y3QgdmR1c2VfZGV2ICpkZXYsIGNvbnN0IGNoYXIg
Km5hbWUpCj4gK3sKPiArCXN0cnVjdCB2ZHVzZV92ZHBhICp2ZGV2ID0gZGV2LT52ZGV2Owo+ICsJ
aW50IHJldDsKPiArCj4gKwlpZiAodmRldikKPiArCQlyZXR1cm4gLUVFWElTVDsKPiArCj4gKwl2
ZGV2ID0gdmRwYV9hbGxvY19kZXZpY2Uoc3RydWN0IHZkdXNlX3ZkcGEsIHZkcGEsIE5VTEwsCj4g
KwkJCQkmdmR1c2VfdmRwYV9jb25maWdfb3BzLCBkZXYtPnZxX251bSwgbmFtZSk7Cj4gKwlpZiAo
IXZkZXYpCj4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsJdmRldi0+ZGV2ID0gZGV2Owo+ICsJ
dmRldi0+dmRwYS5kZXYuZG1hX21hc2sgPSAmdmRldi0+dmRwYS5kZXYuY29oZXJlbnRfZG1hX21h
c2s7Cj4gKwlyZXQgPSBkbWFfc2V0X21hc2tfYW5kX2NvaGVyZW50KCZ2ZGV2LT52ZHBhLmRldiwg
RE1BX0JJVF9NQVNLKDY0KSk7Cj4gKwlpZiAocmV0KQo+ICsJCWdvdG8gZXJyOwo+ICsKPiArCXNl
dF9kbWFfb3BzKCZ2ZGV2LT52ZHBhLmRldiwgJnZkdXNlX2Rldl9kbWFfb3BzKTsKPiArCXZkZXYt
PnZkcGEuZG1hX2RldiA9ICZ2ZGV2LT52ZHBhLmRldjsKPiArCXZkZXYtPnZkcGEucGRldiA9ICZw
YXJlbnRfZGV2Owo+ICsKPiArCXJldCA9IF92ZHBhX3JlZ2lzdGVyX2RldmljZSgmdmRldi0+dmRw
YSk7Cj4gKwlpZiAocmV0KQo+ICsJCWdvdG8gZXJyOwo+ICsKPiArCWRldi0+dmRldiA9IHZkZXY7
Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK2VycjoKPiArCXB1dF9kZXZpY2UoJnZkZXYtPnZkcGEuZGV2
KTsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gK3N0YXRpYyBzdHJ1Y3QgdmRwYV9kZXZpY2Ug
KnZkcGFfZGV2X2FkZChzdHJ1Y3QgdmRwYV9wYXJlbnRfZGV2ICpwZGV2LAo+ICsJCQkJCWNvbnN0
IGNoYXIgKm5hbWUsIHUzMiBkZXZpY2VfaWQsCj4gKwkJCQkJc3RydWN0IG5sYXR0ciAqKmF0dHJz
KQo+ICt7Cj4gKwl1MzIgdmR1c2VfaWQ7Cj4gKwlzdHJ1Y3QgdmR1c2VfZGV2ICpkZXY7Cj4gKwlp
bnQgcmV0ID0gLUVJTlZBTDsKPiArCj4gKwlpZiAoIWF0dHJzW1ZEUEFfQVRUUl9CQUNLRU5EX0lE
XSkKPiArCQlyZXR1cm4gRVJSX1BUUigtRUlOVkFMKTsKPiArCj4gKwltdXRleF9sb2NrKCZ2ZHVz
ZV9sb2NrKTsKPiArCXZkdXNlX2lkID0gbmxhX2dldF91MzIoYXR0cnNbVkRQQV9BVFRSX0JBQ0tF
TkRfSURdKTsKPiArCWRldiA9IHZkdXNlX2ZpbmRfZGV2KHZkdXNlX2lkKTsKPiArCWlmICghZGV2
KQo+ICsJCWdvdG8gdW5sb2NrOwo+ICsKPiArCWlmIChkZXYtPmRldmljZV9pZCAhPSBkZXZpY2Vf
aWQpCj4gKwkJZ290byB1bmxvY2s7Cj4gKwo+ICsJcmV0ID0gdmR1c2VfZGV2X2FkZF92ZHBhKGRl
diwgbmFtZSk7Cj4gK3VubG9jazoKPiArCW11dGV4X3VubG9jaygmdmR1c2VfbG9jayk7Cj4gKwlp
ZiAocmV0KQo+ICsJCXJldHVybiBFUlJfUFRSKHJldCk7Cj4gKwo+ICsJcmV0dXJuICZkZXYtPnZk
ZXYtPnZkcGE7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHZkcGFfZGV2X2RlbChzdHJ1Y3QgdmRw
YV9wYXJlbnRfZGV2ICpwZGV2LCBzdHJ1Y3QgdmRwYV9kZXZpY2UgKmRldikKPiArewo+ICsJX3Zk
cGFfdW5yZWdpc3Rlcl9kZXZpY2UoZGV2KTsKPiArfQo+ICsKPiArc3RhdGljIGNvbnN0IHN0cnVj
dCB2ZHBhX2Rldl9vcHMgdmRwYV9kZXZfcGFyZW50X29wcyA9IHsKPiArCS5kZXZfYWRkID0gdmRw
YV9kZXZfYWRkLAo+ICsJLmRldl9kZWwgPSB2ZHBhX2Rldl9kZWwKPiArfTsKPiArCj4gK3N0YXRp
YyBzdHJ1Y3QgdmlydGlvX2RldmljZV9pZCBpZF90YWJsZVtdID0gewo+ICsJeyBWSVJUSU9fREVW
X0FOWV9JRCwgVklSVElPX0RFVl9BTllfSUQgfSwKPiArCXsgMCB9LAo+ICt9Owo+ICsKPiArc3Rh
dGljIHN0cnVjdCB2ZHBhX3BhcmVudF9kZXYgcGFyZW50X2RldiA9IHsKPiArCS5kZXZpY2UgPSAm
dmR1c2VfcGFyZW50LAo+ICsJLmlkX3RhYmxlID0gaWRfdGFibGUsCj4gKwkub3BzID0gJnZkcGFf
ZGV2X3BhcmVudF9vcHMsCj4gK307Cj4gKwo+ICtzdGF0aWMgaW50IHZkdXNlX3BhcmVudGRldl9p
bml0KHZvaWQpCj4gK3sKPiArCWludCByZXQ7Cj4gKwo+ICsJcmV0ID0gZGV2aWNlX3JlZ2lzdGVy
KCZ2ZHVzZV9wYXJlbnQpOwo+ICsJaWYgKHJldCkKPiArCQlyZXR1cm4gcmV0Owo+ICsKPiArCXJl
dCA9IHZkcGFfcGFyZW50ZGV2X3JlZ2lzdGVyKCZwYXJlbnRfZGV2KTsKPiArCWlmIChyZXQpCj4g
KwkJZ290byBlcnI7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK2VycjoKPiArCWRldmljZV91bnJlZ2lz
dGVyKCZ2ZHVzZV9wYXJlbnQpOwo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3RhdGljIHZv
aWQgdmR1c2VfcGFyZW50ZGV2X2V4aXQodm9pZCkKPiArewo+ICsJdmRwYV9wYXJlbnRkZXZfdW5y
ZWdpc3RlcigmcGFyZW50X2Rldik7Cj4gKwlkZXZpY2VfdW5yZWdpc3RlcigmdmR1c2VfcGFyZW50
KTsKPiArfQo+ICsKPiArc3RhdGljIGludCB2ZHVzZV9pbml0KHZvaWQpCj4gK3sKPiArCWludCBy
ZXQ7Cj4gKwo+ICsJcmV0ID0gbWlzY19yZWdpc3RlcigmdmR1c2VfbWlzYyk7Cj4gKwlpZiAocmV0
KQo+ICsJCXJldHVybiByZXQ7Cj4gKwo+ICsJcmV0ID0gLUVOT01FTTsKPiArCXZkdXNlX3ZkcGFf
d3EgPSBhbGxvY193b3JrcXVldWUoInZkdXNlLXZkcGEiLCBXUV9VTkJPVU5ELCAxKTsKPiArCWlm
ICghdmR1c2VfdmRwYV93cSkKPiArCQlnb3RvIGVycl92ZHBhX3dxOwo+ICsKPiArCXJldCA9IHZk
dXNlX3ZpcnFmZF9pbml0KCk7Cj4gKwlpZiAocmV0KQo+ICsJCWdvdG8gZXJyX2lycWZkOwo+ICsK
PiArCXJldCA9IHZkdXNlX3BhcmVudGRldl9pbml0KCk7Cj4gKwlpZiAocmV0KQo+ICsJCWdvdG8g
ZXJyX3BhcmVudGRldjsKPiArCj4gKwlyZXR1cm4gMDsKPiArZXJyX3BhcmVudGRldjoKPiArCXZk
dXNlX3ZpcnFmZF9leGl0KCk7Cj4gK2Vycl9pcnFmZDoKPiArCWRlc3Ryb3lfd29ya3F1ZXVlKHZk
dXNlX3ZkcGFfd3EpOwo+ICtlcnJfdmRwYV93cToKPiArCW1pc2NfZGVyZWdpc3RlcigmdmR1c2Vf
bWlzYyk7Cj4gKwlyZXR1cm4gcmV0Owo+ICt9Cj4gK21vZHVsZV9pbml0KHZkdXNlX2luaXQpOwo+
ICsKPiArc3RhdGljIHZvaWQgdmR1c2VfZXhpdCh2b2lkKQo+ICt7Cj4gKwltaXNjX2RlcmVnaXN0
ZXIoJnZkdXNlX21pc2MpOwo+ICsJZGVzdHJveV93b3JrcXVldWUodmR1c2VfdmRwYV93cSk7Cj4g
Kwl2ZHVzZV92aXJxZmRfZXhpdCgpOwo+ICsJdmR1c2VfcGFyZW50ZGV2X2V4aXQoKTsKPiArfQo+
ICttb2R1bGVfZXhpdCh2ZHVzZV9leGl0KTsKPiArCj4gK01PRFVMRV9WRVJTSU9OKERSVl9WRVJT
SU9OKTsKPiArTU9EVUxFX0xJQ0VOU0UoRFJWX0xJQ0VOU0UpOwo+ICtNT0RVTEVfQVVUSE9SKERS
Vl9BVVRIT1IpOwo+ICtNT0RVTEVfREVTQ1JJUFRJT04oRFJWX0RFU0MpOwo+IGRpZmYgLS1naXQg
YS9pbmNsdWRlL3VhcGkvbGludXgvdmRwYS5oIGIvaW5jbHVkZS91YXBpL2xpbnV4L3ZkcGEuaAo+
IGluZGV4IGJiYThiODNhOTRiNS4uYTdhODQxZTVmZmM3IDEwMDY0NAo+IC0tLSBhL2luY2x1ZGUv
dWFwaS9saW51eC92ZHBhLmgKPiArKysgYi9pbmNsdWRlL3VhcGkvbGludXgvdmRwYS5oCj4gQEAg
LTMzLDYgKzMzLDcgQEAgZW51bSB2ZHBhX2F0dHIgewo+ICAgCVZEUEFfQVRUUl9ERVZfVkVORE9S
X0lELAkJLyogdTMyICovCj4gICAJVkRQQV9BVFRSX0RFVl9NQVhfVlFTLAkJCS8qIHUzMiAqLwo+
ICAgCVZEUEFfQVRUUl9ERVZfTUFYX1ZRX1NJWkUsCQkvKiB1MTYgKi8KPiArCVZEUEFfQVRUUl9C
QUNLRU5EX0lELAkJCS8qIHUzMiAqLwo+ICAgCj4gICAJLyogbmV3IGF0dHJpYnV0ZXMgbXVzdCBi
ZSBhZGRlZCBhYm92ZSBoZXJlICovCj4gICAJVkRQQV9BVFRSX01BWCwKPiBkaWZmIC0tZ2l0IGEv
aW5jbHVkZS91YXBpL2xpbnV4L3ZkdXNlLmggYi9pbmNsdWRlL3VhcGkvbGludXgvdmR1c2UuaAo+
IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gaW5kZXggMDAwMDAwMDAwMDAwLi5mODU3OWFiZGFhM2IK
PiAtLS0gL2Rldi9udWxsCj4gKysrIGIvaW5jbHVkZS91YXBpL2xpbnV4L3ZkdXNlLmgKPiBAQCAt
MCwwICsxLDk5IEBACj4gKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wIFdJVEgg
TGludXgtc3lzY2FsbC1ub3RlICovCj4gKyNpZm5kZWYgX1VBUElfVkRVU0VfSF8KPiArI2RlZmlu
ZSBfVUFQSV9WRFVTRV9IXwo+ICsKPiArI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Cj4gKwo+ICsv
KiB0aGUgY29udHJvbCBtZXNzYWdlcyBkZWZpbml0aW9uIGZvciByZWFkL3dyaXRlICovCj4gKwo+
ICsjZGVmaW5lIFZEVVNFX0NPTkZJR19EQVRBX0xFTgkyNTYKPiArCj4gK2VudW0gdmR1c2VfcmVx
X3R5cGUgewo+ICsJVkRVU0VfU0VUX1ZRX05VTSwKPiArCVZEVVNFX1NFVF9WUV9BRERSLAo+ICsJ
VkRVU0VfU0VUX1ZRX1JFQURZLAo+ICsJVkRVU0VfR0VUX1ZRX1JFQURZLAo+ICsJVkRVU0VfU0VU
X0ZFQVRVUkVTLAo+ICsJVkRVU0VfR0VUX0ZFQVRVUkVTLAo+ICsJVkRVU0VfU0VUX1NUQVRVUywK
PiArCVZEVVNFX0dFVF9TVEFUVVMsCj4gKwlWRFVTRV9TRVRfQ09ORklHLAo+ICsJVkRVU0VfR0VU
X0NPTkZJRywKPiArfTsKPiArCj4gK3N0cnVjdCB2ZHVzZV92cV9udW0gewo+ICsJX191MzIgaW5k
ZXg7Cj4gKwlfX3UzMiBudW07Cj4gK307Cj4gKwo+ICtzdHJ1Y3QgdmR1c2VfdnFfYWRkciB7Cj4g
KwlfX3UzMiBpbmRleDsKPiArCV9fdTY0IGRlc2NfYWRkcjsKPiArCV9fdTY0IGRyaXZlcl9hZGRy
Owo+ICsJX191NjQgZGV2aWNlX2FkZHI7Cj4gK307Cj4gKwo+ICtzdHJ1Y3QgdmR1c2VfdnFfcmVh
ZHkgewo+ICsJX191MzIgaW5kZXg7Cj4gKwlfX3U4IHJlYWR5Owo+ICt9Owo+ICsKPiArc3RydWN0
IHZkdXNlX2Rldl9jb25maWdfZGF0YSB7Cj4gKwlfX3UzMiBvZmZzZXQ7Cj4gKwlfX3UzMiBsZW47
Cj4gKwlfX3U4IGRhdGFbVkRVU0VfQ09ORklHX0RBVEFfTEVOXTsKPiArfTsKPiArCj4gK3N0cnVj
dCB2ZHVzZV9kZXZfcmVxdWVzdCB7Cj4gKwlfX3UzMiB0eXBlOyAvKiByZXF1ZXN0IHR5cGUgKi8K
PiArCV9fdTMyIHVuaXF1ZTsgLyogcmVxdWVzdCBpZCAqLwo+ICsJX191MzIgZmxhZ3M7IC8qIHJl
cXVlc3QgZmxhZ3MgKi8KPiArCV9fdTMyIHNpemU7IC8qIHRoZSBwYXlsb2FkIHNpemUgKi8KPiAr
CXVuaW9uIHsKPiArCQlzdHJ1Y3QgdmR1c2VfdnFfbnVtIHZxX251bTsgLyogdmlydHF1ZXVlIG51
bSAqLwo+ICsJCXN0cnVjdCB2ZHVzZV92cV9hZGRyIHZxX2FkZHI7IC8qIHZpcnRxdWV1ZSBhZGRy
ZXNzICovCj4gKwkJc3RydWN0IHZkdXNlX3ZxX3JlYWR5IHZxX3JlYWR5OyAvKiB2aXJ0cXVldWUg
cmVhZHkgc3RhdHVzICovCj4gKwkJc3RydWN0IHZkdXNlX2Rldl9jb25maWdfZGF0YSBjb25maWc7
IC8qIHZpcnRpbyBkZXZpY2UgY29uZmlnIHNwYWNlICovCj4gKwkJX191NjQgZmVhdHVyZXM7IC8q
IHZpcnRpbyBmZWF0dXJlcyAqLwo+ICsJCV9fdTggc3RhdHVzOyAvKiBkZXZpY2Ugc3RhdHVzICov
Cj4gKwl9Owo+ICt9Owo+ICsKPiArc3RydWN0IHZkdXNlX2Rldl9yZXNwb25zZSB7Cj4gKwlfX3Uz
MiB1bmlxdWU7IC8qIGNvcnJlc3BvbmRpbmcgcmVxdWVzdCBpZCAqLwo+ICsJX19zMzIgcmVzdWx0
OyAvKiB0aGUgcmVzdWx0IG9mIHJlcXVlc3QgKi8KPiArCXVuaW9uIHsKPiArCQlzdHJ1Y3QgdmR1
c2VfdnFfcmVhZHkgdnFfcmVhZHk7IC8qIHZpcnRxdWV1ZSByZWFkeSBzdGF0dXMgKi8KPiArCQlz
dHJ1Y3QgdmR1c2VfZGV2X2NvbmZpZ19kYXRhIGNvbmZpZzsgLyogdmlydGlvIGRldmljZSBjb25m
aWcgc3BhY2UgKi8KPiArCQlfX3U2NCBmZWF0dXJlczsgLyogdmlydGlvIGZlYXR1cmVzICovCj4g
KwkJX191OCBzdGF0dXM7IC8qIGRldmljZSBzdGF0dXMgKi8KPiArCX07Cj4gK307Cj4gKwo+ICsv
KiBpb2N0bHMgKi8KPiArCj4gK3N0cnVjdCB2ZHVzZV9kZXZfY29uZmlnIHsKPiArCV9fdTMyIGlk
OyAvKiB2ZHVzZSBkZXZpY2UgaWQgKi8KPiArCV9fdTMyIHZlbmRvcl9pZDsgLyogdmlydGlvIHZl
bmRvciBpZCAqLwo+ICsJX191MzIgZGV2aWNlX2lkOyAvKiB2aXJ0aW8gZGV2aWNlIGlkICovCj4g
KwlfX3U2NCBpb3ZhX3NpemU7IC8qIGlvdmEgc3BhY2Ugc2l6ZSwgdXNlZCBmb3IgbW1hcCgyKSAq
Lwo+ICsJX191MTYgdnFfbnVtOyAvKiB0aGUgbnVtYmVyIG9mIHZpcnRxdWV1ZXMgKi8KPiArCV9f
dTE2IHZxX3NpemVfbWF4OyAvKiB0aGUgbWF4IHNpemUgb2YgdmlydHF1ZXVlICovCj4gKwlfX3Uz
MiB2cV9hbGlnbjsgLyogdGhlIGFsbG9jYXRpb24gYWxpZ25tZW50IG9mIHZpcnRxdWV1ZSdzIG1l
dGFkYXRhICovCj4gK307Cj4gKwo+ICtzdHJ1Y3QgdmR1c2VfdnFfZXZlbnRmZCB7Cj4gKwlfX3Uz
MiBpbmRleDsgLyogdmlydHF1ZXVlIGluZGV4ICovCj4gKwlfX3UzMiBmZDsgLyogZXZlbnRmZCAq
Lwo+ICt9Owo+ICsKPiArI2RlZmluZSBWRFVTRV9CQVNFCTB4ODEKPiArCj4gKyNkZWZpbmUgVkRV
U0VfQ1JFQVRFX0RFVglfSU9XKFZEVVNFX0JBU0UsIDB4MDEsIHN0cnVjdCB2ZHVzZV9kZXZfY29u
ZmlnKQo+ICsjZGVmaW5lIFZEVVNFX0dFVF9ERVYJCV9JTyhWRFVTRV9CQVNFLCAweDAyKQo+ICsj
ZGVmaW5lIFZEVVNFX0RFU1RST1lfREVWCV9JTyhWRFVTRV9CQVNFLCAweDAzKQo+ICsKPiArI2Rl
ZmluZSBWRFVTRV9WUV9TRVRVUF9LSUNLRkQJX0lPVyhWRFVTRV9CQVNFLCAweDA0LCBzdHJ1Y3Qg
dmR1c2VfdnFfZXZlbnRmZCkKPiArI2RlZmluZSBWRFVTRV9WUV9TRVRVUF9JUlFGRAlfSU9XKFZE
VVNFX0JBU0UsIDB4MDUsIHN0cnVjdCB2ZHVzZV92cV9ldmVudGZkKQo+ICsKPiArI2VuZGlmIC8q
IF9VQVBJX1ZEVVNFX0hfICovCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmlydHVhbGl6YXRpb25AbGlz
dHMubGludXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51eGZvdW5kYXRpb24ub3Jn
L21haWxtYW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
