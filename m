Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 25282155E4E
	for <lists.virtualization@lfdr.de>; Fri,  7 Feb 2020 19:36:33 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id D832D8697C;
	Fri,  7 Feb 2020 18:36:31 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 0XdiBDNFpatc; Fri,  7 Feb 2020 18:36:28 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id AE43C869D7;
	Fri,  7 Feb 2020 18:36:16 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 9135DC013E;
	Fri,  7 Feb 2020 18:36:16 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 604B2C013E
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:36:06 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by hemlock.osuosl.org (Postfix) with ESMTP id 4DC8187FE3
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:36:06 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id UIzhhxYgDGQr
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:58 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by hemlock.osuosl.org (Postfix) with ESMTPS id 8A2E187F50
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:58 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 4D232305D343; Fri,  7 Feb 2020 20:16:40 +0200 (EET)
Received: from host.bbu.bitdefender.biz (unknown [195.210.4.22])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 3E2A73052073;
 Fri,  7 Feb 2020 20:16:40 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [RFC PATCH v7 37/78] KVM: introspection: add hook/unhook ioctls
Date: Fri,  7 Feb 2020 20:15:55 +0200
Message-Id: <20200207181636.1065-38-alazar@bitdefender.com>
In-Reply-To: <20200207181636.1065-1-alazar@bitdefender.com>
References: <20200207181636.1065-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <ncitu@bitdefender.com>,
 Sean Christopherson <sean.j.christopherson@intel.com>,
 virtualization@lists.linux-foundation.org,
 =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 =?UTF-8?q?Mircea=20C=C3=AErjaliu?= <mcirjaliu@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gaG9vaywgYSBuZXcgdGhyZWFkIGlzIGNyZWF0ZWQgdG8gaGFuZGxlIHRoZSBtZXNzYWdlcyBj
b21pbmcgZnJvbSB0aGUKaW50cm9zcGVjdGlvbiB0b29sIChjb21tYW5kcyBvciBldmVudCByZXBs
aWVzKS4KCkNvLWRldmVsb3BlZC1ieTogTWlyY2VhIEPDrnJqYWxpdSA8bWNpcmphbGl1QGJpdGRl
ZmVuZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogTWlyY2VhIEPDrnJqYWxpdSA8bWNpcmphbGl1QGJp
dGRlZmVuZGVyLmNvbT4KQ28tZGV2ZWxvcGVkLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5jaXR1QGJp
dGRlZmVuZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogTmljdciZb3IgQ8OuyJt1IDxuY2l0dUBiaXRk
ZWZlbmRlci5jb20+ClNpZ25lZC1vZmYtYnk6IEFkYWxiZXJ0IExhesSDciA8YWxhemFyQGJpdGRl
ZmVuZGVyLmNvbT4KLS0tCiBEb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2FwaS50eHQgICAgICAgICAg
ICAgICAgfCAgNDIgKysrKysKIGFyY2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5oICAgICAg
ICAgICAgICB8ICAgOCArCiBhcmNoL3g4Ni9rdm0vTWFrZWZpbGUgICAgICAgICAgICAgICAgICAg
ICAgICAgfCAgIDIgKy0KIGFyY2gveDg2L2t2bS94ODYuYyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB8ICAgNSArCiBpbmNsdWRlL2xpbnV4L2t2bV9ob3N0LmggICAgICAgICAgICAgICAgICAg
ICAgfCAgIDIgKwogaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaCAgICAgICAgICAgICAgICAgICAg
IHwgIDE3ICsrCiBpbmNsdWRlL3VhcGkvbGludXgva3ZtLmggICAgICAgICAgICAgICAgICAgICAg
fCAgMTAgKysKIGluY2x1ZGUvdWFwaS9saW51eC9rdm1pLmggICAgICAgICAgICAgICAgICAgICB8
ICAxMyArKwogdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL01ha2VmaWxlICAgICAgICAgIHwg
ICAxICsKIC4uLi90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jICB8ICA3
OCArKysrKysrKysKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jICAgICAgICAgICAgICAg
ICB8IDE0OCArKysrKysrKysrKysrKysrKysKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9p
bnQuaCAgICAgICAgICAgICB8ICAyMCArKysKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9t
c2cuYyAgICAgICAgICAgICB8ICAzOSArKysrKwogdmlydC9rdm0va3ZtX21haW4uYyAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHwgIDExICsrCiAxNCBmaWxlcyBjaGFuZ2VkLCAzOTUgaW5zZXJ0
aW9ucygrKSwgMSBkZWxldGlvbigtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGFyY2gveDg2L2luY2x1
ZGUvYXNtL2t2bWlfaG9zdC5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgaW5jbHVkZS91YXBpL2xpbnV4
L2t2bWkuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IHRvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94
ODZfNjQva3ZtaV90ZXN0LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCB2aXJ0L2t2bS9pbnRyb3NwZWN0
aW9uL2t2bWlfbXNnLmMKCmRpZmYgLS1naXQgYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2FwaS50
eHQgYi9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2FwaS50eHQKaW5kZXggZWJiMzdiMzRkY2ZjLi41
NDBkOTAxNWQ3MjYgMTAwNjQ0Ci0tLSBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0vYXBpLnR4dAor
KysgYi9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2FwaS50eHQKQEAgLTQxNjgsNiArNDE2OCw0OCBA
QCBUaGlzIGlvY3RsIGlzc3VlcyBhbiB1bHRyYXZpc29yIGNhbGwgdG8gdGVybWluYXRlIHRoZSBz
ZWN1cmUgZ3Vlc3QsCiB1bnBpbnMgdGhlIFZQQSBwYWdlcyBhbmQgcmVsZWFzZXMgYWxsIHRoZSBk
ZXZpY2UgcGFnZXMgdGhhdCBhcmUgdXNlZCB0bwogdHJhY2sgdGhlIHNlY3VyZSBwYWdlcyBieSBo
eXBlcnZpc29yLgogCis0LjEyMiBLVk1fSU5UUk9TUEVDVElPTl9IT09LCisKK0NhcGFiaWxpdHk6
IEtWTV9DQVBfSU5UUk9TUEVDVElPTgorQXJjaGl0ZWN0dXJlczogeDg2CitUeXBlOiB2bSBpb2N0
bAorUGFyYW1ldGVyczogc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uIChpbikKK1JldHVybnM6IDAg
b24gc3VjY2VzcywgYSBuZWdhdGl2ZSB2YWx1ZSBvbiBlcnJvcgorRXJyb3JzOgorICBFTk9NRU06
IG1lbW9yeSBhbGxvY2F0aW9uIGZhaWxlZAorICBFRVhJU1Q6IHRoZSBWTSBpcyBhbHJlYWR5IGlu
dHJvc3BlY3RlZAorICBFSU5WQUw6IHRoZSBmaWxlIGRlc2NyaXB0b3IgZG9lc24ndCBjb3JyZXNw
b25kIHRvIGFuIGFjdGl2ZSBzb2NrZXQKKyAgICAgICAgICBwYWRkaW5nIGlzIG5vdCB6ZXJvCisg
IEVQRVJNOiB0aGUgaW50cm9zcGVjdGlvbiBpcyBkaXNhYmxlZCAoa3ZtLmludHJvc3BlY3Rpb249
MCkKKworVGhpcyBpb2N0bCBpcyB1c2VkIHRvIGVuYWJsZSB0aGUgaW50cm9zcGVjdGlvbiBvZiB0
aGUgY3VycmVudCBWTS4KKworc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uIHsKKwlfX3MzMiBmZDsK
KwlfX3UzMiBwYWRkaW5nOworCV9fdTggdXVpZFsxNl07Cit9OworCitmZCBpcyB0aGUgZmlsZSBk
ZXNjcmlwdG9yIG9mIGEgc29ja2V0IGNvbm5lY3RlZCB0byB0aGUgaW50cm9zcGVjdGlvbiB0b29s
LAorCitwYWRkaW5nIG11c3QgYmUgemVybyAoaXQgbWlnaHQgYmUgdXNlZCBpbiB0aGUgZnV0dXJl
KSwKKwordXVpZCBpcyB1c2VkIGZvciBkZWJ1ZyBhbmQgZXJyb3IgbWVzc2FnZXMuCisKK1RoZSBL
Vk1JIHZlcnNpb24gY2FuIGJlIHJldHJpZXZlZCB1c2luZyB0aGUgS1ZNX0NBUF9JTlRST1NQRUNU
SU9OIG9mCit0aGUgS1ZNX0NIRUNLX0VYVEVOU0lPTiBpb2N0bCgpIGF0IHJ1bi10aW1lLgorCis0
LjEyMyBLVk1fSU5UUk9TUEVDVElPTl9VTkhPT0sKKworQ2FwYWJpbGl0eTogS1ZNX0NBUF9JTlRS
T1NQRUNUSU9OCitBcmNoaXRlY3R1cmVzOiB4ODYKK1R5cGU6IHZtIGlvY3RsCitQYXJhbWV0ZXJz
OiBub25lCitSZXR1cm5zOiAwIG9uIHN1Y2Nlc3MsIGEgbmVnYXRpdmUgdmFsdWUgb24gZXJyb3IK
KworVGhpcyBpb2N0bCBpcyB1c2VkIHRvIGZyZWUgYWxsIGludHJvc3BlY3Rpb24gc3RydWN0dXJl
cworcmVsYXRlZCB0byB0aGlzIFZNLgorCiA1LiBUaGUga3ZtX3J1biBzdHJ1Y3R1cmUKIC0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLQogCmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9r
dm1pX2hvc3QuaCBiL2FyY2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5oCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMzhjMzk4MjYyOTEzCi0tLSAvZGV2L251bGwK
KysrIGIvYXJjaC94ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmgKQEAgLTAsMCArMSw4IEBACisv
KiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLworI2lmbmRlZiBfQVNNX1g4Nl9L
Vk1JX0hPU1RfSAorI2RlZmluZSBfQVNNX1g4Nl9LVk1JX0hPU1RfSAorCitzdHJ1Y3Qga3ZtX2Fy
Y2hfaW50cm9zcGVjdGlvbiB7Cit9OworCisjZW5kaWYgLyogX0FTTV9YODZfS1ZNSV9IT1NUX0gg
Ki8KZGlmZiAtLWdpdCBhL2FyY2gveDg2L2t2bS9NYWtlZmlsZSBiL2FyY2gveDg2L2t2bS9NYWtl
ZmlsZQppbmRleCA1M2IzNTc5YzI5MDAuLmM0NmVjNDlkZmViOSAxMDA2NDQKLS0tIGEvYXJjaC94
ODYva3ZtL01ha2VmaWxlCisrKyBiL2FyY2gveDg2L2t2bS9NYWtlZmlsZQpAQCAtOCw3ICs4LDcg
QEAgS1ZNSSA6PSAkKEtWTSkvaW50cm9zcGVjdGlvbgoga3ZtLXkJCQkrPSAkKEtWTSkva3ZtX21h
aW4ubyAkKEtWTSkvY29hbGVzY2VkX21taW8ubyBcCiAJCQkJJChLVk0pL2V2ZW50ZmQubyAkKEtW
TSkvaXJxY2hpcC5vICQoS1ZNKS92ZmlvLm8KIGt2bS0kKENPTkZJR19LVk1fQVNZTkNfUEYpCSs9
ICQoS1ZNKS9hc3luY19wZi5vCi1rdm0tJChDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04pICs9ICQo
S1ZNSSkva3ZtaS5vCitrdm0tJChDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04pICs9ICQoS1ZNSSkv
a3ZtaS5vICQoS1ZNSSkva3ZtaV9tc2cubwogCiBrdm0teQkJCSs9IHg4Ni5vIGVtdWxhdGUubyBp
ODI1OS5vIGlycS5vIGxhcGljLm8gXAogCQkJICAgaTgyNTQubyBpb2FwaWMubyBpcnFfY29tbS5v
IGNwdWlkLm8gcG11Lm8gbXRyci5vIFwKZGlmZiAtLWdpdCBhL2FyY2gveDg2L2t2bS94ODYuYyBi
L2FyY2gveDg2L2t2bS94ODYuYwppbmRleCA2ZTY2NTM0MWNjODAuLjQ2YWViMzJjYjA3ZiAxMDA2
NDQKLS0tIGEvYXJjaC94ODYva3ZtL3g4Ni5jCisrKyBiL2FyY2gveDg2L2t2bS94ODYuYwpAQCAt
MzMzNSw2ICszMzM1LDExIEBAIGludCBrdm1fdm1faW9jdGxfY2hlY2tfZXh0ZW5zaW9uKHN0cnVj
dCBrdm0gKmt2bSwgbG9uZyBleHQpCiAJY2FzZSBLVk1fQ0FQX0hZUEVSVl9FTkxJR0hURU5FRF9W
TUNTOgogCQlyID0ga3ZtX3g4Nl9vcHMtPm5lc3RlZF9lbmFibGVfZXZtY3MgIT0gTlVMTDsKIAkJ
YnJlYWs7CisjaWZkZWYgQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OCisJY2FzZSBLVk1fQ0FQX0lO
VFJPU1BFQ1RJT046CisJCXIgPSBLVk1JX1ZFUlNJT047CisJCWJyZWFrOworI2VuZGlmCiAJZGVm
YXVsdDoKIAkJYnJlYWs7CiAJfQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9rdm1faG9zdC5o
IGIvaW5jbHVkZS9saW51eC9rdm1faG9zdC5oCmluZGV4IDg2MmRjNDVmOTcxZi4uMDEwNGNiMmM4
ZWUwIDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2t2bV9ob3N0LmgKKysrIGIvaW5jbHVkZS9s
aW51eC9rdm1faG9zdC5oCkBAIC01MDMsNiArNTAzLDggQEAgc3RydWN0IGt2bSB7CiAJc3RydWN0
IHNyY3Vfc3RydWN0IHNyY3U7CiAJc3RydWN0IHNyY3Vfc3RydWN0IGlycV9zcmN1OwogCXBpZF90
IHVzZXJzcGFjZV9waWQ7CisJc3RydWN0IG11dGV4IGt2bWlfbG9jazsKKwlzdHJ1Y3Qga3ZtX2lu
dHJvc3BlY3Rpb24gKmt2bWk7CiB9OwogCiAjZGVmaW5lIGt2bV9lcnIoZm10LCAuLi4pIFwKZGlm
ZiAtLWdpdCBhL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmggYi9pbmNsdWRlL2xpbnV4L2t2bWlf
aG9zdC5oCmluZGV4IDhjZDYxM2ZkZDRmMi4uYzhiOWM4N2VjZmYyIDEwMDY0NAotLS0gYS9pbmNs
dWRlL2xpbnV4L2t2bWlfaG9zdC5oCisrKyBiL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmgKQEAg
LTIsOCArMiwyMiBAQAogI2lmbmRlZiBfX0tWTUlfSE9TVF9ICiAjZGVmaW5lIF9fS1ZNSV9IT1NU
X0gKIAorI2luY2x1ZGUgPHVhcGkvbGludXgva3ZtaS5oPgorCiBzdHJ1Y3Qga3ZtOwogCisjaW5j
bHVkZSA8YXNtL2t2bWlfaG9zdC5oPgorCitzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24geworCXN0
cnVjdCBrdm1fYXJjaF9pbnRyb3NwZWN0aW9uIGFyY2g7CisJc3RydWN0IGt2bSAqa3ZtOworCisJ
dXVpZF90IHV1aWQ7CisKKwlzdHJ1Y3Qgc29ja2V0ICpzb2NrOworCXN0cnVjdCB0YXNrX3N0cnVj
dCAqcmVjdjsKK307CisKICNpZmRlZiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04KIAogaW50IGt2
bWlfaW5pdCh2b2lkKTsKQEAgLTExLDYgKzI1LDkgQEAgdm9pZCBrdm1pX3VuaW5pdCh2b2lkKTsK
IHZvaWQga3ZtaV9jcmVhdGVfdm0oc3RydWN0IGt2bSAqa3ZtKTsKIHZvaWQga3ZtaV9kZXN0cm95
X3ZtKHN0cnVjdCBrdm0gKmt2bSk7CiAKK2ludCBrdm1pX2lvY3RsX2hvb2soc3RydWN0IGt2bSAq
a3ZtLCB2b2lkIF9fdXNlciAqYXJncCk7CitpbnQga3ZtaV9pb2N0bF91bmhvb2soc3RydWN0IGt2
bSAqa3ZtKTsKKwogI2Vsc2UKIAogc3RhdGljIGlubGluZSBpbnQga3ZtaV9pbml0KHZvaWQpIHsg
cmV0dXJuIDA7IH0KZGlmZiAtLWdpdCBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm0uaCBiL2luY2x1
ZGUvdWFwaS9saW51eC9rdm0uaAppbmRleCBmMGExNmI0YWRiYmQuLjA5MTMyZDhkZDNlNSAxMDA2
NDQKLS0tIGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2bS5oCisrKyBiL2luY2x1ZGUvdWFwaS9saW51
eC9rdm0uaApAQCAtMTAwOSw2ICsxMDA5LDcgQEAgc3RydWN0IGt2bV9wcGNfcmVzaXplX2hwdCB7
CiAjZGVmaW5lIEtWTV9DQVBfUFBDX0dVRVNUX0RFQlVHX1NTVEVQIDE3NgogI2RlZmluZSBLVk1f
Q0FQX0FSTV9OSVNWX1RPX1VTRVIgMTc3CiAjZGVmaW5lIEtWTV9DQVBfQVJNX0lOSkVDVF9FWFRf
REFCVCAxNzgKKyNkZWZpbmUgS1ZNX0NBUF9JTlRST1NQRUNUSU9OIDE3OQogCiAjaWZkZWYgS1ZN
X0NBUF9JUlFfUk9VVElORwogCkBAIC0xNTUzLDYgKzE1NTQsMTUgQEAgc3RydWN0IGt2bV9zZXZf
ZGJnIHsKIAlfX3UzMiBsZW47CiB9OwogCitzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb25faG9vayB7
CisJX19zMzIgZmQ7CisJX191MzIgcGFkZGluZzsKKwlfX3U4IHV1aWRbMTZdOworfTsKKworI2Rl
ZmluZSBLVk1fSU5UUk9TUEVDVElPTl9IT09LICAgIF9JT1coS1ZNSU8sIDB4YzMsIHN0cnVjdCBr
dm1faW50cm9zcGVjdGlvbl9ob29rKQorI2RlZmluZSBLVk1fSU5UUk9TUEVDVElPTl9VTkhPT0sg
IF9JTyhLVk1JTywgMHhjNCkKKwogI2RlZmluZSBLVk1fREVWX0FTU0lHTl9FTkFCTEVfSU9NTVUJ
KDEgPDwgMCkKICNkZWZpbmUgS1ZNX0RFVl9BU1NJR05fUENJXzJfMwkJKDEgPDwgMSkKICNkZWZp
bmUgS1ZNX0RFVl9BU1NJR05fTUFTS19JTlRYCSgxIDw8IDIpCmRpZmYgLS1naXQgYS9pbmNsdWRl
L3VhcGkvbGludXgva3ZtaS5oIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaApuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjM0ZGRhOTEwMTZkYgotLS0gL2Rldi9udWxs
CisrKyBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKQEAgLTAsMCArMSwxMyBAQAorLyogU1BE
WC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgV0lUSCBMaW51eC1zeXNjYWxsLW5vdGUgKi8K
KyNpZm5kZWYgX1VBUElfX0xJTlVYX0tWTUlfSAorI2RlZmluZSBfVUFQSV9fTElOVVhfS1ZNSV9I
CisKKy8qCisgKiBLVk1JIHN0cnVjdHVyZXMgYW5kIGRlZmluaXRpb25zCisgKi8KKworZW51bSB7
CisJS1ZNSV9WRVJTSU9OID0gMHgwMDAwMDAwMQorfTsKKworI2VuZGlmIC8qIF9VQVBJX19MSU5V
WF9LVk1JX0ggKi8KZGlmZiAtLWdpdCBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS9NYWtl
ZmlsZSBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS9NYWtlZmlsZQppbmRleCAzMTM4YTkx
NjU3NGEuLmMzYjdjMTIxN2E2ZSAxMDA2NDQKLS0tIGEvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMv
a3ZtL01ha2VmaWxlCisrKyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS9NYWtlZmlsZQpA
QCAtMTUsNiArMTUsNyBAQCBMSUJLVk1fczM5MHggPSBsaWIvczM5MHgvcHJvY2Vzc29yLmMgbGli
L3MzOTB4L3VjYWxsLmMKIFRFU1RfR0VOX1BST0dTX3g4Nl82NCA9IHg4Nl82NC9jcjRfY3B1aWRf
c3luY190ZXN0CiBURVNUX0dFTl9QUk9HU194ODZfNjQgKz0geDg2XzY0L2V2bWNzX3Rlc3QKIFRF
U1RfR0VOX1BST0dTX3g4Nl82NCArPSB4ODZfNjQvaHlwZXJ2X2NwdWlkCitURVNUX0dFTl9QUk9H
U194ODZfNjQgKz0geDg2XzY0L2t2bWlfdGVzdAogVEVTVF9HRU5fUFJPR1NfeDg2XzY0ICs9IHg4
Nl82NC9tbWlvX3dhcm5pbmdfdGVzdAogVEVTVF9HRU5fUFJPR1NfeDg2XzY0ICs9IHg4Nl82NC9w
bGF0Zm9ybV9pbmZvX3Rlc3QKIFRFU1RfR0VOX1BST0dTX3g4Nl82NCArPSB4ODZfNjQvc2V0X3Ny
ZWdzX3Rlc3QKZGlmZiAtLWdpdCBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQv
a3ZtaV90ZXN0LmMgYi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVz
dC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uY2Q4NzQ0ZWM2OTM5
Ci0tLSAvZGV2L251bGwKKysrIGIvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9r
dm1pX3Rlc3QuYwpAQCAtMCwwICsxLDc4IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
R1BMLTIuMAorLyoKKyAqIEtWTSBpbnRyb3NwZWN0aW9uIHRlc3RzCisgKgorICogQ29weXJpZ2h0
IChDKSAyMDIwLCBCaXRkZWZlbmRlciBTLlIuTC4KKyAqLworCisjZGVmaW5lIF9HTlVfU09VUkNF
IC8qIGZvciBwcm9ncmFtX2ludm9jYXRpb25fc2hvcnRfbmFtZSAqLworI2luY2x1ZGUgPHN5cy90
eXBlcy5oPgorI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4KKworI2luY2x1ZGUgInRlc3RfdXRpbC5o
IgorCisjaW5jbHVkZSAia3ZtX3V0aWwuaCIKKyNpbmNsdWRlICJwcm9jZXNzb3IuaCIKKyNpbmNs
dWRlICIuLi9saWIva3ZtX3V0aWxfaW50ZXJuYWwuaCIKKworI2RlZmluZSBWQ1BVX0lEICAgICAg
ICAgNQorCitzdGF0aWMgaW50IHNvY2tldF9wYWlyWzJdOworI2RlZmluZSBLdm1fc29ja2V0ICAg
ICAgIHNvY2tldF9wYWlyWzBdCisjZGVmaW5lIFVzZXJzcGFjZV9zb2NrZXQgc29ja2V0X3BhaXJb
MV0KKwordm9pZCBzZXR1cF9zb2NrZXQodm9pZCkKK3sKKwlpbnQgcjsKKworCXIgPSBzb2NrZXRw
YWlyKEFGX1VOSVgsIFNPQ0tfU1RSRUFNLCAwLCBzb2NrZXRfcGFpcik7CisJVEVTVF9BU1NFUlQo
ciA9PSAwLAorCQkic29ja2V0cGFpcigpIGZhaWxlZCwgZXJybm8gJWQgKCVzKVxuIiwKKwkJZXJy
bm8sIHN0cmVycm9yKGVycm5vKSk7Cit9CisKK3N0YXRpYyB2b2lkIGhvb2tfaW50cm9zcGVjdGlv
bihzdHJ1Y3Qga3ZtX3ZtICp2bSkKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb25faG9vayBo
b29rID0gey5mZCA9IEt2bV9zb2NrZXR9OworCWludCByOworCisJciA9IGlvY3RsKHZtLT5mZCwg
S1ZNX0lOVFJPU1BFQ1RJT05fSE9PSywgJmhvb2spOworCVRFU1RfQVNTRVJUKHIgPT0gMCwKKwkJ
IktWTV9JTlRST1NQRUNUSU9OX0hPT0sgZmFpbGVkLCBlcnJubyAlZCAoJXMpXG4iLAorCQllcnJu
bywgc3RyZXJyb3IoZXJybm8pKTsKK30KKworc3RhdGljIHZvaWQgdW5ob29rX2ludHJvc3BlY3Rp
b24oc3RydWN0IGt2bV92bSAqdm0pCit7CisJaW50IHI7CisKKwlyID0gaW9jdGwodm0tPmZkLCBL
Vk1fSU5UUk9TUEVDVElPTl9VTkhPT0ssIE5VTEwpOworCVRFU1RfQVNTRVJUKHIgPT0gMCwKKwkJ
IktWTV9JTlRST1NQRUNUSU9OX1VOSE9PSyBmYWlsZWQsIGVycm5vICVkICglcylcbiIsCisJCWVy
cm5vLCBzdHJlcnJvcihlcnJubykpOworfQorCitzdGF0aWMgdm9pZCB0ZXN0X2ludHJvc3BlY3Rp
b24oc3RydWN0IGt2bV92bSAqdm0pCit7CisJc2V0dXBfc29ja2V0KCk7CisJaG9va19pbnRyb3Nw
ZWN0aW9uKHZtKTsKKwl1bmhvb2tfaW50cm9zcGVjdGlvbih2bSk7Cit9CisKK2ludCBtYWluKGlu
dCBhcmdjLCBjaGFyICphcmd2W10pCit7CisJc3RydWN0IGt2bV92bSAqdm07CisKKwlpZiAoIWt2
bV9jaGVja19jYXAoS1ZNX0NBUF9JTlRST1NQRUNUSU9OKSkgeworCQlmcHJpbnRmKHN0ZGVyciwK
KwkJCSJLVk1fQ0FQX0lOVFJPU1BFQ1RJT04gbm90IGF2YWlsYWJsZSwgc2tpcHBpbmcgdGVzdHNc
biIpOworCQlleGl0KEtTRlRfU0tJUCk7CisJfQorCisJdm0gPSB2bV9jcmVhdGVfZGVmYXVsdChW
Q1BVX0lELCAwLCBOVUxMKTsKKwl2Y3B1X3NldF9jcHVpZCh2bSwgVkNQVV9JRCwga3ZtX2dldF9z
dXBwb3J0ZWRfY3B1aWQoKSk7CisKKwl0ZXN0X2ludHJvc3BlY3Rpb24odm0pOworCisJcmV0dXJu
IDA7Cit9CmRpZmYgLS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyBiL3ZpcnQv
a3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCmluZGV4IGM3NGRkYjgwNzVjZC4uN2EwMDk0ODA1MTdh
IDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYworKysgYi92aXJ0L2t2
bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwpAQCAtNiw2ICs2LDcgQEAKICAqCiAgKi8KICNpbmNsdWRl
ICJrdm1pX2ludC5oIgorI2luY2x1ZGUgPGxpbnV4L2t0aHJlYWQuaD4KIAogaW50IGt2bWlfaW5p
dCh2b2lkKQogewpAQCAtMTYsMTAgKzE3LDE1NyBAQCB2b2lkIGt2bWlfdW5pbml0KHZvaWQpCiB7
CiB9CiAKK3N0YXRpYyB2b2lkIGZyZWVfa3ZtaShzdHJ1Y3Qga3ZtICprdm0pCit7CisJa2ZyZWUo
a3ZtLT5rdm1pKTsKKwlrdm0tPmt2bWkgPSBOVUxMOworfQorCitzdGF0aWMgc3RydWN0IGt2bV9p
bnRyb3NwZWN0aW9uICoKK2FsbG9jX2t2bWkoc3RydWN0IGt2bSAqa3ZtLCBjb25zdCBzdHJ1Y3Qg
a3ZtX2ludHJvc3BlY3Rpb25faG9vayAqaG9vaykKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rp
b24gKmt2bWk7CisKKwlrdm1pID0ga3phbGxvYyhzaXplb2YoKmt2bWkpLCBHRlBfS0VSTkVMKTsK
KwlpZiAoIWt2bWkpCisJCXJldHVybiBOVUxMOworCisJQlVJTERfQlVHX09OKHNpemVvZihob29r
LT51dWlkKSAhPSBzaXplb2Yoa3ZtaS0+dXVpZCkpOworCW1lbWNweSgma3ZtaS0+dXVpZCwgJmhv
b2stPnV1aWQsIHNpemVvZihrdm1pLT51dWlkKSk7CisKKwlrdm1pLT5rdm0gPSBrdm07CisKKwly
ZXR1cm4ga3ZtaTsKK30KKworc3RhdGljIHZvaWQga3ZtaV9kZXN0cm95KHN0cnVjdCBrdm1faW50
cm9zcGVjdGlvbiAqa3ZtaSkKK3sKKwlzdHJ1Y3Qga3ZtICprdm0gPSBrdm1pLT5rdm07CisKKwlm
cmVlX2t2bWkoa3ZtKTsKK30KKworc3RhdGljIHZvaWQga3ZtaV9zdG9wX3JlY3ZfdGhyZWFkKHN0
cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSkKK3sKKwlrdm1pX3NvY2tfc2h1dGRvd24oa3Zt
aSk7Cit9CisKK3N0YXRpYyB2b2lkIF9fa3ZtaV91bmhvb2soc3RydWN0IGt2bSAqa3ZtKQorewor
CXN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSA9IEtWTUkoa3ZtKTsKKworCWt2bWlfc29j
a19wdXQoa3ZtaSk7Cit9CisKK3N0YXRpYyB2b2lkIGt2bWlfdW5ob29rKHN0cnVjdCBrdm0gKmt2
bSkKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWk7CisKKwltdXRleF9sb2NrKCZr
dm0tPmt2bWlfbG9jayk7CisKKwlrdm1pID0gS1ZNSShrdm0pOworCWlmIChrdm1pKSB7CisJCWt2
bWlfc3RvcF9yZWN2X3RocmVhZChrdm1pKTsKKwkJX19rdm1pX3VuaG9vayhrdm0pOworCQlrdm1p
X2Rlc3Ryb3koa3ZtaSk7CisJfQorCisJbXV0ZXhfdW5sb2NrKCZrdm0tPmt2bWlfbG9jayk7Cit9
CisKK2ludCBrdm1pX2lvY3RsX3VuaG9vayhzdHJ1Y3Qga3ZtICprdm0pCit7CisJa3ZtaV91bmhv
b2soa3ZtKTsKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBfX2t2bWlfaG9vayhzdHJ1Y3Qg
a3ZtICprdm0sCisJCSAgICAgICBjb25zdCBzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb25faG9vayAq
aG9vaykKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkgPSBLVk1JKGt2bSk7CisK
KwlpZiAoIWt2bWlfc29ja19nZXQoa3ZtaSwgaG9vay0+ZmQpKQorCQlyZXR1cm4gLUVJTlZBTDsK
KworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGt2bWlfcmVjdl90aHJlYWQodm9pZCAqYXJn
KQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSA9IGFyZzsKKworCXdoaWxlIChr
dm1pX21zZ19wcm9jZXNzKGt2bWkpKQorCQk7CisKKwkvKgorCSAqIFNpZ25hbCB1c2Vyc3BhY2Ug
KHdoaWNoIG1pZ2h0IHdhaXQgZm9yIFBPTExIVVAgb25seSkKKwkgKiBhbmQgcHJldmVudCB0aGUg
dkNQVXMgZnJvbSBzZW5kaW5nIG90aGVyIGV2ZW50cy4KKwkgKi8KKwlrdm1pX3NvY2tfc2h1dGRv
d24oa3ZtaSk7CisKKwlyZXR1cm4gMDsKK30KKworaW50IGt2bWlfaG9vayhzdHJ1Y3Qga3ZtICpr
dm0sIGNvbnN0IHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbl9ob29rICpob29rKQoreworCXN0cnVj
dCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaTsKKwlpbnQgZXJyID0gMDsKKworCW11dGV4X2xvY2so
Jmt2bS0+a3ZtaV9sb2NrKTsKKworCWlmIChrdm0tPmt2bWkpIHsKKwkJZXJyID0gLUVFWElTVDsK
KwkJZ290byBvdXQ7CisJfQorCisJa3ZtaSA9IGFsbG9jX2t2bWkoa3ZtLCBob29rKTsKKwlpZiAo
IWt2bWkpIHsKKwkJZXJyID0gLUVOT01FTTsKKwkJZ290byBvdXQ7CisJfQorCisJa3ZtLT5rdm1p
ID0ga3ZtaTsKKworCWVyciA9IF9fa3ZtaV9ob29rKGt2bSwgaG9vayk7CisJaWYgKGVycikKKwkJ
Z290byBkZXN0cm95OworCisJa3ZtaS0+cmVjdiA9IGt0aHJlYWRfcnVuKGt2bWlfcmVjdl90aHJl
YWQsIGt2bWksICJrdm1pLXJlY3YiKTsKKwlpZiAoSVNfRVJSKGt2bWktPnJlY3YpKSB7CisJCWVy
ciA9IC1FTk9NRU07CisJCWdvdG8gdW5ob29rOworCX0KKworCWdvdG8gb3V0OworCit1bmhvb2s6
CisJX19rdm1pX3VuaG9vayhrdm0pOworZGVzdHJveToKKwlrdm1pX2Rlc3Ryb3koa3ZtaSk7Citv
dXQ6CisJbXV0ZXhfdW5sb2NrKCZrdm0tPmt2bWlfbG9jayk7CisJcmV0dXJuIGVycjsKK30KKwor
aW50IGt2bWlfaW9jdGxfaG9vayhzdHJ1Y3Qga3ZtICprdm0sIHZvaWQgX191c2VyICphcmdwKQor
eworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlvbl9ob29rIGk7CisKKwlpZiAoY29weV9mcm9tX3Vz
ZXIoJmksIGFyZ3AsIHNpemVvZihpKSkpCisJCXJldHVybiAtRUZBVUxUOworCisJaWYgKGkucGFk
ZGluZykKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlyZXR1cm4ga3ZtaV9ob29rKGt2bSwgJmkpOwor
fQorCiB2b2lkIGt2bWlfY3JlYXRlX3ZtKHN0cnVjdCBrdm0gKmt2bSkKIHsKKwltdXRleF9pbml0
KCZrdm0tPmt2bWlfbG9jayk7CiB9CiAKIHZvaWQga3ZtaV9kZXN0cm95X3ZtKHN0cnVjdCBrdm0g
Kmt2bSkKIHsKKwlrdm1pX3VuaG9vayhrdm0pOwogfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50
cm9zcGVjdGlvbi9rdm1pX2ludC5oIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5o
CmluZGV4IDM0YWY5MjZmOTgzOC4uMDE0NTFkNTczNzg4IDEwMDY0NAotLS0gYS92aXJ0L2t2bS9p
bnRyb3NwZWN0aW9uL2t2bWlfaW50LmgKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1p
X2ludC5oCkBAIC00LDQgKzQsMjQgQEAKIAogI2luY2x1ZGUgPGxpbnV4L2t2bV9ob3N0Lmg+CiAK
KyNkZWZpbmUga3ZtaV93YXJuKGt2bWksIGZtdCwgLi4uKSBcCisJa3ZtX2luZm8oIiVwVSBXQVJO
SU5HOiAiIGZtdCwgJmt2bWktPnV1aWQsICMjIF9fVkFfQVJHU19fKQorI2RlZmluZSBrdm1pX3dh
cm5fb25jZShrdm1pLCBmbXQsIC4uLikgKHsgICAgICAgICAgICAgICAgICAgICBcCisJCXN0YXRp
YyBib29sIF9fc2VjdGlvbiguZGF0YS5vbmNlKSBfX3dhcm5lZDsgICBcCisJCWlmICghX193YXJu
ZWQpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisJCQlfX3dhcm5lZCA9IHRydWU7
ICAgICAgICAgICAgICAgICAgICAgIFwKKwkJCWt2bWlfd2Fybihrdm1pLCBmbXQsICMjIF9fVkFf
QVJHU19fKTsgXAorCQl9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorCX0pCisjZGVmaW5lIGt2bWlfZXJyKGt2bWksIGZtdCwgLi4uKSBcCisJa3ZtX2luZm8o
IiVwVSBFUlJPUjogIiBmbXQsICZrdm1pLT51dWlkLCAjIyBfX1ZBX0FSR1NfXykKKworI2RlZmlu
ZSBLVk1JKGt2bSkgKChzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKikoKGt2bSktPmt2bWkpKQor
CisvKiBrdm1pX21zZy5jICovCitib29sIGt2bWlfc29ja19nZXQoc3RydWN0IGt2bV9pbnRyb3Nw
ZWN0aW9uICprdm1pLCBpbnQgZmQpOwordm9pZCBrdm1pX3NvY2tfc2h1dGRvd24oc3RydWN0IGt2
bV9pbnRyb3NwZWN0aW9uICprdm1pKTsKK3ZvaWQga3ZtaV9zb2NrX3B1dChzdHJ1Y3Qga3ZtX2lu
dHJvc3BlY3Rpb24gKmt2bWkpOworYm9vbCBrdm1pX21zZ19wcm9jZXNzKHN0cnVjdCBrdm1faW50
cm9zcGVjdGlvbiAqa3ZtaSk7CisKICNlbmRpZgpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9z
cGVjdGlvbi9rdm1pX21zZy5jIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uZjllNjYyNzRmYjQzCi0tLSAv
ZGV2L251bGwKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCkBAIC0wLDAg
KzEsMzkgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogS1ZN
IGludHJvc3BlY3Rpb24gKG1lc3NhZ2UgaGFuZGxpbmcpCisgKgorICogQ29weXJpZ2h0IChDKSAy
MDE3LTIwMjAgQml0ZGVmZW5kZXIgUy5SLkwuCisgKgorICovCisjaW5jbHVkZSA8bGludXgvbmV0
Lmg+CisjaW5jbHVkZSAia3ZtaV9pbnQuaCIKKworYm9vbCBrdm1pX3NvY2tfZ2V0KHN0cnVjdCBr
dm1faW50cm9zcGVjdGlvbiAqa3ZtaSwgaW50IGZkKQoreworCXN0cnVjdCBzb2NrZXQgKnNvY2s7
CisJaW50IHI7CisKKwlzb2NrID0gc29ja2ZkX2xvb2t1cChmZCwgJnIpOworCWlmICghc29jaykK
KwkJcmV0dXJuIGZhbHNlOworCisJa3ZtaS0+c29jayA9IHNvY2s7CisKKwlyZXR1cm4gdHJ1ZTsK
K30KKwordm9pZCBrdm1pX3NvY2tfcHV0KHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSkK
K3sKKwlpZiAoa3ZtaS0+c29jaykKKwkJc29ja2ZkX3B1dChrdm1pLT5zb2NrKTsKK30KKwordm9p
ZCBrdm1pX3NvY2tfc2h1dGRvd24oc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pKQorewor
CWtlcm5lbF9zb2NrX3NodXRkb3duKGt2bWktPnNvY2ssIFNIVVRfUkRXUik7Cit9CisKK2Jvb2wg
a3ZtaV9tc2dfcHJvY2VzcyhzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkpCit7CisJcmV0
dXJuIGZhbHNlOworfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0va3ZtX21haW4uYyBiL3ZpcnQva3Zt
L2t2bV9tYWluLmMKaW5kZXggZDMzMDY1NjY1ZTIyLi43N2JhYjliYTkxOGIgMTAwNjQ0Ci0tLSBh
L3ZpcnQva3ZtL2t2bV9tYWluLmMKKysrIGIvdmlydC9rdm0va3ZtX21haW4uYwpAQCAtMzQ5NSw2
ICszNDk1LDE3IEBAIHN0YXRpYyBsb25nIGt2bV92bV9pb2N0bChzdHJ1Y3QgZmlsZSAqZmlscCwK
IAljYXNlIEtWTV9DSEVDS19FWFRFTlNJT046CiAJCXIgPSBrdm1fdm1faW9jdGxfY2hlY2tfZXh0
ZW5zaW9uX2dlbmVyaWMoa3ZtLCBhcmcpOwogCQlicmVhazsKKyNpZmRlZiBDT05GSUdfS1ZNX0lO
VFJPU1BFQ1RJT04KKwljYXNlIEtWTV9JTlRST1NQRUNUSU9OX0hPT0s6CisJCWlmIChlbmFibGVf
aW50cm9zcGVjdGlvbikKKwkJCXIgPSBrdm1pX2lvY3RsX2hvb2soa3ZtLCBhcmdwKTsKKwkJZWxz
ZQorCQkJciA9IC1FUEVSTTsKKwkJYnJlYWs7CisJY2FzZSBLVk1fSU5UUk9TUEVDVElPTl9VTkhP
T0s6CisJCXIgPSBrdm1pX2lvY3RsX3VuaG9vayhrdm0pOworCQlicmVhazsKKyNlbmRpZiAvKiBD
T05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04gKi8KIAlkZWZhdWx0OgogCQlyID0ga3ZtX2FyY2hfdm1f
aW9jdGwoZmlscCwgaW9jdGwsIGFyZyk7CiAJfQpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmlydHVhbGl6
YXRpb25AbGlzdHMubGludXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51eGZvdW5k
YXRpb24ub3JnL21haWxtYW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
