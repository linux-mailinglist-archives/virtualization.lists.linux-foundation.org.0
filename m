Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp4.osuosl.org (smtp4.osuosl.org [IPv6:2605:bc80:3010::137])
	by mail.lfdr.de (Postfix) with ESMTPS id 7FD7F75174E
	for <lists.virtualization@lfdr.de>; Thu, 13 Jul 2023 06:20:25 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp4.osuosl.org (Postfix) with ESMTP id 1546741FD5;
	Thu, 13 Jul 2023 04:20:24 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 1546741FD5
Authentication-Results: smtp4.osuosl.org;
	dkim=fail reason="signature verification failed" (1024-bit key) header.d=redhat.com header.i=@redhat.com header.a=rsa-sha256 header.s=mimecast20190719 header.b=Q1PCz6mv
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
	by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id ZlBHPXFsW1DY; Thu, 13 Jul 2023 04:20:22 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp4.osuosl.org (Postfix) with ESMTPS id BEF2F41DB5;
	Thu, 13 Jul 2023 04:20:21 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org BEF2F41DB5
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id ECA5CC0DD4;
	Thu, 13 Jul 2023 04:20:20 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp4.osuosl.org (smtp4.osuosl.org [IPv6:2605:bc80:3010::137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 49593C0032
 for <virtualization@lists.linux-foundation.org>;
 Thu, 13 Jul 2023 04:20:19 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp4.osuosl.org (Postfix) with ESMTP id 276E041DB5
 for <virtualization@lists.linux-foundation.org>;
 Thu, 13 Jul 2023 04:20:19 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 276E041DB5
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
 by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id tQJXK2EC2eUd
 for <virtualization@lists.linux-foundation.org>;
 Thu, 13 Jul 2023 04:20:17 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 755684096D
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.133.124])
 by smtp4.osuosl.org (Postfix) with ESMTPS id 755684096D
 for <virtualization@lists.linux-foundation.org>;
 Thu, 13 Jul 2023 04:20:17 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1689222016;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=hH+QQmObaUHZXLt2rqjdRlVFiuUDoj0Rt/d8ykJr+Bo=;
 b=Q1PCz6mvwb+X+NUvPC0QCBTgHG5Lb7GE22B+HZeu+9E+DnqoySsT/VJgNiKA7UCsFq/aq9
 LW+CXPF1al5owmw/nNYOqyqXCAJtTVMxIMT4NTXEMJOQEzPhNwYCxmtab3Kf0R+vFqFxaJ
 3XmK5MOzv2PfGYM9d33ytTk2GzK2Zgs=
Received: from mail-qv1-f70.google.com (mail-qv1-f70.google.com
 [209.85.219.70]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384) id
 us-mta-650-LJ3alCXvOpWt-iWUrmL4eQ-1; Thu, 13 Jul 2023 00:20:14 -0400
X-MC-Unique: LJ3alCXvOpWt-iWUrmL4eQ-1
Received: by mail-qv1-f70.google.com with SMTP id
 6a1803df08f44-635a4267cf5so2670176d6.2
 for <virtualization@lists.linux-foundation.org>;
 Wed, 12 Jul 2023 21:20:14 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20221208; t=1689222014; x=1691814014;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
 :subject:date:message-id:reply-to;
 bh=hH+QQmObaUHZXLt2rqjdRlVFiuUDoj0Rt/d8ykJr+Bo=;
 b=aIBKd9ul2cXXKcdE3kx1xjc3N7BtA7JrmHtsvXH/gqACxaElsPP6h1zQwuLiRvgP6g
 ShZo2cBfSdcxQh5rkJqtwVOGgdrhjuMChM+3RDlCewfLpRvyofT9cG5Mf3IZNAU7YaF/
 Z1ql8HLFrvPPluUqVO+Rh8PWiTDqldECr9+XZ0FaHV9DIEMx025sE7DjCm8gCfU1tVcJ
 Oib8PRqwLJIAL4/AiqKtbRbqyqyuaHQFfJiAZIIUwVWJ+MWtLlTfQMfWx0X3kD6QeyWL
 Fs3GUsQOazPGyZbOJcRVi2gDjKXcrf3CzktlrEEvI2XewOXMrb12rdmokzZWsAMMGiRi
 9Zsg==
X-Gm-Message-State: ABy/qLZUJmpxGVtfufJ/6VwNfpjO5dDMaKk3G8t976ZuVnKlGTu8RZYx
 meCCM8gXcaxfCPuPP7KWZ/zzDU9ooJ7MMkW1kczh9W7Hpr9ysC0iZy2AGNJPjxfJ54u+WJEYd6c
 nWaSVEAOHPto/diynTepkFo0wwDLcI6BlYOiO+K2d/ZFwJ1i3ur05UMqEyw==
X-Received: by 2002:a05:6214:a49:b0:621:78a:dd84 with SMTP id
 ee9-20020a0562140a4900b00621078add84mr352276qvb.47.1689222014301; 
 Wed, 12 Jul 2023 21:20:14 -0700 (PDT)
X-Google-Smtp-Source: APBJJlF0+Tt8/oZbFnPXPlESEfcMehFUmNtx1FXUu0l1rFpotOmsS0LrQyJegnDoLm6/j5ryHx2vveK0y5hEzQO0TrA=
X-Received: by 2002:a05:6214:a49:b0:621:78a:dd84 with SMTP id
 ee9-20020a0562140a4900b00621078add84mr352259qvb.47.1689222013966; Wed, 12 Jul
 2023 21:20:13 -0700 (PDT)
MIME-Version: 1.0
References: <20230710034237.12391-1-xuanzhuo@linux.alibaba.com>
 <20230710034237.12391-11-xuanzhuo@linux.alibaba.com>
In-Reply-To: <20230710034237.12391-11-xuanzhuo@linux.alibaba.com>
From: Jason Wang <jasowang@redhat.com>
Date: Thu, 13 Jul 2023 12:20:01 +0800
Message-ID: <CACGkMEtoiHXese1sNJELeidmFc6nFR8rE1aA8MooaEKKUSw_eg@mail.gmail.com>
Subject: Re: [PATCH vhost v11 10/10] virtio_net: merge dma operation for one
 page
To: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Cc: Jesper Dangaard Brouer <hawk@kernel.org>,
 Daniel Borkmann <daniel@iogearbox.net>, "Michael S. Tsirkin" <mst@redhat.com>,
 netdev@vger.kernel.org, John Fastabend <john.fastabend@gmail.com>,
 Alexei Starovoitov <ast@kernel.org>, virtualization@lists.linux-foundation.org,
 Christoph Hellwig <hch@infradead.org>, Eric Dumazet <edumazet@google.com>,
 Jakub Kicinski <kuba@kernel.org>, bpf@vger.kernel.org,
 Paolo Abeni <pabeni@redhat.com>, "David S. Miller" <davem@davemloft.net>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gTW9uLCBKdWwgMTAsIDIwMjMgYXQgMTE6NDPigK9BTSBYdWFuIFpodW8gPHh1YW56aHVvQGxp
bnV4LmFsaWJhYmEuY29tPiB3cm90ZToKPgoKSSdkIHN1Z2dlc3QgdG8gdHdlYWsgdGhlIHRpdGxl
IGxpa2U6CgoibWVyZ2UgZG1hIG9wZXJhdGlvbnMgd2hlbiByZWZpbGxpbmcgbWVyZ2VhYmxlIGJ1
ZmZlcnMiCgo+IEN1cnJlbnRseSwgdGhlIHZpcnRpbyBjb3JlIHdpbGwgcGVyZm9ybSBhIGRtYSBv
cGVyYXRpb24gZm9yIGVhY2gKPiBvcGVyYXRpb24uCgoiZm9yIGVhY2ggYnVmZmVyIj8KCj4gQWx0
aG91Z2gsIHRoZSBzYW1lIHBhZ2UgbWF5IGJlIG9wZXJhdGVkIG11bHRpcGxlIHRpbWVzLgo+Cj4g
VGhlIGRyaXZlciBkb2VzIHRoZSBkbWEgb3BlcmF0aW9uIGFuZCBtYW5hZ2VzIHRoZSBkbWEgYWRk
cmVzcyBiYXNlZCB0aGUKPiBmZWF0dXJlIHByZW1hcHBlZCBvZiB2aXJ0aW8gY29yZS4KPgo+IFRo
aXMgd2F5LCB3ZSBjYW4gcGVyZm9ybSBvbmx5IG9uZSBkbWEgb3BlcmF0aW9uIGZvciB0aGUgc2Ft
ZSBwYWdlLiBJbgo+IHRoZSBjYXNlIG9mIG10dSAxNTAwLCB0aGlzIGNhbiByZWR1Y2UgYSBsb3Qg
b2YgZG1hIG9wZXJhdGlvbnMuCj4KPiBUZXN0ZWQgb24gQWxpeXVuIGc3LjRsYXJnZSBtYWNoaW5l
LCBpbiB0aGUgY2FzZSBvZiBhIGNwdSAxMDAlLCBwcHMKPiBpbmNyZWFzZWQgZnJvbSAxODkzNzY2
IHRvIDE5MDExMDUuIEFuIGluY3JlYXNlIG9mIDAuNCUuCgpCdHcsIGl0IGxvb2tzIHRvIG1lIHRo
ZSBjb2RlIHRvIGRlYWwgd2l0aCBYRFBfVFgvUkVESVJFQ1QgZm9yCmxpbmVhcml6ZWQgcGFnZXMg
d2FzIG1pc3NlZC4KCj4KPiBTaWduZWQtb2ZmLWJ5OiBYdWFuIFpodW8gPHh1YW56aHVvQGxpbnV4
LmFsaWJhYmEuY29tPgo+IC0tLQo+ICBkcml2ZXJzL25ldC92aXJ0aW9fbmV0LmMgfCAyODMgKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tCj4gIDEgZmlsZSBjaGFuZ2VkLCAy
NjcgaW5zZXJ0aW9ucygrKSwgMTYgZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9uZXQvdmlydGlvX25ldC5jIGIvZHJpdmVycy9uZXQvdmlydGlvX25ldC5jCj4gaW5kZXggNDg2
YjU4NDkwMzNkLi40ZGU4NDVkMzViZWQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9uZXQvdmlydGlv
X25ldC5jCj4gKysrIGIvZHJpdmVycy9uZXQvdmlydGlvX25ldC5jCj4gQEAgLTEyNiw2ICsxMjYs
MjcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2aXJ0bmV0X3N0YXRfZGVzYyB2aXJ0bmV0X3JxX3N0
YXRzX2Rlc2NbXSA9IHsKPiAgI2RlZmluZSBWSVJUTkVUX1NRX1NUQVRTX0xFTiAgIEFSUkFZX1NJ
WkUodmlydG5ldF9zcV9zdGF0c19kZXNjKQo+ICAjZGVmaW5lIFZJUlRORVRfUlFfU1RBVFNfTEVO
ICAgQVJSQVlfU0laRSh2aXJ0bmV0X3JxX3N0YXRzX2Rlc2MpCj4KPiArLyogVGhlIGJ1ZnMgb24g
dGhlIHNhbWUgcGFnZSBtYXkgc2hhcmUgdGhpcyBzdHJ1Y3QuICovCj4gK3N0cnVjdCB2aXJ0bmV0
X3JxX2RtYSB7Cj4gKyAgICAgICBzdHJ1Y3QgdmlydG5ldF9ycV9kbWEgKm5leHQ7Cj4gKwo+ICsg
ICAgICAgZG1hX2FkZHJfdCBhZGRyOwo+ICsKPiArICAgICAgIHZvaWQgKmJ1ZjsKPiArICAgICAg
IHUzMiBsZW47Cj4gKwo+ICsgICAgICAgdTMyIHJlZjsKPiArfTsKPiArCj4gKy8qIFJlY29yZCB0
aGUgZG1hIGFuZCBidWYuICovCj4gK3N0cnVjdCB2aXJ0bmV0X3JxX2RhdGEgewo+ICsgICAgICAg
c3RydWN0IHZpcnRuZXRfcnFfZGF0YSAqbmV4dDsKPiArCj4gKyAgICAgICB2b2lkICpidWY7Cj4g
Kwo+ICsgICAgICAgc3RydWN0IHZpcnRuZXRfcnFfZG1hICpkbWE7Cj4gK307Cj4gKwo+ICAvKiBJ
bnRlcm5hbCByZXByZXNlbnRhdGlvbiBvZiBhIHNlbmQgdmlydHF1ZXVlICovCj4gIHN0cnVjdCBz
ZW5kX3F1ZXVlIHsKPiAgICAgICAgIC8qIFZpcnRxdWV1ZSBhc3NvY2lhdGVkIHdpdGggdGhpcyBz
ZW5kIF9xdWV1ZSAqLwo+IEBAIC0xNzUsNiArMTk2LDEzIEBAIHN0cnVjdCByZWNlaXZlX3F1ZXVl
IHsKPiAgICAgICAgIGNoYXIgbmFtZVsxNl07Cj4KPiAgICAgICAgIHN0cnVjdCB4ZHBfcnhxX2lu
Zm8geGRwX3J4cTsKPiArCj4gKyAgICAgICBzdHJ1Y3QgdmlydG5ldF9ycV9kYXRhICpkYXRhX2Fy
cmF5Owo+ICsgICAgICAgc3RydWN0IHZpcnRuZXRfcnFfZGF0YSAqZGF0YV9mcmVlOwo+ICsKPiAr
ICAgICAgIHN0cnVjdCB2aXJ0bmV0X3JxX2RtYSAqZG1hX2FycmF5Owo+ICsgICAgICAgc3RydWN0
IHZpcnRuZXRfcnFfZG1hICpkbWFfZnJlZTsKPiArICAgICAgIHN0cnVjdCB2aXJ0bmV0X3JxX2Rt
YSAqbGFzdF9kbWE7Cj4gIH07Cj4KPiAgLyogVGhpcyBzdHJ1Y3R1cmUgY2FuIGNvbnRhaW4gcnNz
IG1lc3NhZ2Ugd2l0aCBtYXhpbXVtIHNldHRpbmdzIGZvciBpbmRpcmVjdGlvbiB0YWJsZSBhbmQg
a2V5c2l6ZQo+IEBAIC01NDksNiArNTc3LDE3NiBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKnBh
Z2VfdG9fc2tiKHN0cnVjdCB2aXJ0bmV0X2luZm8gKnZpLAo+ICAgICAgICAgcmV0dXJuIHNrYjsK
PiAgfQo+Cj4gK3N0YXRpYyB2b2lkIHZpcnRuZXRfcnFfdW5tYXAoc3RydWN0IHJlY2VpdmVfcXVl
dWUgKnJxLCBzdHJ1Y3QgdmlydG5ldF9ycV9kbWEgKmRtYSkKPiArewo+ICsgICAgICAgc3RydWN0
IGRldmljZSAqZGV2Owo+ICsKPiArICAgICAgIC0tZG1hLT5yZWY7Cj4gKwo+ICsgICAgICAgaWYg
KGRtYS0+cmVmKQo+ICsgICAgICAgICAgICAgICByZXR1cm47Cj4gKwo+ICsgICAgICAgZGV2ID0g
dmlydHF1ZXVlX2RtYV9kZXYocnEtPnZxKTsKPiArCj4gKyAgICAgICBkbWFfdW5tYXBfcGFnZShk
ZXYsIGRtYS0+YWRkciwgZG1hLT5sZW4sIERNQV9GUk9NX0RFVklDRSk7Cj4gKwo+ICsgICAgICAg
ZG1hLT5uZXh0ID0gcnEtPmRtYV9mcmVlOwo+ICsgICAgICAgcnEtPmRtYV9mcmVlID0gZG1hOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCAqdmlydG5ldF9ycV9yZWN5Y2xlX2RhdGEoc3RydWN0IHJl
Y2VpdmVfcXVldWUgKnJxLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3QgdmlydG5ldF9ycV9kYXRhICpkYXRhKQo+ICt7Cj4gKyAgICAgICB2b2lkICpidWY7Cj4g
Kwo+ICsgICAgICAgYnVmID0gZGF0YS0+YnVmOwo+ICsKPiArICAgICAgIGRhdGEtPm5leHQgPSBy
cS0+ZGF0YV9mcmVlOwo+ICsgICAgICAgcnEtPmRhdGFfZnJlZSA9IGRhdGE7Cj4gKwo+ICsgICAg
ICAgcmV0dXJuIGJ1ZjsKPiArfQo+ICsKPiArc3RhdGljIHN0cnVjdCB2aXJ0bmV0X3JxX2RhdGEg
KnZpcnRuZXRfcnFfZ2V0X2RhdGEoc3RydWN0IHJlY2VpdmVfcXVldWUgKnJxLAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKmJ1ZiwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
dmlydG5ldF9ycV9kbWEgKmRtYSkKPiArewo+ICsgICAgICAgc3RydWN0IHZpcnRuZXRfcnFfZGF0
YSAqZGF0YTsKPiArCj4gKyAgICAgICBkYXRhID0gcnEtPmRhdGFfZnJlZTsKPiArICAgICAgIHJx
LT5kYXRhX2ZyZWUgPSBkYXRhLT5uZXh0Owo+ICsKPiArICAgICAgIGRhdGEtPmJ1ZiA9IGJ1ZjsK
PiArICAgICAgIGRhdGEtPmRtYSA9IGRtYTsKPiArCj4gKyAgICAgICByZXR1cm4gZGF0YTsKPiAr
fQo+ICsKPiArc3RhdGljIHZvaWQgKnZpcnRuZXRfcnFfZ2V0X2J1ZihzdHJ1Y3QgcmVjZWl2ZV9x
dWV1ZSAqcnEsIHUzMiAqbGVuLCB2b2lkICoqY3R4KQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3Qgdmly
dG5ldF9ycV9kYXRhICpkYXRhOwo+ICsgICAgICAgdm9pZCAqYnVmOwo+ICsKPiArICAgICAgIGJ1
ZiA9IHZpcnRxdWV1ZV9nZXRfYnVmX2N0eChycS0+dnEsIGxlbiwgY3R4KTsKPiArICAgICAgIGlm
ICghYnVmIHx8ICFycS0+ZGF0YV9hcnJheSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIGJ1ZjsK
PiArCj4gKyAgICAgICBkYXRhID0gYnVmOwo+ICsKPiArICAgICAgIHZpcnRuZXRfcnFfdW5tYXAo
cnEsIGRhdGEtPmRtYSk7Cj4gKwo+ICsgICAgICAgcmV0dXJuIHZpcnRuZXRfcnFfcmVjeWNsZV9k
YXRhKHJxLCBkYXRhKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgKnZpcnRuZXRfcnFfZGV0YWNo
X3VudXNlZF9idWYoc3RydWN0IHJlY2VpdmVfcXVldWUgKnJxKQo+ICt7Cj4gKyAgICAgICBzdHJ1
Y3QgdmlydG5ldF9ycV9kYXRhICpkYXRhOwo+ICsgICAgICAgdm9pZCAqYnVmOwo+ICsKPiArICAg
ICAgIGJ1ZiA9IHZpcnRxdWV1ZV9kZXRhY2hfdW51c2VkX2J1ZihycS0+dnEpOwo+ICsgICAgICAg
aWYgKCFidWYgfHwgIXJxLT5kYXRhX2FycmF5KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gYnVm
Owo+ICsKPiArICAgICAgIGRhdGEgPSBidWY7Cj4gKwo+ICsgICAgICAgdmlydG5ldF9ycV91bm1h
cChycSwgZGF0YS0+ZG1hKTsKPiArCj4gKyAgICAgICByZXR1cm4gdmlydG5ldF9ycV9yZWN5Y2xl
X2RhdGEocnEsIGRhdGEpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZpcnRuZXRfcnFfbWFwX3Nn
KHN0cnVjdCByZWNlaXZlX3F1ZXVlICpycSwgdm9pZCAqYnVmLCB1MzIgbGVuKQo+ICt7Cj4gKyAg
ICAgICBzdHJ1Y3QgdmlydG5ldF9ycV9kbWEgKmRtYSA9IHJxLT5sYXN0X2RtYTsKPiArICAgICAg
IHN0cnVjdCBkZXZpY2UgKmRldjsKPiArICAgICAgIHUzMiBvZmYsIG1hcF9sZW47Cj4gKyAgICAg
ICBkbWFfYWRkcl90IGFkZHI7Cj4gKyAgICAgICB2b2lkICplbmQ7Cj4gKwo+ICsgICAgICAgaWYg
KGxpa2VseShkbWEpICYmIGJ1ZiA+PSBkbWEtPmJ1ZiAmJiAoYnVmICsgbGVuIDw9IGRtYS0+YnVm
ICsgZG1hLT5sZW4pKSB7Cj4gKyAgICAgICAgICAgICAgICsrZG1hLT5yZWY7Cj4gKyAgICAgICAg
ICAgICAgIGFkZHIgPSBkbWEtPmFkZHIgKyAoYnVmIC0gZG1hLT5idWYpOwo+ICsgICAgICAgICAg
ICAgICBnb3RvIG9rOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGVuZCA9IGJ1ZiArIGxlbiAt
IDE7Cj4gKyAgICAgICBvZmYgPSBvZmZzZXRfaW5fcGFnZShlbmQpOwo+ICsgICAgICAgbWFwX2xl
biA9IGxlbiArIFBBR0VfU0laRSAtIG9mZjsKClRoaXMgYXNzdW1lcyBhIFBBR0VfU0laRSB3aGlj
aCBzZWVtcyBzdWItb3B0aW1hbCBhcyBwYWdlIGZyYWcgY291bGQgYmUKbGFyZ2VyIHRoYW4gdGhp
cy4KCj4gKwo+ICsgICAgICAgZGV2ID0gdmlydHF1ZXVlX2RtYV9kZXYocnEtPnZxKTsKPiArCj4g
KyAgICAgICBhZGRyID0gZG1hX21hcF9wYWdlX2F0dHJzKGRldiwgdmlydF90b19wYWdlKGJ1Ziks
IG9mZnNldF9pbl9wYWdlKGJ1ZiksCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IG1hcF9sZW4sIERNQV9GUk9NX0RFVklDRSwgMCk7Cj4gKyAgICAgICBpZiAoYWRkciA9PSBETUFf
TUFQUElOR19FUlJPUikKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsg
ICAgICAgZG1hID0gcnEtPmRtYV9mcmVlOwo+ICsgICAgICAgcnEtPmRtYV9mcmVlID0gZG1hLT5u
ZXh0Owo+ICsKPiArICAgICAgIGRtYS0+cmVmID0gMTsKPiArICAgICAgIGRtYS0+YnVmID0gYnVm
Owo+ICsgICAgICAgZG1hLT5hZGRyID0gYWRkcjsKPiArICAgICAgIGRtYS0+bGVuID0gbWFwX2xl
bjsKPiArCj4gKyAgICAgICBycS0+bGFzdF9kbWEgPSBkbWE7Cj4gKwo+ICtvazoKPiArICAgICAg
IHNnX2luaXRfdGFibGUocnEtPnNnLCAxKTsKPiArICAgICAgIHJxLT5zZ1swXS5kbWFfYWRkcmVz
cyA9IGFkZHI7Cj4gKyAgICAgICBycS0+c2dbMF0ubGVuZ3RoID0gbGVuOwo+ICsKPiArICAgICAg
IHJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHZpcnRuZXRfcnFfbWVyZ2VfbWFwX2lu
aXQoc3RydWN0IHZpcnRuZXRfaW5mbyAqdmkpCj4gK3sKPiArICAgICAgIHN0cnVjdCByZWNlaXZl
X3F1ZXVlICpycTsKPiArICAgICAgIGludCBpLCBlcnIsIGosIG51bTsKPiArCj4gKyAgICAgICAv
KiBkaXNhYmxlIGZvciBiaWcgbW9kZSAqLwo+ICsgICAgICAgaWYgKCF2aS0+bWVyZ2VhYmxlX3J4
X2J1ZnMgJiYgdmktPmJpZ19wYWNrZXRzKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gMDsKPiAr
Cj4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwgdmktPm1heF9xdWV1ZV9wYWlyczsgaSsrKSB7Cj4g
KyAgICAgICAgICAgICAgIGVyciA9IHZpcnRxdWV1ZV9zZXRfcHJlbWFwcGVkKHZpLT5ycVtpXS52
cSk7Cj4gKyAgICAgICAgICAgICAgIGlmIChlcnIpCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
Y29udGludWU7Cj4gKwo+ICsgICAgICAgICAgICAgICBycSA9ICZ2aS0+cnFbaV07Cj4gKwo+ICsg
ICAgICAgICAgICAgICBudW0gPSB2aXJ0cXVldWVfZ2V0X3ZyaW5nX3NpemUocnEtPnZxKTsKPiAr
Cj4gKyAgICAgICAgICAgICAgIHJxLT5kYXRhX2FycmF5ID0ga21hbGxvY19hcnJheShudW0sIHNp
emVvZigqcnEtPmRhdGFfYXJyYXkpLCBHRlBfS0VSTkVMKTsKPiArICAgICAgICAgICAgICAgaWYg
KCFycS0+ZGF0YV9hcnJheSkKCkNhbiB3ZSBhdm9pZCB0aG9zZSBhbGxvY2F0aW9ucyB3aGVuIHdl
IGRvbid0IHVzZSB0aGUgRE1BIEFQST8KCj4gKyAgICAgICAgICAgICAgICAgICAgICAgZ290byBl
cnI7Cj4gKwo+ICsgICAgICAgICAgICAgICBycS0+ZG1hX2FycmF5ID0ga21hbGxvY19hcnJheShu
dW0sIHNpemVvZigqcnEtPmRtYV9hcnJheSksIEdGUF9LRVJORUwpOwo+ICsgICAgICAgICAgICAg
ICBpZiAoIXJxLT5kbWFfYXJyYXkpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgZ290byBlcnI7
Cj4gKwo+ICsgICAgICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgbnVtOyArK2opIHsKPiArICAg
ICAgICAgICAgICAgICAgICAgICBycS0+ZGF0YV9hcnJheVtqXS5uZXh0ID0gcnEtPmRhdGFfZnJl
ZTsKPiArICAgICAgICAgICAgICAgICAgICAgICBycS0+ZGF0YV9mcmVlID0gJnJxLT5kYXRhX2Fy
cmF5W2pdOwo+ICsKPiArICAgICAgICAgICAgICAgICAgICAgICBycS0+ZG1hX2FycmF5W2pdLm5l
eHQgPSBycS0+ZG1hX2ZyZWU7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcnEtPmRtYV9mcmVl
ID0gJnJxLT5kbWFfYXJyYXlbal07Cj4gKyAgICAgICAgICAgICAgIH0KPiArICAgICAgIH0KPiAr
Cj4gKyAgICAgICByZXR1cm4gMDsKPiArCj4gK2VycjoKPiArICAgICAgIGZvciAoaSA9IDA7IGkg
PCB2aS0+bWF4X3F1ZXVlX3BhaXJzOyBpKyspIHsKPiArICAgICAgICAgICAgICAgc3RydWN0IHJl
Y2VpdmVfcXVldWUgKnJxOwo+ICsKPiArICAgICAgICAgICAgICAgcnEgPSAmdmktPnJxW2ldOwo+
ICsKPiArICAgICAgICAgICAgICAga2ZyZWUocnEtPmRtYV9hcnJheSk7Cj4gKyAgICAgICAgICAg
ICAgIGtmcmVlKHJxLT5kYXRhX2FycmF5KTsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1
cm4gLUVOT01FTTsKPiArfQo+ICsKPiAgc3RhdGljIHZvaWQgZnJlZV9vbGRfeG1pdF9za2JzKHN0
cnVjdCBzZW5kX3F1ZXVlICpzcSwgYm9vbCBpbl9uYXBpKQo+ICB7Cj4gICAgICAgICB1bnNpZ25l
ZCBpbnQgbGVuOwo+IEBAIC04MzUsNyArMTAzMyw3IEBAIHN0YXRpYyBzdHJ1Y3QgcGFnZSAqeGRw
X2xpbmVhcml6ZV9wYWdlKHN0cnVjdCByZWNlaXZlX3F1ZXVlICpycSwKPiAgICAgICAgICAgICAg
ICAgdm9pZCAqYnVmOwo+ICAgICAgICAgICAgICAgICBpbnQgb2ZmOwo+Cj4gLSAgICAgICAgICAg
ICAgIGJ1ZiA9IHZpcnRxdWV1ZV9nZXRfYnVmKHJxLT52cSwgJmJ1Zmxlbik7Cj4gKyAgICAgICAg
ICAgICAgIGJ1ZiA9IHZpcnRuZXRfcnFfZ2V0X2J1ZihycSwgJmJ1ZmxlbiwgTlVMTCk7Cj4gICAg
ICAgICAgICAgICAgIGlmICh1bmxpa2VseSghYnVmKSkKPiAgICAgICAgICAgICAgICAgICAgICAg
ICBnb3RvIGVycl9idWY7Cj4KPiBAQCAtMTEyNiw3ICsxMzI0LDcgQEAgc3RhdGljIGludCB2aXJ0
bmV0X2J1aWxkX3hkcF9idWZmX21yZyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ICAgICAgICAg
ICAgICAgICByZXR1cm4gLUVJTlZBTDsKPgo+ICAgICAgICAgd2hpbGUgKC0tKm51bV9idWYgPiAw
KSB7Cj4gLSAgICAgICAgICAgICAgIGJ1ZiA9IHZpcnRxdWV1ZV9nZXRfYnVmX2N0eChycS0+dnEs
ICZsZW4sICZjdHgpOwo+ICsgICAgICAgICAgICAgICBidWYgPSB2aXJ0bmV0X3JxX2dldF9idWYo
cnEsICZsZW4sICZjdHgpOwo+ICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIWJ1ZikpIHsK
PiAgICAgICAgICAgICAgICAgICAgICAgICBwcl9kZWJ1ZygiJXM6IHJ4IGVycm9yOiAlZCBidWZm
ZXJzIG91dCBvZiAlZCBtaXNzaW5nXG4iLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGRldi0+bmFtZSwgKm51bV9idWYsCj4gQEAgLTEzNTEsNyArMTU0OSw3IEBAIHN0YXRpYyBz
dHJ1Y3Qgc2tfYnVmZiAqcmVjZWl2ZV9tZXJnZWFibGUoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwK
PiAgICAgICAgIHdoaWxlICgtLW51bV9idWYpIHsKPiAgICAgICAgICAgICAgICAgaW50IG51bV9z
a2JfZnJhZ3M7Cj4KPiAtICAgICAgICAgICAgICAgYnVmID0gdmlydHF1ZXVlX2dldF9idWZfY3R4
KHJxLT52cSwgJmxlbiwgJmN0eCk7Cj4gKyAgICAgICAgICAgICAgIGJ1ZiA9IHZpcnRuZXRfcnFf
Z2V0X2J1ZihycSwgJmxlbiwgJmN0eCk7Cj4gICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSgh
YnVmKSkgewo+ICAgICAgICAgICAgICAgICAgICAgICAgIHByX2RlYnVnKCIlczogcnggZXJyb3I6
ICVkIGJ1ZmZlcnMgb3V0IG9mICVkIG1pc3NpbmdcbiIsCj4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZGV2LT5uYW1lLCBudW1fYnVmLAo+IEBAIC0xNDE0LDcgKzE2MTIsNyBAQCBz
dGF0aWMgc3RydWN0IHNrX2J1ZmYgKnJlY2VpdmVfbWVyZ2VhYmxlKHN0cnVjdCBuZXRfZGV2aWNl
ICpkZXYsCj4gIGVycl9za2I6Cj4gICAgICAgICBwdXRfcGFnZShwYWdlKTsKPiAgICAgICAgIHdo
aWxlIChudW1fYnVmLS0gPiAxKSB7Cj4gLSAgICAgICAgICAgICAgIGJ1ZiA9IHZpcnRxdWV1ZV9n
ZXRfYnVmKHJxLT52cSwgJmxlbik7Cj4gKyAgICAgICAgICAgICAgIGJ1ZiA9IHZpcnRuZXRfcnFf
Z2V0X2J1ZihycSwgJmxlbiwgTlVMTCk7Cj4gICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSgh
YnVmKSkgewo+ICAgICAgICAgICAgICAgICAgICAgICAgIHByX2RlYnVnKCIlczogcnggZXJyb3I6
ICVkIGJ1ZmZlcnMgbWlzc2luZ1xuIiwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBkZXYtPm5hbWUsIG51bV9idWYpOwo+IEBAIC0xNTI5LDYgKzE3MjcsNyBAQCBzdGF0aWMgaW50
IGFkZF9yZWN2YnVmX3NtYWxsKHN0cnVjdCB2aXJ0bmV0X2luZm8gKnZpLCBzdHJ1Y3QgcmVjZWl2
ZV9xdWV1ZSAqcnEsCj4gICAgICAgICB1bnNpZ25lZCBpbnQgeGRwX2hlYWRyb29tID0gdmlydG5l
dF9nZXRfaGVhZHJvb20odmkpOwo+ICAgICAgICAgdm9pZCAqY3R4ID0gKHZvaWQgKikodW5zaWdu
ZWQgbG9uZyl4ZHBfaGVhZHJvb207Cj4gICAgICAgICBpbnQgbGVuID0gdmktPmhkcl9sZW4gKyBW
SVJUTkVUX1JYX1BBRCArIEdPT0RfUEFDS0VUX0xFTiArIHhkcF9oZWFkcm9vbTsKPiArICAgICAg
IHN0cnVjdCB2aXJ0bmV0X3JxX2RhdGEgKmRhdGE7Cj4gICAgICAgICBpbnQgZXJyOwo+Cj4gICAg
ICAgICBsZW4gPSBTS0JfREFUQV9BTElHTihsZW4pICsKPiBAQCAtMTUzOSwxMSArMTczOCwzNCBA
QCBzdGF0aWMgaW50IGFkZF9yZWN2YnVmX3NtYWxsKHN0cnVjdCB2aXJ0bmV0X2luZm8gKnZpLCBz
dHJ1Y3QgcmVjZWl2ZV9xdWV1ZSAqcnEsCj4gICAgICAgICBidWYgPSAoY2hhciAqKXBhZ2VfYWRk
cmVzcyhhbGxvY19mcmFnLT5wYWdlKSArIGFsbG9jX2ZyYWctPm9mZnNldDsKPiAgICAgICAgIGdl
dF9wYWdlKGFsbG9jX2ZyYWctPnBhZ2UpOwo+ICAgICAgICAgYWxsb2NfZnJhZy0+b2Zmc2V0ICs9
IGxlbjsKPiAtICAgICAgIHNnX2luaXRfb25lKHJxLT5zZywgYnVmICsgVklSVE5FVF9SWF9QQUQg
KyB4ZHBfaGVhZHJvb20sCj4gLSAgICAgICAgICAgICAgICAgICB2aS0+aGRyX2xlbiArIEdPT0Rf
UEFDS0VUX0xFTik7Cj4gLSAgICAgICBlcnIgPSB2aXJ0cXVldWVfYWRkX2luYnVmX2N0eChycS0+
dnEsIHJxLT5zZywgMSwgYnVmLCBjdHgsIGdmcCk7Cj4gKwo+ICsgICAgICAgaWYgKHJxLT5kYXRh
X2FycmF5KSB7Cj4gKyAgICAgICAgICAgICAgIGVyciA9IHZpcnRuZXRfcnFfbWFwX3NnKHJxLCBi
dWYgKyBWSVJUTkVUX1JYX1BBRCArIHhkcF9oZWFkcm9vbSwKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdmktPmhkcl9sZW4gKyBHT09EX1BBQ0tFVF9MRU4pOwoKVGhh
bmtzIHRvIHRoZSBjb21wb3VuZCBwYWdlLiBJIHdvbmRlciBpZiBldmVyeXRoaW5nIGNvdWxkIGJl
CnNpbXBsaWZpZWQgaWYgd2UganVzdCByZXVzZSBwYWdlLT5wcml2YXRlIGZvciBzdG9yaW5nIG1l
dGFkYXRhIGxpa2UKZG1hIGFkZHJlc3MgYW5kIHJlZmNudC4gVGhlbiB3ZSBkb24ndCBuZWVkIGV4
dHJhIHN0dWZmIGZvciB0cmFja2luZwphbnkgb3RoZXIgdGhpbmc/CgpUaGFua3MKCgoKPiArICAg
ICAgICAgICAgICAgaWYgKGVycikKPiArICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG1hcF9l
cnI7Cj4gKwo+ICsgICAgICAgICAgICAgICBkYXRhID0gdmlydG5ldF9ycV9nZXRfZGF0YShycSwg
YnVmLCBycS0+bGFzdF9kbWEpOwo+ICsgICAgICAgfSBlbHNlIHsKPiArICAgICAgICAgICAgICAg
c2dfaW5pdF9vbmUocnEtPnNnLCBidWYgKyBWSVJUTkVUX1JYX1BBRCArIHhkcF9oZWFkcm9vbSwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgdmktPmhkcl9sZW4gKyBHT09EX1BBQ0tFVF9M
RU4pOwo+ICsgICAgICAgICAgICAgICBkYXRhID0gKHZvaWQgKilidWY7Cj4gKyAgICAgICB9Cj4g
Kwo+ICsgICAgICAgZXJyID0gdmlydHF1ZXVlX2FkZF9pbmJ1Zl9jdHgocnEtPnZxLCBycS0+c2cs
IDEsIGRhdGEsIGN0eCwgZ2ZwKTsKPiAgICAgICAgIGlmIChlcnIgPCAwKQo+IC0gICAgICAgICAg
ICAgICBwdXRfcGFnZSh2aXJ0X3RvX2hlYWRfcGFnZShidWYpKTsKPiArICAgICAgICAgICAgICAg
Z290byBhZGRfZXJyOwo+ICsKPiArICAgICAgIHJldHVybiBlcnI7Cj4gKwo+ICthZGRfZXJyOgo+
ICsgICAgICAgaWYgKHJxLT5kYXRhX2FycmF5KSB7Cj4gKyAgICAgICAgICAgICAgIHZpcnRuZXRf
cnFfdW5tYXAocnEsIGRhdGEtPmRtYSk7Cj4gKyAgICAgICAgICAgICAgIHZpcnRuZXRfcnFfcmVj
eWNsZV9kYXRhKHJxLCBkYXRhKTsKPiArICAgICAgIH0KPiArCj4gK21hcF9lcnI6Cj4gKyAgICAg
ICBwdXRfcGFnZSh2aXJ0X3RvX2hlYWRfcGFnZShidWYpKTsKPiAgICAgICAgIHJldHVybiBlcnI7
Cj4gIH0KPgo+IEBAIC0xNjIwLDYgKzE4NDIsNyBAQCBzdGF0aWMgaW50IGFkZF9yZWN2YnVmX21l
cmdlYWJsZShzdHJ1Y3QgdmlydG5ldF9pbmZvICp2aSwKPiAgICAgICAgIHVuc2lnbmVkIGludCBo
ZWFkcm9vbSA9IHZpcnRuZXRfZ2V0X2hlYWRyb29tKHZpKTsKPiAgICAgICAgIHVuc2lnbmVkIGlu
dCB0YWlscm9vbSA9IGhlYWRyb29tID8gc2l6ZW9mKHN0cnVjdCBza2Jfc2hhcmVkX2luZm8pIDog
MDsKPiAgICAgICAgIHVuc2lnbmVkIGludCByb29tID0gU0tCX0RBVEFfQUxJR04oaGVhZHJvb20g
KyB0YWlscm9vbSk7Cj4gKyAgICAgICBzdHJ1Y3QgdmlydG5ldF9ycV9kYXRhICpkYXRhOwo+ICAg
ICAgICAgY2hhciAqYnVmOwo+ICAgICAgICAgdm9pZCAqY3R4Owo+ICAgICAgICAgaW50IGVycjsK
PiBAQCAtMTY1MCwxMiArMTg3MywzMiBAQCBzdGF0aWMgaW50IGFkZF9yZWN2YnVmX21lcmdlYWJs
ZShzdHJ1Y3QgdmlydG5ldF9pbmZvICp2aSwKPiAgICAgICAgICAgICAgICAgYWxsb2NfZnJhZy0+
b2Zmc2V0ICs9IGhvbGU7Cj4gICAgICAgICB9Cj4KPiAtICAgICAgIHNnX2luaXRfb25lKHJxLT5z
ZywgYnVmLCBsZW4pOwo+ICsgICAgICAgaWYgKHJxLT5kYXRhX2FycmF5KSB7Cj4gKyAgICAgICAg
ICAgICAgIGVyciA9IHZpcnRuZXRfcnFfbWFwX3NnKHJxLCBidWYsIGxlbik7Cj4gKyAgICAgICAg
ICAgICAgIGlmIChlcnIpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgZ290byBtYXBfZXJyOwo+
ICsKPiArICAgICAgICAgICAgICAgZGF0YSA9IHZpcnRuZXRfcnFfZ2V0X2RhdGEocnEsIGJ1Ziwg
cnEtPmxhc3RfZG1hKTsKPiArICAgICAgIH0gZWxzZSB7Cj4gKyAgICAgICAgICAgICAgIHNnX2lu
aXRfb25lKHJxLT5zZywgYnVmLCBsZW4pOwo+ICsgICAgICAgICAgICAgICBkYXRhID0gKHZvaWQg
KilidWY7Cj4gKyAgICAgICB9Cj4gKwo+ICAgICAgICAgY3R4ID0gbWVyZ2VhYmxlX2xlbl90b19j
dHgobGVuICsgcm9vbSwgaGVhZHJvb20pOwo+IC0gICAgICAgZXJyID0gdmlydHF1ZXVlX2FkZF9p
bmJ1Zl9jdHgocnEtPnZxLCBycS0+c2csIDEsIGJ1ZiwgY3R4LCBnZnApOwo+ICsgICAgICAgZXJy
ID0gdmlydHF1ZXVlX2FkZF9pbmJ1Zl9jdHgocnEtPnZxLCBycS0+c2csIDEsIGRhdGEsIGN0eCwg
Z2ZwKTsKPiAgICAgICAgIGlmIChlcnIgPCAwKQo+IC0gICAgICAgICAgICAgICBwdXRfcGFnZSh2
aXJ0X3RvX2hlYWRfcGFnZShidWYpKTsKPiArICAgICAgICAgICAgICAgZ290byBhZGRfZXJyOwo+
ICsKPiArICAgICAgIHJldHVybiAwOwo+ICsKPiArYWRkX2VycjoKPiArICAgICAgIGlmIChycS0+
ZGF0YV9hcnJheSkgewo+ICsgICAgICAgICAgICAgICB2aXJ0bmV0X3JxX3VubWFwKHJxLCBkYXRh
LT5kbWEpOwo+ICsgICAgICAgICAgICAgICB2aXJ0bmV0X3JxX3JlY3ljbGVfZGF0YShycSwgZGF0
YSk7Cj4gKyAgICAgICB9Cj4KPiArbWFwX2VycjoKPiArICAgICAgIHB1dF9wYWdlKHZpcnRfdG9f
aGVhZF9wYWdlKGJ1ZikpOwo+ICAgICAgICAgcmV0dXJuIGVycjsKPiAgfQo+Cj4gQEAgLTE3NzUs
MTMgKzIwMTgsMTMgQEAgc3RhdGljIGludCB2aXJ0bmV0X3JlY2VpdmUoc3RydWN0IHJlY2VpdmVf
cXVldWUgKnJxLCBpbnQgYnVkZ2V0LAo+ICAgICAgICAgICAgICAgICB2b2lkICpjdHg7Cj4KPiAg
ICAgICAgICAgICAgICAgd2hpbGUgKHN0YXRzLnBhY2tldHMgPCBidWRnZXQgJiYKPiAtICAgICAg
ICAgICAgICAgICAgICAgIChidWYgPSB2aXJ0cXVldWVfZ2V0X2J1Zl9jdHgocnEtPnZxLCAmbGVu
LCAmY3R4KSkpIHsKPiArICAgICAgICAgICAgICAgICAgICAgIChidWYgPSB2aXJ0bmV0X3JxX2dl
dF9idWYocnEsICZsZW4sICZjdHgpKSkgewo+ICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2Vp
dmVfYnVmKHZpLCBycSwgYnVmLCBsZW4sIGN0eCwgeGRwX3htaXQsICZzdGF0cyk7Cj4gICAgICAg
ICAgICAgICAgICAgICAgICAgc3RhdHMucGFja2V0cysrOwo+ICAgICAgICAgICAgICAgICB9Cj4g
ICAgICAgICB9IGVsc2Ugewo+ICAgICAgICAgICAgICAgICB3aGlsZSAoc3RhdHMucGFja2V0cyA8
IGJ1ZGdldCAmJgo+IC0gICAgICAgICAgICAgICAgICAgICAgKGJ1ZiA9IHZpcnRxdWV1ZV9nZXRf
YnVmKHJxLT52cSwgJmxlbikpICE9IE5VTEwpIHsKPiArICAgICAgICAgICAgICAgICAgICAgIChi
dWYgPSB2aXJ0bmV0X3JxX2dldF9idWYocnEsICZsZW4sIE5VTEwpKSAhPSBOVUxMKSB7Cj4gICAg
ICAgICAgICAgICAgICAgICAgICAgcmVjZWl2ZV9idWYodmksIHJxLCBidWYsIGxlbiwgTlVMTCwg
eGRwX3htaXQsICZzdGF0cyk7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHMucGFja2V0
cysrOwo+ICAgICAgICAgICAgICAgICB9Cj4gQEAgLTM1MTQsNiArMzc1Nyw5IEBAIHN0YXRpYyB2
b2lkIHZpcnRuZXRfZnJlZV9xdWV1ZXMoc3RydWN0IHZpcnRuZXRfaW5mbyAqdmkpCj4gICAgICAg
ICBmb3IgKGkgPSAwOyBpIDwgdmktPm1heF9xdWV1ZV9wYWlyczsgaSsrKSB7Cj4gICAgICAgICAg
ICAgICAgIF9fbmV0aWZfbmFwaV9kZWwoJnZpLT5ycVtpXS5uYXBpKTsKPiAgICAgICAgICAgICAg
ICAgX19uZXRpZl9uYXBpX2RlbCgmdmktPnNxW2ldLm5hcGkpOwo+ICsKPiArICAgICAgICAgICAg
ICAga2ZyZWUodmktPnJxW2ldLmRhdGFfYXJyYXkpOwo+ICsgICAgICAgICAgICAgICBrZnJlZSh2
aS0+cnFbaV0uZG1hX2FycmF5KTsKPiAgICAgICAgIH0KPgo+ICAgICAgICAgLyogV2UgY2FsbGVk
IF9fbmV0aWZfbmFwaV9kZWwoKSwKPiBAQCAtMzU5MSw5ICszODM3LDEwIEBAIHN0YXRpYyB2b2lk
IGZyZWVfdW51c2VkX2J1ZnMoc3RydWN0IHZpcnRuZXRfaW5mbyAqdmkpCj4gICAgICAgICB9Cj4K
PiAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB2aS0+bWF4X3F1ZXVlX3BhaXJzOyBpKyspIHsKPiAt
ICAgICAgICAgICAgICAgc3RydWN0IHZpcnRxdWV1ZSAqdnEgPSB2aS0+cnFbaV0udnE7Cj4gLSAg
ICAgICAgICAgICAgIHdoaWxlICgoYnVmID0gdmlydHF1ZXVlX2RldGFjaF91bnVzZWRfYnVmKHZx
KSkgIT0gTlVMTCkKPiAtICAgICAgICAgICAgICAgICAgICAgICB2aXJ0bmV0X3JxX2ZyZWVfdW51
c2VkX2J1Zih2cSwgYnVmKTsKPiArICAgICAgICAgICAgICAgc3RydWN0IHJlY2VpdmVfcXVldWUg
KnJxID0gJnZpLT5ycVtpXTsKPiArCj4gKyAgICAgICAgICAgICAgIHdoaWxlICgoYnVmID0gdmly
dG5ldF9ycV9kZXRhY2hfdW51c2VkX2J1ZihycSkpICE9IE5VTEwpCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgdmlydG5ldF9ycV9mcmVlX3VudXNlZF9idWYocnEtPnZxLCBidWYpOwo+ICAgICAg
ICAgICAgICAgICBjb25kX3Jlc2NoZWQoKTsKPiAgICAgICAgIH0KPiAgfQo+IEBAIC0zNzY3LDYg
KzQwMTQsMTAgQEAgc3RhdGljIGludCBpbml0X3ZxcyhzdHJ1Y3QgdmlydG5ldF9pbmZvICp2aSkK
PiAgICAgICAgIGlmIChyZXQpCj4gICAgICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWU7Cj4KPiAr
ICAgICAgIHJldCA9IHZpcnRuZXRfcnFfbWVyZ2VfbWFwX2luaXQodmkpOwo+ICsgICAgICAgaWYg
KHJldCkKPiArICAgICAgICAgICAgICAgZ290byBlcnJfZnJlZTsKPiArCj4gICAgICAgICBjcHVz
X3JlYWRfbG9jaygpOwo+ICAgICAgICAgdmlydG5ldF9zZXRfYWZmaW5pdHkodmkpOwo+ICAgICAg
ICAgY3B1c19yZWFkX3VubG9jaygpOwo+IC0tCj4gMi4zMi4wLjMuZzAxMTk1Y2Y5Zgo+CgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpWaXJ0dWFsaXphdGlv
biBtYWlsaW5nIGxpc3QKVmlydHVhbGl6YXRpb25AbGlzdHMubGludXgtZm91bmRhdGlvbi5vcmcK
aHR0cHM6Ly9saXN0cy5saW51eGZvdW5kYXRpb24ub3JnL21haWxtYW4vbGlzdGluZm8vdmlydHVh
bGl6YXRpb24=
