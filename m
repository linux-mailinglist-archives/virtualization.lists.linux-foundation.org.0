Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp4.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 4FFAC507F9B
	for <lists.virtualization@lfdr.de>; Wed, 20 Apr 2022 05:33:06 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp4.osuosl.org (Postfix) with ESMTP id D09384193F;
	Wed, 20 Apr 2022 03:33:04 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
	by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id C6jZ5c7tFCXk; Wed, 20 Apr 2022 03:33:02 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp4.osuosl.org (Postfix) with ESMTPS id 222CD4193E;
	Wed, 20 Apr 2022 03:33:02 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 79D21C0088;
	Wed, 20 Apr 2022 03:33:01 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp2.osuosl.org (smtp2.osuosl.org [IPv6:2605:bc80:3010::133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 3F23FC002C
 for <virtualization@lists.linux-foundation.org>;
 Wed, 20 Apr 2022 03:32:59 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp2.osuosl.org (Postfix) with ESMTP id 2BB6840327
 for <virtualization@lists.linux-foundation.org>;
 Wed, 20 Apr 2022 03:32:59 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Authentication-Results: smtp2.osuosl.org (amavisd-new);
 dkim=pass (1024-bit key) header.d=redhat.com
Received: from smtp2.osuosl.org ([127.0.0.1])
 by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id xz5165QSC4NN
 for <virtualization@lists.linux-foundation.org>;
 Wed, 20 Apr 2022 03:32:57 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.129.124])
 by smtp2.osuosl.org (Postfix) with ESMTPS id 9C0AC400A4
 for <virtualization@lists.linux-foundation.org>;
 Wed, 20 Apr 2022 03:32:57 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1650425576;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=fmkZ9VuJgfsEck212kRbHSlZca3ND4du4JlP1Q+lMT8=;
 b=E5P7IwCoUslouIk1d4Vv3HJM7rpgHH6Hm1wNbO+MgHBvIjLbfSsroHISoAMJdg6D7uiW2k
 x12hOTeL7uXv30em+zl1qK+7Qng8DdUcoZrom3pz/LveYSh4/uPkgHv+6/sPxrDDsOpvRi
 rj/Y6Ze2kytHU7X7m/WwIg8pyS8Xra0=
Received: from mail-pj1-f72.google.com (mail-pj1-f72.google.com
 [209.85.216.72]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 us-mta-107-YscZ0Gh7PTGAjIzbfey3dQ-1; Tue, 19 Apr 2022 23:32:54 -0400
X-MC-Unique: YscZ0Gh7PTGAjIzbfey3dQ-1
Received: by mail-pj1-f72.google.com with SMTP id
 q15-20020a17090a178f00b001d33d8130c8so356651pja.8
 for <virtualization@lists.linux-foundation.org>;
 Tue, 19 Apr 2022 20:32:54 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20210112;
 h=x-gm-message-state:message-id:date:mime-version:user-agent:subject
 :content-language:to:cc:references:from:in-reply-to
 :content-transfer-encoding;
 bh=fmkZ9VuJgfsEck212kRbHSlZca3ND4du4JlP1Q+lMT8=;
 b=Rgphhy1EXkbVKWLni7NLfx+HKGbAkrVZxbr9J6b235o0B07DJTuGX+ermwdn20D+EF
 cGF/AkL1U93yr7bA0Doa+kpnq5tZVmnY2ztNtc8Czd8KtpiZ3lqYNFjhrPNaDl/bNq4n
 YNLDDpyC5zlFrSiAbHhs9LzaTFHrQlEOOb0LIRXCqbM+GcMvCuDDOeO1WV+C6QAMO02v
 bdieSq625OoJo8XKQVKvWjj4YEhqNHNlRmdxNKWKiG58V+GzXNk0KYbPOrWpV4ISdoIF
 s8PDcLvgVYBN2xLEmDWcGXkbFi7vNVEk4DzQz+nnsWa9xmjqnKQRxz8G7xIbJ0pTaAab
 kj0w==
X-Gm-Message-State: AOAM531U7/syZ3jDVjwQd6dFLYNpvL0EZIdMITbfCS7x4E6eM96sbw4V
 j6a8y0BIljbFXWrViR6fUgw7ejdyl1W19BxmoMe3q+4fc11ROG2NVYYWiDyA2TlDGbtMUwtmHX0
 LMZbVFnfRjGS52OvGVF/9OEGzmEnKJ1RCcP+KHk2uBA==
X-Received: by 2002:a17:90a:df8f:b0:1ce:88eb:443c with SMTP id
 p15-20020a17090adf8f00b001ce88eb443cmr2033964pjv.25.1650425573734; 
 Tue, 19 Apr 2022 20:32:53 -0700 (PDT)
X-Google-Smtp-Source: ABdhPJxHNjIh51MsI0LBWK+QwJxWr1Nb71+TL8g9nNpRLppU/ULXxgTDuUUtSnQ+M2YNOi3CPuqoMQ==
X-Received: by 2002:a17:90a:df8f:b0:1ce:88eb:443c with SMTP id
 p15-20020a17090adf8f00b001ce88eb443cmr2033940pjv.25.1650425573342; 
 Tue, 19 Apr 2022 20:32:53 -0700 (PDT)
Received: from [10.72.14.13] ([209.132.188.80])
 by smtp.gmail.com with ESMTPSA id
 s7-20020aa78bc7000000b005082ddeb6f8sm18066651pfd.199.2022.04.19.20.32.49
 (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
 Tue, 19 Apr 2022 20:32:52 -0700 (PDT)
Message-ID: <af8cff9b-13fd-a591-df88-0abcee083d0e@redhat.com>
Date: Wed, 20 Apr 2022 11:32:48 +0800
MIME-Version: 1.0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:91.0)
 Gecko/20100101 Thunderbird/91.8.0
Subject: Re: [PATCH v2 1/4] virtio-crypto: wait ctrl queue instead of busy
 polling
To: zhenwei pi <pizhenwei@bytedance.com>, arei.gonglei@huawei.com,
 mst@redhat.com
References: <20220418090051.372803-1-pizhenwei@bytedance.com>
 <20220418090051.372803-2-pizhenwei@bytedance.com>
From: Jason Wang <jasowang@redhat.com>
In-Reply-To: <20220418090051.372803-2-pizhenwei@bytedance.com>
Authentication-Results: relay.mimecast.com;
 auth=pass smtp.auth=CUSA124A263 smtp.mailfrom=jasowang@redhat.com
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Content-Language: en-US
Cc: helei.sig11@bytedance.com, linux-kernel@vger.kernel.org,
 virtualization@lists.linux-foundation.org, linux-crypto@vger.kernel.org,
 davem@davemloft.net, herbert@gondor.apana.org.au
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

CuWcqCAyMDIyLzQvMTggMTc6MDAsIHpoZW53ZWkgcGkg5YaZ6YGTOgo+IE9yaWdpbmFsbHksIGFm
dGVyIHN1Ym1pdHRpbmcgcmVxdWVzdCBpbnRvIHZpcnRpbyBjcnlwdG8gY29udHJvbAo+IHF1ZXVl
LCB0aGUgZ3Vlc3Qgc2lkZSBwb2xscyB0aGUgcmVzdWx0IGZyb20gdGhlIHZpcnQgcXVldWUuIFRo
aXMKPiBhbGxvd3MgYWxsIG9mIHRoZSByZXF1ZXN0cyBzaGFyZSBhIHNpbmdsZSByZXF1ZXN0IGJ1
ZmZlciBpbgo+IHN0cnVjdCB2aXJ0aW9fY3J5cHRvKGN0cmwmaW5wdXQmY3RybF9zdGF0dXMpLgo+
ICAgICAgQ1BVMCAgIENQVTEgICAgICAgICAgICAgICAuLi4gICAgICAgICAgICAgQ1BVeCAgQ1BV
eQo+ICAgICAgIHwgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAg
IHwKPiAgICAgICBcICAgICAgXCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvICAg
ICAvCj4gICAgICAgIFwtLS0tLS0tLXNwaW5fbG9jaygmdmNyeXB0by0+Y3RybF9sb2NrKS0tLS0t
LS0vCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKPiAgICAgICAgICAgICAgICAgICB2
aXJ0cXVldWUgYWRkICYga2ljawo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8Cj4gICAg
ICAgICAgICAgICAgICAgIGJ1c3kgcG9sbCB2aXJ0cXVldWUKPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgfAo+ICAgICAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZ2Y3J5cHRvLT5jdHJsX2xv
Y2spCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uCj4KPiBUaGVyZSBhcmUgdHdvIHBy
b2JsZW1zOgo+IDEsIFRoZSBxdWV1ZSBkZXB0aCBpcyBhbHdheXMgMSwgdGhlIHBlcmZvcm1hbmNl
IG9mIGEgdmlydGlvIGNyeXB0bwo+ICAgICBkZXZpY2UgZ2V0cyBsaW1pdGVkLiBNdWx0aSB1c2Vy
IHByb2Nlc3NlcyBzaGFyZSBhIHNpbmdsZSBjb250cm9sCj4gICAgIHF1ZXVlLCBhbmQgaGl0IHNw
aW4gbG9jayByYWNlIGZyb20gY29udHJvbCBxdWV1ZS4gVGVzdCBvbiBJbnRlbAo+ICAgICBQbGF0
aW51bSA4MjYwLCBhIHNpbmdsZSB3b3JrZXIgZ2V0cyB+MzVLL3MgY3JlYXRlL2Nsb3NlIHNlc3Np
b24KPiAgICAgb3BlcmF0aW9ucywgYW5kIDggd29ya2VycyBnZXQgfjQwSy9zIG9wZXJhdGlvbnMg
d2l0aCA4MDAlIENQVQo+ICAgICB1dGlsaXphdGlvbi4KPiAyLCBUaGUgY29udHJvbCByZXF1ZXN0
IGlzIHN1cHBvc2VkIHRvIGdldCBoYW5kbGVkIGltbWVkaWF0ZWx5LCBidXQKPiAgICAgaW4gdGhl
IGN1cnJlbnQgaW1wbGVtZW50YXRpb24gb2YgUUVNVSh2Ni4yKSwgdGhlIHZDUFUgdGhyZWFkIGtp
Y2tzCj4gICAgIGFub3RoZXIgdGhyZWFkIHRvIGRvIHRoaXMgd29yaywgdGhlIGxhdGVuY3kgYWxz
byBnZXRzIHVuc3RhYmxlLgo+ICAgICBUcmFja2luZyBsYXRlbmN5IG9mIHZpcnRpb19jcnlwdG9f
YWxnX2FrY2lwaGVyX2Nsb3NlX3Nlc3Npb24gaW4gNXM6Cj4gICAgICAgICAgdXNlY3MgICAgICAg
ICAgICAgICA6IGNvdW50ICAgICBkaXN0cmlidXRpb24KPiAgICAgICAgICAgMCAtPiAxICAgICAg
ICAgIDogMCAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgIHwKPiAgICAgICAgICAgMiAt
PiAzICAgICAgICAgIDogNyAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgIHwKPiAgICAg
ICAgICAgNCAtPiA3ICAgICAgICAgIDogNzIgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAg
IHwKPiAgICAgICAgICAgOCAtPiAxNSAgICAgICAgIDogMTg2NDg1ICAgfCoqKioqKioqKioqKioq
KioqKioqKioqKnwKPiAgICAgICAgICAxNiAtPiAzMSAgICAgICAgIDogNjg3ICAgICAgfCAgICAg
ICAgICAgICAgICAgICAgICAgIHwKPiAgICAgICAgICAzMiAtPiA2MyAgICAgICAgIDogNSAgICAg
ICAgfCAgICAgICAgICAgICAgICAgICAgICAgIHwKPiAgICAgICAgICA2NCAtPiAxMjcgICAgICAg
IDogMyAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgIHwKPiAgICAgICAgIDEyOCAtPiAy
NTUgICAgICAgIDogMSAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgIHwKPiAgICAgICAg
IDI1NiAtPiA1MTEgICAgICAgIDogMCAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgIHwK
PiAgICAgICAgIDUxMiAtPiAxMDIzICAgICAgIDogMCAgICAgICAgfCAgICAgICAgICAgICAgICAg
ICAgICAgIHwKPiAgICAgICAgMTAyNCAtPiAyMDQ3ICAgICAgIDogMCAgICAgICAgfCAgICAgICAg
ICAgICAgICAgICAgICAgIHwKPiAgICAgICAgMjA0OCAtPiA0MDk1ICAgICAgIDogMCAgICAgICAg
fCAgICAgICAgICAgICAgICAgICAgICAgIHwKPiAgICAgICAgNDA5NiAtPiA4MTkxICAgICAgIDog
MCAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgIHwKPiAgICAgICAgODE5MiAtPiAxNjM4
MyAgICAgIDogMiAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgIHwKPiAgICAgVGhpcyBt
ZWFucyB0aGF0IGEgQ1BVIG1heSBob2xkIHZjcnlwdG8tPmN0cmxfbG9jayBhcyBsb25nIGFzIDgx
OTJ+MTYzODN1cy4KPgo+IFRvIGltcHJvdmUgdGhlIHBlcmZvcm1hbmNlIG9mIGNvbnRyb2wgcXVl
dWUsIHJlbW92ZSBjdHJsJmlucHV0JmN0cmxfc3RhdHVzIGZyb20KPiBzdHJ1Y3QgdmlydGlvX2Ny
eXB0bywgZWFjaCByZXF1ZXN0IGFsbG9jYXRlcyByZXF1ZXN0IGJ1ZmZlciBkeW5hbWljYWxseSwg
d2FpdHMKPiBjb21wbGV0aW9uIGluc3RlYWQgb2YgYnVzeSBwb2xsaW5nIHRvIHJlZHVjZSBsb2Nr
IHJhY2luZywgYW5kIGdldHMgY29tcGxldGVkIGJ5Cj4gY29udHJvbCBxdWV1ZSBjYWxsYmFjay4K
CgpJZiBwb3NzaWJsZSwgSSB3b3VsZCBsaWtlIHRvIHNwbGl0IHRoaXMgcGF0Y2ggaW50byB0d286
CgoKMSkgdXNpbmcgcHJpdmF0ZSBidWZmZXIKCjIpIHJlbW92ZSB0aGUgYnVzeSBwb2xsaW5nCgoK
PiAgICAgIENQVTAgICBDUFUxICAgICAgICAgICAgICAgLi4uICAgICAgICAgICAgIENQVXggIENQ
VXkKPiAgICAgICB8ICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAg
ICB8Cj4gICAgICAgXCAgICAgIFwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyAg
ICAgLwo+ICAgICAgICBcLS0tLS0tLS1zcGluX2xvY2soJnZjcnlwdG8tPmN0cmxfbG9jayktLS0t
LS0tLwo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8Cj4gICAgICAgICAgICAgICAgICAg
dmlydHF1ZXVlIGFkZCAmIGtpY2sKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAo+ICAg
ICAgICAtLS0tLS0tLS1zcGluX3VubG9jaygmdmNyeXB0by0+Y3RybF9sb2NrKS0tLS0tLQo+ICAg
ICAgIC8gICAgICAvICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwgICAgIFwKPiAg
ICAgICB8ICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICB8Cj4g
ICAgICB3YWl0ICAgd2FpdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0ICB3YWl0
Cj4KPiBUZXN0IHRoaXMgcGF0Y2gsIHRoZSBndWVzdCBzaWRlIGdldCB+MjAwSy9zIG9wZXJhdGlv
bnMgd2l0aCAzMDAlIENQVQo+IHV0aWxpemF0aW9uLgoKCldoYXQncyBtb3JlLCB0aGlzIGNvdWxk
IGJlIHBhcnQgb2YgdGhlIGhhcmRlbmluZyBzaW5jZSBpdCBoZWxwIHRvIHJlZHVjZSAKdGhlIHBv
c3NpYmlsaXR5IG9mIERPUyBmcm9tIHRoZSBidWdneSBkZXZpY2UuIEkgdGhpbmsgd2UgbmVlZCB0
byBhdm9pZCAKYnVzeSBwb2xsaW5nIGZvciBhbGwgY3RybCB2aXJ0cXVldWVzIChlLmcgdGhlIG9u
ZSBpbiB0aGUgdmlydGlvLW5ldCkuCgpUaGFua3MKCgo+Cj4gU2lnbmVkLW9mZi1ieTogemhlbndl
aSBwaSA8cGl6aGVud2VpQGJ5dGVkYW5jZS5jb20+Cj4gLS0tCj4gICBkcml2ZXJzL2NyeXB0by92
aXJ0aW8vTWFrZWZpbGUgICAgICAgICAgICAgICAgfCAgIDEgKwo+ICAgLi4uL3ZpcnRpby92aXJ0
aW9fY3J5cHRvX2FrY2lwaGVyX2FsZ3MuYyAgICAgIHwgIDkwICsrKysrKy0tLS0tLQo+ICAgZHJp
dmVycy9jcnlwdG8vdmlydGlvL3ZpcnRpb19jcnlwdG9fY29tbW9uLmMgIHwgIDYxICsrKysrKysr
Cj4gICBkcml2ZXJzL2NyeXB0by92aXJ0aW8vdmlydGlvX2NyeXB0b19jb21tb24uaCAgfCAgMjUg
KysrLQo+ICAgZHJpdmVycy9jcnlwdG8vdmlydGlvL3ZpcnRpb19jcnlwdG9fY29yZS5jICAgIHwg
ICAyICstCj4gICAuLi4vdmlydGlvL3ZpcnRpb19jcnlwdG9fc2tjaXBoZXJfYWxncy5jICAgICAg
fCAxMzMgKysrKysrKystLS0tLS0tLS0tCj4gICA2IGZpbGVzIGNoYW5nZWQsIDE4NSBpbnNlcnRp
b25zKCspLCAxMjcgZGVsZXRpb25zKC0pCj4gICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9j
cnlwdG8vdmlydGlvL3ZpcnRpb19jcnlwdG9fY29tbW9uLmMKPgo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2NyeXB0by92aXJ0aW8vTWFrZWZpbGUgYi9kcml2ZXJzL2NyeXB0by92aXJ0aW8vTWFrZWZp
bGUKPiBpbmRleCBiZmE2Y2JhZTM0MmUuLjQ5YzFmYTgwZTQ2NSAxMDA2NDQKPiAtLS0gYS9kcml2
ZXJzL2NyeXB0by92aXJ0aW8vTWFrZWZpbGUKPiArKysgYi9kcml2ZXJzL2NyeXB0by92aXJ0aW8v
TWFrZWZpbGUKPiBAQCAtMyw1ICszLDYgQEAgb2JqLSQoQ09ORklHX0NSWVBUT19ERVZfVklSVElP
KSArPSB2aXJ0aW9fY3J5cHRvLm8KPiAgIHZpcnRpb19jcnlwdG8tb2JqcyA6PSBcCj4gICAJdmly
dGlvX2NyeXB0b19za2NpcGhlcl9hbGdzLm8gXAo+ICAgCXZpcnRpb19jcnlwdG9fYWtjaXBoZXJf
YWxncy5vIFwKPiArCXZpcnRpb19jcnlwdG9fY29tbW9uLm8gXAo+ICAgCXZpcnRpb19jcnlwdG9f
bWdyLm8gXAo+ICAgCXZpcnRpb19jcnlwdG9fY29yZS5vCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Y3J5cHRvL3ZpcnRpby92aXJ0aW9fY3J5cHRvX2FrY2lwaGVyX2FsZ3MuYyBiL2RyaXZlcnMvY3J5
cHRvL3ZpcnRpby92aXJ0aW9fY3J5cHRvX2FrY2lwaGVyX2FsZ3MuYwo+IGluZGV4IGYzZWM5NDIw
MjE1ZS4uOTU2MWJjMmRmNjJiIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvY3J5cHRvL3ZpcnRpby92
aXJ0aW9fY3J5cHRvX2FrY2lwaGVyX2FsZ3MuYwo+ICsrKyBiL2RyaXZlcnMvY3J5cHRvL3ZpcnRp
by92aXJ0aW9fY3J5cHRvX2FrY2lwaGVyX2FsZ3MuYwo+IEBAIC0xMDIsOCArMTAyLDggQEAgc3Rh
dGljIGludCB2aXJ0aW9fY3J5cHRvX2FsZ19ha2NpcGhlcl9pbml0X3Nlc3Npb24oc3RydWN0IHZp
cnRpb19jcnlwdG9fYWtjaXBoZXIKPiAgIHsKPiAgIAlzdHJ1Y3Qgc2NhdHRlcmxpc3Qgb3V0aGRy
X3NnLCBrZXlfc2csIGluaGRyX3NnLCAqc2dzWzNdOwo+ICAgCXN0cnVjdCB2aXJ0aW9fY3J5cHRv
ICp2Y3J5cHRvID0gY3R4LT52Y3J5cHRvOwo+ICsJc3RydWN0IHZpcnRpb19jcnlwdG9fY3RybF9y
ZXF1ZXN0ICp2Y19jdHJsX3JlcTsKPiAgIAl1aW50OF90ICpwa2V5Owo+IC0JdW5zaWduZWQgaW50
IGlubGVuOwo+ICAgCWludCBlcnI7Cj4gICAJdW5zaWduZWQgaW50IG51bV9vdXQgPSAwLCBudW1f
aW4gPSAwOwo+ICAgCj4gQEAgLTExMSw5OCArMTExLDkxIEBAIHN0YXRpYyBpbnQgdmlydGlvX2Ny
eXB0b19hbGdfYWtjaXBoZXJfaW5pdF9zZXNzaW9uKHN0cnVjdCB2aXJ0aW9fY3J5cHRvX2FrY2lw
aGVyCj4gICAJaWYgKCFwa2V5KQo+ICAgCQlyZXR1cm4gLUVOT01FTTsKPiAgIAo+IC0Jc3Bpbl9s
b2NrKCZ2Y3J5cHRvLT5jdHJsX2xvY2spOwo+IC0JbWVtY3B5KCZ2Y3J5cHRvLT5jdHJsLmhlYWRl
ciwgaGVhZGVyLCBzaXplb2YodmNyeXB0by0+Y3RybC5oZWFkZXIpKTsKPiAtCW1lbWNweSgmdmNy
eXB0by0+Y3RybC51LCBwYXJhLCBzaXplb2YodmNyeXB0by0+Y3RybC51KSk7Cj4gLQl2Y3J5cHRv
LT5pbnB1dC5zdGF0dXMgPSBjcHVfdG9fbGUzMihWSVJUSU9fQ1JZUFRPX0VSUik7Cj4gKwl2Y19j
dHJsX3JlcSA9IGt6YWxsb2Moc2l6ZW9mKCp2Y19jdHJsX3JlcSksIEdGUF9LRVJORUwpOwo+ICsJ
aWYgKCF2Y19jdHJsX3JlcSkgewo+ICsJCWVyciA9IC1FTk9NRU07Cj4gKwkJZ290byBvdXQ7Cj4g
Kwl9Cj4gICAKPiAtCXNnX2luaXRfb25lKCZvdXRoZHJfc2csICZ2Y3J5cHRvLT5jdHJsLCBzaXpl
b2YodmNyeXB0by0+Y3RybCkpOwo+ICsJbWVtY3B5KCZ2Y19jdHJsX3JlcS0+Y3RybC5oZWFkZXIs
IGhlYWRlciwgc2l6ZW9mKHZjX2N0cmxfcmVxLT5jdHJsLmhlYWRlcikpOwo+ICsJbWVtY3B5KCZ2
Y19jdHJsX3JlcS0+Y3RybC51LCBwYXJhLCBzaXplb2YodmNfY3RybF9yZXEtPmN0cmwudSkpOwo+
ICsJc2dfaW5pdF9vbmUoJm91dGhkcl9zZywgJnZjX2N0cmxfcmVxLT5jdHJsLCBzaXplb2YodmNf
Y3RybF9yZXEtPmN0cmwpKTsKPiAgIAlzZ3NbbnVtX291dCsrXSA9ICZvdXRoZHJfc2c7Cj4gICAK
PiAgIAlzZ19pbml0X29uZSgma2V5X3NnLCBwa2V5LCBrZXlsZW4pOwo+ICAgCXNnc1tudW1fb3V0
KytdID0gJmtleV9zZzsKPiAgIAo+IC0Jc2dfaW5pdF9vbmUoJmluaGRyX3NnLCAmdmNyeXB0by0+
aW5wdXQsIHNpemVvZih2Y3J5cHRvLT5pbnB1dCkpOwo+ICsJdmNfY3RybF9yZXEtPmlucHV0LnN0
YXR1cyA9IGNwdV90b19sZTMyKFZJUlRJT19DUllQVE9fRVJSKTsKPiArCXNnX2luaXRfb25lKCZp
bmhkcl9zZywgJnZjX2N0cmxfcmVxLT5pbnB1dCwgc2l6ZW9mKHZjX2N0cmxfcmVxLT5pbnB1dCkp
Owo+ICAgCXNnc1tudW1fb3V0ICsgbnVtX2luKytdID0gJmluaGRyX3NnOwo+ICAgCj4gLQllcnIg
PSB2aXJ0cXVldWVfYWRkX3Nncyh2Y3J5cHRvLT5jdHJsX3ZxLCBzZ3MsIG51bV9vdXQsIG51bV9p
biwgdmNyeXB0bywgR0ZQX0FUT01JQyk7Cj4gKwllcnIgPSB2aXJ0aW9fY3J5cHRvX2N0cmxfdnFf
cmVxdWVzdCh2Y3J5cHRvLCBzZ3MsIG51bV9vdXQsIG51bV9pbiwgdmNfY3RybF9yZXEpOwo+ICAg
CWlmIChlcnIgPCAwKQo+ICAgCQlnb3RvIG91dDsKPiAgIAo+IC0JdmlydHF1ZXVlX2tpY2sodmNy
eXB0by0+Y3RybF92cSk7Cj4gLQl3aGlsZSAoIXZpcnRxdWV1ZV9nZXRfYnVmKHZjcnlwdG8tPmN0
cmxfdnEsICZpbmxlbikgJiYKPiAtCSAgICAgICAhdmlydHF1ZXVlX2lzX2Jyb2tlbih2Y3J5cHRv
LT5jdHJsX3ZxKSkKPiAtCQljcHVfcmVsYXgoKTsKPiAtCj4gLQlpZiAobGUzMl90b19jcHUodmNy
eXB0by0+aW5wdXQuc3RhdHVzKSAhPSBWSVJUSU9fQ1JZUFRPX09LKSB7Cj4gKwlpZiAobGUzMl90
b19jcHUodmNfY3RybF9yZXEtPmlucHV0LnN0YXR1cykgIT0gVklSVElPX0NSWVBUT19PSykgewo+
ICsJCXByX2VycigidmlydGlvX2NyeXB0bzogQ3JlYXRlIHNlc3Npb24gZmFpbGVkIHN0YXR1czog
JXVcbiIsCj4gKwkJCWxlMzJfdG9fY3B1KHZjX2N0cmxfcmVxLT5pbnB1dC5zdGF0dXMpKTsKPiAg
IAkJZXJyID0gLUVJTlZBTDsKPiAgIAkJZ290byBvdXQ7Cj4gICAJfQo+ICAgCj4gLQljdHgtPnNl
c3Npb25faWQgPSBsZTY0X3RvX2NwdSh2Y3J5cHRvLT5pbnB1dC5zZXNzaW9uX2lkKTsKPiArCWN0
eC0+c2Vzc2lvbl9pZCA9IGxlNjRfdG9fY3B1KHZjX2N0cmxfcmVxLT5pbnB1dC5zZXNzaW9uX2lk
KTsKPiAgIAljdHgtPnNlc3Npb25fdmFsaWQgPSB0cnVlOwo+ICAgCWVyciA9IDA7Cj4gICAKPiAg
IG91dDoKPiAtCXNwaW5fdW5sb2NrKCZ2Y3J5cHRvLT5jdHJsX2xvY2spOwo+ICsJa2ZyZWUodmNf
Y3RybF9yZXEpOwo+ICAgCWtmcmVlX3NlbnNpdGl2ZShwa2V5KTsKPiAgIAo+IC0JaWYgKGVyciA8
IDApCj4gLQkJcHJfZXJyKCJ2aXJ0aW9fY3J5cHRvOiBDcmVhdGUgc2Vzc2lvbiBmYWlsZWQgc3Rh
dHVzOiAldVxuIiwKPiAtCQkJbGUzMl90b19jcHUodmNyeXB0by0+aW5wdXQuc3RhdHVzKSk7Cj4g
LQo+ICAgCXJldHVybiBlcnI7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgdmlydGlvX2NyeXB0
b19hbGdfYWtjaXBoZXJfY2xvc2Vfc2Vzc2lvbihzdHJ1Y3QgdmlydGlvX2NyeXB0b19ha2NpcGhl
cl9jdHggKmN0eCkKPiAgIHsKPiAgIAlzdHJ1Y3Qgc2NhdHRlcmxpc3Qgb3V0aGRyX3NnLCBpbmhk
cl9zZywgKnNnc1syXTsKPiArCXN0cnVjdCB2aXJ0aW9fY3J5cHRvX2N0cmxfcmVxdWVzdCAqdmNf
Y3RybF9yZXE7Cj4gICAJc3RydWN0IHZpcnRpb19jcnlwdG9fZGVzdHJveV9zZXNzaW9uX3JlcSAq
ZGVzdHJveV9zZXNzaW9uOwo+ICAgCXN0cnVjdCB2aXJ0aW9fY3J5cHRvICp2Y3J5cHRvID0gY3R4
LT52Y3J5cHRvOwo+IC0JdW5zaWduZWQgaW50IG51bV9vdXQgPSAwLCBudW1faW4gPSAwLCBpbmxl
bjsKPiArCXVuc2lnbmVkIGludCBudW1fb3V0ID0gMCwgbnVtX2luID0gMDsKPiAgIAlpbnQgZXJy
Owo+ICAgCj4gLQlzcGluX2xvY2soJnZjcnlwdG8tPmN0cmxfbG9jayk7Cj4gLQlpZiAoIWN0eC0+
c2Vzc2lvbl92YWxpZCkgewo+IC0JCWVyciA9IDA7Cj4gLQkJZ290byBvdXQ7Cj4gLQl9Cj4gLQl2
Y3J5cHRvLT5jdHJsX3N0YXR1cy5zdGF0dXMgPSBWSVJUSU9fQ1JZUFRPX0VSUjsKPiAtCXZjcnlw
dG8tPmN0cmwuaGVhZGVyLm9wY29kZSA9IGNwdV90b19sZTMyKFZJUlRJT19DUllQVE9fQUtDSVBI
RVJfREVTVFJPWV9TRVNTSU9OKTsKPiAtCXZjcnlwdG8tPmN0cmwuaGVhZGVyLnF1ZXVlX2lkID0g
MDsKPiArCWlmICghY3R4LT5zZXNzaW9uX3ZhbGlkKQo+ICsJCXJldHVybiAwOwo+ICAgCj4gLQlk
ZXN0cm95X3Nlc3Npb24gPSAmdmNyeXB0by0+Y3RybC51LmRlc3Ryb3lfc2Vzc2lvbjsKPiArCXZj
X2N0cmxfcmVxID0ga3phbGxvYyhzaXplb2YoKnZjX2N0cmxfcmVxKSwgR0ZQX0tFUk5FTCk7Cj4g
KwlpZiAoIXZjX2N0cmxfcmVxKQo+ICsJCXJldHVybiAtRU5PTUVNOwo+ICsKPiArCXZjX2N0cmxf
cmVxLT5jdHJsLmhlYWRlci5vcGNvZGUgPSBjcHVfdG9fbGUzMihWSVJUSU9fQ1JZUFRPX0FLQ0lQ
SEVSX0RFU1RST1lfU0VTU0lPTik7Cj4gKwl2Y19jdHJsX3JlcS0+Y3RybC5oZWFkZXIucXVldWVf
aWQgPSAwOwo+ICsKPiArCWRlc3Ryb3lfc2Vzc2lvbiA9ICZ2Y19jdHJsX3JlcS0+Y3RybC51LmRl
c3Ryb3lfc2Vzc2lvbjsKPiAgIAlkZXN0cm95X3Nlc3Npb24tPnNlc3Npb25faWQgPSBjcHVfdG9f
bGU2NChjdHgtPnNlc3Npb25faWQpOwo+ICAgCj4gLQlzZ19pbml0X29uZSgmb3V0aGRyX3NnLCAm
dmNyeXB0by0+Y3RybCwgc2l6ZW9mKHZjcnlwdG8tPmN0cmwpKTsKPiArCXNnX2luaXRfb25lKCZv
dXRoZHJfc2csICZ2Y19jdHJsX3JlcS0+Y3RybCwgc2l6ZW9mKHZjX2N0cmxfcmVxLT5jdHJsKSk7
Cj4gICAJc2dzW251bV9vdXQrK10gPSAmb3V0aGRyX3NnOwo+ICAgCj4gLQlzZ19pbml0X29uZSgm
aW5oZHJfc2csICZ2Y3J5cHRvLT5jdHJsX3N0YXR1cy5zdGF0dXMsIHNpemVvZih2Y3J5cHRvLT5j
dHJsX3N0YXR1cy5zdGF0dXMpKTsKPiArCXZjX2N0cmxfcmVxLT5jdHJsX3N0YXR1cy5zdGF0dXMg
PSBWSVJUSU9fQ1JZUFRPX0VSUjsKPiArCXNnX2luaXRfb25lKCZpbmhkcl9zZywgJnZjX2N0cmxf
cmVxLT5jdHJsX3N0YXR1cy5zdGF0dXMsCj4gKwkJc2l6ZW9mKHZjX2N0cmxfcmVxLT5jdHJsX3N0
YXR1cy5zdGF0dXMpKTsKPiAgIAlzZ3NbbnVtX291dCArIG51bV9pbisrXSA9ICZpbmhkcl9zZzsK
PiAgIAo+IC0JZXJyID0gdmlydHF1ZXVlX2FkZF9zZ3ModmNyeXB0by0+Y3RybF92cSwgc2dzLCBu
dW1fb3V0LCBudW1faW4sIHZjcnlwdG8sIEdGUF9BVE9NSUMpOwo+ICsJZXJyID0gdmlydGlvX2Ny
eXB0b19jdHJsX3ZxX3JlcXVlc3QodmNyeXB0bywgc2dzLCBudW1fb3V0LCBudW1faW4sIHZjX2N0
cmxfcmVxKTsKPiAgIAlpZiAoZXJyIDwgMCkKPiAgIAkJZ290byBvdXQ7Cj4gICAKPiAtCXZpcnRx
dWV1ZV9raWNrKHZjcnlwdG8tPmN0cmxfdnEpOwo+IC0Jd2hpbGUgKCF2aXJ0cXVldWVfZ2V0X2J1
Zih2Y3J5cHRvLT5jdHJsX3ZxLCAmaW5sZW4pICYmCj4gLQkgICAgICAgIXZpcnRxdWV1ZV9pc19i
cm9rZW4odmNyeXB0by0+Y3RybF92cSkpCj4gLQkJY3B1X3JlbGF4KCk7Cj4gLQo+IC0JaWYgKHZj
cnlwdG8tPmN0cmxfc3RhdHVzLnN0YXR1cyAhPSBWSVJUSU9fQ1JZUFRPX09LKSB7Cj4gKwlpZiAo
dmNfY3RybF9yZXEtPmN0cmxfc3RhdHVzLnN0YXR1cyAhPSBWSVJUSU9fQ1JZUFRPX09LKSB7Cj4g
ICAJCWVyciA9IC1FSU5WQUw7Cj4gKwkJcHJfZXJyKCJ2aXJ0aW9fY3J5cHRvOiBDbG9zZSBzZXNz
aW9uIGZhaWxlZCBzdGF0dXM6ICV1LCBzZXNzaW9uX2lkOiAweCVsbHhcbiIsCj4gKwkJCXZjX2N0
cmxfcmVxLT5jdHJsX3N0YXR1cy5zdGF0dXMsIGRlc3Ryb3lfc2Vzc2lvbi0+c2Vzc2lvbl9pZCk7
Cj4gICAJCWdvdG8gb3V0Owo+ICAgCX0KPiAgIAo+ICAgCWVyciA9IDA7Cj4gICAJY3R4LT5zZXNz
aW9uX3ZhbGlkID0gZmFsc2U7Cj4gLQo+ICAgb3V0Ogo+IC0Jc3Bpbl91bmxvY2soJnZjcnlwdG8t
PmN0cmxfbG9jayk7Cj4gLQlpZiAoZXJyIDwgMCkgewo+IC0JCXByX2VycigidmlydGlvX2NyeXB0
bzogQ2xvc2Ugc2Vzc2lvbiBmYWlsZWQgc3RhdHVzOiAldSwgc2Vzc2lvbl9pZDogMHglbGx4XG4i
LAo+IC0JCQl2Y3J5cHRvLT5jdHJsX3N0YXR1cy5zdGF0dXMsIGRlc3Ryb3lfc2Vzc2lvbi0+c2Vz
c2lvbl9pZCk7Cj4gLQl9Cj4gKwlrZnJlZSh2Y19jdHJsX3JlcSk7Cj4gICAKPiAgIAlyZXR1cm4g
ZXJyOwo+ICAgfQo+IEBAIC0yMTAsMTQgKzIwMywxMSBAQCBzdGF0aWMgaW50IHZpcnRpb19jcnlw
dG9fYWxnX2FrY2lwaGVyX2Nsb3NlX3Nlc3Npb24oc3RydWN0IHZpcnRpb19jcnlwdG9fYWtjaXBo
ZQo+ICAgc3RhdGljIGludCBfX3ZpcnRpb19jcnlwdG9fYWtjaXBoZXJfZG9fcmVxKHN0cnVjdCB2
aXJ0aW9fY3J5cHRvX2FrY2lwaGVyX3JlcXVlc3QgKnZjX2FrY2lwaGVyX3JlcSwKPiAgIAkJc3Ry
dWN0IGFrY2lwaGVyX3JlcXVlc3QgKnJlcSwgc3RydWN0IGRhdGFfcXVldWUgKmRhdGFfdnEpCj4g
ICB7Cj4gLQlzdHJ1Y3QgdmlydGlvX2NyeXB0b19ha2NpcGhlcl9jdHggKmN0eCA9IHZjX2FrY2lw
aGVyX3JlcS0+YWtjaXBoZXJfY3R4Owo+ICAgCXN0cnVjdCB2aXJ0aW9fY3J5cHRvX3JlcXVlc3Qg
KnZjX3JlcSA9ICZ2Y19ha2NpcGhlcl9yZXEtPmJhc2U7Cj4gLQlzdHJ1Y3QgdmlydGlvX2NyeXB0
byAqdmNyeXB0byA9IGN0eC0+dmNyeXB0bzsKPiAgIAlzdHJ1Y3QgdmlydGlvX2NyeXB0b19vcF9k
YXRhX3JlcSAqcmVxX2RhdGEgPSB2Y19yZXEtPnJlcV9kYXRhOwo+ICAgCXN0cnVjdCBzY2F0dGVy
bGlzdCAqc2dzWzRdLCBvdXRoZHJfc2csIGluaGRyX3NnLCBzcmNkYXRhX3NnLCBkc3RkYXRhX3Nn
Owo+ICAgCXZvaWQgKnNyY19idWYgPSBOVUxMLCAqZHN0X2J1ZiA9IE5VTEw7Cj4gICAJdW5zaWdu
ZWQgaW50IG51bV9vdXQgPSAwLCBudW1faW4gPSAwOwo+IC0JaW50IG5vZGUgPSBkZXZfdG9fbm9k
ZSgmdmNyeXB0by0+dmRldi0+ZGV2KTsKPiAgIAl1bnNpZ25lZCBsb25nIGZsYWdzOwo+ICAgCWlu
dCByZXQgPSAtRU5PTUVNOwo+ICAgCWJvb2wgdmVyaWZ5ID0gdmNfYWtjaXBoZXJfcmVxLT5vcGNv
ZGUgPT0gVklSVElPX0NSWVBUT19BS0NJUEhFUl9WRVJJRlk7Cj4gQEAgLTIyOCw3ICsyMTgsNyBA
QCBzdGF0aWMgaW50IF9fdmlydGlvX2NyeXB0b19ha2NpcGhlcl9kb19yZXEoc3RydWN0IHZpcnRp
b19jcnlwdG9fYWtjaXBoZXJfcmVxdWVzdAo+ICAgCXNnc1tudW1fb3V0KytdID0gJm91dGhkcl9z
ZzsKPiAgIAo+ICAgCS8qIHNyYyBkYXRhICovCj4gLQlzcmNfYnVmID0ga2NhbGxvY19ub2RlKHNy
Y19sZW4sIDEsIEdGUF9LRVJORUwsIG5vZGUpOwo+ICsJc3JjX2J1ZiA9IGtjYWxsb2Moc3JjX2xl
biwgMSwgR0ZQX0tFUk5FTCk7Cj4gICAJaWYgKCFzcmNfYnVmKQo+ICAgCQlnb3RvIGVycjsKPiAg
IAo+IEBAIC0yNDMsNyArMjMzLDcgQEAgc3RhdGljIGludCBfX3ZpcnRpb19jcnlwdG9fYWtjaXBo
ZXJfZG9fcmVxKHN0cnVjdCB2aXJ0aW9fY3J5cHRvX2FrY2lwaGVyX3JlcXVlc3QKPiAgIAkJc2dz
W251bV9vdXQrK10gPSAmc3JjZGF0YV9zZzsKPiAgIAo+ICAgCQkvKiBkc3QgZGF0YSAqLwo+IC0J
CWRzdF9idWYgPSBrY2FsbG9jX25vZGUocmVxLT5kc3RfbGVuLCAxLCBHRlBfS0VSTkVMLCBub2Rl
KTsKPiArCQlkc3RfYnVmID0ga2NhbGxvYyhyZXEtPmRzdF9sZW4sIDEsIEdGUF9LRVJORUwpOwo+
ICAgCQlpZiAoIWRzdF9idWYpCj4gICAJCQlnb3RvIGVycjsKPiAgIAo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2NyeXB0by92aXJ0aW8vdmlydGlvX2NyeXB0b19jb21tb24uYyBiL2RyaXZlcnMvY3J5
cHRvL3ZpcnRpby92aXJ0aW9fY3J5cHRvX2NvbW1vbi5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQK
PiBpbmRleCAwMDAwMDAwMDAwMDAuLjkzZGY3M2M0MGRkMwo+IC0tLSAvZGV2L251bGwKPiArKysg
Yi9kcml2ZXJzL2NyeXB0by92aXJ0aW8vdmlydGlvX2NyeXB0b19jb21tb24uYwo+IEBAIC0wLDAg
KzEsNjEgQEAKPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb3ItbGF0ZXIK
PiArLyogQ29tbW9uIGZ1bmN0aW9ucyBhbmQgaGVscGVycwo+ICsgKgo+ICsgKiBBdXRob3JzOiB6
aGVud2VpIHBpIDxwaXpoZW53ZWlAYnl0ZWRhbmNlLmNvbT4KPiArICoKPiArICogQ29weXJpZ2h0
IDIwMjIgQnl0ZWRhbmNlIENPLiwgTFRELgo+ICsgKi8KPiArCj4gKyNpbmNsdWRlICJ2aXJ0aW9f
Y3J5cHRvX2NvbW1vbi5oIgo+ICsKPiArc3RhdGljIHZvaWQgdmlydGlvX2NyeXB0b19jdHJscV9j
YWxsYmFjayhzdHJ1Y3QgdmlydGlvX2NyeXB0b19jdHJsX3JlcXVlc3QgKnZjX2N0cmxfcmVxKQo+
ICt7Cj4gKwljb21wbGV0ZSgmdmNfY3RybF9yZXEtPmNvbXBsKTsKPiArfQo+ICsKPiAraW50IHZp
cnRpb19jcnlwdG9fY3RybF92cV9yZXF1ZXN0KHN0cnVjdCB2aXJ0aW9fY3J5cHRvICp2Y3J5cHRv
LCBzdHJ1Y3Qgc2NhdHRlcmxpc3QgKnNnc1tdLAo+ICsJCQkJICB1bnNpZ25lZCBpbnQgb3V0X3Nn
cywgdW5zaWduZWQgaW50IGluX3NncywKPiArCQkJCSAgc3RydWN0IHZpcnRpb19jcnlwdG9fY3Ry
bF9yZXF1ZXN0ICp2Y19jdHJsX3JlcSkKPiArewo+ICsJaW50IGVycjsKPiArCXVuc2lnbmVkIGxv
bmcgZmxhZ3M7Cj4gKwo+ICsJaW5pdF9jb21wbGV0aW9uKCZ2Y19jdHJsX3JlcS0+Y29tcGwpOwo+
ICsJdmNfY3RybF9yZXEtPmN0cmxfY2IgPSAgdmlydGlvX2NyeXB0b19jdHJscV9jYWxsYmFjazsK
PiArCj4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmdmNyeXB0by0+Y3RybF9sb2NrLCBmbGFncyk7Cj4g
KwllcnIgPSB2aXJ0cXVldWVfYWRkX3Nncyh2Y3J5cHRvLT5jdHJsX3ZxLCBzZ3MsIG91dF9zZ3Ms
IGluX3NncywgdmNfY3RybF9yZXEsIEdGUF9BVE9NSUMpOwo+ICsJaWYgKGVyciA8IDApIHsKPiAr
CQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ2Y3J5cHRvLT5jdHJsX2xvY2ssIGZsYWdzKTsKPiAr
CQlyZXR1cm4gZXJyOwo+ICsJfQo+ICsKPiArCXZpcnRxdWV1ZV9raWNrKHZjcnlwdG8tPmN0cmxf
dnEpOwo+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdmNyeXB0by0+Y3RybF9sb2NrLCBmbGFn
cyk7Cj4gKwo+ICsJd2FpdF9mb3JfY29tcGxldGlvbigmdmNfY3RybF9yZXEtPmNvbXBsKTsKPiAr
Cj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArdm9pZCB2aXJ0Y3J5cHRvX2N0cmxxX2NhbGxiYWNr
KHN0cnVjdCB2aXJ0cXVldWUgKnZxKQo+ICt7Cj4gKwlzdHJ1Y3QgdmlydGlvX2NyeXB0byAqdmNy
eXB0byA9IHZxLT52ZGV2LT5wcml2Owo+ICsJc3RydWN0IHZpcnRpb19jcnlwdG9fY3RybF9yZXF1
ZXN0ICp2Y19jdHJsX3JlcTsKPiArCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gKwl1bnNpZ25lZCBp
bnQgbGVuOwo+ICsKPiArCXNwaW5fbG9ja19pcnFzYXZlKCZ2Y3J5cHRvLT5jdHJsX2xvY2ssIGZs
YWdzKTsKPiArCWRvIHsKPiArCQl2aXJ0cXVldWVfZGlzYWJsZV9jYih2cSk7Cj4gKwkJd2hpbGUg
KCh2Y19jdHJsX3JlcSA9IHZpcnRxdWV1ZV9nZXRfYnVmKHZxLCAmbGVuKSkgIT0gTlVMTCkgewo+
ICsJCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ2Y3J5cHRvLT5jdHJsX2xvY2ssIGZsYWdzKTsK
PiArCQkJaWYgKHZjX2N0cmxfcmVxLT5jdHJsX2NiKQo+ICsJCQkJdmNfY3RybF9yZXEtPmN0cmxf
Y2IodmNfY3RybF9yZXEpOwo+ICsJCQlzcGluX2xvY2tfaXJxc2F2ZSgmdmNyeXB0by0+Y3RybF9s
b2NrLCBmbGFncyk7Cj4gKwkJfQo+ICsJCWlmICh1bmxpa2VseSh2aXJ0cXVldWVfaXNfYnJva2Vu
KHZxKSkpCj4gKwkJCWJyZWFrOwo+ICsJfSB3aGlsZSAoIXZpcnRxdWV1ZV9lbmFibGVfY2IodnEp
KTsKPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnZjcnlwdG8tPmN0cmxfbG9jaywgZmxhZ3Mp
Owo+ICt9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvY3J5cHRvL3ZpcnRpby92aXJ0aW9fY3J5cHRv
X2NvbW1vbi5oIGIvZHJpdmVycy9jcnlwdG8vdmlydGlvL3ZpcnRpb19jcnlwdG9fY29tbW9uLmgK
PiBpbmRleCBlNjkzZDRlZTgzYTYuLmI5MGFjMGNlMzBkMiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2NyeXB0by92aXJ0aW8vdmlydGlvX2NyeXB0b19jb21tb24uaAo+ICsrKyBiL2RyaXZlcnMvY3J5
cHRvL3ZpcnRpby92aXJ0aW9fY3J5cHRvX2NvbW1vbi5oCj4gQEAgLTEzLDYgKzEzLDcgQEAKPiAg
ICNpbmNsdWRlIDxjcnlwdG8vYWVhZC5oPgo+ICAgI2luY2x1ZGUgPGNyeXB0by9hZXMuaD4KPiAg
ICNpbmNsdWRlIDxjcnlwdG8vZW5naW5lLmg+Cj4gKyNpbmNsdWRlIDx1YXBpL2xpbnV4L3ZpcnRp
b19jcnlwdG8uaD4KPiAgIAo+ICAgCj4gICAvKiBJbnRlcm5hbCByZXByZXNlbnRhdGlvbiBvZiBh
IGRhdGEgdmlydHF1ZXVlICovCj4gQEAgLTY1LDExICs2Niw2IEBAIHN0cnVjdCB2aXJ0aW9fY3J5
cHRvIHsKPiAgIAkvKiBNYXhpbXVtIHNpemUgb2YgcGVyIHJlcXVlc3QgKi8KPiAgIAl1NjQgbWF4
X3NpemU7Cj4gICAKPiAtCS8qIENvbnRyb2wgVlEgYnVmZmVyczogcHJvdGVjdGVkIGJ5IHRoZSBj
dHJsX2xvY2sgKi8KPiAtCXN0cnVjdCB2aXJ0aW9fY3J5cHRvX29wX2N0cmxfcmVxIGN0cmw7Cj4g
LQlzdHJ1Y3QgdmlydGlvX2NyeXB0b19zZXNzaW9uX2lucHV0IGlucHV0Owo+IC0Jc3RydWN0IHZp
cnRpb19jcnlwdG9faW5oZHIgY3RybF9zdGF0dXM7Cj4gLQo+ICAgCXVuc2lnbmVkIGxvbmcgc3Rh
dHVzOwo+ICAgCWF0b21pY190IHJlZl9jb3VudDsKPiAgIAlzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7
Cj4gQEAgLTg1LDYgKzgxLDIwIEBAIHN0cnVjdCB2aXJ0aW9fY3J5cHRvX3N5bV9zZXNzaW9uX2lu
Zm8gewo+ICAgCV9fdTY0IHNlc3Npb25faWQ7Cj4gICB9Owo+ICAgCj4gK3N0cnVjdCB2aXJ0aW9f
Y3J5cHRvX2N0cmxfcmVxdWVzdDsKPiArdHlwZWRlZiB2b2lkICgqdmlydGlvX2NyeXB0b19jdHJs
X2NhbGxiYWNrKQo+ICsJCShzdHJ1Y3QgdmlydGlvX2NyeXB0b19jdHJsX3JlcXVlc3QgKnZjX2N0
cmxfcmVxKTsKPiArCj4gKy8qIE5vdGU6IHRoZXJlIGFyZSBwYWRkaW5nIGZpZWxkcyBpbiByZXF1
ZXN0LCBjbGVhciB0aGVtIHRvIHplcm8gYmVmb3JlIHNlbmRpbmcgdG8gaG9zdCwKPiArICogRXgs
IHZpcnRpb19jcnlwdG9fY3RybF9yZXF1ZXN0OjpjdHJsOjp1OjpkZXN0cm95X3Nlc3Npb246OnBh
ZGRpbmdbNDhdICovCj4gK3N0cnVjdCB2aXJ0aW9fY3J5cHRvX2N0cmxfcmVxdWVzdCB7Cj4gKwlz
dHJ1Y3QgdmlydGlvX2NyeXB0b19vcF9jdHJsX3JlcSBjdHJsOwo+ICsJc3RydWN0IHZpcnRpb19j
cnlwdG9fc2Vzc2lvbl9pbnB1dCBpbnB1dDsKPiArCXN0cnVjdCB2aXJ0aW9fY3J5cHRvX2luaGRy
IGN0cmxfc3RhdHVzOwo+ICsJdmlydGlvX2NyeXB0b19jdHJsX2NhbGxiYWNrIGN0cmxfY2I7Cj4g
KwlzdHJ1Y3QgY29tcGxldGlvbiBjb21wbDsKPiArfTsKPiArCj4gICBzdHJ1Y3QgdmlydGlvX2Ny
eXB0b19yZXF1ZXN0Owo+ICAgdHlwZWRlZiB2b2lkICgqdmlydGlvX2NyeXB0b19kYXRhX2NhbGxi
YWNrKQo+ICAgCQkoc3RydWN0IHZpcnRpb19jcnlwdG9fcmVxdWVzdCAqdmNfcmVxLCBpbnQgbGVu
KTsKPiBAQCAtMTM1LDQgKzE0NSw5IEBAIHZvaWQgdmlydGlvX2NyeXB0b19za2NpcGhlcl9hbGdz
X3VucmVnaXN0ZXIoc3RydWN0IHZpcnRpb19jcnlwdG8gKnZjcnlwdG8pOwo+ICAgaW50IHZpcnRp
b19jcnlwdG9fYWtjaXBoZXJfYWxnc19yZWdpc3RlcihzdHJ1Y3QgdmlydGlvX2NyeXB0byAqdmNy
eXB0byk7Cj4gICB2b2lkIHZpcnRpb19jcnlwdG9fYWtjaXBoZXJfYWxnc191bnJlZ2lzdGVyKHN0
cnVjdCB2aXJ0aW9fY3J5cHRvICp2Y3J5cHRvKTsKPiAgIAo+ICt2b2lkIHZpcnRjcnlwdG9fY3Ry
bHFfY2FsbGJhY2soc3RydWN0IHZpcnRxdWV1ZSAqdnEpOwo+ICtpbnQgdmlydGlvX2NyeXB0b19j
dHJsX3ZxX3JlcXVlc3Qoc3RydWN0IHZpcnRpb19jcnlwdG8gKnZjcnlwdG8sIHN0cnVjdCBzY2F0
dGVybGlzdCAqc2dzW10sCj4gKwkJCQkgIHVuc2lnbmVkIGludCBvdXRfc2dzLCB1bnNpZ25lZCBp
bnQgaW5fc2dzLAo+ICsJCQkJICBzdHJ1Y3QgdmlydGlvX2NyeXB0b19jdHJsX3JlcXVlc3QgKnZj
X2N0cmxfcmVxKTsKPiArCj4gICAjZW5kaWYgLyogX1ZJUlRJT19DUllQVE9fQ09NTU9OX0ggKi8K
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jcnlwdG8vdmlydGlvL3ZpcnRpb19jcnlwdG9fY29yZS5j
IGIvZHJpdmVycy9jcnlwdG8vdmlydGlvL3ZpcnRpb19jcnlwdG9fY29yZS5jCj4gaW5kZXggYzZm
NDgyZGIwYmMwLi5lNjY4ZDRiMWJjNmEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9jcnlwdG8vdmly
dGlvL3ZpcnRpb19jcnlwdG9fY29yZS5jCj4gKysrIGIvZHJpdmVycy9jcnlwdG8vdmlydGlvL3Zp
cnRpb19jcnlwdG9fY29yZS5jCj4gQEAgLTczLDcgKzczLDcgQEAgc3RhdGljIGludCB2aXJ0Y3J5
cHRvX2ZpbmRfdnFzKHN0cnVjdCB2aXJ0aW9fY3J5cHRvICp2aSkKPiAgIAkJZ290byBlcnJfbmFt
ZXM7Cj4gICAKPiAgIAkvKiBQYXJhbWV0ZXJzIGZvciBjb250cm9sIHZpcnRxdWV1ZSAqLwo+IC0J
Y2FsbGJhY2tzW3RvdGFsX3ZxcyAtIDFdID0gTlVMTDsKPiArCWNhbGxiYWNrc1t0b3RhbF92cXMg
LSAxXSA9IHZpcnRjcnlwdG9fY3RybHFfY2FsbGJhY2s7Cj4gICAJbmFtZXNbdG90YWxfdnFzIC0g
MV0gPSAiY29udHJvbHEiOwo+ICAgCj4gICAJLyogQWxsb2NhdGUvaW5pdGlhbGl6ZSBwYXJhbWV0
ZXJzIGZvciBkYXRhIHZpcnRxdWV1ZXMgKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jcnlwdG8v
dmlydGlvL3ZpcnRpb19jcnlwdG9fc2tjaXBoZXJfYWxncy5jIGIvZHJpdmVycy9jcnlwdG8vdmly
dGlvL3ZpcnRpb19jcnlwdG9fc2tjaXBoZXJfYWxncy5jCj4gaW5kZXggYTYxOGM0NmE1MmI4Li5m
ZWYzNTVmZjQ2MWMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9jcnlwdG8vdmlydGlvL3ZpcnRpb19j
cnlwdG9fc2tjaXBoZXJfYWxncy5jCj4gKysrIGIvZHJpdmVycy9jcnlwdG8vdmlydGlvL3ZpcnRp
b19jcnlwdG9fc2tjaXBoZXJfYWxncy5jCj4gQEAgLTExOCwxMSArMTE4LDEzIEBAIHN0YXRpYyBp
bnQgdmlydGlvX2NyeXB0b19hbGdfc2tjaXBoZXJfaW5pdF9zZXNzaW9uKAo+ICAgCQlpbnQgZW5j
cnlwdCkKPiAgIHsKPiAgIAlzdHJ1Y3Qgc2NhdHRlcmxpc3Qgb3V0aGRyLCBrZXlfc2csIGluaGRy
LCAqc2dzWzNdOwo+IC0JdW5zaWduZWQgaW50IHRtcDsKPiAgIAlzdHJ1Y3QgdmlydGlvX2NyeXB0
byAqdmNyeXB0byA9IGN0eC0+dmNyeXB0bzsKPiAgIAlpbnQgb3AgPSBlbmNyeXB0ID8gVklSVElP
X0NSWVBUT19PUF9FTkNSWVBUIDogVklSVElPX0NSWVBUT19PUF9ERUNSWVBUOwo+ICAgCWludCBl
cnI7Cj4gICAJdW5zaWduZWQgaW50IG51bV9vdXQgPSAwLCBudW1faW4gPSAwOwo+ICsJc3RydWN0
IHZpcnRpb19jcnlwdG9fY3RybF9yZXF1ZXN0ICp2Y19jdHJsX3JlcTsKPiArCXN0cnVjdCB2aXJ0
aW9fY3J5cHRvX2N0cmxfaGVhZGVyICpoZWFkZXI7Cj4gKwlzdHJ1Y3QgdmlydGlvX2NyeXB0b19z
eW1fY3JlYXRlX3Nlc3Npb25fcmVxICpzeW1fY3JlYXRlX3Nlc3Npb247Cj4gICAKPiAgIAkvKgo+
ICAgCSAqIEF2b2lkIHRvIGRvIERNQSBmcm9tIHRoZSBzdGFjaywgc3dpdGNoIHRvIHVzaW5nCj4g
QEAgLTEzMywyNiArMTM1LDI3IEBAIHN0YXRpYyBpbnQgdmlydGlvX2NyeXB0b19hbGdfc2tjaXBo
ZXJfaW5pdF9zZXNzaW9uKAo+ICAgCWlmICghY2lwaGVyX2tleSkKPiAgIAkJcmV0dXJuIC1FTk9N
RU07Cj4gICAKPiAtCXNwaW5fbG9jaygmdmNyeXB0by0+Y3RybF9sb2NrKTsKPiArCXZjX2N0cmxf
cmVxID0ga3phbGxvYyhzaXplb2YoKnZjX2N0cmxfcmVxKSwgR0ZQX0tFUk5FTCk7Cj4gKwlpZiAo
IXZjX2N0cmxfcmVxKSB7Cj4gKwkJZXJyID0gLUVOT01FTTsKPiArCQlnb3RvIG91dDsKPiArCX0K
PiArCj4gICAJLyogUGFkIGN0cmwgaGVhZGVyICovCj4gLQl2Y3J5cHRvLT5jdHJsLmhlYWRlci5v
cGNvZGUgPQo+IC0JCWNwdV90b19sZTMyKFZJUlRJT19DUllQVE9fQ0lQSEVSX0NSRUFURV9TRVNT
SU9OKTsKPiAtCXZjcnlwdG8tPmN0cmwuaGVhZGVyLmFsZ28gPSBjcHVfdG9fbGUzMihhbGcpOwo+
ICsJaGVhZGVyID0gJnZjX2N0cmxfcmVxLT5jdHJsLmhlYWRlcjsKPiArCWhlYWRlci0+b3Bjb2Rl
ID0gY3B1X3RvX2xlMzIoVklSVElPX0NSWVBUT19DSVBIRVJfQ1JFQVRFX1NFU1NJT04pOwo+ICsJ
aGVhZGVyLT5hbGdvID0gY3B1X3RvX2xlMzIoYWxnKTsKPiAgIAkvKiBTZXQgdGhlIGRlZmF1bHQg
ZGF0YXF1ZXVlIGlkIHRvIDAgKi8KPiAtCXZjcnlwdG8tPmN0cmwuaGVhZGVyLnF1ZXVlX2lkID0g
MDsKPiArCWhlYWRlci0+cXVldWVfaWQgPSAwOwo+ICAgCj4gLQl2Y3J5cHRvLT5pbnB1dC5zdGF0
dXMgPSBjcHVfdG9fbGUzMihWSVJUSU9fQ1JZUFRPX0VSUik7Cj4gICAJLyogUGFkIGNpcGhlcidz
IHBhcmFtZXRlcnMgKi8KPiAtCXZjcnlwdG8tPmN0cmwudS5zeW1fY3JlYXRlX3Nlc3Npb24ub3Bf
dHlwZSA9Cj4gLQkJY3B1X3RvX2xlMzIoVklSVElPX0NSWVBUT19TWU1fT1BfQ0lQSEVSKTsKPiAt
CXZjcnlwdG8tPmN0cmwudS5zeW1fY3JlYXRlX3Nlc3Npb24udS5jaXBoZXIucGFyYS5hbGdvID0K
PiAtCQl2Y3J5cHRvLT5jdHJsLmhlYWRlci5hbGdvOwo+IC0JdmNyeXB0by0+Y3RybC51LnN5bV9j
cmVhdGVfc2Vzc2lvbi51LmNpcGhlci5wYXJhLmtleWxlbiA9Cj4gLQkJY3B1X3RvX2xlMzIoa2V5
bGVuKTsKPiAtCXZjcnlwdG8tPmN0cmwudS5zeW1fY3JlYXRlX3Nlc3Npb24udS5jaXBoZXIucGFy
YS5vcCA9Cj4gLQkJY3B1X3RvX2xlMzIob3ApOwo+IC0KPiAtCXNnX2luaXRfb25lKCZvdXRoZHIs
ICZ2Y3J5cHRvLT5jdHJsLCBzaXplb2YodmNyeXB0by0+Y3RybCkpOwo+ICsJc3ltX2NyZWF0ZV9z
ZXNzaW9uID0gJnZjX2N0cmxfcmVxLT5jdHJsLnUuc3ltX2NyZWF0ZV9zZXNzaW9uOwo+ICsJc3lt
X2NyZWF0ZV9zZXNzaW9uLT5vcF90eXBlID0gY3B1X3RvX2xlMzIoVklSVElPX0NSWVBUT19TWU1f
T1BfQ0lQSEVSKTsKPiArCXN5bV9jcmVhdGVfc2Vzc2lvbi0+dS5jaXBoZXIucGFyYS5hbGdvID0g
aGVhZGVyLT5hbGdvOwo+ICsJc3ltX2NyZWF0ZV9zZXNzaW9uLT51LmNpcGhlci5wYXJhLmtleWxl
biA9IGNwdV90b19sZTMyKGtleWxlbik7Cj4gKwlzeW1fY3JlYXRlX3Nlc3Npb24tPnUuY2lwaGVy
LnBhcmEub3AgPSBjcHVfdG9fbGUzMihvcCk7Cj4gKwo+ICsJc2dfaW5pdF9vbmUoJm91dGhkciwg
JnZjX2N0cmxfcmVxLT5jdHJsLCBzaXplb2YodmNfY3RybF9yZXEtPmN0cmwpKTsKPiAgIAlzZ3Nb
bnVtX291dCsrXSA9ICZvdXRoZHI7Cj4gICAKPiAgIAkvKiBTZXQga2V5ICovCj4gQEAgLTE2MCw0
NSArMTYzLDM0IEBAIHN0YXRpYyBpbnQgdmlydGlvX2NyeXB0b19hbGdfc2tjaXBoZXJfaW5pdF9z
ZXNzaW9uKAo+ICAgCXNnc1tudW1fb3V0KytdID0gJmtleV9zZzsKPiAgIAo+ICAgCS8qIFJldHVy
biBzdGF0dXMgYW5kIHNlc3Npb24gaWQgYmFjayAqLwo+IC0Jc2dfaW5pdF9vbmUoJmluaGRyLCAm
dmNyeXB0by0+aW5wdXQsIHNpemVvZih2Y3J5cHRvLT5pbnB1dCkpOwo+ICsJdmNfY3RybF9yZXEt
PmlucHV0LnN0YXR1cyA9IGNwdV90b19sZTMyKFZJUlRJT19DUllQVE9fRVJSKTsKPiArCXNnX2lu
aXRfb25lKCZpbmhkciwgJnZjX2N0cmxfcmVxLT5pbnB1dCwgc2l6ZW9mKHZjX2N0cmxfcmVxLT5p
bnB1dCkpOwo+ICAgCXNnc1tudW1fb3V0ICsgbnVtX2luKytdID0gJmluaGRyOwo+ICAgCj4gLQll
cnIgPSB2aXJ0cXVldWVfYWRkX3Nncyh2Y3J5cHRvLT5jdHJsX3ZxLCBzZ3MsIG51bV9vdXQsCj4g
LQkJCQludW1faW4sIHZjcnlwdG8sIEdGUF9BVE9NSUMpOwo+IC0JaWYgKGVyciA8IDApIHsKPiAt
CQlzcGluX3VubG9jaygmdmNyeXB0by0+Y3RybF9sb2NrKTsKPiAtCQlrZnJlZV9zZW5zaXRpdmUo
Y2lwaGVyX2tleSk7Cj4gLQkJcmV0dXJuIGVycjsKPiAtCX0KPiAtCXZpcnRxdWV1ZV9raWNrKHZj
cnlwdG8tPmN0cmxfdnEpOwo+IC0KPiAtCS8qCj4gLQkgKiBUcmFwcGluZyBpbnRvIHRoZSBoeXBl
cnZpc29yLCBzbyB0aGUgcmVxdWVzdCBzaG91bGQgYmUKPiAtCSAqIGhhbmRsZWQgaW1tZWRpYXRl
bHkuCj4gLQkgKi8KPiAtCXdoaWxlICghdmlydHF1ZXVlX2dldF9idWYodmNyeXB0by0+Y3RybF92
cSwgJnRtcCkgJiYKPiAtCSAgICAgICAhdmlydHF1ZXVlX2lzX2Jyb2tlbih2Y3J5cHRvLT5jdHJs
X3ZxKSkKPiAtCQljcHVfcmVsYXgoKTsKPiArCWVyciA9IHZpcnRpb19jcnlwdG9fY3RybF92cV9y
ZXF1ZXN0KHZjcnlwdG8sIHNncywgbnVtX291dCwgbnVtX2luLCB2Y19jdHJsX3JlcSk7Cj4gKwlp
ZiAoZXJyIDwgMCkKPiArCQlnb3RvIG91dDsKPiAgIAo+IC0JaWYgKGxlMzJfdG9fY3B1KHZjcnlw
dG8tPmlucHV0LnN0YXR1cykgIT0gVklSVElPX0NSWVBUT19PSykgewo+IC0JCXNwaW5fdW5sb2Nr
KCZ2Y3J5cHRvLT5jdHJsX2xvY2spOwo+ICsJaWYgKGxlMzJfdG9fY3B1KHZjX2N0cmxfcmVxLT5p
bnB1dC5zdGF0dXMpICE9IFZJUlRJT19DUllQVE9fT0spIHsKPiAgIAkJcHJfZXJyKCJ2aXJ0aW9f
Y3J5cHRvOiBDcmVhdGUgc2Vzc2lvbiBmYWlsZWQgc3RhdHVzOiAldVxuIiwKPiAtCQkJbGUzMl90
b19jcHUodmNyeXB0by0+aW5wdXQuc3RhdHVzKSk7Cj4gLQkJa2ZyZWVfc2Vuc2l0aXZlKGNpcGhl
cl9rZXkpOwo+IC0JCXJldHVybiAtRUlOVkFMOwo+ICsJCQlsZTMyX3RvX2NwdSh2Y19jdHJsX3Jl
cS0+aW5wdXQuc3RhdHVzKSk7Cj4gKwkJZXJyID0gLUVJTlZBTDsKPiArCQlnb3RvIG91dDsKPiAg
IAl9Cj4gICAKPiAgIAlpZiAoZW5jcnlwdCkKPiAgIAkJY3R4LT5lbmNfc2Vzc19pbmZvLnNlc3Np
b25faWQgPQo+IC0JCQlsZTY0X3RvX2NwdSh2Y3J5cHRvLT5pbnB1dC5zZXNzaW9uX2lkKTsKPiAr
CQkJbGU2NF90b19jcHUodmNfY3RybF9yZXEtPmlucHV0LnNlc3Npb25faWQpOwo+ICAgCWVsc2UK
PiAgIAkJY3R4LT5kZWNfc2Vzc19pbmZvLnNlc3Npb25faWQgPQo+IC0JCQlsZTY0X3RvX2NwdSh2
Y3J5cHRvLT5pbnB1dC5zZXNzaW9uX2lkKTsKPiAtCj4gLQlzcGluX3VubG9jaygmdmNyeXB0by0+
Y3RybF9sb2NrKTsKPiArCQkJbGU2NF90b19jcHUodmNfY3RybF9yZXEtPmlucHV0LnNlc3Npb25f
aWQpOwo+ICAgCj4gKwllcnIgPSAwOwo+ICtvdXQ6Cj4gKwlrZnJlZSh2Y19jdHJsX3JlcSk7Cj4g
ICAJa2ZyZWVfc2Vuc2l0aXZlKGNpcGhlcl9rZXkpOwo+IC0JcmV0dXJuIDA7Cj4gKwo+ICsJcmV0
dXJuIGVycjsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGludCB2aXJ0aW9fY3J5cHRvX2FsZ19za2Np
cGhlcl9jbG9zZV9zZXNzaW9uKAo+IEBAIC0yMDYsMjEgKzE5OCwyNCBAQCBzdGF0aWMgaW50IHZp
cnRpb19jcnlwdG9fYWxnX3NrY2lwaGVyX2Nsb3NlX3Nlc3Npb24oCj4gICAJCWludCBlbmNyeXB0
KQo+ICAgewo+ICAgCXN0cnVjdCBzY2F0dGVybGlzdCBvdXRoZHIsIHN0YXR1c19zZywgKnNnc1sy
XTsKPiAtCXVuc2lnbmVkIGludCB0bXA7Cj4gICAJc3RydWN0IHZpcnRpb19jcnlwdG9fZGVzdHJv
eV9zZXNzaW9uX3JlcSAqZGVzdHJveV9zZXNzaW9uOwo+ICAgCXN0cnVjdCB2aXJ0aW9fY3J5cHRv
ICp2Y3J5cHRvID0gY3R4LT52Y3J5cHRvOwo+ICAgCWludCBlcnI7Cj4gICAJdW5zaWduZWQgaW50
IG51bV9vdXQgPSAwLCBudW1faW4gPSAwOwo+ICsJc3RydWN0IHZpcnRpb19jcnlwdG9fY3RybF9y
ZXF1ZXN0ICp2Y19jdHJsX3JlcTsKPiArCXN0cnVjdCB2aXJ0aW9fY3J5cHRvX2N0cmxfaGVhZGVy
ICpoZWFkZXI7Cj4gKwo+ICsJdmNfY3RybF9yZXEgPSBremFsbG9jKHNpemVvZigqdmNfY3RybF9y
ZXEpLCBHRlBfS0VSTkVMKTsKPiArCWlmICghdmNfY3RybF9yZXEpCj4gKwkJcmV0dXJuIC1FTk9N
RU07Cj4gICAKPiAtCXNwaW5fbG9jaygmdmNyeXB0by0+Y3RybF9sb2NrKTsKPiAtCXZjcnlwdG8t
PmN0cmxfc3RhdHVzLnN0YXR1cyA9IFZJUlRJT19DUllQVE9fRVJSOwo+ICAgCS8qIFBhZCBjdHJs
IGhlYWRlciAqLwo+IC0JdmNyeXB0by0+Y3RybC5oZWFkZXIub3Bjb2RlID0KPiAtCQljcHVfdG9f
bGUzMihWSVJUSU9fQ1JZUFRPX0NJUEhFUl9ERVNUUk9ZX1NFU1NJT04pOwo+ICsJaGVhZGVyID0g
JnZjX2N0cmxfcmVxLT5jdHJsLmhlYWRlcjsKPiArCWhlYWRlci0+b3Bjb2RlID0gY3B1X3RvX2xl
MzIoVklSVElPX0NSWVBUT19DSVBIRVJfREVTVFJPWV9TRVNTSU9OKTsKPiAgIAkvKiBTZXQgdGhl
IGRlZmF1bHQgdmlydHF1ZXVlIGlkIHRvIDAgKi8KPiAtCXZjcnlwdG8tPmN0cmwuaGVhZGVyLnF1
ZXVlX2lkID0gMDsKPiArCWhlYWRlci0+cXVldWVfaWQgPSAwOwo+ICAgCj4gLQlkZXN0cm95X3Nl
c3Npb24gPSAmdmNyeXB0by0+Y3RybC51LmRlc3Ryb3lfc2Vzc2lvbjsKPiArCWRlc3Ryb3lfc2Vz
c2lvbiA9ICZ2Y19jdHJsX3JlcS0+Y3RybC51LmRlc3Ryb3lfc2Vzc2lvbjsKPiAgIAo+ICAgCWlm
IChlbmNyeXB0KQo+ICAgCQlkZXN0cm95X3Nlc3Npb24tPnNlc3Npb25faWQgPQo+IEBAIC0yMjks
MzcgKzIyNCwzMyBAQCBzdGF0aWMgaW50IHZpcnRpb19jcnlwdG9fYWxnX3NrY2lwaGVyX2Nsb3Nl
X3Nlc3Npb24oCj4gICAJCWRlc3Ryb3lfc2Vzc2lvbi0+c2Vzc2lvbl9pZCA9Cj4gICAJCQljcHVf
dG9fbGU2NChjdHgtPmRlY19zZXNzX2luZm8uc2Vzc2lvbl9pZCk7Cj4gICAKPiAtCXNnX2luaXRf
b25lKCZvdXRoZHIsICZ2Y3J5cHRvLT5jdHJsLCBzaXplb2YodmNyeXB0by0+Y3RybCkpOwo+ICsJ
c2dfaW5pdF9vbmUoJm91dGhkciwgJnZjX2N0cmxfcmVxLT5jdHJsLCBzaXplb2YodmNfY3RybF9y
ZXEtPmN0cmwpKTsKPiAgIAlzZ3NbbnVtX291dCsrXSA9ICZvdXRoZHI7Cj4gICAKPiAgIAkvKiBS
ZXR1cm4gc3RhdHVzIGFuZCBzZXNzaW9uIGlkIGJhY2sgKi8KPiAtCXNnX2luaXRfb25lKCZzdGF0
dXNfc2csICZ2Y3J5cHRvLT5jdHJsX3N0YXR1cy5zdGF0dXMsCj4gLQkJc2l6ZW9mKHZjcnlwdG8t
PmN0cmxfc3RhdHVzLnN0YXR1cykpOwo+ICsJdmNfY3RybF9yZXEtPmN0cmxfc3RhdHVzLnN0YXR1
cyA9IFZJUlRJT19DUllQVE9fRVJSOwo+ICsJc2dfaW5pdF9vbmUoJnN0YXR1c19zZywgJnZjX2N0
cmxfcmVxLT5jdHJsX3N0YXR1cy5zdGF0dXMsCj4gKwkJc2l6ZW9mKHZjX2N0cmxfcmVxLT5jdHJs
X3N0YXR1cy5zdGF0dXMpKTsKPiAgIAlzZ3NbbnVtX291dCArIG51bV9pbisrXSA9ICZzdGF0dXNf
c2c7Cj4gICAKPiAtCWVyciA9IHZpcnRxdWV1ZV9hZGRfc2dzKHZjcnlwdG8tPmN0cmxfdnEsIHNn
cywgbnVtX291dCwKPiAtCQkJbnVtX2luLCB2Y3J5cHRvLCBHRlBfQVRPTUlDKTsKPiAtCWlmIChl
cnIgPCAwKSB7Cj4gLQkJc3Bpbl91bmxvY2soJnZjcnlwdG8tPmN0cmxfbG9jayk7Cj4gLQkJcmV0
dXJuIGVycjsKPiAtCX0KPiAtCXZpcnRxdWV1ZV9raWNrKHZjcnlwdG8tPmN0cmxfdnEpOwo+IC0K
PiAtCXdoaWxlICghdmlydHF1ZXVlX2dldF9idWYodmNyeXB0by0+Y3RybF92cSwgJnRtcCkgJiYK
PiAtCSAgICAgICAhdmlydHF1ZXVlX2lzX2Jyb2tlbih2Y3J5cHRvLT5jdHJsX3ZxKSkKPiAtCQlj
cHVfcmVsYXgoKTsKPiArCWVyciA9IHZpcnRpb19jcnlwdG9fY3RybF92cV9yZXF1ZXN0KHZjcnlw
dG8sIHNncywgbnVtX291dCwgbnVtX2luLCB2Y19jdHJsX3JlcSk7Cj4gKwlpZiAoZXJyIDwgMCkK
PiArCQlnb3RvIG91dDsKPiAgIAo+IC0JaWYgKHZjcnlwdG8tPmN0cmxfc3RhdHVzLnN0YXR1cyAh
PSBWSVJUSU9fQ1JZUFRPX09LKSB7Cj4gLQkJc3Bpbl91bmxvY2soJnZjcnlwdG8tPmN0cmxfbG9j
ayk7Cj4gKwlpZiAodmNfY3RybF9yZXEtPmN0cmxfc3RhdHVzLnN0YXR1cyAhPSBWSVJUSU9fQ1JZ
UFRPX09LKSB7Cj4gICAJCXByX2VycigidmlydGlvX2NyeXB0bzogQ2xvc2Ugc2Vzc2lvbiBmYWls
ZWQgc3RhdHVzOiAldSwgc2Vzc2lvbl9pZDogMHglbGx4XG4iLAo+IC0JCQl2Y3J5cHRvLT5jdHJs
X3N0YXR1cy5zdGF0dXMsCj4gKwkJCXZjX2N0cmxfcmVxLT5jdHJsX3N0YXR1cy5zdGF0dXMsCj4g
ICAJCQlkZXN0cm95X3Nlc3Npb24tPnNlc3Npb25faWQpOwo+ICAgCj4gLQkJcmV0dXJuIC1FSU5W
QUw7Cj4gKwkJZXJyID0gLUVJTlZBTDsKPiArCQlnb3RvIG91dDsKPiAgIAl9Cj4gLQlzcGluX3Vu
bG9jaygmdmNyeXB0by0+Y3RybF9sb2NrKTsKPiAgIAo+IC0JcmV0dXJuIDA7Cj4gKwllcnIgPSAw
Owo+ICtvdXQ6Cj4gKwlrZnJlZSh2Y19jdHJsX3JlcSk7Cj4gKwo+ICsJcmV0dXJuIGVycjsKPiAg
IH0KPiAgIAo+ICAgc3RhdGljIGludCB2aXJ0aW9fY3J5cHRvX2FsZ19za2NpcGhlcl9pbml0X3Nl
c3Npb25zKAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
VmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZv
dW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL3ZpcnR1YWxpemF0aW9u

