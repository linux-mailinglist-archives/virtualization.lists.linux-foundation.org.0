Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
	by mail.lfdr.de (Postfix) with ESMTPS id CC2732D1AEE
	for <lists.virtualization@lfdr.de>; Mon,  7 Dec 2020 21:47:43 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by silver.osuosl.org (Postfix) with ESMTP id 583592E296;
	Mon,  7 Dec 2020 20:47:42 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 2xsOBG6aCYMO; Mon,  7 Dec 2020 20:47:20 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by silver.osuosl.org (Postfix) with ESMTP id 37A042E294;
	Mon,  7 Dec 2020 20:46:48 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 25BC7C0FA7;
	Mon,  7 Dec 2020 20:46:48 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 4E4F7C013B
 for <virtualization@lists.linux-foundation.org>;
 Mon,  7 Dec 2020 20:46:46 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by silver.osuosl.org (Postfix) with ESMTP id 2ED8E2E292
 for <virtualization@lists.linux-foundation.org>;
 Mon,  7 Dec 2020 20:46:46 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id c35RpuoY0yZ4
 for <virtualization@lists.linux-foundation.org>;
 Mon,  7 Dec 2020 20:46:21 +0000 (UTC)
X-Greylist: from auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by silver.osuosl.org (Postfix) with ESMTPS id 0B7232E277
 for <virtualization@lists.linux-foundation.org>;
 Mon,  7 Dec 2020 20:46:19 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 81520305D460; Mon,  7 Dec 2020 22:46:17 +0200 (EET)
Received: from localhost.localdomain (unknown [91.199.104.27])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 4E2663072785;
 Mon,  7 Dec 2020 22:46:17 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v11 33/81] KVM: introspection: add hook/unhook ioctls
Date: Mon,  7 Dec 2020 22:45:34 +0200
Message-Id: <20201207204622.15258-34-alazar@bitdefender.com>
In-Reply-To: <20201207204622.15258-1-alazar@bitdefender.com>
References: <20201207204622.15258-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mircea=20C=C3=AErjaliu?= <mcirjaliu@bitdefender.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <nicu.citu@icloud.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gaG9vaywgYSBuZXcgdGhyZWFkIGlzIGNyZWF0ZWQgdG8gaGFuZGxlIHRoZSBtZXNzYWdlcyBj
b21pbmcgZnJvbSB0aGUKaW50cm9zcGVjdGlvbiB0b29sIChjb21tYW5kcyBvciBldmVudCByZXBs
aWVzKS4gVGhlIFZNIHJlbGF0ZWQgY29tbWFuZHMKYXJlIGhhbmRsZWQgYnkgdGhpcyB0aHJlYWQs
IHdoaWxlIHRoZSB2Q1BVIGNvbW1hbmRzIGFuZCBldmVudHMgcmVwbGllcwphcmUgZGlzcGF0Y2hl
ZCB0byB0aGUgdkNQVSB0aHJlYWRzLgoKT24gdW5ob29rLCB0aGUgc29ja2V0IGlzIHNodXQgZG93
biwgd2hpY2ggd2lsbCBzaWduYWw6IHRoZSByZWNlaXZpbmcKdGhyZWFkIHRvIHF1aXQgKGJlY2F1
c2UgaXQgbWlnaHQgYmUgYmxvY2tlZCBpbiByZWN2bXNnKCkpIGFuZCB0aGUKaW50cm9zcGVjdGlv
biB0b29sIHRvIGNsZWFuIHVwLgoKVGhlIG11dGV4IGlzIHVzZWQgdG8gcHJvdGVjdCB0aGUgJ2t2
bS0+a3ZtaScgcG9pbnRlciB3aGVuIGFjY2Vzc2VkCnRocm91Z2ggaW9jdGxzLgoKVGhlIHJlZmVy
ZW5jZSBjb3VudGVyIGlzIGluY3JlbWVudGVkIGJ5IHRoZSByZWNlaXZpbmcgdGhyZWFkIChmb3IK
aXRzIGVudGlyZSBsaWZlIHRpbWUpIGFuZCBieSB0aGUgdkNQVSB0aHJlYWRzIHdoaWxlIHNlbmRp
bmcgZXZlbnRzIG9yCmhhbmRsaW5nIGNvbW1hbmRzLgoKVGhlIGNvbXBsZXRpb24gb2JqZWN0cyBp
cyBzZXQgd2hlbiB0aGUgcmVmZXJlbmNlIGNvdW50ZXIgcmVhY2hlcyB6ZXJvLAphbGxvd2luZyB0
aGUgdW5ob29rIHByb2Nlc3MgdG8gY29udGludWUgYW5kIGZyZWUgdGhlIGludHJvc3BlY3Rpb24K
c3RydWN0dXJlcy4KCkNvLWRldmVsb3BlZC1ieTogTWlyY2VhIEPDrnJqYWxpdSA8bWNpcmphbGl1
QGJpdGRlZmVuZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogTWlyY2VhIEPDrnJqYWxpdSA8bWNpcmph
bGl1QGJpdGRlZmVuZGVyLmNvbT4KQ28tZGV2ZWxvcGVkLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5p
Y3UuY2l0dUBpY2xvdWQuY29tPgpTaWduZWQtb2ZmLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5pY3Uu
Y2l0dUBpY2xvdWQuY29tPgpTaWduZWQtb2ZmLWJ5OiBBZGFsYmVydCBMYXrEg3IgPGFsYXphckBi
aXRkZWZlbmRlci5jb20+Ci0tLQogRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9hcGkucnN0ICAgICAg
ICAgICAgICAgIHwgIDYzICsrKysrKysKIGFyY2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5o
ICAgICAgICAgICAgICB8ICAgOCArCiBhcmNoL3g4Ni9rdm0vTWFrZWZpbGUgICAgICAgICAgICAg
ICAgICAgICAgICAgfCAgIDIgKy0KIGFyY2gveDg2L2t2bS94ODYuYyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB8ICAgNSArCiBpbmNsdWRlL2xpbnV4L2t2bV9ob3N0LmggICAgICAgICAgICAg
ICAgICAgICAgfCAgIDUgKwogaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaCAgICAgICAgICAgICAg
ICAgICAgIHwgIDE4ICsrCiBpbmNsdWRlL3VhcGkvbGludXgva3ZtLmggICAgICAgICAgICAgICAg
ICAgICAgfCAgMTAgKysKIGluY2x1ZGUvdWFwaS9saW51eC9rdm1pLmggICAgICAgICAgICAgICAg
ICAgICB8ICAxMyArKwogdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL01ha2VmaWxlICAgICAg
ICAgIHwgICAxICsKIC4uLi90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5j
ICB8ICA4NyArKysrKysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyAgICAgICAg
ICAgICAgICAgfCAxNjAgKysrKysrKysrKysrKysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9u
L2t2bWlfaW50LmggICAgICAgICAgICAgfCAgMTAgKysKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24v
a3ZtaV9tc2cuYyAgICAgICAgICAgICB8ICAzOSArKysrKwogdmlydC9rdm0va3ZtX21haW4uYyAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDIxICsrKwogMTQgZmlsZXMgY2hhbmdlZCwgNDQx
IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBhcmNoL3g4
Ni9pbmNsdWRlL2FzbS9rdm1pX2hvc3QuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGluY2x1ZGUvdWFw
aS9saW51eC9rdm1pLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0b29scy90ZXN0aW5nL3NlbGZ0ZXN0
cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgdmlydC9rdm0vaW50
cm9zcGVjdGlvbi9rdm1pX21zZy5jCgpkaWZmIC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2
bS9hcGkucnN0IGIvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9hcGkucnN0CmluZGV4IDcwMjU0ZWFh
NTIyOS4uOWI0OGJlOTBhZTdiIDEwMDY0NAotLS0gYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2Fw
aS5yc3QKKysrIGIvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9hcGkucnN0CkBAIC00ODI1LDYgKzQ4
MjUsNTggQEAgaW50byB1c2VyIHNwYWNlLgogSWYgYSB2Q1BVIGlzIGluIHJ1bm5pbmcgc3RhdGUg
d2hpbGUgdGhpcyBpb2N0bCBpcyBpbnZva2VkLCB0aGUgdkNQVSBtYXkKIGV4cGVyaWVuY2UgaW5j
b25zaXN0ZW50IGZpbHRlcmluZyBiZWhhdmlvciBvbiBNU1IgYWNjZXNzZXMuCiAKKzQuMTI3IEtW
TV9JTlRST1NQRUNUSU9OX0hPT0sKKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKworOkNh
cGFiaWxpdHk6IEtWTV9DQVBfSU5UUk9TUEVDVElPTgorOkFyY2hpdGVjdHVyZXM6IHg4NgorOlR5
cGU6IHZtIGlvY3RsCis6UGFyYW1ldGVyczogc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uIChpbikK
KzpSZXR1cm5zOiAwIG9uIHN1Y2Nlc3MsIGEgbmVnYXRpdmUgdmFsdWUgb24gZXJyb3IKKworRXJy
b3JzOgorCisgID09PT09PSAgICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQorICBFTk9NRU0gICAgIHRoZSBtZW1vcnkgYWxsb2NhdGlv
biBmYWlsZWQKKyAgRUVYSVNUICAgICB0aGUgVk0gaXMgYWxyZWFkeSBpbnRyb3NwZWN0ZWQKKyAg
RUlOVkFMICAgICB0aGUgZmlsZSBkZXNjcmlwdG9yIGRvZXNuJ3QgY29ycmVzcG9uZCB0byBhbiBh
Y3RpdmUgc29ja2V0CisgIEVJTlZBTCAgICAgdGhlIHBhZGRpbmcgaXMgbm90IHplcm8KKyAgRVBF
Uk0gICAgICB0aGUgaW50cm9zcGVjdGlvbiBpcyBkaXNhYmxlZCAoa3ZtLmludHJvc3BlY3Rpb249
MCkKKyAgPT09PT09ICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09CisKK1RoaXMgaW9jdGwgaXMgdXNlZCB0byBlbmFibGUgdGhlIGlu
dHJvc3BlY3Rpb24gb2YgdGhlIGN1cnJlbnQgVk0uCisKKzo6CisKKyAgc3RydWN0IGt2bV9pbnRy
b3NwZWN0aW9uIHsKKwlfX3MzMiBmZDsKKwlfX3UzMiBwYWRkaW5nOworCV9fdTggdXVpZFsxNl07
CisgIH07CisKK2ZkIGlzIHRoZSBmaWxlIGRlc2NyaXB0b3Igb2YgYSBzb2NrZXQgY29ubmVjdGVk
IHRvIHRoZSBpbnRyb3NwZWN0aW9uIHRvb2wsCisKK3BhZGRpbmcgbXVzdCBiZSB6ZXJvIChpdCBt
aWdodCBiZSB1c2VkIGluIHRoZSBmdXR1cmUpLAorCit1dWlkIGlzIHVzZWQgZm9yIGRlYnVnIGFu
ZCBlcnJvciBtZXNzYWdlcy4KKworNC4xMjggS1ZNX0lOVFJPU1BFQ1RJT05fVU5IT09LCistLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKworOkNhcGFiaWxpdHk6IEtWTV9DQVBfSU5UUk9T
UEVDVElPTgorOkFyY2hpdGVjdHVyZXM6IHg4NgorOlR5cGU6IHZtIGlvY3RsCis6UGFyYW1ldGVy
czogbm9uZQorOlJldHVybnM6IDAgb24gc3VjY2VzcywgYSBuZWdhdGl2ZSB2YWx1ZSBvbiBlcnJv
cgorCitFcnJvcnM6CisKKyAgPT09PT09ICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CisgIEVQRVJNICAgICAgdGhlIGludHJvc3Bl
Y3Rpb24gaXMgZGlzYWJsZWQgKGt2bS5pbnRyb3NwZWN0aW9uPTApCisgID09PT09PSAgICAgPT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQor
CitUaGlzIGlvY3RsIGlzIHVzZWQgdG8gZnJlZSBhbGwgaW50cm9zcGVjdGlvbiBzdHJ1Y3R1cmVz
CityZWxhdGVkIHRvIHRoaXMgVk0uCiAKIDUuIFRoZSBrdm1fcnVuIHN0cnVjdHVyZQogPT09PT09
PT09PT09PT09PT09PT09PT09CkBAIC02NDk2LDMgKzY1NDgsMTQgQEAgS1ZNX0dFVF9ESVJUWV9M
T0cgYW5kIEtWTV9DTEVBUl9ESVJUWV9MT0cuICBBZnRlciBlbmFibGluZwogS1ZNX0NBUF9ESVJU
WV9MT0dfUklORyB3aXRoIGFuIGFjY2VwdGFibGUgZGlydHkgcmluZyBzaXplLCB0aGUgdmlydHVh
bAogbWFjaGluZSB3aWxsIHN3aXRjaCB0byByaW5nLWJ1ZmZlciBkaXJ0eSBwYWdlIHRyYWNraW5n
IGFuZCBmdXJ0aGVyCiBLVk1fR0VUX0RJUlRZX0xPRyBvciBLVk1fQ0xFQVJfRElSVFlfTE9HIGlv
Y3RscyB3aWxsIGZhaWwuCisKKzguMzAgS1ZNX0NBUF9JTlRST1NQRUNUSU9OCistLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQorCis6QXJjaGl0ZWN0dXJlczogeDg2CisKK1RoaXMgY2FwYWJpbGl0
eSBpbmRpY2F0ZXMgdGhhdCBLVk0gc3VwcG9ydHMgVk0gaW50cm9zcGVjdGlvbgorYW5kIGl0IGlz
IGVuYWJsZWQuCisKK1RoZSBLVk1fQ0hFQ0tfRVhURU5TSU9OIGlvY3RsIHJldHVybnMgdGhlIGlu
dHJvc3BlY3Rpb24gQVBJIHZlcnNpb24KKyhhIG51bWJlciBsYXJnZXIgdGhhbiAwKS4KZGlmZiAt
LWdpdCBhL2FyY2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5oIGIvYXJjaC94ODYvaW5jbHVk
ZS9hc20va3ZtaV9ob3N0LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAw
Li4zOGMzOTgyNjI5MTMKLS0tIC9kZXYvbnVsbAorKysgYi9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9r
dm1pX2hvc3QuaApAQCAtMCwwICsxLDggQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBH
UEwtMi4wICovCisjaWZuZGVmIF9BU01fWDg2X0tWTUlfSE9TVF9ICisjZGVmaW5lIF9BU01fWDg2
X0tWTUlfSE9TVF9ICisKK3N0cnVjdCBrdm1fYXJjaF9pbnRyb3NwZWN0aW9uIHsKK307CisKKyNl
bmRpZiAvKiBfQVNNX1g4Nl9LVk1JX0hPU1RfSCAqLwpkaWZmIC0tZ2l0IGEvYXJjaC94ODYva3Zt
L01ha2VmaWxlIGIvYXJjaC94ODYva3ZtL01ha2VmaWxlCmluZGV4IGU5Nzg0ZGYwNTVkNC4uZGI0
MTIxYjQxMTJkIDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9rdm0vTWFrZWZpbGUKKysrIGIvYXJjaC94
ODYva3ZtL01ha2VmaWxlCkBAIC0xNCw3ICsxNCw3IEBAIGt2bS15CQkJKz0gJChLVk0pL2t2bV9t
YWluLm8gJChLVk0pL2NvYWxlc2NlZF9tbWlvLm8gXAogCQkJCSQoS1ZNKS9ldmVudGZkLm8gJChL
Vk0pL2lycWNoaXAubyAkKEtWTSkvdmZpby5vIFwKIAkJCQkkKEtWTSkvZGlydHlfcmluZy5vCiBr
dm0tJChDT05GSUdfS1ZNX0FTWU5DX1BGKQkrPSAkKEtWTSkvYXN5bmNfcGYubwota3ZtLSQoQ09O
RklHX0tWTV9JTlRST1NQRUNUSU9OKSArPSAkKEtWTUkpL2t2bWkubwora3ZtLSQoQ09ORklHX0tW
TV9JTlRST1NQRUNUSU9OKSArPSAkKEtWTUkpL2t2bWkubyAkKEtWTUkpL2t2bWlfbXNnLm8KIAog
a3ZtLXkJCQkrPSB4ODYubyBlbXVsYXRlLm8gaTgyNTkubyBpcnEubyBsYXBpYy5vIFwKIAkJCSAg
IGk4MjU0Lm8gaW9hcGljLm8gaXJxX2NvbW0ubyBjcHVpZC5vIHBtdS5vIG10cnIubyBcCmRpZmYg
LS1naXQgYS9hcmNoL3g4Ni9rdm0veDg2LmMgYi9hcmNoL3g4Ni9rdm0veDg2LmMKaW5kZXggZDli
MTAzNDQ2NWM4Li44YThhNzA1NTI2NDUgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS94ODYuYwor
KysgYi9hcmNoL3g4Ni9rdm0veDg2LmMKQEAgLTU3LDYgKzU3LDcgQEAKICNpbmNsdWRlIDxsaW51
eC9zY2hlZC9pc29sYXRpb24uaD4KICNpbmNsdWRlIDxsaW51eC9tZW1fZW5jcnlwdC5oPgogI2lu
Y2x1ZGUgPGxpbnV4L2VudHJ5LWt2bS5oPgorI2luY2x1ZGUgPGxpbnV4L2t2bWlfaG9zdC5oPgog
CiAjaW5jbHVkZSA8dHJhY2UvZXZlbnRzL2t2bS5oPgogCkBAIC0zODI1LDYgKzM4MjYsMTAgQEAg
aW50IGt2bV92bV9pb2N0bF9jaGVja19leHRlbnNpb24oc3RydWN0IGt2bSAqa3ZtLCBsb25nIGV4
dCkKIAljYXNlIEtWTV9DQVBfU1RFQUxfVElNRToKIAkJciA9IHNjaGVkX2luZm9fb24oKTsKIAkJ
YnJlYWs7CisJY2FzZSBLVk1fQ0FQX0lOVFJPU1BFQ1RJT046CisJCWlmIChlbmFibGVfaW50cm9z
cGVjdGlvbikKKwkJCXIgPSBrdm1pX3ZlcnNpb24oKTsKKwkJYnJlYWs7CiAJZGVmYXVsdDoKIAkJ
YnJlYWs7CiAJfQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9rdm1faG9zdC5oIGIvaW5jbHVk
ZS9saW51eC9rdm1faG9zdC5oCmluZGV4IDJjNjQwZWE5ZDdiYS4uZjMxMTBlMDkyYWQwIDEwMDY0
NAotLS0gYS9pbmNsdWRlL2xpbnV4L2t2bV9ob3N0LmgKKysrIGIvaW5jbHVkZS9saW51eC9rdm1f
aG9zdC5oCkBAIC01MTMsNiArNTEzLDExIEBAIHN0cnVjdCBrdm0gewogCXBpZF90IHVzZXJzcGFj
ZV9waWQ7CiAJdW5zaWduZWQgaW50IG1heF9oYWx0X3BvbGxfbnM7CiAJdTMyIGRpcnR5X3Jpbmdf
c2l6ZTsKKworCXN0cnVjdCBtdXRleCBrdm1pX2xvY2s7CisJcmVmY291bnRfdCBrdm1pX3JlZjsK
KwlzdHJ1Y3QgY29tcGxldGlvbiBrdm1pX2NvbXBsZXRlOworCXN0cnVjdCBrdm1faW50cm9zcGVj
dGlvbiAqa3ZtaTsKIH07CiAKICNkZWZpbmUga3ZtX2VycihmbXQsIC4uLikgXApkaWZmIC0tZ2l0
IGEvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaCBiL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmgK
aW5kZXggMWUwYTczYzJhMTkwLi44NTc0Yjk2ODg3MzYgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbGlu
dXgva3ZtaV9ob3N0LmgKKysrIGIvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaApAQCAtNCwxMyAr
NCwzMSBAQAogCiAjaWZkZWYgQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OCiAKKyNpbmNsdWRlIDxh
c20va3ZtaV9ob3N0Lmg+CisKK3N0cnVjdCBrdm1faW50cm9zcGVjdGlvbiB7CisJc3RydWN0IGt2
bV9hcmNoX2ludHJvc3BlY3Rpb24gYXJjaDsKKwlzdHJ1Y3Qga3ZtICprdm07CisKKwl1dWlkX3Qg
dXVpZDsKKworCXN0cnVjdCBzb2NrZXQgKnNvY2s7CisJc3RydWN0IHRhc2tfc3RydWN0ICpyZWN2
OworfTsKKworaW50IGt2bWlfdmVyc2lvbih2b2lkKTsKIGludCBrdm1pX2luaXQodm9pZCk7CiB2
b2lkIGt2bWlfdW5pbml0KHZvaWQpOwogdm9pZCBrdm1pX2NyZWF0ZV92bShzdHJ1Y3Qga3ZtICpr
dm0pOwogdm9pZCBrdm1pX2Rlc3Ryb3lfdm0oc3RydWN0IGt2bSAqa3ZtKTsKIAoraW50IGt2bWlf
aW9jdGxfaG9vayhzdHJ1Y3Qga3ZtICprdm0sCisJCSAgICBjb25zdCBzdHJ1Y3Qga3ZtX2ludHJv
c3BlY3Rpb25faG9vayAqaG9vayk7CitpbnQga3ZtaV9pb2N0bF91bmhvb2soc3RydWN0IGt2bSAq
a3ZtKTsKKwogI2Vsc2UKIAorc3RhdGljIGlubGluZSBpbnQga3ZtaV92ZXJzaW9uKHZvaWQpIHsg
cmV0dXJuIDA7IH0KIHN0YXRpYyBpbmxpbmUgaW50IGt2bWlfaW5pdCh2b2lkKSB7IHJldHVybiAw
OyB9CiBzdGF0aWMgaW5saW5lIHZvaWQga3ZtaV91bmluaXQodm9pZCkgeyB9CiBzdGF0aWMgaW5s
aW5lIHZvaWQga3ZtaV9jcmVhdGVfdm0oc3RydWN0IGt2bSAqa3ZtKSB7IH0KZGlmZiAtLWdpdCBh
L2luY2x1ZGUvdWFwaS9saW51eC9rdm0uaCBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm0uaAppbmRl
eCA4ODY4MDJiOGZmYmEuLmEwYmUwZWE1YjEzZiAxMDA2NDQKLS0tIGEvaW5jbHVkZS91YXBpL2xp
bnV4L2t2bS5oCisrKyBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm0uaApAQCAtMTA1Niw2ICsxMDU2
LDcgQEAgc3RydWN0IGt2bV9wcGNfcmVzaXplX2hwdCB7CiAjZGVmaW5lIEtWTV9DQVBfRU5GT1JD
RV9QVl9GRUFUVVJFX0NQVUlEIDE5MAogI2RlZmluZSBLVk1fQ0FQX1NZU19IWVBFUlZfQ1BVSUQg
MTkxCiAjZGVmaW5lIEtWTV9DQVBfRElSVFlfTE9HX1JJTkcgMTkyCisjZGVmaW5lIEtWTV9DQVBf
SU5UUk9TUEVDVElPTiAxOTMKIAogI2lmZGVmIEtWTV9DQVBfSVJRX1JPVVRJTkcKIApAQCAtMTY0
Myw2ICsxNjQ0LDE1IEBAIHN0cnVjdCBrdm1fc2V2X2RiZyB7CiAJX191MzIgbGVuOwogfTsKIAor
c3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uX2hvb2sgeworCV9fczMyIGZkOworCV9fdTMyIHBhZGRp
bmc7CisJX191OCB1dWlkWzE2XTsKK307CisKKyNkZWZpbmUgS1ZNX0lOVFJPU1BFQ1RJT05fSE9P
SyAgICBfSU9XKEtWTUlPLCAweGM4LCBzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb25faG9vaykKKyNk
ZWZpbmUgS1ZNX0lOVFJPU1BFQ1RJT05fVU5IT09LICBfSU8oS1ZNSU8sIDB4YzkpCisKICNkZWZp
bmUgS1ZNX0RFVl9BU1NJR05fRU5BQkxFX0lPTU1VCSgxIDw8IDApCiAjZGVmaW5lIEtWTV9ERVZf
QVNTSUdOX1BDSV8yXzMJCSgxIDw8IDEpCiAjZGVmaW5lIEtWTV9ERVZfQVNTSUdOX01BU0tfSU5U
WAkoMSA8PCAyKQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCBiL2luY2x1
ZGUvdWFwaS9saW51eC9rdm1pLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAw
MDAwLi4zNGRkYTkxMDE2ZGIKLS0tIC9kZXYvbnVsbAorKysgYi9pbmNsdWRlL3VhcGkvbGludXgv
a3ZtaS5oCkBAIC0wLDAgKzEsMTMgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwt
Mi4wIFdJVEggTGludXgtc3lzY2FsbC1ub3RlICovCisjaWZuZGVmIF9VQVBJX19MSU5VWF9LVk1J
X0gKKyNkZWZpbmUgX1VBUElfX0xJTlVYX0tWTUlfSAorCisvKgorICogS1ZNSSBzdHJ1Y3R1cmVz
IGFuZCBkZWZpbml0aW9ucworICovCisKK2VudW0geworCUtWTUlfVkVSU0lPTiA9IDB4MDAwMDAw
MDEKK307CisKKyNlbmRpZiAvKiBfVUFQSV9fTElOVVhfS1ZNSV9IICovCmRpZmYgLS1naXQgYS90
b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0vTWFrZWZpbGUgYi90b29scy90ZXN0aW5nL3NlbGZ0
ZXN0cy9rdm0vTWFrZWZpbGUKaW5kZXggNGZlYmY0ZDVlYWQ5Li5mNmU5YTQ0MmEwYTAgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS9NYWtlZmlsZQorKysgYi90b29scy90
ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0vTWFrZWZpbGUKQEAgLTQyLDYgKzQyLDcgQEAgVEVTVF9HRU5f
UFJPR1NfeDg2XzY0ID0geDg2XzY0L2NyNF9jcHVpZF9zeW5jX3Rlc3QKIFRFU1RfR0VOX1BST0dT
X3g4Nl82NCArPSB4ODZfNjQvZXZtY3NfdGVzdAogVEVTVF9HRU5fUFJPR1NfeDg2XzY0ICs9IHg4
Nl82NC9oeXBlcnZfY3B1aWQKIFRFU1RfR0VOX1BST0dTX3g4Nl82NCArPSB4ODZfNjQva3ZtX3B2
X3Rlc3QKK1RFU1RfR0VOX1BST0dTX3g4Nl82NCArPSB4ODZfNjQva3ZtaV90ZXN0CiBURVNUX0dF
Tl9QUk9HU194ODZfNjQgKz0geDg2XzY0L21taW9fd2FybmluZ190ZXN0CiBURVNUX0dFTl9QUk9H
U194ODZfNjQgKz0geDg2XzY0L3BsYXRmb3JtX2luZm9fdGVzdAogVEVTVF9HRU5fUFJPR1NfeDg2
XzY0ICs9IHg4Nl82NC9zZXRfc3JlZ3NfdGVzdApkaWZmIC0tZ2l0IGEvdG9vbHMvdGVzdGluZy9z
ZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3Rz
L2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi4xM2QzZTBhM2FmOWQKLS0tIC9kZXYvbnVsbAorKysgYi90b29scy90ZXN0aW5nL3Nl
bGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCkBAIC0wLDAgKzEsODcgQEAKKy8vIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogS1ZNIGludHJvc3BlY3Rpb24gdGVz
dHMKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMjAsIEJpdGRlZmVuZGVyIFMuUi5MLgorICovCisK
KyNkZWZpbmUgX0dOVV9TT1VSQ0UgLyogZm9yIHByb2dyYW1faW52b2NhdGlvbl9zaG9ydF9uYW1l
ICovCisjaW5jbHVkZSA8c3lzL3R5cGVzLmg+CisjaW5jbHVkZSA8c3lzL3NvY2tldC5oPgorCisj
aW5jbHVkZSAidGVzdF91dGlsLmgiCisKKyNpbmNsdWRlICJrdm1fdXRpbC5oIgorI2luY2x1ZGUg
InByb2Nlc3Nvci5oIgorI2luY2x1ZGUgIi4uL2xpYi9rdm1fdXRpbF9pbnRlcm5hbC5oIgorCisj
aW5jbHVkZSAibGludXgva3ZtaS5oIgorCisjZGVmaW5lIFZDUFVfSUQgMQorCitzdGF0aWMgaW50
IHNvY2tldF9wYWlyWzJdOworI2RlZmluZSBLdm1fc29ja2V0ICAgICAgIHNvY2tldF9wYWlyWzBd
CisjZGVmaW5lIFVzZXJzcGFjZV9zb2NrZXQgc29ja2V0X3BhaXJbMV0KKwordm9pZCBzZXR1cF9z
b2NrZXQodm9pZCkKK3sKKwlpbnQgcjsKKworCXIgPSBzb2NrZXRwYWlyKEFGX1VOSVgsIFNPQ0tf
U1RSRUFNLCAwLCBzb2NrZXRfcGFpcik7CisJVEVTVF9BU1NFUlQociA9PSAwLAorCQkic29ja2V0
cGFpcigpIGZhaWxlZCwgZXJybm8gJWQgKCVzKVxuIiwKKwkJZXJybm8sIHN0cmVycm9yKGVycm5v
KSk7Cit9CisKK3N0YXRpYyB2b2lkIGRvX2hvb2tfaW9jdGwoc3RydWN0IGt2bV92bSAqdm0sIF9f
czMyIGZkLCBpbnQgZXhwZWN0ZWRfZXJyKQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlvbl9o
b29rIGhvb2sgPSB7IC5mZCA9IGZkLCB9OworCWludCByOworCisJciA9IGlvY3RsKHZtLT5mZCwg
S1ZNX0lOVFJPU1BFQ1RJT05fSE9PSywgJmhvb2spOworCVRFU1RfQVNTRVJUKHIgPT0gMCB8fCBl
cnJubyA9PSBleHBlY3RlZF9lcnIsCisJCSJLVk1fSU5UUk9TUEVDVElPTl9IT09LIGZhaWxlZCwg
ZXJybm8gJWQgKCVzKSwgZXhwZWN0ZWQgJWQsIGZkICVkXG4iLAorCQllcnJubywgc3RyZXJyb3Io
ZXJybm8pLCBleHBlY3RlZF9lcnIsIGZkKTsKK30KKworc3RhdGljIHZvaWQgaG9va19pbnRyb3Nw
ZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQoreworCWRvX2hvb2tfaW9jdGwodm0sIC0xLCBFSU5W
QUwpOworCWRvX2hvb2tfaW9jdGwodm0sIEt2bV9zb2NrZXQsIDApOworCWRvX2hvb2tfaW9jdGwo
dm0sIEt2bV9zb2NrZXQsIEVFWElTVCk7Cit9CisKK3N0YXRpYyB2b2lkIHVuaG9va19pbnRyb3Nw
ZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQoreworCWludCByOworCisJciA9IGlvY3RsKHZtLT5m
ZCwgS1ZNX0lOVFJPU1BFQ1RJT05fVU5IT09LLCBOVUxMKTsKKwlURVNUX0FTU0VSVChyID09IDAs
CisJCSJLVk1fSU5UUk9TUEVDVElPTl9VTkhPT0sgZmFpbGVkLCBlcnJubyAlZCAoJXMpXG4iLAor
CQllcnJubywgc3RyZXJyb3IoZXJybm8pKTsKK30KKworc3RhdGljIHZvaWQgdGVzdF9pbnRyb3Nw
ZWN0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQoreworCXNldHVwX3NvY2tldCgpOworCWhvb2tfaW50
cm9zcGVjdGlvbih2bSk7CisJdW5ob29rX2ludHJvc3BlY3Rpb24odm0pOworfQorCitpbnQgbWFp
bihpbnQgYXJnYywgY2hhciAqYXJndltdKQoreworCXN0cnVjdCBrdm1fdm0gKnZtOworCisJaWYg
KCFrdm1fY2hlY2tfY2FwKEtWTV9DQVBfSU5UUk9TUEVDVElPTikpIHsKKwkJcHJpbnRfc2tpcCgi
S1ZNX0NBUF9JTlRST1NQRUNUSU9OIG5vdCBhdmFpbGFibGUiKTsKKwkJZXhpdChLU0ZUX1NLSVAp
OworCX0KKworCXZtID0gdm1fY3JlYXRlX2RlZmF1bHQoVkNQVV9JRCwgMCwgTlVMTCk7CisJdmNw
dV9zZXRfY3B1aWQodm0sIFZDUFVfSUQsIGt2bV9nZXRfc3VwcG9ydGVkX2NwdWlkKCkpOworCisJ
dGVzdF9pbnRyb3NwZWN0aW9uKHZtKTsKKworCWt2bV92bV9mcmVlKHZtKTsKKwlyZXR1cm4gMDsK
K30KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jIGIvdmlydC9rdm0v
aW50cm9zcGVjdGlvbi9rdm1pLmMKaW5kZXggYWY1M2JkY2I3ZWM4Li5jNGQyMGU3NTdlYmIgMTAw
NjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCisrKyBiL3ZpcnQva3ZtL2lu
dHJvc3BlY3Rpb24va3ZtaS5jCkBAIC01LDYgKzUsNyBAQAogICogQ29weXJpZ2h0IChDKSAyMDE3
LTIwMjAgQml0ZGVmZW5kZXIgUy5SLkwuCiAgKgogICovCisjaW5jbHVkZSA8bGludXgva3RocmVh
ZC5oPgogI2luY2x1ZGUgImt2bWlfaW50LmgiCiAKIGludCBrdm1pX2luaXQodm9pZCkKQEAgLTEy
LDE0ICsxMywxNzMgQEAgaW50IGt2bWlfaW5pdCh2b2lkKQogCXJldHVybiAwOwogfQogCitpbnQg
a3ZtaV92ZXJzaW9uKHZvaWQpCit7CisJcmV0dXJuIEtWTUlfVkVSU0lPTjsKK30KKwogdm9pZCBr
dm1pX3VuaW5pdCh2b2lkKQogewogfQogCitzdGF0aWMgdm9pZCBrdm1pX2ZyZWUoc3RydWN0IGt2
bSAqa3ZtKQoreworCWtmcmVlKGt2bS0+a3ZtaSk7CisJa3ZtLT5rdm1pID0gTlVMTDsKK30KKwor
c3RhdGljIHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqCitrdm1pX2FsbG9jKHN0cnVjdCBrdm0g
Kmt2bSwgY29uc3Qgc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uX2hvb2sgKmhvb2spCit7CisJc3Ry
dWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pOworCisJa3ZtaSA9IGt6YWxsb2Moc2l6ZW9mKCpr
dm1pKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFrdm1pKQorCQlyZXR1cm4gTlVMTDsKKworCUJVSUxE
X0JVR19PTihzaXplb2YoaG9vay0+dXVpZCkgIT0gc2l6ZW9mKGt2bWktPnV1aWQpKTsKKwltZW1j
cHkoJmt2bWktPnV1aWQsICZob29rLT51dWlkLCBzaXplb2Yoa3ZtaS0+dXVpZCkpOworCisJa3Zt
aS0+a3ZtID0ga3ZtOworCisJcmV0dXJuIGt2bWk7Cit9CisKK3N0YXRpYyB2b2lkIGt2bWlfZGVz
dHJveShzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkpCit7CisJc3RydWN0IGt2bSAqa3Zt
ID0ga3ZtaS0+a3ZtOworCisJa3ZtaV9mcmVlKGt2bSk7Cit9CisKK3N0YXRpYyB2b2lkIGt2bWlf
c3RvcF9yZWN2X3RocmVhZChzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkpCit7CisJa3Zt
aV9zb2NrX3NodXRkb3duKGt2bWkpOworfQorCitzdGF0aWMgdm9pZCBfX2t2bWlfdW5ob29rKHN0
cnVjdCBrdm0gKmt2bSkKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkgPSBLVk1J
KGt2bSk7CisKKwl3YWl0X2Zvcl9jb21wbGV0aW9uX2tpbGxhYmxlKCZrdm0tPmt2bWlfY29tcGxl
dGUpOworCWt2bWlfc29ja19wdXQoa3ZtaSk7Cit9CisKK3N0YXRpYyB2b2lkIGt2bWlfdW5ob29r
KHN0cnVjdCBrdm0gKmt2bSkKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWk7CisK
KwltdXRleF9sb2NrKCZrdm0tPmt2bWlfbG9jayk7CisKKwlrdm1pID0gS1ZNSShrdm0pOworCWlm
IChrdm1pKSB7CisJCWt2bWlfc3RvcF9yZWN2X3RocmVhZChrdm1pKTsKKwkJX19rdm1pX3VuaG9v
ayhrdm0pOworCQlrdm1pX2Rlc3Ryb3koa3ZtaSk7CisJfQorCisJbXV0ZXhfdW5sb2NrKCZrdm0t
Pmt2bWlfbG9jayk7Cit9CisKK2ludCBrdm1pX2lvY3RsX3VuaG9vayhzdHJ1Y3Qga3ZtICprdm0p
Cit7CisJa3ZtaV91bmhvb2soa3ZtKTsKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQga3Zt
aV9wdXQoc3RydWN0IGt2bSAqa3ZtKQoreworCWlmIChyZWZjb3VudF9kZWNfYW5kX3Rlc3QoJmt2
bS0+a3ZtaV9yZWYpKQorCQljb21wbGV0ZSgma3ZtLT5rdm1pX2NvbXBsZXRlKTsKK30KKworc3Rh
dGljIGludCBfX2t2bWlfaG9vayhzdHJ1Y3Qga3ZtICprdm0sCisJCSAgICAgICBjb25zdCBzdHJ1
Y3Qga3ZtX2ludHJvc3BlY3Rpb25faG9vayAqaG9vaykKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3Bl
Y3Rpb24gKmt2bWkgPSBLVk1JKGt2bSk7CisKKwlpZiAoIWt2bWlfc29ja19nZXQoa3ZtaSwgaG9v
ay0+ZmQpKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50
IGt2bWlfcmVjdl90aHJlYWQodm9pZCAqYXJnKQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlv
biAqa3ZtaSA9IGFyZzsKKworCXdoaWxlIChrdm1pX21zZ19wcm9jZXNzKGt2bWkpKQorCQk7CisK
KwkvKiBTaWduYWwgdXNlcnNwYWNlIGFuZCBwcmV2ZW50IHRoZSB2Q1BVcyBmcm9tIHNlbmRpbmcg
ZXZlbnRzLiAqLworCWt2bWlfc29ja19zaHV0ZG93bihrdm1pKTsKKworCWt2bWlfcHV0KGt2bWkt
Pmt2bSk7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQga3ZtaV9ob29rKHN0cnVjdCBrdm0g
Kmt2bSwKKwkJICAgICBjb25zdCBzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb25faG9vayAqaG9vaykK
K3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWk7CisJaW50IGVyciA9IDA7CisKKwlt
dXRleF9sb2NrKCZrdm0tPmt2bWlfbG9jayk7CisKKwlpZiAoa3ZtLT5rdm1pKSB7CisJCWVyciA9
IC1FRVhJU1Q7CisJCWdvdG8gb3V0OworCX0KKworCWt2bWkgPSBrdm1pX2FsbG9jKGt2bSwgaG9v
ayk7CisJaWYgKCFrdm1pKSB7CisJCWVyciA9IC1FTk9NRU07CisJCWdvdG8gb3V0OworCX0KKwor
CWt2bS0+a3ZtaSA9IGt2bWk7CisKKwllcnIgPSBfX2t2bWlfaG9vayhrdm0sIGhvb2spOworCWlm
IChlcnIpCisJCWdvdG8gZGVzdHJveTsKKworCWluaXRfY29tcGxldGlvbigma3ZtLT5rdm1pX2Nv
bXBsZXRlKTsKKworCXJlZmNvdW50X3NldCgma3ZtLT5rdm1pX3JlZiwgMSk7CisKKwlrdm1pLT5y
ZWN2ID0ga3RocmVhZF9ydW4oa3ZtaV9yZWN2X3RocmVhZCwga3ZtaSwgImt2bWktcmVjdiIpOwor
CWlmIChJU19FUlIoa3ZtaS0+cmVjdikpIHsKKwkJZXJyID0gLUVOT01FTTsKKwkJa3ZtaV9wdXQo
a3ZtKTsKKwkJZ290byB1bmhvb2s7CisJfQorCisJZ290byBvdXQ7CisKK3VuaG9vazoKKwlfX2t2
bWlfdW5ob29rKGt2bSk7CitkZXN0cm95OgorCWt2bWlfZGVzdHJveShrdm1pKTsKK291dDoKKwlt
dXRleF91bmxvY2soJmt2bS0+a3ZtaV9sb2NrKTsKKwlyZXR1cm4gZXJyOworfQorCitpbnQga3Zt
aV9pb2N0bF9ob29rKHN0cnVjdCBrdm0gKmt2bSwKKwkJICAgIGNvbnN0IHN0cnVjdCBrdm1faW50
cm9zcGVjdGlvbl9ob29rICpob29rKQoreworCWlmIChob29rLT5wYWRkaW5nKQorCQlyZXR1cm4g
LUVJTlZBTDsKKworCXJldHVybiBrdm1pX2hvb2soa3ZtLCBob29rKTsKK30KKwogdm9pZCBrdm1p
X2NyZWF0ZV92bShzdHJ1Y3Qga3ZtICprdm0pCiB7CisJbXV0ZXhfaW5pdCgma3ZtLT5rdm1pX2xv
Y2spOwogfQogCiB2b2lkIGt2bWlfZGVzdHJveV92bShzdHJ1Y3Qga3ZtICprdm0pCiB7CisJa3Zt
aV91bmhvb2soa3ZtKTsKIH0KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3Zt
aV9pbnQuaCBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaAppbmRleCBiZGI0MjI4
ZmRhNWIuLmM4OTg3NWJkMmJhYyAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9r
dm1pX2ludC5oCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaApAQCAtMyw1
ICszLDE1IEBACiAjZGVmaW5lIF9fS1ZNSV9JTlRfSAogCiAjaW5jbHVkZSA8bGludXgva3ZtX2hv
c3QuaD4KKyNpbmNsdWRlIDxsaW51eC9rdm1pX2hvc3QuaD4KKyNpbmNsdWRlIDx1YXBpL2xpbnV4
L2t2bWkuaD4KKworI2RlZmluZSBLVk1JKGt2bSkgKChrdm0pLT5rdm1pKQorCisvKiBrdm1pX21z
Zy5jICovCitib29sIGt2bWlfc29ja19nZXQoc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1p
LCBpbnQgZmQpOwordm9pZCBrdm1pX3NvY2tfc2h1dGRvd24oc3RydWN0IGt2bV9pbnRyb3NwZWN0
aW9uICprdm1pKTsKK3ZvaWQga3ZtaV9zb2NrX3B1dChzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24g
Kmt2bWkpOworYm9vbCBrdm1pX21zZ19wcm9jZXNzKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAq
a3ZtaSk7CiAKICNlbmRpZgpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1p
X21zZy5jIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uM2FlNTJjNjFmODYxCi0tLSAvZGV2L251bGwKKysr
IGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCkBAIC0wLDAgKzEsMzkgQEAKKy8v
IFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogS1ZNIGludHJvc3BlY3Rp
b24gKG1lc3NhZ2UgaGFuZGxpbmcpCisgKgorICogQ29weXJpZ2h0IChDKSAyMDE3LTIwMjAgQml0
ZGVmZW5kZXIgUy5SLkwuCisgKgorICovCisjaW5jbHVkZSA8bGludXgvbmV0Lmg+CisjaW5jbHVk
ZSAia3ZtaV9pbnQuaCIKKworYm9vbCBrdm1pX3NvY2tfZ2V0KHN0cnVjdCBrdm1faW50cm9zcGVj
dGlvbiAqa3ZtaSwgaW50IGZkKQoreworCXN0cnVjdCBzb2NrZXQgKnNvY2s7CisJaW50IGVycjsK
KworCXNvY2sgPSBzb2NrZmRfbG9va3VwKGZkLCAmZXJyKTsKKwlpZiAoIXNvY2spCisJCXJldHVy
biBmYWxzZTsKKworCWt2bWktPnNvY2sgPSBzb2NrOworCisJcmV0dXJuIHRydWU7Cit9CisKK3Zv
aWQga3ZtaV9zb2NrX3B1dChzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkpCit7CisJaWYg
KGt2bWktPnNvY2spCisJCXNvY2tmZF9wdXQoa3ZtaS0+c29jayk7Cit9CisKK3ZvaWQga3ZtaV9z
b2NrX3NodXRkb3duKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSkKK3sKKwlrZXJuZWxf
c29ja19zaHV0ZG93bihrdm1pLT5zb2NrLCBTSFVUX1JEV1IpOworfQorCitib29sIGt2bWlfbXNn
X3Byb2Nlc3Moc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pKQoreworCXJldHVybiBmYWxz
ZTsKK30KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2t2bV9tYWluLmMgYi92aXJ0L2t2bS9rdm1fbWFp
bi5jCmluZGV4IGNkYzUyYmIyZjgxOS4uZjg5ZTBjOTA5ZGU3IDEwMDY0NAotLS0gYS92aXJ0L2t2
bS9rdm1fbWFpbi5jCisrKyBiL3ZpcnQva3ZtL2t2bV9tYWluLmMKQEAgLTQwMTgsNiArNDAxOCwy
NyBAQCBzdGF0aWMgbG9uZyBrdm1fdm1faW9jdGwoc3RydWN0IGZpbGUgKmZpbHAsCiAJY2FzZSBL
Vk1fUkVTRVRfRElSVFlfUklOR1M6CiAJCXIgPSBrdm1fdm1faW9jdGxfcmVzZXRfZGlydHlfcGFn
ZXMoa3ZtKTsKIAkJYnJlYWs7CisjaWZkZWYgQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OCisJY2Fz
ZSBLVk1fSU5UUk9TUEVDVElPTl9IT09LOiB7CisJCXN0cnVjdCBrdm1faW50cm9zcGVjdGlvbl9o
b29rIGhvb2s7CisKKwkJciA9IC1FUEVSTTsKKwkJaWYgKCFlbmFibGVfaW50cm9zcGVjdGlvbikK
KwkJCWdvdG8gb3V0OworCisJCXIgPSAtRUZBVUxUOworCQlpZiAoY29weV9mcm9tX3VzZXIoJmhv
b2ssIGFyZ3AsIHNpemVvZihob29rKSkpCisJCQlnb3RvIG91dDsKKworCQlyID0ga3ZtaV9pb2N0
bF9ob29rKGt2bSwgJmhvb2spOworCQlicmVhazsKKwl9CisJY2FzZSBLVk1fSU5UUk9TUEVDVElP
Tl9VTkhPT0s6CisJCXIgPSAtRVBFUk07CisJCWlmIChlbmFibGVfaW50cm9zcGVjdGlvbikKKwkJ
CXIgPSBrdm1pX2lvY3RsX3VuaG9vayhrdm0pOworCQlicmVhazsKKyNlbmRpZiAvKiBDT05GSUdf
S1ZNX0lOVFJPU1BFQ1RJT04gKi8KIAlkZWZhdWx0OgogCQlyID0ga3ZtX2FyY2hfdm1faW9jdGwo
ZmlscCwgaW9jdGwsIGFyZyk7CiAJfQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmlydHVhbGl6YXRpb25A
bGlzdHMubGludXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51eGZvdW5kYXRpb24u
b3JnL21haWxtYW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
