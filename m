Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
	by mail.lfdr.de (Postfix) with ESMTPS id C25A1228B3B
	for <lists.virtualization@lfdr.de>; Tue, 21 Jul 2020 23:26:27 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by hemlock.osuosl.org (Postfix) with ESMTP id 7F2DC884B5;
	Tue, 21 Jul 2020 21:26:26 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id N12Ztn6IEO5M; Tue, 21 Jul 2020 21:26:21 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by hemlock.osuosl.org (Postfix) with ESMTP id 3DF8A884EE;
	Tue, 21 Jul 2020 21:26:21 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 13CF8C016F;
	Tue, 21 Jul 2020 21:26:21 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 1185FC088E
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:26:12 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by whitealder.osuosl.org (Postfix) with ESMTP id DD9E185A5B
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:26:11 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id uleNsVJR9a3q
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:26:04 +0000 (UTC)
X-Greylist: from auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by whitealder.osuosl.org (Postfix) with ESMTPS id DC096882B3
 for <virtualization@lists.linux-foundation.org>;
 Tue, 21 Jul 2020 21:25:58 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 B6CBB3041305; Wed, 22 Jul 2020 00:09:24 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.27])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 85511304FA12;
 Wed, 22 Jul 2020 00:09:24 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v9 38/84] KVM: introspection: add hook/unhook ioctls
Date: Wed, 22 Jul 2020 00:08:36 +0300
Message-Id: <20200721210922.7646-39-alazar@bitdefender.com>
In-Reply-To: <20200721210922.7646-1-alazar@bitdefender.com>
References: <20200721210922.7646-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <ncitu@bitdefender.com>,
 =?UTF-8?q?Mircea=20C=C3=AErjaliu?= <mcirjaliu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gaG9vaywgYSBuZXcgdGhyZWFkIGlzIGNyZWF0ZWQgdG8gaGFuZGxlIHRoZSBtZXNzYWdlcyBj
b21pbmcgZnJvbSB0aGUKaW50cm9zcGVjdGlvbiB0b29sIChjb21tYW5kcyBvciBldmVudCByZXBs
aWVzKS4gVGhlIFZNIHJlbGF0ZWQgY29tbWFuZHMKYXJlIGhhbmRsZWQgYnkgdGhpcyB0aHJlYWQs
IHdoaWxlIHRoZSB2Q1BVIGNvbW1hbmRzIGFuZCBldmVudHMgcmVwbGllcwphcmUgZGlzcGF0Y2hl
ZCB0byB0aGUgdkNQVSB0aHJlYWRzLgoKT24gdW5ob29rLCB0aGUgc29ja2V0IGlzIHNodXQgZG93
biwgd2hpY2ggd2lsbCBzaWduYWw6IHRoZSByZWNlaXZpbmcKdGhyZWFkIHRvIHF1aXQgKGJlY2F1
c2UgaXQgbWlnaHQgYmUgYmxvY2tlZCBpbiByZWN2bXNnKCkpIGFuZCB0aGUKaW50cm9zcGVjdGlv
biB0b29sIHRvIGNsZWFuIHVwLgoKVGhlIG11dGV4IGlzIHVzZWQgdG8gcHJvdGVjdCB0aGUgJ2t2
bS0+a3ZtaScgcG9pbnRlciB3aGVuIGFjY2Vzc2VkIHRocm91Z2gKaW9jdGxzLgoKVGhlIHJlZmVy
ZW5jZSBjb3VudGVyIGlzIHVzZWQgYnkgdGhlIHJlY2VpdmluZyB0aHJlYWQgKGZvciBpdHMgZW50
aXJlCmxpZmUgdGltZSkgYW5kIGJ5IHRoZSB2Q1BVIHRocmVhZHMgd2hpbGUgc2VuZGluZyBpbnRy
b3NwZWN0aW9uIGV2ZW50cwpvciBoYW5kbGluZyBpbnRyb3NwZWN0aW9uIGNvbW1hbmRzLgoKVGhl
IGNvbXBsZXRpb24gb2JqZWN0cyBpcyBzZXQgd2hlbiB0aGUgcmVmZXJlbmNlIGNvdW50ZXIgcmVh
Y2hlcyB6ZXJvIGFuZAp0aGUgdW5ob29rIHByb2Nlc3MgaXMgd2FpdGluZyBmb3IgaXQgaW4gb3Jk
ZXIgdG8gZnJlZSB0aGUgaW50cm9zcGVjdGlvbgpzdHJ1Y3R1cmVzLgoKQ28tZGV2ZWxvcGVkLWJ5
OiBNaXJjZWEgQ8OucmphbGl1IDxtY2lyamFsaXVAYml0ZGVmZW5kZXIuY29tPgpTaWduZWQtb2Zm
LWJ5OiBNaXJjZWEgQ8OucmphbGl1IDxtY2lyamFsaXVAYml0ZGVmZW5kZXIuY29tPgpDby1kZXZl
bG9wZWQtYnk6IE5pY3XImW9yIEPDrsibdSA8bmNpdHVAYml0ZGVmZW5kZXIuY29tPgpTaWduZWQt
b2ZmLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5jaXR1QGJpdGRlZmVuZGVyLmNvbT4KU2lnbmVkLW9m
Zi1ieTogQWRhbGJlcnQgTGF6xINyIDxhbGF6YXJAYml0ZGVmZW5kZXIuY29tPgotLS0KIERvY3Vt
ZW50YXRpb24vdmlydC9rdm0vYXBpLnJzdCAgICAgICAgICAgICAgICB8ICA1NSArKysrKysKIGFy
Y2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5oICAgICAgICAgICAgICB8ICAgOCArCiBhcmNo
L3g4Ni9rdm0vTWFrZWZpbGUgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIGFyY2gv
eDg2L2t2bS94ODYuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgNiArCiBpbmNsdWRl
L2xpbnV4L2t2bV9ob3N0LmggICAgICAgICAgICAgICAgICAgICAgfCAgIDUgKwogaW5jbHVkZS9s
aW51eC9rdm1pX2hvc3QuaCAgICAgICAgICAgICAgICAgICAgIHwgIDE3ICsrCiBpbmNsdWRlL3Vh
cGkvbGludXgva3ZtLmggICAgICAgICAgICAgICAgICAgICAgfCAgMTAgKysKIGluY2x1ZGUvdWFw
aS9saW51eC9rdm1pLmggICAgICAgICAgICAgICAgICAgICB8ICAxMyArKwogdG9vbHMvdGVzdGlu
Zy9zZWxmdGVzdHMva3ZtL01ha2VmaWxlICAgICAgICAgIHwgICAxICsKIC4uLi90ZXN0aW5nL3Nl
bGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jICB8ICA5NCArKysrKysrKysrCiB2aXJ0L2t2
bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyAgICAgICAgICAgICAgICAgfCAxNjIgKysrKysrKysrKysr
KysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmggICAgICAgICAgICAgfCAg
MjIgKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgICAgICAgICAgICAgfCAg
MzkgKysrKysKIHZpcnQva3ZtL2t2bV9tYWluLmMgICAgICAgICAgICAgICAgICAgICAgICAgICB8
ICAxOSArKwogMTQgZmlsZXMgY2hhbmdlZCwgNDUyIGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24o
LSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBhcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1pX2hvc3QuaAog
Y3JlYXRlIG1vZGUgMTAwNjQ0IGluY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKIGNyZWF0ZSBtb2Rl
IDEwMDY0NCB0b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCiBj
cmVhdGUgbW9kZSAxMDA2NDQgdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCgpkaWZm
IC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9hcGkucnN0IGIvRG9jdW1lbnRhdGlvbi92
aXJ0L2t2bS9hcGkucnN0CmluZGV4IDMyMDc4OGY4MWEwNS4uZTM0ZjIwNDMwZWIxIDEwMDY0NAot
LS0gYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2FwaS5yc3QKKysrIGIvRG9jdW1lbnRhdGlvbi92
aXJ0L2t2bS9hcGkucnN0CkBAIC00Njk3LDYgKzQ2OTcsNjEgQEAgS1ZNX1BWX1ZNX1ZFUklGWQog
ICBWZXJpZnkgdGhlIGludGVncml0eSBvZiB0aGUgdW5wYWNrZWQgaW1hZ2UuIE9ubHkgaWYgdGhp
cyBzdWNjZWVkcywKICAgS1ZNIGlzIGFsbG93ZWQgdG8gc3RhcnQgcHJvdGVjdGVkIFZDUFVzLgog
Cis0LjEyNiBLVk1fSU5UUk9TUEVDVElPTl9IT09LCistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCisKKzpDYXBhYmlsaXR5OiBLVk1fQ0FQX0lOVFJPU1BFQ1RJT04KKzpBcmNoaXRlY3R1cmVz
OiB4ODYKKzpUeXBlOiB2bSBpb2N0bAorOlBhcmFtZXRlcnM6IHN0cnVjdCBrdm1faW50cm9zcGVj
dGlvbiAoaW4pCis6UmV0dXJuczogMCBvbiBzdWNjZXNzLCBhIG5lZ2F0aXZlIHZhbHVlIG9uIGVy
cm9yCisKK0Vycm9yczoKKworICA9PT09PT0gICAgID09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KKyAgRU5PTUVNICAgICB0aGUgbWVtb3J5
IGFsbG9jYXRpb24gZmFpbGVkCisgIEVFWElTVCAgICAgdGhlIFZNIGlzIGFscmVhZHkgaW50cm9z
cGVjdGVkCisgIEVJTlZBTCAgICAgdGhlIGZpbGUgZGVzY3JpcHRvciBkb2Vzbid0IGNvcnJlc3Bv
bmQgdG8gYW4gYWN0aXZlIHNvY2tldAorICBFSU5WQUwgICAgIHRoZSBwYWRkaW5nIGlzIG5vdCB6
ZXJvCisgIEVQRVJNICAgICAgdGhlIGludHJvc3BlY3Rpb24gaXMgZGlzYWJsZWQgKGt2bS5pbnRy
b3NwZWN0aW9uPTApCisgID09PT09PSAgICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorCitUaGlzIGlvY3RsIGlzIHVzZWQgdG8gZW5h
YmxlIHRoZSBpbnRyb3NwZWN0aW9uIG9mIHRoZSBjdXJyZW50IFZNLgorCis6OgorCisgIHN0cnVj
dCBrdm1faW50cm9zcGVjdGlvbiB7CisJX19zMzIgZmQ7CisJX191MzIgcGFkZGluZzsKKwlfX3U4
IHV1aWRbMTZdOworICB9OworCitmZCBpcyB0aGUgZmlsZSBkZXNjcmlwdG9yIG9mIGEgc29ja2V0
IGNvbm5lY3RlZCB0byB0aGUgaW50cm9zcGVjdGlvbiB0b29sLAorCitwYWRkaW5nIG11c3QgYmUg
emVybyAoaXQgbWlnaHQgYmUgdXNlZCBpbiB0aGUgZnV0dXJlKSwKKwordXVpZCBpcyB1c2VkIGZv
ciBkZWJ1ZyBhbmQgZXJyb3IgbWVzc2FnZXMuCisKK1RoZSBLVk1JIHZlcnNpb24gY2FuIGJlIHJl
dHJpZXZlZCB1c2luZyB0aGUgS1ZNX0NBUF9JTlRST1NQRUNUSU9OIG9mCit0aGUgS1ZNX0NIRUNL
X0VYVEVOU0lPTiBpb2N0bCgpIGF0IHJ1bi10aW1lLgorCis0LjEyNyBLVk1fSU5UUk9TUEVDVElP
Tl9VTkhPT0sKKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorCis6Q2FwYWJpbGl0eTog
S1ZNX0NBUF9JTlRST1NQRUNUSU9OCis6QXJjaGl0ZWN0dXJlczogeDg2Cis6VHlwZTogdm0gaW9j
dGwKKzpQYXJhbWV0ZXJzOiBub25lCis6UmV0dXJuczogMCBvbiBzdWNjZXNzLCBhIG5lZ2F0aXZl
IHZhbHVlIG9uIGVycm9yCisKK0Vycm9yczoKKworICA9PT09PT0gICAgID09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KKyAgRVBFUk0gICAg
ICB0aGUgaW50cm9zcGVjdGlvbiBpcyBkaXNhYmxlZCAoa3ZtLmludHJvc3BlY3Rpb249MCkKKyAg
PT09PT09ICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09CisKK1RoaXMgaW9jdGwgaXMgdXNlZCB0byBmcmVlIGFsbCBpbnRyb3NwZWN0
aW9uIHN0cnVjdHVyZXMKK3JlbGF0ZWQgdG8gdGhpcyBWTS4KIAogNS4gVGhlIGt2bV9ydW4gc3Ry
dWN0dXJlCiA9PT09PT09PT09PT09PT09PT09PT09PT0KZGlmZiAtLWdpdCBhL2FyY2gveDg2L2lu
Y2x1ZGUvYXNtL2t2bWlfaG9zdC5oIGIvYXJjaC94ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmgK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4zOGMzOTgyNjI5MTMKLS0t
IC9kZXYvbnVsbAorKysgYi9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1pX2hvc3QuaApAQCAtMCww
ICsxLDggQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCisjaWZuZGVm
IF9BU01fWDg2X0tWTUlfSE9TVF9ICisjZGVmaW5lIF9BU01fWDg2X0tWTUlfSE9TVF9ICisKK3N0
cnVjdCBrdm1fYXJjaF9pbnRyb3NwZWN0aW9uIHsKK307CisKKyNlbmRpZiAvKiBfQVNNX1g4Nl9L
Vk1JX0hPU1RfSCAqLwpkaWZmIC0tZ2l0IGEvYXJjaC94ODYva3ZtL01ha2VmaWxlIGIvYXJjaC94
ODYva3ZtL01ha2VmaWxlCmluZGV4IDg4MGIwMjhjN2Y4Ni4uZmIwMjQyMDMyY2QxIDEwMDY0NAot
LS0gYS9hcmNoL3g4Ni9rdm0vTWFrZWZpbGUKKysrIGIvYXJjaC94ODYva3ZtL01ha2VmaWxlCkBA
IC0xMyw3ICsxMyw3IEBAIEtWTUkgOj0gJChLVk0pL2ludHJvc3BlY3Rpb24KIGt2bS15CQkJKz0g
JChLVk0pL2t2bV9tYWluLm8gJChLVk0pL2NvYWxlc2NlZF9tbWlvLm8gXAogCQkJCSQoS1ZNKS9l
dmVudGZkLm8gJChLVk0pL2lycWNoaXAubyAkKEtWTSkvdmZpby5vCiBrdm0tJChDT05GSUdfS1ZN
X0FTWU5DX1BGKQkrPSAkKEtWTSkvYXN5bmNfcGYubwota3ZtLSQoQ09ORklHX0tWTV9JTlRST1NQ
RUNUSU9OKSArPSAkKEtWTUkpL2t2bWkubwora3ZtLSQoQ09ORklHX0tWTV9JTlRST1NQRUNUSU9O
KSArPSAkKEtWTUkpL2t2bWkubyAkKEtWTUkpL2t2bWlfbXNnLm8KIAoga3ZtLXkJCQkrPSB4ODYu
byBlbXVsYXRlLm8gaTgyNTkubyBpcnEubyBsYXBpYy5vIFwKIAkJCSAgIGk4MjU0Lm8gaW9hcGlj
Lm8gaXJxX2NvbW0ubyBjcHVpZC5vIHBtdS5vIG10cnIubyBcCmRpZmYgLS1naXQgYS9hcmNoL3g4
Ni9rdm0veDg2LmMgYi9hcmNoL3g4Ni9rdm0veDg2LmMKaW5kZXggZmZjZjA5ZTliZjc4Li5mZjBk
M2M4MmRlNjQgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS94ODYuYworKysgYi9hcmNoL3g4Ni9r
dm0veDg2LmMKQEAgLTU2LDYgKzU2LDcgQEAKICNpbmNsdWRlIDxsaW51eC9zY2hlZC9zdGF0Lmg+
CiAjaW5jbHVkZSA8bGludXgvc2NoZWQvaXNvbGF0aW9uLmg+CiAjaW5jbHVkZSA8bGludXgvbWVt
X2VuY3J5cHQuaD4KKyNpbmNsdWRlIDxsaW51eC9rdm1pX2hvc3QuaD4KIAogI2luY2x1ZGUgPHRy
YWNlL2V2ZW50cy9rdm0uaD4KIApAQCAtMzUzOCw2ICszNTM5LDExIEBAIGludCBrdm1fdm1faW9j
dGxfY2hlY2tfZXh0ZW5zaW9uKHN0cnVjdCBrdm0gKmt2bSwgbG9uZyBleHQpCiAJY2FzZSBLVk1f
Q0FQX0hZUEVSVl9FTkxJR0hURU5FRF9WTUNTOgogCQlyID0ga3ZtX3g4Nl9vcHMubmVzdGVkX29w
cy0+ZW5hYmxlX2V2bWNzICE9IE5VTEw7CiAJCWJyZWFrOworI2lmZGVmIENPTkZJR19LVk1fSU5U
Uk9TUEVDVElPTgorCWNhc2UgS1ZNX0NBUF9JTlRST1NQRUNUSU9OOgorCQlyID0ga3ZtaV92ZXJz
aW9uKCk7CisJCWJyZWFrOworI2VuZGlmCiAJZGVmYXVsdDoKIAkJYnJlYWs7CiAJfQpkaWZmIC0t
Z2l0IGEvaW5jbHVkZS9saW51eC9rdm1faG9zdC5oIGIvaW5jbHVkZS9saW51eC9rdm1faG9zdC5o
CmluZGV4IDViNmYxMzM4ZGU3NC4uYzgyYzU1MDg1NjA0IDEwMDY0NAotLS0gYS9pbmNsdWRlL2xp
bnV4L2t2bV9ob3N0LmgKKysrIGIvaW5jbHVkZS9saW51eC9rdm1faG9zdC5oCkBAIC01MDQsNiAr
NTA0LDExIEBAIHN0cnVjdCBrdm0gewogCXN0cnVjdCBzcmN1X3N0cnVjdCBpcnFfc3JjdTsKIAlw
aWRfdCB1c2Vyc3BhY2VfcGlkOwogCXVuc2lnbmVkIGludCBtYXhfaGFsdF9wb2xsX25zOworCisJ
c3RydWN0IG11dGV4IGt2bWlfbG9jazsKKwlyZWZjb3VudF90IGt2bWlfcmVmOworCXN0cnVjdCBj
b21wbGV0aW9uIGt2bWlfY29tcGxldGU7CisJc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1p
OwogfTsKIAogI2RlZmluZSBrdm1fZXJyKGZtdCwgLi4uKSBcCmRpZmYgLS1naXQgYS9pbmNsdWRl
L2xpbnV4L2t2bWlfaG9zdC5oIGIvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaAppbmRleCAxZTBh
NzNjMmExOTAuLjU1ZmY1NzFkYjQwZCAxMDA2NDQKLS0tIGEvaW5jbHVkZS9saW51eC9rdm1pX2hv
c3QuaAorKysgYi9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oCkBAIC00LDExICs0LDI4IEBACiAK
ICNpZmRlZiBDT05GSUdfS1ZNX0lOVFJPU1BFQ1RJT04KIAorI2luY2x1ZGUgPGFzbS9rdm1pX2hv
c3QuaD4KKworc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uIHsKKwlzdHJ1Y3Qga3ZtX2FyY2hfaW50
cm9zcGVjdGlvbiBhcmNoOworCXN0cnVjdCBrdm0gKmt2bTsKKworCXV1aWRfdCB1dWlkOworCisJ
c3RydWN0IHNvY2tldCAqc29jazsKKwlzdHJ1Y3QgdGFza19zdHJ1Y3QgKnJlY3Y7Cit9OworCitp
bnQga3ZtaV92ZXJzaW9uKHZvaWQpOwogaW50IGt2bWlfaW5pdCh2b2lkKTsKIHZvaWQga3ZtaV91
bmluaXQodm9pZCk7CiB2b2lkIGt2bWlfY3JlYXRlX3ZtKHN0cnVjdCBrdm0gKmt2bSk7CiB2b2lk
IGt2bWlfZGVzdHJveV92bShzdHJ1Y3Qga3ZtICprdm0pOwogCitpbnQga3ZtaV9pb2N0bF9ob29r
KHN0cnVjdCBrdm0gKmt2bSwKKwkJICAgIGNvbnN0IHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbl9o
b29rICpob29rKTsKK2ludCBrdm1pX2lvY3RsX3VuaG9vayhzdHJ1Y3Qga3ZtICprdm0pOworCiAj
ZWxzZQogCiBzdGF0aWMgaW5saW5lIGludCBrdm1pX2luaXQodm9pZCkgeyByZXR1cm4gMDsgfQpk
aWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2bS5oIGIvaW5jbHVkZS91YXBpL2xpbnV4
L2t2bS5oCmluZGV4IDRmZGYzMDMxNjU4Mi4uZGQ4NGViZGZjZDZkIDEwMDY0NAotLS0gYS9pbmNs
dWRlL3VhcGkvbGludXgva3ZtLmgKKysrIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bS5oCkBAIC0x
MDMxLDYgKzEwMzEsNyBAQCBzdHJ1Y3Qga3ZtX3BwY19yZXNpemVfaHB0IHsKICNkZWZpbmUgS1ZN
X0NBUF9QUENfU0VDVVJFX0dVRVNUIDE4MQogI2RlZmluZSBLVk1fQ0FQX0hBTFRfUE9MTCAxODIK
ICNkZWZpbmUgS1ZNX0NBUF9BU1lOQ19QRl9JTlQgMTgzCisjZGVmaW5lIEtWTV9DQVBfSU5UUk9T
UEVDVElPTiAxODQKIAogI2lmZGVmIEtWTV9DQVBfSVJRX1JPVVRJTkcKIApAQCAtMTYxMiw2ICsx
NjEzLDE1IEBAIHN0cnVjdCBrdm1fc2V2X2RiZyB7CiAJX191MzIgbGVuOwogfTsKIAorc3RydWN0
IGt2bV9pbnRyb3NwZWN0aW9uX2hvb2sgeworCV9fczMyIGZkOworCV9fdTMyIHBhZGRpbmc7CisJ
X191OCB1dWlkWzE2XTsKK307CisKKyNkZWZpbmUgS1ZNX0lOVFJPU1BFQ1RJT05fSE9PSyAgICBf
SU9XKEtWTUlPLCAweGMzLCBzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb25faG9vaykKKyNkZWZpbmUg
S1ZNX0lOVFJPU1BFQ1RJT05fVU5IT09LICBfSU8oS1ZNSU8sIDB4YzQpCisKICNkZWZpbmUgS1ZN
X0RFVl9BU1NJR05fRU5BQkxFX0lPTU1VCSgxIDw8IDApCiAjZGVmaW5lIEtWTV9ERVZfQVNTSUdO
X1BDSV8yXzMJCSgxIDw8IDEpCiAjZGVmaW5lIEtWTV9ERVZfQVNTSUdOX01BU0tfSU5UWAkoMSA8
PCAyKQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCBiL2luY2x1ZGUvdWFw
aS9saW51eC9rdm1pLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4z
NGRkYTkxMDE2ZGIKLS0tIC9kZXYvbnVsbAorKysgYi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5o
CkBAIC0wLDAgKzEsMTMgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wIFdJ
VEggTGludXgtc3lzY2FsbC1ub3RlICovCisjaWZuZGVmIF9VQVBJX19MSU5VWF9LVk1JX0gKKyNk
ZWZpbmUgX1VBUElfX0xJTlVYX0tWTUlfSAorCisvKgorICogS1ZNSSBzdHJ1Y3R1cmVzIGFuZCBk
ZWZpbml0aW9ucworICovCisKK2VudW0geworCUtWTUlfVkVSU0lPTiA9IDB4MDAwMDAwMDEKK307
CisKKyNlbmRpZiAvKiBfVUFQSV9fTElOVVhfS1ZNSV9IICovCmRpZmYgLS1naXQgYS90b29scy90
ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0vTWFrZWZpbGUgYi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9r
dm0vTWFrZWZpbGUKaW5kZXggNGExNjY1ODhkOTlmLi5lYThhNmIwOGU4N2UgMTAwNjQ0Ci0tLSBh
L3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS9NYWtlZmlsZQorKysgYi90b29scy90ZXN0aW5n
L3NlbGZ0ZXN0cy9rdm0vTWFrZWZpbGUKQEAgLTQxLDYgKzQxLDcgQEAgTElCS1ZNX3MzOTB4ID0g
bGliL3MzOTB4L3Byb2Nlc3Nvci5jIGxpYi9zMzkweC91Y2FsbC5jCiBURVNUX0dFTl9QUk9HU194
ODZfNjQgPSB4ODZfNjQvY3I0X2NwdWlkX3N5bmNfdGVzdAogVEVTVF9HRU5fUFJPR1NfeDg2XzY0
ICs9IHg4Nl82NC9ldm1jc190ZXN0CiBURVNUX0dFTl9QUk9HU194ODZfNjQgKz0geDg2XzY0L2h5
cGVydl9jcHVpZAorVEVTVF9HRU5fUFJPR1NfeDg2XzY0ICs9IHg4Nl82NC9rdm1pX3Rlc3QKIFRF
U1RfR0VOX1BST0dTX3g4Nl82NCArPSB4ODZfNjQvbW1pb193YXJuaW5nX3Rlc3QKIFRFU1RfR0VO
X1BST0dTX3g4Nl82NCArPSB4ODZfNjQvcGxhdGZvcm1faW5mb190ZXN0CiBURVNUX0dFTl9QUk9H
U194ODZfNjQgKz0geDg2XzY0L3NldF9zcmVnc190ZXN0CmRpZmYgLS1naXQgYS90b29scy90ZXN0
aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jIGIvdG9vbHMvdGVzdGluZy9zZWxm
dGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAw
MDAwMDAwMDAwMDAuLjA4Y2E0NzAxYzQ0MAotLS0gL2Rldi9udWxsCisrKyBiL3Rvb2xzL3Rlc3Rp
bmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKQEAgLTAsMCArMSw5NCBAQAorLy8g
U1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKKy8qCisgKiBLVk0gaW50cm9zcGVjdGlv
biB0ZXN0cworICoKKyAqIENvcHlyaWdodCAoQykgMjAyMCwgQml0ZGVmZW5kZXIgUy5SLkwuCisg
Ki8KKworI2RlZmluZSBfR05VX1NPVVJDRSAvKiBmb3IgcHJvZ3JhbV9pbnZvY2F0aW9uX3Nob3J0
X25hbWUgKi8KKyNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KKyNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+
CisKKyNpbmNsdWRlICJ0ZXN0X3V0aWwuaCIKKworI2luY2x1ZGUgImt2bV91dGlsLmgiCisjaW5j
bHVkZSAicHJvY2Vzc29yLmgiCisjaW5jbHVkZSAiLi4vbGliL2t2bV91dGlsX2ludGVybmFsLmgi
CisKKyNpbmNsdWRlICJsaW51eC9rdm1pLmgiCisKKyNkZWZpbmUgVkNQVV9JRCAgICAgICAgIDUK
Kworc3RhdGljIGludCBzb2NrZXRfcGFpclsyXTsKKyNkZWZpbmUgS3ZtX3NvY2tldCAgICAgICBz
b2NrZXRfcGFpclswXQorI2RlZmluZSBVc2Vyc3BhY2Vfc29ja2V0IHNvY2tldF9wYWlyWzFdCisK
K3ZvaWQgc2V0dXBfc29ja2V0KHZvaWQpCit7CisJaW50IHI7CisKKwlyID0gc29ja2V0cGFpcihB
Rl9VTklYLCBTT0NLX1NUUkVBTSwgMCwgc29ja2V0X3BhaXIpOworCVRFU1RfQVNTRVJUKHIgPT0g
MCwKKwkJInNvY2tldHBhaXIoKSBmYWlsZWQsIGVycm5vICVkICglcylcbiIsCisJCWVycm5vLCBz
dHJlcnJvcihlcnJubykpOworfQorCitzdGF0aWMgdm9pZCBkb19ob29rX2lvY3RsKHN0cnVjdCBr
dm1fdm0gKnZtLCBfX3MzMiBmZCwgX191MzIgcGFkZGluZywKKwkJCSAgaW50IGV4cGVjdGVkX2Vy
cikKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb25faG9vayBob29rID0geworCQkuZmQgPSBm
ZCwKKwkJLnBhZGRpbmcgPSBwYWRkaW5nCisJfTsKKwlpbnQgcjsKKworCXIgPSBpb2N0bCh2bS0+
ZmQsIEtWTV9JTlRST1NQRUNUSU9OX0hPT0ssICZob29rKTsKKwlURVNUX0FTU0VSVChyID09IDAg
fHwgZXJybm8gPT0gZXhwZWN0ZWRfZXJyLAorCQkiS1ZNX0lOVFJPU1BFQ1RJT05fSE9PSyBmYWls
ZWQsIGVycm5vICVkICglcyksIGV4cGVjdGVkICVkLCBmZCAlZCwgcGFkZGluZyAlZFxuIiwKKwkJ
ZXJybm8sIHN0cmVycm9yKGVycm5vKSwgZXhwZWN0ZWRfZXJyLCBmZCwgcGFkZGluZyk7Cit9CisK
K3N0YXRpYyB2b2lkIGhvb2tfaW50cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkKK3sKKwlf
X3UzMiBwYWRkaW5nID0gMSwgbm9fcGFkZGluZyA9IDA7CisKKwlkb19ob29rX2lvY3RsKHZtLCBL
dm1fc29ja2V0LCBwYWRkaW5nLCBFSU5WQUwpOworCWRvX2hvb2tfaW9jdGwodm0sIC0xLCBub19w
YWRkaW5nLCBFSU5WQUwpOworCWRvX2hvb2tfaW9jdGwodm0sIEt2bV9zb2NrZXQsIG5vX3BhZGRp
bmcsIDApOworCWRvX2hvb2tfaW9jdGwodm0sIEt2bV9zb2NrZXQsIG5vX3BhZGRpbmcsIEVFWElT
VCk7Cit9CisKK3N0YXRpYyB2b2lkIHVuaG9va19pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0g
KnZtKQoreworCWludCByOworCisJciA9IGlvY3RsKHZtLT5mZCwgS1ZNX0lOVFJPU1BFQ1RJT05f
VU5IT09LLCBOVUxMKTsKKwlURVNUX0FTU0VSVChyID09IDAsCisJCSJLVk1fSU5UUk9TUEVDVElP
Tl9VTkhPT0sgZmFpbGVkLCBlcnJubyAlZCAoJXMpXG4iLAorCQllcnJubywgc3RyZXJyb3IoZXJy
bm8pKTsKK30KKworc3RhdGljIHZvaWQgdGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBrdm1fdm0g
KnZtKQoreworCXNldHVwX3NvY2tldCgpOworCWhvb2tfaW50cm9zcGVjdGlvbih2bSk7CisJdW5o
b29rX2ludHJvc3BlY3Rpb24odm0pOworfQorCitpbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJn
dltdKQoreworCXN0cnVjdCBrdm1fdm0gKnZtOworCisJaWYgKCFrdm1fY2hlY2tfY2FwKEtWTV9D
QVBfSU5UUk9TUEVDVElPTikpIHsKKwkJcHJpbnRfc2tpcCgiS1ZNX0NBUF9JTlRST1NQRUNUSU9O
IG5vdCBhdmFpbGFibGUiKTsKKwkJZXhpdChLU0ZUX1NLSVApOworCX0KKworCXZtID0gdm1fY3Jl
YXRlX2RlZmF1bHQoVkNQVV9JRCwgMCwgTlVMTCk7CisJdmNwdV9zZXRfY3B1aWQodm0sIFZDUFVf
SUQsIGt2bV9nZXRfc3VwcG9ydGVkX2NwdWlkKCkpOworCisJdGVzdF9pbnRyb3NwZWN0aW9uKHZt
KTsKKworCWt2bV92bV9mcmVlKHZtKTsKKwlyZXR1cm4gMDsKK30KZGlmZiAtLWdpdCBhL3ZpcnQv
a3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMK
aW5kZXggYWY1M2JkY2I3ZWM4Li41ZDliYzRlZDUwNjAgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2lu
dHJvc3BlY3Rpb24va3ZtaS5jCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCkBA
IC01LDYgKzUsNyBAQAogICogQ29weXJpZ2h0IChDKSAyMDE3LTIwMjAgQml0ZGVmZW5kZXIgUy5S
LkwuCiAgKgogICovCisjaW5jbHVkZSA8bGludXgva3RocmVhZC5oPgogI2luY2x1ZGUgImt2bWlf
aW50LmgiCiAKIGludCBrdm1pX2luaXQodm9pZCkKQEAgLTEyLDE0ICsxMywxNzUgQEAgaW50IGt2
bWlfaW5pdCh2b2lkKQogCXJldHVybiAwOwogfQogCitpbnQga3ZtaV92ZXJzaW9uKHZvaWQpCit7
CisJcmV0dXJuIEtWTUlfVkVSU0lPTjsKK30KKwogdm9pZCBrdm1pX3VuaW5pdCh2b2lkKQogewog
fQogCitzdGF0aWMgdm9pZCBmcmVlX2t2bWkoc3RydWN0IGt2bSAqa3ZtKQoreworCWtmcmVlKGt2
bS0+a3ZtaSk7CisJa3ZtLT5rdm1pID0gTlVMTDsKK30KKworc3RhdGljIHN0cnVjdCBrdm1faW50
cm9zcGVjdGlvbiAqCithbGxvY19rdm1pKHN0cnVjdCBrdm0gKmt2bSwgY29uc3Qgc3RydWN0IGt2
bV9pbnRyb3NwZWN0aW9uX2hvb2sgKmhvb2spCit7CisJc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9u
ICprdm1pOworCisJa3ZtaSA9IGt6YWxsb2Moc2l6ZW9mKCprdm1pKSwgR0ZQX0tFUk5FTCk7CisJ
aWYgKCFrdm1pKQorCQlyZXR1cm4gTlVMTDsKKworCUJVSUxEX0JVR19PTihzaXplb2YoaG9vay0+
dXVpZCkgIT0gc2l6ZW9mKGt2bWktPnV1aWQpKTsKKwltZW1jcHkoJmt2bWktPnV1aWQsICZob29r
LT51dWlkLCBzaXplb2Yoa3ZtaS0+dXVpZCkpOworCisJa3ZtaS0+a3ZtID0ga3ZtOworCisJcmV0
dXJuIGt2bWk7Cit9CisKK3N0YXRpYyB2b2lkIGt2bWlfZGVzdHJveShzdHJ1Y3Qga3ZtX2ludHJv
c3BlY3Rpb24gKmt2bWkpCit7CisJc3RydWN0IGt2bSAqa3ZtID0ga3ZtaS0+a3ZtOworCisJZnJl
ZV9rdm1pKGt2bSk7Cit9CisKK3N0YXRpYyB2b2lkIGt2bWlfc3RvcF9yZWN2X3RocmVhZChzdHJ1
Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkpCit7CisJa3ZtaV9zb2NrX3NodXRkb3duKGt2bWkp
OworfQorCitzdGF0aWMgdm9pZCBfX2t2bWlfdW5ob29rKHN0cnVjdCBrdm0gKmt2bSkKK3sKKwlz
dHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkgPSBLVk1JKGt2bSk7CisKKwl3YWl0X2Zvcl9j
b21wbGV0aW9uX2tpbGxhYmxlKCZrdm0tPmt2bWlfY29tcGxldGUpOworCWt2bWlfc29ja19wdXQo
a3ZtaSk7Cit9CisKK3N0YXRpYyB2b2lkIGt2bWlfdW5ob29rKHN0cnVjdCBrdm0gKmt2bSkKK3sK
KwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWk7CisKKwltdXRleF9sb2NrKCZrdm0tPmt2
bWlfbG9jayk7CisKKwlrdm1pID0gS1ZNSShrdm0pOworCWlmIChrdm1pKSB7CisJCWt2bWlfc3Rv
cF9yZWN2X3RocmVhZChrdm1pKTsKKwkJX19rdm1pX3VuaG9vayhrdm0pOworCQlrdm1pX2Rlc3Ry
b3koa3ZtaSk7CisJfQorCisJbXV0ZXhfdW5sb2NrKCZrdm0tPmt2bWlfbG9jayk7Cit9CisKK2lu
dCBrdm1pX2lvY3RsX3VuaG9vayhzdHJ1Y3Qga3ZtICprdm0pCit7CisJa3ZtaV91bmhvb2soa3Zt
KTsKKwlyZXR1cm4gMDsKK30KKwordm9pZCBrdm1pX3B1dChzdHJ1Y3Qga3ZtICprdm0pCit7CisJ
aWYgKHJlZmNvdW50X2RlY19hbmRfdGVzdCgma3ZtLT5rdm1pX3JlZikpCisJCWNvbXBsZXRlKCZr
dm0tPmt2bWlfY29tcGxldGUpOworfQorCitzdGF0aWMgaW50IF9fa3ZtaV9ob29rKHN0cnVjdCBr
dm0gKmt2bSwKKwkJICAgICAgIGNvbnN0IHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbl9ob29rICpo
b29rKQoreworCXN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSA9IEtWTUkoa3ZtKTsKKwor
CWlmICgha3ZtaV9zb2NrX2dldChrdm1pLCBob29rLT5mZCkpCisJCXJldHVybiAtRUlOVkFMOwor
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQga3ZtaV9yZWN2X3RocmVhZCh2b2lkICphcmcp
Cit7CisJc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pID0gYXJnOworCisJd2hpbGUgKGt2
bWlfbXNnX3Byb2Nlc3Moa3ZtaSkpCisJCTsKKworCS8qCisJICogU2lnbmFsIHVzZXJzcGFjZSAo
d2hpY2ggbWlnaHQgd2FpdCBmb3IgUE9MTEhVUCBvbmx5KQorCSAqIGFuZCBwcmV2ZW50IHRoZSB2
Q1BVcyBmcm9tIHNlbmRpbmcgb3RoZXIgZXZlbnRzLgorCSAqLworCWt2bWlfc29ja19zaHV0ZG93
bihrdm1pKTsKKworCWt2bWlfcHV0KGt2bWktPmt2bSk7CisJcmV0dXJuIDA7Cit9CisKK2ludCBr
dm1pX2hvb2soc3RydWN0IGt2bSAqa3ZtLCBjb25zdCBzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb25f
aG9vayAqaG9vaykKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWk7CisJaW50IGVy
ciA9IDA7CisKKwltdXRleF9sb2NrKCZrdm0tPmt2bWlfbG9jayk7CisKKwlpZiAoa3ZtLT5rdm1p
KSB7CisJCWVyciA9IC1FRVhJU1Q7CisJCWdvdG8gb3V0OworCX0KKworCWt2bWkgPSBhbGxvY19r
dm1pKGt2bSwgaG9vayk7CisJaWYgKCFrdm1pKSB7CisJCWVyciA9IC1FTk9NRU07CisJCWdvdG8g
b3V0OworCX0KKworCWt2bS0+a3ZtaSA9IGt2bWk7CisKKwllcnIgPSBfX2t2bWlfaG9vayhrdm0s
IGhvb2spOworCWlmIChlcnIpCisJCWdvdG8gZGVzdHJveTsKKworCWluaXRfY29tcGxldGlvbigm
a3ZtLT5rdm1pX2NvbXBsZXRlKTsKKworCXJlZmNvdW50X3NldCgma3ZtLT5rdm1pX3JlZiwgMSk7
CisKKwlrdm1pLT5yZWN2ID0ga3RocmVhZF9ydW4oa3ZtaV9yZWN2X3RocmVhZCwga3ZtaSwgImt2
bWktcmVjdiIpOworCWlmIChJU19FUlIoa3ZtaS0+cmVjdikpIHsKKwkJZXJyID0gLUVOT01FTTsK
KwkJa3ZtaV9wdXQoa3ZtKTsKKwkJZ290byB1bmhvb2s7CisJfQorCisJZ290byBvdXQ7CisKK3Vu
aG9vazoKKwlfX2t2bWlfdW5ob29rKGt2bSk7CitkZXN0cm95OgorCWt2bWlfZGVzdHJveShrdm1p
KTsKK291dDoKKwltdXRleF91bmxvY2soJmt2bS0+a3ZtaV9sb2NrKTsKKwlyZXR1cm4gZXJyOwor
fQorCitpbnQga3ZtaV9pb2N0bF9ob29rKHN0cnVjdCBrdm0gKmt2bSwKKwkJICAgIGNvbnN0IHN0
cnVjdCBrdm1faW50cm9zcGVjdGlvbl9ob29rICpob29rKQoreworCWlmIChob29rLT5wYWRkaW5n
KQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXJldHVybiBrdm1pX2hvb2soa3ZtLCBob29rKTsKK30K
Kwogdm9pZCBrdm1pX2NyZWF0ZV92bShzdHJ1Y3Qga3ZtICprdm0pCiB7CisJbXV0ZXhfaW5pdCgm
a3ZtLT5rdm1pX2xvY2spOwogfQogCiB2b2lkIGt2bWlfZGVzdHJveV92bShzdHJ1Y3Qga3ZtICpr
dm0pCiB7CisJa3ZtaV91bmhvb2soa3ZtKTsKIH0KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJv
c3BlY3Rpb24va3ZtaV9pbnQuaCBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaApp
bmRleCAzNGFmOTI2Zjk4MzguLmYwYThkNjUzZDc5YiAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50
cm9zcGVjdGlvbi9rdm1pX2ludC5oCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9p
bnQuaApAQCAtMyw1ICszLDI3IEBACiAjZGVmaW5lIF9fS1ZNSV9JTlRfSF9fCiAKICNpbmNsdWRl
IDxsaW51eC9rdm1faG9zdC5oPgorI2luY2x1ZGUgPGxpbnV4L2t2bWlfaG9zdC5oPgorI2luY2x1
ZGUgPHVhcGkvbGludXgva3ZtaS5oPgorCisjZGVmaW5lIGt2bWlfd2Fybihrdm1pLCBmbXQsIC4u
LikgXAorCWt2bV9pbmZvKCIlcFUgV0FSTklORzogIiBmbXQsICZrdm1pLT51dWlkLCAjIyBfX1ZB
X0FSR1NfXykKKyNkZWZpbmUga3ZtaV93YXJuX29uY2Uoa3ZtaSwgZm10LCAuLi4pICh7ICAgICAg
ICAgICAgICAgICAgICAgXAorCQlzdGF0aWMgYm9vbCBfX3NlY3Rpb24oLmRhdGEub25jZSkgX193
YXJuZWQ7ICAgXAorCQlpZiAoIV9fd2FybmVkKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorCQkJX193YXJuZWQgPSB0cnVlOyAgICAgICAgICAgICAgICAgICAgICBcCisJCQlrdm1p
X3dhcm4oa3ZtaSwgZm10LCAjIyBfX1ZBX0FSR1NfXyk7IFwKKwkJfSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKwl9KQorI2RlZmluZSBrdm1pX2Vycihrdm1p
LCBmbXQsIC4uLikgXAorCWt2bV9pbmZvKCIlcFUgRVJST1I6ICIgZm10LCAma3ZtaS0+dXVpZCwg
IyMgX19WQV9BUkdTX18pCisKKyNkZWZpbmUgS1ZNSShrdm0pICgoa3ZtKS0+a3ZtaSkKKworLyog
a3ZtaV9tc2cuYyAqLworYm9vbCBrdm1pX3NvY2tfZ2V0KHN0cnVjdCBrdm1faW50cm9zcGVjdGlv
biAqa3ZtaSwgaW50IGZkKTsKK3ZvaWQga3ZtaV9zb2NrX3NodXRkb3duKHN0cnVjdCBrdm1faW50
cm9zcGVjdGlvbiAqa3ZtaSk7Cit2b2lkIGt2bWlfc29ja19wdXQoc3RydWN0IGt2bV9pbnRyb3Nw
ZWN0aW9uICprdm1pKTsKK2Jvb2wga3ZtaV9tc2dfcHJvY2VzcyhzdHJ1Y3Qga3ZtX2ludHJvc3Bl
Y3Rpb24gKmt2bWkpOwogCiAjZW5kaWYKZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rp
b24va3ZtaV9tc2cuYyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYwpuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjNhZTUyYzYxZjg2MQotLS0gL2Rldi9u
dWxsCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYwpAQCAtMCwwICsxLDM5
IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyoKKyAqIEtWTSBpbnRy
b3NwZWN0aW9uIChtZXNzYWdlIGhhbmRsaW5nKQorICoKKyAqIENvcHlyaWdodCAoQykgMjAxNy0y
MDIwIEJpdGRlZmVuZGVyIFMuUi5MLgorICoKKyAqLworI2luY2x1ZGUgPGxpbnV4L25ldC5oPgor
I2luY2x1ZGUgImt2bWlfaW50LmgiCisKK2Jvb2wga3ZtaV9zb2NrX2dldChzdHJ1Y3Qga3ZtX2lu
dHJvc3BlY3Rpb24gKmt2bWksIGludCBmZCkKK3sKKwlzdHJ1Y3Qgc29ja2V0ICpzb2NrOworCWlu
dCBlcnI7CisKKwlzb2NrID0gc29ja2ZkX2xvb2t1cChmZCwgJmVycik7CisJaWYgKCFzb2NrKQor
CQlyZXR1cm4gZmFsc2U7CisKKwlrdm1pLT5zb2NrID0gc29jazsKKworCXJldHVybiB0cnVlOwor
fQorCit2b2lkIGt2bWlfc29ja19wdXQoc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pKQor
eworCWlmIChrdm1pLT5zb2NrKQorCQlzb2NrZmRfcHV0KGt2bWktPnNvY2spOworfQorCit2b2lk
IGt2bWlfc29ja19zaHV0ZG93bihzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWkpCit7CisJ
a2VybmVsX3NvY2tfc2h1dGRvd24oa3ZtaS0+c29jaywgU0hVVF9SRFdSKTsKK30KKworYm9vbCBr
dm1pX21zZ19wcm9jZXNzKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSkKK3sKKwlyZXR1
cm4gZmFsc2U7Cit9CmRpZmYgLS1naXQgYS92aXJ0L2t2bS9rdm1fbWFpbi5jIGIvdmlydC9rdm0v
a3ZtX21haW4uYwppbmRleCBhMmI0MjRmZDJlZmQuLjBkMmRhNzdjY2IxMiAxMDA2NDQKLS0tIGEv
dmlydC9rdm0va3ZtX21haW4uYworKysgYi92aXJ0L2t2bS9rdm1fbWFpbi5jCkBAIC0zODI5LDYg
KzM4MjksMjUgQEAgc3RhdGljIGxvbmcga3ZtX3ZtX2lvY3RsKHN0cnVjdCBmaWxlICpmaWxwLAog
CWNhc2UgS1ZNX0NIRUNLX0VYVEVOU0lPTjoKIAkJciA9IGt2bV92bV9pb2N0bF9jaGVja19leHRl
bnNpb25fZ2VuZXJpYyhrdm0sIGFyZyk7CiAJCWJyZWFrOworI2lmZGVmIENPTkZJR19LVk1fSU5U
Uk9TUEVDVElPTgorCWNhc2UgS1ZNX0lOVFJPU1BFQ1RJT05fSE9PSzoKKwkJciA9IC1FUEVSTTsK
KwkJaWYgKGVuYWJsZV9pbnRyb3NwZWN0aW9uKSB7CisJCQlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rp
b25faG9vayBob29rOworCisJCQlpZiAoY29weV9mcm9tX3VzZXIoJmhvb2ssIGFyZ3AsIHNpemVv
Zihob29rKSkpCisJCQkJciA9IC1FRkFVTFQ7CisJCQllbHNlCisJCQkJciA9IGt2bWlfaW9jdGxf
aG9vayhrdm0sICZob29rKTsKKwkJfQorCQlicmVhazsKKwljYXNlIEtWTV9JTlRST1NQRUNUSU9O
X1VOSE9PSzoKKwkJaWYgKGVuYWJsZV9pbnRyb3NwZWN0aW9uKQorCQkJciA9IGt2bWlfaW9jdGxf
dW5ob29rKGt2bSk7CisJCWVsc2UKKwkJCXIgPSAtRVBFUk07CisJCWJyZWFrOworI2VuZGlmIC8q
IENPTkZJR19LVk1fSU5UUk9TUEVDVElPTiAqLwogCWRlZmF1bHQ6CiAJCXIgPSBrdm1fYXJjaF92
bV9pb2N0bChmaWxwLCBpb2N0bCwgYXJnKTsKIAl9Cl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFs
aXphdGlvbkBsaXN0cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91
bmRhdGlvbi5vcmcvbWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
