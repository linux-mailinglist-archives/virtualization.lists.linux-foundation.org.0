Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from mail.linuxfoundation.org (mail.linuxfoundation.org [140.211.169.12])
	by mail.lfdr.de (Postfix) with ESMTPS id CB20F8820B
	for <lists.virtualization@lfdr.de>; Fri,  9 Aug 2019 20:10:45 +0200 (CEST)
Received: from mail.linux-foundation.org (localhost [127.0.0.1])
	by mail.linuxfoundation.org (Postfix) with ESMTP id 96C5BE1E;
	Fri,  9 Aug 2019 18:09:59 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@mail.linuxfoundation.org
Received: from smtp1.linuxfoundation.org (smtp1.linux-foundation.org
	[172.17.192.35])
	by mail.linuxfoundation.org (Postfix) with ESMTPS id 7B01AD7C
	for <virtualization@lists.linux-foundation.org>;
	Fri,  9 Aug 2019 18:09:56 +0000 (UTC)
X-Greylist: from auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
	(mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
	by smtp1.linuxfoundation.org (Postfix) with ESMTPS id DAD4B8A9
	for <virtualization@lists.linux-foundation.org>;
	Fri,  9 Aug 2019 18:09:54 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
	by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
	72460305D343; Fri,  9 Aug 2019 19:01:05 +0300 (EEST)
Received: from localhost.localdomain (unknown [89.136.169.210])
	by smtp.bitdefender.com (Postfix) with ESMTPSA id 2B57A305B7A0;
	Fri,  9 Aug 2019 19:01:05 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [RFC PATCH v6 35/92] KVM: VMX: Add control flags for SPP enabling
Date: Fri,  9 Aug 2019 18:59:50 +0300
Message-Id: <20190809160047.8319-36-alazar@bitdefender.com>
In-Reply-To: <20190809160047.8319-1-alazar@bitdefender.com>
References: <20190809160047.8319-1-alazar@bitdefender.com>
MIME-Version: 1.0
X-Spam-Status: No, score=-4.2 required=5.0 tests=BAYES_00,RCVD_IN_DNSWL_MED
	autolearn=unavailable version=3.3.1
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on
	smtp1.linux-foundation.org
Cc: Tamas K Lengyel <tamas@tklengyel.com>,
	Weijiang Yang <weijiang.yang@intel.com>,
	Zhang Yi <yi.z.zhang@linux.intel.com>, Yu C <yu.c.zhang@intel.com>,
	=?UTF-8?q?Radim=20Kr=C4=8Dm=C3=A1=C5=99?= <rkrcmar@redhat.com>,
	He Chen <he.chen@linux.intel.com>,
	Jan Kiszka <jan.kiszka@siemens.com>,
	=?UTF-8?q?Samuel=20Laur=C3=A9n?= <samuel.lauren@iki.fi>,
	Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
	virtualization@lists.linux-foundation.org,
	=?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
	linux-mm@kvack.org, Patrick Colp <patrick.colp@oracle.com>,
	Mathieu Tarral <mathieu.tarral@protonmail.com>,
	Stefan Hajnoczi <stefanha@redhat.com>,
	Paolo Bonzini <pbonzini@redhat.com>, Zhang@mail.linuxfoundation.org,
	=?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.12
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>,
	<mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>,
	<mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: virtualization-bounces@lists.linux-foundation.org
Errors-To: virtualization-bounces@lists.linux-foundation.org

RnJvbTogWWFuZyBXZWlqaWFuZyA8d2VpamlhbmcueWFuZ0BpbnRlbC5jb20+CgpDaGVjayBTUFAg
Y2FwYWJpbGl0eSBpbiBNU1JfSUEzMl9WTVhfUFJPQ0JBU0VEX0NUTFMyLCBpdHMgMjMtYml0Cmlu
ZGljYXRlcyBTUFAgc3VwcG9ydC4gTWFyayBTUFAgYml0IGluIENQVSBjYXBhYmlsaXRpZXMgYml0
bWFwIGlmCml0J3Mgc3VwcG9ydGVkLgoKQ28tZGV2ZWxvcGVkLWJ5OiBIZSBDaGVuIDxoZS5jaGVu
QGxpbnV4LmludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogSGUgQ2hlbiA8aGUuY2hlbkBsaW51eC5p
bnRlbC5jb20+CkNvLWRldmVsb3BlZC1ieTogWmhhbmcgWWkgPHlpLnouemhhbmdAbGludXguaW50
ZWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBaaGFuZyBZaSA8eWkuei56aGFuZ0BsaW51eC5pbnRlbC5j
b20+CkNvLWRldmVsb3BlZC1ieTogWWFuZyBXZWlqaWFuZyA8d2VpamlhbmcueWFuZ0BpbnRlbC5j
b20+ClNpZ25lZC1vZmYtYnk6IFlhbmcgV2VpamlhbmcgPHdlaWppYW5nLnlhbmdAaW50ZWwuY29t
PgpNZXNzYWdlLUlkOiA8MjAxOTA3MTcxMzM3NTEuMTI5MTAtMy13ZWlqaWFuZy55YW5nQGludGVs
LmNvbT4KU2lnbmVkLW9mZi1ieTogQWRhbGJlcnQgTGF6xINyIDxhbGF6YXJAYml0ZGVmZW5kZXIu
Y29tPgotLS0KIGFyY2gveDg2L2luY2x1ZGUvYXNtL2NwdWZlYXR1cmVzLmggfCAgMSArCiBhcmNo
L3g4Ni9pbmNsdWRlL2FzbS92bXguaCAgICAgICAgIHwgIDEgKwogYXJjaC94ODYva2VybmVsL2Nw
dS9pbnRlbC5jICAgICAgICB8ICA0ICsrKysKIGFyY2gveDg2L2t2bS92bXgvY2FwYWJpbGl0aWVz
LmggICAgfCAgNSArKysrKwogYXJjaC94ODYva3ZtL3ZteC92bXguYyAgICAgICAgICAgICB8IDEw
ICsrKysrKysrKysKIDUgZmlsZXMgY2hhbmdlZCwgMjEgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdp
dCBhL2FyY2gveDg2L2luY2x1ZGUvYXNtL2NwdWZlYXR1cmVzLmggYi9hcmNoL3g4Ni9pbmNsdWRl
L2FzbS9jcHVmZWF0dXJlcy5oCmluZGV4IDZkNjEyMjUyNDcxMS4uMTgzYjRmZDg2NGM2IDEwMDY0
NAotLS0gYS9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9jcHVmZWF0dXJlcy5oCisrKyBiL2FyY2gveDg2
L2luY2x1ZGUvYXNtL2NwdWZlYXR1cmVzLmgKQEAgLTIyOCw2ICsyMjgsNyBAQAogI2RlZmluZSBY
ODZfRkVBVFVSRV9GTEVYUFJJT1JJVFkJKCA4KjMyKyAyKSAvKiBJbnRlbCBGbGV4UHJpb3JpdHkg
Ki8KICNkZWZpbmUgWDg2X0ZFQVRVUkVfRVBUCQkJKCA4KjMyKyAzKSAvKiBJbnRlbCBFeHRlbmRl
ZCBQYWdlIFRhYmxlICovCiAjZGVmaW5lIFg4Nl9GRUFUVVJFX1ZQSUQJCSggOCozMisgNCkgLyog
SW50ZWwgVmlydHVhbCBQcm9jZXNzb3IgSUQgKi8KKyNkZWZpbmUgWDg2X0ZFQVRVUkVfU1BQCQkJ
KCA4KjMyKyA1KSAvKiBJbnRlbCBFUFQtYmFzZWQgU3ViLVBhZ2UgV3JpdGUgUHJvdGVjdGlvbiAq
LwogCiAjZGVmaW5lIFg4Nl9GRUFUVVJFX1ZNTUNBTEwJCSggOCozMisxNSkgLyogUHJlZmVyIFZN
TUNBTEwgdG8gVk1DQUxMICovCiAjZGVmaW5lIFg4Nl9GRUFUVVJFX1hFTlBWCQkoIDgqMzIrMTYp
IC8qICIiIFhlbiBwYXJhdmlydHVhbCBndWVzdCAqLwpkaWZmIC0tZ2l0IGEvYXJjaC94ODYvaW5j
bHVkZS9hc20vdm14LmggYi9hcmNoL3g4Ni9pbmNsdWRlL2FzbS92bXguaAppbmRleCA0ZTQxMzNl
ODY0ODQuLmEyYzllMThlMGFkNyAxMDA2NDQKLS0tIGEvYXJjaC94ODYvaW5jbHVkZS9hc20vdm14
LmgKKysrIGIvYXJjaC94ODYvaW5jbHVkZS9hc20vdm14LmgKQEAgLTgxLDYgKzgxLDcgQEAKICNk
ZWZpbmUgU0VDT05EQVJZX0VYRUNfWFNBVkVTCQkJMHgwMDEwMDAwMAogI2RlZmluZSBTRUNPTkRB
UllfRVhFQ19QVF9VU0VfR1BBCQkweDAxMDAwMDAwCiAjZGVmaW5lIFNFQ09OREFSWV9FWEVDX01P
REVfQkFTRURfRVBUX0VYRUMJMHgwMDQwMDAwMAorI2RlZmluZSBTRUNPTkRBUllfRVhFQ19FTkFC
TEVfU1BQCQkweDAwODAwMDAwCiAjZGVmaW5lIFNFQ09OREFSWV9FWEVDX1RTQ19TQ0FMSU5HICAg
ICAgICAgICAgICAweDAyMDAwMDAwCiAKICNkZWZpbmUgUElOX0JBU0VEX0VYVF9JTlRSX01BU0sg
ICAgICAgICAgICAgICAgIDB4MDAwMDAwMDEKZGlmZiAtLWdpdCBhL2FyY2gveDg2L2tlcm5lbC9j
cHUvaW50ZWwuYyBiL2FyY2gveDg2L2tlcm5lbC9jcHUvaW50ZWwuYwppbmRleCBmYzNjMDdmZTdk
ZjUuLmI1NTE1NmNlMTZkYSAxMDA2NDQKLS0tIGEvYXJjaC94ODYva2VybmVsL2NwdS9pbnRlbC5j
CisrKyBiL2FyY2gveDg2L2tlcm5lbC9jcHUvaW50ZWwuYwpAQCAtNDc2LDYgKzQ3Niw3IEBAIHN0
YXRpYyB2b2lkIGRldGVjdF92bXhfdmlydGNhcChzdHJ1Y3QgY3B1aW5mb194ODYgKmMpCiAjZGVm
aW5lIFg4Nl9WTVhfRkVBVFVSRV9QUk9DX0NUTFMyX0VQVAkJMHgwMDAwMDAwMgogI2RlZmluZSBY
ODZfVk1YX0ZFQVRVUkVfUFJPQ19DVExTMl9WUElECQkweDAwMDAwMDIwCiAjZGVmaW5lIHg4Nl9W
TVhfRkVBVFVSRV9FUFRfQ0FQX0FECQkweDAwMjAwMDAwCisjZGVmaW5lIFg4Nl9WTVhfRkVBVFVS
RV9QUk9DX0NUTFMyX1NQUAkJMHgwMDgwMDAwMAogCiAJdTMyIHZteF9tc3JfbG93LCB2bXhfbXNy
X2hpZ2gsIG1zcl9jdGwsIG1zcl9jdGwyOwogCXUzMiBtc3JfdnBpZF9jYXAsIG1zcl9lcHRfY2Fw
OwpAQCAtNDg2LDYgKzQ4Nyw3IEBAIHN0YXRpYyB2b2lkIGRldGVjdF92bXhfdmlydGNhcChzdHJ1
Y3QgY3B1aW5mb194ODYgKmMpCiAJY2xlYXJfY3B1X2NhcChjLCBYODZfRkVBVFVSRV9FUFQpOwog
CWNsZWFyX2NwdV9jYXAoYywgWDg2X0ZFQVRVUkVfVlBJRCk7CiAJY2xlYXJfY3B1X2NhcChjLCBY
ODZfRkVBVFVSRV9FUFRfQUQpOworCWNsZWFyX2NwdV9jYXAoYywgWDg2X0ZFQVRVUkVfU1BQKTsK
IAogCXJkbXNyKE1TUl9JQTMyX1ZNWF9QUk9DQkFTRURfQ1RMUywgdm14X21zcl9sb3csIHZteF9t
c3JfaGlnaCk7CiAJbXNyX2N0bCA9IHZteF9tc3JfaGlnaCB8IHZteF9tc3JfbG93OwpAQCAtNTA5
LDYgKzUxMSw4IEBAIHN0YXRpYyB2b2lkIGRldGVjdF92bXhfdmlydGNhcChzdHJ1Y3QgY3B1aW5m
b194ODYgKmMpCiAJCX0KIAkJaWYgKG1zcl9jdGwyICYgWDg2X1ZNWF9GRUFUVVJFX1BST0NfQ1RM
UzJfVlBJRCkKIAkJCXNldF9jcHVfY2FwKGMsIFg4Nl9GRUFUVVJFX1ZQSUQpOworCQlpZiAobXNy
X2N0bDIgJiBYODZfVk1YX0ZFQVRVUkVfUFJPQ19DVExTMl9TUFApCisJCQlzZXRfY3B1X2NhcChj
LCBYODZfRkVBVFVSRV9TUFApOwogCX0KIH0KIApkaWZmIC0tZ2l0IGEvYXJjaC94ODYva3ZtL3Zt
eC9jYXBhYmlsaXRpZXMuaCBiL2FyY2gveDg2L2t2bS92bXgvY2FwYWJpbGl0aWVzLmgKaW5kZXgg
ODU0ZTE0NDEzMWM2Li44MjIxZWNiZjY1MTYgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS92bXgv
Y2FwYWJpbGl0aWVzLmgKKysrIGIvYXJjaC94ODYva3ZtL3ZteC9jYXBhYmlsaXRpZXMuaApAQCAt
MjM5LDYgKzIzOSwxMSBAQCBzdGF0aWMgaW5saW5lIGJvb2wgY3B1X2hhc192bXhfcG1sKHZvaWQp
CiAJcmV0dXJuIHZtY3NfY29uZmlnLmNwdV9iYXNlZF8ybmRfZXhlY19jdHJsICYgU0VDT05EQVJZ
X0VYRUNfRU5BQkxFX1BNTDsKIH0KIAorc3RhdGljIGlubGluZSBib29sIGNwdV9oYXNfdm14X2Vw
dF9zcHAodm9pZCkKK3sKKwlyZXR1cm4gdm1jc19jb25maWcuY3B1X2Jhc2VkXzJuZF9leGVjX2N0
cmwgJiBTRUNPTkRBUllfRVhFQ19FTkFCTEVfU1BQOworfQorCiBzdGF0aWMgaW5saW5lIGJvb2wg
dm14X3hzYXZlc19zdXBwb3J0ZWQodm9pZCkKIHsKIAlyZXR1cm4gdm1jc19jb25maWcuY3B1X2Jh
c2VkXzJuZF9leGVjX2N0cmwgJgpkaWZmIC0tZ2l0IGEvYXJjaC94ODYva3ZtL3ZteC92bXguYyBi
L2FyY2gveDg2L2t2bS92bXgvdm14LmMKaW5kZXggOTdjZmQ1YTMxNmYzLi5mOTRlM2RlZmQ5Y2Yg
MTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS92bXgvdm14LmMKKysrIGIvYXJjaC94ODYva3ZtL3Zt
eC92bXguYwpAQCAtMTE0LDYgKzExNCw4IEBAIHN0YXRpYyB1NjQgX19yZWFkX21vc3RseSBob3N0
X3hzczsKIGJvb2wgX19yZWFkX21vc3RseSBlbmFibGVfcG1sID0gMTsKIG1vZHVsZV9wYXJhbV9u
YW1lZChwbWwsIGVuYWJsZV9wbWwsIGJvb2wsIFNfSVJVR08pOwogCitzdGF0aWMgYm9vbCBfX3Jl
YWRfbW9zdGx5IHNwcF9zdXBwb3J0ZWQgPSAwOworCiAjZGVmaW5lIE1TUl9CSVRNQVBfTU9ERV9Y
MkFQSUMJCTEKICNkZWZpbmUgTVNSX0JJVE1BUF9NT0RFX1gyQVBJQ19BUElDVgkyCiAKQEAgLTIy
NDcsNiArMjI0OSw3IEBAIHN0YXRpYyBfX2luaXQgaW50IHNldHVwX3ZtY3NfY29uZmlnKHN0cnVj
dCB2bWNzX2NvbmZpZyAqdm1jc19jb25mLAogCQkJU0VDT05EQVJZX0VYRUNfUkRTRUVEX0VYSVRJ
TkcgfAogCQkJU0VDT05EQVJZX0VYRUNfUkRSQU5EX0VYSVRJTkcgfAogCQkJU0VDT05EQVJZX0VY
RUNfRU5BQkxFX1BNTCB8CisJCQlTRUNPTkRBUllfRVhFQ19FTkFCTEVfU1BQIHwKIAkJCVNFQ09O
REFSWV9FWEVDX1RTQ19TQ0FMSU5HIHwKIAkJCVNFQ09OREFSWV9FWEVDX1BUX1VTRV9HUEEgfAog
CQkJU0VDT05EQVJZX0VYRUNfUFRfQ09OQ0VBTF9WTVggfApAQCAtMzkwMSw2ICszOTA0LDkgQEAg
c3RhdGljIHZvaWQgdm14X2NvbXB1dGVfc2Vjb25kYXJ5X2V4ZWNfY29udHJvbChzdHJ1Y3QgdmNw
dV92bXggKnZteCkKIAlpZiAoIWVuYWJsZV9wbWwpCiAJCWV4ZWNfY29udHJvbCAmPSB+U0VDT05E
QVJZX0VYRUNfRU5BQkxFX1BNTDsKIAorCWlmICghc3BwX3N1cHBvcnRlZCkKKwkJZXhlY19jb250
cm9sICY9IH5TRUNPTkRBUllfRVhFQ19FTkFCTEVfU1BQOworCiAJaWYgKHZteF94c2F2ZXNfc3Vw
cG9ydGVkKCkpIHsKIAkJLyogRXhwb3NpbmcgWFNBVkVTIG9ubHkgd2hlbiBYU0FWRSBpcyBleHBv
c2VkICovCiAJCWJvb2wgeHNhdmVzX2VuYWJsZWQgPQpAQCAtNzU3MCw2ICs3NTc2LDEwIEBAIHN0
YXRpYyBfX2luaXQgaW50IGhhcmR3YXJlX3NldHVwKHZvaWQpCiAJaWYgKCFjcHVfaGFzX3ZteF9m
bGV4cHJpb3JpdHkoKSkKIAkJZmxleHByaW9yaXR5X2VuYWJsZWQgPSAwOwogCisJaWYgKGNwdV9o
YXNfdm14X2VwdF9zcHAoKSAmJiBlbmFibGVfZXB0ICYmCisJICAgIGJvb3RfY3B1X2hhcyhYODZf
RkVBVFVSRV9TUFApKQorCQlzcHBfc3VwcG9ydGVkID0gMTsKKwogCWlmICghY3B1X2hhc192aXJ0
dWFsX25taXMoKSkKIAkJZW5hYmxlX3ZubWkgPSAwOwogCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0
dWFsaXphdGlvbkBsaXN0cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4
Zm91bmRhdGlvbi5vcmcvbWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
