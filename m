Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 866C12D1AD3
	for <lists.virtualization@lfdr.de>; Mon,  7 Dec 2020 21:46:38 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 24F9A87148;
	Mon,  7 Dec 2020 20:46:37 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id NWXcjGqlwdp6; Mon,  7 Dec 2020 20:46:35 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 140E687115;
	Mon,  7 Dec 2020 20:46:35 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id D23BEC163C;
	Mon,  7 Dec 2020 20:46:34 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 2E0E8C013B
 for <virtualization@lists.linux-foundation.org>;
 Mon,  7 Dec 2020 20:46:31 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by whitealder.osuosl.org (Postfix) with ESMTP id 1C8C6879A4
 for <virtualization@lists.linux-foundation.org>;
 Mon,  7 Dec 2020 20:46:31 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id tuqvBh2A6bW0
 for <virtualization@lists.linux-foundation.org>;
 Mon,  7 Dec 2020 20:46:24 +0000 (UTC)
X-Greylist: from auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by whitealder.osuosl.org (Postfix) with ESMTPS id 2273E879DB
 for <virtualization@lists.linux-foundation.org>;
 Mon,  7 Dec 2020 20:46:18 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 4AE65305D513; Mon,  7 Dec 2020 22:46:16 +0200 (EET)
Received: from localhost.localdomain (unknown [91.199.104.27])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 231563072785;
 Mon,  7 Dec 2020 22:46:16 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v11 27/81] KVM: x86: page track: provide all callbacks with
 the guest virtual address
Date: Mon,  7 Dec 2020 22:45:28 +0200
Message-Id: <20201207204622.15258-28-alazar@bitdefender.com>
In-Reply-To: <20201207204622.15258-1-alazar@bitdefender.com>
References: <20201207204622.15258-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBpcyBuZWVk
ZWQgYmVjYXVzZSB0aGUgZW11bGF0b3IgY2FsbHMgdGhlIHBhZ2UgdHJhY2tpbmcgY29kZQppcnJl
c3BlY3RpdmUgb2YgdGhlIGN1cnJlbnQgVk0tZXhpdCByZWFzb24gb3IgYXZhaWxhYmxlIGluZm9y
bWF0aW9uLgoKU2lnbmVkLW9mZi1ieTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIu
Y29tPgpTaWduZWQtb2ZmLWJ5OiBBZGFsYmVydCBMYXrEg3IgPGFsYXphckBiaXRkZWZlbmRlci5j
b20+Ci0tLQogYXJjaC94ODYvaW5jbHVkZS9hc20va3ZtX2hvc3QuaCAgICAgICB8ICAyICstCiBh
cmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1fcGFnZV90cmFjay5oIHwgMTAgKysrKysrLS0tLQogYXJj
aC94ODYva3ZtL21tdS9tbXUuYyAgICAgICAgICAgICAgICB8ICAyICstCiBhcmNoL3g4Ni9rdm0v
bW11L3BhZ2VfdHJhY2suYyAgICAgICAgIHwgIDYgKysrLS0tCiBhcmNoL3g4Ni9rdm0veDg2LmMg
ICAgICAgICAgICAgICAgICAgIHwgMTYgKysrKysrKystLS0tLS0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Z0L2t2bWd0LmMgICAgICB8ICAyICstCiA2IGZpbGVzIGNoYW5nZWQsIDIwIGluc2Vy
dGlvbnMoKyksIDE4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2FyY2gveDg2L2luY2x1ZGUv
YXNtL2t2bV9ob3N0LmggYi9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1faG9zdC5oCmluZGV4IDY1
YmNlOGFlZWRlNS4uMmZmYzExYzVjNmMwIDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9pbmNsdWRlL2Fz
bS9rdm1faG9zdC5oCisrKyBiL2FyY2gveDg2L2luY2x1ZGUvYXNtL2t2bV9ob3N0LmgKQEAgLTEz
OTYsNyArMTM5Niw3IEBAIHZvaWQga3ZtX21tdV9jaGFuZ2VfbW11X3BhZ2VzKHN0cnVjdCBrdm0g
Kmt2bSwgdW5zaWduZWQgbG9uZyBrdm1fbnJfbW11X3BhZ2VzKTsKIGludCBsb2FkX3BkcHRycyhz
dHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHN0cnVjdCBrdm1fbW11ICptbXUsIHVuc2lnbmVkIGxvbmcg
Y3IzKTsKIGJvb2wgcGRwdHJzX2NoYW5nZWQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIAotaW50
IGVtdWxhdG9yX3dyaXRlX3BoeXMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsCitp
bnQgZW11bGF0b3Jfd3JpdGVfcGh5cyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIGdwYV90IGdwYSwg
Z3ZhX3QgZ3ZhLAogCQkJICBjb25zdCB2b2lkICp2YWwsIGludCBieXRlcyk7CiAKIHN0cnVjdCBr
dm1faXJxX21hc2tfbm90aWZpZXIgewpkaWZmIC0tZ2l0IGEvYXJjaC94ODYvaW5jbHVkZS9hc20v
a3ZtX3BhZ2VfdHJhY2suaCBiL2FyY2gveDg2L2luY2x1ZGUvYXNtL2t2bV9wYWdlX3RyYWNrLmgK
aW5kZXggODdiZDYwMjVkOTFkLi45YTI2MWU0NjNlYjMgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2lu
Y2x1ZGUvYXNtL2t2bV9wYWdlX3RyYWNrLmgKKysrIGIvYXJjaC94ODYvaW5jbHVkZS9hc20va3Zt
X3BhZ2VfdHJhY2suaApAQCAtMjgsMTIgKzI4LDE0IEBAIHN0cnVjdCBrdm1fcGFnZV90cmFja19u
b3RpZmllcl9ub2RlIHsKIAkgKgogCSAqIEB2Y3B1OiB0aGUgdmNwdSB3aGVyZSB0aGUgd3JpdGUg
YWNjZXNzIGhhcHBlbmVkLgogCSAqIEBncGE6IHRoZSBwaHlzaWNhbCBhZGRyZXNzIHdyaXR0ZW4g
YnkgZ3Vlc3QuCisJICogQGd2YTogdGhlIHZpcnR1YWwgYWRkcmVzcyB3cml0dGVuIGJ5IGd1ZXN0
LgogCSAqIEBuZXc6IHRoZSBkYXRhIHdhcyB3cml0dGVuIHRvIHRoZSBhZGRyZXNzLgogCSAqIEBi
eXRlczogdGhlIHdyaXR0ZW4gbGVuZ3RoLgogCSAqIEBub2RlOiB0aGlzIG5vZGUKIAkgKi8KLQl2
b2lkICgqdHJhY2tfd3JpdGUpKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgZ3BhX3QgZ3BhLCBjb25z
dCB1OCAqbmV3LAotCQkJICAgIGludCBieXRlcywgc3RydWN0IGt2bV9wYWdlX3RyYWNrX25vdGlm
aWVyX25vZGUgKm5vZGUpOworCXZvaWQgKCp0cmFja193cml0ZSkoc3RydWN0IGt2bV92Y3B1ICp2
Y3B1LCBncGFfdCBncGEsIGd2YV90IGd2YSwKKwkJCSAgICBjb25zdCB1OCAqbmV3LCBpbnQgYnl0
ZXMsCisJCQkgICAgc3RydWN0IGt2bV9wYWdlX3RyYWNrX25vdGlmaWVyX25vZGUgKm5vZGUpOwog
CS8qCiAJICogSXQgaXMgY2FsbGVkIHdoZW4gbWVtb3J5IHNsb3QgaXMgYmVpbmcgbW92ZWQgb3Ig
cmVtb3ZlZAogCSAqIHVzZXJzIGNhbiBkcm9wIHdyaXRlLXByb3RlY3Rpb24gZm9yIHRoZSBwYWdl
cyBpbiB0aGF0IG1lbW9yeSBzbG90CkBAIC02OCw3ICs3MCw3IEBAIGt2bV9wYWdlX3RyYWNrX3Jl
Z2lzdGVyX25vdGlmaWVyKHN0cnVjdCBrdm0gKmt2bSwKIHZvaWQKIGt2bV9wYWdlX3RyYWNrX3Vu
cmVnaXN0ZXJfbm90aWZpZXIoc3RydWN0IGt2bSAqa3ZtLAogCQkJCSAgIHN0cnVjdCBrdm1fcGFn
ZV90cmFja19ub3RpZmllcl9ub2RlICpuKTsKLXZvaWQga3ZtX3BhZ2VfdHJhY2tfd3JpdGUoc3Ry
dWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsIGNvbnN0IHU4ICpuZXcsCi0JCQkgIGludCBi
eXRlcyk7Cit2b2lkIGt2bV9wYWdlX3RyYWNrX3dyaXRlKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwg
Z3BhX3QgZ3BhLCBndmFfdCBndmEsCisJCQkgIGNvbnN0IHU4ICpuZXcsIGludCBieXRlcyk7CiB2
b2lkIGt2bV9wYWdlX3RyYWNrX2ZsdXNoX3Nsb3Qoc3RydWN0IGt2bSAqa3ZtLCBzdHJ1Y3Qga3Zt
X21lbW9yeV9zbG90ICpzbG90KTsKICNlbmRpZgpkaWZmIC0tZ2l0IGEvYXJjaC94ODYva3ZtL21t
dS9tbXUuYyBiL2FyY2gveDg2L2t2bS9tbXUvbW11LmMKaW5kZXggNWRmZTBlZGUwZTgxLi4xNjMx
ZTIzNjcwODUgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS9tbXUvbW11LmMKKysrIGIvYXJjaC94
ODYva3ZtL21tdS9tbXUuYwpAQCAtNDk2Myw3ICs0OTYzLDcgQEAgc3RhdGljIGNvbnN0IHVuaW9u
IGt2bV9tbXVfcGFnZV9yb2xlIHJvbGVfaWduID0gewogCS5pbnZhbGlkID0gMHgxLAogfTsKIAot
c3RhdGljIHZvaWQga3ZtX21tdV9wdGVfd3JpdGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFf
dCBncGEsCitzdGF0aWMgdm9pZCBrdm1fbW11X3B0ZV93cml0ZShzdHJ1Y3Qga3ZtX3ZjcHUgKnZj
cHUsIGdwYV90IGdwYSwgZ3ZhX3QgZ3ZhLAogCQkJICAgICAgY29uc3QgdTggKm5ldywgaW50IGJ5
dGVzLAogCQkJICAgICAgc3RydWN0IGt2bV9wYWdlX3RyYWNrX25vdGlmaWVyX25vZGUgKm5vZGUp
CiB7CmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9rdm0vbW11L3BhZ2VfdHJhY2suYyBiL2FyY2gveDg2
L2t2bS9tbXUvcGFnZV90cmFjay5jCmluZGV4IDg0NDNhNjc1NzE1Yi4uZDdhNTkxYTg1YWY4IDEw
MDY0NAotLS0gYS9hcmNoL3g4Ni9rdm0vbW11L3BhZ2VfdHJhY2suYworKysgYi9hcmNoL3g4Ni9r
dm0vbW11L3BhZ2VfdHJhY2suYwpAQCAtMjE2LDggKzIxNiw4IEBAIEVYUE9SVF9TWU1CT0xfR1BM
KGt2bV9wYWdlX3RyYWNrX3VucmVnaXN0ZXJfbm90aWZpZXIpOwogICogVGhlIG5vZGUgc2hvdWxk
IGZpZ3VyZSBvdXQgaWYgdGhlIHdyaXR0ZW4gcGFnZSBpcyB0aGUgb25lIHRoYXQgbm9kZSBpcwog
ICogaW50ZXJlc3RlZCBpbiBieSBpdHNlbGYuCiAgKi8KLXZvaWQga3ZtX3BhZ2VfdHJhY2tfd3Jp
dGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsIGNvbnN0IHU4ICpuZXcsCi0JCQkg
IGludCBieXRlcykKK3ZvaWQga3ZtX3BhZ2VfdHJhY2tfd3JpdGUoc3RydWN0IGt2bV92Y3B1ICp2
Y3B1LCBncGFfdCBncGEsIGd2YV90IGd2YSwKKwkJCSAgY29uc3QgdTggKm5ldywgaW50IGJ5dGVz
KQogewogCXN0cnVjdCBrdm1fcGFnZV90cmFja19ub3RpZmllcl9oZWFkICpoZWFkOwogCXN0cnVj
dCBrdm1fcGFnZV90cmFja19ub3RpZmllcl9ub2RlICpuOwpAQCAtMjMyLDcgKzIzMiw3IEBAIHZv
aWQga3ZtX3BhZ2VfdHJhY2tfd3JpdGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEs
IGNvbnN0IHU4ICpuZXcsCiAJaGxpc3RfZm9yX2VhY2hfZW50cnlfc3JjdShuLCAmaGVhZC0+dHJh
Y2tfbm90aWZpZXJfbGlzdCwgbm9kZSwKIAkJCQlzcmN1X3JlYWRfbG9ja19oZWxkKCZoZWFkLT50
cmFja19zcmN1KSkKIAkJaWYgKG4tPnRyYWNrX3dyaXRlKQotCQkJbi0+dHJhY2tfd3JpdGUodmNw
dSwgZ3BhLCBuZXcsIGJ5dGVzLCBuKTsKKwkJCW4tPnRyYWNrX3dyaXRlKHZjcHUsIGdwYSwgZ3Zh
LCBuZXcsIGJ5dGVzLCBuKTsKIAlzcmN1X3JlYWRfdW5sb2NrKCZoZWFkLT50cmFja19zcmN1LCBp
ZHgpOwogfQogCmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9rdm0veDg2LmMgYi9hcmNoL3g4Ni9rdm0v
eDg2LmMKaW5kZXggZjQ4NjAzYzhlNDRkLi5jMmYxM2EyNzU0NDggMTAwNjQ0Ci0tLSBhL2FyY2gv
eDg2L2t2bS94ODYuYworKysgYi9hcmNoL3g4Ni9rdm0veDg2LmMKQEAgLTYxMTUsNyArNjExNSw3
IEBAIHN0YXRpYyBpbnQgdmNwdV9tbWlvX2d2YV90b19ncGEoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
LCB1bnNpZ25lZCBsb25nIGd2YSwKIAlyZXR1cm4gdmNwdV9pc19tbWlvX2dwYSh2Y3B1LCBndmEs
ICpncGEsIHdyaXRlKTsKIH0KIAotaW50IGVtdWxhdG9yX3dyaXRlX3BoeXMoc3RydWN0IGt2bV92
Y3B1ICp2Y3B1LCBncGFfdCBncGEsCitpbnQgZW11bGF0b3Jfd3JpdGVfcGh5cyhzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUsIGdwYV90IGdwYSwgZ3ZhX3QgZ3ZhLAogCQkJY29uc3Qgdm9pZCAqdmFsLCBp
bnQgYnl0ZXMpCiB7CiAJaW50IHJldDsKQEAgLTYxMjMsMTQgKzYxMjMsMTQgQEAgaW50IGVtdWxh
dG9yX3dyaXRlX3BoeXMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsCiAJcmV0ID0g
a3ZtX3ZjcHVfd3JpdGVfZ3Vlc3QodmNwdSwgZ3BhLCB2YWwsIGJ5dGVzKTsKIAlpZiAocmV0IDwg
MCkKIAkJcmV0dXJuIDA7Ci0Ja3ZtX3BhZ2VfdHJhY2tfd3JpdGUodmNwdSwgZ3BhLCB2YWwsIGJ5
dGVzKTsKKwlrdm1fcGFnZV90cmFja193cml0ZSh2Y3B1LCBncGEsIGd2YSwgdmFsLCBieXRlcyk7
CiAJcmV0dXJuIDE7CiB9CiAKIHN0cnVjdCByZWFkX3dyaXRlX2VtdWxhdG9yX29wcyB7CiAJaW50
ICgqcmVhZF93cml0ZV9wcmVwYXJlKShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHZvaWQgKnZhbCwK
IAkJCQkgIGludCBieXRlcyk7Ci0JaW50ICgqcmVhZF93cml0ZV9lbXVsYXRlKShzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUsIGdwYV90IGdwYSwKKwlpbnQgKCpyZWFkX3dyaXRlX2VtdWxhdGUpKHN0cnVj
dCBrdm1fdmNwdSAqdmNwdSwgZ3BhX3QgZ3BhLCBndmFfdCBndmEsCiAJCQkJICB2b2lkICp2YWws
IGludCBieXRlcyk7CiAJaW50ICgqcmVhZF93cml0ZV9tbWlvKShzdHJ1Y3Qga3ZtX3ZjcHUgKnZj
cHUsIGdwYV90IGdwYSwKIAkJCSAgICAgICBpbnQgYnl0ZXMsIHZvaWQgKnZhbCk7CkBAIC02MTUx
LDE2ICs2MTUxLDE2IEBAIHN0YXRpYyBpbnQgcmVhZF9wcmVwYXJlKHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSwgdm9pZCAqdmFsLCBpbnQgYnl0ZXMpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
cmVhZF9lbXVsYXRlKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgZ3BhX3QgZ3BhLAorc3RhdGljIGlu
dCByZWFkX2VtdWxhdGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsIGd2YV90IGd2
YSwKIAkJCXZvaWQgKnZhbCwgaW50IGJ5dGVzKQogewogCXJldHVybiAha3ZtX3ZjcHVfcmVhZF9n
dWVzdCh2Y3B1LCBncGEsIHZhbCwgYnl0ZXMpOwogfQogCi1zdGF0aWMgaW50IHdyaXRlX2VtdWxh
dGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsCitzdGF0aWMgaW50IHdyaXRlX2Vt
dWxhdGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsIGd2YV90IGd2YSwKIAkJCSB2
b2lkICp2YWwsIGludCBieXRlcykKIHsKLQlyZXR1cm4gZW11bGF0b3Jfd3JpdGVfcGh5cyh2Y3B1
LCBncGEsIHZhbCwgYnl0ZXMpOworCXJldHVybiBlbXVsYXRvcl93cml0ZV9waHlzKHZjcHUsIGdw
YSwgZ3ZhLCB2YWwsIGJ5dGVzKTsKIH0KIAogc3RhdGljIGludCB3cml0ZV9tbWlvKHN0cnVjdCBr
dm1fdmNwdSAqdmNwdSwgZ3BhX3QgZ3BhLCBpbnQgYnl0ZXMsIHZvaWQgKnZhbCkKQEAgLTYyMjgs
NyArNjIyOCw3IEBAIHN0YXRpYyBpbnQgZW11bGF0b3JfcmVhZF93cml0ZV9vbmVwYWdlKHVuc2ln
bmVkIGxvbmcgYWRkciwgdm9pZCAqdmFsLAogCQkJcmV0dXJuIFg4NkVNVUxfUFJPUEFHQVRFX0ZB
VUxUOwogCX0KIAotCWlmICghcmV0ICYmIG9wcy0+cmVhZF93cml0ZV9lbXVsYXRlKHZjcHUsIGdw
YSwgdmFsLCBieXRlcykpCisJaWYgKCFyZXQgJiYgb3BzLT5yZWFkX3dyaXRlX2VtdWxhdGUodmNw
dSwgZ3BhLCBhZGRyLCB2YWwsIGJ5dGVzKSkKIAkJcmV0dXJuIFg4NkVNVUxfQ09OVElOVUU7CiAK
IAkvKgpAQCAtNjM5Nyw3ICs2Mzk3LDcgQEAgc3RhdGljIGludCBlbXVsYXRvcl9jbXB4Y2hnX2Vt
dWxhdGVkKHN0cnVjdCB4ODZfZW11bGF0ZV9jdHh0ICpjdHh0LAogCWlmICghZXhjaGFuZ2VkKQog
CQlyZXR1cm4gWDg2RU1VTF9DTVBYQ0hHX0ZBSUxFRDsKIAotCWt2bV9wYWdlX3RyYWNrX3dyaXRl
KHZjcHUsIGdwYSwgbmV3LCBieXRlcyk7CisJa3ZtX3BhZ2VfdHJhY2tfd3JpdGUodmNwdSwgZ3Bh
LCBhZGRyLCBuZXcsIGJ5dGVzKTsKIAogCXJldHVybiBYODZFTVVMX0NPTlRJTlVFOwogCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQva3ZtZ3QuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9rdm1ndC5jCmluZGV4IGFkOGE5ZGY0OWYyOS4uNGUzNzBiMjE2MzY1IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQva3ZtZ3QuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndnQva3ZtZ3QuYwpAQCAtMTc0OSw3ICsxNzQ5LDcgQEAgc3RhdGljIGludCBr
dm1ndF9wYWdlX3RyYWNrX3JlbW92ZSh1bnNpZ25lZCBsb25nIGhhbmRsZSwgdTY0IGdmbikKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIHZvaWQga3ZtZ3RfcGFnZV90cmFja193cml0ZShzdHJ1Y3Qg
a3ZtX3ZjcHUgKnZjcHUsIGdwYV90IGdwYSwKK3N0YXRpYyB2b2lkIGt2bWd0X3BhZ2VfdHJhY2tf
d3JpdGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBncGFfdCBncGEsIGd2YV90IGd2YSwKIAkJY29u
c3QgdTggKnZhbCwgaW50IGxlbiwKIAkJc3RydWN0IGt2bV9wYWdlX3RyYWNrX25vdGlmaWVyX25v
ZGUgKm5vZGUpCiB7Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0cy5saW51
eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcvbWFpbG1h
bi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
