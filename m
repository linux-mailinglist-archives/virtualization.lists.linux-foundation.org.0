Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 682FA155DF8
	for <lists.virtualization@lfdr.de>; Fri,  7 Feb 2020 19:26:10 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 1BDB486975;
	Fri,  7 Feb 2020 18:26:09 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id HXM-FfnnH3XF; Fri,  7 Feb 2020 18:26:05 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 53E0C86942;
	Fri,  7 Feb 2020 18:26:00 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 2D2C8C013E;
	Fri,  7 Feb 2020 18:26:00 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id CDE3BC013E
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:55 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by hemlock.osuosl.org (Postfix) with ESMTP id B51DD87F8E
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:55 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id WoxIXsX651gZ
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:54 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by hemlock.osuosl.org (Postfix) with ESMTPS id A405187EC4
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:53 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 08A7E305D354; Fri,  7 Feb 2020 20:16:41 +0200 (EET)
Received: from host.bbu.bitdefender.biz (unknown [195.210.4.22])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id EAE47305206C;
 Fri,  7 Feb 2020 20:16:40 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [RFC PATCH v7 54/78] KVM: introspection: add KVMI_VCPU_GET_REGISTERS
Date: Fri,  7 Feb 2020 20:16:12 +0200
Message-Id: <20200207181636.1065-55-alazar@bitdefender.com>
In-Reply-To: <20200207181636.1065-1-alazar@bitdefender.com>
References: <20200207181636.1065-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 Sean Christopherson <sean.j.christopherson@intel.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBjb21tYW5k
IGlzIHVzZWQgdG8gZ2V0IGt2bV9yZWdzIGFuZCBrdm1fc3JlZ3Mgc3RydWN0dXJlcywKcGx1cyB0
aGUgbGlzdCBvZiBzdHJ1Y3Qga3ZtX21zcnMuCgpTaWduZWQtb2ZmLWJ5OiBNaWhhaSBEb27Im3Ug
PG1kb250dUBiaXRkZWZlbmRlci5jb20+CkNvLWRldmVsb3BlZC1ieTogQWRhbGJlcnQgTGF6xINy
IDxhbGF6YXJAYml0ZGVmZW5kZXIuY29tPgpTaWduZWQtb2ZmLWJ5OiBBZGFsYmVydCBMYXrEg3Ig
PGFsYXphckBiaXRkZWZlbmRlci5jb20+Ci0tLQogRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1p
LnJzdCAgICAgICAgICAgICAgIHwgNDIgKysrKysrKysrKysKIGFyY2gveDg2L2luY2x1ZGUvdWFw
aS9hc20va3ZtaS5oICAgICAgICAgICAgICB8IDE1ICsrKysKIGFyY2gveDg2L2t2bS9rdm1pLmMg
ICAgICAgICAgICAgICAgICAgICAgICAgICB8IDcwICsrKysrKysrKysrKysrKysrKysKIGluY2x1
ZGUvdWFwaS9saW51eC9rdm1pLmggICAgICAgICAgICAgICAgICAgICB8ICAxICsKIC4uLi90ZXN0
aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jICB8IDI2ICsrKysrKysKIHZpcnQv
a3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCAgICAgICAgICAgICB8ICA2ICsrCiB2aXJ0L2t2
bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgICAgICAgICAgICAgfCAxOCArKysrKwogNyBmaWxl
cyBjaGFuZ2VkLCAxNzggaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRpb24v
dmlydC9rdm0va3ZtaS5yc3QgYi9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CmluZGV4
IGM0OGFiYzhmNWM5Ny4uNWMzNjZiY2QzMTEyIDEwMDY0NAotLS0gYS9Eb2N1bWVudGF0aW9uL3Zp
cnQva3ZtL2t2bWkucnN0CisrKyBiL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKQEAg
LTU0Nyw2ICs1NDcsNDggQEAgYnkgdGhlICpLVk1JX1ZNX0NPTlRST0xfRVZFTlRTKiBjb21tYW5k
LgogKiAtS1ZNX0VQRVJNIC0gdGhlIGFjY2VzcyBpcyByZXN0cmljdGVkIGJ5IHRoZSBob3N0CiAq
IC1LVk1fRU9QTk9UU1VQUCAtIG9uZSB0aGUgZXZlbnRzIGNhbid0IGJlIGludGVyY2VwdGVkIGlu
IHRoZSBjdXJyZW50IHNldHVwCiAKKzExLiBLVk1JX1ZDUFVfR0VUX1JFR0lTVEVSUworLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tCisKKzpBcmNoaXRlY3R1cmVzOiB4ODYKKzpWZXJzaW9uczog
Pj0gMQorOlBhcmFtZXRlcnM6CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV92Y3B1X2hkcjsKKwlzdHJ1
Y3Qga3ZtaV92Y3B1X2dldF9yZWdpc3RlcnMgeworCQlfX3UxNiBubXNyczsKKwkJX191MTYgcGFk
ZGluZzE7CisJCV9fdTMyIHBhZGRpbmcyOworCQlfX3UzMiBtc3JzX2lkeFswXTsKKwl9OworCis6
UmV0dXJuczoKKworOjoKKworCXN0cnVjdCBrdm1pX2Vycm9yX2NvZGU7CisJc3RydWN0IGt2bWlf
dmNwdV9nZXRfcmVnaXN0ZXJzX3JlcGx5IHsKKwkJX191MzIgbW9kZTsKKwkJX191MzIgcGFkZGlu
ZzsKKwkJc3RydWN0IGt2bV9yZWdzIHJlZ3M7CisJCXN0cnVjdCBrdm1fc3JlZ3Mgc3JlZ3M7CisJ
CXN0cnVjdCBrdm1fbXNycyBtc3JzOworCX07CisKK0ZvciB0aGUgZ2l2ZW4gdkNQVSBhbmQgdGhl
IGBgbm1zcnNgYCBzaXplZCBhcnJheSBvZiBNU1JzIHJlZ2lzdGVycywKK3JldHVybnMgdGhlIGN1
cnJlbnQgdkNQVSBtb2RlIChpbiBieXRlczogMiwgNCBvciA4KSwgdGhlIGdlbmVyYWwgcHVycG9z
ZQorcmVnaXN0ZXJzLCB0aGUgc3BlY2lhbCByZWdpc3RlcnMgYW5kIHRoZSByZXF1ZXN0ZWQgc2V0
IG9mIE1TUnMuCisKKzpFcnJvcnM6CisKKyogLUtWTV9FSU5WQUwgLSB0aGUgc2VsZWN0ZWQgdkNQ
VSBpcyBpbnZhbGlkCisqIC1LVk1fRUlOVkFMIC0gb25lIG9mIHRoZSBpbmRpY2F0ZWQgTVNScyBp
cyBpbnZhbGlkCisqIC1LVk1fRUlOVkFMIC0gcGFkZGluZyBpcyBub3QgemVybworKiAtS1ZNX0VB
R0FJTiAtIHRoZSBzZWxlY3RlZCB2Q1BVIGNhbid0IGJlIGludHJvc3BlY3RlZCB5ZXQKKyogLUtW
TV9FTk9NRU0gLSBub3QgZW5vdWdoIG1lbW9yeSB0byBhbGxvY2F0ZSB0aGUgcmVwbHkKKwogRXZl
bnRzCiA9PT09PT0KIApkaWZmIC0tZ2l0IGEvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1p
LmggYi9hcmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaAppbmRleCA4OWFkZjg0Y2VmZTQu
LmYxNDY3NGMzYzEwOSAxMDA2NDQKLS0tIGEvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1p
LmgKKysrIGIvYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmgKQEAgLTMwLDQgKzMwLDE5
IEBAIHN0cnVjdCBrdm1pX3ZjcHVfZ2V0X2luZm9fcmVwbHkgewogCV9fdTY0IHRzY19zcGVlZDsK
IH07CiAKK3N0cnVjdCBrdm1pX3ZjcHVfZ2V0X3JlZ2lzdGVycyB7CisJX191MTYgbm1zcnM7CisJ
X191MTYgcGFkZGluZzE7CisJX191MzIgcGFkZGluZzI7CisJX191MzIgbXNyc19pZHhbMF07Cit9
OworCitzdHJ1Y3Qga3ZtaV92Y3B1X2dldF9yZWdpc3RlcnNfcmVwbHkgeworCV9fdTMyIG1vZGU7
CisJX191MzIgcGFkZGluZzsKKwlzdHJ1Y3Qga3ZtX3JlZ3MgcmVnczsKKwlzdHJ1Y3Qga3ZtX3Ny
ZWdzIHNyZWdzOworCXN0cnVjdCBrdm1fbXNycyBtc3JzOworfTsKKwogI2VuZGlmIC8qIF9VQVBJ
X0FTTV9YODZfS1ZNSV9IICovCmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9rdm0va3ZtaS5jIGIvYXJj
aC94ODYva3ZtL2t2bWkuYwppbmRleCA4NDJkNmFiZWJiNDEuLjY3Y2YyZDE5YmEwZiAxMDA2NDQK
LS0tIGEvYXJjaC94ODYva3ZtL2t2bWkuYworKysgYi9hcmNoL3g4Ni9rdm0va3ZtaS5jCkBAIC03
MCwzICs3MCw3MyBAQCBpbnQga3ZtaV9hcmNoX2NtZF92Y3B1X2dldF9pbmZvKHN0cnVjdCBrdm1f
dmNwdSAqdmNwdSwKIAogCXJldHVybiAwOwogfQorCitzdGF0aWMgdm9pZCAqCithbGxvY19nZXRf
cmVnaXN0ZXJzX3JlcGx5KGNvbnN0IHN0cnVjdCBrdm1pX21zZ19oZHIgKm1zZywKKwkJCSAgY29u
c3Qgc3RydWN0IGt2bWlfdmNwdV9nZXRfcmVnaXN0ZXJzICpyZXEsCisJCQkgIHNpemVfdCAqcnBs
X3NpemUpCit7CisJc3RydWN0IGt2bWlfdmNwdV9nZXRfcmVnaXN0ZXJzX3JlcGx5ICpycGw7CisJ
dTE2IGssIG4gPSByZXEtPm5tc3JzOworCisJKnJwbF9zaXplID0gc3RydWN0X3NpemUocnBsLCBt
c3JzLmVudHJpZXMsIG4pOworCXJwbCA9IGt2bWlfbXNnX2FsbG9jX2NoZWNrKCpycGxfc2l6ZSk7
CisJaWYgKHJwbCkgeworCQlycGwtPm1zcnMubm1zcnMgPSBuOworCisJCWZvciAoayA9IDA7IGsg
PCBuOyBrKyspCisJCQlycGwtPm1zcnMuZW50cmllc1trXS5pbmRleCA9IHJlcS0+bXNyc19pZHhb
a107CisJfQorCisJcmV0dXJuIHJwbDsKK30KKworc3RhdGljIGludCBrdm1pX2dldF9yZWdpc3Rl
cnMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1MzIgKm1vZGUsCisJCQkgICAgICBzdHJ1Y3Qga3Zt
X3JlZ3MgKnJlZ3MsCisJCQkgICAgICBzdHJ1Y3Qga3ZtX3NyZWdzICpzcmVncywKKwkJCSAgICAg
IHN0cnVjdCBrdm1fbXNycyAqbXNycykKK3sKKwlzdHJ1Y3Qga3ZtX21zcl9lbnRyeSAqbXNyID0g
bXNycy0+ZW50cmllczsKKwlzdHJ1Y3Qga3ZtX21zcl9lbnRyeSAqZW5kID0gbXNycy0+ZW50cmll
cyArIG1zcnMtPm5tc3JzOworCWludCBlcnIgPSAwOworCisJa3ZtX2FyY2hfdmNwdV9nZXRfcmVn
cyh2Y3B1LCByZWdzKTsKKwlrdm1fYXJjaF92Y3B1X2dldF9zcmVncyh2Y3B1LCBzcmVncyk7CisJ
Km1vZGUgPSBrdm1pX3ZjcHVfbW9kZSh2Y3B1LCBzcmVncyk7CisKKwlmb3IgKDsgbXNyIDwgZW5k
ICYmICFlcnI7IG1zcisrKQorCQllcnIgPSBfX2t2bV9nZXRfbXNyKHZjcHUsIG1zci0+aW5kZXgs
ICZtc3ItPmRhdGEsIHRydWUpOworCisJcmV0dXJuIGVyciA/IC1LVk1fRUlOVkFMIDogMDsKK30K
KworaW50IGt2bWlfYXJjaF9jbWRfdmNwdV9nZXRfcmVnaXN0ZXJzKHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSwKKwkJCQljb25zdCBzdHJ1Y3Qga3ZtaV9tc2dfaGRyICptc2csCisJCQkJY29uc3Qgc3Ry
dWN0IGt2bWlfdmNwdV9nZXRfcmVnaXN0ZXJzICpyZXEsCisJCQkJc3RydWN0IGt2bWlfdmNwdV9n
ZXRfcmVnaXN0ZXJzX3JlcGx5ICoqZGVzdCwKKwkJCQlzaXplX3QgKmRlc3Rfc2l6ZSkKK3sKKwlz
dHJ1Y3Qga3ZtaV92Y3B1X2dldF9yZWdpc3RlcnNfcmVwbHkgKnJwbDsKKwlzaXplX3QgcnBsX3Np
emUgPSAwOworCWludCBlcnI7CisKKwlpZiAocmVxLT5wYWRkaW5nMSB8fCByZXEtPnBhZGRpbmcy
KQorCQlyZXR1cm4gLUtWTV9FSU5WQUw7CisKKwlpZiAobXNnLT5zaXplIDwgc2l6ZW9mKHN0cnVj
dCBrdm1pX3ZjcHVfaGRyKQorCQkJKyBzdHJ1Y3Rfc2l6ZShyZXEsIG1zcnNfaWR4LCByZXEtPm5t
c3JzKSkKKwkJcmV0dXJuIC1LVk1fRUlOVkFMOworCisJcnBsID0gYWxsb2NfZ2V0X3JlZ2lzdGVy
c19yZXBseShtc2csIHJlcSwgJnJwbF9zaXplKTsKKwlpZiAoIXJwbCkKKwkJcmV0dXJuIC1LVk1f
RU5PTUVNOworCisJZXJyID0ga3ZtaV9nZXRfcmVnaXN0ZXJzKHZjcHUsICZycGwtPm1vZGUsICZy
cGwtPnJlZ3MsCisJCQkJICZycGwtPnNyZWdzLCAmcnBsLT5tc3JzKTsKKworCSpkZXN0ID0gcnBs
OworCSpkZXN0X3NpemUgPSBycGxfc2l6ZTsKKworCXJldHVybiBlcnI7CisKK30KZGlmZiAtLWdp
dCBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmggYi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5o
CmluZGV4IDc0NTUwM2ZiNzM3OC4uYmRiNWY5NzdjMjQwIDEwMDY0NAotLS0gYS9pbmNsdWRlL3Vh
cGkvbGludXgva3ZtaS5oCisrKyBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKQEAgLTI5LDYg
KzI5LDcgQEAgZW51bSB7CiAJS1ZNSV9WQ1BVX0dFVF9JTkZPICAgICAgID0gOSwKIAlLVk1JX1ZD
UFVfUEFVU0UgICAgICAgICAgPSAxMCwKIAlLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMgPSAxMSwK
KwlLVk1JX1ZDUFVfR0VUX1JFR0lTVEVSUyAgPSAxMiwKIAogCUtWTUlfTlVNX01FU1NBR0VTCiB9
OwpkaWZmIC0tZ2l0IGEvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rl
c3QuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKaW5k
ZXggODMwYjY0Y2FlMjBiLi41ZDc2ZDQ5YmMyNzcgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3Rlc3Rpbmcv
c2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKKysrIGIvdG9vbHMvdGVzdGluZy9zZWxm
dGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYwpAQCAtODAzLDYgKzgwMywzMSBAQCBzdGF0aWMg
dm9pZCB0ZXN0X2NtZF92Y3B1X2NvbnRyb2xfZXZlbnRzKHN0cnVjdCBrdm1fdm0gKnZtKQogCXRl
c3RfaW52YWxpZF92Y3B1X2V2ZW50KHZtLCBpbnZhbGlkX2lkKTsKIH0KIAorc3RhdGljIHZvaWQg
Z2V0X3ZjcHVfcmVnaXN0ZXJzKHN0cnVjdCBrdm1fdm0gKnZtLAorCQkJICAgICAgIHN0cnVjdCBr
dm1fcmVncyAqcmVncykKK3sKKwlzdHJ1Y3QgeworCQlzdHJ1Y3Qga3ZtaV9tc2dfaGRyIGhkcjsK
KwkJc3RydWN0IGt2bWlfdmNwdV9oZHIgdmNwdV9oZHI7CisJCXN0cnVjdCBrdm1pX3ZjcHVfZ2V0
X3JlZ2lzdGVycyBjbWQ7CisJfSByZXEgPSB7fTsKKwlzdHJ1Y3Qga3ZtaV92Y3B1X2dldF9yZWdp
c3RlcnNfcmVwbHkgcnBsOworCisJdGVzdF92Y3B1MF9jb21tYW5kKHZtLCBLVk1JX1ZDUFVfR0VU
X1JFR0lTVEVSUywgJnJlcS5oZHIsIHNpemVvZihyZXEpLAorCQkJICAgJnJwbCwgc2l6ZW9mKHJw
bCkpOworCisJbWVtY3B5KHJlZ3MsICZycGwucmVncywgc2l6ZW9mKCpyZWdzKSk7Cit9CisKK3N0
YXRpYyB2b2lkIHRlc3RfY21kX3ZjcHVfZ2V0X3JlZ2lzdGVycyhzdHJ1Y3Qga3ZtX3ZtICp2bSkK
K3sKKwlzdHJ1Y3Qga3ZtX3JlZ3MgcmVncyA9IHt9OworCisJZ2V0X3ZjcHVfcmVnaXN0ZXJzKHZt
LCAmcmVncyk7CisKKwlERUJVRygiZ2V0X3JlZ2lzdGVycyByaXAgMHglbGx4XG4iLCByZWdzLnJp
cCk7Cit9CisKIHN0YXRpYyB2b2lkIHRlc3RfaW50cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2
bSkKIHsKIAlzZXR1cF9zb2NrZXQoKTsKQEAgLTgxOSw2ICs4NDQsNyBAQCBzdGF0aWMgdm9pZCB0
ZXN0X2ludHJvc3BlY3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCiAJdGVzdF9jbWRfZ2V0X3ZjcHVf
aW5mbyh2bSk7CiAJdGVzdF9wYXVzZSh2bSk7CiAJdGVzdF9jbWRfdmNwdV9jb250cm9sX2V2ZW50
cyh2bSk7CisJdGVzdF9jbWRfdmNwdV9nZXRfcmVnaXN0ZXJzKHZtKTsKIAogCXVuaG9va19pbnRy
b3NwZWN0aW9uKHZtKTsKIH0KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3Zt
aV9pbnQuaCBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaAppbmRleCBmZTU5Njk2
YjA4MjYuLjVjOWJhNGIxMTA3ZSAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9r
dm1pX2ludC5oCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaApAQCAtMzgs
NiArMzgsNyBAQAogCQkJfCBCSVQoS1ZNSV9WQ1BVX0dFVF9JTkZPKSBcCiAJCQl8IEJJVChLVk1J
X1ZDUFVfUEFVU0UpIFwKIAkJCXwgQklUKEtWTUlfVkNQVV9DT05UUk9MX0VWRU5UUykgXAorCQkJ
fCBCSVQoS1ZNSV9WQ1BVX0dFVF9SRUdJU1RFUlMpIFwKIAkJKQogCiAjZGVmaW5lIEtWTUkoa3Zt
KSAoKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqKSgoa3ZtKS0+a3ZtaSkpCkBAIC04Miw1ICs4
MywxMCBAQCBpbnQga3ZtaV9jbWRfdmNwdV9wYXVzZShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIGJv
b2wgd2FpdCk7CiBpbnQga3ZtaV9hcmNoX2NtZF92Y3B1X2dldF9pbmZvKHN0cnVjdCBrdm1fdmNw
dSAqdmNwdSwKIAkJCQlzdHJ1Y3Qga3ZtaV92Y3B1X2dldF9pbmZvX3JlcGx5ICpycGwpOwogdm9p
ZCBrdm1pX2FyY2hfc2V0dXBfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBzdHJ1Y3Qga3Zt
aV9ldmVudCAqZXYpOworaW50IGt2bWlfYXJjaF9jbWRfdmNwdV9nZXRfcmVnaXN0ZXJzKHN0cnVj
dCBrdm1fdmNwdSAqdmNwdSwKKwkJCQljb25zdCBzdHJ1Y3Qga3ZtaV9tc2dfaGRyICptc2csCisJ
CQkJY29uc3Qgc3RydWN0IGt2bWlfdmNwdV9nZXRfcmVnaXN0ZXJzICpyZXEsCisJCQkJc3RydWN0
IGt2bWlfdmNwdV9nZXRfcmVnaXN0ZXJzX3JlcGx5ICoqZGVzdCwKKwkJCQlzaXplX3QgKmRlc3Rf
c2l6ZSk7CiAKICNlbmRpZgpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1p
X21zZy5jIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCmluZGV4IDE5OTVhNjNm
NGU5OS4uNGE3YzgzMTE4M2JiIDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2
bWlfbXNnLmMKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCkBAIC0yNyw2
ICsyNyw3IEBAIHN0YXRpYyBjb25zdCBjaGFyICpjb25zdCBtc2dfSURzW10gPSB7CiAJW0tWTUlf
Vk1fV1JJVEVfUEhZU0lDQUxdICAgPSAiS1ZNSV9WTV9XUklURV9QSFlTSUNBTCIsCiAJW0tWTUlf
VkNQVV9DT05UUk9MX0VWRU5UU10gPSAiS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTIiwKIAlbS1ZN
SV9WQ1BVX0dFVF9JTkZPXSAgICAgICA9ICJLVk1JX1ZDUFVfR0VUX0lORk8iLAorCVtLVk1JX1ZD
UFVfR0VUX1JFR0lTVEVSU10gID0gIktWTUlfVkNQVV9HRVRfUkVHSVNURVJTIiwKIAlbS1ZNSV9W
Q1BVX1BBVVNFXSAgICAgICAgICA9ICJLVk1JX1ZDUFVfUEFVU0UiLAogfTsKIApAQCAtNDM0LDYg
KzQzNSwyMiBAQCBzdGF0aWMgaW50IGhhbmRsZV92Y3B1X2NvbnRyb2xfZXZlbnRzKGNvbnN0IHN0
cnVjdCBrdm1pX3ZjcHVfY21kX2pvYiAqam9iLAogCXJldHVybiBrdm1pX21zZ192Y3B1X3JlcGx5
KGpvYiwgbXNnLCBlYywgTlVMTCwgMCk7CiB9CiAKK3N0YXRpYyBpbnQgaGFuZGxlX2dldF9yZWdp
c3RlcnMoY29uc3Qgc3RydWN0IGt2bWlfdmNwdV9jbWRfam9iICpqb2IsCisJCQkJY29uc3Qgc3Ry
dWN0IGt2bWlfbXNnX2hkciAqbXNnLAorCQkJCWNvbnN0IHZvaWQgKnJlcSkKK3sKKwlzdHJ1Y3Qg
a3ZtaV92Y3B1X2dldF9yZWdpc3RlcnNfcmVwbHkgKnJwbCA9IE5VTEw7CisJc2l6ZV90IHJwbF9z
aXplID0gMDsKKwlpbnQgZXJyLCBlYzsKKworCWVjID0ga3ZtaV9hcmNoX2NtZF92Y3B1X2dldF9y
ZWdpc3RlcnMoam9iLT52Y3B1LCBtc2csIHJlcSwKKwkJCQkJICAgICAgJnJwbCwgJnJwbF9zaXpl
KTsKKworCWVyciA9IGt2bWlfbXNnX3ZjcHVfcmVwbHkoam9iLCBtc2csIGVjLCBycGwsIHJwbF9z
aXplKTsKKwlrdm1pX21zZ19mcmVlKHJwbCk7CisJcmV0dXJuIGVycjsKK30KKwogLyoKICAqIFRo
ZXNlIGNvbW1hbmRzIGFyZSBleGVjdXRlZCBvbiB0aGUgdkNQVSB0aHJlYWQuIFRoZSByZWNlaXZp
bmcgdGhyZWFkCiAgKiBwYXNzZXMgdGhlIG1lc3NhZ2VzIHVzaW5nIGEgbmV3bHkgYWxsb2NhdGVk
ICdzdHJ1Y3Qga3ZtaV92Y3B1X2NtZF9qb2InCkBAIC00NDUsNiArNDYyLDcgQEAgc3RhdGljIGlu
dCgqY29uc3QgbXNnX3ZjcHVbXSkoY29uc3Qgc3RydWN0IGt2bWlfdmNwdV9jbWRfam9iICosCiAJ
W0tWTUlfRVZFTlRfUkVQTFldICAgICAgICAgPSBoYW5kbGVfZXZlbnRfcmVwbHksCiAJW0tWTUlf
VkNQVV9DT05UUk9MX0VWRU5UU10gPSBoYW5kbGVfdmNwdV9jb250cm9sX2V2ZW50cywKIAlbS1ZN
SV9WQ1BVX0dFVF9JTkZPXSAgICAgICA9IGhhbmRsZV9nZXRfdmNwdV9pbmZvLAorCVtLVk1JX1ZD
UFVfR0VUX1JFR0lTVEVSU10gID0gaGFuZGxlX2dldF9yZWdpc3RlcnMsCiB9OwogCiBzdGF0aWMg
dm9pZCBrdm1pX2pvYl92Y3B1X2NtZChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHZvaWQgKmN0eCkK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6
YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24u
b3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3Zp
cnR1YWxpemF0aW9u
