Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
	by mail.lfdr.de (Postfix) with ESMTPS id E281B1978E3
	for <lists.virtualization@lfdr.de>; Mon, 30 Mar 2020 12:20:21 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by hemlock.osuosl.org (Postfix) with ESMTP id 83AA9884EF;
	Mon, 30 Mar 2020 10:20:20 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id yvhheH3V1OfB; Mon, 30 Mar 2020 10:20:16 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by hemlock.osuosl.org (Postfix) with ESMTP id 3C6B488505;
	Mon, 30 Mar 2020 10:20:14 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 33387C07FF;
	Mon, 30 Mar 2020 10:20:14 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 6F645C07FF
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:59 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by hemlock.osuosl.org (Postfix) with ESMTP id 5E58B8844C
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:59 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id UUdVVS+9hTje
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:52 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by hemlock.osuosl.org (Postfix) with ESMTPS id 82B30883AC
 for <virtualization@lists.linux-foundation.org>;
 Mon, 30 Mar 2020 10:19:52 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 220F530644BC; Mon, 30 Mar 2020 13:12:56 +0300 (EEST)
Received: from localhost.localdomain (unknown [91.199.104.28])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id DDFB8305B7A1;
 Mon, 30 Mar 2020 13:12:55 +0300 (EEST)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v8 45/81] KVM: introspection: add KVMI_EVENT_UNHOOK
Date: Mon, 30 Mar 2020 13:12:32 +0300
Message-Id: <20200330101308.21702-46-alazar@bitdefender.com>
In-Reply-To: <20200330101308.21702-1-alazar@bitdefender.com>
References: <20200330101308.21702-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>, virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

SW4gY2VydGFpbiBzaXR1YXRpb25zICh3aGVuIHRoZSBndWVzdCBoYXMgdG8gYmUgcGF1c2VkLCBz
dXNwZW5kZWQsCm1pZ3JhdGVkLCBldGMuKSwgdXNlcnNwYWNlIHdpbGwgdXNlIHRoZSBLVk1fSU5U
Uk9TUEVDVElPTl9QUkVVTkhPT0sgaW9jdGwKaW4gb3JkZXIgdG8gdHJpZ2dlciB0aGUgS1ZNSV9F
VkVOVF9VTkhPT0sgZXZlbnQuIElmIHRoZSBldmVudCBpcyBzZW50CnN1Y2Nlc3NmdWxseSAodGhl
IFZNIGhhcyBhbiBhY3RpdmUgaW50cm9zcGVjdGlvbiBjaGFubmVsKSwgdXNlcnNwYWNlCnNob3Vs
ZCBkZWxheSB0aGUgYWN0aW9uIChwYXVzZS9zdXNwZW5kLy4uLikgdG8gZ2l2ZSB0aGUgaW50cm9z
cGVjdGlvbgp0b29sIHRoZSBjaGFuY2UgdG8gcmVtb3ZlIGl0cyBob29rcyAoZWcuIGJyZWFrcG9p
bnRzKSB3aGlsZSB0aGUgZ3Vlc3QKaXMgc3RpbGwgcnVubmluZy4gT25jZSBhIHRpbWVvdXQgaXMg
cmVhY2hlZCBvciB0aGUgaW50cm9zcGVjdGlvbiB0b29sCmhhcyBjbG9zZWQgdGhlIHNvY2tldCwg
dXNlcnNwYWNlIHNob3VsZCByZXN1bWUgdGhlIGFjdGlvbi4KClNpZ25lZC1vZmYtYnk6IEFkYWxi
ZXJ0IExhesSDciA8YWxhemFyQGJpdGRlZmVuZGVyLmNvbT4KLS0tCiBEb2N1bWVudGF0aW9uL3Zp
cnQva3ZtL2FwaS5yc3QgICAgICAgICAgICAgICAgfCAyOCArKysrKysrKwogRG9jdW1lbnRhdGlv
bi92aXJ0L2t2bS9rdm1pLnJzdCAgICAgICAgICAgICAgIHwgNjkgKysrKysrKysrKysrKysrKysr
LQogYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9rdm1pLmggICAgICAgICAgICAgIHwgMjkgKysr
KysrKysKIGluY2x1ZGUvbGludXgva3ZtaV9ob3N0LmggICAgICAgICAgICAgICAgICAgICB8ICAz
ICsKIGluY2x1ZGUvdWFwaS9saW51eC9rdm0uaCAgICAgICAgICAgICAgICAgICAgICB8ICAyICsK
IGluY2x1ZGUvdWFwaS9saW51eC9rdm1pLmggICAgICAgICAgICAgICAgICAgICB8IDEzICsrKysK
IC4uLi90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jICB8IDQyICsrKysr
KysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyAgICAgICAgICAgICAgICAgfCA0
MiArKysrKysrKysrLQogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oICAgICAgICAg
ICAgIHwgIDEgKwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jICAgICAgICAgICAg
IHwgMzggKysrKysrKysrKwogdmlydC9rdm0va3ZtX21haW4uYyAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHwgIDMgKwogMTEgZmlsZXMgY2hhbmdlZCwgMjY2IGluc2VydGlvbnMoKyksIDQgZGVs
ZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgYXJjaC94ODYvaW5jbHVkZS91YXBpL2FzbS9r
dm1pLmgKCmRpZmYgLS1naXQgYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2FwaS5yc3QgYi9Eb2N1
bWVudGF0aW9uL3ZpcnQva3ZtL2FwaS5yc3QKaW5kZXggNGQ4MWEyZjJmOGY3Li40MTc4ZTEzMTc2
NDcgMTAwNjQ0Ci0tLSBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0vYXBpLnJzdAorKysgYi9Eb2N1
bWVudGF0aW9uL3ZpcnQva3ZtL2FwaS5yc3QKQEAgLTQ3NzEsNiArNDc3MSwzNCBAQCB0aGUgZXZl
bnQgaXMgZGlzYWxsb3dlZC4KIFVubGVzcyBzZXQgdG8gLTEgKG1lYW5pbmcgYWxsIGV2ZW50KSwg
aWQgbXVzdCBiZSBhIGV2ZW50IElECiAoZS5nLiBLVk1JX0VWRU5UX1VOSE9PSywgS1ZNSV9FVkVO
VF9DUiwgZXRjLikKIAorNC4xMjkgS1ZNX0lOVFJPU1BFQ1RJT05fUFJFVU5IT09LCistLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKworOkNhcGFiaWxpdHk6IEtWTV9DQVBfSU5UUk9T
UEVDVElPTgorOkFyY2hpdGVjdHVyZXM6IHg4NgorOlR5cGU6IHZtIGlvY3RsCis6UGFyYW1ldGVy
czogbm9uZQorOlJldHVybnM6IDAgb24gc3VjY2VzcywgYSBuZWdhdGl2ZSB2YWx1ZSBvbiBlcnJv
cgorCitFcnJvcnM6CisKKyAgPT09PT09ICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KKyAgRUZBVUxUICAgICB0aGUgaW50cm9z
cGVjdGlvbiBpcyBub3QgZW5hYmxlZAorICBFRkFVTFQgICAgIHRoZSBzb2NrZXQgKHBhc3NlZCB3
aXRoIEtWTV9JTlRST1NQRUNUSU9OX0hPT0spIGhhZCBhbiBlcnJvcgorICBFTk9FTlQgICAgIHRo
ZSBpbnRyb3NwZWN0aW9uIHRvb2wgZGlkbid0IHN1YnNjcmliZWQKKyAgICAgICAgICAgICB0byB0
aGlzIHR5cGUgb2YgaW50cm9zcGVjdGlvbiBldmVudCAodW5ob29rKQorICA9PT09PT0gICAgID09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PQorCitUaGlzIGlvY3RsIGlzIHVzZWQgdG8gaW5mb3JtIHRoYXQgdGhlIGN1cnJlbnQgVk0gaXMK
K3BhdXNlZC9zdXNwZW5kZWQvbWlncmF0ZWQvZXRjLgorCitLVk0gc2hvdWxkIHNlbmQgYW4gJ3Vu
aG9vaycgaW50cm9zcGVjdGlvbiBldmVudCB0byB0aGUgaW50cm9zcGVjdGlvbiB0b29sLgorCitJ
ZiB0aGlzIGlvY3RsIGlzIHN1Y2Nlc3NmdWwsIHRoZSB1c2Vyc3BhY2Ugc2hvdWxkIGdpdmUgdGhl
CitpbnRyb3NwZWN0aW9uIHRvb2wgYSBjaGFuY2UgdG8gdW5ob29rIHRoZSBWTSBhbmQgdGhlbiBp
dCBzaG91bGQgdXNlCitLVk1fSU5UUk9TUEVDVElPTl9VTkhPT0sgdG8gbWFrZSBzdXJlIGFsbCB0
aGUgaW50cm9zcGVjdGlvbiBzdHJ1Y3R1cmVzCithcmUgZnJlZWQuCisKIDUuIFRoZSBrdm1fcnVu
IHN0cnVjdHVyZQogPT09PT09PT09PT09PT09PT09PT09PT09CiAKZGlmZiAtLWdpdCBhL0RvY3Vt
ZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QgYi9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWku
cnN0CmluZGV4IDM2YjM0ZTA5ZDJjMi4uZTY1MmJkZDY1MDUyIDEwMDY0NAotLS0gYS9Eb2N1bWVu
dGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CisrKyBiL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3Zt
aS5yc3QKQEAgLTE5NCw5ICsxOTQsMTAgQEAgYmVjb21lcyBuZWNlc3NhcnkgdG8gcmVtb3ZlIHRo
ZW0gYmVmb3JlIHRoZSBndWVzdCBpcyBzdXNwZW5kZWQsIG1vdmVkCiAobWlncmF0ZWQpIG9yIGEg
c25hcHNob3Qgd2l0aCBtZW1vcnkgaXMgY3JlYXRlZC4KIAogVGhlIGFjdGlvbnMgYXJlIG5vcm1h
bGx5IHBlcmZvcm1lZCBieSB0aGUgZGV2aWNlIG1hbmFnZXIuIEluIHRoZSBjYXNlCi1vZiBRRU1V
LCBpdCB3aWxsIHVzZSBhbm90aGVyIGlvY3RsIHRvIG5vdGlmeSB0aGUgaW50cm9zcGVjdGlvbiB0
b29sIGFuZAotd2FpdCBmb3IgYSBsaW1pdGVkIGFtb3VudCBvZiB0aW1lIChhIGZldyBzZWNvbmRz
KSBmb3IgYSBjb25maXJtYXRpb24gdGhhdAotaXMgT0sgdG8gcHJvY2VlZC4KK29mIFFFTVUsIGl0
IHdpbGwgdXNlIHRoZSAqS1ZNX0lOVFJPU1BFQ1RJT05fUFJFVU5IT09LKiBpb2N0bCB0byB0cmln
Z2VyCit0aGUgKktWTUlfRVZFTlRfVU5IT09LKiBldmVudCBhbmQgd2FpdCBmb3IgYSBsaW1pdGVk
IGFtb3VudCBvZiB0aW1lCisoYSBmZXcgc2Vjb25kcykgZm9yIGEgY29uZmlybWF0aW9uIGZyb20g
dGhlIGludHJvc3BlY3Rpb24gdG9vbAordGhhdCBpcyBPSyB0byBwcm9jZWVkLgogCiBMaXZlIG1p
Z3JhdGlvbnMKIC0tLS0tLS0tLS0tLS0tLQpAQCAtMzM4LDMgKzMzOSw2NSBAQCBUaGlzIGNvbW1h
bmQgaXMgYWx3YXlzIGFsbG93ZWQuCiAJfTsKIAogUmV0dXJucyB0aGUgbnVtYmVyIG9mIG9ubGlu
ZSB2Q1BVcy4KKworRXZlbnRzCis9PT09PT0KKworQWxsIGludHJvc3BlY3Rpb24gZXZlbnRzIChW
TSBvciB2Q1BVIHJlbGF0ZWQpIGFyZSBzZW50Cit1c2luZyB0aGUgKktWTUlfRVZFTlQqIG1lc3Nh
Z2UgaWQuCisKK1RoZSAqS1ZNSV9FVkVOVF9VTkhPT0sqIGV2ZW50IGRvZXNuJ3QgaGF2ZSBhIHJl
cGx5IGFuZCBzaGFyZSB0aGUga3ZtaV9ldmVudAorc3RydWN0dXJlLCBmb3IgY29uc2lzdGVuY3kg
d2l0aCB0aGUgdkNQVSBldmVudHMuCisKK1RoZSBtZXNzYWdlIGRhdGEgYmVnaW5zIHdpdGggYSBj
b21tb24gc3RydWN0dXJlLCBoYXZpbmcgdGhlIHNpemUgb2YgdGhlCitzdHJ1Y3R1cmUsIHRoZSB2
Q1BVIGluZGV4IGFuZCB0aGUgZXZlbnQgaWQ6OgorCisJc3RydWN0IGt2bWlfZXZlbnQgeworCQlf
X3UxNiBzaXplOworCQlfX3UxNiB2Y3B1OworCQlfX3U4IGV2ZW50OworCQlfX3U4IHBhZGRpbmdb
M107CisJCXN0cnVjdCBrdm1pX2V2ZW50X2FyY2ggYXJjaDsKKwl9CisKK09uIHg4NiB0aGUgc3Ry
dWN0dXJlIGxvb2tzIGxpa2UgdGhpczo6CisKKwlzdHJ1Y3Qga3ZtaV9ldmVudF9hcmNoIHsKKwkJ
X191OCBtb2RlOworCQlfX3U4IHBhZGRpbmdbN107CisJCXN0cnVjdCBrdm1fcmVncyByZWdzOwor
CQlzdHJ1Y3Qga3ZtX3NyZWdzIHNyZWdzOworCQlzdHJ1Y3QgeworCQkJX191NjQgc3lzZW50ZXJf
Y3M7CisJCQlfX3U2NCBzeXNlbnRlcl9lc3A7CisJCQlfX3U2NCBzeXNlbnRlcl9laXA7CisJCQlf
X3U2NCBlZmVyOworCQkJX191NjQgc3RhcjsKKwkJCV9fdTY0IGxzdGFyOworCQkJX191NjQgY3N0
YXI7CisJCQlfX3U2NCBwYXQ7CisJCQlfX3U2NCBzaGFkb3dfZ3M7CisJCX0gbXNyczsKKwl9Owor
CitJdCBjb250YWlucyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdkNQVSBzdGF0ZSBhdCB0aGUgdGlt
ZSBvZiB0aGUgZXZlbnQuCisKK1NwZWNpZmljIGRhdGEgY2FuIGZvbGxvdyB0aGVzZSBjb21tb24g
c3RydWN0dXJlcy4KKworMS4gS1ZNSV9FVkVOVF9VTkhPT0sKKy0tLS0tLS0tLS0tLS0tLS0tLS0t
CisKKzpBcmNoaXRlY3R1cmU6IGFsbAorOlZlcnNpb25zOiA+PSAxCis6QWN0aW9uczogbm9uZQor
OlBhcmFtZXRlcnM6CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV9ldmVudDsKKworOlJldHVybnM6IG5v
bmUKKworVGhpcyBldmVudCBpcyBzZW50IHdoZW4gdGhlIGRldmljZSBtYW5hZ2VyIGhhcyB0byBw
YXVzZS9zdG9wL21pZ3JhdGUgdGhlCitndWVzdCAoc2VlICoqVW5ob29raW5nKiopLiAgVGhlIGlu
dHJvc3BlY3Rpb24gdG9vbCBoYXMgYSBjaGFuY2UgdG8gdW5ob29rCithbmQgY2xvc2UgdGhlIEtW
TUkgY2hhbm5lbCAoc2lnbmFsaW5nIHRoYXQgdGhlIG9wZXJhdGlvbiBjYW4gcHJvY2VlZCkuCmRp
ZmYgLS1naXQgYS9hcmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2t2bWkuaCBiL2FyY2gveDg2L2lu
Y2x1ZGUvdWFwaS9hc20va3ZtaS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAw
MDAwMC4uNTUxZjllZDFlZDljCi0tLSAvZGV2L251bGwKKysrIGIvYXJjaC94ODYvaW5jbHVkZS91
YXBpL2FzbS9rdm1pLmgKQEAgLTAsMCArMSwyOSBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAgV0lUSCBMaW51eC1zeXNjYWxsLW5vdGUgKi8KKyNpZm5kZWYgX1VBUElfQVNN
X1g4Nl9LVk1JX0gKKyNkZWZpbmUgX1VBUElfQVNNX1g4Nl9LVk1JX0gKKworLyoKKyAqIEtWTSBp
bnRyb3NwZWN0aW9uIC0geDg2IHNwZWNpZmljIHN0cnVjdHVyZXMgYW5kIGRlZmluaXRpb25zCisg
Ki8KKworI2luY2x1ZGUgPGFzbS9rdm0uaD4KKworc3RydWN0IGt2bWlfZXZlbnRfYXJjaCB7CisJ
X191OCBtb2RlOwkJLyogMiwgNCBvciA4ICovCisJX191OCBwYWRkaW5nWzddOworCXN0cnVjdCBr
dm1fcmVncyByZWdzOworCXN0cnVjdCBrdm1fc3JlZ3Mgc3JlZ3M7CisJc3RydWN0IHsKKwkJX191
NjQgc3lzZW50ZXJfY3M7CisJCV9fdTY0IHN5c2VudGVyX2VzcDsKKwkJX191NjQgc3lzZW50ZXJf
ZWlwOworCQlfX3U2NCBlZmVyOworCQlfX3U2NCBzdGFyOworCQlfX3U2NCBsc3RhcjsKKwkJX191
NjQgY3N0YXI7CisJCV9fdTY0IHBhdDsKKwkJX191NjQgc2hhZG93X2dzOworCX0gbXNyczsKK307
CisKKyNlbmRpZiAvKiBfVUFQSV9BU01fWDg2X0tWTUlfSCAqLwpkaWZmIC0tZ2l0IGEvaW5jbHVk
ZS9saW51eC9rdm1pX2hvc3QuaCBiL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmgKaW5kZXggNGU3
N2EwMjI3YzA4Li4xODBlMjYzMzVhOGYgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbGludXgva3ZtaV9o
b3N0LmgKKysrIGIvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaApAQCAtMjEsNiArMjEsOCBAQCBz
dHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gewogCiAJREVDTEFSRV9CSVRNQVAoY21kX2FsbG93X21h
c2ssIEtWTUlfTlVNX0NPTU1BTkRTKTsKIAlERUNMQVJFX0JJVE1BUChldmVudF9hbGxvd19tYXNr
LCBLVk1JX05VTV9FVkVOVFMpOworCisJYXRvbWljX3QgZXZfc2VxOwogfTsKIAogI2lmZGVmIENP
TkZJR19LVk1fSU5UUk9TUEVDVElPTgpAQCAtMzQsNiArMzYsNyBAQCBpbnQga3ZtaV9pb2N0bF9o
b29rKHN0cnVjdCBrdm0gKmt2bSwgdm9pZCBfX3VzZXIgKmFyZ3ApOwogaW50IGt2bWlfaW9jdGxf
dW5ob29rKHN0cnVjdCBrdm0gKmt2bSk7CiBpbnQga3ZtaV9pb2N0bF9jb21tYW5kKHN0cnVjdCBr
dm0gKmt2bSwgdm9pZCBfX3VzZXIgKmFyZ3ApOwogaW50IGt2bWlfaW9jdGxfZXZlbnQoc3RydWN0
IGt2bSAqa3ZtLCB2b2lkIF9fdXNlciAqYXJncCk7CitpbnQga3ZtaV9pb2N0bF9wcmV1bmhvb2so
c3RydWN0IGt2bSAqa3ZtKTsKIAogI2Vsc2UKIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xp
bnV4L2t2bS5oIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bS5oCmluZGV4IGRkNGFiODhmMDAxMi4u
Yjg0NDhjZDc5N2VjIDEwMDY0NAotLS0gYS9pbmNsdWRlL3VhcGkvbGludXgva3ZtLmgKKysrIGIv
aW5jbHVkZS91YXBpL2xpbnV4L2t2bS5oCkBAIC0xNTc2LDYgKzE1NzYsOCBAQCBzdHJ1Y3Qga3Zt
X2ludHJvc3BlY3Rpb25fZmVhdHVyZSB7CiAjZGVmaW5lIEtWTV9JTlRST1NQRUNUSU9OX0NPTU1B
TkQgX0lPVyhLVk1JTywgMHhjNSwgc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uX2ZlYXR1cmUpCiAj
ZGVmaW5lIEtWTV9JTlRST1NQRUNUSU9OX0VWRU5UICAgX0lPVyhLVk1JTywgMHhjNiwgc3RydWN0
IGt2bV9pbnRyb3NwZWN0aW9uX2ZlYXR1cmUpCiAKKyNkZWZpbmUgS1ZNX0lOVFJPU1BFQ1RJT05f
UFJFVU5IT09LICBfSU8oS1ZNSU8sIDB4YzcpCisKICNkZWZpbmUgS1ZNX0RFVl9BU1NJR05fRU5B
QkxFX0lPTU1VCSgxIDw8IDApCiAjZGVmaW5lIEtWTV9ERVZfQVNTSUdOX1BDSV8yXzMJCSgxIDw8
IDEpCiAjZGVmaW5lIEtWTV9ERVZfQVNTSUdOX01BU0tfSU5UWAkoMSA8PCAyKQpkaWZmIC0tZ2l0
IGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgK
aW5kZXggYmZhMTUyNjc5OGU2Li42ODllYmEzMmMwMzEgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFw
aS9saW51eC9rdm1pLmgKKysrIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaApAQCAtOCwxMiAr
OCwxNSBAQAogCiAjaW5jbHVkZSA8bGludXgva2VybmVsLmg+CiAjaW5jbHVkZSA8bGludXgvdHlw
ZXMuaD4KKyNpbmNsdWRlIDxhc20va3ZtaS5oPgogCiBlbnVtIHsKIAlLVk1JX1ZFUlNJT04gPSAw
eDAwMDAwMDAxCiB9OwogCiBlbnVtIHsKKwlLVk1JX0VWRU5UICAgICAgICAgICAgPSAxLAorCiAJ
S1ZNSV9HRVRfVkVSU0lPTiAgICAgID0gMiwKIAlLVk1JX1ZNX0NIRUNLX0NPTU1BTkQgPSAzLAog
CUtWTUlfVk1fQ0hFQ0tfRVZFTlQgICA9IDQsCkBAIC0yMyw2ICsyNiw4IEBAIGVudW0gewogfTsK
IAogZW51bSB7CisJS1ZNSV9FVkVOVF9VTkhPT0sgPSAwLAorCiAJS1ZNSV9OVU1fRVZFTlRTCiB9
OwogCkBAIC03MCw0ICs3NSwxMiBAQCBzdHJ1Y3Qga3ZtaV92bV9nZXRfaW5mb19yZXBseSB7CiAJ
X191MzIgcGFkZGluZ1szXTsKIH07CiAKK3N0cnVjdCBrdm1pX2V2ZW50IHsKKwlfX3UxNiBzaXpl
OworCV9fdTE2IHZjcHU7CisJX191OCBldmVudDsKKwlfX3U4IHBhZGRpbmdbM107CisJc3RydWN0
IGt2bWlfZXZlbnRfYXJjaCBhcmNoOworfTsKKwogI2VuZGlmIC8qIF9VQVBJX19MSU5VWF9LVk1J
X0ggKi8KZGlmZiAtLWdpdCBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3Zt
aV90ZXN0LmMgYi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5j
CmluZGV4IGJhNTgwODFiZmVjNC4uOWNiNjVmOGM5NDZmIDEwMDY0NAotLS0gYS90b29scy90ZXN0
aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jCisrKyBiL3Rvb2xzL3Rlc3Rpbmcv
c2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKQEAgLTI2OCw2ICsyNjgsNDcgQEAgc3Rh
dGljIHZvaWQgdGVzdF9jbWRfZ2V0X3ZtX2luZm8odm9pZCkKIAlERUJVRygidmNwdSBjb3VudDog
JXVcbiIsIHJwbC52Y3B1X2NvdW50KTsKIH0KIAorc3RhdGljIHZvaWQgdHJpZ2dlcl9ldmVudF91
bmhvb2tfbm90aWZpY2F0aW9uKHN0cnVjdCBrdm1fdm0gKnZtKQoreworCWludCByOworCisJciA9
IGlvY3RsKHZtLT5mZCwgS1ZNX0lOVFJPU1BFQ1RJT05fUFJFVU5IT09LLCBOVUxMKTsKKwlURVNU
X0FTU0VSVChyID09IDAsCisJCSJLVk1fSU5UUk9TUEVDVElPTl9QUkVVTkhPT0sgZmFpbGVkLCBl
cnJubyAlZCAoJXMpXG4iLAorCQllcnJubywgc3RyZXJyb3IoZXJybm8pKTsKK30KKworc3RhdGlj
IHZvaWQgcmVjZWl2ZV9ldmVudChzdHJ1Y3Qga3ZtaV9tc2dfaGRyICpoZHIsIHN0cnVjdCBrdm1p
X2V2ZW50ICpldiwKKwkJCSBzaXplX3QgZXZfc2l6ZSwgaW50IGV2ZW50X2lkKQoreworCXJlY2Vp
dmVfZGF0YShoZHIsIHNpemVvZigqaGRyKSk7CisKKwlURVNUX0FTU0VSVChoZHItPmlkID09IEtW
TUlfRVZFTlQsCisJCSJVbmV4cGVjdGVkIG1lc3NhZ2VzIGlkICVkLCBleHBlY3RlZCAlZFxuIiwK
KwkJaGRyLT5pZCwgS1ZNSV9FVkVOVCk7CisKKwlURVNUX0FTU0VSVChoZHItPnNpemUgPT0gZXZf
c2l6ZSwKKwkJIkludmFsaWQgZXZlbnQgc2l6ZSAlZCwgZXhwZWN0ZWQgJWQgYnl0ZXNcbiIsCisJ
CWhkci0+c2l6ZSwgZXZfc2l6ZSk7CisKKwlyZWNlaXZlX2RhdGEoZXYsIGV2X3NpemUpOworCisJ
VEVTVF9BU1NFUlQoZXYtPmV2ZW50ID09IGV2ZW50X2lkLAorCQkiVW5leHBlY3RlZCBldmVudCAl
ZCwgZXhwZWN0ZWQgJWRcbiIsCisJCWV2LT5ldmVudCwgZXZlbnRfaWQpOworfQorCitzdGF0aWMg
dm9pZCB0ZXN0X2V2ZW50X3VuaG9vayhzdHJ1Y3Qga3ZtX3ZtICp2bSkKK3sKKwlfX3UxNiBpZCA9
IEtWTUlfRVZFTlRfVU5IT09LOworCXN0cnVjdCBrdm1pX21zZ19oZHIgaGRyOworCXN0cnVjdCBr
dm1pX2V2ZW50IGV2OworCisJdHJpZ2dlcl9ldmVudF91bmhvb2tfbm90aWZpY2F0aW9uKHZtKTsK
KworCXJlY2VpdmVfZXZlbnQoJmhkciwgJmV2LCBzaXplb2YoZXYpLCBpZCk7Cit9CisKIHN0YXRp
YyB2b2lkIHRlc3RfaW50cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkKIHsKIAlzZXR1cF9z
b2NrZXQoKTsKQEAgLTI3OCw2ICszMTksNyBAQCBzdGF0aWMgdm9pZCB0ZXN0X2ludHJvc3BlY3Rp
b24oc3RydWN0IGt2bV92bSAqdm0pCiAJdGVzdF9jbWRfY2hlY2tfY29tbWFuZCgpOwogCXRlc3Rf
Y21kX2NoZWNrX2V2ZW50KCk7CiAJdGVzdF9jbWRfZ2V0X3ZtX2luZm8oKTsKKwl0ZXN0X2V2ZW50
X3VuaG9vayh2bSk7CiAKIAl1bmhvb2tfaW50cm9zcGVjdGlvbih2bSk7CiB9CmRpZmYgLS1naXQg
YS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24v
a3ZtaS5jCmluZGV4IDVjMTdmNTQ4YjQ1Ny4uYmY2ZDVlYzk1MWM4IDEwMDY0NAotLS0gYS92aXJ0
L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYworKysgYi92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2
bWkuYwpAQCAtMTIsNiArMTIsOCBAQAogCiBzdGF0aWMgREVDTEFSRV9CSVRNQVAoS3ZtaV9hbHdh
eXNfYWxsb3dlZF9jb21tYW5kcywgS1ZNSV9OVU1fQ09NTUFORFMpOwogREVDTEFSRV9CSVRNQVAo
S3ZtaV9rbm93bl9ldmVudHMsIEtWTUlfTlVNX0VWRU5UUyk7CitzdGF0aWMgREVDTEFSRV9CSVRN
QVAoS3ZtaV9rbm93bl92bV9ldmVudHMsIEtWTUlfTlVNX0VWRU5UUyk7CitzdGF0aWMgREVDTEFS
RV9CSVRNQVAoS3ZtaV9rbm93bl92Y3B1X2V2ZW50cywgS1ZNSV9OVU1fRVZFTlRTKTsKIAogc3Rh
dGljIHN0cnVjdCBrbWVtX2NhY2hlICptc2dfY2FjaGU7CiAKQEAgLTU2LDcgKzU4LDEzIEBAIHN0
YXRpYyB2b2lkIHNldHVwX2Fsd2F5c19hbGxvd2VkX2NvbW1hbmRzKHZvaWQpCiAKIHN0YXRpYyB2
b2lkIHNldHVwX2tub3duX2V2ZW50cyh2b2lkKQogewotCWJpdG1hcF96ZXJvKEt2bWlfa25vd25f
ZXZlbnRzLCBLVk1JX05VTV9FVkVOVFMpOworCWJpdG1hcF96ZXJvKEt2bWlfa25vd25fdm1fZXZl
bnRzLCBLVk1JX05VTV9FVkVOVFMpOworCXNldF9iaXQoS1ZNSV9FVkVOVF9VTkhPT0ssIEt2bWlf
a25vd25fdm1fZXZlbnRzKTsKKworCWJpdG1hcF96ZXJvKEt2bWlfa25vd25fdmNwdV9ldmVudHMs
IEtWTUlfTlVNX0VWRU5UUyk7CisKKwliaXRtYXBfb3IoS3ZtaV9rbm93bl9ldmVudHMsIEt2bWlf
a25vd25fdm1fZXZlbnRzLAorCQkgIEt2bWlfa25vd25fdmNwdV9ldmVudHMsIEtWTUlfTlVNX0VW
RU5UUyk7CiB9CiAKIGludCBrdm1pX2luaXQodm9pZCkKQEAgLTkzLDYgKzEwMSw4IEBAIGFsbG9j
X2t2bWkoc3RydWN0IGt2bSAqa3ZtLCBjb25zdCBzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb25faG9v
ayAqaG9vaykKIAliaXRtYXBfY29weShrdm1pLT5jbWRfYWxsb3dfbWFzaywgS3ZtaV9hbHdheXNf
YWxsb3dlZF9jb21tYW5kcywKIAkJICAgIEtWTUlfTlVNX0NPTU1BTkRTKTsKIAorCWF0b21pY19z
ZXQoJmt2bWktPmV2X3NlcSwgMCk7CisKIAlrdm1pLT5rdm0gPSBrdm07CiAKIAlyZXR1cm4ga3Zt
aTsKQEAgLTM0OSwzICszNTksMzMgQEAgaW50IGt2bWlfaW9jdGxfY29tbWFuZChzdHJ1Y3Qga3Zt
ICprdm0sIHZvaWQgX191c2VyICphcmdwKQogCW11dGV4X3VubG9jaygma3ZtLT5rdm1pX2xvY2sp
OwogCXJldHVybiBlcnI7CiB9CisKK3N0YXRpYyBib29sIGt2bWlfdW5ob29rX2V2ZW50KHN0cnVj
dCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSkKK3sKKwlpbnQgZXJyOworCisJZXJyID0ga3ZtaV9t
c2dfc2VuZF91bmhvb2soa3ZtaSk7CisKKwlyZXR1cm4gIWVycjsKK30KKworaW50IGt2bWlfaW9j
dGxfcHJldW5ob29rKHN0cnVjdCBrdm0gKmt2bSkKK3sKKwlzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rp
b24gKmt2bWk7CisJaW50IGVyciA9IDA7CisKKwltdXRleF9sb2NrKCZrdm0tPmt2bWlfbG9jayk7
CisKKwlrdm1pID0gS1ZNSShrdm0pOworCWlmICgha3ZtaSkgeworCQllcnIgPSAtRUZBVUxUOwor
CQlnb3RvIG91dDsKKwl9CisKKwlpZiAoIWt2bWlfdW5ob29rX2V2ZW50KGt2bWkpKQorCQllcnIg
PSAtRU5PRU5UOworCitvdXQ6CisJbXV0ZXhfdW5sb2NrKCZrdm0tPmt2bWlfbG9jayk7CisJcmV0
dXJuIGVycjsKK30KZGlmZiAtLWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQu
aCBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaAppbmRleCBmNzU1YzY2Y2VlY2Mu
LmVjZDA2MjVlMGM5ZSAxMDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2lu
dC5oCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaApAQCAtMjUsNiArMjUs
NyBAQCBib29sIGt2bWlfc29ja19nZXQoc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pLCBp
bnQgZmQpOwogdm9pZCBrdm1pX3NvY2tfc2h1dGRvd24oc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9u
ICprdm1pKTsKIHZvaWQga3ZtaV9zb2NrX3B1dChzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2
bWkpOwogYm9vbCBrdm1pX21zZ19wcm9jZXNzKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3Zt
aSk7CitpbnQga3ZtaV9tc2dfc2VuZF91bmhvb2soc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICpr
dm1pKTsKIAogLyoga3ZtaS5jICovCiB2b2lkICprdm1pX21zZ19hbGxvYyh2b2lkKTsKZGlmZiAt
LWdpdCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYyBiL3ZpcnQva3ZtL2ludHJv
c3BlY3Rpb24va3ZtaV9tc2cuYwppbmRleCBjZWVjMzFhZTQ1ODEuLmIzODEyNzNiNzM1NSAxMDA2
NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCisrKyBiL3ZpcnQva3Zt
L2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYwpAQCAtMjU2LDMgKzI1Niw0MSBAQCBib29sIGt2bWlf
bXNnX3Byb2Nlc3Moc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pKQogb3V0OgogCXJldHVy
biBlcnIgPT0gMDsKIH0KKworc3RhdGljIHZvaWQga3ZtaV9zZXR1cF9ldmVudF9tc2dfaGRyKHN0
cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSwKKwkJCQkgICAgIHN0cnVjdCBrdm1pX21zZ19o
ZHIgKmhkciwKKwkJCQkgICAgIHNpemVfdCBtc2dfc2l6ZSkKK3sKKwltZW1zZXQoaGRyLCAwLCBz
aXplb2YoKmhkcikpOworCisJaGRyLT5pZCA9IEtWTUlfRVZFTlQ7CisJaGRyLT5zZXEgPSBhdG9t
aWNfaW5jX3JldHVybigma3ZtaS0+ZXZfc2VxKTsKKwloZHItPnNpemUgPSBtc2dfc2l6ZSAtIHNp
emVvZigqaGRyKTsKK30KKworc3RhdGljIHZvaWQga3ZtaV9zZXR1cF9ldmVudF9jb21tb24oc3Ry
dWN0IGt2bWlfZXZlbnQgKmV2LCB1MzIgZXZfaWQsCisJCQkJICAgIHUxNiB2Y3B1X2lkeCkKK3sK
KwltZW1zZXQoZXYsIDAsIHNpemVvZigqZXYpKTsKKworCWV2LT52Y3B1ID0gdmNwdV9pZHg7CisJ
ZXYtPmV2ZW50ID0gZXZfaWQ7CisJZXYtPnNpemUgPSBzaXplb2YoKmV2KTsKK30KKworaW50IGt2
bWlfbXNnX3NlbmRfdW5ob29rKHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSkKK3sKKwlz
dHJ1Y3Qga3ZtaV9tc2dfaGRyIGhkcjsKKwlzdHJ1Y3Qga3ZtaV9ldmVudCBjb21tb247CisJc3Ry
dWN0IGt2ZWMgdmVjW10gPSB7CisJCXsuaW92X2Jhc2UgPSAmaGRyLAkuaW92X2xlbiA9IHNpemVv
ZihoZHIpCSB9LAorCQl7Lmlvdl9iYXNlID0gJmNvbW1vbiwJLmlvdl9sZW4gPSBzaXplb2YoY29t
bW9uKX0sCisJfTsKKwlzaXplX3QgbXNnX3NpemUgPSBzaXplb2YoaGRyKSArIHNpemVvZihjb21t
b24pOworCXNpemVfdCBuID0gQVJSQVlfU0laRSh2ZWMpOworCisJa3ZtaV9zZXR1cF9ldmVudF9t
c2dfaGRyKGt2bWksICZoZHIsIG1zZ19zaXplKTsKKwlrdm1pX3NldHVwX2V2ZW50X2NvbW1vbigm
Y29tbW9uLCBLVk1JX0VWRU5UX1VOSE9PSywgMCk7CisKKwlyZXR1cm4ga3ZtaV9zb2NrX3dyaXRl
KGt2bWksIHZlYywgbiwgbXNnX3NpemUpOworfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0va3ZtX21h
aW4uYyBiL3ZpcnQva3ZtL2t2bV9tYWluLmMKaW5kZXggNGNhODYyNTU3NWJiLi44NmJjMmVkNjgw
Y2UgMTAwNjQ0Ci0tLSBhL3ZpcnQva3ZtL2t2bV9tYWluLmMKKysrIGIvdmlydC9rdm0va3ZtX21h
aW4uYwpAQCAtMzU5Niw2ICszNTk2LDkgQEAgc3RhdGljIGxvbmcga3ZtX3ZtX2lvY3RsKHN0cnVj
dCBmaWxlICpmaWxwLAogCWNhc2UgS1ZNX0lOVFJPU1BFQ1RJT05fRVZFTlQ6CiAJCXIgPSBrdm1p
X2lvY3RsX2V2ZW50KGt2bSwgYXJncCk7CiAJCWJyZWFrOworCWNhc2UgS1ZNX0lOVFJPU1BFQ1RJ
T05fUFJFVU5IT09LOgorCQlyID0ga3ZtaV9pb2N0bF9wcmV1bmhvb2soa3ZtKTsKKwkJYnJlYWs7
CiAjZW5kaWYgLyogQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OICovCiAJZGVmYXVsdDoKIAkJciA9
IGt2bV9hcmNoX3ZtX2lvY3RsKGZpbHAsIGlvY3RsLCBhcmcpOwpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QK
VmlydHVhbGl6YXRpb25AbGlzdHMubGludXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5s
aW51eGZvdW5kYXRpb24ub3JnL21haWxtYW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
