Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 9939C155E04
	for <lists.virtualization@lfdr.de>; Fri,  7 Feb 2020 19:26:23 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 59D668696D;
	Fri,  7 Feb 2020 18:26:22 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id N4MlL3f8uX3t; Fri,  7 Feb 2020 18:26:21 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 29FC486A3D;
	Fri,  7 Feb 2020 18:26:04 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 14E33C1D81;
	Fri,  7 Feb 2020 18:26:04 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id D1CF1C1D85
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:58 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by silver.osuosl.org (Postfix) with ESMTP id B3C5C2265B
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:58 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id oJEduBlEj-dE
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:58 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by silver.osuosl.org (Postfix) with ESMTPS id E16EA2264C
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:57 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 90790305D35E; Fri,  7 Feb 2020 20:16:41 +0200 (EET)
Received: from host.bbu.bitdefender.biz (unknown [195.210.4.22])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 7B3833052074;
 Fri,  7 Feb 2020 20:16:41 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [RFC PATCH v7 64/78] KVM: introspection: add KVMI_EVENT_XSETBV
Date: Fri,  7 Feb 2020 20:16:22 +0200
Message-Id: <20200207181636.1065-65-alazar@bitdefender.com>
In-Reply-To: <20200207181636.1065-1-alazar@bitdefender.com>
References: <20200207181636.1065-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <ncitu@bitdefender.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 Sean Christopherson <sean.j.christopherson@intel.com>,
 virtualization@lists.linux-foundation.org,
 =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBldmVudCBp
cyBzZW50IHdoZW4gdGhlIGV4dGVuZGVkIGNvbnRyb2wgcmVnaXN0ZXIgWENSMCBpcyBnb2luZyB0
bwpiZSBjaGFuZ2VkLgoKU2lnbmVkLW9mZi1ieTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVm
ZW5kZXIuY29tPgpDby1kZXZlbG9wZWQtYnk6IE5pY3XImW9yIEPDrsibdSA8bmNpdHVAYml0ZGVm
ZW5kZXIuY29tPgpTaWduZWQtb2ZmLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5jaXR1QGJpdGRlZmVu
ZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogQWRhbGJlcnQgTGF6xINyIDxhbGF6YXJAYml0ZGVmZW5k
ZXIuY29tPgotLS0KIERvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QgICAgICAgICAgICAg
ICB8IDI2ICsrKysrKwogYXJjaC94ODYvaW5jbHVkZS9hc20va3ZtaV9ob3N0LmggICAgICAgICAg
ICAgIHwgIDIgKwogYXJjaC94ODYva3ZtL3g4Ni5jICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwgIDYgKysKIGluY2x1ZGUvdWFwaS9saW51eC9rdm1pLmggICAgICAgICAgICAgICAgICAgICB8
ICAxICsKIC4uLi90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jICB8IDgz
ICsrKysrKysrKysrKysrKysrKysKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCAg
ICAgICAgICAgICB8ICAxICsKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYyAgICAg
ICAgICAgICB8IDM5ICsrKysrKysrKwogNyBmaWxlcyBjaGFuZ2VkLCAxNTggaW5zZXJ0aW9ucygr
KQoKZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QgYi9Eb2N1bWVu
dGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CmluZGV4IGMxYmFkY2RlMTY2Mi4uOGI0M2UwZjgwZjc3
IDEwMDY0NAotLS0gYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0CisrKyBiL0RvY3Vt
ZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKQEAgLTUzNCw2ICs1MzQsNyBAQCB0aGUgZm9sbG93
aW5nIGV2ZW50czo6CiAJS1ZNSV9FVkVOVF9DUgogCUtWTUlfRVZFTlRfSFlQRVJDQUxMCiAJS1ZN
SV9FVkVOVF9UUkFQCisJS1ZNSV9FVkVOVF9YU0VUQlYKIAogV2hlbiBhbiBldmVudCBpcyBlbmFi
bGVkLCB0aGUgaW50cm9zcGVjdGlvbiB0b29sIGlzIG5vdGlmaWVkIGFuZCBpdAogbXVzdCByZXBs
eSB3aXRoOiBjb250aW51ZSwgcmV0cnksIGNyYXNoLCBldGMuIChzZWUgKipFdmVudHMqKiBiZWxv
dykuCkBAIC05OTksMyArMTAwMCwyOCBAQCB0b29rIHBsYWNlIGFuZCB0aGUgaW50cm9zcGVjdGlv
biBoYXMgYmVlbiBlbmFibGVkIGZvciB0aGlzIGV2ZW50CiBgYGt2bWlfZXZlbnRgYCwgZXhjZXB0
aW9uL2ludGVycnVwdCBudW1iZXIgKHZlY3RvciksIGV4Y2VwdGlvbiBjb2RlCiAoYGBlcnJvcl9j
b2RlYGApIGFuZCBDUjIgYXJlIHNlbnQgdG8gdGhlIGludHJvc3BlY3Rpb24gdG9vbCwKIHdoaWNo
IHNob3VsZCBjaGVjayBpZiBpdHMgZXhjZXB0aW9uIGhhcyBiZWVuIGluamVjdGVkIG9yIG92ZXJy
aWRkZW4uCisKKzcuIEtWTUlfRVZFTlRfWFNFVEJWCistLS0tLS0tLS0tLS0tLS0tLS0tLQorCis6
QXJjaGl0ZWN0dXJlczogeDg2Cis6VmVyc2lvbnM6ID49IDEKKzpBY3Rpb25zOiBDT05USU5VRSwg
Q1JBU0gKKzpQYXJhbWV0ZXJzOgorCis6OgorCisJc3RydWN0IGt2bWlfZXZlbnQ7CisKKzpSZXR1
cm5zOgorCis6OgorCisJc3RydWN0IGt2bWlfdmNwdV9oZHI7CisJc3RydWN0IGt2bWlfZXZlbnRf
cmVwbHk7CisKK1RoaXMgZXZlbnQgaXMgc2VudCB3aGVuIHRoZSBleHRlbmRlZCBjb250cm9sIHJl
Z2lzdGVyIFhDUjAgaXMgZ29pbmcKK3RvIGJlIGNoYW5nZWQgYW5kIHRoZSBpbnRyb3NwZWN0aW9u
IGhhcyBiZWVuIGVuYWJsZWQgZm9yIHRoaXMgZXZlbnQKKyhzZWUgKktWTUlfVkNQVV9DT05UUk9M
X0VWRU5UUyopLgorCitgYGt2bWlfZXZlbnRgYCBpcyBzZW50IHRvIHRoZSBpbnRyb3NwZWN0aW9u
IHRvb2wuCmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1pX2hvc3QuaCBiL2Fy
Y2gveDg2L2luY2x1ZGUvYXNtL2t2bWlfaG9zdC5oCmluZGV4IDI0ZjNmOGZkZWU2Mi4uYjNmYTk1
MDM2MmRiIDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1pX2hvc3QuaAorKysg
Yi9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1pX2hvc3QuaApAQCAtMzAsNiArMzAsNyBAQCBib29s
IGt2bWlfY3JfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1bnNpZ25lZCBpbnQgY3IsCiAJ
CSAgIHVuc2lnbmVkIGxvbmcgb2xkX3ZhbHVlLCB1bnNpZ25lZCBsb25nICpuZXdfdmFsdWUpOwog
Ym9vbCBrdm1pX2NyM19pbnRlcmNlcHRlZChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwogYm9vbCBr
dm1pX21vbml0b3JfY3Izd19pbnRlcmNlcHQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBib29sIGVu
YWJsZSk7Cit2b2lkIGt2bWlfeHNldGJ2X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7CiAK
ICNlbHNlIC8qIENPTkZJR19LVk1fSU5UUk9TUEVDVElPTiAqLwogCkBAIC00MSw2ICs0Miw3IEBA
IHN0YXRpYyBpbmxpbmUgYm9vbCBrdm1pX2NyX2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwg
dW5zaWduZWQgaW50IGNyLAogc3RhdGljIGlubGluZSBib29sIGt2bWlfY3IzX2ludGVyY2VwdGVk
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkgeyByZXR1cm4gZmFsc2U7IH0KIHN0YXRpYyBpbmxpbmUg
Ym9vbCBrdm1pX21vbml0b3JfY3Izd19pbnRlcmNlcHQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LAog
CQkJCQkJYm9vbCBlbmFibGUpIHsgcmV0dXJuIGZhbHNlOyB9CitzdGF0aWMgaW5saW5lIHZvaWQg
a3ZtaV94c2V0YnZfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KSB7IH0KIAogI2VuZGlmIC8q
IENPTkZJR19LVk1fSU5UUk9TUEVDVElPTiAqLwogCmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9rdm0v
eDg2LmMgYi9hcmNoL3g4Ni9rdm0veDg2LmMKaW5kZXggZmY2MTEyM2NlNGJkLi5mYTU4M2Y4MjI5
OGUgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS94ODYuYworKysgYi9hcmNoL3g4Ni9rdm0veDg2
LmMKQEAgLTg2Niw2ICs4NjYsMTIgQEAgc3RhdGljIGludCBfX2t2bV9zZXRfeGNyKHN0cnVjdCBr
dm1fdmNwdSAqdmNwdSwgdTMyIGluZGV4LCB1NjQgeGNyKQogCX0KIAl2Y3B1LT5hcmNoLnhjcjAg
PSB4Y3IwOwogCisjaWZkZWYgQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OCisJaWYgKGluZGV4ID09
IDAgJiYgeGNyMCAhPSBvbGRfeGNyMCkKKwkJa3ZtaV94c2V0YnZfZXZlbnQodmNwdSk7CisjZW5k
aWYgLyogQ09ORklHX0tWTV9JTlRST1NQRUNUSU9OICovCisKKwogCWlmICgoeGNyMCBeIG9sZF94
Y3IwKSAmIFhGRUFUVVJFX01BU0tfRVhURU5EKQogCQlrdm1fdXBkYXRlX2NwdWlkKHZjcHUpOwog
CXJldHVybiAwOwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaCBiL2luY2x1
ZGUvdWFwaS9saW51eC9rdm1pLmgKaW5kZXggNzBkNWE2N2JhZGVmLi4zZWE0ODgyYWM0NjkgMTAw
NjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKKysrIGIvaW5jbHVkZS91YXBpL2xp
bnV4L2t2bWkuaApAQCAtNDcsNiArNDcsNyBAQCBlbnVtIHsKIAlLVk1JX0VWRU5UX0JSRUFLUE9J
TlQgPSAzLAogCUtWTUlfRVZFTlRfQ1IgICAgICAgICA9IDQsCiAJS1ZNSV9FVkVOVF9UUkFQICAg
ICAgID0gNSwKKwlLVk1JX0VWRU5UX1hTRVRCViAgICAgPSA2LAogCiAJS1ZNSV9OVU1fRVZFTlRT
CiB9OwpkaWZmIC0tZ2l0IGEvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1p
X3Rlc3QuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMK
aW5kZXggMjg1MmU2ODk0ZTgxLi4yOTlmNGQyOWQwZDYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3Rlc3Rp
bmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKKysrIGIvdG9vbHMvdGVzdGluZy9z
ZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYwpAQCAtMjEsNiArMjEsOCBAQAogCiAjZGVm
aW5lIFZDUFVfSUQgICAgICAgICA1CiAKKyNkZWZpbmUgWDg2X0ZFQVRVUkVfWFNBVkUJKDE8PDI2
KQorCiBzdGF0aWMgaW50IHNvY2tldF9wYWlyWzJdOwogI2RlZmluZSBLdm1fc29ja2V0ICAgICAg
IHNvY2tldF9wYWlyWzBdCiAjZGVmaW5lIFVzZXJzcGFjZV9zb2NrZXQgc29ja2V0X3BhaXJbMV0K
QEAgLTUzLDYgKzU1LDcgQEAgZW51bSB7CiAJR1VFU1RfVEVTVF9CUCwKIAlHVUVTVF9URVNUX0NS
LAogCUdVRVNUX1RFU1RfSFlQRVJDQUxMLAorCUdVRVNUX1RFU1RfWFNFVEJWLAogfTsKIAogI2Rl
ZmluZSBHVUVTVF9SRVFVRVNUX1RFU1QoKSAgICAgR1VFU1RfU1lOQygwKQpAQCAtODQsNiArODcs
NDUgQEAgc3RhdGljIHZvaWQgZ3Vlc3RfaHlwZXJjYWxsX3Rlc3Qodm9pZCkKIAlhc20gdm9sYXRp
bGUoIi5ieXRlIDB4MGYsMHgwMSwweGMxIik7CiB9CiAKKy8qIGZyb20gZnB1L2ludGVybmFsLmgg
Ki8KK3N0YXRpYyB1NjQgeGdldGJ2KHUzMiBpbmRleCkKK3sKKwl1MzIgZWF4LCBlZHg7CisKKwlh
c20gdm9sYXRpbGUoIi5ieXRlIDB4MGYsMHgwMSwweGQwIiAvKiB4Z2V0YnYgKi8KKwkJICAgICA6
ICI9YSIgKGVheCksICI9ZCIgKGVkeCkKKwkJICAgICA6ICJjIiAoaW5kZXgpKTsKKwlyZXR1cm4g
ZWF4ICsgKCh1NjQpZWR4IDw8IDMyKTsKK30KKworLyogZnJvbSBmcHUvaW50ZXJuYWwuaCAqLwor
c3RhdGljIHZvaWQgeHNldGJ2KHUzMiBpbmRleCwgdTY0IHZhbHVlKQoreworCXUzMiBlYXggPSB2
YWx1ZTsKKwl1MzIgZWR4ID0gdmFsdWUgPj4gMzI7CisKKwlhc20gdm9sYXRpbGUoIi5ieXRlIDB4
MGYsMHgwMSwweGQxIiAvKiB4c2V0YnYgKi8KKwkJICAgICA6IDogImEiIChlYXgpLCAiZCIgKGVk
eCksICJjIiAoaW5kZXgpKTsKK30KKworc3RhdGljIHZvaWQgZ3Vlc3RfeHNldGJ2X3Rlc3Qodm9p
ZCkKK3sKKwljb25zdCBpbnQgU1NFX0JJVCA9IDEgPDwgMTsKKwljb25zdCBpbnQgQVZYX0JJVCA9
IDEgPDwgMjsKKwl1NjQgeGNyMDsKKworCS8qIGF2b2lkICNVRCAqLworCXNldF9jcjQoZ2V0X2Ny
NCgpIHwgWDg2X0NSNF9PU1hTQVZFKTsKKworCXhjcjAgPSB4Z2V0YnYoMCk7CisJaWYgKHhjcjAg
JiBBVlhfQklUKQorCQl4Y3IwICY9IH5BVlhfQklUOworCWVsc2UKKwkJeGNyMCB8PSAoQVZYX0JJ
VCB8IFNTRV9CSVQpOworCisJeHNldGJ2KDAsIHhjcjApOworfQorCiBzdGF0aWMgdm9pZCBndWVz
dF9jb2RlKHZvaWQpCiB7CiAJd2hpbGUgKHRydWUpIHsKQEAgLTk5LDYgKzE0MSw5IEBAIHN0YXRp
YyB2b2lkIGd1ZXN0X2NvZGUodm9pZCkKIAkJY2FzZSBHVUVTVF9URVNUX0hZUEVSQ0FMTDoKIAkJ
CWd1ZXN0X2h5cGVyY2FsbF90ZXN0KCk7CiAJCQlicmVhazsKKwkJY2FzZSBHVUVTVF9URVNUX1hT
RVRCVjoKKwkJCWd1ZXN0X3hzZXRidl90ZXN0KCk7CisJCQlicmVhazsKIAkJfQogCQlHVUVTVF9T
SUdOQUxfVEVTVF9ET05FKCk7CiAJfQpAQCAtMTI0MCw2ICsxMjg1LDQzIEBAIHN0YXRpYyB2b2lk
IHRlc3RfY21kX3ZtX2dldF9tYXhfZ2ZuKHZvaWQpCiAJREVCVUcoIm1heF9nZm46IDB4JWxseFxu
IiwgcnBsLmdmbik7CiB9CiAKK3N0YXRpYyB2b2lkIHRlc3RfZXZlbnRfeHNldGJ2KHN0cnVjdCBr
dm1fdm0gKnZtKQoreworCXN0cnVjdCB2Y3B1X3dvcmtlcl9kYXRhIGRhdGEgPSB7CisJCS52bSA9
IHZtLAorCQkudmNwdV9pZCA9IFZDUFVfSUQsCisJCS50ZXN0X2lkID0gR1VFU1RfVEVTVF9YU0VU
QlYsCisJfTsKKwlfX3UxNiBldmVudF9pZCA9IEtWTUlfRVZFTlRfWFNFVEJWOworCXN0cnVjdCBr
dm1fY3B1aWRfZW50cnkyICplbnRyeTsKKwlzdHJ1Y3QgdmNwdV9yZXBseSBycGwgPSB7fTsKKwlz
dHJ1Y3Qga3ZtaV9tc2dfaGRyIGhkcjsKKwlwdGhyZWFkX3QgdmNwdV90aHJlYWQ7CisJc3RydWN0
IGt2bWlfZXZlbnQgZXY7CisKKwllbnRyeSA9IGt2bV9nZXRfc3VwcG9ydGVkX2NwdWlkX2VudHJ5
KDEpOworCWlmICghKGVudHJ5LT5lY3ggJiBYODZfRkVBVFVSRV9YU0FWRSkpIHsKKwkJREVCVUco
IlhTQVZFIGlzIG5vdCBzdXBwb3J0ZWQsIGVjeCAweCV4LCBza2lwcGluZyB4c2V0YnYgdGVzdFxu
IiwKKwkJCWVudHJ5LT5lY3gpOworCQlyZXR1cm47CisJfQorCisJZW5hYmxlX3ZjcHVfZXZlbnQo
dm0sIGV2ZW50X2lkKTsKKworCXZjcHVfdGhyZWFkID0gc3RhcnRfdmNwdV93b3JrZXIoJmRhdGEp
OworCisJcmVjZWl2ZV9ldmVudCgmaGRyLCAmZXYsIHNpemVvZihldiksIGV2ZW50X2lkKTsKKwor
CURFQlVHKCJYU0VUQlYgZXZlbnQsIHJpcCAweCVsbHhcbiIsIGV2LmFyY2gucmVncy5yaXApOwor
CisJcmVwbHlfdG9fZXZlbnQoJmhkciwgJmV2LCBLVk1JX0VWRU5UX0FDVElPTl9DT05USU5VRSwK
KwkJCSZycGwsIHNpemVvZihycGwpKTsKKworCXN0b3BfdmNwdV93b3JrZXIodmNwdV90aHJlYWQs
ICZkYXRhKTsKKworCWRpc2FibGVfdmNwdV9ldmVudCh2bSwgZXZlbnRfaWQpOworfQorCiBzdGF0
aWMgdm9pZCB0ZXN0X2ludHJvc3BlY3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCiB7CiAJc2V0dXBf
c29ja2V0KCk7CkBAIC0xMjY0LDYgKzEzNDYsNyBAQCBzdGF0aWMgdm9pZCB0ZXN0X2ludHJvc3Bl
Y3Rpb24oc3RydWN0IGt2bV92bSAqdm0pCiAJdGVzdF9jbWRfdmNwdV9jb250cm9sX2NyKHZtKTsK
IAl0ZXN0X2NtZF92Y3B1X2luamVjdF9leGNlcHRpb24odm0pOwogCXRlc3RfY21kX3ZtX2dldF9t
YXhfZ2ZuKCk7CisJdGVzdF9ldmVudF94c2V0YnYodm0pOwogCiAJdW5ob29rX2ludHJvc3BlY3Rp
b24odm0pOwogfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5o
IGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCmluZGV4IDY1YTU4MDFmMTQzYy4u
NWEwMGUzOGM4OGNjIDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50
LmgKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCkBAIC0yNyw2ICsyNyw3
IEBACiAJCQkgIHwgQklUKEtWTUlfRVZFTlRfSFlQRVJDQUxMKSBcCiAJCQkgIHwgQklUKEtWTUlf
RVZFTlRfVFJBUCkgXAogCQkJICB8IEJJVChLVk1JX0VWRU5UX1BBVVNFX1ZDUFUpIFwKKwkJCSAg
fCBCSVQoS1ZNSV9FVkVOVF9YU0VUQlYpIFwKIAkJKQogCiAjZGVmaW5lIEtWTUlfS05PV05fRVZF
TlRTIChLVk1JX0tOT1dOX1ZNX0VWRU5UUyB8IEtWTUlfS05PV05fVkNQVV9FVkVOVFMpCmRpZmYg
LS1naXQgYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgYi92aXJ0L2t2bS9pbnRy
b3NwZWN0aW9uL2t2bWlfbXNnLmMKaW5kZXggOTRmYWI3MGI1NmZhLi5iYTJkN2M2YWNiMjIgMTAw
NjQ0Ci0tLSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYworKysgYi92aXJ0L2t2
bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKQEAgLTk1NiwzICs5NTYsNDIgQEAgdTMyIGt2bWlf
bXNnX3NlbmRfYnAoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1NjQgZ3BhLCB1OCBpbnNuX2xlbikK
IAogCXJldHVybiBhY3Rpb247CiB9CisKK3N0YXRpYyB1MzIga3ZtaV9zZW5kX3hzZXRidihzdHJ1
Y3Qga3ZtX3ZjcHUgKnZjcHUpCit7CisJaW50IGVyciwgYWN0aW9uOworCisJZXJyID0ga3ZtaV9z
ZW5kX2V2ZW50KHZjcHUsIEtWTUlfRVZFTlRfWFNFVEJWLCBOVUxMLCAwLAorCQkJICAgICAgTlVM
TCwgMCwgJmFjdGlvbik7CisJaWYgKGVycikKKwkJcmV0dXJuIEtWTUlfRVZFTlRfQUNUSU9OX0NP
TlRJTlVFOworCisJcmV0dXJuIGFjdGlvbjsKK30KKworc3RhdGljIHZvaWQgX19rdm1pX3hzZXRi
dl9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCit7CisJdTMyIGFjdGlvbjsKKworCWFjdGlv
biA9IGt2bWlfc2VuZF94c2V0YnYodmNwdSk7CisJc3dpdGNoIChhY3Rpb24pIHsKKwljYXNlIEtW
TUlfRVZFTlRfQUNUSU9OX0NPTlRJTlVFOgorCQlicmVhazsKKwlkZWZhdWx0OgorCQlrdm1pX2hh
bmRsZV9jb21tb25fZXZlbnRfYWN0aW9ucyh2Y3B1LT5rdm0sIGFjdGlvbiwgIlhTRVRCViIpOwor
CX0KK30KKwordm9pZCBrdm1pX3hzZXRidl9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCit7
CisJc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pOworCisJa3ZtaSA9IGt2bWlfZ2V0KHZj
cHUtPmt2bSk7CisJaWYgKCFrdm1pKQorCQlyZXR1cm47CisKKwlpZiAoaXNfZXZlbnRfZW5hYmxl
ZCh2Y3B1LCBLVk1JX0VWRU5UX1hTRVRCVikpCisJCV9fa3ZtaV94c2V0YnZfZXZlbnQodmNwdSk7
CisKKwlrdm1pX3B1dCh2Y3B1LT5rdm0pOworfQpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmlydHVhbGl6
YXRpb25AbGlzdHMubGludXgtZm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51eGZvdW5k
YXRpb24ub3JnL21haWxtYW4vbGlzdGluZm8vdmlydHVhbGl6YXRpb24=
