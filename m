Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id C216E155DEC
	for <lists.virtualization@lfdr.de>; Fri,  7 Feb 2020 19:26:00 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 17B9386980;
	Fri,  7 Feb 2020 18:25:59 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id RU_XSg47H7aH; Fri,  7 Feb 2020 18:25:55 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 068EC86936;
	Fri,  7 Feb 2020 18:25:55 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id D37B2C013E;
	Fri,  7 Feb 2020 18:25:54 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 00F6BC013E
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:53 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by fraxinus.osuosl.org (Postfix) with ESMTP id E35B6868EF
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:52 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id UfbxU_uUBmE7
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:51 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by fraxinus.osuosl.org (Postfix) with ESMTPS id 8944F86914
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:25:51 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 02910305D353; Fri,  7 Feb 2020 20:16:41 +0200 (EET)
Received: from host.bbu.bitdefender.biz (unknown [195.210.4.22])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id E3DA9305206B;
 Fri,  7 Feb 2020 20:16:40 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [RFC PATCH v7 53/78] KVM: introspection: add KVMI_VCPU_CONTROL_EVENTS
Date: Fri,  7 Feb 2020 20:16:11 +0200
Message-Id: <20200207181636.1065-54-alazar@bitdefender.com>
In-Reply-To: <20200207181636.1065-1-alazar@bitdefender.com>
References: <20200207181636.1065-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 Sean Christopherson <sean.j.christopherson@intel.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBjb21tYW5k
IGVuYWJsZXMvZGlzYWJsZXMgdkNQVSBpbnRyb3NwZWN0aW9uIGV2ZW50cy4KClNpZ25lZC1vZmYt
Ynk6IE1paGFpIERvbsibdSA8bWRvbnR1QGJpdGRlZmVuZGVyLmNvbT4KQ28tZGV2ZWxvcGVkLWJ5
OiBBZGFsYmVydCBMYXrEg3IgPGFsYXphckBiaXRkZWZlbmRlci5jb20+ClNpZ25lZC1vZmYtYnk6
IEFkYWxiZXJ0IExhesSDciA8YWxhemFyQGJpdGRlZmVuZGVyLmNvbT4KLS0tCiBEb2N1bWVudGF0
aW9uL3ZpcnQva3ZtL2t2bWkucnN0ICAgICAgICAgICAgICAgfCA0NSArKysrKysrKystCiBpbmNs
dWRlL2xpbnV4L2t2bWlfaG9zdC5oICAgICAgICAgICAgICAgICAgICAgfCAgMiArCiBpbmNsdWRl
L3VhcGkvbGludXgva3ZtaS5oICAgICAgICAgICAgICAgICAgICAgfCAyOCArKysrLS0tCiAuLi4v
dGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyAgfCA4MiArKysrKysrKysr
KysrKysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyAgICAgICAgICAgICAgICAg
fCAxMyArKysKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCAgICAgICAgICAgICB8
ICAzICsKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYyAgICAgICAgICAgICB8IDUy
ICsrKysrKysrKy0tLQogNyBmaWxlcyBjaGFuZ2VkLCAyMDIgaW5zZXJ0aW9ucygrKSwgMjMgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdCBi
L0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKaW5kZXggOGJmOWI4ZjZkZDdjLi5jNDhh
YmM4ZjVjOTcgMTAwNjQ0Ci0tLSBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKKysr
IGIvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdApAQCAtNTA0LDEzICs1MDQsNTYgQEAg
VXNlICpLVk1JX1ZNX0NIRUNLX0VWRU5UKiBmaXJzdC4KICogLUtWTV9FQUdBSU4gLSB0aGUgc2Vs
ZWN0ZWQgdkNQVSBjYW4ndCBiZSBpbnRyb3NwZWN0ZWQgeWV0CiAqIC1LVk1fRUJVU1kgIC0gdGhl
IHNlbGVjdGVkIHZDUFUgaGFzIHRvbyBtYW55IHF1ZXVlZCAqS1ZNSV9FVkVOVF9QQVVTRV9WQ1BV
KiBldmVudHMKIAorMTAuIEtWTUlfVkNQVV9DT05UUk9MX0VWRU5UUworLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLQorCis6QXJjaGl0ZWN0dXJlczogYWxsCis6VmVyc2lvbnM6ID49IDEKKzpQ
YXJhbWV0ZXJzOgorCis6OgorCisJc3RydWN0IGt2bWlfdmNwdV9oZHI7CisJc3RydWN0IGt2bWlf
dmNwdV9jb250cm9sX2V2ZW50cyB7CisJCV9fdTE2IGV2ZW50X2lkOworCQlfX3U4IGVuYWJsZTsK
KwkJX191OCBwYWRkaW5nMTsKKwkJX191MzIgcGFkZGluZzI7CisJfTsKKworOlJldHVybnM6CisK
Kzo6CisKKwlzdHJ1Y3Qga3ZtaV9lcnJvcl9jb2RlCisKK0VuYWJsZXMvZGlzYWJsZXMgdkNQVSBp
bnRyb3NwZWN0aW9uIGV2ZW50cy4KKworV2hlbiBhbiBldmVudCBpcyBlbmFibGVkLCB0aGUgaW50
cm9zcGVjdGlvbiB0b29sIGlzIG5vdGlmaWVkIGFuZCBpdAorbXVzdCByZXBseSB3aXRoOiBjb250
aW51ZSwgcmV0cnksIGNyYXNoLCBldGMuIChzZWUgKipFdmVudHMqKiBiZWxvdykuCisKK1RoZSAq
S1ZNSV9FVkVOVF9QQVVTRV9WQ1BVKiBldmVudCBpcyBhbHdheXMgYWxsb3dlZCwKK2JlY2F1c2Ug
aXQgaXMgdHJpZ2dlcmVkIGJ5IHRoZSAqS1ZNSV9WQ1BVX1BBVVNFKiBjb21tYW5kLgorCitUaGUg
KktWTUlfRVZFTlRfVU5IT09LKiBldmVudCBpcyBjb250cm9sbGVkCitieSB0aGUgKktWTUlfVk1f
Q09OVFJPTF9FVkVOVFMqIGNvbW1hbmQuCisKKzpFcnJvcnM6CisKKyogLUtWTV9FSU5WQUwgLSB0
aGUgc2VsZWN0ZWQgdkNQVSBpcyBpbnZhbGlkCisqIC1LVk1fRUlOVkFMIC0gdGhlIGV2ZW50IElE
IGlzIGludmFsaWQvdW5rbm93biAodXNlICpLVk1JX1ZNX0NIRUNLX0VWRU5UKiBmaXJzdCkKKyog
LUtWTV9FSU5WQUwgLSBwYWRkaW5nIGlzIG5vdCB6ZXJvCisqIC1LVk1fRUFHQUlOIC0gdGhlIHNl
bGVjdGVkIHZDUFUgY2FuJ3QgYmUgaW50cm9zcGVjdGVkIHlldAorKiAtS1ZNX0VQRVJNIC0gdGhl
IGFjY2VzcyBpcyByZXN0cmljdGVkIGJ5IHRoZSBob3N0CisqIC1LVk1fRU9QTk9UU1VQUCAtIG9u
ZSB0aGUgZXZlbnRzIGNhbid0IGJlIGludGVyY2VwdGVkIGluIHRoZSBjdXJyZW50IHNldHVwCiAK
IEV2ZW50cwogPT09PT09CiAKIEFsbCBpbnRyb3NwZWN0aW9uIGV2ZW50cyAoVk0gb3IgdkNQVSBy
ZWxhdGVkKSBhcmUgc2VudAogdXNpbmcgdGhlICpLVk1JX0VWRU5UKiBtZXNzYWdlIGlkLiBObyBl
dmVudCB3aWxsIGJlIHNlbnQgdW5sZXNzCi1pdCBpcyBleHBsaWNpdGx5IGVuYWJsZWQgb3IgcmVx
dWVzdGVkIChlZy4gKktWTUlfRVZFTlRfUEFVU0VfVkNQVSopLgoraXQgaXMgZXhwbGljaXRseSBl
bmFibGVkIChzZWUgKktWTUlfVk1fQ09OVFJPTF9FVkVOVFMqIGFuZCAqS1ZNSV9WQ1BVX0NPTlRS
T0xfRVZFTlRTKikKK29yIHJlcXVlc3RlZCAoZWcuICpLVk1JX0VWRU5UX1BBVVNFX1ZDUFUqKS4K
IAogVGhlICpLVk1JX0VWRU5UX1VOSE9PSyogZXZlbnQgZG9lc24ndCBoYXZlIGEgcmVwbHkgYW5k
IHNoYXJlIHRoZSBrdm1pX2V2ZW50CiBzdHJ1Y3R1cmUsIGZvciBjb25zaXN0ZW5jeSB3aXRoIHRo
ZSB2Q1BVIGV2ZW50cy4KZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmggYi9p
bmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oCmluZGV4IDQ5ZTY4Nzc3YTM5MC4uZGE2MjFkODNjZDk0
IDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oCisrKyBiL2luY2x1ZGUvbGlu
dXgva3ZtaV9ob3N0LmgKQEAgLTM2LDYgKzM2LDggQEAgc3RydWN0IGt2bV92Y3B1X2ludHJvc3Bl
Y3Rpb24gewogCiAJc3RydWN0IGt2bWlfdmNwdV9yZXBseSByZXBseTsKIAlib29sIHdhaXRpbmdf
Zm9yX3JlcGx5OworCisJREVDTEFSRV9CSVRNQVAoZXZfbWFzaywgS1ZNSV9OVU1fRVZFTlRTKTsK
IH07CiAKIHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiB7CmRpZmYgLS1naXQgYS9pbmNsdWRlL3Vh
cGkvbGludXgva3ZtaS5oIGIvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWkuaAppbmRleCAyZWIxZTVi
MjBkNTMuLjc0NTUwM2ZiNzM3OCAxMDA2NDQKLS0tIGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWku
aAorKysgYi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oCkBAIC0xOCwxNiArMTgsMTcgQEAgZW51
bSB7CiAJS1ZNSV9FVkVOVF9SRVBMWSAgICAgICA9IDAsCiAJS1ZNSV9FVkVOVCAgICAgICAgICAg
ICA9IDEsCiAKLQlLVk1JX0dFVF9WRVJTSU9OICAgICAgID0gMiwKLQlLVk1JX1ZNX0NIRUNLX0NP
TU1BTkQgID0gMywKLQlLVk1JX1ZNX0NIRUNLX0VWRU5UICAgID0gNCwKLQlLVk1JX1ZNX0dFVF9J
TkZPICAgICAgID0gNSwKLQlLVk1JX1ZNX0NPTlRST0xfRVZFTlRTID0gNiwKLQlLVk1JX1ZNX1JF
QURfUEhZU0lDQUwgID0gNywKLQlLVk1JX1ZNX1dSSVRFX1BIWVNJQ0FMID0gOCwKLQotCUtWTUlf
VkNQVV9HRVRfSU5GTyAgICAgPSA5LAotCUtWTUlfVkNQVV9QQVVTRSAgICAgICAgPSAxMCwKKwlL
Vk1JX0dFVF9WRVJTSU9OICAgICAgICAgPSAyLAorCUtWTUlfVk1fQ0hFQ0tfQ09NTUFORCAgICA9
IDMsCisJS1ZNSV9WTV9DSEVDS19FVkVOVCAgICAgID0gNCwKKwlLVk1JX1ZNX0dFVF9JTkZPICAg
ICAgICAgPSA1LAorCUtWTUlfVk1fQ09OVFJPTF9FVkVOVFMgICA9IDYsCisJS1ZNSV9WTV9SRUFE
X1BIWVNJQ0FMICAgID0gNywKKwlLVk1JX1ZNX1dSSVRFX1BIWVNJQ0FMICAgPSA4LAorCisJS1ZN
SV9WQ1BVX0dFVF9JTkZPICAgICAgID0gOSwKKwlLVk1JX1ZDUFVfUEFVU0UgICAgICAgICAgPSAx
MCwKKwlLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMgPSAxMSwKIAogCUtWTUlfTlVNX01FU1NBR0VT
CiB9OwpAQCAtMTEzLDYgKzExNCwxMyBAQCBzdHJ1Y3Qga3ZtaV92Y3B1X3BhdXNlIHsKIAlfX3Uz
MiBwYWRkaW5nMzsKIH07CiAKK3N0cnVjdCBrdm1pX3ZjcHVfY29udHJvbF9ldmVudHMgeworCV9f
dTE2IGV2ZW50X2lkOworCV9fdTggZW5hYmxlOworCV9fdTggcGFkZGluZzE7CisJX191MzIgcGFk
ZGluZzI7Cit9OworCiBzdHJ1Y3Qga3ZtaV9ldmVudCB7CiAJX191MTYgc2l6ZTsKIAlfX3UxNiB2
Y3B1OwpkaWZmIC0tZ2l0IGEvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1p
X3Rlc3QuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMK
aW5kZXggMjdkZTVmYjI0NTgwLi44MzBiNjRjYWUyMGIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3Rlc3Rp
bmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKKysrIGIvdG9vbHMvdGVzdGluZy9z
ZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYwpAQCAtOTYsNiArOTYsMTEgQEAgc3RhdGlj
IHZvaWQgdG9nZ2xlX2V2ZW50X3Blcm1pc3Npb24oc3RydWN0IGt2bV92bSAqdm0sIF9fczMyIGlk
LCBib29sIGFsbG93KQogCQlpZCwgZXJybm8sIHN0cmVycm9yKGVycm5vKSk7CiB9CiAKK3N0YXRp
YyB2b2lkIGRpc2FsbG93X2V2ZW50KHN0cnVjdCBrdm1fdm0gKnZtLCBfX3MzMiBldmVudF9pZCkK
K3sKKwl0b2dnbGVfZXZlbnRfcGVybWlzc2lvbih2bSwgZXZlbnRfaWQsIGZhbHNlKTsKK30KKwog
c3RhdGljIHZvaWQgYWxsb3dfZXZlbnQoc3RydWN0IGt2bV92bSAqdm0sIF9fczMyIGV2ZW50X2lk
KQogewogCXRvZ2dsZV9ldmVudF9wZXJtaXNzaW9uKHZtLCBldmVudF9pZCwgdHJ1ZSk7CkBAIC03
MjIsNiArNzI3LDgyIEBAIHN0YXRpYyB2b2lkIHRlc3RfcGF1c2Uoc3RydWN0IGt2bV92bSAqdm0p
CiAJc3RvcF92Y3B1X3dvcmtlcih2Y3B1X3RocmVhZCwgJmRhdGEpOwogfQogCitzdGF0aWMgaW50
IGNtZF92Y3B1X2NvbnRyb2xfZXZlbnQoc3RydWN0IGt2bV92bSAqdm0sIF9fdTE2IGV2ZW50X2lk
LAorCQkJCSAgYm9vbCBlbmFibGUpCit7CisJc3RydWN0IHsKKwkJc3RydWN0IGt2bWlfbXNnX2hk
ciBoZHI7CisJCXN0cnVjdCBrdm1pX3ZjcHVfaGRyIHZjcHVfaGRyOworCQlzdHJ1Y3Qga3ZtaV92
Y3B1X2NvbnRyb2xfZXZlbnRzIGNtZDsKKwl9IHJlcSA9IHt9OworCisJcmVxLmNtZC5ldmVudF9p
ZCA9IGV2ZW50X2lkOworCXJlcS5jbWQuZW5hYmxlID0gZW5hYmxlID8gMSA6IDA7CisKKwlyZXR1
cm4gZG9fdmNwdTBfY29tbWFuZCh2bSwgS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTLAorCQkJCSZy
ZXEuaGRyLCBzaXplb2YocmVxKSwgTlVMTCwgMCk7Cit9CisKK3N0YXRpYyB2b2lkIGVuYWJsZV92
Y3B1X2V2ZW50KHN0cnVjdCBrdm1fdm0gKnZtLCBfX3UxNiBldmVudF9pZCkKK3sKKwlpbnQgcjsK
KworCXIgPSBjbWRfdmNwdV9jb250cm9sX2V2ZW50KHZtLCBldmVudF9pZCwgdHJ1ZSk7CisJVEVT
VF9BU1NFUlQociA9PSAwLAorCQkiS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTIGZhaWxlZCB0byBl
bmFibGUgdkNQVSBldmVudCAlZCwgZXJyb3IgJWQoJXMpXG4iLAorCQlldmVudF9pZCwgLXIsIGt2
bV9zdHJlcnJvcigtcikpOworfQorCitzdGF0aWMgdm9pZCBkaXNhYmxlX3ZjcHVfZXZlbnQoc3Ry
dWN0IGt2bV92bSAqdm0sIF9fdTE2IGV2ZW50X2lkKQoreworCWludCByOworCisJciA9IGNtZF92
Y3B1X2NvbnRyb2xfZXZlbnQodm0sIGV2ZW50X2lkLCBmYWxzZSk7CisJVEVTVF9BU1NFUlQociA9
PSAwLAorCQkiS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTIGZhaWxlZCB0byBkaXNhYmxlIHZDUFUg
ZXZlbnQgJWQsIGVycm9yICVkKCVzKVxuIiwKKwkJZXZlbnRfaWQsIC1yLCBrdm1fc3RyZXJyb3Io
LXIpKTsKK30KKworc3RhdGljIHZvaWQgdGVzdF9kaXNhbGxvd2VkX3ZjcHVfZXZlbnQoc3RydWN0
IGt2bV92bSAqdm0sIF9fdTE2IGV2ZW50X2lkKQoreworCWJvb2wgZW5hYmxlID0gdHJ1ZTsKKwlp
bnQgcjsKKworCWRpc2FsbG93X2V2ZW50KHZtLCBldmVudF9pZCk7CisKKwlyID0gY21kX3ZjcHVf
Y29udHJvbF9ldmVudCh2bSwgZXZlbnRfaWQsIGVuYWJsZSk7CisJVEVTVF9BU1NFUlQociA9PSAt
S1ZNX0VQRVJNLAorCQkiS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTIGRpZG4ndCBmYWlsZWQgd2l0
aCBLVk1fRVBFUk0sIGlkICVkLCBlcnJvciAlZCAoJXMpXG4iLAorCQlldmVudF9pZCwgLXIsIGt2
bV9zdHJlcnJvcigtcikpOworCisJYWxsb3dfZXZlbnQodm0sIGV2ZW50X2lkKTsKK30KKworc3Rh
dGljIHZvaWQgdGVzdF9pbnZhbGlkX3ZjcHVfZXZlbnQoc3RydWN0IGt2bV92bSAqdm0sIF9fdTE2
IGV2ZW50X2lkKQoreworCWJvb2wgZW5hYmxlID0gdHJ1ZTsKKwlpbnQgcjsKKworCXIgPSBjbWRf
dmNwdV9jb250cm9sX2V2ZW50KHZtLCBldmVudF9pZCwgZW5hYmxlKTsKKwlURVNUX0FTU0VSVChy
ID09IC1LVk1fRUlOVkFMLAorCQkiY21kX3ZjcHVfY29udHJvbF9ldmVudCBkaWRuJ3QgZmFpbGVk
IHdpdGggS1ZNX0VJTlZBTCwgaWQgJWQsIGVycm9yICVkICglcylcbiIsCisJCWV2ZW50X2lkLCAt
ciwga3ZtX3N0cmVycm9yKC1yKSk7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3RfY21kX3ZjcHVfY29u
dHJvbF9ldmVudHMoc3RydWN0IGt2bV92bSAqdm0pCit7CisJX191MTYgdmFsaWRfaWQgPSBLVk1J
X0VWRU5UX1BBVVNFX1ZDUFU7CisJX191MTYgaW52YWxpZF9pZCA9IDB4ZmZmZjsKKworCXRlc3Rf
ZGlzYWxsb3dlZF92Y3B1X2V2ZW50KHZtLCB2YWxpZF9pZCk7CisKKwllbmFibGVfdmNwdV9ldmVu
dCh2bSwgdmFsaWRfaWQpOworCisJZGlzYWJsZV92Y3B1X2V2ZW50KHZtLCB2YWxpZF9pZCk7CisK
Kwl0ZXN0X2ludmFsaWRfdmNwdV9ldmVudCh2bSwgaW52YWxpZF9pZCk7Cit9CisKIHN0YXRpYyB2
b2lkIHRlc3RfaW50cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkKIHsKIAlzZXR1cF9zb2Nr
ZXQoKTsKQEAgLTczNyw2ICs4MTgsNyBAQCBzdGF0aWMgdm9pZCB0ZXN0X2ludHJvc3BlY3Rpb24o
c3RydWN0IGt2bV92bSAqdm0pCiAJdGVzdF9tZW1vcnlfYWNjZXNzKHZtKTsKIAl0ZXN0X2NtZF9n
ZXRfdmNwdV9pbmZvKHZtKTsKIAl0ZXN0X3BhdXNlKHZtKTsKKwl0ZXN0X2NtZF92Y3B1X2NvbnRy
b2xfZXZlbnRzKHZtKTsKIAogCXVuaG9va19pbnRyb3NwZWN0aW9uKHZtKTsKIH0KZGlmZiAtLWdp
dCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jIGIvdmlydC9rdm0vaW50cm9zcGVjdGlv
bi9rdm1pLmMKaW5kZXggNjcwYzE0Yzk2ODNmLi5mNGZmOTk2OGJkNTggMTAwNjQ0Ci0tLSBhL3Zp
cnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaS5jCisrKyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24v
a3ZtaS5jCkBAIC01NDUsNiArNTQ1LDE5IEBAIGludCBrdm1pX2NtZF92bV9jb250cm9sX2V2ZW50
cyhzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKmt2bWksCiAJcmV0dXJuIDA7CiB9CiAKK2ludCBr
dm1pX2NtZF92Y3B1X2NvbnRyb2xfZXZlbnRzKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKKwkJCQkg
dW5zaWduZWQgaW50IGV2ZW50X2lkLCBib29sIGVuYWJsZSkKK3sKKwlzdHJ1Y3Qga3ZtX3ZjcHVf
aW50cm9zcGVjdGlvbiAqdmNwdWkgPSBWQ1BVSSh2Y3B1KTsKKworCWlmIChlbmFibGUpCisJCXNl
dF9iaXQoZXZlbnRfaWQsIHZjcHVpLT5ldl9tYXNrKTsKKwllbHNlCisJCWNsZWFyX2JpdChldmVu
dF9pZCwgdmNwdWktPmV2X21hc2spOworCisJcmV0dXJuIDA7Cit9CisKIHVuc2lnbmVkIGxvbmcg
Z2ZuX3RvX2h2YV9zYWZlKHN0cnVjdCBrdm0gKmt2bSwgZ2ZuX3QgZ2ZuKQogewogCXVuc2lnbmVk
IGxvbmcgaHZhOwpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5o
IGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCmluZGV4IDUwYjJiOThkZDk5Yi4u
ZmU1OTY5NmIwODI2IDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50
LmgKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCkBAIC0zNyw2ICszNyw3
IEBACiAJCQl8IEJJVChLVk1JX1ZNX1dSSVRFX1BIWVNJQ0FMKSBcCiAJCQl8IEJJVChLVk1JX1ZD
UFVfR0VUX0lORk8pIFwKIAkJCXwgQklUKEtWTUlfVkNQVV9QQVVTRSkgXAorCQkJfCBCSVQoS1ZN
SV9WQ1BVX0NPTlRST0xfRVZFTlRTKSBcCiAJCSkKIAogI2RlZmluZSBLVk1JKGt2bSkgKChzdHJ1
Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKikoKGt2bSktPmt2bWkpKQpAQCAtNjYsNiArNjcsOCBAQCBp
bnQga3ZtaV9hZGRfam9iKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKIHZvaWQga3ZtaV9ydW5fam9i
cyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpOwogaW50IGt2bWlfY21kX3ZtX2NvbnRyb2xfZXZlbnRz
KHN0cnVjdCBrdm1faW50cm9zcGVjdGlvbiAqa3ZtaSwKIAkJCQl1bnNpZ25lZCBpbnQgZXZlbnRf
aWQsIGJvb2wgZW5hYmxlKTsKK2ludCBrdm1pX2NtZF92Y3B1X2NvbnRyb2xfZXZlbnRzKHN0cnVj
dCBrdm1fdmNwdSAqdmNwdSwKKwkJCQkgdW5zaWduZWQgaW50IGV2ZW50X2lkLCBib29sIGVuYWJs
ZSk7CiBpbnQga3ZtaV9jbWRfcmVhZF9waHlzaWNhbChzdHJ1Y3Qga3ZtICprdm0sIHU2NCBncGEs
IHU2NCBzaXplLAogCQkJICAgaW50ICgqc2VuZCkoc3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICos
CiAJCQkJCWNvbnN0IHN0cnVjdCBrdm1pX21zZ19oZHIqLApkaWZmIC0tZ2l0IGEvdmlydC9rdm0v
aW50cm9zcGVjdGlvbi9rdm1pX21zZy5jIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21z
Zy5jCmluZGV4IDY5YWJjYTk5OWNkMi4uMTk5NWE2M2Y0ZTk5IDEwMDY0NAotLS0gYS92aXJ0L2t2
bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9r
dm1pX21zZy5jCkBAIC0xNywxNiArMTcsMTcgQEAgc3RydWN0IGt2bWlfdmNwdV9jbWRfam9iIHsK
IH07CiAKIHN0YXRpYyBjb25zdCBjaGFyICpjb25zdCBtc2dfSURzW10gPSB7Ci0JW0tWTUlfRVZF
TlRfUkVQTFldICAgICAgID0gIktWTUlfRVZFTlRfUkVQTFkiLAotCVtLVk1JX0dFVF9WRVJTSU9O
XSAgICAgICA9ICJLVk1JX0dFVF9WRVJTSU9OIiwKLQlbS1ZNSV9WTV9DSEVDS19DT01NQU5EXSAg
PSAiS1ZNSV9WTV9DSEVDS19DT01NQU5EIiwKLQlbS1ZNSV9WTV9DSEVDS19FVkVOVF0gICAgPSAi
S1ZNSV9WTV9DSEVDS19FVkVOVCIsCi0JW0tWTUlfVk1fQ09OVFJPTF9FVkVOVFNdID0gIktWTUlf
Vk1fQ09OVFJPTF9FVkVOVFMiLAotCVtLVk1JX1ZNX0dFVF9JTkZPXSAgICAgICA9ICJLVk1JX1ZN
X0dFVF9JTkZPIiwKLQlbS1ZNSV9WTV9SRUFEX1BIWVNJQ0FMXSAgPSAiS1ZNSV9WTV9SRUFEX1BI
WVNJQ0FMIiwKLQlbS1ZNSV9WTV9XUklURV9QSFlTSUNBTF0gPSAiS1ZNSV9WTV9XUklURV9QSFlT
SUNBTCIsCi0JW0tWTUlfVkNQVV9HRVRfSU5GT10gICAgID0gIktWTUlfVkNQVV9HRVRfSU5GTyIs
Ci0JW0tWTUlfVkNQVV9QQVVTRV0gICAgICAgID0gIktWTUlfVkNQVV9QQVVTRSIsCisJW0tWTUlf
RVZFTlRfUkVQTFldICAgICAgICAgPSAiS1ZNSV9FVkVOVF9SRVBMWSIsCisJW0tWTUlfR0VUX1ZF
UlNJT05dICAgICAgICAgPSAiS1ZNSV9HRVRfVkVSU0lPTiIsCisJW0tWTUlfVk1fQ0hFQ0tfQ09N
TUFORF0gICAgPSAiS1ZNSV9WTV9DSEVDS19DT01NQU5EIiwKKwlbS1ZNSV9WTV9DSEVDS19FVkVO
VF0gICAgICA9ICJLVk1JX1ZNX0NIRUNLX0VWRU5UIiwKKwlbS1ZNSV9WTV9DT05UUk9MX0VWRU5U
U10gICA9ICJLVk1JX1ZNX0NPTlRST0xfRVZFTlRTIiwKKwlbS1ZNSV9WTV9HRVRfSU5GT10gICAg
ICAgICA9ICJLVk1JX1ZNX0dFVF9JTkZPIiwKKwlbS1ZNSV9WTV9SRUFEX1BIWVNJQ0FMXSAgICA9
ICJLVk1JX1ZNX1JFQURfUEhZU0lDQUwiLAorCVtLVk1JX1ZNX1dSSVRFX1BIWVNJQ0FMXSAgID0g
IktWTUlfVk1fV1JJVEVfUEhZU0lDQUwiLAorCVtLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFNdID0g
IktWTUlfVkNQVV9DT05UUk9MX0VWRU5UUyIsCisJW0tWTUlfVkNQVV9HRVRfSU5GT10gICAgICAg
PSAiS1ZNSV9WQ1BVX0dFVF9JTkZPIiwKKwlbS1ZNSV9WQ1BVX1BBVVNFXSAgICAgICAgICA9ICJL
Vk1JX1ZDUFVfUEFVU0UiLAogfTsKIAogc3RhdGljIGJvb2wgaXNfa25vd25fbWVzc2FnZSh1MTYg
aWQpCkBAIC00MDcsNiArNDA4LDMyIEBAIHN0YXRpYyBpbnQgaGFuZGxlX2V2ZW50X3JlcGx5KGNv
bnN0IHN0cnVjdCBrdm1pX3ZjcHVfY21kX2pvYiAqam9iLAogCXJldHVybiBleHBlY3RlZC0+ZXJy
b3I7CiB9CiAKK3N0YXRpYyBpbnQgaGFuZGxlX3ZjcHVfY29udHJvbF9ldmVudHMoY29uc3Qgc3Ry
dWN0IGt2bWlfdmNwdV9jbWRfam9iICpqb2IsCisJCQkJICAgICAgY29uc3Qgc3RydWN0IGt2bWlf
bXNnX2hkciAqbXNnLAorCQkJCSAgICAgIGNvbnN0IHZvaWQgKl9yZXEpCit7CisJc3RydWN0IGt2
bV9pbnRyb3NwZWN0aW9uICprdm1pID0gS1ZNSShqb2ItPnZjcHUtPmt2bSk7CisJY29uc3Qgc3Ry
dWN0IGt2bWlfdmNwdV9jb250cm9sX2V2ZW50cyAqcmVxID0gX3JlcTsKKwlERUNMQVJFX0JJVE1B
UChrbm93bl9ldmVudHMsIEtWTUlfTlVNX0VWRU5UUyk7CisJaW50IGVjOworCisJYml0bWFwX2Zy
b21fdTY0KGtub3duX2V2ZW50cywgS1ZNSV9LTk9XTl9WQ1BVX0VWRU5UUyk7CisKKwlpZiAocmVx
LT5wYWRkaW5nMSB8fCByZXEtPnBhZGRpbmcyKQorCQllYyA9IC1LVk1fRUlOVkFMOworCWVsc2Ug
aWYgKHJlcS0+ZXZlbnRfaWQgPj0gS1ZNSV9OVU1fRVZFTlRTKQorCQllYyA9IC1LVk1fRUlOVkFM
OworCWVsc2UgaWYgKCF0ZXN0X2JpdChyZXEtPmV2ZW50X2lkLCBrbm93bl9ldmVudHMpKQorCQll
YyA9IC1LVk1fRUlOVkFMOworCWVsc2UgaWYgKCFpc19ldmVudF9hbGxvd2VkKGt2bWksIHJlcS0+
ZXZlbnRfaWQpKQorCQllYyA9IC1LVk1fRVBFUk07CisJZWxzZQorCQllYyA9IGt2bWlfY21kX3Zj
cHVfY29udHJvbF9ldmVudHMoam9iLT52Y3B1LCByZXEtPmV2ZW50X2lkLAorCQkJCQkJICByZXEt
PmVuYWJsZSk7CisKKwlyZXR1cm4ga3ZtaV9tc2dfdmNwdV9yZXBseShqb2IsIG1zZywgZWMsIE5V
TEwsIDApOworfQorCiAvKgogICogVGhlc2UgY29tbWFuZHMgYXJlIGV4ZWN1dGVkIG9uIHRoZSB2
Q1BVIHRocmVhZC4gVGhlIHJlY2VpdmluZyB0aHJlYWQKICAqIHBhc3NlcyB0aGUgbWVzc2FnZXMg
dXNpbmcgYSBuZXdseSBhbGxvY2F0ZWQgJ3N0cnVjdCBrdm1pX3ZjcHVfY21kX2pvYicKQEAgLTQx
NSw4ICs0NDIsOSBAQCBzdGF0aWMgaW50IGhhbmRsZV9ldmVudF9yZXBseShjb25zdCBzdHJ1Y3Qg
a3ZtaV92Y3B1X2NtZF9qb2IgKmpvYiwKICAqLwogc3RhdGljIGludCgqY29uc3QgbXNnX3ZjcHVb
XSkoY29uc3Qgc3RydWN0IGt2bWlfdmNwdV9jbWRfam9iICosCiAJCQkgICAgICBjb25zdCBzdHJ1
Y3Qga3ZtaV9tc2dfaGRyICosIGNvbnN0IHZvaWQgKikgPSB7Ci0JW0tWTUlfRVZFTlRfUkVQTFld
ICAgPSBoYW5kbGVfZXZlbnRfcmVwbHksCi0JW0tWTUlfVkNQVV9HRVRfSU5GT10gPSBoYW5kbGVf
Z2V0X3ZjcHVfaW5mbywKKwlbS1ZNSV9FVkVOVF9SRVBMWV0gICAgICAgICA9IGhhbmRsZV9ldmVu
dF9yZXBseSwKKwlbS1ZNSV9WQ1BVX0NPTlRST0xfRVZFTlRTXSA9IGhhbmRsZV92Y3B1X2NvbnRy
b2xfZXZlbnRzLAorCVtLVk1JX1ZDUFVfR0VUX0lORk9dICAgICAgID0gaGFuZGxlX2dldF92Y3B1
X2luZm8sCiB9OwogCiBzdGF0aWMgdm9pZCBrdm1pX2pvYl92Y3B1X2NtZChzdHJ1Y3Qga3ZtX3Zj
cHUgKnZjcHUsIHZvaWQgKmN0eCkKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZpcnR1YWxpemF0aW9uQGxp
c3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGludXhmb3VuZGF0aW9uLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
