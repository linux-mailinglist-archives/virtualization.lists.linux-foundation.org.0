Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp3.osuosl.org (smtp3.osuosl.org [IPv6:2605:bc80:3010::136])
	by mail.lfdr.de (Postfix) with ESMTPS id 19D7D6F9E72
	for <lists.virtualization@lfdr.de>; Mon,  8 May 2023 05:57:27 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp3.osuosl.org (Postfix) with ESMTP id 03EEB60F10;
	Mon,  8 May 2023 03:57:24 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp3.osuosl.org 03EEB60F10
Authentication-Results: smtp3.osuosl.org;
	dkim=fail reason="signature verification failed" (1024-bit key) header.d=redhat.com header.i=@redhat.com header.a=rsa-sha256 header.s=mimecast20190719 header.b=DgcD4U/k
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp3.osuosl.org ([127.0.0.1])
	by localhost (smtp3.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id RUY30XWjAr2G; Mon,  8 May 2023 03:57:21 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp3.osuosl.org (Postfix) with ESMTPS id B993260E63;
	Mon,  8 May 2023 03:57:20 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp3.osuosl.org B993260E63
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id E3147C008A;
	Mon,  8 May 2023 03:57:19 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp2.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by lists.linuxfoundation.org (Postfix) with ESMTP id BBE0DC002A
 for <virtualization@lists.linux-foundation.org>;
 Mon,  8 May 2023 03:57:18 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp2.osuosl.org (Postfix) with ESMTP id 820D440150
 for <virtualization@lists.linux-foundation.org>;
 Mon,  8 May 2023 03:57:18 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org 820D440150
Authentication-Results: smtp2.osuosl.org;
 dkim=pass (1024-bit key) header.d=redhat.com header.i=@redhat.com
 header.a=rsa-sha256 header.s=mimecast20190719 header.b=DgcD4U/k
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
 by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id psRk2-g1Aj1c
 for <virtualization@lists.linux-foundation.org>;
 Mon,  8 May 2023 03:57:17 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp2.osuosl.org E4A24400AB
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.133.124])
 by smtp2.osuosl.org (Postfix) with ESMTPS id E4A24400AB
 for <virtualization@lists.linux-foundation.org>;
 Mon,  8 May 2023 03:57:16 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1683518235;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=i91vpv5xI9eOoiC7RRdi6WyfJZYJucuHqIMPJTLnImA=;
 b=DgcD4U/kffSFos8uzqS2CL8if/uqcgQDth+xpR7MfS1FkX8betTHvdVbdkBEgZ3Np6FzHH
 NRVx9pC+oNT4yJBsJSBgn2lq1aFnco6ODCcKQv4s9FVyPR3+DwIRi843A3yZP9OoprgWeX
 30oDX09VB2TrwEemdpX/SUsjwVbx7G0=
Received: from mail-lj1-f200.google.com (mail-lj1-f200.google.com
 [209.85.208.200]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384) id
 us-mta-246-h0vX8E0SMeKzE5xGQ4b7Zw-1; Sun, 07 May 2023 23:57:13 -0400
X-MC-Unique: h0vX8E0SMeKzE5xGQ4b7Zw-1
Received: by mail-lj1-f200.google.com with SMTP id
 38308e7fff4ca-2ac7e062911so19480121fa.2
 for <virtualization@lists.linux-foundation.org>;
 Sun, 07 May 2023 20:57:13 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20221208; t=1683518232; x=1686110232;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
 :subject:date:message-id:reply-to;
 bh=i91vpv5xI9eOoiC7RRdi6WyfJZYJucuHqIMPJTLnImA=;
 b=jF32pHsVjZGZe8WFxaGeyx1YL0QqWrwq9ux4I9E2syKGjbUqJvFjasbj82sqeW8TtC
 NEqpkndXiBxBp/mgrbWl+mM5H3MThETiZ26FpoZF6urfmJUSmwdCaSw44KLif+WLB81v
 ktdV3yoG79C47daLV8CJ7Jcfa4UTsAvbxydXplFoBgdv3aTAnEICHsEkDLAprgzlF72X
 yaT6eo2st0TQIAlk3MTzspFBA3sMVynHHOReUkL0m2ytvw45TZ8xvKTjnNYjQptjZC29
 ap6eNEGP3VlGsSQ+qqfna4FQn9PsOSvBN5Ydadhnr6iI0ZXjklJLecRKck/2HJWrFWD8
 ZO4w==
X-Gm-Message-State: AC+VfDxcJBIh8OsPQXgRsubf8fX90ODUbmKaBtChUc78pdKBt7hcKDNw
 x7acMfkj2sET5HOiXXav0REBCnv7efQlWPAYP5AmBm8CoLI2HyP539ZJ1dQHK0ZyVZhCCqSyDhN
 QvC5uIilURrp1ML3UPhrtEn7cPcW35s4vqup+aqJlP1GcsE10MvR5dQ4Wlg==
X-Received: by 2002:a2e:a3d7:0:b0:2a7:6e2e:20e0 with SMTP id
 w23-20020a2ea3d7000000b002a76e2e20e0mr2358986lje.7.1683518232250; 
 Sun, 07 May 2023 20:57:12 -0700 (PDT)
X-Google-Smtp-Source: ACHHUZ5u93lIq7NaRxNHzxCXrGIqso8w+PBjqeamQ31AANjgSg0MuDhWLywZFKK4cjWi4nwTnqWmmQ3Hg5Sm1/42Vmg=
X-Received: by 2002:a2e:a3d7:0:b0:2a7:6e2e:20e0 with SMTP id
 w23-20020a2ea3d7000000b002a76e2e20e0mr2358978lje.7.1683518231831; Sun, 07 May
 2023 20:57:11 -0700 (PDT)
MIME-Version: 1.0
References: <20230427104428.862643-1-mie@igel.co.jp>
 <20230427104428.862643-2-mie@igel.co.jp>
In-Reply-To: <20230427104428.862643-2-mie@igel.co.jp>
From: Jason Wang <jasowang@redhat.com>
Date: Mon, 8 May 2023 11:57:00 +0800
Message-ID: <CACGkMEsuyHAg=iq_w=jOyjbx5YK2GDF_=RCX-ncqDvEiVMu+Jg@mail.gmail.com>
Subject: Re: [RFC PATCH v2 1/3] PCI: endpoint: introduce a helper to implement
 pci ep virtio function
To: Shunsuke Mie <mie@igel.co.jp>
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Cc: Kishon Vijay Abraham I <kishon@kernel.org>,
 =?UTF-8?Q?Krzysztof_Wilczy=C5=84ski?= <kw@linux.com>,
 Randy Dunlap <rdunlap@infradead.org>, "Michael S. Tsirkin" <mst@redhat.com>,
 linux-pci@vger.kernel.org, Lorenzo Pieralisi <lpieralisi@kernel.org>,
 Manivannan Sadhasivam <mani@kernel.org>, Frank Li <Frank.Li@nxp.com>,
 linux-kernel@vger.kernel.org, virtualization@lists.linux-foundation.org,
 Ren Zhijie <renzhijie2@huawei.com>, Jon Mason <jdmason@kudzu.us>,
 Bjorn Helgaas <bhelgaas@google.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gVGh1LCBBcHIgMjcsIDIwMjMgYXQgNjo0NOKAr1BNIFNodW5zdWtlIE1pZSA8bWllQGlnZWwu
Y28uanA+IHdyb3RlOgo+Cj4gVGhlIExpbnV4IFBDSWUgRW5kcG9pbnQgZnJhbWV3b3JrIHN1cHBv
cnRzIHRvIGltcGxlbWVudCBQQ0llIGVuZHBvaW50Cj4gZnVuY3Rpb25zIHVzaW5nIGEgUENJZSBj
b250cm9sbGVyIG9wZXJhdGluZyBpbiBlbmRwb2ludCBtb2RlLgo+IEl0IGlzIHBvc3NibGUgdG8g
cmVhbGl6ZSB0aGUgYmVoYXZpb3Igb2YgUENJZSBkZXZpY2UsIHN1Y2ggYXMgdmlydGlvIFBDSQo+
IGRldmljZS4gVGhpcyBwYXRjaCBpbnRyb2R1Y2VzIGEgc2V0b2YgaGVscGVyIGZ1bmN0aW9ucyBh
bmQgZGF0YSBzdHJ1Y3R1cmVzCj4gdG8gaW1wbGVtZW50IGEgUENJZSBlbmRwb2ludCBmdW5jdGlv
biB0aGF0IGJlaGF2ZXMgYXMgYSB2aXJ0aW8gZGV2aWNlLgo+Cj4gVGhvc2UgZnVuY3Rpb25zIGVu
YWJsZSB0aGUgaW1wbGVtZW50YXRpb24gUENJZSBlbmRwb2ludCBmdW5jdGlvbiB0aGF0Cj4gY29t
cGx5IHdpdGggdGhlIHZpcnRpbyBsZWNhY3kgc3BlY2lmaWNhdGlvbi4gQmVjYXVzZSBtb2Rlcm4g
dmlydGlvCj4gc3BlY2lmaWNhdGlvbnMgcmVxdWlyZSBkZXZpY2VzIHRvIGltcGxlbWVudCBjdXN0
b20gUENJZSBjYXBhYmlsaXRpZXMsIHdoaWNoCj4gYXJlIG5vdCBjdXJyZW50bHkgc3VwcG9ydGVk
IGJ5IGVpdGhlciBQQ0llIGNvbnRyb2xsZXJzL2RyaXZlcnMgb3IgdGhlIFBDSWUKPiBlbmRwb2lu
dCBmcmFtZXdvcmsuCj4KPiBUaGUgaGVscGVyIGZ1bmN0aW9ucyB3b3JrIHdpdGggdGhlIG5ldyBz
dHJ1Y3QgZXBmX3ZpcnRpbywgd2hpY2ggaXMKPiBpbml0aWFsaXplZCBhbmQgZmluYWxpemVkIHVz
aW5nIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb25zOgo+Cj4gLSBpbnQgZXBmX3ZpcnRpb19pbml0KCk7
Cj4gLSB2b2lkIGVwZl92aXJ0aW9fZmluYWwoKQo+Cj4gT25jZSBpbml0aWFsaXplZCwgdGhlIFBD
SWUgY29uZmlndXJhdGlvbiBzcGFjZSBjYW4gYmUgcmVhZCBhbmQgd3JpdHRlbgo+IHVzaW5nIHRo
ZSBmb2xsb3dpbmcgZnVuY3Rpb25zOgo+Cj4gLSBlcGZfdmlydGlvX2NmZ197cmVhZCx3cml0ZX0j
c2l6ZSgpCj4gLSBlcGZfdmlydGlvX2NmZ197c2V0LGNsZWFyfSNzaXplKCkKPiAtIGVwZl92aXJ0
aW9fY2ZnX21lbWNweV90b2lvKCkKPgo+IFRoZSBzaXplIGlzIHN1cHBvcnRlZCA4LCAxNiBhbmQg
MzJiaXRzLiBUaGUgY29udGVudCBvZiBjb25maWd1cmF0aW9uIHNwYWNlCj4gdmFyaWVzIGRlcGVu
ZGluZyBvbiB0aGUgdHlwZSBvZiB2aXJ0aW8gZGV2aWNlLgo+Cj4gQWZ0ZXIgdGhlIHNldHVwLCBs
YXVuY2ggdGhlIGtlcm5lbCB0aHJlYWQgZm9yIG5lZ290aWF0aW9uIHdpdGggaG9zdCB2aXJ0aW8K
PiBkcml2ZXJzIGFuZCBkZXRlY3Rpb24gdmlydHF1ZXVlIG5vdGlmaWNhdGlvbnMgd2l0aCB0aGUg
ZnVuY3Rpb246Cj4KPiAtIGVwZl92aXJ0aW9fbGF1bmNoX2JndGFzaygpCj4KPiBBbHNvIHRoZXJl
IGFyZSBmdW5jdGlvbnMgdG8gc2h1dGRvd24gYW5kIHJlc2V0IHRoZSBrdGhyZWFkLgo+Cj4gLSBl
cGZfdmlydGlvX3Rlcm1pbmF0ZV9iZ3Rhc2soKQo+IC0gZXBmX3ZpcnRpb190ZXJtaW5hdGVfcmVz
ZXQoKQo+Cj4gRGF0YSB0cmFuc2ZlciBmdW5jdGlvbiBpcyBhbHNvIHByb3ZpZGUuCj4KPiAtIGVw
Zl92aXJ0aW9fbWVtY3B5X2tpb3Yya2lvdigpCj4KPiBXaGlsZSB0aGlzIHBhdGNoIHByb3ZpZGVz
IGZ1bmN0aW9ucyBmb3IgbmVnb3RpYXRpbmcgd2l0aCBob3N0IGRyaXZlcnMgYW5kCj4gY29weWlu
ZyBkYXRhLCBlYWNoIFBDSWUgZnVuY3Rpb24gZHJpdmVyIG11c3QgaW1wbCBlbWVudCBvcGVyYXRp
b25zIHRoYXQKPiBkZXBlbmQgb24gZWFjaCBzcGVjaWZpYyBkZXZpY2UsIHN1Y2ggYXMgbmV0d29y
aywgYmxvY2ssIGV0Yy4KPgo+IFNpZ25lZC1vZmYtYnk6IFNodW5zdWtlIE1pZSA8bWllQGlnZWwu
Y28uanA+Cj4gLS0tCj4KPiBDaGFuZ2VzIGZyb20gdjI6Cj4gLSBJbXByb3ZlIHRoZSBtZW1jcHkg
ZnVuY3Rpb24gYmV0d2VlbiBraW92IGFuZCBraW92IG9uIGxvY2FsIHJhbSBhbmQKPiByZW1vdGUg
cmFtIHZpYSBwY2llIGJ1cy4KPgo+ICBkcml2ZXJzL3BjaS9lbmRwb2ludC9mdW5jdGlvbnMvS2Nv
bmZpZyAgICAgICAgfCAgIDcgKwo+ICBkcml2ZXJzL3BjaS9lbmRwb2ludC9mdW5jdGlvbnMvTWFr
ZWZpbGUgICAgICAgfCAgIDEgKwo+ICAuLi4vcGNpL2VuZHBvaW50L2Z1bmN0aW9ucy9wY2ktZXBm
LXZpcnRpby5jICAgfCA0NTggKysrKysrKysrKysrKysrKysrCj4gIC4uLi9wY2kvZW5kcG9pbnQv
ZnVuY3Rpb25zL3BjaS1lcGYtdmlydGlvLmggICB8IDEyNiArKysrKwo+ICA0IGZpbGVzIGNoYW5n
ZWQsIDU5MiBpbnNlcnRpb25zKCspCj4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3BjaS9l
bmRwb2ludC9mdW5jdGlvbnMvcGNpLWVwZi12aXJ0aW8uYwo+ICBjcmVhdGUgbW9kZSAxMDA2NDQg
ZHJpdmVycy9wY2kvZW5kcG9pbnQvZnVuY3Rpb25zL3BjaS1lcGYtdmlydGlvLmgKPgo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL3BjaS9lbmRwb2ludC9mdW5jdGlvbnMvS2NvbmZpZyBiL2RyaXZlcnMv
cGNpL2VuZHBvaW50L2Z1bmN0aW9ucy9LY29uZmlnCj4gaW5kZXggOWZkNTYwODg2ODcxLi5mYTFh
NmE1NjlhOGYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9wY2kvZW5kcG9pbnQvZnVuY3Rpb25zL0tj
b25maWcKPiArKysgYi9kcml2ZXJzL3BjaS9lbmRwb2ludC9mdW5jdGlvbnMvS2NvbmZpZwo+IEBA
IC0zNywzICszNywxMCBAQCBjb25maWcgUENJX0VQRl9WTlRCCj4gICAgICAgICAgIGJldHdlZW4g
UENJIFJvb3QgUG9ydCBhbmQgUENJZSBFbmRwb2ludC4KPgo+ICAgICAgICAgICBJZiBpbiBkb3Vi
dCwgc2F5ICJOIiB0byBkaXNhYmxlIEVuZHBvaW50IE5UQiBkcml2ZXIuCj4gKwo+ICtjb25maWcg
UENJX0VQRl9WSVJUSU8KPiArICAgICAgIHRyaXN0YXRlCj4gKyAgICAgICBkZXBlbmRzIG9uIFBD
SV9FTkRQT0lOVAo+ICsgICAgICAgc2VsZWN0IFZIT1NUX1JJTkdfSU9NRU0KPiArICAgICAgIGhl
bHAKPiArICAgICAgICAgSGVscGVycyB0byBpbXBsZW1lbnQgUENJIHZpcnRpbyBFbmRwb2ludCBm
dW5jdGlvbgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3BjaS9lbmRwb2ludC9mdW5jdGlvbnMvTWFr
ZWZpbGUgYi9kcml2ZXJzL3BjaS9lbmRwb2ludC9mdW5jdGlvbnMvTWFrZWZpbGUKPiBpbmRleCA1
YzEzMDAxZGVhYmEuLmE5NmYxMjdjZTkwMCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL3BjaS9lbmRw
b2ludC9mdW5jdGlvbnMvTWFrZWZpbGUKPiArKysgYi9kcml2ZXJzL3BjaS9lbmRwb2ludC9mdW5j
dGlvbnMvTWFrZWZpbGUKPiBAQCAtNiwzICs2LDQgQEAKPiAgb2JqLSQoQ09ORklHX1BDSV9FUEZf
VEVTVCkgICAgICAgICAgICAgKz0gcGNpLWVwZi10ZXN0Lm8KPiAgb2JqLSQoQ09ORklHX1BDSV9F
UEZfTlRCKSAgICAgICAgICAgICAgKz0gcGNpLWVwZi1udGIubwo+ICBvYmotJChDT05GSUdfUENJ
X0VQRl9WTlRCKSAgICAgICAgICAgICArPSBwY2ktZXBmLXZudGIubwo+ICtvYmotJChDT05GSUdf
UENJX0VQRl9WSVJUSU8pICAgICAgICAgICArPSBwY2ktZXBmLXZpcnRpby5vCj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvcGNpL2VuZHBvaW50L2Z1bmN0aW9ucy9wY2ktZXBmLXZpcnRpby5jIGIvZHJp
dmVycy9wY2kvZW5kcG9pbnQvZnVuY3Rpb25zL3BjaS1lcGYtdmlydGlvLmMKPiBuZXcgZmlsZSBt
b2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAwMDAwMC4uZjY3NjEwZGQyNDdkCj4gLS0tIC9kZXYv
bnVsbAo+ICsrKyBiL2RyaXZlcnMvcGNpL2VuZHBvaW50L2Z1bmN0aW9ucy9wY2ktZXBmLXZpcnRp
by5jCj4gQEAgLTAsMCArMSw0NTggQEAKPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQ
TC0yLjAKPiArLyoKPiArICogSGVscGVycyB0byBpbXBsZW1lbnQgUENJZSB2aXJ0aW8gRVAgZnVu
Y3Rpb24uCj4gKyAqLwo+ICsjaW5jbHVkZSA8bGludXgvdmlydGlvX3BjaS5oPgo+ICsjaW5jbHVk
ZSA8bGludXgvdmlydGlvX2NvbmZpZy5oPgo+ICsjaW5jbHVkZSA8bGludXgva3RocmVhZC5oPgo+
ICsKPiArI2luY2x1ZGUgInBjaS1lcGYtdmlydGlvLmgiCj4gKwo+ICtzdGF0aWMgdm9pZCBlcGZf
dmlydGlvX3VubWFwX3ZxKHN0cnVjdCBwY2lfZXBmICplcGYsIHZvaWQgX19pb21lbSAqdnFfdmly
dCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBoeXNfYWRkcl90IHZxX3BoeXMs
IHVuc2lnbmVkIGludCBudW0pCj4gK3sKPiArICAgICAgIHNpemVfdCB2cV9zaXplID0gdnJpbmdf
c2l6ZShudW0sIFZJUlRJT19QQ0lfVlJJTkdfQUxJR04pOwo+ICsKPiArICAgICAgIHBjaV9lcGNf
dW5tYXBfYWRkcihlcGYtPmVwYywgZXBmLT5mdW5jX25vLCBlcGYtPnZmdW5jX25vLCB2cV9waHlz
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgIHZxX3ZpcnQsIHZxX3NpemUpOwo+ICsgICAg
ICAgcGNpX2VwY19tZW1fZnJlZV9hZGRyKGVwZi0+ZXBjLCB2cV9waHlzLCB2cV92aXJ0LCB2cV9z
aXplKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgX19pb21lbSAqZXBmX3ZpcnRpb19tYXBfdnEo
c3RydWN0IHBjaV9lcGYgKmVwZiwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBwaHlzX2FkZHJfdCB2cV9wY2lfYWRkciwKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgbnVtLCBwaHlzX2FkZHJfdCAqdnFfcGh5cykKPiAr
ewo+ICsgICAgICAgaW50IGVycjsKPiArICAgICAgIHNpemVfdCB2cV9zaXplOwo+ICsgICAgICAg
dm9pZCBfX2lvbWVtICp2cV92aXJ0Owo+ICsKPiArICAgICAgIHZxX3NpemUgPSB2cmluZ19zaXpl
KG51bSwgVklSVElPX1BDSV9WUklOR19BTElHTik7Cj4gKwo+ICsgICAgICAgdnFfdmlydCA9IHBj
aV9lcGNfbWFwX2FkZHIoZXBmLT5lcGMsIGVwZi0+ZnVuY19ubywgZXBmLT52ZnVuY19ubywKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZxX3BjaV9hZGRyLCB2cV9waHlzLCB2
cV9zaXplKTsKPiArICAgICAgIGlmIChJU19FUlIodnFfdmlydCkpIHsKPiArICAgICAgICAgICAg
ICAgcHJfZXJyKCJGYWlsZWQgdG8gbWFwIHZpcnR1cXVldWUgdG8gbG9jYWwiKTsKPiArICAgICAg
ICAgICAgICAgZ290byBlcnJfZnJlZTsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4g
dnFfdmlydDsKPiArCj4gK2Vycl9mcmVlOgo+ICsgICAgICAgcGNpX2VwY19tZW1fZnJlZV9hZGRy
KGVwZi0+ZXBjLCAqdnFfcGh5cywgdnFfdmlydCwgdnFfc2l6ZSk7Cj4gKwo+ICsgICAgICAgcmV0
dXJuIEVSUl9QVFIoZXJyKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZXBmX3ZpcnRpb19mcmVl
X3ZyaW5naChzdHJ1Y3QgcGNpX2VwZiAqZXBmLCBzdHJ1Y3QgZXBmX3ZyaW5naCAqZXZyaCkKPiAr
ewo+ICsgICAgICAgZXBmX3ZpcnRpb191bm1hcF92cShlcGYsIGV2cmgtPnZpcnQsIGV2cmgtPnBo
eXMsIGV2cmgtPm51bSk7Cj4gKyAgICAgICBrZnJlZShldnJoKTsKPiArfQo+ICsKPiArc3RhdGlj
IHN0cnVjdCBlcGZfdnJpbmdoICplcGZfdmlydGlvX2FsbG9jX3ZyaW5naChzdHJ1Y3QgcGNpX2Vw
ZiAqZXBmLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdTY0IGZlYXR1cmVzLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcGh5c19hZGRyX3QgcGNpX2FkZHIsCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgbnVtKQo+ICt7Cj4gKyAg
ICAgICBpbnQgZXJyOwo+ICsgICAgICAgc3RydWN0IHZyaW5nIHZyaW5nOwo+ICsgICAgICAgc3Ry
dWN0IGVwZl92cmluZ2ggKmV2cmg7Cj4gKwo+ICsgICAgICAgZXZyaCA9IGttYWxsb2Moc2l6ZW9m
KCpldnJoKSwgR0ZQX0tFUk5FTCk7Cj4gKyAgICAgICBpZiAoIWV2cmgpIHsKPiArICAgICAgICAg
ICAgICAgZXJyID0gLUVOT01FTTsKPiArICAgICAgICAgICAgICAgZ290byBlcnJfdW5tYXBfdnE7
Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgZXZyaC0+bnVtID0gbnVtOwo+ICsKPiArICAgICAg
IGV2cmgtPnZpcnQgPSBlcGZfdmlydGlvX21hcF92cShlcGYsIHBjaV9hZGRyLCBudW0sICZldnJo
LT5waHlzKTsKPiArICAgICAgIGlmIChJU19FUlIoZXZyaC0+dmlydCkpCj4gKyAgICAgICAgICAg
ICAgIHJldHVybiBldnJoLT52aXJ0Owo+ICsKPiArICAgICAgIHZyaW5nX2luaXQoJnZyaW5nLCBu
dW0sIGV2cmgtPnZpcnQsIFZJUlRJT19QQ0lfVlJJTkdfQUxJR04pOwo+ICsKPiArICAgICAgIGVy
ciA9IHZyaW5naF9pbml0X2lvbWVtKCZldnJoLT52cmgsIGZlYXR1cmVzLCBudW0sIGZhbHNlLCB2
cmluZy5kZXNjLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdnJpbmcuYXZhaWws
IHZyaW5nLnVzZWQpOwo+ICsgICAgICAgaWYgKGVycikKPiArICAgICAgICAgICAgICAgZ290byBl
cnJfZnJlZV9lcGZfdnE7Cj4gKwo+ICsgICAgICAgcmV0dXJuIGV2cmg7Cj4gKwo+ICtlcnJfZnJl
ZV9lcGZfdnE6Cj4gKyAgICAgICBrZnJlZShldnJoKTsKPiArCj4gK2Vycl91bm1hcF92cToKPiAr
ICAgICAgIGVwZl92aXJ0aW9fdW5tYXBfdnEoZXBmLCBldnJoLT52aXJ0LCBldnJoLT5waHlzLCBl
dnJoLT5udW0pOwo+ICsKPiArICAgICAgIHJldHVybiBFUlJfUFRSKGVycik7Cj4gK30KPiArCj4g
KyNkZWZpbmUgVklSVElPX1BDSV9MRUdBQ1lfQ0ZHX0JBUiAwCj4gKwo+ICtzdGF0aWMgdm9pZCBf
X2lvbWVtICplcGZfdmlydGlvX2FsbG9jX2JhcihzdHJ1Y3QgcGNpX2VwZiAqZXBmLCBzaXplX3Qg
c2l6ZSkKPiArewo+ICsgICAgICAgc3RydWN0IHBjaV9lcGZfYmFyICpjb25maWdfYmFyID0gJmVw
Zi0+YmFyW1ZJUlRJT19QQ0lfTEVHQUNZX0NGR19CQVJdOwo+ICsgICAgICAgY29uc3Qgc3RydWN0
IHBjaV9lcGNfZmVhdHVyZXMgKmZlYXR1cmVzOwo+ICsgICAgICAgdm9pZCBfX2lvbWVtICpiYXI7
Cj4gKyAgICAgICBpbnQgZXJyOwo+ICsKPiArICAgICAgIGZlYXR1cmVzID0gcGNpX2VwY19nZXRf
ZmVhdHVyZXMoZXBmLT5lcGMsIGVwZi0+ZnVuY19ubywgZXBmLT52ZnVuY19ubyk7Cj4gKyAgICAg
ICBpZiAoIWZlYXR1cmVzKSB7Cj4gKyAgICAgICAgICAgICAgIHByX2RlYnVnKCJGYWlsZWQgdG8g
Z2V0IFBDSSBFUEMgZmVhdHVyZXNcbiIpOwo+ICsgICAgICAgICAgICAgICByZXR1cm4gRVJSX1BU
UigtRU9QTk9UU1VQUCk7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgaWYgKGZlYXR1cmVzLT5y
ZXNlcnZlZF9iYXIgJiBCSVQoVklSVElPX1BDSV9MRUdBQ1lfQ0ZHX0JBUikpIHsKPiArICAgICAg
ICAgICAgICAgcHJfZGVidWcoIkNhbm5vdCB1c2UgdGhlIFBDSSBCQVIgZm9yIGxlZ2FjeSB2aXJ0
aW8gcGNpXG4iKTsKPiArICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoLUVPUE5PVFNVUFAp
OwoKU2luY2UgMS4wIGhhcyBiZWVuIHVzZWQgZm9yIHllYXJzLCBJIHdvdWxkIHN1Z2dlc3Qgc3Rh
cnRpbmcgZnJvbSBhCm1vZGVybiBkZXZpY2Ugb3RoZXIgdGhhbiBhIGxlZ2FjeSBvbmUuIE90aGVy
d2lzZSB5b3UgbWF5IGVuZCB1cCB3aXRoCnNvbWUgaGFja3kgc3R1ZmZzIG1vcmUgYmVsb3cuCgo+
ICsgICAgICAgfQo+ICsKPiArICAgICAgIGlmIChmZWF0dXJlcy0+YmFyX2ZpeGVkX3NpemVbVklS
VElPX1BDSV9MRUdBQ1lfQ0ZHX0JBUl0pIHsKPiArICAgICAgICAgICAgICAgaWYgKHNpemUgPgo+
ICsgICAgICAgICAgICAgICAgICAgZmVhdHVyZXMtPmJhcl9maXhlZF9zaXplW1ZJUlRJT19QQ0lf
TEVHQUNZX0NGR19CQVJdKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcHJfZGVidWcoIlBD
SSBCQVIgc2l6ZSBpcyBub3QgZW5vdWdoXG4iKTsKPiArICAgICAgICAgICAgICAgICAgICAgICBy
ZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKPiArICAgICAgICAgICAgICAgfQo+ICsgICAgICAgfQo+
ICsKPiArICAgICAgIGJhciA9IHBjaV9lcGZfYWxsb2Nfc3BhY2UoZXBmLCBzaXplLCBWSVJUSU9f
UENJX0xFR0FDWV9DRkdfQkFSLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBm
ZWF0dXJlcy0+YWxpZ24sIFBSSU1BUllfSU5URVJGQUNFKTsKPiArICAgICAgIGlmICghYmFyKSB7
Cj4gKyAgICAgICAgICAgICAgIHByX2RlYnVnKCJGYWlsZWQgdG8gYWxsb2NhdGUgdmlydGlvLW5l
dCBjb25maWcgbWVtb3J5XG4iKTsKPiArICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoLUVO
T01FTSk7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgY29uZmlnX2Jhci0+ZmxhZ3MgfD0gUENJ
X0JBU0VfQUREUkVTU19NRU1fVFlQRV82NDsKClRoaXMgaXMgdGhlIHRyaWNreSBwYXJ0OgoKMSkg
c3BlYyBzYWlkIGxlZ2FjeSBiYXIgaXMgSS9PIG5vdCBtZW1vcnkKMikgdGhpcyBjb2RlIG1heSBz
dGlsbCB3b3JrIGlmIHRoZSBob3N0IGlzIHJ1bm5pbmcgd2l0aCBMaW51eCBzaW5jZQp0aGUgdmly
dGlvIGRyaXZlciB3b3JrIGZvciBtZW1vcnkgYmFyCjMpIGJ1dCBpdCBtYXkgbm90IHdvcmsgaWYg
dGhlIGhvc3QgaXMgbm90IHJ1bm5pbmcgd2l0aCBMaW51eAoKPiArICAgICAgIGVyciA9IHBjaV9l
cGNfc2V0X2JhcihlcGYtPmVwYywgZXBmLT5mdW5jX25vLCBlcGYtPnZmdW5jX25vLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ19iYXIpOwo+ICsgICAgICAgaWYgKGVycikg
ewo+ICsgICAgICAgICAgICAgICBwcl9kZWJ1ZygiRmFpbGVkIHRvIHNldCBQQ0kgQkFSIik7Cj4g
KyAgICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWVfc3BhY2U7Cj4gKyAgICAgICB9Cj4gKwo+ICsg
ICAgICAgcmV0dXJuIGJhcjsKPiArCj4gK2Vycl9mcmVlX3NwYWNlOgo+ICsKPiArICAgICAgIHBj
aV9lcGZfZnJlZV9zcGFjZShlcGYsIGJhciwgVklSVElPX1BDSV9MRUdBQ1lfQ0ZHX0JBUiwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZX0lOVEVSRkFDRSk7Cj4gKwo+ICsgICAg
ICAgcmV0dXJuIEVSUl9QVFIoZXJyKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZXBmX3ZpcnRp
b19mcmVlX2JhcihzdHJ1Y3QgcGNpX2VwZiAqZXBmLCB2b2lkIF9faW9tZW0gKmJhcikKPiArewo+
ICsgICAgICAgc3RydWN0IHBjaV9lcGZfYmFyICpjb25maWdfYmFyID0gJmVwZi0+YmFyW1ZJUlRJ
T19QQ0lfTEVHQUNZX0NGR19CQVJdOwo+ICsKPiArICAgICAgIHBjaV9lcGNfY2xlYXJfYmFyKGVw
Zi0+ZXBjLCBlcGYtPmZ1bmNfbm8sIGVwZi0+dmZ1bmNfbm8sIGNvbmZpZ19iYXIpOwo+ICsgICAg
ICAgcGNpX2VwZl9mcmVlX3NwYWNlKGVwZiwgYmFyLCBWSVJUSU9fUENJX0xFR0FDWV9DRkdfQkFS
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSU1BUllfSU5URVJGQUNFKTsKPiArfQo+
ICsKPiArc3RhdGljIHZvaWQgZXBmX3ZpcnRpb19pbml0X2JhcihzdHJ1Y3QgZXBmX3ZpcnRpbyAq
ZXZpbywgdm9pZCBfX2lvbWVtICpiYXIpCj4gK3sKPiArICAgICAgIGV2aW8tPmJhciA9IGJhcjsK
PiArCj4gKyAgICAgICBlcGZfdmlydGlvX2NmZ193cml0ZTMyKGV2aW8sIFZJUlRJT19QQ0lfSE9T
VF9GRUFUVVJFUywgZXZpby0+ZmVhdHVyZXMpOwo+ICsgICAgICAgZXBmX3ZpcnRpb19jZmdfd3Jp
dGUxNihldmlvLCBWSVJUSU9fUENJX0lTUiwgVklSVElPX1BDSV9JU1JfUVVFVUUpOwo+ICsgICAg
ICAgZXBmX3ZpcnRpb19jZmdfd3JpdGUxNihldmlvLCBWSVJUSU9fUENJX1FVRVVFX05VTSwgZXZp
by0+dnFsZW4pOwo+ICsgICAgICAgZXBmX3ZpcnRpb19jZmdfd3JpdGUxNihldmlvLCBWSVJUSU9f
UENJX1FVRVVFX05PVElGWSwgZXZpby0+bnZxKTsKPiArICAgICAgIGVwZl92aXJ0aW9fY2ZnX3dy
aXRlOChldmlvLCBWSVJUSU9fUENJX1NUQVRVUywgMCk7Cj4gK30KPiArCj4gKy8qKgo+ICsgKiBl
cGZfdmlydGlvX2luaXQgLSBpbml0aWFsaXplIHN0cnVjdCBlcGZfdmlydGlvIGFuZCBzZXR1cCBC
QVIgZm9yIHZpcnRpbwo+ICsgKiBAZXZpbzogc3RydWN0IGVwZl92aXJ0aW8gdG8gaW5pdGlhbGl6
ZS4KPiArICogQGhkcjogcGNpIGNvbmZpZ3VyYXRpb24gc3BhY2UgdG8gc2hvdyByZW1vdGUgaG9z
dC4KPiArICogQGJhcl9zaXplOiBwY2kgQkFSIHNpemUgaXQgZGVwZW5kcyBvbiB0aGUgdmlydGlv
IGRldmljZSB0eXBlLgo+ICsgKgo+ICsgKiBSZXR1cm5zIHplcm8gb3IgYSBuZWdhdGl2ZSBlcnJv
ci4KPiArICovCj4gK2ludCBlcGZfdmlydGlvX2luaXQoc3RydWN0IGVwZl92aXJ0aW8gKmV2aW8s
IHN0cnVjdCBwY2lfZXBmX2hlYWRlciAqaGRyLAo+ICsgICAgICAgICAgICAgICAgICAgc2l6ZV90
IGJhcl9zaXplKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgcGNpX2VwZiAqZXBmID0gZXZpby0+ZXBm
Owo+ICsgICAgICAgdm9pZCBfX2lvbWVtICpiYXI7Cj4gKyAgICAgICBpbnQgZXJyOwo+ICsKPiAr
ICAgICAgIGVyciA9IHBjaV9lcGNfd3JpdGVfaGVhZGVyKGVwZi0+ZXBjLCBlcGYtPmZ1bmNfbm8s
IGVwZi0+dmZ1bmNfbm8sIGhkcik7Cj4gKyAgICAgICBpZiAoZXJyKQo+ICsgICAgICAgICAgICAg
ICByZXR1cm4gZXJyOwo+ICsKPiArICAgICAgIGJhciA9IGVwZl92aXJ0aW9fYWxsb2NfYmFyKGVw
ZiwgYmFyX3NpemUpOwo+ICsgICAgICAgaWYgKElTX0VSUihiYXIpKQo+ICsgICAgICAgICAgICAg
ICByZXR1cm4gUFRSX0VSUihiYXIpOwo+ICsKPiArICAgICAgIGVwZl92aXJ0aW9faW5pdF9iYXIo
ZXZpbywgYmFyKTsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiArfQo+ICtFWFBPUlRfU1lNQk9M
X0dQTChlcGZfdmlydGlvX2luaXQpOwo+ICsKPiArLyoqCj4gKyAqIGVwZl92aXJ0aW9fZmluYWwg
LSBmaW5hbGl6ZSBzdHJ1Y3QgZXBmX3ZpcnRpby4gaXQgZnJlZXMgYmFyIGFuZCBtZW1vcmllcwo+
ICsgKiBAZXZpbzogc3RydWN0IGVwZl92aXJ0aW8gdG8gZmluYWxpemUuCj4gKyAqLwo+ICt2b2lk
IGVwZl92aXJ0aW9fZmluYWwoc3RydWN0IGVwZl92aXJ0aW8gKmV2aW8pCj4gK3sKPiArICAgICAg
IGVwZl92aXJ0aW9fZnJlZV9iYXIoZXZpby0+ZXBmLCBldmlvLT5iYXIpOwo+ICsKPiArICAgICAg
IGZvciAoaW50IGkgPSAwOyBpIDwgZXZpby0+bnZxOyBpKyspCj4gKyAgICAgICAgICAgICAgIGVw
Zl92aXJ0aW9fZnJlZV92cmluZ2goZXZpby0+ZXBmLCBldmlvLT52cmhzW2ldKTsKPiArCj4gKyAg
ICAgICBrZnJlZShldmlvLT52cmhzKTsKPiArfQo+ICtFWFBPUlRfU1lNQk9MX0dQTChlcGZfdmly
dGlvX2ZpbmFsKTsKPiArCj4gK3N0YXRpYyBpbnQgZXBmX3ZpcnRpb19uZWdvdGlhdGVfdnEoc3Ry
dWN0IGVwZl92aXJ0aW8gKmV2aW8pCj4gK3sKPiArICAgICAgIHUzMiBwZm47Cj4gKyAgICAgICB1
MTYgc2VsOwo+ICsgICAgICAgaW50IGkgPSAwOwo+ICsgICAgICAgc3RydWN0IF9wYWlyIHsKPiAr
ICAgICAgICAgICAgICAgdTMyIHBmbjsKPiArICAgICAgICAgICAgICAgdTE2IHNlbDsKPiArICAg
ICAgIH0gKnRtcDsKPiArICAgICAgIGludCBlcnIgPSAwOwo+ICsgICAgICAgc2l6ZV90IG52cSA9
IGV2aW8tPm52cTsKPiArCj4gKyAgICAgICB0bXAgPSBrbWFsbG9jX2FycmF5KG52cSwgc2l6ZW9m
KHRtcFswXSksIEdGUF9LRVJORUwpOwo+ICsgICAgICAgaWYgKCF0bXApCj4gKyAgICAgICAgICAg
ICAgIHJldHVybiAtRU5PTUVNOwo+ICsKPiArICAgICAgIC8qCj4gKyAgICAgICAgKiBQQ0llIEVQ
IGZyYW1ld29yayBoYXMgbm8gY2FwYWJpbGl0eSB0byBob29rIGFjY2VzcyBQQ0kgQkFSIHNwYWNl
IGZyb20KPiArICAgICAgICAqIHJlbW90ZSBob3N0IGRyaXZlciwgc28gcG9sbCB0aGUgc3BlY2lm
aWMgcmVnaXN0ZXIsIHF1ZXVlIHBmbiB0byBkZXRlY3QKPiArICAgICAgICAqIHRoZSB3cml0aW5n
IGZyb20gdGhlIGRyaXZlci4KClRoZXJlIHdlcmUgZGlzY3Vzc2lvbnMgaW4gdGhlIHBhc3Qgd2hp
Y2ggdHJpZWQgdG8gaGF2ZSBhIG5ldyB0cmFuc3BvcnQKdGhhdCB3b3JrcyBmb3IgdGhlIGVuZHBv
aW50IGluc3RlYWQgb2YgZG9pbmcgdHJpY2tzIGxpa2UgdGhpcy4gSGF2ZQp5b3UgZXZlciBjb25z
aWRlcmVkIHRoaXM/Cgo+ICsgICAgICAgICoKPiArICAgICAgICAqIFRoaXMgaW1wbGVtZW50YXRp
b24gYXNzdW1lcyB0aGF0IHRoZSBhZGRyZXNzIG9mIGVhY2ggdmlydHF1ZXVlIGlzCj4gKyAgICAg
ICAgKiB3cml0dGVuIG9ubHkgb25jZS4KPiArICAgICAgICAqLwo+ICsgICAgICAgZm9yIChpID0g
MDsgaSA8IG52cTsgaSsrKSB7Cj4gKyAgICAgICAgICAgICAgIHdoaWxlICghKHBmbiA9IGVwZl92
aXJ0aW9fY2ZnX3JlYWQzMihldmlvLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgVklSVElPX1BDSV9RVUVVRV9QRk4pKSAmJgo+ICsgICAgICAg
ICAgICAgICAgICAgICAgZXZpby0+cnVubmluZykKPiArICAgICAgICAgICAgICAgICAgICAgICA7
CgpTaG91bGQgd2UgZG8gY29uZF9yZXNjaGVkKCkgaGVyZT8KCj4gKwo+ICsgICAgICAgICAgICAg
ICBzZWwgPSBlcGZfdmlydGlvX2NmZ19yZWFkMTYoZXZpbywgVklSVElPX1BDSV9RVUVVRV9TRUwp
Owo+ICsKPiArICAgICAgICAgICAgICAgZXBmX3ZpcnRpb19jZmdfd3JpdGUzMihldmlvLCBWSVJU
SU9fUENJX1FVRVVFX1BGTiwgMCk7Cj4gKwo+ICsgICAgICAgICAgICAgICB0bXBbaV0ucGZuID0g
cGZuOwo+ICsgICAgICAgICAgICAgICB0bXBbaV0uc2VsID0gc2VsOwo+ICsgICAgICAgfQo+ICsK
PiArICAgICAgIGlmICghZXZpby0+cnVubmluZykKPiArICAgICAgICAgICAgICAgZ290byBlcnJf
b3V0Owo+ICsKPiArICAgICAgIGV2aW8tPnZyaHMgPSBrbWFsbG9jX2FycmF5KG52cSwgc2l6ZW9m
KGV2aW8tPnZyaHNbMF0pLCBHRlBfS0VSTkVMKTsKPiArICAgICAgIGlmICghZXZpby0+dnJocykg
ewo+ICsgICAgICAgICAgICAgICBlcnIgPSAtRU5PTUVNOwo+ICsgICAgICAgICAgICAgICBnb3Rv
IGVycl9vdXQ7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IG52cTsg
aSsrKSB7Cj4gKyAgICAgICAgICAgICAgIHBoeXNfYWRkcl90IHBjaSA9IHRtcFtpXS5wZm4gPDwg
VklSVElPX1BDSV9RVUVVRV9BRERSX1NISUZUOwo+ICsKPiArICAgICAgICAgICAgICAgZXZpby0+
dnJoc1tpXSA9IGVwZl92aXJ0aW9fYWxsb2NfdnJpbmdoKAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgIGV2aW8tPmVwZiwgZXZpby0+ZmVhdHVyZXMsIHBjaSwgZXZpby0+dnFsZW4pOwo+ICsgICAg
ICAgICAgICAgICBpZiAoSVNfRVJSKGV2aW8tPnZyaHNbaV0pKSB7Cj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgZXJyID0gUFRSX0VSUihldmlvLT52cmhzW2ldKTsKPiArICAgICAgICAgICAgICAg
ICAgICAgICBnb3RvIGVycl9mcmVlX2V2cmhzOwo+ICsgICAgICAgICAgICAgICB9Cj4gKyAgICAg
ICB9Cj4gKwo+ICsgICAgICAga2ZyZWUodG1wKTsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiAr
Cj4gK2Vycl9mcmVlX2V2cmhzOgo+ICsgICAgICAgZm9yIChpIC09IDE7IGkgPiAwOyBpLS0pCj4g
KyAgICAgICAgICAgICAgIGVwZl92aXJ0aW9fZnJlZV92cmluZ2goZXZpby0+ZXBmLCBldmlvLT52
cmhzW2ldKTsKPiArCj4gKyAgICAgICBrZnJlZShldmlvLT52cmhzKTsKPiArCj4gK2Vycl9vdXQ6
Cj4gKyAgICAgICBrZnJlZSh0bXApOwo+ICsKPiArICAgICAgIHJldHVybiBlcnI7Cj4gK30KPiAr
Cj4gK3N0YXRpYyB2b2lkIGVwZl92aXJ0aW9fbW9uaXRvcl9xbm90aWZ5KHN0cnVjdCBlcGZfdmly
dGlvICpldmlvKQo+ICt7Cj4gKyAgICAgICBjb25zdCB1MTYgcW5fZGVmYXVsdCA9IGV2aW8tPm52
cTsKPiArICAgICAgIHUxNiB0bXA7Cj4gKwo+ICsgICAgICAgLyogU2luY2UgdGhlcmUgaXMgbm8g
d2F5IHRvIHN5bmNocm9uaXplIGJldHdlZW4gdGhlIGhvc3QgYW5kIEVQIGZ1bmN0aW9ucywKPiAr
ICAgICAgICAqIGl0IGlzIHBvc3NpYmxlIHRvIG1pc3MgbXVsdGlwbGUgbm90aWZpY2F0aW9ucy4K
PiArICAgICAgICAqLwo+ICsgICAgICAgd2hpbGUgKGV2aW8tPnJ1bm5pbmcpIHsKPiArICAgICAg
ICAgICAgICAgdG1wID0gZXBmX3ZpcnRpb19jZmdfcmVhZDE2KGV2aW8sIFZJUlRJT19QQ0lfUVVF
VUVfTk9USUZZKTsKPiArICAgICAgICAgICAgICAgaWYgKHRtcCA9PSBxbl9kZWZhdWx0KQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKY29uZF9yZXNjaGVkKCk/Cgo+ICsKPiAr
ICAgICAgICAgICAgICAgZXBmX3ZpcnRpb19jZmdfd3JpdGUxNihldmlvLCBWSVJUSU9fUENJX1FV
RVVFX05PVElGWSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxbl9k
ZWZhdWx0KTsKPiArCj4gKyAgICAgICAgICAgICAgIGV2aW8tPnFuX2NhbGxiYWNrKGV2aW8tPnFu
X3BhcmFtKTsKPiArICAgICAgIH0KPiArfQo+ICsKPiArc3RhdGljIGludCBlcGZfdmlydGlvX2Jn
dGFzayh2b2lkICpwYXJhbSkKPiArewo+ICsgICAgICAgc3RydWN0IGVwZl92aXJ0aW8gKmV2aW8g
PSBwYXJhbTsKPiArICAgICAgIGludCBlcnI7Cj4gKwo+ICsgICAgICAgZXJyID0gZXBmX3ZpcnRp
b19uZWdvdGlhdGVfdnEoZXZpbyk7Cj4gKyAgICAgICBpZiAoZXJyIDwgMCkgewo+ICsgICAgICAg
ICAgICAgICBwcl9lcnIoImZhaWxlZCB0byBuZWdvdGljYXRlIGNvbmZpZ3Mgd2l0aCBkcml2ZXJc
biIpOwo+ICsgICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ICsgICAgICAgfQo+ICsKPiArICAg
ICAgIHdoaWxlICghKGVwZl92aXJ0aW9fY2ZnX3JlYWQ4KGV2aW8sIFZJUlRJT19QQ0lfU1RBVFVT
KSAmCj4gKyAgICAgICAgICAgICAgICBWSVJUSU9fQ09ORklHX1NfRFJJVkVSX09LKSAmJgo+ICsg
ICAgICAgICAgICAgIGV2aW8tPnJ1bm5pbmcpCj4gKyAgICAgICAgICAgICAgIDsKPiArCj4gKyAg
ICAgICBpZiAoZXZpby0+aWNfY2FsbGJhY2sgJiYgZXZpby0+cnVubmluZykKPiArICAgICAgICAg
ICAgICAgZXZpby0+aWNfY2FsbGJhY2soZXZpby0+aWNfcGFyYW0pOwo+ICsKPiArICAgICAgIGVw
Zl92aXJ0aW9fbW9uaXRvcl9xbm90aWZ5KGV2aW8pOwo+ICsKPiArICAgICAgIHJldHVybiAwOwo+
ICt9Cj4gKwo+ICsvKioKPiArICogZXBmX3ZpcnRpb19sYXVuY2hfYmd0YXNrIC0gc3Bhd24gYSBr
dGhyZWFkIHRoYXQgZW11bGF0ZXMgdmlydGlvIGRldmljZQo+ICsgKiBvcGVyYXRpb25zLgo+ICsg
KiBAZXZpbzogSXQgc2hvdWxkIGJlIGluaXRpYWxpemVkIHByaW9yIHdpdGggZXBmX3ZpcnRpb19p
bml0KCkuCj4gKyAqCj4gKyAqIFJldHVybnMgemVybyBvciBhIG5lZ2F0aXZlIGVycm9yLgo+ICsg
Ki8KPiAraW50IGVwZl92aXJ0aW9fbGF1bmNoX2JndGFzayhzdHJ1Y3QgZXBmX3ZpcnRpbyAqZXZp
bykKPiArewo+ICsgICAgICAgZXZpby0+Ymd0YXNrID0ga3RocmVhZF9jcmVhdGUoZXBmX3ZpcnRp
b19iZ3Rhc2ssIGV2aW8sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAi
cGNpLWVwZi12aXJ0aW8vYmd0YXNrIik7Cj4gKyAgICAgICBpZiAoSVNfRVJSKGV2aW8tPmJndGFz
aykpCj4gKyAgICAgICAgICAgICAgIHJldHVybiBQVFJfRVJSKGV2aW8tPmJndGFzayk7Cj4gKwo+
ICsgICAgICAgZXZpby0+cnVubmluZyA9IHRydWU7Cj4gKwo+ICsgICAgICAgc2NoZWRfc2V0X2Zp
Zm8oZXZpby0+Ymd0YXNrKTsKPiArICAgICAgIHdha2VfdXBfcHJvY2VzcyhldmlvLT5iZ3Rhc2sp
Owo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICt9Cj4gK0VYUE9SVF9TWU1CT0xfR1BMKGVwZl92
aXJ0aW9fbGF1bmNoX2JndGFzayk7Cj4gKwo+ICsvKioKPiArICogZXBmX3ZpcnRpb190ZXJtaW5h
dGVfYmd0YXNrIC0gc2h1dGRvd24gYSBkZXZpY2UgZW11bGF0aW9uIGt0aHJlYWQuCj4gKyAqIEBl
dmlvOiBzdHJ1Y3QgZXBmX3ZpcnRpbyBpdCBhbHJlYWR5IGxhdW5jaGVkIGJndGFzay4KPiArICov
Cj4gK3ZvaWQgZXBmX3ZpcnRpb190ZXJtaW5hdGVfYmd0YXNrKHN0cnVjdCBlcGZfdmlydGlvICpl
dmlvKQo+ICt7Cj4gKyAgICAgICBldmlvLT5ydW5uaW5nID0gZmFsc2U7Cj4gKwo+ICsgICAgICAg
a3RocmVhZF9zdG9wKGV2aW8tPmJndGFzayk7Cj4gK30KPiArRVhQT1JUX1NZTUJPTF9HUEwoZXBm
X3ZpcnRpb190ZXJtaW5hdGVfYmd0YXNrKTsKPiArCj4gKy8qKgo+ICsgKiBlcGZfdmlydGlvX3Jl
c2V0IC0gcmVzZXQgdmlydGlvIHN0YXR1cwo+ICsgKiBAZXZpbzogc3RydWN0IGVwZl92aXJ0aW8g
dG8gcmVzZXQKPiArICoKPiArICogUmV0dXJucyB6ZXJvIG9yIGEgbmVnYXRpdmUgZXJyb3IuCj4g
KyAqLwo+ICtpbnQgZXBmX3ZpcnRpb19yZXNldChzdHJ1Y3QgZXBmX3ZpcnRpbyAqZXZpbykKPiAr
ewo+ICsgICAgICAgZXBmX3ZpcnRpb190ZXJtaW5hdGVfYmd0YXNrKGV2aW8pOwo+ICsgICAgICAg
ZXBmX3ZpcnRpb19pbml0X2JhcihldmlvLCBldmlvLT5iYXIpOwo+ICsKPiArICAgICAgIHJldHVy
biBlcGZfdmlydGlvX2xhdW5jaF9iZ3Rhc2soZXZpbyk7Cj4gK30KPiArRVhQT1JUX1NZTUJPTF9H
UEwoZXBmX3ZpcnRpb19yZXNldCk7Cj4gKwo+ICtpbnQgZXBmX3ZpcnRpb19nZXRkZXNjKHN0cnVj
dCBlcGZfdmlydGlvICpldmlvLCBpbnQgaW5kZXgsCj4gKyAgICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3QgdnJpbmdoX2tpb3YgKnJpb3YsIHN0cnVjdCB2cmluZ2hfa2lvdiAqd2lvdiwKPiArICAg
ICAgICAgICAgICAgICAgICAgIHUxNiAqaGVhZCkKPiArewo+ICsgICAgICAgc3RydWN0IHZyaW5n
aCAqdnJoID0gJmV2aW8tPnZyaHNbaW5kZXhdLT52cmg7Cj4gKwo+ICsgICAgICAgcmV0dXJuIHZy
aW5naF9nZXRkZXNjX2lvbWVtKHZyaCwgcmlvdiwgd2lvdiwgaGVhZCwgR0ZQX0tFUk5FTCk7Cj4g
K30KPiArCj4gK3ZvaWQgZXBmX3ZpcnRpb19hYmFuZG9uKHN0cnVjdCBlcGZfdmlydGlvICpldmlv
LCBpbnQgaW5kZXgsIGludCBudW0pCj4gK3sKPiArICAgICAgIHN0cnVjdCB2cmluZ2ggKnZyaCA9
ICZldmlvLT52cmhzW2luZGV4XS0+dnJoOwo+ICsKPiArICAgICAgIHZyaW5naF9hYmFuZG9uX2lv
bWVtKHZyaCwgbnVtKTsKPiArfQo+ICsKPiArdm9pZCBlcGZfdmlydGlvX2lvdl9jb21wbGV0ZShz
dHJ1Y3QgZXBmX3ZpcnRpbyAqZXZpbywgaW50IGluZGV4LCB1MTYgaGVhZCwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHNpemVfdCB0b3RhbF9sZW4pCj4gK3sKPiArICAgICAgIHN0cnVj
dCB2cmluZ2ggKnZyaCA9ICZldmlvLT52cmhzW2luZGV4XS0+dnJoOwo+ICsKPiArICAgICAgIHZy
aW5naF9jb21wbGV0ZV9pb21lbSh2cmgsIGhlYWQsIHRvdGFsX2xlbik7Cj4gK30KPiArCj4gK2lu
dCBlcGZfdmlydGlvX21lbWNweV9raW92Mmtpb3Yoc3RydWN0IGVwZl92aXJ0aW8gKmV2aW8sCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdnJpbmdoX2tpb3YgKnNpb3Ys
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdnJpbmdoX2tpb3YgKmRp
b3YsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtIGRtYV90cmFuc2Zlcl9k
aXJlY3Rpb24gZGlyKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgcGNpX2VwZiAqZXBmID0gZXZpby0+
ZXBmOwo+ICsgICAgICAgc2l6ZV90IHNsZW4sIGRsZW47Cj4gKyAgICAgICB1NjQgc2Jhc2UsIGRi
YXNlOwo+ICsgICAgICAgcGh5c19hZGRyX3QgcGh5czsKPiArICAgICAgIHZvaWQgKmRzdCwgKnNy
YzsKPiArCj4gKyAgICAgICBmb3IgKDsgc2lvdi0+aSA8IHNpb3YtPnVzZWQ7IHNpb3YtPmkrKywg
ZGlvdi0+aSsrKSB7Cj4gKyAgICAgICAgICAgICAgIHNsZW4gPSBzaW92LT5pb3Zbc2lvdi0+aV0u
aW92X2xlbjsKPiArICAgICAgICAgICAgICAgc2Jhc2UgPSAodTY0KXNpb3YtPmlvdltzaW92LT5p
XS5pb3ZfYmFzZTsKPiArICAgICAgICAgICAgICAgZGxlbiA9IGRpb3YtPmlvdltkaW92LT5pXS5p
b3ZfbGVuOwo+ICsgICAgICAgICAgICAgICBkYmFzZSA9ICh1NjQpZGlvdi0+aW92W2Rpb3YtPmld
Lmlvdl9iYXNlOwo+ICsKPiArICAgICAgICAgICAgICAgaWYgKGRsZW4gPCBzbGVuKSB7Cj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgcHJfaW5mbygibm90IGVub3VnaCBidWZmZXJcbiIpOwo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICsgICAgICAgICAgICAgICB9
Cj4gKwo+ICsgICAgICAgICAgICAgICBpZiAoZGlyID09IERNQV9NRU1fVE9fREVWKSB7Cj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgc3JjID0gcGh5c190b192aXJ0KHNiYXNlKTsKPiArCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgZHN0ID0gcGNpX2VwY19tYXBfYWRkcihlcGYtPmVwYywgZXBm
LT5mdW5jX25vLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZXBmLT52ZnVuY19ubywgZGJhc2UsICZwaHlzLAo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc2xlbik7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAg
aWYgKElTX0VSUihkc3QpKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcl9l
cnIoImZhaWxlZCB0byBtYXAgcGNpIG1tb2VyeSBzcGFjdCB0byBsb2NhbFxuIik7CgpUeXBvcy4K
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUFRSX0VSUihkc3QpOwo+
ICsgICAgICAgICAgICAgICAgICAgICAgIH0KPiArICAgICAgICAgICAgICAgfSBlbHNlIHsKPiAr
ICAgICAgICAgICAgICAgICAgICAgICBzcmMgPSBwY2lfZXBjX21hcF9hZGRyKGVwZi0+ZXBjLCBl
cGYtPmZ1bmNfbm8sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBlcGYtPnZmdW5jX25vLCBzYmFzZSwgJnBoeXMsCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzbGVuKTsKPiArICAgICAgICAgICAgICAgICAgICAg
ICBpZiAoSVNfRVJSKHNyYykpIHsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBy
X2VycigiZmFpbGVkIHRvIG1hcCBwY2kgbW1vZXJ5IHNwYWN0IHRvIGxvY2FsXG4iKTsKClR5cG9z
LgoKVGhhbmtzCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpWaXJ0dWFsaXphdGlvbiBtYWlsaW5nIGxpc3QKVmlydHVhbGl6YXRpb25AbGlzdHMubGludXgt
Zm91bmRhdGlvbi5vcmcKaHR0cHM6Ly9saXN0cy5saW51eGZvdW5kYXRpb24ub3JnL21haWxtYW4v
bGlzdGluZm8vdmlydHVhbGl6YXRpb24=
