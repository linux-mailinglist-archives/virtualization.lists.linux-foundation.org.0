Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp1.osuosl.org (smtp1.osuosl.org [IPv6:2605:bc80:3010::138])
	by mail.lfdr.de (Postfix) with ESMTPS id B674F4AD257
	for <lists.virtualization@lfdr.de>; Tue,  8 Feb 2022 08:37:53 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by smtp1.osuosl.org (Postfix) with ESMTP id E858F813EB;
	Tue,  8 Feb 2022 07:37:51 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp1.osuosl.org ([127.0.0.1])
	by localhost (smtp1.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id VZePG9LOLLUJ; Tue,  8 Feb 2022 07:37:50 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by smtp1.osuosl.org (Postfix) with ESMTPS id 56364813E9;
	Tue,  8 Feb 2022 07:37:50 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id BC96BC0073;
	Tue,  8 Feb 2022 07:37:49 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp4.osuosl.org (smtp4.osuosl.org [140.211.166.137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 87139C000B
 for <virtualization@lists.linux-foundation.org>;
 Tue,  8 Feb 2022 07:37:47 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp4.osuosl.org (Postfix) with ESMTP id 678AC402BB
 for <virtualization@lists.linux-foundation.org>;
 Tue,  8 Feb 2022 07:37:47 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
 by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id Dp8bxjSkJhfV
 for <virtualization@lists.linux-foundation.org>;
 Tue,  8 Feb 2022 07:37:44 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
Received: from out30-133.freemail.mail.aliyun.com
 (out30-133.freemail.mail.aliyun.com [115.124.30.133])
 by smtp4.osuosl.org (Postfix) with ESMTPS id 072F040245
 for <virtualization@lists.linux-foundation.org>;
 Tue,  8 Feb 2022 07:37:43 +0000 (UTC)
X-Alimail-AntiSpam: AC=PASS; BC=-1|-1; BR=01201311R201e4; CH=green; DM=||false|;
 DS=||; FP=0|-1|-1|-1|0|-1|-1|-1; HT=e01e04407; MF=xuanzhuo@linux.alibaba.com;
 NM=1; PH=DS; RN=11; SR=0; TI=SMTPD_---0V3vbKSq_1644305857; 
Received: from localhost(mailfrom:xuanzhuo@linux.alibaba.com
 fp:SMTPD_---0V3vbKSq_1644305857) by smtp.aliyun-inc.com(127.0.0.1);
 Tue, 08 Feb 2022 15:37:38 +0800
Message-ID: <1644305735.2620988-1-xuanzhuo@linux.alibaba.com>
Subject: Re: [PATCH v3 13/17] virtio_pci: queue_reset: support
 VIRTIO_F_RING_RESET
Date: Tue, 8 Feb 2022 15:35:35 +0800
From: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
To: Jason Wang <jasowang@redhat.com>
References: <20220126073533.44994-1-xuanzhuo@linux.alibaba.com>
 <20220126073533.44994-14-xuanzhuo@linux.alibaba.com>
 <0908a9f6-562d-fab5-39c3-2f0125acc80e@redhat.com>
 <1644220750.6834595-1-xuanzhuo@linux.alibaba.com>
 <CACGkMEuemxceN-uQ9Pg1bkaW6jba_jzWkoduRM_FqXUKQy26AA@mail.gmail.com>
In-Reply-To: <CACGkMEuemxceN-uQ9Pg1bkaW6jba_jzWkoduRM_FqXUKQy26AA@mail.gmail.com>
Cc: Jesper Dangaard Brouer <hawk@kernel.org>,
 Daniel Borkmann <daniel@iogearbox.net>, "Michael S. Tsirkin" <mst@redhat.com>,
 netdev <netdev@vger.kernel.org>, John Fastabend <john.fastabend@gmail.com>,
 Alexei Starovoitov <ast@kernel.org>,
 virtualization <virtualization@lists.linux-foundation.org>,
 Jakub Kicinski <kuba@kernel.org>, bpf@vger.kernel.org,
 "David S. Miller" <davem@davemloft.net>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gVHVlLCA4IEZlYiAyMDIyIDEwOjU1OjM3ICswODAwLCBKYXNvbiBXYW5nIDxqYXNvd2FuZ0By
ZWRoYXQuY29tPiB3cm90ZToKPiBPbiBNb24sIEZlYiA3LCAyMDIyIGF0IDQ6MTkgUE0gWHVhbiBa
aHVvIDx4dWFuemh1b0BsaW51eC5hbGliYWJhLmNvbT4gd3JvdGU6Cj4gPgo+ID4gT24gTW9uLCA3
IEZlYiAyMDIyIDE0OjU3OjEzICswODAwLCBKYXNvbiBXYW5nIDxqYXNvd2FuZ0ByZWRoYXQuY29t
PiB3cm90ZToKPiA+ID4KPiA+ID4g5ZyoIDIwMjIvMS8yNiDkuIvljYgzOjM1LCBYdWFuIFpodW8g
5YaZ6YGTOgo+ID4gPiA+IFRoaXMgcGF0Y2ggaW1wbGVtZW50cyB2aXJ0aW8gcGNpIHN1cHBvcnQg
Zm9yIFFVRVVFIFJFU0VULgo+ID4gPiA+Cj4gPiA+ID4gUGVyZm9ybWluZyByZXNldCBvbiBhIHF1
ZXVlIGlzIGRpdmlkZWQgaW50byB0d28gc3RlcHM6Cj4gPiA+ID4KPiA+ID4gPiAxLiByZXNldF92
cTogcmVzZXQgb25lIHZxCj4gPiA+ID4gMi4gZW5hYmxlX3Jlc2V0X3ZxOiByZS1lbmFibGUgdGhl
IHJlc2V0IHF1ZXVlCj4gPiA+ID4KPiA+ID4gPiBJbiB0aGUgZmlyc3Qgc3RlcCwgdGhlc2UgdGFz
a3Mgd2lsbCBiZSBjb21wbGV0ZWQ6Cj4gPiA+ID4gICAgIDEuIG5vdGlmeSB0aGUgaGFyZHdhcmUg
cXVldWUgdG8gcmVzZXQKPiA+ID4gPiAgICAgMi4gcmVjeWNsZSB0aGUgYnVmZmVyIGZyb20gdnEK
PiA+ID4gPiAgICAgMy4gcmVsZWFzZSB0aGUgcmluZyBvZiB0aGUgdnEKPiA+ID4gPgo+ID4gPiA+
IFRoZSBwcm9jZXNzIG9mIGVuYWJsZSByZXNldCB2cToKPiA+ID4gPiAgICAgIHZwX21vZGVybl9l
bmFibGVfcmVzZXRfdnEoKQo+ID4gPiA+ICAgICAgdnBfZW5hYmxlX3Jlc2V0X3ZxKCkKPiA+ID4g
PiAgICAgIF9fdnBfc2V0dXBfdnEoKQo+ID4gPiA+ICAgICAgc2V0dXBfdnEoKQo+ID4gPiA+ICAg
ICAgdnJpbmdfc2V0dXBfdmlydHF1ZXVlKCkKPiA+ID4gPgo+ID4gPiA+IEluIHRoaXMgcHJvY2Vz
cywgd2UgYWRkZWQgdHdvIHBhcmFtZXRlcnMsIHZxIGFuZCBudW0sIGFuZCBmaW5hbGx5IHBhc3Nl
ZAo+ID4gPiA+IHRoZW0gdG8gdnJpbmdfc2V0dXBfdmlydHF1ZXVlKCkuICBBbmQgcmV1c2UgdGhl
IG9yaWdpbmFsIGluZm8gYW5kIHZxLgo+ID4gPiA+Cj4gPiA+ID4gU2lnbmVkLW9mZi1ieTogWHVh
biBaaHVvIDx4dWFuemh1b0BsaW51eC5hbGliYWJhLmNvbT4KPiA+ID4gPiAtLS0KPiA+ID4gPiAg
IGRyaXZlcnMvdmlydGlvL3ZpcnRpb19wY2lfY29tbW9uLmMgfCAgMzYgKysrKysrKy0tLS0KPiA+
ID4gPiAgIGRyaXZlcnMvdmlydGlvL3ZpcnRpb19wY2lfY29tbW9uLmggfCAgIDUgKysKPiA+ID4g
PiAgIGRyaXZlcnMvdmlydGlvL3ZpcnRpb19wY2lfbW9kZXJuLmMgfCAxMDAgKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysKPiA+ID4gPiAgIDMgZmlsZXMgY2hhbmdlZCwgMTI4IGluc2VydGlv
bnMoKyksIDEzIGRlbGV0aW9ucygtKQo+ID4gPiA+Cj4gPiA+ID4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvdmlydGlvL3ZpcnRpb19wY2lfY29tbW9uLmMgYi9kcml2ZXJzL3ZpcnRpby92aXJ0aW9fcGNp
X2NvbW1vbi5jCj4gPiA+ID4gaW5kZXggYzAyOTM2ZDI5YTMxLi5hZDIxNjM4ZmJmNjYgMTAwNjQ0
Cj4gPiA+ID4gLS0tIGEvZHJpdmVycy92aXJ0aW8vdmlydGlvX3BjaV9jb21tb24uYwo+ID4gPiA+
ICsrKyBiL2RyaXZlcnMvdmlydGlvL3ZpcnRpb19wY2lfY29tbW9uLmMKPiA+ID4gPiBAQCAtMjA1
LDIzICsyMDUsMjggQEAgc3RhdGljIGludCB2cF9yZXF1ZXN0X21zaXhfdmVjdG9ycyhzdHJ1Y3Qg
dmlydGlvX2RldmljZSAqdmRldiwgaW50IG52ZWN0b3JzLAo+ID4gPiA+ICAgICByZXR1cm4gZXJy
Owo+ID4gPiA+ICAgfQo+ID4gPiA+Cj4gPiA+ID4gLXN0YXRpYyBzdHJ1Y3QgdmlydHF1ZXVlICp2
cF9zZXR1cF92cShzdHJ1Y3QgdmlydGlvX2RldmljZSAqdmRldiwgdW5zaWduZWQgaW5kZXgsCj4g
PiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAoKmNhbGxiYWNrKShz
dHJ1Y3QgdmlydHF1ZXVlICp2cSksCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY29uc3QgY2hhciAqbmFtZSwKPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBib29sIGN0eCwKPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB1MTYgbXNpeF92ZWMsIHUxNiBudW0pCj4gPiA+ID4gK3N0cnVjdCB2aXJ0cXVldWUgKnZwX3Nl
dHVwX3ZxKHN0cnVjdCB2aXJ0aW9fZGV2aWNlICp2ZGV2LCB1bnNpZ25lZCBpbmRleCwKPiA+ID4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKCpjYWxsYmFjaykoc3RydWN0IHZpcnRx
dWV1ZSAqdnEpLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAq
bmFtZSwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgY3R4LAo+ID4gPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgdTE2IG1zaXhfdmVjLCB1MTYgbnVtKQo+ID4gPiA+
ICAgewo+ID4gPiA+ICAgICBzdHJ1Y3QgdmlydGlvX3BjaV9kZXZpY2UgKnZwX2RldiA9IHRvX3Zw
X2RldmljZSh2ZGV2KTsKPiA+ID4gPiAtICAgc3RydWN0IHZpcnRpb19wY2lfdnFfaW5mbyAqaW5m
byA9IGttYWxsb2Moc2l6ZW9mICppbmZvLCBHRlBfS0VSTkVMKTsKPiA+ID4gPiArICAgc3RydWN0
IHZpcnRpb19wY2lfdnFfaW5mbyAqaW5mbzsKPiA+ID4gPiAgICAgc3RydWN0IHZpcnRxdWV1ZSAq
dnE7Cj4gPiA+ID4gICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gPiA+ID4KPiA+ID4gPiAtICAg
LyogZmlsbCBvdXQgb3VyIHN0cnVjdHVyZSB0aGF0IHJlcHJlc2VudHMgYW4gYWN0aXZlIHF1ZXVl
ICovCj4gPiA+ID4gLSAgIGlmICghaW5mbykKPiA+ID4gPiAtICAgICAgICAgICByZXR1cm4gRVJS
X1BUUigtRU5PTUVNKTsKPiA+ID4gPiArICAgaW5mbyA9IHZwX2Rldi0+dnFzW2luZGV4XTsKPiA+
ID4gPiArICAgaWYgKCFpbmZvKSB7Cj4gPiA+ID4gKyAgICAgICAgICAgaW5mbyA9IGt6YWxsb2Mo
c2l6ZW9mICppbmZvLCBHRlBfS0VSTkVMKTsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICAgICAgICAg
LyogZmlsbCBvdXQgb3VyIHN0cnVjdHVyZSB0aGF0IHJlcHJlc2VudHMgYW4gYWN0aXZlIHF1ZXVl
ICovCj4gPiA+ID4gKyAgICAgICAgICAgaWYgKCFpbmZvKQo+ID4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Cj4gPiA+ID4gKyAgIH0KPiA+ID4gPgo+ID4g
PiA+ICAgICB2cSA9IHZwX2Rldi0+c2V0dXBfdnEodnBfZGV2LCBpbmZvLCBpbmRleCwgY2FsbGJh
Y2ssIG5hbWUsIGN0eCwKPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgIG1zaXhfdmVj
LCBOVUxMLCBudW0pOwo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgbXNpeF92ZWMs
IGluZm8tPnZxLCBudW0pOwo+ID4gPiA+ICAgICBpZiAoSVNfRVJSKHZxKSkKPiA+ID4gPiAgICAg
ICAgICAgICBnb3RvIG91dF9pbmZvOwo+ID4gPiA+Cj4gPiA+ID4gQEAgLTIzOCw2ICsyNDMsOSBA
QCBzdGF0aWMgc3RydWN0IHZpcnRxdWV1ZSAqdnBfc2V0dXBfdnEoc3RydWN0IHZpcnRpb19kZXZp
Y2UgKnZkZXYsIHVuc2lnbmVkIGluZGV4LAo+ID4gPiA+ICAgICByZXR1cm4gdnE7Cj4gPiA+ID4K
PiA+ID4gPiAgIG91dF9pbmZvOgo+ID4gPiA+ICsgICBpZiAoaW5mby0+dnEgJiYgaW5mby0+dnEt
PnJlc2V0KQo+ID4gPiA+ICsgICAgICAgICAgIHJldHVybiB2cTsKPiA+ID4gPiArCj4gPiA+ID4g
ICAgIGtmcmVlKGluZm8pOwo+ID4gPiA+ICAgICByZXR1cm4gdnE7Cj4gPiA+ID4gICB9Cj4gPiA+
ID4gQEAgLTI0OCw5ICsyNTYsMTEgQEAgc3RhdGljIHZvaWQgdnBfZGVsX3ZxKHN0cnVjdCB2aXJ0
cXVldWUgKnZxKQo+ID4gPiA+ICAgICBzdHJ1Y3QgdmlydGlvX3BjaV92cV9pbmZvICppbmZvID0g
dnBfZGV2LT52cXNbdnEtPmluZGV4XTsKPiA+ID4gPiAgICAgdW5zaWduZWQgbG9uZyBmbGFnczsK
PiA+ID4gPgo+ID4gPiA+IC0gICBzcGluX2xvY2tfaXJxc2F2ZSgmdnBfZGV2LT5sb2NrLCBmbGFn
cyk7Cj4gPiA+ID4gLSAgIGxpc3RfZGVsKCZpbmZvLT5ub2RlKTsKPiA+ID4gPiAtICAgc3Bpbl91
bmxvY2tfaXJxcmVzdG9yZSgmdnBfZGV2LT5sb2NrLCBmbGFncyk7Cj4gPiA+ID4gKyAgIGlmICgh
dnEtPnJlc2V0KSB7Cj4gPiA+ID4gKyAgICAgICAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJnZwX2Rl
di0+bG9jaywgZmxhZ3MpOwo+ID4gPiA+ICsgICAgICAgICAgIGxpc3RfZGVsKCZpbmZvLT5ub2Rl
KTsKPiA+ID4gPiArICAgICAgICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ2cF9kZXYtPmxv
Y2ssIGZsYWdzKTsKPiA+ID4gPiArICAgfQo+ID4gPiA+Cj4gPiA+ID4gICAgIHZwX2Rldi0+ZGVs
X3ZxKGluZm8pOwo+ID4gPiA+ICAgICBrZnJlZShpbmZvKTsKPiA+ID4gPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy92aXJ0aW8vdmlydGlvX3BjaV9jb21tb24uaCBiL2RyaXZlcnMvdmlydGlvL3ZpcnRp
b19wY2lfY29tbW9uLmgKPiA+ID4gPiBpbmRleCA2NWRiOTIyNDVlNDEuLmMxZDE1ZjdjMGJlNCAx
MDA2NDQKPiA+ID4gPiAtLS0gYS9kcml2ZXJzL3ZpcnRpby92aXJ0aW9fcGNpX2NvbW1vbi5oCj4g
PiA+ID4gKysrIGIvZHJpdmVycy92aXJ0aW8vdmlydGlvX3BjaV9jb21tb24uaAo+ID4gPiA+IEBA
IC0xMTksNiArMTE5LDExIEBAIGludCB2cF9maW5kX3ZxcyhzdHJ1Y3QgdmlydGlvX2RldmljZSAq
dmRldiwgdW5zaWduZWQgbnZxcywKPiA+ID4gPiAgICAgICAgICAgICBzdHJ1Y3QgdmlydHF1ZXVl
ICp2cXNbXSwgdnFfY2FsbGJhY2tfdCAqY2FsbGJhY2tzW10sCj4gPiA+ID4gICAgICAgICAgICAg
Y29uc3QgY2hhciAqIGNvbnN0IG5hbWVzW10sIGNvbnN0IGJvb2wgKmN0eCwKPiA+ID4gPiAgICAg
ICAgICAgICBzdHJ1Y3QgaXJxX2FmZmluaXR5ICpkZXNjKTsKPiA+ID4gPiArc3RydWN0IHZpcnRx
dWV1ZSAqdnBfc2V0dXBfdnEoc3RydWN0IHZpcnRpb19kZXZpY2UgKnZkZXYsIHVuc2lnbmVkIGlu
ZGV4LAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAoKmNhbGxiYWNrKShz
dHJ1Y3QgdmlydHF1ZXVlICp2cSksCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBjaGFyICpuYW1lLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBj
dHgsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICB1MTYgbXNpeF92ZWMsIHUxNiBu
dW0pOwo+ID4gPiA+ICAgY29uc3QgY2hhciAqdnBfYnVzX25hbWUoc3RydWN0IHZpcnRpb19kZXZp
Y2UgKnZkZXYpOwo+ID4gPiA+Cj4gPiA+ID4gICAvKiBTZXR1cCB0aGUgYWZmaW5pdHkgZm9yIGEg
dmlydHF1ZXVlOgo+ID4gPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3ZpcnRpby92aXJ0aW9fcGNp
X21vZGVybi5jIGIvZHJpdmVycy92aXJ0aW8vdmlydGlvX3BjaV9tb2Rlcm4uYwo+ID4gPiA+IGlu
ZGV4IDJjZTU4ZGU1NDlkZS4uNjc4OTQxMTE2OWU0IDEwMDY0NAo+ID4gPiA+IC0tLSBhL2RyaXZl
cnMvdmlydGlvL3ZpcnRpb19wY2lfbW9kZXJuLmMKPiA+ID4gPiArKysgYi9kcml2ZXJzL3ZpcnRp
by92aXJ0aW9fcGNpX21vZGVybi5jCj4gPiA+ID4gQEAgLTM0LDYgKzM0LDkgQEAgc3RhdGljIHZv
aWQgdnBfdHJhbnNwb3J0X2ZlYXR1cmVzKHN0cnVjdCB2aXJ0aW9fZGV2aWNlICp2ZGV2LCB1NjQg
ZmVhdHVyZXMpCj4gPiA+ID4gICAgIGlmICgoZmVhdHVyZXMgJiBCSVRfVUxMKFZJUlRJT19GX1NS
X0lPVikpICYmCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICBwY2lfZmluZF9leHRfY2FwYWJp
bGl0eShwY2lfZGV2LCBQQ0lfRVhUX0NBUF9JRF9TUklPVikpCj4gPiA+ID4gICAgICAgICAgICAg
X192aXJ0aW9fc2V0X2JpdCh2ZGV2LCBWSVJUSU9fRl9TUl9JT1YpOwo+ID4gPiA+ICsKPiA+ID4g
PiArICAgaWYgKGZlYXR1cmVzICYgQklUX1VMTChWSVJUSU9fRl9SSU5HX1JFU0VUKSkKPiA+ID4g
PiArICAgICAgICAgICBfX3ZpcnRpb19zZXRfYml0KHZkZXYsIFZJUlRJT19GX1JJTkdfUkVTRVQp
Owo+ID4gPiA+ICAgfQo+ID4gPiA+Cj4gPiA+ID4gICAvKiB2aXJ0aW8gY29uZmlnLT5maW5hbGl6
ZV9mZWF0dXJlcygpIGltcGxlbWVudGF0aW9uICovCj4gPiA+ID4gQEAgLTE3Niw2ICsxNzksOTQg
QEAgc3RhdGljIHZvaWQgdnBfcmVzZXQoc3RydWN0IHZpcnRpb19kZXZpY2UgKnZkZXYpCj4gPiA+
ID4gICAgIHZwX2Rpc2FibGVfY2JzKHZkZXYpOwo+ID4gPiA+ICAgfQo+ID4gPiA+Cj4gPiA+ID4g
K3N0YXRpYyBpbnQgdnBfbW9kZXJuX3Jlc2V0X3ZxKHN0cnVjdCB2aXJ0aW9fcmVzZXRfdnEgKnBh
cmFtKQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgIHN0cnVjdCB2aXJ0aW9fcGNpX2RldmljZSAqdnBf
ZGV2ID0gdG9fdnBfZGV2aWNlKHBhcmFtLT52ZGV2KTsKPiA+ID4gPiArICAgc3RydWN0IHZpcnRp
b19wY2lfbW9kZXJuX2RldmljZSAqbWRldiA9ICZ2cF9kZXYtPm1kZXY7Cj4gPiA+ID4gKyAgIHN0
cnVjdCB2aXJ0aW9fcGNpX3ZxX2luZm8gKmluZm87Cj4gPiA+ID4gKyAgIHUxNiBtc2l4X3ZlYywg
cXVldWVfaW5kZXg7Cj4gPiA+ID4gKyAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gPiA+ID4gKyAg
IHZvaWQgKmJ1ZjsKPiA+ID4gPiArCj4gPiA+ID4gKyAgIGlmICghdmlydGlvX2hhc19mZWF0dXJl
KHBhcmFtLT52ZGV2LCBWSVJUSU9fRl9SSU5HX1JFU0VUKSkKPiA+ID4gPiArICAgICAgICAgICBy
ZXR1cm4gLUVOT0VOVDsKPiA+ID4gPiArCj4gPiA+ID4gKyAgIHF1ZXVlX2luZGV4ID0gcGFyYW0t
PnF1ZXVlX2luZGV4Owo+ID4gPiA+ICsKPiA+ID4gPiArICAgdnBfbW9kZXJuX3NldF9xdWV1ZV9y
ZXNldChtZGV2LCBxdWV1ZV9pbmRleCk7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAvKiBBZnRlciB3
cml0ZSAxIHRvIHF1ZXVlIHJlc2V0LCB0aGUgZHJpdmVyIE1VU1Qgd2FpdCBmb3IgYSByZWFkIG9m
Cj4gPiA+ID4gKyAgICAqIHF1ZXVlIHJlc2V0IHRvIHJldHVybiAxLgo+ID4gPiA+ICsgICAgKi8K
PiA+ID4gPiArICAgd2hpbGUgKHZwX21vZGVybl9nZXRfcXVldWVfcmVzZXQobWRldiwgcXVldWVf
aW5kZXgpICE9IDEpCj4gPiA+ID4gKyAgICAgICAgICAgbXNsZWVwKDEpOwo+ID4gPgo+ID4gPgo+
ID4gPiBJcyB0aGlzIGJldHRlciB0byBtb3ZlIHRoaXMgbG9naWMgaW50byB2cF9tb2Rlcm5fc2V0
X3F1ZXVlX3Jlc2V0KCk/Cj4gPiA+Cj4gPgo+ID4gT0suCj4gPgo+ID4gPgo+ID4gPiA+ICsKPiA+
ID4gPiArICAgaW5mbyA9IHZwX2Rldi0+dnFzW3F1ZXVlX2luZGV4XTsKPiA+ID4gPiArICAgbXNp
eF92ZWMgPSBpbmZvLT5tc2l4X3ZlY3RvcjsKPiA+ID4gPiArCj4gPiA+ID4gKyAgIC8qIERpc2Fi
bGUgVlEgY2FsbGJhY2suICovCj4gPiA+ID4gKyAgIGlmICh2cF9kZXYtPnBlcl92cV92ZWN0b3Jz
ICYmIG1zaXhfdmVjICE9IFZJUlRJT19NU0lfTk9fVkVDVE9SKQo+ID4gPiA+ICsgICAgICAgICAg
IGRpc2FibGVfaXJxKHBjaV9pcnFfdmVjdG9yKHZwX2Rldi0+cGNpX2RldiwgbXNpeF92ZWMpKTsK
PiA+ID4KPiA+ID4KPiA+ID4gSG93IGFib3V0IHRoZSBJTlRYIGNhc2Ugd2hlcmUgaXJxIGlzIHNo
YXJlZD8gSSBndWVzcyB3ZSBuZWVkIHRvIGRpc2FibGUKPiA+ID4gYW5kIGVuYWJsZSB0aGUgaXJx
IGFzIHdlbGwuCj4gPgo+ID4gRm9yIHRoZSBJTlRYIHNjZW5hcmlvLCBJIGRvbid0IHRoaW5rIHdl
IG5lZWQgdG8gZGlzYWJsZS9lbmFibGUgdGhlIGlycS4gQnV0IEkgZG8KPiA+IGhhdmUgYSBtaXN0
YWtlLCBJIHNob3VsZCBwdXQgdGhlIGZvbGxvd2luZyBsaXN0X2RlbCgmaW5mby0+bm9kZSkgaGVy
ZSwgc28gdGhhdAo+ID4gd2hlbiB0aGUgaXJxIGNvbWVzLCBpdCB3aWxsIG5vIGxvbmdlciBvcGVy
YXRlIHRoaXMgdnEuCj4gPgo+ID4gSW4gZmFjdCwgZm9yIG5vIElOVFggY2FzZSwgdGhlIGRpc2Fi
bGVfaXJxIGhlcmUgaXMgbm90IG5lY2Vzc2FyeSwgYWNjb3JkaW5nIHRvCj4gPiB0aGUgcmVxdWly
ZW1lbnRzIG9mIHRoZSBzcGVjLCBhZnRlciByZXNldCwgdGhlIGRldmljZSBzaG91bGQgbm90IGdl
bmVyYXRlIGlycQo+ID4gYW55bW9yZS4KPgo+IEkgbWF5IG1pc3Mgc29tZXRoaW5nIGJ1dCBJIGRv
bid0IHRoaW5rIElOVFggZGlmZmVycyBmcm9tIE1TSSBmcm9tIHRoZQo+IHZxIGhhbmRsZXIgcGVy
c3BlY3RpdmUuCj4KPiA+IEhlcmUganVzdCB0byBwcmV2ZW50IGFjY2lkZW50cy4KPgo+IFRoZSBw
cm9ibGVtIGlzIHRoYXQgaWYgeW91IGRvbid0IGRpc2FibGUvc3luYyBJUlEgdGhlcmUgY291bGQg
YmUgYQo+IHJhY2UgYmV0d2VlbiB0aGUgdnEgaXJxIGhhbmRsZXIgYW5kIHRoZSB2aXJ0cXVldWVf
ZGV0YWNoX3VudXNlZF9idWYoKT8KPgo+ID4KPiA+ID4KPiA+ID4KPiA+ID4gPiArCj4gPiA+ID4g
KyAgIHdoaWxlICgoYnVmID0gdmlydHF1ZXVlX2RldGFjaF91bnVzZWRfYnVmKGluZm8tPnZxKSkg
IT0gTlVMTCkKPiA+ID4gPiArICAgICAgICAgICBwYXJhbS0+ZnJlZV91bnVzZWRfY2IocGFyYW0s
IGJ1Zik7Cj4gPiA+Cj4gPiA+Cj4gPiA+IEFueSByZWFzb24gdGhhdCB3ZSBjYW4ndCBsZWF2ZSB0
aGlzIGxvZ2ljIHRvIGRyaXZlcj8gKE9yIGlzIHRoZXJlIGFueQo+ID4gPiBvcGVyYXRpb25zIHRo
YXQgbXVzdCBiZSBkb25lIGJlZm9yZSB0aGUgZm9sbG93aW5nIG9wZXJhdGlvbnM/KQo+ID4KPiA+
IEFzIHlvdSBjb21tZW50ZWQgYmVmb3JlLCB3ZSBtZXJnZWQgZnJlZSB1bnVzZWQgYnVmIGFuZCBy
ZXNldCBxdWV1ZS4KPiA+Cj4gPiBJIHRoaW5rIGl0J3MgYSBnb29kIG5vdGUsIG90aGVyd2lzZSwg
d2UncmUgZ29pbmcgdG8KPiA+Cj4gPiAgICAgICAgIDEuIHJlc2V0IHZxCj4gPiAgICAgICAgIDIu
IGZyZWUgdW51c2VkKGJ5IGRyaXZlcikKPiA+ICAgICAgICAgMy4gZnJlZSByaW5nIG9mIHZxCj4K
PiBSZXRoaW5rIGFib3V0IHRoaXMsIEknZCBwcmVmZXIgdG8gbGVhdmUgaXQgdG8gdGhlIGRyaXZl
ciBmb3IgY29uc2lzdGVuY3kuCj4KPiBFLmcgdGhlIHZpcnRxdWV1ZV9kZXRhY2hfdW51c2VkX2J1
ZigpIGlzIGNhbGxlZCBieSBlYWNoIGRyaXZlciBub3dkYXlzLgoKSW4gdGhpcyBjYXNlLCBnbyBi
YWNrIHRvIG15IHByZXZpb3VzIGRlc2lnbiBhbmQgYWRkIHRocmVlIGhlbHBlcnM6CgoJaW50ICgq
cmVzZXRfdnEpKCk7CglpbnQgKCpmcmVlX3Jlc2V0X3ZxKSgpOwoJaW50ICgqZW5hYmxlX3Jlc2V0
X3ZxKSgpOwoKVGhhbmtzLgoKPgo+ID4KPiA+Cj4gPiA+Cj4gPiA+Cj4gPiA+ID4gKwo+ID4gPiA+
ICsgICAvKiBkZWxldGUgdnEgKi8KPiA+ID4gPiArICAgc3Bpbl9sb2NrX2lycXNhdmUoJnZwX2Rl
di0+bG9jaywgZmxhZ3MpOwo+ID4gPiA+ICsgICBsaXN0X2RlbCgmaW5mby0+bm9kZSk7Cj4gPiA+
ID4gKyAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnZwX2Rldi0+bG9jaywgZmxhZ3MpOwo+ID4g
PiA+ICsKPiA+ID4gPiArICAgSU5JVF9MSVNUX0hFQUQoJmluZm8tPm5vZGUpOwo+ID4gPiA+ICsK
PiA+ID4gPiArICAgaWYgKHZwX2Rldi0+bXNpeF9lbmFibGVkKQo+ID4gPiA+ICsgICAgICAgICAg
IHZwX21vZGVybl9xdWV1ZV92ZWN0b3IobWRldiwgaW5mby0+dnEtPmluZGV4LAo+ID4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVklSVElPX01TSV9OT19WRUNUT1IpOwo+
ID4gPgo+ID4gPgo+ID4gPiBJIHdvbmRlciBpZiB0aGlzIGlzIGEgbXVzdC4KPiA+ID4KPiA+ID4K
PiA+ID4gPiArCj4gPiA+ID4gKyAgIGlmICghbWRldi0+bm90aWZ5X2Jhc2UpCj4gPiA+ID4gKyAg
ICAgICAgICAgcGNpX2lvdW5tYXAobWRldi0+cGNpX2RldiwKPiA+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAodm9pZCBfX2ZvcmNlIF9faW9tZW0gKilpbmZvLT52cS0+cHJpdik7Cj4gPiA+
Cj4gPiA+Cj4gPiA+IElzIHRoaXMgYSBtdXN0PyB3aGF0IGhhcHBlbnMgaWYgd2Ugc2ltcGx5IGRv
bid0IGRvIHRoaXM/Cj4gPiA+Cj4gPgo+ID4gVGhlIHB1cnBvc2Ugb2YgdGhlc2UgdHdvIG9wZXJh
dGlvbnMgaXMgbWFpbmx5IHRvIGJlIHN5bW1ldHJpY2FsIHdpdGggZGVsX3ZxKCkuCj4KPiBUaGlz
IGlzIGFub3RoZXIgcXVlc3Rpb24gSSB3YW50IHRvIGFzay4gQW55IHJlYXNvbiBmb3IgY2FsbGlu
Zwo+IGRlbF92cSgpPyBJcyBpdCBiZWNhdXNlIHlvdSBuZWVkIHRvIGV4Y2x1ZGUgYSB2cSBmcm9t
IHRoZSB2cSBoYW5kbGVyPwo+Cj4gRm9yIGFueSBjYXNlLCB0aGUgTVNJIGFuZCBub3RpZmljYXRp
b24gc3R1ZmYgc2VlbXMgdW5uZWNlc3NhcnkuCj4KPiBUaGFua3MKPgo+ID4KPiA+Cj4gPiA+Cj4g
PiA+ID4gKwo+ID4gPiA+ICsgICB2cmluZ19yZXNldF92aXJ0cXVldWUoaW5mby0+dnEpOwo+ID4g
PiA+ICsKPiA+ID4gPiArICAgcmV0dXJuIDA7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4g
K3N0YXRpYyBzdHJ1Y3QgdmlydHF1ZXVlICp2cF9tb2Rlcm5fZW5hYmxlX3Jlc2V0X3ZxKHN0cnVj
dCB2aXJ0aW9fcmVzZXRfdnEgKnBhcmFtKQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgIHN0cnVjdCB2
aXJ0aW9fcGNpX2RldmljZSAqdnBfZGV2ID0gdG9fdnBfZGV2aWNlKHBhcmFtLT52ZGV2KTsKPiA+
ID4gPiArICAgc3RydWN0IHZpcnRpb19wY2lfbW9kZXJuX2RldmljZSAqbWRldiA9ICZ2cF9kZXYt
Pm1kZXY7Cj4gPiA+ID4gKyAgIHN0cnVjdCB2aXJ0aW9fcGNpX3ZxX2luZm8gKmluZm87Cj4gPiA+
ID4gKyAgIHUxNiBtc2l4X3ZlYywgcXVldWVfaW5kZXg7Cj4gPiA+ID4gKyAgIHN0cnVjdCB2aXJ0
cXVldWUgKnZxOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgaWYgKCF2aXJ0aW9faGFzX2ZlYXR1cmUo
cGFyYW0tPnZkZXYsIFZJUlRJT19GX1JJTkdfUkVTRVQpKQo+ID4gPiA+ICsgICAgICAgICAgIHJl
dHVybiBFUlJfUFRSKC1FTk9FTlQpOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgcXVldWVfaW5kZXgg
PSBwYXJhbS0+cXVldWVfaW5kZXg7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICBpbmZvID0gdnBfZGV2
LT52cXNbcXVldWVfaW5kZXhdOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgaWYgKCFpbmZvLT52cS0+
cmVzZXQpCj4gPiA+ID4gKyAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoLUVQRVJNKTsKPiA+ID4g
PiArCj4gPiA+ID4gKyAgIC8qIGNoZWNrIHF1ZXVlIHJlc2V0IHN0YXR1cyAqLwo+ID4gPiA+ICsg
ICBpZiAodnBfbW9kZXJuX2dldF9xdWV1ZV9yZXNldChtZGV2LCBxdWV1ZV9pbmRleCkgIT0gMSkK
PiA+ID4gPiArICAgICAgICAgICByZXR1cm4gRVJSX1BUUigtRUJVU1kpOwo+ID4gPiA+ICsKPiA+
ID4gPiArICAgdnEgPSB2cF9zZXR1cF92cShwYXJhbS0+dmRldiwgcXVldWVfaW5kZXgsIHBhcmFt
LT5jYWxsYmFjaywgcGFyYW0tPm5hbWUsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgcGFy
YW0tPmN0eCwgaW5mby0+bXNpeF92ZWN0b3IsIHBhcmFtLT5yaW5nX251bSk7Cj4gPiA+ID4gKyAg
IGlmIChJU19FUlIodnEpKQo+ID4gPiA+ICsgICAgICAgICAgIHJldHVybiB2cTsKPiA+ID4gPiAr
Cj4gPiA+ID4gKyAgIHZwX21vZGVybl9zZXRfcXVldWVfZW5hYmxlKCZ2cF9kZXYtPm1kZXYsIHZx
LT5pbmRleCwgdHJ1ZSk7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICBtc2l4X3ZlYyA9IHZwX2Rldi0+
dnFzW3F1ZXVlX2luZGV4XS0+bXNpeF92ZWN0b3I7Cj4gPiA+ID4gKyAgIGlmICh2cF9kZXYtPnBl
cl92cV92ZWN0b3JzICYmIG1zaXhfdmVjICE9IFZJUlRJT19NU0lfTk9fVkVDVE9SKQo+ID4gPiA+
ICsgICAgICAgICAgIGVuYWJsZV9pcnEocGNpX2lycV92ZWN0b3IodnBfZGV2LT5wY2lfZGV2LCBt
c2l4X3ZlYykpOwo+ID4gPgo+ID4gPgo+ID4gPiBIb3cgYWJvdXQgdGhlIElOVC1YIGNhc2U/Cj4g
Pgo+ID4gRXhwbGFpbmVkIGFib3ZlLgo+ID4KPiA+IFRoYW5rcy4KPiA+Cj4gPiA+Cj4gPiA+IFRo
YW5rcwo+ID4gPgo+ID4gPgo+ID4gPiA+ICsKPiA+ID4gPiArICAgcmV0dXJuIHZxOwo+ID4gPiA+
ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICAgc3RhdGljIHUxNiB2cF9jb25maWdfdmVjdG9yKHN0cnVj
dCB2aXJ0aW9fcGNpX2RldmljZSAqdnBfZGV2LCB1MTYgdmVjdG9yKQo+ID4gPiA+ICAgewo+ID4g
PiA+ICAgICByZXR1cm4gdnBfbW9kZXJuX2NvbmZpZ192ZWN0b3IoJnZwX2Rldi0+bWRldiwgdmVj
dG9yKTsKPiA+ID4gPiBAQCAtMjg0LDYgKzM3NSwxMSBAQCBzdGF0aWMgdm9pZCBkZWxfdnEoc3Ry
dWN0IHZpcnRpb19wY2lfdnFfaW5mbyAqaW5mbykKPiA+ID4gPiAgICAgc3RydWN0IHZpcnRpb19w
Y2lfZGV2aWNlICp2cF9kZXYgPSB0b192cF9kZXZpY2UodnEtPnZkZXYpOwo+ID4gPiA+ICAgICBz
dHJ1Y3QgdmlydGlvX3BjaV9tb2Rlcm5fZGV2aWNlICptZGV2ID0gJnZwX2Rldi0+bWRldjsKPiA+
ID4gPgo+ID4gPiA+ICsgICBpZiAodnEtPnJlc2V0KSB7Cj4gPiA+ID4gKyAgICAgICAgICAgdnJp
bmdfZGVsX3ZpcnRxdWV1ZSh2cSk7Cj4gPiA+ID4gKyAgICAgICAgICAgcmV0dXJuOwo+ID4gPiA+
ICsgICB9Cj4gPiA+ID4gKwo+ID4gPiA+ICAgICBpZiAodnBfZGV2LT5tc2l4X2VuYWJsZWQpCj4g
PiA+ID4gICAgICAgICAgICAgdnBfbW9kZXJuX3F1ZXVlX3ZlY3RvcihtZGV2LCB2cS0+aW5kZXgs
Cj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWSVJUSU9fTVNJX05P
X1ZFQ1RPUik7Cj4gPiA+ID4gQEAgLTQwMyw2ICs0OTksOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0
IHZpcnRpb19jb25maWdfb3BzIHZpcnRpb19wY2lfY29uZmlnX25vZGV2X29wcyA9IHsKPiA+ID4g
PiAgICAgLnNldF92cV9hZmZpbml0eSA9IHZwX3NldF92cV9hZmZpbml0eSwKPiA+ID4gPiAgICAg
LmdldF92cV9hZmZpbml0eSA9IHZwX2dldF92cV9hZmZpbml0eSwKPiA+ID4gPiAgICAgLmdldF9z
aG1fcmVnaW9uICA9IHZwX2dldF9zaG1fcmVnaW9uLAo+ID4gPiA+ICsgICAucmVzZXRfdnEgICAg
ICAgID0gdnBfbW9kZXJuX3Jlc2V0X3ZxLAo+ID4gPiA+ICsgICAuZW5hYmxlX3Jlc2V0X3ZxID0g
dnBfbW9kZXJuX2VuYWJsZV9yZXNldF92cSwKPiA+ID4gPiAgIH07Cj4gPiA+ID4KPiA+ID4gPiAg
IHN0YXRpYyBjb25zdCBzdHJ1Y3QgdmlydGlvX2NvbmZpZ19vcHMgdmlydGlvX3BjaV9jb25maWdf
b3BzID0gewo+ID4gPiA+IEBAIC00MjEsNiArNTE5LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2
aXJ0aW9fY29uZmlnX29wcyB2aXJ0aW9fcGNpX2NvbmZpZ19vcHMgPSB7Cj4gPiA+ID4gICAgIC5z
ZXRfdnFfYWZmaW5pdHkgPSB2cF9zZXRfdnFfYWZmaW5pdHksCj4gPiA+ID4gICAgIC5nZXRfdnFf
YWZmaW5pdHkgPSB2cF9nZXRfdnFfYWZmaW5pdHksCj4gPiA+ID4gICAgIC5nZXRfc2htX3JlZ2lv
biAgPSB2cF9nZXRfc2htX3JlZ2lvbiwKPiA+ID4gPiArICAgLnJlc2V0X3ZxICAgICAgICA9IHZw
X21vZGVybl9yZXNldF92cSwKPiA+ID4gPiArICAgLmVuYWJsZV9yZXNldF92cSA9IHZwX21vZGVy
bl9lbmFibGVfcmVzZXRfdnEsCj4gPiA+ID4gICB9Owo+ID4gPiA+Cj4gPiA+ID4gICAvKiB0aGUg
UENJIHByb2JpbmcgZnVuY3Rpb24gKi8KPiA+ID4KPiA+Cj4KX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBsaXN0ClZp
cnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlzdHMubGlu
dXhmb3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
