Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
	by mail.lfdr.de (Postfix) with ESMTPS id 107F02C3CF4
	for <lists.virtualization@lfdr.de>; Wed, 25 Nov 2020 10:52:17 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by whitealder.osuosl.org (Postfix) with ESMTP id 73C6D86E0F;
	Wed, 25 Nov 2020 09:52:15 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id C2HqYx6Ywu4B; Wed, 25 Nov 2020 09:52:06 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by whitealder.osuosl.org (Postfix) with ESMTP id 7543D86DDB;
	Wed, 25 Nov 2020 09:52:02 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 5FD80C163C;
	Wed, 25 Nov 2020 09:52:02 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id CEA07C1DA1
 for <virtualization@lists.linux-foundation.org>;
 Wed, 25 Nov 2020 09:51:57 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by silver.osuosl.org (Postfix) with ESMTP id B057F2A12C
 for <virtualization@lists.linux-foundation.org>;
 Wed, 25 Nov 2020 09:51:57 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id mLRNQdoX8xuM
 for <virtualization@lists.linux-foundation.org>;
 Wed, 25 Nov 2020 09:51:57 +0000 (UTC)
X-Greylist: from auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by silver.osuosl.org (Postfix) with ESMTPS id 936AC2743A
 for <virtualization@lists.linux-foundation.org>;
 Wed, 25 Nov 2020 09:51:56 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 1A838305D3C5; Wed, 25 Nov 2020 11:35:52 +0200 (EET)
Received: from localhost.localdomain (unknown [91.199.104.27])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id E24593072785;
 Wed, 25 Nov 2020 11:35:51 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [PATCH v10 57/81] KVM: introspection: add KVMI_VCPU_EVENT_BREAKPOINT
Date: Wed, 25 Nov 2020 11:35:36 +0200
Message-Id: <20201125093600.2766-58-alazar@bitdefender.com>
In-Reply-To: <20201125093600.2766-1-alazar@bitdefender.com>
References: <20201125093600.2766-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 =?UTF-8?q?Nicu=C8=99or=20C=C3=AE=C8=9Bu?= <nicu.citu@icloud.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBldmVudCBp
cyBzZW50IHdoZW4gYSBicmVha3BvaW50IHdhcyByZWFjaGVkLgoKVGhlIGludHJvc3BlY3Rpb24g
dG9vbCBjYW4gcGxhY2UgYnJlYWtwb2ludHMgYW5kIHVzZSB0aGVtIGFzIG5vdGlmaWNhdGlvbgpm
b3Igd2hlbiB0aGUgT1Mgb3IgYW4gYXBwbGljYXRpb24gaGFzIHJlYWNoZWQgYSBjZXJ0YWluIHN0
YXRlIG9yIGlzCnRyeWluZyB0byBwZXJmb3JtIGEgY2VydGFpbiBvcGVyYXRpb24gKGVnLiBjcmVh
dGUgYSBwcm9jZXNzKS4KClNpZ25lZC1vZmYtYnk6IE1paGFpIERvbsibdSA8bWRvbnR1QGJpdGRl
ZmVuZGVyLmNvbT4KQ28tZGV2ZWxvcGVkLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5pY3UuY2l0dUBp
Y2xvdWQuY29tPgpTaWduZWQtb2ZmLWJ5OiBOaWN1yJlvciBDw67Im3UgPG5pY3UuY2l0dUBpY2xv
dWQuY29tPgpDby1kZXZlbG9wZWQtYnk6IEFkYWxiZXJ0IExhesSDciA8YWxhemFyQGJpdGRlZmVu
ZGVyLmNvbT4KU2lnbmVkLW9mZi1ieTogQWRhbGJlcnQgTGF6xINyIDxhbGF6YXJAYml0ZGVmZW5k
ZXIuY29tPgotLS0KIERvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QgICAgICAgICAgICAg
ICB8IDQ4ICsrKysrKysrKysrKysrKysrKwogYXJjaC94ODYva3ZtL2t2bWkuYyAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHwgNTAgKysrKysrKysrKysrKysrKysrKwogYXJjaC94ODYva3ZtL3N2
bS9zdm0uYyAgICAgICAgICAgICAgICAgICAgICAgIHwgMzQgKysrKysrKysrKysrKwogYXJjaC94
ODYva3ZtL3ZteC92bXguYyAgICAgICAgICAgICAgICAgICAgICAgIHwgMTcgKysrKystLQogaW5j
bHVkZS9saW51eC9rdm1pX2hvc3QuaCAgICAgICAgICAgICAgICAgICAgIHwgIDMgKysKIGluY2x1
ZGUvdWFwaS9saW51eC9rdm1pLmggICAgICAgICAgICAgICAgICAgICB8IDExICsrKy0KIC4uLi90
ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jICB8IDQ2ICsrKysrKysrKysr
KysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyAgICAgICAgICAgICAgICAgfCAy
NSArKysrKysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50LmggICAgICAgICAg
ICAgfCAgNCArKwogdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jICAgICAgICAgICAg
IHwgMTggKysrKysrKwogMTAgZmlsZXMgY2hhbmdlZCwgMjUwIGluc2VydGlvbnMoKyksIDYgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdCBi
L0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKaW5kZXggMDIzYzg4NTYzOGFmLi5jODlm
MzgzZTQ4ZjkgMTAwNjQ0Ci0tLSBhL0RvY3VtZW50YXRpb24vdmlydC9rdm0va3ZtaS5yc3QKKysr
IGIvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdApAQCAtNTM4LDYgKzUzOCw3IEBAIGNv
bW1hbmQpIGJlZm9yZSByZXR1cm5pbmcgdG8gZ3Vlc3QuCiBFbmFibGVzL2Rpc2FibGVzIHZDUFUg
aW50cm9zcGVjdGlvbiBldmVudHMuIFRoaXMgY29tbWFuZCBjYW4gYmUgdXNlZCB3aXRoCiB0aGUg
Zm9sbG93aW5nIGV2ZW50czo6CiAKKwlLVk1JX1ZDUFVfRVZFTlRfQlJFQUtQT0lOVAogCUtWTUlf
VkNQVV9FVkVOVF9IWVBFUkNBTEwKIAogV2hlbiBhbiBldmVudCBpcyBlbmFibGVkLCB0aGUgaW50
cm9zcGVjdGlvbiB0b29sIGlzIG5vdGlmaWVkIGFuZApAQCAtNTU5LDYgKzU2MCw5IEBAIHRoZSAq
S1ZNSV9WTV9DT05UUk9MX0VWRU5UUyogY29tbWFuZC4KICogLUtWTV9FSU5WQUwgLSB0aGUgZXZl
bnQgSUQgaXMgdW5rbm93biAodXNlICpLVk1JX1ZNX0NIRUNLX0VWRU5UKiBmaXJzdCkKICogLUtW
TV9FUEVSTSAtIHRoZSBhY2Nlc3MgaXMgZGlzYWxsb3dlZCAodXNlICpLVk1JX1ZNX0NIRUNLX0VW
RU5UKiBmaXJzdCkKICogLUtWTV9FQUdBSU4gLSB0aGUgc2VsZWN0ZWQgdkNQVSBjYW4ndCBiZSBp
bnRyb3NwZWN0ZWQgeWV0CisqIC1LVk1fRUJVU1kgLSB0aGUgZXZlbnQgY2FuJ3QgYmUgaW50ZXJj
ZXB0ZWQgcmlnaHQgbm93CisgICAgICAgICAgICAgICAoZS5nLiBLVk1JX1ZDUFVfRVZFTlRfQlJF
QUtQT0lOVCBpZiB0aGUgI0JQIGV2ZW50CisgICAgICAgICAgICAgICAgaXMgYWxyZWFkeSBpbnRl
cmNlcHRlZCBieSB1c2Vyc3BhY2UpCiAKIDExLiBLVk1JX1ZDUFVfR0VUX1JFR0lTVEVSUwogLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCkBAIC04MTcsMyArODIxLDQ3IEBAIGZvdW5kIGR1cmlu
ZyBhIHNjYW4uCiAKIFRoZSBtb3N0IHVzZWZ1bCByZWdpc3RlcnMgZGVzY3JpYmluZyB0aGUgdkNQ
VSBzdGF0ZSBjYW4gYmUgcmVhZCBmcm9tCiBgYGt2bWlfdmNwdV9ldmVudC5hcmNoLnJlZ3NgYC4K
KworNC4gS1ZNSV9WQ1BVX0VWRU5UX0JSRUFLUE9JTlQKKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCisKKzpBcmNoaXRlY3R1cmVzOiB4ODYKKzpWZXJzaW9uczogPj0gMQorOkFjdGlvbnM6
IENPTlRJTlVFLCBDUkFTSCwgUkVUUlkKKzpQYXJhbWV0ZXJzOgorCis6OgorCisJc3RydWN0IGt2
bWlfZXZlbnRfaGRyOworCXN0cnVjdCBrdm1pX3ZjcHVfZXZlbnQ7CisJc3RydWN0IGt2bWlfdmNw
dV9ldmVudF9icmVha3BvaW50IHsKKwkJX191NjQgZ3BhOworCQlfX3U4IGluc25fbGVuOworCQlf
X3U4IHBhZGRpbmdbN107CisJfTsKKworOlJldHVybnM6CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV92
Y3B1X2hkcjsKKwlzdHJ1Y3Qga3ZtaV92Y3B1X2V2ZW50X3JlcGx5OworCitUaGlzIGV2ZW50IGlz
IHNlbnQgd2hlbiBhIGJyZWFrcG9pbnQgd2FzIHJlYWNoZWQgYW5kIHRoZSBpbnRyb3NwZWN0aW9u
IGhhcworYmVlbiBlbmFibGVkIGZvciB0aGlzIGV2ZW50IChzZWUgKktWTUlfVkNQVV9DT05UUk9M
X0VWRU5UUyopLgorCitTb21lIG9mIHRoZXNlIGJyZWFrcG9pbnRzIGNvdWxkIGhhdmUgYmVlbiBp
bmplY3RlZCBieSB0aGUgaW50cm9zcGVjdGlvbiB0b29sLAorcGxhY2VkIGluIHRoZSBzbGFjayBz
cGFjZSBvZiB2YXJpb3VzIGZ1bmN0aW9ucyBhbmQgdXNlZCBhcyBub3RpZmljYXRpb24KK2ZvciB3
aGVuIHRoZSBPUyBvciBhbiBhcHBsaWNhdGlvbiBoYXMgcmVhY2hlZCBhIGNlcnRhaW4gc3RhdGUg
b3IgaXMKK3RyeWluZyB0byBwZXJmb3JtIGEgY2VydGFpbiBvcGVyYXRpb24gKGxpa2UgY3JlYXRp
bmcgYSBwcm9jZXNzKS4KKworYGBrdm1pX3ZjcHVfZXZlbnRgYCAod2l0aCB0aGUgdkNQVSBzdGF0
ZSksIHRoZSBndWVzdCBwaHlzaWNhbCBhZGRyZXNzCisoYGBncGFgYCkgd2hlcmUgdGhlIGJyZWFr
cG9pbnQgaW5zdHJ1Y3Rpb24gaXMgcGxhY2VkIGFuZCB0aGUgYnJlYWtwb2ludAoraW5zdHJ1Y3Rp
b24gbGVuZ3RoIChgYGluc25fbGVuYGApIGFyZSBzZW50IHRvIHRoZSBpbnRyb3NwZWN0aW9uIHRv
b2wuCisKK1RoZSAqUkVUUlkqIGFjdGlvbiBpcyB1c2VkIGJ5IHRoZSBpbnRyb3NwZWN0aW9uIHRv
b2wgZm9yIGl0cyBvd24KK2JyZWFrcG9pbnRzLiBJbiBtb3N0IGNhc2VzLCB0aGUgdG9vbCB3aWxs
IGNoYW5nZSB0aGUgaW5zdHJ1Y3Rpb24gcG9pbnRlcgorYmVmb3JlIHJldHVybmluZyB0aGlzIGFj
dGlvbi4KKworVGhlICpDT05USU5VRSogYWN0aW9uIHdpbGwgY2F1c2UgdGhlIGJyZWFrcG9pbnQg
ZXhjZXB0aW9uIHRvIGJlIHJlaW5qZWN0ZWQKKyh0aGUgT1Mgd2lsbCBoYW5kbGUgaXQpLgpkaWZm
IC0tZ2l0IGEvYXJjaC94ODYva3ZtL2t2bWkuYyBiL2FyY2gveDg2L2t2bS9rdm1pLmMKaW5kZXgg
NWYwOGNmMGQxOWJjLi4wYmI2ZjM4ZjEyMTMgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2t2bS9rdm1p
LmMKKysrIGIvYXJjaC94ODYva3ZtL2t2bWkuYwpAQCAtMTEsNiArMTEsNyBAQAogCiB2b2lkIGt2
bWlfYXJjaF9pbml0X3ZjcHVfZXZlbnRzX21hc2sodW5zaWduZWQgbG9uZyAqc3VwcG9ydGVkKQog
eworCXNldF9iaXQoS1ZNSV9WQ1BVX0VWRU5UX0JSRUFLUE9JTlQsIHN1cHBvcnRlZCk7CiAJc2V0
X2JpdChLVk1JX1ZDUFVfRVZFTlRfSFlQRVJDQUxMLCBzdXBwb3J0ZWQpOwogfQogCkBAIC0xNjAs
MyArMTYxLDUyIEBAIGJvb2wga3ZtaV9hcmNoX2lzX2FnZW50X2h5cGVyY2FsbChzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUpCiAJcmV0dXJuIChzdWJmdW5jMSA9PSBLVk1fSENfWEVOX0hWTV9PUF9HVUVT
VF9SRVFVRVNUX1ZNX0VWRU5UCiAJCSYmIHN1YmZ1bmMyID09IDApOwogfQorCitzdGF0aWMgaW50
IGt2bWlfY29udHJvbF9icF9pbnRlcmNlcHQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBib29sIGVu
YWJsZSkKK3sKKwlzdHJ1Y3Qga3ZtX2d1ZXN0X2RlYnVnIGRiZyA9IHt9OworCWludCBlcnIgPSAw
OworCisJaWYgKGVuYWJsZSkKKwkJZGJnLmNvbnRyb2wgPSBLVk1fR1VFU1REQkdfRU5BQkxFIHwg
S1ZNX0dVRVNUREJHX1VTRV9TV19CUDsKKworCWVyciA9IGt2bV9hcmNoX3ZjcHVfc2V0X2d1ZXN0
X2RlYnVnKHZjcHUsICZkYmcpOworCisJcmV0dXJuIGVycjsKK30KKworaW50IGt2bWlfYXJjaF9j
bWRfY29udHJvbF9pbnRlcmNlcHQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LAorCQkJCSAgICB1bnNp
Z25lZCBpbnQgZXZlbnRfaWQsIGJvb2wgZW5hYmxlKQoreworCWludCBlcnIgPSAwOworCisJc3dp
dGNoIChldmVudF9pZCkgeworCWNhc2UgS1ZNSV9WQ1BVX0VWRU5UX0JSRUFLUE9JTlQ6CisJCWVy
ciA9IGt2bWlfY29udHJvbF9icF9pbnRlcmNlcHQodmNwdSwgZW5hYmxlKTsKKwkJYnJlYWs7CisJ
ZGVmYXVsdDoKKwkJYnJlYWs7CisJfQorCisJcmV0dXJuIGVycjsKK30KKwordm9pZCBrdm1pX2Fy
Y2hfYnJlYWtwb2ludF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU2NCBndmEsIHU4IGlu
c25fbGVuKQoreworCXUzMiBhY3Rpb247CisJdTY0IGdwYTsKKworCWdwYSA9IGt2bV9tbXVfZ3Zh
X3RvX2dwYV9zeXN0ZW0odmNwdSwgZ3ZhLCAwLCBOVUxMKTsKKworCWFjdGlvbiA9IGt2bWlfbXNn
X3NlbmRfdmNwdV9icCh2Y3B1LCBncGEsIGluc25fbGVuKTsKKwlzd2l0Y2ggKGFjdGlvbikgewor
CWNhc2UgS1ZNSV9FVkVOVF9BQ1RJT05fQ09OVElOVUU6CisJCWt2bV9xdWV1ZV9leGNlcHRpb24o
dmNwdSwgQlBfVkVDVE9SKTsKKwkJYnJlYWs7CisJY2FzZSBLVk1JX0VWRU5UX0FDVElPTl9SRVRS
WToKKwkJLyogcmlwIHdhcyBtb3N0IGxpa2VseSBhZGp1c3RlZCBwYXN0IHRoZSBJTlQgMyBpbnN0
cnVjdGlvbiAqLworCQlicmVhazsKKwlkZWZhdWx0OgorCQlrdm1pX2hhbmRsZV9jb21tb25fZXZl
bnRfYWN0aW9ucyh2Y3B1LCBhY3Rpb24pOworCX0KK30KZGlmZiAtLWdpdCBhL2FyY2gveDg2L2t2
bS9zdm0vc3ZtLmMgYi9hcmNoL3g4Ni9rdm0vc3ZtL3N2bS5jCmluZGV4IGM2NzMwZWMzOWM1OC4u
YmFjYTQ1NTIxMmY5IDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9rdm0vc3ZtL3N2bS5jCisrKyBiL2Fy
Y2gveDg2L2t2bS9zdm0vc3ZtLmMKQEAgLTI1LDYgKzI1LDcgQEAKICNpbmNsdWRlIDxsaW51eC9w
YWdlbWFwLmg+CiAjaW5jbHVkZSA8bGludXgvc3dhcC5oPgogI2luY2x1ZGUgPGxpbnV4L3J3c2Vt
Lmg+CisjaW5jbHVkZSA8bGludXgva3ZtaV9ob3N0Lmg+CiAKICNpbmNsdWRlIDxhc20vYXBpYy5o
PgogI2luY2x1ZGUgPGFzbS9wZXJmX2V2ZW50Lmg+CkBAIC0xOTU4LDEwICsxOTU5LDQzIEBAIHN0
YXRpYyBpbnQgZGJfaW50ZXJjZXB0aW9uKHN0cnVjdCB2Y3B1X3N2bSAqc3ZtKQogCXJldHVybiAx
OwogfQogCitzdGF0aWMgdW5zaWduZWQgc3ZtX2dldF9pbnN0cnVjdGlvbl9sZW4oc3RydWN0IGt2
bV92Y3B1ICp2Y3B1KQoreworCXN0cnVjdCB2Y3B1X3N2bSAqc3ZtID0gdG9fc3ZtKHZjcHUpOwor
CXVuc2lnbmVkIGxvbmcgcmlwID0ga3ZtX3JpcF9yZWFkKHZjcHUpOworCXVuc2lnbmVkIGxvbmcg
bmV4dF9yaXAgPSAwOworCXVuc2lnbmVkIGluc25fbGVuOworCisJaWYgKHN0YXRpY19jcHVfaGFz
KFg4Nl9GRUFUVVJFX05SSVBTKSkKKwkJbmV4dF9yaXAgPSBzdm0tPnZtY2ItPmNvbnRyb2wubmV4
dF9yaXA7CisKKwlpZiAoIW5leHRfcmlwKSB7CisJCWlmICgha3ZtX2VtdWxhdGVfaW5zdHJ1Y3Rp
b24odmNwdSwgRU1VTFRZUEVfU0tJUCkpCisJCQlyZXR1cm4gMDsKKworCQluZXh0X3JpcCA9IGt2
bV9yaXBfcmVhZCh2Y3B1KTsKKwkJa3ZtX3JpcF93cml0ZSh2Y3B1LCByaXApOworCX0KKworCWlu
c25fbGVuID0gbmV4dF9yaXAgLSByaXA7CisJaWYgKGluc25fbGVuID4gTUFYX0lOU1RfU0laRSkg
eworCQlwcl9lcnIoIiVzOiBpcCAweCVseCBuZXh0IDB4JWx4XG4iLAorCQkgICAgICAgX19mdW5j
X18sIHJpcCwgbmV4dF9yaXApOworCQlyZXR1cm4gMDsKKwl9CisKKwlyZXR1cm4gaW5zbl9sZW47
Cit9CisKIHN0YXRpYyBpbnQgYnBfaW50ZXJjZXB0aW9uKHN0cnVjdCB2Y3B1X3N2bSAqc3ZtKQog
ewogCXN0cnVjdCBrdm1fcnVuICprdm1fcnVuID0gc3ZtLT52Y3B1LnJ1bjsKIAorCWlmICgha3Zt
aV9icmVha3BvaW50X2V2ZW50KCZzdm0tPnZjcHUsIHN2bS0+dm1jYi0+c2F2ZS5jcy5iYXNlICsK
KwkJCQkJICAgICAgIHN2bS0+dm1jYi0+c2F2ZS5yaXAsCisJCQkJICAgc3ZtX2dldF9pbnN0cnVj
dGlvbl9sZW4oJnN2bS0+dmNwdSkpKQorCQlyZXR1cm4gMTsKKwogCWt2bV9ydW4tPmV4aXRfcmVh
c29uID0gS1ZNX0VYSVRfREVCVUc7CiAJa3ZtX3J1bi0+ZGVidWcuYXJjaC5wYyA9IHN2bS0+dm1j
Yi0+c2F2ZS5jcy5iYXNlICsgc3ZtLT52bWNiLT5zYXZlLnJpcDsKIAlrdm1fcnVuLT5kZWJ1Zy5h
cmNoLmV4Y2VwdGlvbiA9IEJQX1ZFQ1RPUjsKZGlmZiAtLWdpdCBhL2FyY2gveDg2L2t2bS92bXgv
dm14LmMgYi9hcmNoL3g4Ni9rdm0vdm14L3ZteC5jCmluZGV4IDFjOGZiZDYyMDljZS4uOWJmYTJl
OWY4MTYxIDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9rdm0vdm14L3ZteC5jCisrKyBiL2FyY2gveDg2
L2t2bS92bXgvdm14LmMKQEAgLTI4LDYgKzI4LDcgQEAKICNpbmNsdWRlIDxsaW51eC90Ym9vdC5o
PgogI2luY2x1ZGUgPGxpbnV4L3RyYWNlX2V2ZW50cy5oPgogI2luY2x1ZGUgPGxpbnV4L2VudHJ5
LWt2bS5oPgorI2luY2x1ZGUgPGxpbnV4L2t2bWlfaG9zdC5oPgogCiAjaW5jbHVkZSA8YXNtL2Fw
aWMuaD4KICNpbmNsdWRlIDxhc20vYXNtLmg+CkBAIC00ODE0LDcgKzQ4MTUsNyBAQCBzdGF0aWMg
aW50IGhhbmRsZV9leGNlcHRpb25fbm1pKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSkKIAlzdHJ1Y3Qg
dmNwdV92bXggKnZteCA9IHRvX3ZteCh2Y3B1KTsKIAlzdHJ1Y3Qga3ZtX3J1biAqa3ZtX3J1biA9
IHZjcHUtPnJ1bjsKIAl1MzIgaW50cl9pbmZvLCBleF9ubywgZXJyb3JfY29kZTsKLQl1bnNpZ25l
ZCBsb25nIGNyMiwgcmlwLCBkcjY7CisJdW5zaWduZWQgbG9uZyBjcjIsIGRyNjsKIAl1MzIgdmVj
dF9pbmZvOwogCiAJdmVjdF9pbmZvID0gdm14LT5pZHRfdmVjdG9yaW5nX2luZm87CkBAIC00ODk1
LDcgKzQ4OTYsMTAgQEAgc3RhdGljIGludCBoYW5kbGVfZXhjZXB0aW9uX25taShzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUpCiAJCWt2bV9ydW4tPmRlYnVnLmFyY2guZHI2ID0gZHI2IHwgRFI2X0ZJWEVE
XzEgfCBEUjZfUlRNOwogCQlrdm1fcnVuLT5kZWJ1Zy5hcmNoLmRyNyA9IHZtY3NfcmVhZGwoR1VF
U1RfRFI3KTsKIAkJZmFsbHRocm91Z2g7Ci0JY2FzZSBCUF9WRUNUT1I6CisJY2FzZSBCUF9WRUNU
T1I6IHsKKwkJdW5zaWduZWQgbG9uZyBndmEgPSB2bWNzX3JlYWRsKEdVRVNUX0NTX0JBU0UpICsK
KwkJCWt2bV9yaXBfcmVhZCh2Y3B1KTsKKwogCQkvKgogCQkgKiBVcGRhdGUgaW5zdHJ1Y3Rpb24g
bGVuZ3RoIGFzIHdlIG1heSByZWluamVjdCAjQlAgZnJvbQogCQkgKiB1c2VyIHNwYWNlIHdoaWxl
IGluIGd1ZXN0IGRlYnVnZ2luZyBtb2RlLiBSZWFkaW5nIGl0IGZvcgpAQCAtNDkwMywxMSArNDkw
NywxNiBAQCBzdGF0aWMgaW50IGhhbmRsZV9leGNlcHRpb25fbm1pKHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSkKIAkJICovCiAJCXZteC0+dmNwdS5hcmNoLmV2ZW50X2V4aXRfaW5zdF9sZW4gPQogCQkJ
dm1jc19yZWFkMzIoVk1fRVhJVF9JTlNUUlVDVElPTl9MRU4pOworCisJCWlmICgha3ZtaV9icmVh
a3BvaW50X2V2ZW50KHZjcHUsIGd2YSwKKwkJCQkJICAgdm14LT52Y3B1LmFyY2guZXZlbnRfZXhp
dF9pbnN0X2xlbikpCisJCQlyZXR1cm4gMTsKKwogCQlrdm1fcnVuLT5leGl0X3JlYXNvbiA9IEtW
TV9FWElUX0RFQlVHOwotCQlyaXAgPSBrdm1fcmlwX3JlYWQodmNwdSk7Ci0JCWt2bV9ydW4tPmRl
YnVnLmFyY2gucGMgPSB2bWNzX3JlYWRsKEdVRVNUX0NTX0JBU0UpICsgcmlwOworCQlrdm1fcnVu
LT5kZWJ1Zy5hcmNoLnBjID0gZ3ZhOwogCQlrdm1fcnVuLT5kZWJ1Zy5hcmNoLmV4Y2VwdGlvbiA9
IGV4X25vOwogCQlicmVhazsKKwl9CiAJY2FzZSBBQ19WRUNUT1I6CiAJCWlmIChndWVzdF9pbmpl
Y3RfYWModmNwdSkpIHsKIAkJCWt2bV9xdWV1ZV9leGNlcHRpb25fZSh2Y3B1LCBBQ19WRUNUT1Is
IGVycm9yX2NvZGUpOwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaCBiL2lu
Y2x1ZGUvbGludXgva3ZtaV9ob3N0LmgKaW5kZXggMWZiNzc1YjBkZTMzLi4zMGI3MjY5NDY4ZGQg
MTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmgKKysrIGIvaW5jbHVkZS9saW51
eC9rdm1pX2hvc3QuaApAQCAtNzAsNiArNzAsNyBAQCBpbnQga3ZtaV9pb2N0bF9wcmV1bmhvb2so
c3RydWN0IGt2bSAqa3ZtKTsKIAogdm9pZCBrdm1pX2hhbmRsZV9yZXF1ZXN0cyhzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUpOwogYm9vbCBrdm1pX2h5cGVyY2FsbF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUg
KnZjcHUpOworYm9vbCBrdm1pX2JyZWFrcG9pbnRfZXZlbnQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
LCB1NjQgZ3ZhLCB1OCBpbnNuX2xlbik7CiAKICNlbHNlCiAKQEAgLTgyLDYgKzgzLDggQEAgc3Rh
dGljIGlubGluZSB2b2lkIGt2bWlfdmNwdV91bmluaXQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KSB7
IH0KIAogc3RhdGljIGlubGluZSB2b2lkIGt2bWlfaGFuZGxlX3JlcXVlc3RzKHN0cnVjdCBrdm1f
dmNwdSAqdmNwdSkgeyB9CiBzdGF0aWMgaW5saW5lIGJvb2wga3ZtaV9oeXBlcmNhbGxfZXZlbnQo
c3RydWN0IGt2bV92Y3B1ICp2Y3B1KSB7IHJldHVybiBmYWxzZTsgfQorc3RhdGljIGlubGluZSBi
b29sIGt2bWlfYnJlYWtwb2ludF9ldmVudChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsIHU2NCBndmEs
CisJCQkJCSB1OCBpbnNuX2xlbikgeyByZXR1cm4gdHJ1ZTsgfQogCiAjZW5kaWYgLyogQ09ORklH
X0tWTV9JTlRST1NQRUNUSU9OICovCiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvdWFwaS9saW51eC9r
dm1pLmggYi9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oCmluZGV4IDNkZmMzNDg2Y2M0Ni4uZWE2
NmYzZjgwM2U3IDEwMDY0NAotLS0gYS9pbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oCisrKyBiL2lu
Y2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKQEAgLTU0LDggKzU0LDkgQEAgZW51bSB7CiB9OwogCiBl
bnVtIHsKLQlLVk1JX1ZDUFVfRVZFTlRfUEFVU0UgICAgID0gS1ZNSV9WQ1BVX0VWRU5UX0lEKDAp
LAotCUtWTUlfVkNQVV9FVkVOVF9IWVBFUkNBTEwgPSBLVk1JX1ZDUFVfRVZFTlRfSUQoMSksCisJ
S1ZNSV9WQ1BVX0VWRU5UX1BBVVNFICAgICAgPSBLVk1JX1ZDUFVfRVZFTlRfSUQoMCksCisJS1ZN
SV9WQ1BVX0VWRU5UX0hZUEVSQ0FMTCAgPSBLVk1JX1ZDUFVfRVZFTlRfSUQoMSksCisJS1ZNSV9W
Q1BVX0VWRU5UX0JSRUFLUE9JTlQgPSBLVk1JX1ZDUFVfRVZFTlRfSUQoMiksCiAKIAlLVk1JX05F
WFRfVkNQVV9FVkVOVAogfTsKQEAgLTE2MCw0ICsxNjEsMTAgQEAgc3RydWN0IGt2bWlfdmNwdV9j
b250cm9sX2V2ZW50cyB7CiAJX191MzIgcGFkZGluZzI7CiB9OwogCitzdHJ1Y3Qga3ZtaV92Y3B1
X2V2ZW50X2JyZWFrcG9pbnQgeworCV9fdTY0IGdwYTsKKwlfX3U4IGluc25fbGVuOworCV9fdTgg
cGFkZGluZ1s3XTsKK307CisKICNlbmRpZiAvKiBfVUFQSV9fTElOVVhfS1ZNSV9IICovCmRpZmYg
LS1naXQgYS90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9rdm0veDg2XzY0L2t2bWlfdGVzdC5jIGIv
dG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYwppbmRleCA4Yzc3
MmIyYmZmMmEuLmNjYjlhM2E5OTdkOCAxMDA2NDQKLS0tIGEvdG9vbHMvdGVzdGluZy9zZWxmdGVz
dHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYworKysgYi90b29scy90ZXN0aW5nL3NlbGZ0ZXN0cy9r
dm0veDg2XzY0L2t2bWlfdGVzdC5jCkBAIC01Myw2ICs1Myw3IEBAIHN0cnVjdCB2Y3B1X3dvcmtl
cl9kYXRhIHsKIAogZW51bSB7CiAJR1VFU1RfVEVTVF9OT09QID0gMCwKKwlHVUVTVF9URVNUX0JQ
LAogCUdVRVNUX1RFU1RfSFlQRVJDQUxMLAogfTsKIApAQCAtNjgsNiArNjksMTEgQEAgc3RhdGlj
IGludCBndWVzdF90ZXN0X2lkKHZvaWQpCiAJcmV0dXJuIFJFQURfT05DRSh0ZXN0X2lkKTsKIH0K
IAorc3RhdGljIHZvaWQgZ3Vlc3RfYnBfdGVzdCh2b2lkKQoreworCWFzbSB2b2xhdGlsZSgiaW50
MyIpOworfQorCiBzdGF0aWMgdm9pZCBndWVzdF9oeXBlcmNhbGxfdGVzdCh2b2lkKQogewogCWFz
bSB2b2xhdGlsZSgibW92ICQzNCwgJXJheCIpOwpAQCAtODIsNiArODgsOSBAQCBzdGF0aWMgdm9p
ZCBndWVzdF9jb2RlKHZvaWQpCiAJCXN3aXRjaCAoZ3Vlc3RfdGVzdF9pZCgpKSB7CiAJCWNhc2Ug
R1VFU1RfVEVTVF9OT09QOgogCQkJYnJlYWs7CisJCWNhc2UgR1VFU1RfVEVTVF9CUDoKKwkJCWd1
ZXN0X2JwX3Rlc3QoKTsKKwkJCWJyZWFrOwogCQljYXNlIEdVRVNUX1RFU1RfSFlQRVJDQUxMOgog
CQkJZ3Vlc3RfaHlwZXJjYWxsX3Rlc3QoKTsKIAkJCWJyZWFrOwpAQCAtMTAxOCw2ICsxMDI3LDQy
IEBAIHN0YXRpYyB2b2lkIHRlc3RfZXZlbnRfaHlwZXJjYWxsKHN0cnVjdCBrdm1fdm0gKnZtKQog
CWRpc2FibGVfdmNwdV9ldmVudCh2bSwgZXZlbnRfaWQpOwogfQogCitzdGF0aWMgdm9pZCB0ZXN0
X2V2ZW50X2JyZWFrcG9pbnQoc3RydWN0IGt2bV92bSAqdm0pCit7CisJc3RydWN0IHZjcHVfd29y
a2VyX2RhdGEgZGF0YSA9IHsKKwkJLnZtID0gdm0sCisJCS52Y3B1X2lkID0gVkNQVV9JRCwKKwkJ
LnRlc3RfaWQgPSBHVUVTVF9URVNUX0JQLAorCX07CisJc3RydWN0IGt2bWlfbXNnX2hkciBoZHI7
CisJc3RydWN0IHsKKwkJc3RydWN0IHZjcHVfZXZlbnQgdmNwdV9ldjsKKwkJc3RydWN0IGt2bWlf
dmNwdV9ldmVudF9icmVha3BvaW50IGJwOworCX0gZXY7CisJc3RydWN0IHZjcHVfcmVwbHkgcnBs
ID0ge307CisJX191MTYgZXZlbnRfaWQgPSBLVk1JX1ZDUFVfRVZFTlRfQlJFQUtQT0lOVDsKKwlw
dGhyZWFkX3QgdmNwdV90aHJlYWQ7CisKKwllbmFibGVfdmNwdV9ldmVudCh2bSwgZXZlbnRfaWQp
OworCisJdmNwdV90aHJlYWQgPSBzdGFydF92Y3B1X3dvcmtlcigmZGF0YSk7CisKKwlyZWNlaXZl
X3ZjcHVfZXZlbnQoJmhkciwgJmV2LnZjcHVfZXYsIHNpemVvZihldiksIGV2ZW50X2lkKTsKKwor
CXByX2RlYnVnKCJCcmVha3BvaW50IGV2ZW50LCByaXAgMHglbGx4LCBsZW4gJXVcbiIsCisJCWV2
LnZjcHVfZXYuY29tbW9uLmFyY2gucmVncy5yaXAsIGV2LmJwLmluc25fbGVuKTsKKworCWV2LnZj
cHVfZXYuY29tbW9uLmFyY2gucmVncy5yaXAgKz0gZXYuYnAuaW5zbl9sZW47CisJX19zZXRfcmVn
aXN0ZXJzKHZtLCAmZXYudmNwdV9ldi5jb21tb24uYXJjaC5yZWdzKTsKKworCXJlcGx5X3RvX2V2
ZW50KCZoZHIsICZldi52Y3B1X2V2LCBLVk1JX0VWRU5UX0FDVElPTl9SRVRSWSwKKwkJCSZycGws
IHNpemVvZihycGwpKTsKKworCXdhaXRfdmNwdV93b3JrZXIodmNwdV90aHJlYWQpOworCisJZGlz
YWJsZV92Y3B1X2V2ZW50KHZtLCBldmVudF9pZCk7Cit9CisKIHN0YXRpYyB2b2lkIHRlc3RfaW50
cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkKIHsKIAlzcmFuZG9tKHRpbWUoMCkpOwpAQCAt
MTAzOSw2ICsxMDg0LDcgQEAgc3RhdGljIHZvaWQgdGVzdF9pbnRyb3NwZWN0aW9uKHN0cnVjdCBr
dm1fdm0gKnZtKQogCXRlc3RfY21kX3ZjcHVfc2V0X3JlZ2lzdGVycyh2bSk7CiAJdGVzdF9jbWRf
dmNwdV9nZXRfY3B1aWQodm0pOwogCXRlc3RfZXZlbnRfaHlwZXJjYWxsKHZtKTsKKwl0ZXN0X2V2
ZW50X2JyZWFrcG9pbnQodm0pOwogCiAJdW5ob29rX2ludHJvc3BlY3Rpb24odm0pOwogfQpkaWZm
IC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMgYi92aXJ0L2t2bS9pbnRyb3Nw
ZWN0aW9uL2t2bWkuYwppbmRleCBlMWUwY2QxNzEzOGMuLjQ3NmFmNmRkOGJmMSAxMDA2NDQKLS0t
IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKKysrIGIvdmlydC9rdm0vaW50cm9zcGVj
dGlvbi9rdm1pLmMKQEAgLTYzOCw2ICs2MzgsMTEgQEAgaW50IGt2bWlfY21kX3ZjcHVfY29udHJv
bF9ldmVudHMoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LAogCQkJCSB1MTYgZXZlbnRfaWQsIGJvb2wg
ZW5hYmxlKQogewogCXN0cnVjdCBrdm1fdmNwdV9pbnRyb3NwZWN0aW9uICp2Y3B1aSA9IFZDUFVJ
KHZjcHUpOworCWludCBlcnI7CisKKwllcnIgPSBrdm1pX2FyY2hfY21kX2NvbnRyb2xfaW50ZXJj
ZXB0KHZjcHUsIGV2ZW50X2lkLCBlbmFibGUpOworCWlmIChlcnIpCisJCXJldHVybiBlcnI7CiAK
IAlpZiAoZW5hYmxlKQogCQlzZXRfYml0KGV2ZW50X2lkLCB2Y3B1aS0+ZXZfZW5hYmxlX21hc2sp
OwpAQCAtODc0LDMgKzg3OSwyMyBAQCBib29sIGt2bWlfaHlwZXJjYWxsX2V2ZW50KHN0cnVjdCBr
dm1fdmNwdSAqdmNwdSkKIAogCXJldHVybiByZXQ7CiB9CisKK2Jvb2wga3ZtaV9icmVha3BvaW50
X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTY0IGd2YSwgdTggaW5zbl9sZW4pCit7CisJ
c3RydWN0IGt2bV9pbnRyb3NwZWN0aW9uICprdm1pOworCWJvb2wgcmV0ID0gdHJ1ZTsKKworCWt2
bWkgPSBrdm1pX2dldCh2Y3B1LT5rdm0pOworCWlmICgha3ZtaSkKKwkJcmV0dXJuIHJldDsKKwor
CWlmIChpc192Y3B1X2V2ZW50X2VuYWJsZWQodmNwdSwgS1ZNSV9WQ1BVX0VWRU5UX0JSRUFLUE9J
TlQpKSB7CisJCWt2bWlfYXJjaF9icmVha3BvaW50X2V2ZW50KHZjcHUsIGd2YSwgaW5zbl9sZW4p
OworCQlyZXQgPSBmYWxzZTsKKwl9CisKKwlrdm1pX3B1dCh2Y3B1LT5rdm0pOworCisJcmV0dXJu
IHJldDsKK30KK0VYUE9SVF9TWU1CT0woa3ZtaV9icmVha3BvaW50X2V2ZW50KTsKZGlmZiAtLWdp
dCBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCBiL3ZpcnQva3ZtL2ludHJvc3Bl
Y3Rpb24va3ZtaV9pbnQuaAppbmRleCA3MmYwYjc1ZDJjZjUuLmZmNzQ1ZTNjZWJhZiAxMDA2NDQK
LS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCisrKyBiL3ZpcnQva3ZtL2lu
dHJvc3BlY3Rpb24va3ZtaV9pbnQuaApAQCAtNDUsNiArNDUsNyBAQCBpbnQga3ZtaV9tc2dfdmNw
dV9yZXBseShjb25zdCBzdHJ1Y3Qga3ZtaV92Y3B1X21zZ19qb2IgKmpvYiwKIAkJCWNvbnN0IHZv
aWQgKnJwbCwgc2l6ZV90IHJwbF9zaXplKTsKIHUzMiBrdm1pX21zZ19zZW5kX3ZjcHVfcGF1c2Uo
c3RydWN0IGt2bV92Y3B1ICp2Y3B1KTsKIHUzMiBrdm1pX21zZ19zZW5kX3ZjcHVfaHlwZXJjYWxs
KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSk7Cit1MzIga3ZtaV9tc2dfc2VuZF92Y3B1X2JwKHN0cnVj
dCBrdm1fdmNwdSAqdmNwdSwgdTY0IGdwYSwgdTggaW5zbl9sZW4pOwogCiAvKiBrdm1pLmMgKi8K
IHZvaWQgKmt2bWlfbXNnX2FsbG9jKHZvaWQpOwpAQCAtNzksNSArODAsOCBAQCB2b2lkIGt2bWlf
YXJjaF9zZXR1cF92Y3B1X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKIAkJCQlzdHJ1Y3Qg
a3ZtaV92Y3B1X2V2ZW50ICpldik7CiB2b2lkIGt2bWlfYXJjaF9wb3N0X3JlcGx5KHN0cnVjdCBr
dm1fdmNwdSAqdmNwdSk7CiBib29sIGt2bWlfYXJjaF9pc19hZ2VudF9oeXBlcmNhbGwoc3RydWN0
IGt2bV92Y3B1ICp2Y3B1KTsKK3ZvaWQga3ZtaV9hcmNoX2JyZWFrcG9pbnRfZXZlbnQoc3RydWN0
IGt2bV92Y3B1ICp2Y3B1LCB1NjQgZ3ZhLCB1OCBpbnNuX2xlbik7CitpbnQga3ZtaV9hcmNoX2Nt
ZF9jb250cm9sX2ludGVyY2VwdChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCisJCQkJICAgIHVuc2ln
bmVkIGludCBldmVudF9pZCwgYm9vbCBlbmFibGUpOwogCiAjZW5kaWYKZGlmZiAtLWdpdCBhL3Zp
cnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYyBiL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24v
a3ZtaV9tc2cuYwppbmRleCAwYzNmMDQ0NzIzZmMuLjVjNWYxNGJiY2I0MCAxMDA2NDQKLS0tIGEv
dmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX21zZy5jCisrKyBiL3ZpcnQva3ZtL2ludHJvc3Bl
Y3Rpb24va3ZtaV9tc2cuYwpAQCAtNzUyLDMgKzc1MiwyMSBAQCB1MzIga3ZtaV9tc2dfc2VuZF92
Y3B1X2h5cGVyY2FsbChzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCiAKIAlyZXR1cm4gYWN0aW9uOwog
fQorCit1MzIga3ZtaV9tc2dfc2VuZF92Y3B1X2JwKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTY0
IGdwYSwgdTggaW5zbl9sZW4pCit7CisJc3RydWN0IGt2bWlfdmNwdV9ldmVudF9icmVha3BvaW50
IGU7CisJdTMyIGFjdGlvbjsKKwlpbnQgZXJyOworCisJbWVtc2V0KCZlLCAwLCBzaXplb2YoZSkp
OworCWUuZ3BhID0gZ3BhOworCWUuaW5zbl9sZW4gPSBpbnNuX2xlbjsKKworCWVyciA9IGt2bWlf
c2VuZF92Y3B1X2V2ZW50KHZjcHUsIEtWTUlfVkNQVV9FVkVOVF9CUkVBS1BPSU5ULAorCQkJCSAg
ICZlLCBzaXplb2YoZSksIE5VTEwsIDAsICZhY3Rpb24pOworCWlmIChlcnIpCisJCXJldHVybiBL
Vk1JX0VWRU5UX0FDVElPTl9DT05USU5VRTsKKworCXJldHVybiBhY3Rpb247Cit9Cl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClZpcnR1YWxpemF0aW9uIG1h
aWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRw
czovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcvbWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXph
dGlvbg==
