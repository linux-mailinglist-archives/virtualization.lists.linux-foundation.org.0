Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp4.osuosl.org (smtp4.osuosl.org [IPv6:2605:bc80:3010::137])
	by mail.lfdr.de (Postfix) with ESMTPS id A2AB16AD7C6
	for <lists.virtualization@lfdr.de>; Tue,  7 Mar 2023 07:55:45 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by smtp4.osuosl.org (Postfix) with ESMTP id 2827540743;
	Tue,  7 Mar 2023 06:55:44 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 2827540743
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp4.osuosl.org ([127.0.0.1])
	by localhost (smtp4.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 5gVfqSfwuQpk; Tue,  7 Mar 2023 06:55:42 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp4.osuosl.org (Postfix) with ESMTPS id 519EE4086F;
	Tue,  7 Mar 2023 06:55:42 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp4.osuosl.org 519EE4086F
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 98A21C0089;
	Tue,  7 Mar 2023 06:55:41 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp3.osuosl.org (smtp3.osuosl.org [IPv6:2605:bc80:3010::136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 2FA96C0032
 for <virtualization@lists.linux-foundation.org>;
 Tue,  7 Mar 2023 06:55:40 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp3.osuosl.org (Postfix) with ESMTP id F14A26058F
 for <virtualization@lists.linux-foundation.org>;
 Tue,  7 Mar 2023 06:55:39 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp3.osuosl.org F14A26058F
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp3.osuosl.org ([127.0.0.1])
 by localhost (smtp3.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id BqhYN1KQ4LEz
 for <virtualization@lists.linux-foundation.org>;
 Tue,  7 Mar 2023 06:55:38 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp3.osuosl.org 1FA9960011
Received: from out30-119.freemail.mail.aliyun.com
 (out30-119.freemail.mail.aliyun.com [115.124.30.119])
 by smtp3.osuosl.org (Postfix) with ESMTPS id 1FA9960011
 for <virtualization@lists.linux-foundation.org>;
 Tue,  7 Mar 2023 06:55:37 +0000 (UTC)
X-Alimail-AntiSpam: AC=PASS; BC=-1|-1; BR=01201311R101e4; CH=green; DM=||false|;
 DS=||; FP=0|-1|-1|-1|0|-1|-1|-1; HT=ay29a033018046051;
 MF=xuanzhuo@linux.alibaba.com; NM=1; PH=DS; RN=3; SR=0;
 TI=SMTPD_---0VdKBmAx_1678172132; 
Received: from localhost(mailfrom:xuanzhuo@linux.alibaba.com
 fp:SMTPD_---0VdKBmAx_1678172132) by smtp.aliyun-inc.com;
 Tue, 07 Mar 2023 14:55:32 +0800
Message-ID: <1678172062.4617074-2-xuanzhuo@linux.alibaba.com>
Subject: Re: [PATCH vhost v1 02/12] virtio_ring: split: separate DMA codes
Date: Tue, 7 Mar 2023 14:54:22 +0800
From: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
To: Jason Wang <jasowang@redhat.com>
References: <20230302115908.1461-1-xuanzhuo@linux.alibaba.com>
 <20230302115908.1461-3-xuanzhuo@linux.alibaba.com>
 <CACGkMEus-e6MR9k2bPmhAUPCjCzDmO4NW+Apx=Eqptx=S9KZ+g@mail.gmail.com>
In-Reply-To: <CACGkMEus-e6MR9k2bPmhAUPCjCzDmO4NW+Apx=Eqptx=S9KZ+g@mail.gmail.com>
Cc: "Michael S. Tsirkin" <mst@redhat.com>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gVHVlLCA3IE1hciAyMDIzIDE0OjQzOjM5ICswODAwLCBKYXNvbiBXYW5nIDxqYXNvd2FuZ0By
ZWRoYXQuY29tPiB3cm90ZToKPiBPbiBUaHUsIE1hciAyLCAyMDIzIGF0IDc6NTnigK9QTSBYdWFu
IFpodW8gPHh1YW56aHVvQGxpbnV4LmFsaWJhYmEuY29tPiB3cm90ZToKPiA+Cj4gPiBETUEtcmVs
YXRlZCBsb2dpYyBpcyBzZXBhcmF0ZWQgZnJvbSB0aGUgdmlydHF1ZXVlX2FkZF92cmluZ19zcGxp
dCgpIHRvCj4gPiBwcmVwYXJlIGZvciBzdWJzZXF1ZW50IHN1cHBvcnQgZm9yIHByZW1hcHBlZC4K
PiA+Cj4gPiBETUEgYWRkcmVzcyB3aWxsIGJlIHNhdmVkIGFzIHNnLT5kbWFfYWRkcmVzcywgdGhl
bgo+ID4gdmlydHF1ZXVlX2FkZF92cmluZ19zcGxpdCgpIHdpbGwgdXNlIGl0IGRpcmVjdGx5Lgo+
ID4KPiA+IElmIGl0IGlzIGEgcHJlbWFwcGVkIHNjZW5lLCB0aGUgdHJhbnNtaXR0ZWQgc2dzIHNo
b3VsZCBoYXZlIHNhdmVkIERNQQo+ID4gYWRkcmVzcyBpbiBkbWFfYWRkcmVzcywgYW5kIGluIHZp
cnRpbyBjb3JlLCB3ZSBuZWVkIHRvIHBhc3MKPiA+IHZpcnRxdWV1ZV9tYXBfc2dzKCkuCj4gPgo+
ID4gU2lnbmVkLW9mZi1ieTogWHVhbiBaaHVvIDx4dWFuemh1b0BsaW51eC5hbGliYWJhLmNvbT4K
PiA+IC0tLQo+ID4gIGRyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5nLmMgfCAxMTYgKysrKysrKysr
KysrKysrKysrKysrKysrLS0tLS0tLS0tLS0KPiA+ICAxIGZpbGUgY2hhbmdlZCwgODAgaW5zZXJ0
aW9ucygrKSwgMzYgZGVsZXRpb25zKC0pCj4gPgo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdmly
dGlvL3ZpcnRpb19yaW5nLmMgYi9kcml2ZXJzL3ZpcnRpby92aXJ0aW9fcmluZy5jCj4gPiBpbmRl
eCAzMDA1ODkzZWNjNjEuLjE3NTIwZjBkNzY0OSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvdmly
dGlvL3ZpcnRpb19yaW5nLmMKPiA+ICsrKyBiL2RyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5nLmMK
PiA+IEBAIC01MjAsNiArNTIwLDczIEBAIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgaW50IHZpcnRx
dWV1ZV9hZGRfZGVzY19zcGxpdChzdHJ1Y3QgdmlydHF1ZXVlICp2cSwKPiA+ICAgICAgICAgcmV0
dXJuIG5leHQ7Cj4gPiAgfQo+ID4KPiA+ICtzdGF0aWMgaW50IHZpcnRxdWV1ZV9tYXBfc2dzKHN0
cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3Qgc2NhdHRlcmxpc3QgKnNnc1tdLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1bnNpZ25lZCBpbnQgdG90YWxfc2csCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVuc2lnbmVkIGludCBvdXRfc2dzLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB1bnNpZ25lZCBpbnQgaW5fc2dzKQo+ID4gK3sKPiA+ICsgICAgICAgc3RydWN0IHNjYXR0ZXJs
aXN0ICpzZzsKPiA+ICsgICAgICAgdW5zaWduZWQgaW50IG47Cj4gPiArCj4gPiArICAgICAgIGZv
ciAobiA9IDA7IG4gPCBvdXRfc2dzOyBuKyspIHsKPiA+ICsgICAgICAgICAgICAgICBmb3IgKHNn
ID0gc2dzW25dOyBzZzsgc2cgPSBzZ19uZXh0KHNnKSkgewo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgZG1hX2FkZHJfdCBhZGRyID0gdnJpbmdfbWFwX29uZV9zZyh2cSwgc2csIERNQV9UT19E
RVZJQ0UpOwo+ID4gKwo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZyaW5nX21hcHBp
bmdfZXJyb3IodnEsIGFkZHIpKQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBy
ZXR1cm4gLUVOT01FTTsKPiA+ICsKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIHNnLT5kbWFf
YWRkcmVzcyA9IGFkZHI7Cj4gPiArICAgICAgICAgICAgICAgfQo+ID4gKyAgICAgICB9Cj4gPiAr
Cj4gPiArICAgICAgIGZvciAoOyBuIDwgKG91dF9zZ3MgKyBpbl9zZ3MpOyBuKyspIHsKPiA+ICsg
ICAgICAgICAgICAgICBmb3IgKHNnID0gc2dzW25dOyBzZzsgc2cgPSBzZ19uZXh0KHNnKSkgewo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZG1hX2FkZHJfdCBhZGRyID0gdnJpbmdfbWFwX29u
ZV9zZyh2cSwgc2csIERNQV9GUk9NX0RFVklDRSk7Cj4gPiArCj4gPiArICAgICAgICAgICAgICAg
ICAgICAgICBpZiAodnJpbmdfbWFwcGluZ19lcnJvcih2cSwgYWRkcikpCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+ID4gKwo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgc2ctPmRtYV9hZGRyZXNzID0gYWRkcjsKPiA+ICsgICAgICAgICAgICAg
ICB9Cj4gPiArICAgICAgIH0KPiA+ICsKPiA+ICsgICAgICAgcmV0dXJuIDA7Cj4gPiArfQo+ID4g
Kwo+ID4gK3N0YXRpYyB2b2lkIHZpcnRxdWV1ZV91bm1hcF9zZ3Moc3RydWN0IHZyaW5nX3ZpcnRx
dWV1ZSAqdnEsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY2F0
dGVybGlzdCAqc2dzW10sCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCB0b3RhbF9zZywKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5z
aWduZWQgaW50IG91dF9zZ3MsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVu
c2lnbmVkIGludCBpbl9zZ3MpCj4gPiArewo+ID4gKyAgICAgICBzdHJ1Y3Qgc2NhdHRlcmxpc3Qg
KnNnOwo+ID4gKyAgICAgICB1bnNpZ25lZCBpbnQgbjsKPiA+ICsKPiA+ICsgICAgICAgaWYgKCF2
cS0+dXNlX2RtYV9hcGkpCj4gPiArICAgICAgICAgICAgICAgcmV0dXJuOwo+ID4gKwo+ID4gKyAg
ICAgICBmb3IgKG4gPSAwOyBuIDwgb3V0X3NnczsgbisrKSB7Cj4gPiArICAgICAgICAgICAgICAg
Zm9yIChzZyA9IHNnc1tuXTsgc2c7IHNnID0gc2dfbmV4dChzZykpIHsKPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgIGlmICghc2ctPmRtYV9hZGRyZXNzKQo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICByZXR1cm47Cj4gPiArCj4gPiArICAgICAgICAgICAgICAgICAgICAgICBk
bWFfdW5tYXBfcGFnZSh2cmluZ19kbWFfZGV2KHZxKSwgc2ctPmRtYV9hZGRyZXNzLAo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2ctPmxlbmd0aCwgRE1BX1RPX0RF
VklDRSk7Cj4gPiArICAgICAgICAgICAgICAgfQo+ID4gKyAgICAgICB9Cj4gPiArCj4gPiArICAg
ICAgIGZvciAoOyBuIDwgKG91dF9zZ3MgKyBpbl9zZ3MpOyBuKyspIHsKPiA+ICsgICAgICAgICAg
ICAgICBmb3IgKHNnID0gc2dzW25dOyBzZzsgc2cgPSBzZ19uZXh0KHNnKSkgewo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgaWYgKCFzZy0+ZG1hX2FkZHJlc3MpCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHJldHVybjsKPiA+ICsKPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgIGRtYV91bm1hcF9wYWdlKHZyaW5nX2RtYV9kZXYodnEpLCBzZy0+ZG1hX2FkZHJlc3MsCj4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZy0+bGVuZ3RoLCBETUFf
RlJPTV9ERVZJQ0UpOwo+ID4gKyAgICAgICAgICAgICAgIH0KPiA+ICsgICAgICAgfQo+ID4gK30K
PiA+ICsKPiA+ICAvKiBub3RlOiByZXR1cm4gTlVMTCBtZWFucyBubyBpbmRpcmVjdCB0aGF0IGlz
IHZhbGlkLiAqLwo+ID4gIHN0YXRpYyBzdHJ1Y3QgdnJpbmdfZGVzYyAqdmlydHF1ZXVlX2dldF9k
ZXNjX3NwbGl0KHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLAo+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHRvdGFsX3Nn
LAo+ID4gQEAgLTU3Nyw3ICs2NDQsNyBAQCBzdGF0aWMgaW5saW5lIGludCB2aXJ0cXVldWVfYWRk
X3ZyaW5nX3NwbGl0KHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLAo+ID4gIHsKPiA+ICAgICAg
ICAgc3RydWN0IHZpcnRxdWV1ZSAqX3ZxID0gJnZxLT52cTsKPiA+ICAgICAgICAgc3RydWN0IHNj
YXR0ZXJsaXN0ICpzZzsKPiA+IC0gICAgICAgdW5zaWduZWQgaW50IGksIG4sIGF2YWlsLCBkZXNj
c191c2VkLCBwcmV2LCBlcnJfaWR4Owo+ID4gKyAgICAgICB1bnNpZ25lZCBpbnQgaSwgbiwgYXZh
aWwsIGRlc2NzX3VzZWQsIHByZXY7Cj4gPiAgICAgICAgIGludCBoZWFkOwo+ID4gICAgICAgICBi
b29sIGluZGlyZWN0Owo+ID4KPiA+IEBAIC01OTgsMzAgKzY2NSwyNSBAQCBzdGF0aWMgaW5saW5l
IGludCB2aXJ0cXVldWVfYWRkX3ZyaW5nX3NwbGl0KHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZx
LAo+ID4KPiA+ICAgICAgICAgZm9yIChuID0gMDsgbiA8IG91dF9zZ3M7IG4rKykgewo+ID4gICAg
ICAgICAgICAgICAgIGZvciAoc2cgPSBzZ3Nbbl07IHNnOyBzZyA9IHNnX25leHQoc2cpKSB7Cj4g
PiAtICAgICAgICAgICAgICAgICAgICAgICBkbWFfYWRkcl90IGFkZHIgPSB2cmluZ19tYXBfb25l
X3NnKHZxLCBzZywgRE1BX1RPX0RFVklDRSk7Cj4gPiAtICAgICAgICAgICAgICAgICAgICAgICBp
ZiAodnJpbmdfbWFwcGluZ19lcnJvcih2cSwgYWRkcikpCj4gPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGdvdG8gdW5tYXBfcmVsZWFzZTsKPiA+IC0KPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgIHByZXYgPSBpOwo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgLyogTm90ZSB0
aGF0IHdlIHRydXN0IGluZGlyZWN0IGRlc2NyaXB0b3IKPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAqIHRhYmxlIHNpbmNlIGl0IHVzZSBzdHJlYW0gRE1BIG1hcHBpbmcuCj4gPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgKi8KPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGkgPSB2aXJ0
cXVldWVfYWRkX2Rlc2Nfc3BsaXQoX3ZxLCBkZXNjLCBpLCBhZGRyLCBzZy0+bGVuZ3RoLAo+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgaSA9IHZpcnRxdWV1ZV9hZGRfZGVzY19zcGxpdChfdnEs
IGRlc2MsIGksCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHNnLT5kbWFfYWRkcmVzcywKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc2ctPmxlbmd0aCwKPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVlJJTkdfREVTQ19GX05FWFQs
Cj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGluZGlyZWN0KTsKPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiAgICAgICAgIH0KPiA+ICAgICAg
ICAgZm9yICg7IG4gPCAob3V0X3NncyArIGluX3Nncyk7IG4rKykgewo+ID4gICAgICAgICAgICAg
ICAgIGZvciAoc2cgPSBzZ3Nbbl07IHNnOyBzZyA9IHNnX25leHQoc2cpKSB7Cj4gPiAtICAgICAg
ICAgICAgICAgICAgICAgICBkbWFfYWRkcl90IGFkZHIgPSB2cmluZ19tYXBfb25lX3NnKHZxLCBz
ZywgRE1BX0ZST01fREVWSUNFKTsKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmICh2cmlu
Z19tYXBwaW5nX2Vycm9yKHZxLCBhZGRyKSkKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZ290byB1bm1hcF9yZWxlYXNlOwo+ID4gLQo+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgcHJldiA9IGk7Cj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAvKiBOb3RlIHRoYXQgd2Ug
dHJ1c3QgaW5kaXJlY3QgZGVzY3JpcHRvcgo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICog
dGFibGUgc2luY2UgaXQgdXNlIHN0cmVhbSBETUEgbWFwcGluZy4KPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAqLwo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgaSA9IHZpcnRxdWV1ZV9h
ZGRfZGVzY19zcGxpdChfdnEsIGRlc2MsIGksIGFkZHIsCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICBpID0gdmlydHF1ZXVlX2FkZF9kZXNjX3NwbGl0KF92cSwgZGVzYywgaSwKPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2ctPmRtYV9h
ZGRyZXNzLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzZy0+bGVuZ3RoLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBWUklOR19ERVNDX0ZfTkVYVCB8Cj4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZSSU5HX0RFU0NfRl9XUklU
RSwKPiA+IEBAIC02NDAsNyArNzAyLDcgQEAgc3RhdGljIGlubGluZSBpbnQgdmlydHF1ZXVlX2Fk
ZF92cmluZ19zcGxpdChzdHJ1Y3QgdnJpbmdfdmlydHF1ZXVlICp2cSwKPiA+ICAgICAgICAgICAg
ICAgICAgICAgICAgIHZxLCBkZXNjLCB0b3RhbF9zZyAqIHNpemVvZihzdHJ1Y3QgdnJpbmdfZGVz
YyksCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICBETUFfVE9fREVWSUNFKTsKPiA+ICAgICAg
ICAgICAgICAgICBpZiAodnJpbmdfbWFwcGluZ19lcnJvcih2cSwgYWRkcikpCj4gPiAtICAgICAg
ICAgICAgICAgICAgICAgICBnb3RvIHVubWFwX3JlbGVhc2U7Cj4gPiArICAgICAgICAgICAgICAg
ICAgICAgICByZXR1cm4gLUVOT01FTTsKPiA+Cj4gPiAgICAgICAgICAgICAgICAgdmlydHF1ZXVl
X2FkZF9kZXNjX3NwbGl0KF92cSwgdnEtPnNwbGl0LnZyaW5nLmRlc2MsCj4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWQsIGFkZHIsCj4gPiBAQCAtNjgwLDMw
ICs3NDIsNiBAQCBzdGF0aWMgaW5saW5lIGludCB2aXJ0cXVldWVfYWRkX3ZyaW5nX3NwbGl0KHN0
cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLAo+ID4gICAgICAgICAgICAgICAgIHZpcnRxdWV1ZV9r
aWNrKF92cSk7Cj4gPgo+ID4gICAgICAgICByZXR1cm4gMDsKPiA+IC0KPiA+IC11bm1hcF9yZWxl
YXNlOgo+ID4gLSAgICAgICBlcnJfaWR4ID0gaTsKPiA+IC0KPiA+IC0gICAgICAgaWYgKGluZGly
ZWN0KQo+ID4gLSAgICAgICAgICAgICAgIGkgPSAwOwo+ID4gLSAgICAgICBlbHNlCj4gPiAtICAg
ICAgICAgICAgICAgaSA9IGhlYWQ7Cj4gPiAtCj4gPiAtICAgICAgIGZvciAobiA9IDA7IG4gPCB0
b3RhbF9zZzsgbisrKSB7Cj4gPiAtICAgICAgICAgICAgICAgaWYgKGkgPT0gZXJyX2lkeCkKPiA+
IC0gICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gLSAgICAgICAgICAgICAgIGlmIChp
bmRpcmVjdCkgewo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgdnJpbmdfdW5tYXBfb25lX3Nw
bGl0X2luZGlyZWN0KHZxLCAmZGVzY1tpXSk7Cj4gPiAtICAgICAgICAgICAgICAgICAgICAgICBp
ID0gdmlydGlvMTZfdG9fY3B1KF92cS0+dmRldiwgZGVzY1tpXS5uZXh0KTsKPiA+IC0gICAgICAg
ICAgICAgICB9IGVsc2UKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGkgPSB2cmluZ191bm1h
cF9vbmVfc3BsaXQodnEsIGkpOwo+ID4gLSAgICAgICB9Cj4gPiAtCj4gPiAtICAgICAgIGlmIChp
bmRpcmVjdCkKPiA+IC0gICAgICAgICAgICAgICBrZnJlZShkZXNjKTsKPiA+IC0KPiA+IC0gICAg
ICAgRU5EX1VTRSh2cSk7Cj4gPiAtICAgICAgIHJldHVybiAtRU5PTUVNOwo+ID4gIH0KPiA+Cj4g
PiAgc3RhdGljIGlubGluZSBpbnQgdmlydHF1ZXVlX2FkZF9zcGxpdChzdHJ1Y3QgdmlydHF1ZXVl
ICpfdnEsCj4gPiBAQCAtNzI5LDYgKzc2NywxMCBAQCBzdGF0aWMgaW5saW5lIGludCB2aXJ0cXVl
dWVfYWRkX3NwbGl0KHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ICAgICAgICAgICAgICAgICBn
b3RvIGVuZDsKPiA+ICAgICAgICAgfQo+ID4KPiA+ICsgICAgICAgZXJyID0gdmlydHF1ZXVlX21h
cF9zZ3ModnEsIHNncywgdG90YWxfc2csIG91dF9zZ3MsIGluX3Nncyk7Cj4gPiArICAgICAgIGlm
IChlcnIpCj4gPiArICAgICAgICAgICAgICAgZ290byBlcnI7Cj4gPiArCj4gPiAgICAgICAgIGhl
YWQgPSB2cS0+ZnJlZV9oZWFkOwo+ID4gICAgICAgICBlcnIgPSB2aXJ0cXVldWVfYWRkX3ZyaW5n
X3NwbGl0KHZxLCBzZ3MsIHRvdGFsX3NnLCBvdXRfc2dzLCBpbl9zZ3MsIGRlc2MpOwo+Cj4gQW55
IHJlYXNvbiB3ZSBkb24ndCBkbyB2aXJ0cXVldWVfbWFwX3NncygpL3ZpcnRxdWV1ZV91bm1hcF9z
Z3MoKQo+IGluc2lkZSB2aXJ0cXVldWVfYWRkX3ZyaW5nX3NwbGl0KCk/CgpBcyB0aGUgYW5zd2Vy
IHRvICMxLgoKVGhhbmtzLgoKCj4KPiBUaGFua3MKPgo+Cj4gPiAgICAgICAgIGlmIChlcnIpCj4g
PiBAQCAtNzQxLDYgKzc4Myw4IEBAIHN0YXRpYyBpbmxpbmUgaW50IHZpcnRxdWV1ZV9hZGRfc3Bs
aXQoc3RydWN0IHZpcnRxdWV1ZSAqX3ZxLAo+ID4gICAgICAgICBnb3RvIGVuZDsKPiA+Cj4gPiAg
ZXJyOgo+ID4gKyAgICAgICB2aXJ0cXVldWVfdW5tYXBfc2dzKHZxLCBzZ3MsIHRvdGFsX3NnLCBv
dXRfc2dzLCBpbl9zZ3MpOwo+ID4gKwo+ID4gICAgICAgICBrZnJlZShkZXNjKTsKPiA+Cj4gPiAg
ZW5kOgo+ID4gLS0KPiA+IDIuMzIuMC4zLmcwMTE5NWNmOWYKPiA+Cj4KX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KVmlydHVhbGl6YXRpb24gbWFpbGluZyBs
aXN0ClZpcnR1YWxpemF0aW9uQGxpc3RzLmxpbnV4LWZvdW5kYXRpb24ub3JnCmh0dHBzOi8vbGlz
dHMubGludXhmb3VuZGF0aW9uLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3ZpcnR1YWxpemF0aW9u
