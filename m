Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 2A201155E34
	for <lists.virtualization@lfdr.de>; Fri,  7 Feb 2020 19:36:13 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id C539D86A78;
	Fri,  7 Feb 2020 18:36:11 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id FC-JA2Z_igND; Fri,  7 Feb 2020 18:36:09 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [140.211.9.56])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 4A26A869D1;
	Fri,  7 Feb 2020 18:36:06 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 2CAC8C013E;
	Fri,  7 Feb 2020 18:36:06 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 910E5C1D8D
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:58 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by fraxinus.osuosl.org (Postfix) with ESMTP id 7BEA2860BE
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:58 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id juGj6BX1oY5E
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:56 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx01.bbu.dsd.mx.bitdefender.com
 (mx01.bbu.dsd.mx.bitdefender.com [91.199.104.161])
 by fraxinus.osuosl.org (Postfix) with ESMTPS id 0FBB586964
 for <virtualization@lists.linux-foundation.org>;
 Fri,  7 Feb 2020 18:35:56 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp01.buh.bitdefender.com [10.17.80.75])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 11998305D355; Fri,  7 Feb 2020 20:16:41 +0200 (EET)
Received: from host.bbu.bitdefender.biz (unknown [195.210.4.22])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 02A3D305206D;
 Fri,  7 Feb 2020 20:16:41 +0200 (EET)
From: =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>
To: kvm@vger.kernel.org
Subject: [RFC PATCH v7 55/78] KVM: introspection: add KVMI_VCPU_SET_REGISTERS
Date: Fri,  7 Feb 2020 20:16:13 +0200
Message-Id: <20200207181636.1065-56-alazar@bitdefender.com>
In-Reply-To: <20200207181636.1065-1-alazar@bitdefender.com>
References: <20200207181636.1065-1-alazar@bitdefender.com>
MIME-Version: 1.0
Cc: =?UTF-8?q?Mihai=20Don=C8=9Bu?= <mdontu@bitdefender.com>,
 Sean Christopherson <sean.j.christopherson@intel.com>,
 virtualization@lists.linux-foundation.org,
 =?UTF-8?q?Adalbert=20Laz=C4=83r?= <alazar@bitdefender.com>,
 =?UTF-8?q?Mircea=20C=C3=AErjaliu?= <mcirjaliu@bitdefender.com>,
 Paolo Bonzini <pbonzini@redhat.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

RnJvbTogTWloYWkgRG9uyJt1IDxtZG9udHVAYml0ZGVmZW5kZXIuY29tPgoKVGhpcyBjb21tYW5k
IGlzIGFsbG93ZWQgb25seSBkdXJpbmcgYSB2Q1BVIGV2ZW50IChhbiBldmVudCBoYXMgYmVlbiBz
ZW50CmFuZCB0aGUgdkNQVSBpcyB3YWl0aW5nIGZvciB0aGUgcmVwbHkpLiBUaGUgcmVnaXN0ZXJz
IHdpbGwgYmUgc2V0IG9ubHkKd2hlbiB0aGUgcmVwbHkgaGFzIGJlZW4gcmVjZWl2ZWQuCgpTaWdu
ZWQtb2ZmLWJ5OiBNaWhhaSBEb27Im3UgPG1kb250dUBiaXRkZWZlbmRlci5jb20+CkNvLWRldmVs
b3BlZC1ieTogTWlyY2VhIEPDrnJqYWxpdSA8bWNpcmphbGl1QGJpdGRlZmVuZGVyLmNvbT4KU2ln
bmVkLW9mZi1ieTogTWlyY2VhIEPDrnJqYWxpdSA8bWNpcmphbGl1QGJpdGRlZmVuZGVyLmNvbT4K
Q28tZGV2ZWxvcGVkLWJ5OiBBZGFsYmVydCBMYXrEg3IgPGFsYXphckBiaXRkZWZlbmRlci5jb20+
ClNpZ25lZC1vZmYtYnk6IEFkYWxiZXJ0IExhesSDciA8YWxhemFyQGJpdGRlZmVuZGVyLmNvbT4K
LS0tCiBEb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0ICAgICAgICAgICAgICAgfCAyOSAr
KysrKysrCiBpbmNsdWRlL2xpbnV4L2t2bWlfaG9zdC5oICAgICAgICAgICAgICAgICAgICAgfCAg
MyArCiBpbmNsdWRlL3VhcGkvbGludXgva3ZtaS5oICAgICAgICAgICAgICAgICAgICAgfCAgMSAr
CiAuLi4vdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyAgfCA4MiArKysr
KysrKysrKysrKysrKysrCiB2aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWkuYyAgICAgICAgICAg
ICAgICAgfCAyNCArKysrKysKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9pbnQuaCAgICAg
ICAgICAgICB8ICA0ICsKIHZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYyAgICAgICAg
ICAgICB8IDE1ICsrKysKIDcgZmlsZXMgY2hhbmdlZCwgMTU4IGluc2VydGlvbnMoKykKCmRpZmYg
LS1naXQgYS9Eb2N1bWVudGF0aW9uL3ZpcnQva3ZtL2t2bWkucnN0IGIvRG9jdW1lbnRhdGlvbi92
aXJ0L2t2bS9rdm1pLnJzdAppbmRleCA1YzM2NmJjZDMxMTIuLmZmMWZlNWVjMmUxOCAxMDA2NDQK
LS0tIGEvRG9jdW1lbnRhdGlvbi92aXJ0L2t2bS9rdm1pLnJzdAorKysgYi9Eb2N1bWVudGF0aW9u
L3ZpcnQva3ZtL2t2bWkucnN0CkBAIC01ODksNiArNTg5LDM1IEBAIHJlZ2lzdGVycywgdGhlIHNw
ZWNpYWwgcmVnaXN0ZXJzIGFuZCB0aGUgcmVxdWVzdGVkIHNldCBvZiBNU1JzLgogKiAtS1ZNX0VB
R0FJTiAtIHRoZSBzZWxlY3RlZCB2Q1BVIGNhbid0IGJlIGludHJvc3BlY3RlZCB5ZXQKICogLUtW
TV9FTk9NRU0gLSBub3QgZW5vdWdoIG1lbW9yeSB0byBhbGxvY2F0ZSB0aGUgcmVwbHkKIAorMTIu
IEtWTUlfVkNQVV9TRVRfUkVHSVNURVJTCistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKwor
OkFyY2hpdGVjdHVyZXM6IHg4NgorOlZlcnNpb25zOiA+PSAxCis6UGFyYW1ldGVyczoKKworOjoK
KworCXN0cnVjdCBrdm1pX3ZjcHVfaGRyOworCXN0cnVjdCBrdm1fcmVnczsKKworOlJldHVybnM6
CisKKzo6CisKKwlzdHJ1Y3Qga3ZtaV9lcnJvcl9jb2RlCisKK1NldHMgdGhlIGdlbmVyYWwgcHVy
cG9zZSByZWdpc3RlcnMgZm9yIHRoZSBnaXZlbiB2Q1BVLiBUaGUgY2hhbmdlcyBiZWNvbWUKK3Zp
c2libGUgdG8gb3RoZXIgdGhyZWFkcyBhY2Nlc3NpbmcgdGhlIEtWTSB2Q1BVIHN0cnVjdHVyZSBh
ZnRlciB0aGUgZXZlbnQKK2N1cnJlbnRseSBiZWluZyBoYW5kbGVkIGlzIHJlcGxpZWQgdG8uCisK
KzpFcnJvcnM6CisKKyogLUtWTV9FSU5WQUwgLSB0aGUgc2VsZWN0ZWQgdkNQVSBpcyBpbnZhbGlk
CisqIC1LVk1fRUlOVkFMIC0gcGFkZGluZyBpcyBub3QgemVybworKiAtS1ZNX0VBR0FJTiAtIHRo
ZSBzZWxlY3RlZCB2Q1BVIGNhbid0IGJlIGludHJvc3BlY3RlZCB5ZXQKKyogLUtWTV9FT1BOT1RT
VVBQIC0gdGhlIGNvbW1hbmQgaGFzbid0IGJlZW4gcmVjZWl2ZWQgZHVyaW5nIGFuIGludHJvc3Bl
Y3Rpb24gZXZlbnQKKwogRXZlbnRzCiA9PT09PT0KIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51
eC9rdm1pX2hvc3QuaCBiL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmgKaW5kZXggZGE2MjFkODNj
ZDk0Li42OGM3NmRiODM5NzMgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbGludXgva3ZtaV9ob3N0LmgK
KysrIGIvaW5jbHVkZS9saW51eC9rdm1pX2hvc3QuaApAQCAtMzgsNiArMzgsOSBAQCBzdHJ1Y3Qg
a3ZtX3ZjcHVfaW50cm9zcGVjdGlvbiB7CiAJYm9vbCB3YWl0aW5nX2Zvcl9yZXBseTsKIAogCURF
Q0xBUkVfQklUTUFQKGV2X21hc2ssIEtWTUlfTlVNX0VWRU5UUyk7CisKKwlzdHJ1Y3Qga3ZtX3Jl
Z3MgZGVsYXllZF9yZWdzOworCWJvb2wgaGF2ZV9kZWxheWVkX3JlZ3M7CiB9OwogCiBzdHJ1Y3Qg
a3ZtX2ludHJvc3BlY3Rpb24gewpkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xpbnV4L2t2bWku
aCBiL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKaW5kZXggYmRiNWY5NzdjMjQwLi40ZDVmNjMx
N2RiMDMgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvdWFwaS9saW51eC9rdm1pLmgKKysrIGIvaW5jbHVk
ZS91YXBpL2xpbnV4L2t2bWkuaApAQCAtMzAsNiArMzAsNyBAQCBlbnVtIHsKIAlLVk1JX1ZDUFVf
UEFVU0UgICAgICAgICAgPSAxMCwKIAlLVk1JX1ZDUFVfQ09OVFJPTF9FVkVOVFMgPSAxMSwKIAlL
Vk1JX1ZDUFVfR0VUX1JFR0lTVEVSUyAgPSAxMiwKKwlLVk1JX1ZDUFVfU0VUX1JFR0lTVEVSUyAg
PSAxMywKIAogCUtWTUlfTlVNX01FU1NBR0VTCiB9OwpkaWZmIC0tZ2l0IGEvdG9vbHMvdGVzdGlu
Zy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3QuYyBiL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRl
c3RzL2t2bS94ODZfNjQva3ZtaV90ZXN0LmMKaW5kZXggNWQ3NmQ0OWJjMjc3Li42ZTQ0OTAzNDBi
MzYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3Rlc3Rpbmcvc2VsZnRlc3RzL2t2bS94ODZfNjQva3ZtaV90
ZXN0LmMKKysrIGIvdG9vbHMvdGVzdGluZy9zZWxmdGVzdHMva3ZtL3g4Nl82NC9rdm1pX3Rlc3Qu
YwpAQCAtODI4LDYgKzgyOCw4NyBAQCBzdGF0aWMgdm9pZCB0ZXN0X2NtZF92Y3B1X2dldF9yZWdp
c3RlcnMoc3RydWN0IGt2bV92bSAqdm0pCiAJREVCVUcoImdldF9yZWdpc3RlcnMgcmlwIDB4JWxs
eFxuIiwgcmVncy5yaXApOwogfQogCitzdGF0aWMgaW50IF9fY21kX3NldF9yZWdpc3RlcnMoc3Ry
dWN0IGt2bV92bSAqdm0sCisJCQkgICAgICAgc3RydWN0IGt2bV9yZWdzICpyZWdzKQoreworCXN0
cnVjdCB7CisJCXN0cnVjdCBrdm1pX21zZ19oZHIgaGRyOworCQlzdHJ1Y3Qga3ZtaV92Y3B1X2hk
ciB2Y3B1X2hkcjsKKwkJc3RydWN0IGt2bV9yZWdzIHJlZ3M7CisJfSByZXEgPSB7fTsKKwlfX3Ux
NiB2Y3B1X2luZGV4ID0gMDsKKworCXJlcS52Y3B1X2hkci52Y3B1ID0gdmNwdV9pbmRleDsKKwor
CW1lbWNweSgmcmVxLnJlZ3MsIHJlZ3MsIHNpemVvZihyZXEucmVncykpOworCisJcmV0dXJuIGRv
X2NvbW1hbmQoS1ZNSV9WQ1BVX1NFVF9SRUdJU1RFUlMsCisJCQkgICZyZXEuaGRyLCBzaXplb2Yo
cmVxKSwgTlVMTCwgMCk7Cit9CisKK3N0YXRpYyBpbnQgY21kX3NldF9yZWdpc3RlcnMoc3RydWN0
IGt2bV92bSAqdm0sCisJCQkgICAgIHN0cnVjdCBrdm1fcmVncyAqcmVncykKK3sKKwlzdHJ1Y3Qg
dmNwdV93b3JrZXJfZGF0YSBkYXRhID0gey52bSA9IHZtLCAudmNwdV9pZCA9IFZDUFVfSUR9Owor
CXB0aHJlYWRfdCB2Y3B1X3RocmVhZDsKKwlpbnQgcjsKKworCXZjcHVfdGhyZWFkID0gc3RhcnRf
dmNwdV93b3JrZXIoJmRhdGEpOworCisJciA9IF9fY21kX3NldF9yZWdpc3RlcnModm0sIHJlZ3Mp
OworCisJc3RvcF92Y3B1X3dvcmtlcih2Y3B1X3RocmVhZCwgJmRhdGEpOworCisJcmV0dXJuIHI7
Cit9CisKK3N0YXRpYyB2b2lkIF9fc2V0X3JlZ2lzdGVycyhzdHJ1Y3Qga3ZtX3ZtICp2bSwKKwkJ
CSAgICBzdHJ1Y3Qga3ZtX3JlZ3MgKnJlZ3MpCit7CisJaW50IHI7CisKKwlyID0gX19jbWRfc2V0
X3JlZ2lzdGVycyh2bSwgcmVncyk7CisJVEVTVF9BU1NFUlQociA9PSAwLAorCQkiS1ZNSV9WQ1BV
X1NFVF9SRUdJU1RFUlMgZmFpbGVkLCBlcnJvciAlZCglcylcbiIsCisJCS1yLCBrdm1fc3RyZXJy
b3IoLXIpKTsKK30KKworc3RhdGljIHZvaWQgdGVzdF9jbWRfdmNwdV9zZXRfcmVnaXN0ZXJzKHN0
cnVjdCBrdm1fdm0gKnZtKQoreworCXN0cnVjdCB2Y3B1X3dvcmtlcl9kYXRhIGRhdGEgPSB7LnZt
ID0gdm0sIC52Y3B1X2lkID0gVkNQVV9JRH07CisJX191MTYgZXZlbnRfaWQgPSBLVk1JX0VWRU5U
X1BBVVNFX1ZDUFU7CisJc3RydWN0IGt2bWlfbXNnX2hkciBoZHI7CisJcHRocmVhZF90IHZjcHVf
dGhyZWFkOworCXN0cnVjdCBrdm1pX2V2ZW50IGV2OworCXN0cnVjdCB2Y3B1X3JlcGx5IHJwbCA9
IHt9OworCXN0cnVjdCBrdm1fcmVncyByZWdzID0ge307CisJaW50IHI7CisKKwlnZXRfdmNwdV9y
ZWdpc3RlcnModm0sICZyZWdzKTsKKworCXIgPSBjbWRfc2V0X3JlZ2lzdGVycyh2bSwgJnJlZ3Mp
OworCVRFU1RfQVNTRVJUKHIgPT0gLUtWTV9FT1BOT1RTVVBQLAorCQkiS1ZNSV9WQ1BVX1NFVF9S
RUdJU1RFUlMgZGlkbid0IGZhaWxlZCB3aXRoIEtWTV9FT1BOT1RTVVBQLCBlcnJvciAlZCglcylc
biIsCisJCS1yLCBrdm1fc3RyZXJyb3IoLXIpKTsKKworCWVuYWJsZV92Y3B1X2V2ZW50KHZtLCBl
dmVudF9pZCk7CisKKwlwYXVzZV92Y3B1KHZtKTsKKworCXZjcHVfdGhyZWFkID0gc3RhcnRfdmNw
dV93b3JrZXIoJmRhdGEpOworCisJcmVjZWl2ZV9ldmVudCgmaGRyLCAmZXYsIHNpemVvZihldiks
IGV2ZW50X2lkKTsKKworCV9fc2V0X3JlZ2lzdGVycyh2bSwgJmV2LmFyY2gucmVncyk7CisKKwly
ZXBseV90b19ldmVudCgmaGRyLCAmZXYsIEtWTUlfRVZFTlRfQUNUSU9OX0NPTlRJTlVFLAorCQkJ
JnJwbCwgc2l6ZW9mKHJwbCkpOworCisJc3RvcF92Y3B1X3dvcmtlcih2Y3B1X3RocmVhZCwgJmRh
dGEpOworCisJZGlzYWJsZV92Y3B1X2V2ZW50KHZtLCBldmVudF9pZCk7Cit9CisKIHN0YXRpYyB2
b2lkIHRlc3RfaW50cm9zcGVjdGlvbihzdHJ1Y3Qga3ZtX3ZtICp2bSkKIHsKIAlzZXR1cF9zb2Nr
ZXQoKTsKQEAgLTg0NSw2ICs5MjYsNyBAQCBzdGF0aWMgdm9pZCB0ZXN0X2ludHJvc3BlY3Rpb24o
c3RydWN0IGt2bV92bSAqdm0pCiAJdGVzdF9wYXVzZSh2bSk7CiAJdGVzdF9jbWRfdmNwdV9jb250
cm9sX2V2ZW50cyh2bSk7CiAJdGVzdF9jbWRfdmNwdV9nZXRfcmVnaXN0ZXJzKHZtKTsKKwl0ZXN0
X2NtZF92Y3B1X3NldF9yZWdpc3RlcnModm0pOwogCiAJdW5ob29rX2ludHJvc3BlY3Rpb24odm0p
OwogfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMgYi92aXJ0L2t2
bS9pbnRyb3NwZWN0aW9uL2t2bWkuYwppbmRleCBmNGZmOTk2OGJkNTguLjhmZmJmNDZiYzE3ZCAx
MDA2NDQKLS0tIGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pLmMKKysrIGIvdmlydC9rdm0v
aW50cm9zcGVjdGlvbi9rdm1pLmMKQEAgLTgwNCwzICs4MDQsMjcgQEAgaW50IGt2bWlfY21kX3Zj
cHVfcGF1c2Uoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBib29sIHdhaXQpCiAKIAlyZXR1cm4gMDsK
IH0KKworaW50IGt2bWlfY21kX3ZjcHVfc2V0X3JlZ2lzdGVycyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZj
cHUsCisJCQkJY29uc3Qgc3RydWN0IGt2bV9yZWdzICpyZWdzKQoreworCXN0cnVjdCBrdm1fdmNw
dV9pbnRyb3NwZWN0aW9uICp2Y3B1aSA9IFZDUFVJKHZjcHUpOworCisJaWYgKCF2Y3B1aS0+d2Fp
dGluZ19mb3JfcmVwbHkpCisJCXJldHVybiAtS1ZNX0VPUE5PVFNVUFA7CisKKwltZW1jcHkoJnZj
cHVpLT5kZWxheWVkX3JlZ3MsIHJlZ3MsIHNpemVvZih2Y3B1aS0+ZGVsYXllZF9yZWdzKSk7CisJ
dmNwdWktPmhhdmVfZGVsYXllZF9yZWdzID0gdHJ1ZTsKKworCXJldHVybiAwOworfQorCit2b2lk
IGt2bWlfcG9zdF9yZXBseShzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCit7CisJc3RydWN0IGt2bV92
Y3B1X2ludHJvc3BlY3Rpb24gKnZjcHVpID0gVkNQVUkodmNwdSk7CisKKwlpZiAodmNwdWktPmhh
dmVfZGVsYXllZF9yZWdzKSB7CisJCWt2bV9hcmNoX3ZjcHVfc2V0X3JlZ3ModmNwdSwgJnZjcHVp
LT5kZWxheWVkX3JlZ3MsIGZhbHNlKTsKKwkJdmNwdWktPmhhdmVfZGVsYXllZF9yZWdzID0gZmFs
c2U7CisJfQorfQpkaWZmIC0tZ2l0IGEvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5o
IGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCmluZGV4IDVjOWJhNGIxMTA3ZS4u
YTczNmYzNjRmNWJlIDEwMDY0NAotLS0gYS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfaW50
LmgKKysrIGIvdmlydC9rdm0vaW50cm9zcGVjdGlvbi9rdm1pX2ludC5oCkBAIC0zOSw2ICszOSw3
IEBACiAJCQl8IEJJVChLVk1JX1ZDUFVfUEFVU0UpIFwKIAkJCXwgQklUKEtWTUlfVkNQVV9DT05U
Uk9MX0VWRU5UUykgXAogCQkJfCBCSVQoS1ZNSV9WQ1BVX0dFVF9SRUdJU1RFUlMpIFwKKwkJCXwg
QklUKEtWTUlfVkNQVV9TRVRfUkVHSVNURVJTKSBcCiAJCSkKIAogI2RlZmluZSBLVk1JKGt2bSkg
KChzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rpb24gKikoKGt2bSktPmt2bWkpKQpAQCAtNjYsNiArNjcs
NyBAQCBpbnQga3ZtaV9hZGRfam9iKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKIAkJIHZvaWQgKCpm
Y3QpKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdm9pZCAqY3R4KSwKIAkJIHZvaWQgKmN0eCwgdm9p
ZCAoKmZyZWVfZmN0KSh2b2lkICpjdHgpKTsKIHZvaWQga3ZtaV9ydW5fam9icyhzdHJ1Y3Qga3Zt
X3ZjcHUgKnZjcHUpOwordm9pZCBrdm1pX3Bvc3RfcmVwbHkoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
KTsKIGludCBrdm1pX2NtZF92bV9jb250cm9sX2V2ZW50cyhzdHJ1Y3Qga3ZtX2ludHJvc3BlY3Rp
b24gKmt2bWksCiAJCQkJdW5zaWduZWQgaW50IGV2ZW50X2lkLCBib29sIGVuYWJsZSk7CiBpbnQg
a3ZtaV9jbWRfdmNwdV9jb250cm9sX2V2ZW50cyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCkBAIC03
OCw2ICs4MCw4IEBAIGludCBrdm1pX2NtZF9yZWFkX3BoeXNpY2FsKHN0cnVjdCBrdm0gKmt2bSwg
dTY0IGdwYSwgdTY0IHNpemUsCiBpbnQga3ZtaV9jbWRfd3JpdGVfcGh5c2ljYWwoc3RydWN0IGt2
bSAqa3ZtLCB1NjQgZ3BhLCB1NjQgc2l6ZSwKIAkJCSAgICBjb25zdCB2b2lkICpidWYpOwogaW50
IGt2bWlfY21kX3ZjcHVfcGF1c2Uoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCBib29sIHdhaXQpOwor
aW50IGt2bWlfY21kX3ZjcHVfc2V0X3JlZ2lzdGVycyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCisJ
CQkJY29uc3Qgc3RydWN0IGt2bV9yZWdzICpyZWdzKTsKIAogLyogYXJjaCAqLwogaW50IGt2bWlf
YXJjaF9jbWRfdmNwdV9nZXRfaW5mbyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUsCmRpZmYgLS1naXQg
YS92aXJ0L2t2bS9pbnRyb3NwZWN0aW9uL2t2bWlfbXNnLmMgYi92aXJ0L2t2bS9pbnRyb3NwZWN0
aW9uL2t2bWlfbXNnLmMKaW5kZXggNGE3YzgzMTE4M2JiLi4xMWUwMTcxMDc2YzcgMTAwNjQ0Ci0t
LSBhL3ZpcnQva3ZtL2ludHJvc3BlY3Rpb24va3ZtaV9tc2cuYworKysgYi92aXJ0L2t2bS9pbnRy
b3NwZWN0aW9uL2t2bWlfbXNnLmMKQEAgLTI5LDYgKzI5LDcgQEAgc3RhdGljIGNvbnN0IGNoYXIg
KmNvbnN0IG1zZ19JRHNbXSA9IHsKIAlbS1ZNSV9WQ1BVX0dFVF9JTkZPXSAgICAgICA9ICJLVk1J
X1ZDUFVfR0VUX0lORk8iLAogCVtLVk1JX1ZDUFVfR0VUX1JFR0lTVEVSU10gID0gIktWTUlfVkNQ
VV9HRVRfUkVHSVNURVJTIiwKIAlbS1ZNSV9WQ1BVX1BBVVNFXSAgICAgICAgICA9ICJLVk1JX1ZD
UFVfUEFVU0UiLAorCVtLVk1JX1ZDUFVfU0VUX1JFR0lTVEVSU10gID0gIktWTUlfVkNQVV9TRVRf
UkVHSVNURVJTIiwKIH07CiAKIHN0YXRpYyBib29sIGlzX2tub3duX21lc3NhZ2UodTE2IGlkKQpA
QCAtNDUxLDYgKzQ1MiwxOCBAQCBzdGF0aWMgaW50IGhhbmRsZV9nZXRfcmVnaXN0ZXJzKGNvbnN0
IHN0cnVjdCBrdm1pX3ZjcHVfY21kX2pvYiAqam9iLAogCXJldHVybiBlcnI7CiB9CiAKK3N0YXRp
YyBpbnQgaGFuZGxlX3NldF9yZWdpc3RlcnMoY29uc3Qgc3RydWN0IGt2bWlfdmNwdV9jbWRfam9i
ICpqb2IsCisJCQkJY29uc3Qgc3RydWN0IGt2bWlfbXNnX2hkciAqbXNnLAorCQkJCWNvbnN0IHZv
aWQgKl9yZXEpCit7CisJY29uc3Qgc3RydWN0IGt2bV9yZWdzICpyZWdzID0gX3JlcTsKKwlpbnQg
ZWM7CisKKwllYyA9IGt2bWlfY21kX3ZjcHVfc2V0X3JlZ2lzdGVycyhqb2ItPnZjcHUsIHJlZ3Mp
OworCisJcmV0dXJuIGt2bWlfbXNnX3ZjcHVfcmVwbHkoam9iLCBtc2csIGVjLCBOVUxMLCAwKTsK
K30KKwogLyoKICAqIFRoZXNlIGNvbW1hbmRzIGFyZSBleGVjdXRlZCBvbiB0aGUgdkNQVSB0aHJl
YWQuIFRoZSByZWNlaXZpbmcgdGhyZWFkCiAgKiBwYXNzZXMgdGhlIG1lc3NhZ2VzIHVzaW5nIGEg
bmV3bHkgYWxsb2NhdGVkICdzdHJ1Y3Qga3ZtaV92Y3B1X2NtZF9qb2InCkBAIC00NjMsNiArNDc2
LDcgQEAgc3RhdGljIGludCgqY29uc3QgbXNnX3ZjcHVbXSkoY29uc3Qgc3RydWN0IGt2bWlfdmNw
dV9jbWRfam9iICosCiAJW0tWTUlfVkNQVV9DT05UUk9MX0VWRU5UU10gPSBoYW5kbGVfdmNwdV9j
b250cm9sX2V2ZW50cywKIAlbS1ZNSV9WQ1BVX0dFVF9JTkZPXSAgICAgICA9IGhhbmRsZV9nZXRf
dmNwdV9pbmZvLAogCVtLVk1JX1ZDUFVfR0VUX1JFR0lTVEVSU10gID0gaGFuZGxlX2dldF9yZWdp
c3RlcnMsCisJW0tWTUlfVkNQVV9TRVRfUkVHSVNURVJTXSAgPSBoYW5kbGVfc2V0X3JlZ2lzdGVy
cywKIH07CiAKIHN0YXRpYyB2b2lkIGt2bWlfam9iX3ZjcHVfY21kKHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSwgdm9pZCAqY3R4KQpAQCAtODE4LDYgKzgzMiw3IEBAIHN0YXRpYyBpbnQga3ZtaV9zZW5k
X2V2ZW50KHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTMyIGV2X2lkLAogCWlmIChlcnIpCiAJCWdv
dG8gb3V0OwogCisJa3ZtaV9wb3N0X3JlcGx5KHZjcHUpOwogCSphY3Rpb24gPSB2Y3B1aS0+cmVw
bHkuYWN0aW9uOwogCiBvdXQ6Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBsaXN0
cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5vcmcv
bWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
