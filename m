Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp2.osuosl.org (smtp2.osuosl.org [140.211.166.133])
	by mail.lfdr.de (Postfix) with ESMTPS id BBDEF4A3401
	for <lists.virtualization@lfdr.de>; Sun, 30 Jan 2022 05:43:12 +0100 (CET)
Received: from localhost (localhost [127.0.0.1])
	by smtp2.osuosl.org (Postfix) with ESMTP id 3934240342;
	Sun, 30 Jan 2022 04:43:11 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp2.osuosl.org ([127.0.0.1])
	by localhost (smtp2.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id tz0LkHunkoKm; Sun, 30 Jan 2022 04:43:09 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp2.osuosl.org (Postfix) with ESMTPS id CD0B7400E0;
	Sun, 30 Jan 2022 04:43:08 +0000 (UTC)
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 51C75C0073;
	Sun, 30 Jan 2022 04:43:08 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp3.osuosl.org (smtp3.osuosl.org [IPv6:2605:bc80:3010::136])
 by lists.linuxfoundation.org (Postfix) with ESMTP id 94508C000B
 for <virtualization@lists.linux-foundation.org>;
 Sun, 30 Jan 2022 04:43:06 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp3.osuosl.org (Postfix) with ESMTP id 6A44360B48
 for <virtualization@lists.linux-foundation.org>;
 Sun, 30 Jan 2022 04:43:06 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Authentication-Results: smtp3.osuosl.org (amavisd-new);
 dkim=pass (1024-bit key) header.d=redhat.com
Received: from smtp3.osuosl.org ([127.0.0.1])
 by localhost (smtp3.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id DxEMDig9Gczm
 for <virtualization@lists.linux-foundation.org>;
 Sun, 30 Jan 2022 04:43:05 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.129.124])
 by smtp3.osuosl.org (Postfix) with ESMTPS id D6BF4607D0
 for <virtualization@lists.linux-foundation.org>;
 Sun, 30 Jan 2022 04:43:04 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1643517783;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=b2drNTCNkwJABK5/bzrkE2Qv3Y+XGpam7FKWmJlBdG8=;
 b=ZVnidb+GyHpZZ1HRMiYP7/jx97khkXHuMD+WhZppOwN6FTgVORRbFzPeF6pBt2ElcbwW3o
 B7VQuVPnBoSz6HDoFdsodWNiyCTiqbeqct6eHgCNPCj9aNurfYTyjMaQJ+jAgmE2d6uWzR
 rIk79n/czMotLWRkyD/Ow4LHsxCu11c=
Received: from mail-pj1-f69.google.com (mail-pj1-f69.google.com
 [209.85.216.69]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 us-mta-645-SyqPBMTZMhisUz10--4TEw-1; Sat, 29 Jan 2022 23:43:01 -0500
X-MC-Unique: SyqPBMTZMhisUz10--4TEw-1
Received: by mail-pj1-f69.google.com with SMTP id
 x4-20020a17090ab00400b001b58c484826so8998822pjq.0
 for <virtualization@lists.linux-foundation.org>;
 Sat, 29 Jan 2022 20:43:01 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20210112;
 h=x-gm-message-state:message-id:date:mime-version:user-agent:subject
 :content-language:to:cc:references:from:in-reply-to
 :content-transfer-encoding;
 bh=b2drNTCNkwJABK5/bzrkE2Qv3Y+XGpam7FKWmJlBdG8=;
 b=WRa9BdHG4GlCTcr5RZexbIQkMrrlZld8n1avPCSvbh9CIy2CXT0YFoy9UJhHaqRcPM
 w2tiqmv3S8o4i1RqNOQvwfaw9zdGGafRjiXZoZbCse8afO29nQ2qL93gPfBwi3smxuLP
 BgrpbSbadtp/b008S8ZWs2At/+Au2kVgTkkJrsDSlQSdk1YzSfcYkQX26pfUpGbBBZz8
 D5Tyvj99NtvPphlQBiVz4XbKPtwlDo+jAy5GzuGRDmH0fI7empa3ysku4pG1seEGnmTg
 ppHA9KeYX5HmcR2iX7n62aKy0EZCAEvgc/85HYnKYDFUmyJppRtLyixjRSdZteDwW0DM
 LwZg==
X-Gm-Message-State: AOAM532M2fFv60vT1sKLn/bSP2PlonC3Xo9G+MemAr4AtoSDbX7nB9Zw
 tohVEoUfXAzG+VoG8uZ0vxdADlr5dKd1bhvLAeoDYQcgP5pk+ABwNpZbMLR/QKivpjW4ik+oZEO
 20QqQfXn9wssSyh6MigpTpxvl2tYty/3slc9USp2wEw==
X-Received: by 2002:a05:6a00:14cc:: with SMTP id
 w12mr14774264pfu.47.1643517780584; 
 Sat, 29 Jan 2022 20:43:00 -0800 (PST)
X-Google-Smtp-Source: ABdhPJyHwZkhnrIFy+LQWFKt5x7QLQ24RCeeTJpFcEaHvUcHjHXhwWTDpqN3V2x9WpK0HEtWuzkjgw==
X-Received: by 2002:a05:6a00:14cc:: with SMTP id
 w12mr14774228pfu.47.1643517780114; 
 Sat, 29 Jan 2022 20:43:00 -0800 (PST)
Received: from [10.72.13.18] ([209.132.188.80])
 by smtp.gmail.com with ESMTPSA id q12sm14936965pfk.199.2022.01.29.20.42.50
 (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
 Sat, 29 Jan 2022 20:42:59 -0800 (PST)
Message-ID: <6c98f4e8-8695-ab83-ae37-2d6293a1fafa@redhat.com>
Date: Sun, 30 Jan 2022 12:42:44 +0800
MIME-Version: 1.0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:91.0)
 Gecko/20100101 Thunderbird/91.5.1
Subject: Re: [PATCH 18/31] vhost: Shadow virtqueue buffers forwarding
To: =?UTF-8?Q?Eugenio_P=c3=a9rez?= <eperezma@redhat.com>, qemu-devel@nongnu.org
References: <20220121202733.404989-1-eperezma@redhat.com>
 <20220121202733.404989-19-eperezma@redhat.com>
From: Jason Wang <jasowang@redhat.com>
In-Reply-To: <20220121202733.404989-19-eperezma@redhat.com>
Authentication-Results: relay.mimecast.com;
 auth=pass smtp.auth=CUSA124A263 smtp.mailfrom=jasowang@redhat.com
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Content-Language: en-US
Cc: Laurent Vivier <lvivier@redhat.com>, Parav Pandit <parav@mellanox.com>,
 Cindy Lu <lulu@redhat.com>, "Michael S. Tsirkin" <mst@redhat.com>,
 Richard Henderson <richard.henderson@linaro.org>,
 Markus Armbruster <armbru@redhat.com>, Gautam Dawar <gdawar@xilinx.com>,
 virtualization@lists.linux-foundation.org,
 Eduardo Habkost <ehabkost@redhat.com>,
 Harpreet Singh Anand <hanand@xilinx.com>, Xiao W Wang <xiao.w.wang@intel.com>,
 Stefan Hajnoczi <stefanha@redhat.com>, Eli Cohen <eli@mellanox.com>,
 Paolo Bonzini <pbonzini@redhat.com>, Zhu Lingshan <lingshan.zhu@intel.com>,
 Eric Blake <eblake@redhat.com>
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

CuWcqCAyMDIyLzEvMjIg5LiK5Y2INDoyNywgRXVnZW5pbyBQw6lyZXog5YaZ6YGTOgo+IEluaXRp
YWwgdmVyc2lvbiBvZiBzaGFkb3cgdmlydHF1ZXVlIHRoYXQgYWN0dWFsbHkgZm9yd2FyZCBidWZm
ZXJzLiBUaGVyZQo+IGlzIG5vIGlvbW11IHN1cHBvcnQgYXQgdGhlIG1vbWVudCwgYW5kIHRoYXQg
d2lsbCBiZSBhZGRyZXNzZWQgaW4gZnV0dXJlCj4gcGF0Y2hlcyBvZiB0aGlzIHNlcmllcy4gU2lu
Y2UgYWxsIHZob3N0LXZkcGEgZGV2aWNlcyB1c2UgZm9yY2VkIElPTU1VLAo+IHRoaXMgbWVhbnMg
dGhhdCBTVlEgaXMgbm90IHVzYWJsZSBhdCB0aGlzIHBvaW50IG9mIHRoZSBzZXJpZXMgb24gYW55
Cj4gZGV2aWNlLgo+Cj4gRm9yIHNpbXBsaWNpdHkgaXQgb25seSBzdXBwb3J0cyBtb2Rlcm4gZGV2
aWNlcywgdGhhdCBleHBlY3RzIHZyaW5nCj4gaW4gbGl0dGxlIGVuZGlhbiwgd2l0aCBzcGxpdCBy
aW5nIGFuZCBubyBldmVudCBpZHggb3IgaW5kaXJlY3QKPiBkZXNjcmlwdG9ycy4gU3VwcG9ydCBm
b3IgdGhlbSB3aWxsIG5vdCBiZSBhZGRlZCBpbiB0aGlzIHNlcmllcy4KPgo+IEl0IHJldXNlcyB0
aGUgVmlydFF1ZXVlIGNvZGUgZm9yIHRoZSBkZXZpY2UgcGFydC4gVGhlIGRyaXZlciBwYXJ0IGlz
Cj4gYmFzZWQgb24gTGludXgncyB2aXJ0aW9fcmluZyBkcml2ZXIsIGJ1dCB3aXRoIHN0cmlwcGVk
IGZ1bmN0aW9uYWxpdHkKPiBhbmQgb3B0aW1pemF0aW9ucyBzbyBpdCdzIGVhc2llciB0byByZXZp
ZXcuCj4KPiBIb3dldmVyLCBmb3J3YXJkaW5nIGJ1ZmZlcnMgaGF2ZSBzb21lIHBhcnRpY3VsYXIg
cGllY2VzOiBPbmUgb2YgdGhlIG1vc3QKPiB1bmV4cGVjdGVkIG9uZXMgaXMgdGhhdCBhIGd1ZXN0
J3MgYnVmZmVyIGNhbiBleHBhbmQgdGhyb3VnaCBtb3JlIHRoYW4KPiBvbmUgZGVzY3JpcHRvciBp
biBTVlEuIFdoaWxlIHRoaXMgaXMgaGFuZGxlZCBncmFjZWZ1bGx5IGJ5IHFlbXUncwo+IGVtdWxh
dGVkIHZpcnRpbyBkZXZpY2VzLCBpdCBtYXkgY2F1c2UgdW5leHBlY3RlZCBTVlEgcXVldWUgZnVs
bC4gVGhpcwo+IHBhdGNoIGFsc28gc29sdmVzIGl0IGJ5IGNoZWNraW5nIGZvciB0aGlzIGNvbmRp
dGlvbiBhdCBib3RoIGd1ZXN0J3MKPiBraWNrcyBhbmQgZGV2aWNlJ3MgY2FsbHMuIFRoZSBjb2Rl
IG1heSBiZSBtb3JlIGVsZWdhbnQgaW4gdGhlIGZ1dHVyZSBpZgo+IFNWUSBjb2RlIHJ1bnMgaW4g
aXRzIG93biBpb2NvbnRleHQuCj4KPiBTaWduZWQtb2ZmLWJ5OiBFdWdlbmlvIFDDqXJleiA8ZXBl
cmV6bWFAcmVkaGF0LmNvbT4KPiAtLS0KPiAgIGh3L3ZpcnRpby92aG9zdC1zaGFkb3ctdmlydHF1
ZXVlLmggfCAgIDIgKwo+ICAgaHcvdmlydGlvL3Zob3N0LXNoYWRvdy12aXJ0cXVldWUuYyB8IDM2
NSArKysrKysrKysrKysrKysrKysrKysrKysrKysrLQo+ICAgaHcvdmlydGlvL3Zob3N0LXZkcGEu
YyAgICAgICAgICAgICB8IDExMSArKysrKysrKy0KPiAgIDMgZmlsZXMgY2hhbmdlZCwgNDYyIGlu
c2VydGlvbnMoKyksIDE2IGRlbGV0aW9ucygtKQo+Cj4gZGlmZiAtLWdpdCBhL2h3L3ZpcnRpby92
aG9zdC1zaGFkb3ctdmlydHF1ZXVlLmggYi9ody92aXJ0aW8vdmhvc3Qtc2hhZG93LXZpcnRxdWV1
ZS5oCj4gaW5kZXggMzlhZWY1ZmZkZi4uMTljOTM0YWY0OSAxMDA2NDQKPiAtLS0gYS9ody92aXJ0
aW8vdmhvc3Qtc2hhZG93LXZpcnRxdWV1ZS5oCj4gKysrIGIvaHcvdmlydGlvL3Zob3N0LXNoYWRv
dy12aXJ0cXVldWUuaAo+IEBAIC0zMyw2ICszMyw4IEBAIHVpbnQxNl90IHZob3N0X3N2cV9nZXRf
bnVtKGNvbnN0IFZob3N0U2hhZG93VmlydHF1ZXVlICpzdnEpOwo+ICAgc2l6ZV90IHZob3N0X3N2
cV9kcml2ZXJfYXJlYV9zaXplKGNvbnN0IFZob3N0U2hhZG93VmlydHF1ZXVlICpzdnEpOwo+ICAg
c2l6ZV90IHZob3N0X3N2cV9kZXZpY2VfYXJlYV9zaXplKGNvbnN0IFZob3N0U2hhZG93VmlydHF1
ZXVlICpzdnEpOwo+ICAgCj4gK3ZvaWQgdmhvc3Rfc3ZxX3N0YXJ0KFZob3N0U2hhZG93VmlydHF1
ZXVlICpzdnEsIFZpcnRJT0RldmljZSAqdmRldiwKPiArICAgICAgICAgICAgICAgICAgICAgVmly
dFF1ZXVlICp2cSk7Cj4gICB2b2lkIHZob3N0X3N2cV9zdG9wKFZob3N0U2hhZG93VmlydHF1ZXVl
ICpzdnEpOwo+ICAgCj4gICBWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAqdmhvc3Rfc3ZxX25ldyh1aW50
MTZfdCBxc2l6ZSk7Cj4gZGlmZiAtLWdpdCBhL2h3L3ZpcnRpby92aG9zdC1zaGFkb3ctdmlydHF1
ZXVlLmMgYi9ody92aXJ0aW8vdmhvc3Qtc2hhZG93LXZpcnRxdWV1ZS5jCj4gaW5kZXggN2MxNjgw
NzVkNy4uYTFhNDA0ZjY4ZiAxMDA2NDQKPiAtLS0gYS9ody92aXJ0aW8vdmhvc3Qtc2hhZG93LXZp
cnRxdWV1ZS5jCj4gKysrIGIvaHcvdmlydGlvL3Zob3N0LXNoYWRvdy12aXJ0cXVldWUuYwo+IEBA
IC05LDYgKzksOCBAQAo+ICAgCj4gICAjaW5jbHVkZSAicWVtdS9vc2RlcC5oIgo+ICAgI2luY2x1
ZGUgImh3L3ZpcnRpby92aG9zdC1zaGFkb3ctdmlydHF1ZXVlLmgiCj4gKyNpbmNsdWRlICJody92
aXJ0aW8vdmhvc3QuaCIKPiArI2luY2x1ZGUgImh3L3ZpcnRpby92aXJ0aW8tYWNjZXNzLmgiCj4g
ICAjaW5jbHVkZSAic3RhbmRhcmQtaGVhZGVycy9saW51eC92aG9zdF90eXBlcy5oIgo+ICAgCj4g
ICAjaW5jbHVkZSAicWVtdS9lcnJvci1yZXBvcnQuaCIKPiBAQCAtMzYsNiArMzgsMzMgQEAgdHlw
ZWRlZiBzdHJ1Y3QgVmhvc3RTaGFkb3dWaXJ0cXVldWUgewo+ICAgCj4gICAgICAgLyogR3Vlc3Qn
cyBjYWxsIG5vdGlmaWVyLCB3aGVyZSBTVlEgY2FsbHMgZ3Vlc3QuICovCj4gICAgICAgRXZlbnRO
b3RpZmllciBzdnFfY2FsbDsKPiArCj4gKyAgICAvKiBWaXJ0aW8gcXVldWUgc2hhZG93aW5nICov
Cj4gKyAgICBWaXJ0UXVldWUgKnZxOwo+ICsKPiArICAgIC8qIFZpcnRpbyBkZXZpY2UgKi8KPiAr
ICAgIFZpcnRJT0RldmljZSAqdmRldjsKPiArCj4gKyAgICAvKiBNYXAgZm9yIHJldHVybmluZyBn
dWVzdCdzIGRlc2NyaXB0b3JzICovCj4gKyAgICBWaXJ0UXVldWVFbGVtZW50ICoqcmluZ19pZF9t
YXBzOwo+ICsKPiArICAgIC8qIE5leHQgVmlydFF1ZXVlIGVsZW1lbnQgdGhhdCBndWVzdCBtYWRl
IGF2YWlsYWJsZSAqLwo+ICsgICAgVmlydFF1ZXVlRWxlbWVudCAqbmV4dF9ndWVzdF9hdmFpbF9l
bGVtOwo+ICsKPiArICAgIC8qIE5leHQgaGVhZCB0byBleHBvc2UgdG8gZGV2aWNlICovCj4gKyAg
ICB1aW50MTZfdCBhdmFpbF9pZHhfc2hhZG93Owo+ICsKPiArICAgIC8qIE5leHQgZnJlZSBkZXNj
cmlwdG9yICovCj4gKyAgICB1aW50MTZfdCBmcmVlX2hlYWQ7Cj4gKwo+ICsgICAgLyogTGFzdCBz
ZWVuIHVzZWQgaWR4ICovCj4gKyAgICB1aW50MTZfdCBzaGFkb3dfdXNlZF9pZHg7Cj4gKwo+ICsg
ICAgLyogTmV4dCBoZWFkIHRvIGNvbnN1bWUgZnJvbSBkZXZpY2UgKi8KPiArICAgIHVpbnQxNl90
IGxhc3RfdXNlZF9pZHg7Cj4gKwo+ICsgICAgLyogQ2FjaGUgZm9yIHRoZSBleHBvc2VkIG5vdGlm
aWNhdGlvbiBmbGFnICovCj4gKyAgICBib29sIG5vdGlmaWNhdGlvbjsKPiAgIH0gVmhvc3RTaGFk
b3dWaXJ0cXVldWU7Cj4gICAKPiAgICNkZWZpbmUgSU5WQUxJRF9TVlFfS0lDS19GRCAtMQo+IEBA
IC0xNDgsMzAgKzE3NywyOTQgQEAgYm9vbCB2aG9zdF9zdnFfYWNrX2d1ZXN0X2ZlYXR1cmVzKHVp
bnQ2NF90IGRldl9mZWF0dXJlcywKPiAgICAgICByZXR1cm4gdHJ1ZTsKPiAgIH0KPiAgIAo+IC0v
KiBGb3J3YXJkIGd1ZXN0IG5vdGlmaWNhdGlvbnMgKi8KPiAtc3RhdGljIHZvaWQgdmhvc3RfaGFu
ZGxlX2d1ZXN0X2tpY2soRXZlbnROb3RpZmllciAqbikKPiArLyoqCj4gKyAqIE51bWJlciBvZiBk
ZXNjcmlwdG9ycyB0aGF0IFNWUSBjYW4gbWFrZSBhdmFpbGFibGUgZnJvbSB0aGUgZ3Vlc3QuCj4g
KyAqCj4gKyAqIEBzdnEgICBUaGUgc3ZxCj4gKyAqLwo+ICtzdGF0aWMgdWludDE2X3Qgdmhvc3Rf
c3ZxX2F2YWlsYWJsZV9zbG90cyhjb25zdCBWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxKQo+ICAg
ewo+IC0gICAgVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSA9IGNvbnRhaW5lcl9vZihuLCBWaG9z
dFNoYWRvd1ZpcnRxdWV1ZSwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3ZxX2tpY2spOwo+ICsgICAgcmV0dXJuIHN2cS0+dnJpbmcubnVtIC0gKHN2cS0+
YXZhaWxfaWR4X3NoYWRvdyAtIHN2cS0+c2hhZG93X3VzZWRfaWR4KTsKPiArfQo+ICsKPiArc3Rh
dGljIHZvaWQgdmhvc3Rfc3ZxX3NldF9ub3RpZmljYXRpb24oVmhvc3RTaGFkb3dWaXJ0cXVldWUg
KnN2cSwgYm9vbCBlbmFibGUpCj4gK3sKPiArICAgIHVpbnQxNl90IG5vdGlmaWNhdGlvbl9mbGFn
Owo+ICAgCj4gLSAgICBpZiAodW5saWtlbHkoIWV2ZW50X25vdGlmaWVyX3Rlc3RfYW5kX2NsZWFy
KG4pKSkgewo+ICsgICAgaWYgKHN2cS0+bm90aWZpY2F0aW9uID09IGVuYWJsZSkgewo+ICsgICAg
ICAgIHJldHVybjsKPiArICAgIH0KPiArCj4gKyAgICBub3RpZmljYXRpb25fZmxhZyA9IGNwdV90
b19sZTE2KFZSSU5HX0FWQUlMX0ZfTk9fSU5URVJSVVBUKTsKPiArCj4gKyAgICBzdnEtPm5vdGlm
aWNhdGlvbiA9IGVuYWJsZTsKPiArICAgIGlmIChlbmFibGUpIHsKPiArICAgICAgICBzdnEtPnZy
aW5nLmF2YWlsLT5mbGFncyAmPSB+bm90aWZpY2F0aW9uX2ZsYWc7Cj4gKyAgICB9IGVsc2Ugewo+
ICsgICAgICAgIHN2cS0+dnJpbmcuYXZhaWwtPmZsYWdzIHw9IG5vdGlmaWNhdGlvbl9mbGFnOwo+
ICsgICAgfQo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCB2aG9zdF92cmluZ193cml0ZV9kZXNjcyhW
aG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBjb25zdCBzdHJ1Y3QgaW92ZWMgKmlvdmVjLAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzaXplX3QgbnVtLCBib29sIG1vcmVfZGVzY3MsIGJvb2wgd3JpdGUp
Cj4gK3sKPiArICAgIHVpbnQxNl90IGkgPSBzdnEtPmZyZWVfaGVhZCwgbGFzdCA9IHN2cS0+ZnJl
ZV9oZWFkOwo+ICsgICAgdW5zaWduZWQgbjsKPiArICAgIHVpbnQxNl90IGZsYWdzID0gd3JpdGUg
PyBjcHVfdG9fbGUxNihWUklOR19ERVNDX0ZfV1JJVEUpIDogMDsKPiArICAgIHZyaW5nX2Rlc2Nf
dCAqZGVzY3MgPSBzdnEtPnZyaW5nLmRlc2M7Cj4gKwo+ICsgICAgaWYgKG51bSA9PSAwKSB7Cj4g
KyAgICAgICAgcmV0dXJuOwo+ICsgICAgfQo+ICsKPiArICAgIGZvciAobiA9IDA7IG4gPCBudW07
IG4rKykgewo+ICsgICAgICAgIGlmIChtb3JlX2Rlc2NzIHx8IChuICsgMSA8IG51bSkpIHsKPiAr
ICAgICAgICAgICAgZGVzY3NbaV0uZmxhZ3MgPSBmbGFncyB8IGNwdV90b19sZTE2KFZSSU5HX0RF
U0NfRl9ORVhUKTsKPiArICAgICAgICB9IGVsc2Ugewo+ICsgICAgICAgICAgICBkZXNjc1tpXS5m
bGFncyA9IGZsYWdzOwo+ICsgICAgICAgIH0KPiArICAgICAgICBkZXNjc1tpXS5hZGRyID0gY3B1
X3RvX2xlNjQoKGh3YWRkcilpb3ZlY1tuXS5pb3ZfYmFzZSk7Cj4gKyAgICAgICAgZGVzY3NbaV0u
bGVuID0gY3B1X3RvX2xlMzIoaW92ZWNbbl0uaW92X2xlbik7Cj4gKwo+ICsgICAgICAgIGxhc3Qg
PSBpOwo+ICsgICAgICAgIGkgPSBjcHVfdG9fbGUxNihkZXNjc1tpXS5uZXh0KTsKPiArICAgIH0K
PiArCj4gKyAgICBzdnEtPmZyZWVfaGVhZCA9IGxlMTZfdG9fY3B1KGRlc2NzW2xhc3RdLm5leHQp
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgdW5zaWduZWQgdmhvc3Rfc3ZxX2FkZF9zcGxpdChWaG9zdFNo
YWRvd1ZpcnRxdWV1ZSAqc3ZxLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBWaXJ0UXVldWVFbGVtZW50ICplbGVtKQo+ICt7Cj4gKyAgICBpbnQgaGVhZDsKPiArICAgIHVu
c2lnbmVkIGF2YWlsX2lkeDsKPiArICAgIHZyaW5nX2F2YWlsX3QgKmF2YWlsID0gc3ZxLT52cmlu
Zy5hdmFpbDsKPiArCj4gKyAgICBoZWFkID0gc3ZxLT5mcmVlX2hlYWQ7Cj4gKwo+ICsgICAgLyog
V2UgbmVlZCBzb21lIGRlc2NyaXB0b3JzIGhlcmUgKi8KPiArICAgIGFzc2VydChlbGVtLT5vdXRf
bnVtIHx8IGVsZW0tPmluX251bSk7CgoKTG9va3MgbGlrZSB0aGlzIGNvdWxkIGJlIHRyaWdnZXJl
ZCBieSBndWVzdCwgd2UgbmVlZCBmYWlsIGluc3RlYWQgYXNzZXJ0IApoZXJlLgoKCj4gKwo+ICsg
ICAgdmhvc3RfdnJpbmdfd3JpdGVfZGVzY3Moc3ZxLCBlbGVtLT5vdXRfc2csIGVsZW0tPm91dF9u
dW0sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtLT5pbl9udW0gPiAwLCBmYWxz
ZSk7Cj4gKyAgICB2aG9zdF92cmluZ193cml0ZV9kZXNjcyhzdnEsIGVsZW0tPmluX3NnLCBlbGVt
LT5pbl9udW0sIGZhbHNlLCB0cnVlKTsKPiArCj4gKyAgICAvKgo+ICsgICAgICogUHV0IGVudHJ5
IGluIGF2YWlsYWJsZSBhcnJheSAoYnV0IGRvbid0IHVwZGF0ZSBhdmFpbC0+aWR4IHVudGlsIHRo
ZXkKPiArICAgICAqIGRvIHN5bmMpLgo+ICsgICAgICovCj4gKyAgICBhdmFpbF9pZHggPSBzdnEt
PmF2YWlsX2lkeF9zaGFkb3cgJiAoc3ZxLT52cmluZy5udW0gLSAxKTsKPiArICAgIGF2YWlsLT5y
aW5nW2F2YWlsX2lkeF0gPSBjcHVfdG9fbGUxNihoZWFkKTsKPiArICAgIHN2cS0+YXZhaWxfaWR4
X3NoYWRvdysrOwo+ICsKPiArICAgIC8qIFVwZGF0ZSBhdmFpbCBpbmRleCBhZnRlciB0aGUgZGVz
Y3JpcHRvciBpcyB3cm90ZSAqLwo+ICsgICAgc21wX3dtYigpOwo+ICsgICAgYXZhaWwtPmlkeCA9
IGNwdV90b19sZTE2KHN2cS0+YXZhaWxfaWR4X3NoYWRvdyk7Cj4gKwo+ICsgICAgcmV0dXJuIGhl
YWQ7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHZob3N0X3N2cV9hZGQoVmhvc3RTaGFkb3dWaXJ0
cXVldWUgKnN2cSwgVmlydFF1ZXVlRWxlbWVudCAqZWxlbSkKPiArewo+ICsgICAgdW5zaWduZWQg
cWVtdV9oZWFkID0gdmhvc3Rfc3ZxX2FkZF9zcGxpdChzdnEsIGVsZW0pOwo+ICsKPiArICAgIHN2
cS0+cmluZ19pZF9tYXBzW3FlbXVfaGVhZF0gPSBlbGVtOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9p
ZCB2aG9zdF9zdnFfa2ljayhWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxKQo+ICt7Cj4gKyAgICAv
KiBXZSBuZWVkIHRvIGV4cG9zZSBhdmFpbGFibGUgYXJyYXkgZW50cmllcyBiZWZvcmUgY2hlY2tp
bmcgdXNlZCBmbGFncyAqLwo+ICsgICAgc21wX21iKCk7Cj4gKyAgICBpZiAoc3ZxLT52cmluZy51
c2VkLT5mbGFncyAmIFZSSU5HX1VTRURfRl9OT19OT1RJRlkpIHsKPiAgICAgICAgICAgcmV0dXJu
Owo+ICAgICAgIH0KPiAgIAo+ICAgICAgIGV2ZW50X25vdGlmaWVyX3NldCgmc3ZxLT5oZGV2X2tp
Y2spOwo+ICAgfQo+ICAgCj4gLS8qIEZvcndhcmQgdmhvc3Qgbm90aWZpY2F0aW9ucyAqLwo+ICsv
KioKPiArICogRm9yd2FyZCBhdmFpbGFibGUgYnVmZmVycy4KPiArICoKPiArICogQHN2cSBTaGFk
b3cgVmlydFF1ZXVlCj4gKyAqCj4gKyAqIE5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9uIGRvZXMgbm90
IGd1YXJhbnRlZSB0aGF0IGFsbCBndWVzdCdzIGF2YWlsYWJsZQo+ICsgKiBidWZmZXJzIGFyZSBh
dmFpbGFibGUgdG8gdGhlIGRldmljZSBpbiBTVlEgYXZhaWwgcmluZy4gVGhlIGd1ZXN0IG1heSBo
YXZlCj4gKyAqIGV4cG9zZWQgYSBHUEEgLyBHSU9WQSBjb25naXVvdXMgYnVmZmVyLCBidXQgaXQg
bWF5IG5vdCBiZSBjb250aWd1b3VzIGluIHFlbXUKPiArICogdmFkZHIuCj4gKyAqCj4gKyAqIElm
IHRoYXQgaGFwcGVucywgZ3Vlc3QncyBraWNrIG5vdGlmaWNhdGlvbnMgd2lsbCBiZSBkaXNhYmxl
ZCB1bnRpbCBkZXZpY2UKPiArICogbWFrZXMgc29tZSBidWZmZXJzIHVzZWQuCj4gKyAqLwo+ICtz
dGF0aWMgdm9pZCB2aG9zdF9oYW5kbGVfZ3Vlc3Rfa2ljayhWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAq
c3ZxKQo+ICt7Cj4gKyAgICAvKiBDbGVhciBldmVudCBub3RpZmllciAqLwo+ICsgICAgZXZlbnRf
bm90aWZpZXJfdGVzdF9hbmRfY2xlYXIoJnN2cS0+c3ZxX2tpY2spOwo+ICsKPiArICAgIC8qIE1h
a2UgYXZhaWxhYmxlIGFzIG1hbnkgYnVmZmVycyBhcyBwb3NzaWJsZSAqLwo+ICsgICAgZG8gewo+
ICsgICAgICAgIGlmICh2aXJ0aW9fcXVldWVfZ2V0X25vdGlmaWNhdGlvbihzdnEtPnZxKSkgewo+
ICsgICAgICAgICAgICB2aXJ0aW9fcXVldWVfc2V0X25vdGlmaWNhdGlvbihzdnEtPnZxLCBmYWxz
ZSk7CgoKVGhpcyBsb29rcyBsaWtlIGFuIG9wdGltaXphdGlvbiB0aGUgc2hvdWxkIGJlbG9uZyB0
byAKdmlydGlvX3F1ZXVlX3NldF9ub3RpZmljYXRpb24oKSBpdHNlbGYuCgoKPiArICAgICAgICB9
Cj4gKwo+ICsgICAgICAgIHdoaWxlICh0cnVlKSB7Cj4gKyAgICAgICAgICAgIFZpcnRRdWV1ZUVs
ZW1lbnQgKmVsZW07Cj4gKwo+ICsgICAgICAgICAgICBpZiAoc3ZxLT5uZXh0X2d1ZXN0X2F2YWls
X2VsZW0pIHsKPiArICAgICAgICAgICAgICAgIGVsZW0gPSBnX3N0ZWFsX3BvaW50ZXIoJnN2cS0+
bmV4dF9ndWVzdF9hdmFpbF9lbGVtKTsKPiArICAgICAgICAgICAgfSBlbHNlIHsKPiArICAgICAg
ICAgICAgICAgIGVsZW0gPSB2aXJ0cXVldWVfcG9wKHN2cS0+dnEsIHNpemVvZigqZWxlbSkpOwo+
ICsgICAgICAgICAgICB9Cj4gKwo+ICsgICAgICAgICAgICBpZiAoIWVsZW0pIHsKPiArICAgICAg
ICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgICAgICB9Cj4gKwo+ICsgICAgICAgICAgICBpZiAo
ZWxlbS0+b3V0X251bSArIGVsZW0tPmluX251bSA+Cj4gKyAgICAgICAgICAgICAgICB2aG9zdF9z
dnFfYXZhaWxhYmxlX3Nsb3RzKHN2cSkpIHsKPiArICAgICAgICAgICAgICAgIC8qCj4gKyAgICAg
ICAgICAgICAgICAgKiBUaGlzIGNvbmRpdGlvbiBpcyBwb3NzaWJsZSBzaW5jZSBhIGNvbnRpZ3Vv
dXMgYnVmZmVyIGluIEdQQQo+ICsgICAgICAgICAgICAgICAgICogZG9lcyBub3QgaW1wbHkgYSBj
b250aWd1b3VzIGJ1ZmZlciBpbiBxZW11J3MgVkEKPiArICAgICAgICAgICAgICAgICAqIHNjYXR0
ZXItZ2F0aGVyIHNlZ21lbnRzLiBJZiB0aGF0IGhhcHBlbiwgdGhlIGJ1ZmZlciBleHBvc2VkCj4g
KyAgICAgICAgICAgICAgICAgKiB0byB0aGUgZGV2aWNlIG5lZWRzIHRvIGJlIGEgY2hhaW4gb2Yg
ZGVzY3JpcHRvcnMgYXQgdGhpcwo+ICsgICAgICAgICAgICAgICAgICogbW9tZW50Lgo+ICsgICAg
ICAgICAgICAgICAgICoKPiArICAgICAgICAgICAgICAgICAqIFNWUSBjYW5ub3QgaG9sZCBtb3Jl
IGF2YWlsYWJsZSBidWZmZXJzIGlmIHdlIGFyZSBoZXJlOgo+ICsgICAgICAgICAgICAgICAgICog
cXVldWUgdGhlIGN1cnJlbnQgZ3Vlc3QgZGVzY3JpcHRvciBhbmQgaWdub3JlIGZ1cnRoZXIga2lj
a3MKPiArICAgICAgICAgICAgICAgICAqIHVudGlsIHNvbWUgZWxlbWVudHMgYXJlIHVzZWQuCj4g
KyAgICAgICAgICAgICAgICAgKi8KPiArICAgICAgICAgICAgICAgIHN2cS0+bmV4dF9ndWVzdF9h
dmFpbF9lbGVtID0gZWxlbTsKPiArICAgICAgICAgICAgICAgIHJldHVybjsKPiArICAgICAgICAg
ICAgfQo+ICsKPiArICAgICAgICAgICAgdmhvc3Rfc3ZxX2FkZChzdnEsIGVsZW0pOwo+ICsgICAg
ICAgICAgICB2aG9zdF9zdnFfa2ljayhzdnEpOwo+ICsgICAgICAgIH0KPiArCj4gKyAgICAgICAg
dmlydGlvX3F1ZXVlX3NldF9ub3RpZmljYXRpb24oc3ZxLT52cSwgdHJ1ZSk7Cj4gKyAgICB9IHdo
aWxlICghdmlydGlvX3F1ZXVlX2VtcHR5KHN2cS0+dnEpKTsKPiArfQo+ICsKPiArLyoqCj4gKyAq
IEhhbmRsZSBndWVzdCdzIGtpY2suCj4gKyAqCj4gKyAqIEBuIGd1ZXN0IGtpY2sgZXZlbnQgbm90
aWZpZXIsIHRoZSBvbmUgdGhhdCBndWVzdCBzZXQgdG8gbm90aWZ5IHN2cS4KPiArICovCj4gK3N0
YXRpYyB2b2lkIHZob3N0X2hhbmRsZV9ndWVzdF9raWNrX25vdGlmaWVyKEV2ZW50Tm90aWZpZXIg
Km4pCj4gK3sKPiArICAgIFZob3N0U2hhZG93VmlydHF1ZXVlICpzdnEgPSBjb250YWluZXJfb2Yo
biwgVmhvc3RTaGFkb3dWaXJ0cXVldWUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN2cV9raWNrKTsKPiArICAgIHZob3N0X2hhbmRsZV9ndWVzdF9raWNr
KHN2cSk7Cj4gK30KPiArCj4gK3N0YXRpYyBib29sIHZob3N0X3N2cV9tb3JlX3VzZWQoVmhvc3RT
aGFkb3dWaXJ0cXVldWUgKnN2cSkKPiArewo+ICsgICAgaWYgKHN2cS0+bGFzdF91c2VkX2lkeCAh
PSBzdnEtPnNoYWRvd191c2VkX2lkeCkgewo+ICsgICAgICAgIHJldHVybiB0cnVlOwo+ICsgICAg
fQo+ICsKPiArICAgIHN2cS0+c2hhZG93X3VzZWRfaWR4ID0gY3B1X3RvX2xlMTYoc3ZxLT52cmlu
Zy51c2VkLT5pZHgpOwo+ICsKPiArICAgIHJldHVybiBzdnEtPmxhc3RfdXNlZF9pZHggIT0gc3Zx
LT5zaGFkb3dfdXNlZF9pZHg7Cj4gK30KPiArCj4gK3N0YXRpYyBWaXJ0UXVldWVFbGVtZW50ICp2
aG9zdF9zdnFfZ2V0X2J1ZihWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxKQo+ICt7Cj4gKyAgICB2
cmluZ19kZXNjX3QgKmRlc2NzID0gc3ZxLT52cmluZy5kZXNjOwo+ICsgICAgY29uc3QgdnJpbmdf
dXNlZF90ICp1c2VkID0gc3ZxLT52cmluZy51c2VkOwo+ICsgICAgdnJpbmdfdXNlZF9lbGVtX3Qg
dXNlZF9lbGVtOwo+ICsgICAgdWludDE2X3QgbGFzdF91c2VkOwo+ICsKPiArICAgIGlmICghdmhv
c3Rfc3ZxX21vcmVfdXNlZChzdnEpKSB7Cj4gKyAgICAgICAgcmV0dXJuIE5VTEw7Cj4gKyAgICB9
Cj4gKwo+ICsgICAgLyogT25seSBnZXQgdXNlZCBhcnJheSBlbnRyaWVzIGFmdGVyIHRoZXkgaGF2
ZSBiZWVuIGV4cG9zZWQgYnkgZGV2ICovCj4gKyAgICBzbXBfcm1iKCk7Cj4gKyAgICBsYXN0X3Vz
ZWQgPSBzdnEtPmxhc3RfdXNlZF9pZHggJiAoc3ZxLT52cmluZy5udW0gLSAxKTsKPiArICAgIHVz
ZWRfZWxlbS5pZCA9IGxlMzJfdG9fY3B1KHVzZWQtPnJpbmdbbGFzdF91c2VkXS5pZCk7Cj4gKyAg
ICB1c2VkX2VsZW0ubGVuID0gbGUzMl90b19jcHUodXNlZC0+cmluZ1tsYXN0X3VzZWRdLmxlbik7
Cj4gKwo+ICsgICAgc3ZxLT5sYXN0X3VzZWRfaWR4Kys7Cj4gKyAgICBpZiAodW5saWtlbHkodXNl
ZF9lbGVtLmlkID49IHN2cS0+dnJpbmcubnVtKSkgewo+ICsgICAgICAgIGVycm9yX3JlcG9ydCgi
RGV2aWNlICVzIHNheXMgaW5kZXggJXUgaXMgdXNlZCIsIHN2cS0+dmRldi0+bmFtZSwKPiArICAg
ICAgICAgICAgICAgICAgICAgdXNlZF9lbGVtLmlkKTsKPiArICAgICAgICByZXR1cm4gTlVMTDsK
PiArICAgIH0KPiArCj4gKyAgICBpZiAodW5saWtlbHkoIXN2cS0+cmluZ19pZF9tYXBzW3VzZWRf
ZWxlbS5pZF0pKSB7Cj4gKyAgICAgICAgZXJyb3JfcmVwb3J0KAo+ICsgICAgICAgICAgICAiRGV2
aWNlICVzIHNheXMgaW5kZXggJXUgaXMgdXNlZCwgYnV0IGl0IHdhcyBub3QgYXZhaWxhYmxlIiwK
PiArICAgICAgICAgICAgc3ZxLT52ZGV2LT5uYW1lLCB1c2VkX2VsZW0uaWQpOwo+ICsgICAgICAg
IHJldHVybiBOVUxMOwo+ICsgICAgfQo+ICsKPiArICAgIGRlc2NzW3VzZWRfZWxlbS5pZF0ubmV4
dCA9IHN2cS0+ZnJlZV9oZWFkOwo+ICsgICAgc3ZxLT5mcmVlX2hlYWQgPSB1c2VkX2VsZW0uaWQ7
Cj4gKwo+ICsgICAgc3ZxLT5yaW5nX2lkX21hcHNbdXNlZF9lbGVtLmlkXS0+bGVuID0gdXNlZF9l
bGVtLmxlbjsKPiArICAgIHJldHVybiBnX3N0ZWFsX3BvaW50ZXIoJnN2cS0+cmluZ19pZF9tYXBz
W3VzZWRfZWxlbS5pZF0pOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCB2aG9zdF9zdnFfZmx1c2go
Vmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGJvb2wgY2hlY2tfZm9yX2F2YWlsX3F1ZXVlKQo+ICt7Cj4gKyAgICBWaXJ0UXVldWUgKnZxID0g
c3ZxLT52cTsKPiArCj4gKyAgICAvKiBNYWtlIGFzIG1hbnkgYnVmZmVycyBhcyBwb3NzaWJsZSB1
c2VkLiAqLwo+ICsgICAgZG8gewo+ICsgICAgICAgIHVuc2lnbmVkIGkgPSAwOwo+ICsKPiArICAg
ICAgICB2aG9zdF9zdnFfc2V0X25vdGlmaWNhdGlvbihzdnEsIGZhbHNlKTsKPiArICAgICAgICB3
aGlsZSAodHJ1ZSkgewo+ICsgICAgICAgICAgICBnX2F1dG9mcmVlIFZpcnRRdWV1ZUVsZW1lbnQg
KmVsZW0gPSB2aG9zdF9zdnFfZ2V0X2J1ZihzdnEpOwo+ICsgICAgICAgICAgICBpZiAoIWVsZW0p
IHsKPiArICAgICAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgICAgICB9Cj4gKwo+ICsgICAg
ICAgICAgICBpZiAodW5saWtlbHkoaSA+PSBzdnEtPnZyaW5nLm51bSkpIHsKPiArICAgICAgICAg
ICAgICAgIHZpcnRpb19lcnJvcihzdnEtPnZkZXYsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAiTW9yZSB0aGFuICV1IHVzZWQgYnVmZmVycyBvYnRhaW5lZCBpbiBhICV1IHNpemUgU1ZRIiwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgIGksIHN2cS0+dnJpbmcubnVtKTsKPiArICAgICAg
ICAgICAgICAgIHZpcnRxdWV1ZV9maWxsKHZxLCBlbGVtLCBlbGVtLT5sZW4sIGkpOwo+ICsgICAg
ICAgICAgICAgICAgdmlydHF1ZXVlX2ZsdXNoKHZxLCBpKTsKCgpMZXQncyBzaW1wbHkgdXNlIHZp
cnRxdWV1ZV9wdXNoKCkgaGVyZT8KCgo+ICsgICAgICAgICAgICAgICAgaSA9IDA7CgoKRG8gd2Ug
bmVlZCB0byBiYWlsIG91dCBoZXJlPwoKCj4gKyAgICAgICAgICAgIH0KPiArICAgICAgICAgICAg
dmlydHF1ZXVlX2ZpbGwodnEsIGVsZW0sIGVsZW0tPmxlbiwgaSsrKTsKPiArICAgICAgICB9Cj4g
Kwo+ICsgICAgICAgIHZpcnRxdWV1ZV9mbHVzaCh2cSwgaSk7Cj4gKyAgICAgICAgZXZlbnRfbm90
aWZpZXJfc2V0KCZzdnEtPnN2cV9jYWxsKTsKPiArCj4gKyAgICAgICAgaWYgKGNoZWNrX2Zvcl9h
dmFpbF9xdWV1ZSAmJiBzdnEtPm5leHRfZ3Vlc3RfYXZhaWxfZWxlbSkgewo+ICsgICAgICAgICAg
ICAvKgo+ICsgICAgICAgICAgICAgKiBBdmFpbCByaW5nIHdhcyBmdWxsIHdoZW4gdmhvc3Rfc3Zx
X2ZsdXNoIHdhcyBjYWxsZWQsIHNvIGl0J3MgYQo+ICsgICAgICAgICAgICAgKiBnb29kIG1vbWVu
dCB0byBtYWtlIG1vcmUgZGVzY3JpcHRvcnMgYXZhaWxhYmxlIGlmIHBvc3NpYmxlCj4gKyAgICAg
ICAgICAgICAqLwo+ICsgICAgICAgICAgICB2aG9zdF9oYW5kbGVfZ3Vlc3Rfa2ljayhzdnEpOwoK
CklzIHRoZXJlIGJldHRlciB0byBoYXZlIGEgc2ltaWxhciBjaGVjayBhcyB2aG9zdF9oYW5kbGVf
Z3Vlc3Rfa2ljaygpIGRpZD8KCiDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgIGlmIChlbGVtLT5vdXRf
bnVtICsgZWxlbS0+aW5fbnVtID4KIMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoCB2aG9z
dF9zdnFfYXZhaWxhYmxlX3Nsb3RzKHN2cSkpIHsKCgo+ICsgICAgICAgIH0KPiArCj4gKyAgICAg
ICAgdmhvc3Rfc3ZxX3NldF9ub3RpZmljYXRpb24oc3ZxLCB0cnVlKTsKCgpBIG1iKCkgaXMgbmVl
ZGVkIGhlcmU/IE90aGVyd2lzZSB3ZSBtYXkgbG9zdCBhIGNhbGwgaGVyZSAod2hlcmUgCnZob3N0
X3N2cV9tb3JlX3VzZWQoKSBpcyBydW4gYmVmb3JlIHZob3N0X3N2cV9zZXRfbm90aWZpY2F0aW9u
KCkpLgoKCj4gKyAgICB9IHdoaWxlICh2aG9zdF9zdnFfbW9yZV91c2VkKHN2cSkpOwo+ICt9Cj4g
Kwo+ICsvKioKPiArICogRm9yd2FyZCB1c2VkIGJ1ZmZlcnMuCj4gKyAqCj4gKyAqIEBuIGhkZXYg
Y2FsbCBldmVudCBub3RpZmllciwgdGhlIG9uZSB0aGF0IGRldmljZSBzZXQgdG8gbm90aWZ5IHN2
cS4KPiArICoKPiArICogTm90ZSB0aGF0IHdlIGFyZSBub3QgbWFraW5nIGFueSBidWZmZXJzIGF2
YWlsYWJsZSBpbiB0aGUgbG9vcCwgdGhlcmUgaXMgbm8KPiArICogd2F5IHRoYXQgaXQgcnVucyBt
b3JlIHRoYW4gdmlydHF1ZXVlIHNpemUgdGltZXMuCj4gKyAqLwo+ICAgc3RhdGljIHZvaWQgdmhv
c3Rfc3ZxX2hhbmRsZV9jYWxsKEV2ZW50Tm90aWZpZXIgKm4pCj4gICB7Cj4gICAgICAgVmhvc3RT
aGFkb3dWaXJ0cXVldWUgKnN2cSA9IGNvbnRhaW5lcl9vZihuLCBWaG9zdFNoYWRvd1ZpcnRxdWV1
ZSwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkZXZf
Y2FsbCk7Cj4gICAKPiAtICAgIGlmICh1bmxpa2VseSghZXZlbnRfbm90aWZpZXJfdGVzdF9hbmRf
Y2xlYXIobikpKSB7Cj4gLSAgICAgICAgcmV0dXJuOwo+IC0gICAgfQo+ICsgICAgLyogQ2xlYXIg
ZXZlbnQgbm90aWZpZXIgKi8KPiArICAgIGV2ZW50X25vdGlmaWVyX3Rlc3RfYW5kX2NsZWFyKG4p
OwoKCkFueSByZWFzb24gdGhhdCB3ZSByZW1vdmUgdGhlIGFib3ZlIGNoZWNrPwoKCj4gICAKPiAt
ICAgIGV2ZW50X25vdGlmaWVyX3NldCgmc3ZxLT5zdnFfY2FsbCk7Cj4gKyAgICB2aG9zdF9zdnFf
Zmx1c2goc3ZxLCB0cnVlKTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gQEAgLTI1OCwxMyArNTUxLDM4
IEBAIHZvaWQgdmhvc3Rfc3ZxX3NldF9zdnFfa2lja19mZChWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAq
c3ZxLCBpbnQgc3ZxX2tpY2tfZmQpCj4gICAgICAgICogbmVlZCB0byBleHBsaWNpdGVseSBjaGVj
ayBmb3IgdGhlbS4KPiAgICAgICAgKi8KPiAgICAgICBldmVudF9ub3RpZmllcl9pbml0X2ZkKCZz
dnEtPnN2cV9raWNrLCBzdnFfa2lja19mZCk7Cj4gLSAgICBldmVudF9ub3RpZmllcl9zZXRfaGFu
ZGxlcigmc3ZxLT5zdnFfa2ljaywgdmhvc3RfaGFuZGxlX2d1ZXN0X2tpY2spOwo+ICsgICAgZXZl
bnRfbm90aWZpZXJfc2V0X2hhbmRsZXIoJnN2cS0+c3ZxX2tpY2ssCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB2aG9zdF9oYW5kbGVfZ3Vlc3Rfa2lja19ub3RpZmllcik7Cj4gICAK
PiAgICAgICBpZiAoIWNoZWNrX29sZCB8fCBldmVudF9ub3RpZmllcl90ZXN0X2FuZF9jbGVhcigm
dG1wKSkgewo+ICAgICAgICAgICBldmVudF9ub3RpZmllcl9zZXQoJnN2cS0+aGRldl9raWNrKTsK
PiAgICAgICB9Cj4gICB9Cj4gICAKPiArLyoqCj4gKyAqIFN0YXJ0IHNoYWRvdyB2aXJ0cXVldWUg
b3BlcmF0aW9uLgo+ICsgKgo+ICsgKiBAc3ZxIFNoYWRvdyBWaXJ0cXVldWUKPiArICogQHZkZXYg
ICAgICAgIFZpcnRJTyBkZXZpY2UKPiArICogQHZxICAgICAgICAgIFZpcnRxdWV1ZSB0byBzaGFk
b3cKPiArICovCj4gK3ZvaWQgdmhvc3Rfc3ZxX3N0YXJ0KFZob3N0U2hhZG93VmlydHF1ZXVlICpz
dnEsIFZpcnRJT0RldmljZSAqdmRldiwKPiArICAgICAgICAgICAgICAgICAgICAgVmlydFF1ZXVl
ICp2cSkKPiArewo+ICsgICAgc3ZxLT5uZXh0X2d1ZXN0X2F2YWlsX2VsZW0gPSBOVUxMOwo+ICsg
ICAgc3ZxLT5hdmFpbF9pZHhfc2hhZG93ID0gMDsKPiArICAgIHN2cS0+c2hhZG93X3VzZWRfaWR4
ID0gMDsKPiArICAgIHN2cS0+bGFzdF91c2VkX2lkeCA9IDA7Cj4gKyAgICBzdnEtPnZkZXYgPSB2
ZGV2Owo+ICsgICAgc3ZxLT52cSA9IHZxOwo+ICsKPiArICAgIG1lbXNldChzdnEtPnZyaW5nLmF2
YWlsLCAwLCBzaXplb2YoKnN2cS0+dnJpbmcuYXZhaWwpKTsKPiArICAgIG1lbXNldChzdnEtPnZy
aW5nLnVzZWQsIDAsIHNpemVvZigqc3ZxLT52cmluZy5hdmFpbCkpOwo+ICsgICAgZm9yICh1bnNp
Z25lZCBpID0gMDsgaSA8IHN2cS0+dnJpbmcubnVtIC0gMTsgaSsrKSB7Cj4gKyAgICAgICAgc3Zx
LT52cmluZy5kZXNjW2ldLm5leHQgPSBjcHVfdG9fbGUxNihpICsgMSk7Cj4gKyAgICB9Cj4gK30K
PiArCj4gICAvKioKPiAgICAqIFN0b3Agc2hhZG93IHZpcnRxdWV1ZSBvcGVyYXRpb24uCj4gICAg
KiBAc3ZxIFNoYWRvdyBWaXJ0cXVldWUKPiBAQCAtMjcyLDYgKzU5MCwyOCBAQCB2b2lkIHZob3N0
X3N2cV9zZXRfc3ZxX2tpY2tfZmQoVmhvc3RTaGFkb3dWaXJ0cXVldWUgKnN2cSwgaW50IHN2cV9r
aWNrX2ZkKQo+ICAgdm9pZCB2aG9zdF9zdnFfc3RvcChWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3Zx
KQo+ICAgewo+ICAgICAgIGV2ZW50X25vdGlmaWVyX3NldF9oYW5kbGVyKCZzdnEtPnN2cV9raWNr
LCBOVUxMKTsKPiArICAgIGdfYXV0b2ZyZWUgVmlydFF1ZXVlRWxlbWVudCAqbmV4dF9hdmFpbF9l
bGVtID0gTlVMTDsKPiArCj4gKyAgICBpZiAoIXN2cS0+dnEpIHsKPiArICAgICAgICByZXR1cm47
Cj4gKyAgICB9Cj4gKwo+ICsgICAgLyogU2VuZCBhbGwgcGVuZGluZyB1c2VkIGRlc2NyaXB0b3Jz
IHRvIGd1ZXN0ICovCj4gKyAgICB2aG9zdF9zdnFfZmx1c2goc3ZxLCBmYWxzZSk7Cj4gKwo+ICsg
ICAgZm9yICh1bnNpZ25lZCBpID0gMDsgaSA8IHN2cS0+dnJpbmcubnVtOyArK2kpIHsKPiArICAg
ICAgICBnX2F1dG9mcmVlIFZpcnRRdWV1ZUVsZW1lbnQgKmVsZW0gPSBOVUxMOwo+ICsgICAgICAg
IGVsZW0gPSBnX3N0ZWFsX3BvaW50ZXIoJnN2cS0+cmluZ19pZF9tYXBzW2ldKTsKPiArICAgICAg
ICBpZiAoZWxlbSkgewo+ICsgICAgICAgICAgICB2aXJ0cXVldWVfZGV0YWNoX2VsZW1lbnQoc3Zx
LT52cSwgZWxlbSwgZWxlbS0+bGVuKTsKPiArICAgICAgICB9Cj4gKyAgICB9Cj4gKwo+ICsgICAg
bmV4dF9hdmFpbF9lbGVtID0gZ19zdGVhbF9wb2ludGVyKCZzdnEtPm5leHRfZ3Vlc3RfYXZhaWxf
ZWxlbSk7Cj4gKyAgICBpZiAobmV4dF9hdmFpbF9lbGVtKSB7Cj4gKyAgICAgICAgdmlydHF1ZXVl
X2RldGFjaF9lbGVtZW50KHN2cS0+dnEsIG5leHRfYXZhaWxfZWxlbSwKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbmV4dF9hdmFpbF9lbGVtLT5sZW4pOwo+ICsgICAgfQo+ICAg
fQo+ICAgCj4gICAvKioKPiBAQCAtMzE2LDcgKzY1Niw3IEBAIFZob3N0U2hhZG93VmlydHF1ZXVl
ICp2aG9zdF9zdnFfbmV3KHVpbnQxNl90IHFzaXplKQo+ICAgICAgIG1lbXNldChzdnEtPnZyaW5n
LmRlc2MsIDAsIGRyaXZlcl9zaXplKTsKPiAgICAgICBzdnEtPnZyaW5nLnVzZWQgPSBxZW11X21l
bWFsaWduKHFlbXVfcmVhbF9ob3N0X3BhZ2Vfc2l6ZSwgZGV2aWNlX3NpemUpOwo+ICAgICAgIG1l
bXNldChzdnEtPnZyaW5nLnVzZWQsIDAsIGRldmljZV9zaXplKTsKPiAtCj4gKyAgICBzdnEtPnJp
bmdfaWRfbWFwcyA9IGdfbmV3MChWaXJ0UXVldWVFbGVtZW50ICosIHFzaXplKTsKPiAgICAgICBl
dmVudF9ub3RpZmllcl9zZXRfaGFuZGxlcigmc3ZxLT5oZGV2X2NhbGwsIHZob3N0X3N2cV9oYW5k
bGVfY2FsbCk7Cj4gICAgICAgcmV0dXJuIGdfc3RlYWxfcG9pbnRlcigmc3ZxKTsKPiAgIAo+IEBA
IC0zMzUsNiArNjc1LDcgQEAgdm9pZCB2aG9zdF9zdnFfZnJlZShWaG9zdFNoYWRvd1ZpcnRxdWV1
ZSAqdnEpCj4gICAgICAgZXZlbnRfbm90aWZpZXJfY2xlYW51cCgmdnEtPmhkZXZfa2ljayk7Cj4g
ICAgICAgZXZlbnRfbm90aWZpZXJfc2V0X2hhbmRsZXIoJnZxLT5oZGV2X2NhbGwsIE5VTEwpOwo+
ICAgICAgIGV2ZW50X25vdGlmaWVyX2NsZWFudXAoJnZxLT5oZGV2X2NhbGwpOwo+ICsgICAgZ19m
cmVlKHZxLT5yaW5nX2lkX21hcHMpOwo+ICAgICAgIHFlbXVfdmZyZWUodnEtPnZyaW5nLmRlc2Mp
Owo+ICAgICAgIHFlbXVfdmZyZWUodnEtPnZyaW5nLnVzZWQpOwo+ICAgICAgIGdfZnJlZSh2cSk7
Cj4gZGlmZiAtLWdpdCBhL2h3L3ZpcnRpby92aG9zdC12ZHBhLmMgYi9ody92aXJ0aW8vdmhvc3Qt
dmRwYS5jCj4gaW5kZXggNTNlMTRiYWZhMC4uMGU1YzAwZWQ3ZSAxMDA2NDQKPiAtLS0gYS9ody92
aXJ0aW8vdmhvc3QtdmRwYS5jCj4gKysrIGIvaHcvdmlydGlvL3Zob3N0LXZkcGEuYwo+IEBAIC03
NTIsOSArNzUyLDkgQEAgc3RhdGljIGludCB2aG9zdF92ZHBhX3NldF92cmluZ19jYWxsKHN0cnVj
dCB2aG9zdF9kZXYgKmRldiwKPiAgICAqIE5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9uIGRvZXMgbm90
IHJld2luZCBraWNrIGZpbGUgZGVzY3JpcHRvciBpZiBjYW5ub3Qgc2V0Cj4gICAgKiBjYWxsIG9u
ZS4KPiAgICAqLwo+IC1zdGF0aWMgYm9vbCB2aG9zdF92ZHBhX3N2cV9zZXR1cChzdHJ1Y3Qgdmhv
c3RfZGV2ICpkZXYsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmhvc3RTaGFk
b3dWaXJ0cXVldWUgKnN2cSwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNp
Z25lZCBpZHgpCj4gK3N0YXRpYyBpbnQgdmhvc3RfdmRwYV9zdnFfc2V0X2ZkcyhzdHJ1Y3Qgdmhv
c3RfZGV2ICpkZXYsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaG9zdFNo
YWRvd1ZpcnRxdWV1ZSAqc3ZxLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dW5zaWduZWQgaWR4KQo+ICAgewo+ICAgICAgIHN0cnVjdCB2aG9zdF92cmluZ19maWxlIGZpbGUg
PSB7Cj4gICAgICAgICAgIC5pbmRleCA9IGRldi0+dnFfaW5kZXggKyBpZHgsCj4gQEAgLTc2Nyw3
ICs3NjcsNyBAQCBzdGF0aWMgYm9vbCB2aG9zdF92ZHBhX3N2cV9zZXR1cChzdHJ1Y3Qgdmhvc3Rf
ZGV2ICpkZXYsCj4gICAgICAgciA9IHZob3N0X3ZkcGFfc2V0X3ZyaW5nX2Rldl9raWNrKGRldiwg
JmZpbGUpOwo+ICAgICAgIGlmICh1bmxpa2VseShyICE9IDApKSB7Cj4gICAgICAgICAgIGVycm9y
X3JlcG9ydCgiQ2FuJ3Qgc2V0IGRldmljZSBraWNrIGZkICglZCkiLCAtcik7Cj4gLSAgICAgICAg
cmV0dXJuIGZhbHNlOwo+ICsgICAgICAgIHJldHVybiByOwo+ICAgICAgIH0KPiAgIAo+ICAgICAg
IGV2ZW50X25vdGlmaWVyID0gdmhvc3Rfc3ZxX2dldF9zdnFfY2FsbF9ub3RpZmllcihzdnEpOwo+
IEBAIC03NzcsNiArNzc3LDk5IEBAIHN0YXRpYyBib29sIHZob3N0X3ZkcGFfc3ZxX3NldHVwKHN0
cnVjdCB2aG9zdF9kZXYgKmRldiwKPiAgICAgICAgICAgZXJyb3JfcmVwb3J0KCJDYW4ndCBzZXQg
ZGV2aWNlIGNhbGwgZmQgKCVkKSIsIC1yKTsKPiAgICAgICB9Cj4gICAKPiArICAgIHJldHVybiBy
Owo+ICt9Cj4gKwo+ICsvKioKPiArICogVW5tYXAgU1ZRIGFyZWEgaW4gdGhlIGRldmljZQo+ICsg
Ki8KPiArc3RhdGljIGJvb2wgdmhvc3RfdmRwYV9zdnFfdW5tYXBfcmluZyhzdHJ1Y3Qgdmhvc3Rf
dmRwYSAqdiwgaHdhZGRyIGlvdmEsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaHdhZGRyIHNpemUpCj4gK3sKPiArICAgIGludCByOwo+ICsKPiArICAgIHNpemUgPSBS
T1VORF9VUChzaXplLCBxZW11X3JlYWxfaG9zdF9wYWdlX3NpemUpOwo+ICsgICAgciA9IHZob3N0
X3ZkcGFfZG1hX3VubWFwKHYsIGlvdmEsIHNpemUpOwo+ICsgICAgcmV0dXJuIHIgPT0gMDsKPiAr
fQo+ICsKPiArc3RhdGljIGJvb2wgdmhvc3RfdmRwYV9zdnFfdW5tYXBfcmluZ3Moc3RydWN0IHZo
b3N0X2RldiAqZGV2LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBWaG9zdFNoYWRvd1ZpcnRxdWV1ZSAqc3ZxKQo+ICt7Cj4gKyAgICBzdHJ1Y3Qgdmhvc3Rf
dmRwYSAqdiA9IGRldi0+b3BhcXVlOwo+ICsgICAgc3RydWN0IHZob3N0X3ZyaW5nX2FkZHIgc3Zx
X2FkZHI7Cj4gKyAgICBzaXplX3QgZGV2aWNlX3NpemUgPSB2aG9zdF9zdnFfZGV2aWNlX2FyZWFf
c2l6ZShzdnEpOwo+ICsgICAgc2l6ZV90IGRyaXZlcl9zaXplID0gdmhvc3Rfc3ZxX2RyaXZlcl9h
cmVhX3NpemUoc3ZxKTsKPiArICAgIGJvb2wgb2s7Cj4gKwo+ICsgICAgdmhvc3Rfc3ZxX2dldF92
cmluZ19hZGRyKHN2cSwgJnN2cV9hZGRyKTsKPiArCj4gKyAgICBvayA9IHZob3N0X3ZkcGFfc3Zx
X3VubWFwX3Jpbmcodiwgc3ZxX2FkZHIuZGVzY191c2VyX2FkZHIsIGRyaXZlcl9zaXplKTsKPiAr
ICAgIGlmICh1bmxpa2VseSghb2spKSB7Cj4gKyAgICAgICAgcmV0dXJuIGZhbHNlOwo+ICsgICAg
fQo+ICsKPiArICAgIHJldHVybiB2aG9zdF92ZHBhX3N2cV91bm1hcF9yaW5nKHYsIHN2cV9hZGRy
LnVzZWRfdXNlcl9hZGRyLCBkZXZpY2Vfc2l6ZSk7Cj4gK30KPiArCj4gKy8qKgo+ICsgKiBNYXAg
c2hhZG93IHZpcnRxdWV1ZSByaW5ncyBpbiBkZXZpY2UKPiArICoKPiArICogQGRldiAgIFRoZSB2
aG9zdCBkZXZpY2UKPiArICogQHN2cSAgIFRoZSBzaGFkb3cgdmlydHF1ZXVlCj4gKyAqLwo+ICtz
dGF0aWMgYm9vbCB2aG9zdF92ZHBhX3N2cV9tYXBfcmluZ3Moc3RydWN0IHZob3N0X2RldiAqZGV2
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgVmhvc3RTaGFk
b3dWaXJ0cXVldWUgKnN2cSkKPiArewo+ICsgICAgc3RydWN0IHZob3N0X3ZkcGEgKnYgPSBkZXYt
Pm9wYXF1ZTsKPiArICAgIHN0cnVjdCB2aG9zdF92cmluZ19hZGRyIHN2cV9hZGRyOwo+ICsgICAg
c2l6ZV90IGRldmljZV9zaXplID0gdmhvc3Rfc3ZxX2RldmljZV9hcmVhX3NpemUoc3ZxKTsKPiAr
ICAgIHNpemVfdCBkcml2ZXJfc2l6ZSA9IHZob3N0X3N2cV9kcml2ZXJfYXJlYV9zaXplKHN2cSk7
Cj4gKyAgICBpbnQgcjsKPiArCj4gKyAgICB2aG9zdF9zdnFfZ2V0X3ZyaW5nX2FkZHIoc3ZxLCAm
c3ZxX2FkZHIpOwo+ICsKPiArICAgIHIgPSB2aG9zdF92ZHBhX2RtYV9tYXAodiwgc3ZxX2FkZHIu
ZGVzY191c2VyX2FkZHIsIGRyaXZlcl9zaXplLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAodm9pZCAqKXN2cV9hZGRyLmRlc2NfdXNlcl9hZGRyLCB0cnVlKTsKPiArICAgIGlmICh1bmxp
a2VseShyICE9IDApKSB7Cj4gKyAgICAgICAgcmV0dXJuIGZhbHNlOwo+ICsgICAgfQo+ICsKPiAr
ICAgIHIgPSB2aG9zdF92ZHBhX2RtYV9tYXAodiwgc3ZxX2FkZHIudXNlZF91c2VyX2FkZHIsIGRl
dmljZV9zaXplLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAodm9pZCAqKXN2cV9hZGRy
LnVzZWRfdXNlcl9hZGRyLCBmYWxzZSk7CgoKRG8gd2UgbmVlZCB1bm1hcCB0aGUgZHJpdmVyIGFy
ZWEgaWYgd2UgZmFpbCBoZXJlPwoKVGhhbmtzCgoKPiArICAgIHJldHVybiByID09IDA7Cj4gK30K
PiArCj4gK3N0YXRpYyBib29sIHZob3N0X3ZkcGFfc3ZxX3NldHVwKHN0cnVjdCB2aG9zdF9kZXYg
KmRldiwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaG9zdFNoYWRvd1ZpcnRx
dWV1ZSAqc3ZxLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGlk
eCkKPiArewo+ICsgICAgdWludDE2X3QgdnFfaW5kZXggPSBkZXYtPnZxX2luZGV4ICsgaWR4Owo+
ICsgICAgc3RydWN0IHZob3N0X3ZyaW5nX3N0YXRlIHMgPSB7Cj4gKyAgICAgICAgLmluZGV4ID0g
dnFfaW5kZXgsCj4gKyAgICB9Owo+ICsgICAgaW50IHI7Cj4gKyAgICBib29sIG9rOwo+ICsKPiAr
ICAgIHIgPSB2aG9zdF92ZHBhX3NldF9kZXZfdnJpbmdfYmFzZShkZXYsICZzKTsKPiArICAgIGlm
ICh1bmxpa2VseShyKSkgewo+ICsgICAgICAgIGVycm9yX3JlcG9ydCgiQ2FuJ3Qgc2V0IHZyaW5n
IGJhc2UgKCVkKSIsIHIpOwo+ICsgICAgICAgIHJldHVybiBmYWxzZTsKPiArICAgIH0KPiArCj4g
KyAgICBzLm51bSA9IHZob3N0X3N2cV9nZXRfbnVtKHN2cSk7Cj4gKyAgICByID0gdmhvc3RfdmRw
YV9zZXRfZGV2X3ZyaW5nX251bShkZXYsICZzKTsKPiArICAgIGlmICh1bmxpa2VseShyKSkgewo+
ICsgICAgICAgIGVycm9yX3JlcG9ydCgiQ2FuJ3Qgc2V0IHZyaW5nIG51bSAoJWQpIiwgcik7Cj4g
KyAgICAgICAgcmV0dXJuIGZhbHNlOwo+ICsgICAgfQo+ICsKPiArICAgIG9rID0gdmhvc3RfdmRw
YV9zdnFfbWFwX3JpbmdzKGRldiwgc3ZxKTsKPiArICAgIGlmICh1bmxpa2VseSghb2spKSB7Cj4g
KyAgICAgICAgcmV0dXJuIGZhbHNlOwo+ICsgICAgfQo+ICsKPiArICAgIHIgPSB2aG9zdF92ZHBh
X3N2cV9zZXRfZmRzKGRldiwgc3ZxLCBpZHgpOwo+ICAgICAgIHJldHVybiByID09IDA7Cj4gICB9
Cj4gICAKPiBAQCAtNzg4LDE0ICs4ODEsMjQgQEAgc3RhdGljIGludCB2aG9zdF92ZHBhX2Rldl9z
dGFydChzdHJ1Y3Qgdmhvc3RfZGV2ICpkZXYsIGJvb2wgc3RhcnRlZCkKPiAgICAgICBpZiAoc3Rh
cnRlZCkgewo+ICAgICAgICAgICB2aG9zdF92ZHBhX2hvc3Rfbm90aWZpZXJzX2luaXQoZGV2KTsK
PiAgICAgICAgICAgZm9yICh1bnNpZ25lZCBpID0gMDsgaSA8IHYtPnNoYWRvd192cXMtPmxlbjsg
KytpKSB7Cj4gKyAgICAgICAgICAgIFZpcnRRdWV1ZSAqdnEgPSB2aXJ0aW9fZ2V0X3F1ZXVlKGRl
di0+dmRldiwgZGV2LT52cV9pbmRleCArIGkpOwo+ICAgICAgICAgICAgICAgVmhvc3RTaGFkb3dW
aXJ0cXVldWUgKnN2cSA9IGdfcHRyX2FycmF5X2luZGV4KHYtPnNoYWRvd192cXMsIGkpOwo+ICAg
ICAgICAgICAgICAgYm9vbCBvayA9IHZob3N0X3ZkcGFfc3ZxX3NldHVwKGRldiwgc3ZxLCBpKTsK
PiAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghb2spKSB7Cj4gICAgICAgICAgICAgICAgICAg
cmV0dXJuIC0xOwo+ICAgICAgICAgICAgICAgfQo+ICsgICAgICAgICAgICB2aG9zdF9zdnFfc3Rh
cnQoc3ZxLCBkZXYtPnZkZXYsIHZxKTsKPiAgICAgICAgICAgfQo+ICAgICAgICAgICB2aG9zdF92
ZHBhX3NldF92cmluZ19yZWFkeShkZXYpOwo+ICAgICAgIH0gZWxzZSB7Cj4gKyAgICAgICAgZm9y
ICh1bnNpZ25lZCBpID0gMDsgaSA8IHYtPnNoYWRvd192cXMtPmxlbjsgKytpKSB7Cj4gKyAgICAg
ICAgICAgIFZob3N0U2hhZG93VmlydHF1ZXVlICpzdnEgPSBnX3B0cl9hcnJheV9pbmRleCh2LT5z
aGFkb3dfdnFzLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgaSk7Cj4gKyAgICAgICAgICAgIGJvb2wgb2sgPSB2aG9zdF92ZHBhX3N2
cV91bm1hcF9yaW5ncyhkZXYsIHN2cSk7Cj4gKyAgICAgICAgICAgIGlmICh1bmxpa2VseSghb2sp
KSB7Cj4gKyAgICAgICAgICAgICAgICByZXR1cm4gLTE7Cj4gKyAgICAgICAgICAgIH0KPiArICAg
ICAgICB9Cj4gICAgICAgICAgIHZob3N0X3ZkcGFfaG9zdF9ub3RpZmllcnNfdW5pbml0KGRldiwg
ZGV2LT5udnFzKTsKPiAgICAgICB9Cj4gICAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXph
dGlvbkBsaXN0cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRh
dGlvbi5vcmcvbWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
