Return-Path: <virtualization-bounces@lists.linux-foundation.org>
X-Original-To: lists.virtualization@lfdr.de
Delivered-To: lists.virtualization@lfdr.de
Received: from smtp1.osuosl.org (smtp1.osuosl.org [IPv6:2605:bc80:3010::138])
	by mail.lfdr.de (Postfix) with ESMTPS id C4129707C62
	for <lists.virtualization@lfdr.de>; Thu, 18 May 2023 10:55:43 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by smtp1.osuosl.org (Postfix) with ESMTP id E76BF83D04;
	Thu, 18 May 2023 08:55:41 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org E76BF83D04
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp1.osuosl.org ([127.0.0.1])
	by localhost (smtp1.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 6zRiCqHM_HjV; Thu, 18 May 2023 08:55:40 +0000 (UTC)
Received: from lists.linuxfoundation.org (lf-lists.osuosl.org [IPv6:2605:bc80:3010:104::8cd3:938])
	by smtp1.osuosl.org (Postfix) with ESMTPS id 50E5283F51;
	Thu, 18 May 2023 08:55:40 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org 50E5283F51
Received: from lf-lists.osuosl.org (localhost [127.0.0.1])
	by lists.linuxfoundation.org (Postfix) with ESMTP id 6F77DC007E;
	Thu, 18 May 2023 08:55:39 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@lists.linuxfoundation.org
Received: from smtp1.osuosl.org (smtp1.osuosl.org [IPv6:2605:bc80:3010::138])
 by lists.linuxfoundation.org (Postfix) with ESMTP id D7A61C002A
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 08:55:37 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by smtp1.osuosl.org (Postfix) with ESMTP id 9E28883ECE
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 08:55:37 +0000 (UTC)
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org 9E28883ECE
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from smtp1.osuosl.org ([127.0.0.1])
 by localhost (smtp1.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id sPkqUfSRb7J3
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 08:55:35 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.8.0
DKIM-Filter: OpenDKIM Filter v2.11.0 smtp1.osuosl.org 58C3D83D04
Received: from out30-133.freemail.mail.aliyun.com
 (out30-133.freemail.mail.aliyun.com [115.124.30.133])
 by smtp1.osuosl.org (Postfix) with ESMTPS id 58C3D83D04
 for <virtualization@lists.linux-foundation.org>;
 Thu, 18 May 2023 08:55:34 +0000 (UTC)
X-Alimail-AntiSpam: AC=PASS; BC=-1|-1; BR=01201311R921e4; CH=green; DM=||false|;
 DS=||; FP=0|-1|-1|-1|0|-1|-1|-1; HT=ay29a033018045170;
 MF=xuanzhuo@linux.alibaba.com; NM=1; PH=DS; RN=4; SR=0;
 TI=SMTPD_---0ViwAEuC_1684400127; 
Received: from localhost(mailfrom:xuanzhuo@linux.alibaba.com
 fp:SMTPD_---0ViwAEuC_1684400127) by smtp.aliyun-inc.com;
 Thu, 18 May 2023 16:55:28 +0800
Message-ID: <1684399835.450851-1-xuanzhuo@linux.alibaba.com>
Subject: Re: [PATCH vhost v9 05/12] virtio_ring: split: virtqueue_add_split()
 support premapped
Date: Thu, 18 May 2023 16:50:35 +0800
From: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
To: "Michael S. Tsirkin" <mst@redhat.com>
References: <20230517022249.20790-1-xuanzhuo@linux.alibaba.com>
 <20230517022249.20790-6-xuanzhuo@linux.alibaba.com>
 <CACGkMEu7+kDPiWmULXW_saW6pb5yF=gnqXRkSWcYbZCiJmszHQ@mail.gmail.com>
 <20230518030701-mutt-send-email-mst@kernel.org>
 <1684395232.2129312-1-xuanzhuo@linux.alibaba.com>
 <20230518041446-mutt-send-email-mst@kernel.org>
In-Reply-To: <20230518041446-mutt-send-email-mst@kernel.org>
Cc: Christoph Hellwig <hch@infradead.org>,
 virtualization@lists.linux-foundation.org
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>, 
 <mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: virtualization-bounces@lists.linux-foundation.org
Sender: "Virtualization" <virtualization-bounces@lists.linux-foundation.org>

T24gVGh1LCAxOCBNYXkgMjAyMyAwNDoyOTowMSAtMDQwMCwgIk1pY2hhZWwgUy4gVHNpcmtpbiIg
PG1zdEByZWRoYXQuY29tPiB3cm90ZToKPiBPbiBUaHUsIE1heSAxOCwgMjAyMyBhdCAwMzozMzo1
MlBNICswODAwLCBYdWFuIFpodW8gd3JvdGU6Cj4gPiBPbiBUaHUsIDE4IE1heSAyMDIzIDAzOjEx
OjI1IC0wNDAwLCAiTWljaGFlbCBTLiBUc2lya2luIiA8bXN0QHJlZGhhdC5jb20+IHdyb3RlOgo+
ID4gPiBPbiBUaHUsIE1heSAxOCwgMjAyMyBhdCAwMjo1MTo1N1BNICswODAwLCBKYXNvbiBXYW5n
IHdyb3RlOgo+ID4gPiA+IE9uIFdlZCwgTWF5IDE3LCAyMDIzIGF0IDEwOjIz4oCvQU0gWHVhbiBa
aHVvIDx4dWFuemh1b0BsaW51eC5hbGliYWJhLmNvbT4gd3JvdGU6Cj4gPiA+ID4gPgo+ID4gPiA+
ID4gdmlydHF1ZXVlX2FkZF9zcGxpdCgpIG9ubHkgc3VwcG9ydHMgdmlydHVhbCBhZGRyZXNzZXMs
IGRtYSBpcyBjb21wbGV0ZWQKPiA+ID4gPiA+IGluIHZpcnRxdWV1ZV9hZGRfc3BsaXQoKS4KPiA+
ID4gPiA+Cj4gPiA+ID4gPiBJbiBzb21lIHNjZW5hcmlvcyAoc3VjaCBhcyB0aGUgQUZfWERQIHNj
ZW5hcmlvKSwgdGhlIG1lbW9yeSBpcyBhbGxvY2F0ZWQKPiA+ID4gPiA+IGFuZCBETUEgaXMgY29t
cGxldGVkIGluIGFkdmFuY2UsIHNvIGl0IGlzIG5lY2Vzc2FyeSBmb3IgdXMgdG8gc3VwcG9ydAo+
ID4gPiA+ID4gcGFzc2luZyB0aGUgRE1BIGFkZHJlc3MgdG8gdmlydHF1ZXVlX2FkZF9zcGxpdCgp
Lgo+ID4gPiA+ID4KPiA+ID4gPiA+IFJlY29yZCB0aGlzIGluZm9ybWF0aW9uIGluIGRlc2Nfc3Rh
dGUsIHdlIGNhbiBza2lwIHVubWFwIGJhc2VkIG9uIHRoaXMKPiA+ID4gPiA+IHdoZW4gZXhlY3V0
aW5nIGRtYSB1bm1hcC4KPiA+ID4gPgo+ID4gPiA+IEkgd291bGQgYWxzbyBzdWdnZXN0IGRvY3Vt
ZW50aW5nIHdoeSBhIHBlciBkZXNjcmlwdG9yIG1ldGFkYXRhIGlzCj4gPiA+ID4gbmVlZGVkIGlu
c3RlYWQgb2YgYSBwZXIgdmlydHF1ZXVlIG9uZS4KPiA+ID4KPiA+ID4gSSB0aGluayB3ZSBjb3Vs
ZCBtYWtlIGl0IHBlciB2aXJ0cXVldWUuIFRoYXQgd291bGQgbWVhbiBhbGwgY29kZSBpbgo+ID4g
PiB2aXJ0aW8gbmV0IHdvdWxkIGhhdmUgdG8gY2hhbmdlIHRvIGRvIGRtYSBtYXBwaW5nIGl0c2Vs
ZiBpbnN0ZWFkIG9mCj4gPiA+IHJlbHlpbmcgb24gdmlydGlvIGNvcmUgdGhvdWdoLiAgV2hpY2gg
aXMgbWF5YmUgYSBnb29kIGlkZWE/IERlZmluaXRlbHkgYQo+ID4gPiB2ZXJ5IGludHJ1c2l2ZSBj
aGFuZ2UgdGhvdWdoLCB3aWxsIG5lZWQgYSBsb3Qgb2YgcGVyZm9ybWFuY2UgdGVzdGluZwo+ID4g
PiB0byBtYWtlIHN1cmUgd2UgZG9uJ3QgYnJlYWsgYW55dGhpbmcuCj4gPgo+ID4gSW4gZmFjdCwg
d2UgaGF2ZSB0cmllZCB0aGlzIGlkZWEuCj4gPgo+ID4gVGhlIHByb2JsZW0gaXMgdGhlIGRldGFj
aCBhbmQgdW5tYXAuCj4gPgo+ID4gV2UgbmVlZCB0byBnZXQgYWxsIERNQSBBZGRyZXNzZXMgZnJv
bSB2aXJ0aW8tcmluZyB0byB1bm1hcC4gQ3VycmVudGx5LCBpdCBkb2VzCj4gPiBub3Qgc3VwcG9y
dCB0byByZXR1cm4gdGhlIERNQSBBZGRyZXNzLCBhbmQgZm9yIFNLQiwgd2UgbmVlZCB0byBnZXQg
bXVsdGlwbGUgRE1BCj4gPiBBZGRyZXNzZXMgYXQgb25lIHRpbWUuCj4gPgo+ID4gVGhpcyBuZWVk
IHRvIG1vZGlmeSB0aGUgbG9naWMgb2YgVmlydGlvLVJpbmcgZGV0YWNoLiBCZXNpZGVzIHRoaXMs
IEkgYWxzbyBhZ3JlZQo+ID4gd2l0aCB0aGlzIGlkZWEuCj4gPgo+ID4gVGhhbmtzLgo+Cj4gV2Vs
bCB5b3UgY2FuIGhhdmUgYSB2ZXJzaW9uIG9mIGdldF9idWYgdGhhdCByZXR1cm5zIHRoZW0gLi4u
IGJ1dAo+IGl0IGlzIG5vdCBjbGVhciB0byBtZSBhbGwgdGhpcyBpcyB3b3J0aCBpdCB1bmxlc3Mg
eW91IHdhbnQKPiB0byBkbyB1bnNhZmUgdHJpY2tzIGxpa2UgbGVhdmluZyB0aGVtIG1hcHBlZC4g
SSdkIGxlYXZlIHRoYXQKPiBmb3IgYW5vdGhlciBkYXkgbWF5YmUuCj4KPiBGb3IgbWFya2luZyBk
ZXNjIGFzIHByZW1hcHBlZCBJIHRoaW5rIHdlIGNhbiB1c2UgYSBiaXQgZnJvbQo+IGRlc2NfZXh0
cmEtPmZsYWdzLCBlaXRoZXIgcmV1c2luZyBvbmUgb2YgTkVYVCxBVkFJTCxVU0VELCBvciBzdGVh
bGluZwo+IGFub3RoZXIgb25lLgo+CgpEbyB5b3UgbWVhbiB0aGlzIGh0dHBzOi8vbG9yZS5rZXJu
ZWwub3JnL2FsbC8yMDIyMDIxMDA4NTEyNC4xNTQ2Ni02LXh1YW56aHVvQGxpbnV4LmFsaWJhYmEu
Y29tLwoKVGhhbmtzLgoKPgo+Cj4gPgo+ID4gPgo+ID4gPgo+ID4gPgo+ID4gPgo+ID4gPiA+ID4K
PiA+ID4gPiA+IFNpZ25lZC1vZmYtYnk6IFh1YW4gWmh1byA8eHVhbnpodW9AbGludXguYWxpYmFi
YS5jb20+Cj4gPiA+ID4gPiAtLS0KPiA+ID4gPiA+ICBkcml2ZXJzL3ZpcnRpby92aXJ0aW9fcmlu
Zy5jIHwgMzggKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tCj4gPiA+ID4gPiAg
MSBmaWxlIGNoYW5nZWQsIDI5IGluc2VydGlvbnMoKyksIDkgZGVsZXRpb25zKC0pCj4gPiA+ID4g
Pgo+ID4gPiA+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5nLmMgYi9k
cml2ZXJzL3ZpcnRpby92aXJ0aW9fcmluZy5jCj4gPiA+ID4gPiBpbmRleCBlMmZjNTBjMDViZWMu
LmJkNWU4NGFmYWIzNyAxMDA2NDQKPiA+ID4gPiA+IC0tLSBhL2RyaXZlcnMvdmlydGlvL3ZpcnRp
b19yaW5nLmMKPiA+ID4gPiA+ICsrKyBiL2RyaXZlcnMvdmlydGlvL3ZpcnRpb19yaW5nLmMKPiA+
ID4gPiA+IEBAIC03MCw2ICs3MCw3IEBACj4gPiA+ID4gPiAgc3RydWN0IHZyaW5nX2Rlc2Nfc3Rh
dGVfc3BsaXQgewo+ID4gPiA+ID4gICAgICAgICB2b2lkICpkYXRhOyAgICAgICAgICAgICAgICAg
ICAgIC8qIERhdGEgZm9yIGNhbGxiYWNrLiAqLwo+ID4gPiA+ID4gICAgICAgICBzdHJ1Y3QgdnJp
bmdfZGVzYyAqaW5kaXJfZGVzYzsgIC8qIEluZGlyZWN0IGRlc2NyaXB0b3IsIGlmIGFueS4gKi8K
PiA+ID4gPiA+ICsgICAgICAgYm9vbCBwcmVtYXBwZWQ7ICAgICAgICAgICAgICAgICAvKiBETUEg
bWFwcGluZyBpcyBkb25lIGJ5IGRyaXZlci4gKi8KPiA+ID4gPgo+ID4gPiA+IEdvaW5nIGJhY2sg
dG8gdGhlIG9yaWdpbmFsIGRpc2N1c3Npb24gYXJvdW5kIHdoZXJlIHRoaXMgc2hvdWxkIGJlCj4g
PiA+ID4gcGxhY2VkLiBJIHdvbmRlciBpZiB3ZSBjYW4gZmluZCBhIGNvbW1vbiBwbGFjZSB0byBz
dG9yZSB0aGlzIHNpbmNlIGl0Cj4gPiA+ID4gaGFzIG5vdGhpbmcgcmVsYXRlZCB0byB2aXJ0cXVl
dWUgbGF5b3V0LiBNYXliZSBkZXNjX2V4dHJhPyBBbmQgaXQKPiA+ID4gPiB3b3VsZCBiZSBldmVu
IGJldHRlciBpZiB3ZSBjYW4gYXZvaWQgc3RyZXNzaW5nIHRoZSBjYWNoZSBsaWtlIGFib3ZlLgo+
ID4gPiA+Cj4gPiA+ID4gPiAgfTsKPiA+ID4gPiA+Cj4gPiA+ID4gPiAgc3RydWN0IHZyaW5nX2Rl
c2Nfc3RhdGVfcGFja2VkIHsKPiA+ID4gPiA+IEBAIC0zNTYsOCArMzU3LDE0IEBAIHN0YXRpYyBz
dHJ1Y3QgZGV2aWNlICp2cmluZ19kbWFfZGV2KGNvbnN0IHN0cnVjdCB2cmluZ192aXJ0cXVldWUg
KnZxKQo+ID4gPiA+ID4KPiA+ID4gPiA+ICAvKiBNYXAgb25lIHNnIGVudHJ5LiAqLwo+ID4gPiA+
ID4gIHN0YXRpYyBpbnQgdnJpbmdfbWFwX29uZV9zZyhjb25zdCBzdHJ1Y3QgdnJpbmdfdmlydHF1
ZXVlICp2cSwgc3RydWN0IHNjYXR0ZXJsaXN0ICpzZywKPiA+ID4gPiA+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICBlbnVtIGRtYV9kYXRhX2RpcmVjdGlvbiBkaXJlY3Rpb24sIHN0YXRpYyBk
bWFfYWRkcl90ICphZGRyKQo+ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIGVu
dW0gZG1hX2RhdGFfZGlyZWN0aW9uIGRpcmVjdGlvbiwKPiA+ID4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICBib29sIHByZW1hcHBlZCwgZG1hX2FkZHJfdCAqYWRkcikKPiA+ID4gPgo+
ID4gPiA+IGhhdmluZyB0aGluZ3MgbGlrZToKPiA+ID4gPgo+ID4gPiA+IGludCBmdW5jKGJvb2wg
ZG8pCj4gPiA+ID4gewo+ID4gPiA+IGlmICghZG8pCj4gPiA+ID4gICAgIHJldHVybjsKPiA+ID4g
PiB9Cj4gPiA+ID4KPiA+ID4gPiBpcyBhIGhpbnQgdGhhdCB0aGUgY2hlY2sgbmVlZHMgdG8gYmUg
ZG9uZSBieSB0aGUgY2FsbGVyPwo+ID4gPiA+Cj4gPiA+ID4gQW5kIHRoaXMgY2hhbmdlIHNob3Vs
ZCB3b3JrIGZvciBib3RoIHBhY2tlZCBhbmQgc3BsaXQuIEkgdGhpbmsgd2UgbmVlZAo+ID4gPiA+
IHRvIHNxdWFzaCB0aGUgcGFja2VkIGNoYW5nZXMgaGVyZS4KPiA+ID4gPgo+ID4gPiA+IExvb2tp
bmcgYXQgaG93IHBhY2tlZCB2aXJ0cXVldWUgdXNlcyB0aGlzIGluIHRoaXMgcGF0Y2gsIEkgZG9u
J3QgdGhpbmsKPiA+ID4gPiB0aGlzIHBhdGNoIGNhbiBldmVuIGJlIGJ1aWx0LiBJIHdpbGwgd2Fp
dCBmb3IgYSBuZXcgdmVyc2lvbiBhbmQKPiA+ID4gPiBjb250aW51ZSB0aGUgcmV2aWV3IGZyb20g
dGhlcmUuCj4gPiA+ID4KPiA+ID4gPiBUaGFua3MKPiA+ID4gPgo+ID4gPiA+Cj4gPiA+ID4KPiA+
ID4gPiA+ICB7Cj4gPiA+ID4gPiArICAgICAgIGlmIChwcmVtYXBwZWQpIHsKPiA+ID4gPiA+ICsg
ICAgICAgICAgICAgICAqYWRkciA9IHNnX2RtYV9hZGRyZXNzKHNnKTsKPiA+ID4gPiA+ICsgICAg
ICAgICAgICAgICByZXR1cm4gMDsKPiA+ID4gPiA+ICsgICAgICAgfQo+ID4gPiA+ID4gKwo+ID4g
PiA+ID4gICAgICAgICBpZiAoIXZxLT51c2VfZG1hX2FwaSkgewo+ID4gPiA+ID4gICAgICAgICAg
ICAgICAgIC8qCj4gPiA+ID4gPiAgICAgICAgICAgICAgICAgICogSWYgRE1BIGlzIG5vdCB1c2Vk
LCBLTVNBTiBkb2Vzbid0IGtub3cgdGhhdCB0aGUgc2NhdHRlcmxpc3QKPiA+ID4gPiA+IEBAIC00
NDUsNyArNDUyLDcgQEAgc3RhdGljIHZvaWQgdnJpbmdfdW5tYXBfb25lX3NwbGl0X2luZGlyZWN0
KGNvbnN0IHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLAo+ID4gPiA+ID4gIH0KPiA+ID4gPiA+
Cj4gPiA+ID4gPiAgc3RhdGljIHVuc2lnbmVkIGludCB2cmluZ191bm1hcF9vbmVfc3BsaXQoY29u
c3Qgc3RydWN0IHZyaW5nX3ZpcnRxdWV1ZSAqdnEsCj4gPiA+ID4gPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgaSkKPiA+ID4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBpLCBib29s
IHByZW1hcHBlZCkKPiA+ID4gPiA+ICB7Cj4gPiA+ID4gPiAgICAgICAgIHN0cnVjdCB2cmluZ19k
ZXNjX2V4dHJhICpleHRyYSA9IHZxLT5zcGxpdC5kZXNjX2V4dHJhOwo+ID4gPiA+ID4gICAgICAg
ICB1MTYgZmxhZ3M7Cj4gPiA+ID4gPiBAQCAtNDYyLDYgKzQ2OSw5IEBAIHN0YXRpYyB1bnNpZ25l
ZCBpbnQgdnJpbmdfdW5tYXBfb25lX3NwbGl0KGNvbnN0IHN0cnVjdCB2cmluZ192aXJ0cXVldWUg
KnZxLAo+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGZsYWdzICYg
VlJJTkdfREVTQ19GX1dSSVRFKSA/Cj4gPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBETUFfRlJPTV9ERVZJQ0UgOiBETUFfVE9fREVWSUNFKTsKPiA+ID4gPiA+ICAgICAg
ICAgfSBlbHNlIHsKPiA+ID4gPiA+ICsgICAgICAgICAgICAgICBpZiAocHJlbWFwcGVkKQo+ID4g
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXQ7Cj4gPiA+ID4gPiArCj4gPiA+
ID4gPiAgICAgICAgICAgICAgICAgZG1hX3VubWFwX3BhZ2UodnJpbmdfZG1hX2Rldih2cSksCj4g
PiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFbaV0uYWRkciwKPiA+
ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYVtpXS5sZW4sCj4gPiA+
ID4gPiBAQCAtNTMyLDYgKzU0Miw3IEBAIHN0YXRpYyBpbmxpbmUgaW50IHZpcnRxdWV1ZV9hZGRf
c3BsaXQoc3RydWN0IHZpcnRxdWV1ZSAqX3ZxLAo+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgaW5fc2dzLAo+ID4gPiA+ID4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpkYXRhLAo+ID4gPiA+ID4gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpjdHgsCj4gPiA+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgcHJlbWFwcGVkLAo+ID4g
PiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZnBfdCBnZnApCj4g
PiA+ID4gPiAgewo+ID4gPiA+ID4gICAgICAgICBzdHJ1Y3QgdnJpbmdfdmlydHF1ZXVlICp2cSA9
IHRvX3Z2cShfdnEpOwo+ID4gPiA+ID4gQEAgLTU5NSw3ICs2MDYsNyBAQCBzdGF0aWMgaW5saW5l
IGludCB2aXJ0cXVldWVfYWRkX3NwbGl0KHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ID4gPiA+
ICAgICAgICAgICAgICAgICBmb3IgKHNnID0gc2dzW25dOyBzZzsgc2cgPSBzZ19uZXh0KHNnKSkg
ewo+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgZG1hX2FkZHJfdCBhZGRyOwo+ID4g
PiA+ID4KPiA+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmICh2cmluZ19tYXBfb25l
X3NnKHZxLCBzZywgRE1BX1RPX0RFVklDRSwgJmFkZHIpKQo+ID4gPiA+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgaWYgKHZyaW5nX21hcF9vbmVfc2codnEsIHNnLCBETUFfVE9fREVWSUNFLCBw
cmVtYXBwZWQsICZhZGRyKSkKPiA+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZ290byB1bm1hcF9yZWxlYXNlOwo+ID4gPiA+ID4KPiA+ID4gPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgIHByZXYgPSBpOwo+ID4gPiA+ID4gQEAgLTYxMSw3ICs2MjIsNyBAQCBzdGF0aWMg
aW5saW5lIGludCB2aXJ0cXVldWVfYWRkX3NwbGl0KHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+
ID4gPiA+ICAgICAgICAgICAgICAgICBmb3IgKHNnID0gc2dzW25dOyBzZzsgc2cgPSBzZ19uZXh0
KHNnKSkgewo+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgZG1hX2FkZHJfdCBhZGRy
Owo+ID4gPiA+ID4KPiA+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmICh2cmluZ19t
YXBfb25lX3NnKHZxLCBzZywgRE1BX0ZST01fREVWSUNFLCAmYWRkcikpCj4gPiA+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICBpZiAodnJpbmdfbWFwX29uZV9zZyh2cSwgc2csIERNQV9GUk9N
X0RFVklDRSwgcHJlbWFwcGVkLCAmYWRkcikpCj4gPiA+ID4gPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGdvdG8gdW5tYXBfcmVsZWFzZTsKPiA+ID4gPiA+Cj4gPiA+ID4gPiAgICAg
ICAgICAgICAgICAgICAgICAgICBwcmV2ID0gaTsKPiA+ID4gPiA+IEBAIC02NTcsNiArNjY4LDcg
QEAgc3RhdGljIGlubGluZSBpbnQgdmlydHF1ZXVlX2FkZF9zcGxpdChzdHJ1Y3QgdmlydHF1ZXVl
ICpfdnEsCj4gPiA+ID4gPgo+ID4gPiA+ID4gICAgICAgICAvKiBTdG9yZSB0b2tlbiBhbmQgaW5k
aXJlY3QgYnVmZmVyIHN0YXRlLiAqLwo+ID4gPiA+ID4gICAgICAgICB2cS0+c3BsaXQuZGVzY19z
dGF0ZVtoZWFkXS5kYXRhID0gZGF0YTsKPiA+ID4gPiA+ICsgICAgICAgdnEtPnNwbGl0LmRlc2Nf
c3RhdGVbaGVhZF0ucHJlbWFwcGVkID0gcHJlbWFwcGVkOwo+ID4gPiA+ID4gICAgICAgICBpZiAo
aW5kaXJlY3QpCj4gPiA+ID4gPiAgICAgICAgICAgICAgICAgdnEtPnNwbGl0LmRlc2Nfc3RhdGVb
aGVhZF0uaW5kaXJfZGVzYyA9IGRlc2M7Cj4gPiA+ID4gPiAgICAgICAgIGVsc2UKPiA+ID4gPiA+
IEBAIC02ODYsNiArNjk4LDE0IEBAIHN0YXRpYyBpbmxpbmUgaW50IHZpcnRxdWV1ZV9hZGRfc3Bs
aXQoc3RydWN0IHZpcnRxdWV1ZSAqX3ZxLAo+ID4gPiA+ID4gICAgICAgICByZXR1cm4gMDsKPiA+
ID4gPiA+Cj4gPiA+ID4gPiAgdW5tYXBfcmVsZWFzZToKPiA+ID4gPiA+ICsgICAgICAgaWYgKHBy
ZW1hcHBlZCkgewo+ID4gPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChpbmRpcmVjdCkKPiA+ID4g
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGtmcmVlKGRlc2MpOwo+ID4gPiA+ID4gKwo+ID4g
PiA+ID4gKyAgICAgICAgICAgICAgIEVORF9VU0UodnEpOwo+ID4gPiA+ID4gKyAgICAgICAgICAg
ICAgIHJldHVybiAtRU5PTUVNOwo+ID4gPiA+ID4gKyAgICAgICB9Cj4gPiA+ID4gPiArCj4gPiA+
ID4gPiAgICAgICAgIGVycl9pZHggPSBpOwo+ID4gPiA+ID4KPiA+ID4gPiA+ICAgICAgICAgaWYg
KGluZGlyZWN0KQo+ID4gPiA+ID4gQEAgLTcwMCw3ICs3MjAsNyBAQCBzdGF0aWMgaW5saW5lIGlu
dCB2aXJ0cXVldWVfYWRkX3NwbGl0KHN0cnVjdCB2aXJ0cXVldWUgKl92cSwKPiA+ID4gPiA+ICAg
ICAgICAgICAgICAgICAgICAgICAgIHZyaW5nX3VubWFwX29uZV9zcGxpdF9pbmRpcmVjdCh2cSwg
JmRlc2NbaV0pOwo+ID4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgaSA9IHZpcnRpbzE2
X3RvX2NwdShfdnEtPnZkZXYsIGRlc2NbaV0ubmV4dCk7Cj4gPiA+ID4gPiAgICAgICAgICAgICAg
ICAgfSBlbHNlCj4gPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBpID0gdnJpbmdfdW5t
YXBfb25lX3NwbGl0KHZxLCBpKTsKPiA+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGkg
PSB2cmluZ191bm1hcF9vbmVfc3BsaXQodnEsIGksIGZhbHNlKTsKPiA+ID4gPiA+ICAgICAgICAg
fQo+ID4gPiA+ID4KPiA+ID4gPiA+ICAgICAgICAgaWYgKGluZGlyZWN0KQo+ID4gPiA+ID4gQEAg
LTc1NywxMiArNzc3LDEyIEBAIHN0YXRpYyB2b2lkIGRldGFjaF9idWZfc3BsaXQoc3RydWN0IHZy
aW5nX3ZpcnRxdWV1ZSAqdnEsIHVuc2lnbmVkIGludCBoZWFkLAo+ID4gPiA+ID4gICAgICAgICBp
ID0gaGVhZDsKPiA+ID4gPiA+Cj4gPiA+ID4gPiAgICAgICAgIHdoaWxlICh2cS0+c3BsaXQudnJp
bmcuZGVzY1tpXS5mbGFncyAmIG5leHRmbGFnKSB7Cj4gPiA+ID4gPiAtICAgICAgICAgICAgICAg
dnJpbmdfdW5tYXBfb25lX3NwbGl0KHZxLCBpKTsKPiA+ID4gPiA+ICsgICAgICAgICAgICAgICB2
cmluZ191bm1hcF9vbmVfc3BsaXQodnEsIGksIHN0YXRlLT5wcmVtYXBwZWQpOwo+ID4gPiA+ID4g
ICAgICAgICAgICAgICAgIGkgPSB2cS0+c3BsaXQuZGVzY19leHRyYVtpXS5uZXh0Owo+ID4gPiA+
ID4gICAgICAgICAgICAgICAgIHZxLT52cS5udW1fZnJlZSsrOwo+ID4gPiA+ID4gICAgICAgICB9
Cj4gPiA+ID4gPgo+ID4gPiA+ID4gLSAgICAgICB2cmluZ191bm1hcF9vbmVfc3BsaXQodnEsIGkp
Owo+ID4gPiA+ID4gKyAgICAgICB2cmluZ191bm1hcF9vbmVfc3BsaXQodnEsIGksIHN0YXRlLT5w
cmVtYXBwZWQpOwo+ID4gPiA+ID4gICAgICAgICB2cS0+c3BsaXQuZGVzY19leHRyYVtpXS5uZXh0
ID0gdnEtPmZyZWVfaGVhZDsKPiA+ID4gPiA+ICAgICAgICAgdnEtPmZyZWVfaGVhZCA9IGhlYWQ7
Cj4gPiA+ID4gPgo+ID4gPiA+ID4gQEAgLTc4Myw3ICs4MDMsNyBAQCBzdGF0aWMgdm9pZCBkZXRh
Y2hfYnVmX3NwbGl0KHN0cnVjdCB2cmluZ192aXJ0cXVldWUgKnZxLCB1bnNpZ25lZCBpbnQgaGVh
ZCwKPiA+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVlJJTkdfREVTQ19G
X0lORElSRUNUKSk7Cj4gPiA+ID4gPiAgICAgICAgICAgICAgICAgQlVHX09OKGxlbiA9PSAwIHx8
IGxlbiAlIHNpemVvZihzdHJ1Y3QgdnJpbmdfZGVzYykpOwo+ID4gPiA+ID4KPiA+ID4gPiA+IC0g
ICAgICAgICAgICAgICBpZiAodnEtPnVzZV9kbWFfYXBpKSB7Cj4gPiA+ID4gPiArICAgICAgICAg
ICAgICAgaWYgKHZxLT51c2VfZG1hX2FwaSAmJiAhc3RhdGUtPnByZW1hcHBlZCkgewo+ID4gPiA+
ID4gICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IGxlbiAvIHNpemVvZihz
dHJ1Y3QgdnJpbmdfZGVzYyk7IGorKykKPiA+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdnJpbmdfdW5tYXBfb25lX3NwbGl0X2luZGlyZWN0KHZxLCAmaW5kaXJfZGVzY1tq
XSk7Cj4gPiA+ID4gPiAgICAgICAgICAgICAgICAgfQo+ID4gPiA+ID4gQEAgLTIxNDMsNyArMjE2
Myw3IEBAIHN0YXRpYyBpbmxpbmUgaW50IHZpcnRxdWV1ZV9hZGQoc3RydWN0IHZpcnRxdWV1ZSAq
X3ZxLAo+ID4gPiA+ID4gICAgICAgICByZXR1cm4gdnEtPnBhY2tlZF9yaW5nID8gdmlydHF1ZXVl
X2FkZF9wYWNrZWQoX3ZxLCBzZ3MsIHRvdGFsX3NnLAo+ID4gPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIG91dF9zZ3MsIGluX3NncywgZGF0YSwgY3R4LCBnZnAp
IDoKPiA+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpcnRxdWV1ZV9h
ZGRfc3BsaXQoX3ZxLCBzZ3MsIHRvdGFsX3NnLAo+ID4gPiA+ID4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIG91dF9zZ3MsIGluX3NncywgZGF0YSwgY3R4LCBnZnApOwo+
ID4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dF9zZ3Ms
IGluX3NncywgZGF0YSwgY3R4LCBwcmVtYXBwZWQsIGdmcCk7Cj4gPiA+ID4gPiAgfQo+ID4gPiA+
ID4KPiA+ID4gPiA+ICAvKioKPiA+ID4gPiA+IC0tCj4gPiA+ID4gPiAyLjMyLjAuMy5nMDExOTVj
ZjlmCj4gPiA+ID4gPgo+ID4gPgo+Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fClZpcnR1YWxpemF0aW9uIG1haWxpbmcgbGlzdApWaXJ0dWFsaXphdGlvbkBs
aXN0cy5saW51eC1mb3VuZGF0aW9uLm9yZwpodHRwczovL2xpc3RzLmxpbnV4Zm91bmRhdGlvbi5v
cmcvbWFpbG1hbi9saXN0aW5mby92aXJ0dWFsaXphdGlvbg==
